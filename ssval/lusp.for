        IMPLICIT INTEGER (A-Z)
        DOUBLE PRECISION FILEID,CURFIL,FILNAM(2),SUUN
        INTEGER UNAME(3),NEWNAM(3),PROTC(4)
        DATA FILNAM/'LUDUPD.DELLUDUPD.CHG'/
        CALL HSHAKE
100     CALL G1BYTE(CODE)
        IF ((CODE.LT.1).OR.(CODE.GT.2)) GO TO 550
        FILEID= FILNAM(CODE)
        CALL FILINF(FILEID,PROTC,IERROR)
        IF (IERROR.NE.0) GO TO 640
        CALL GETNAM(CODE,CURFIL)
200     CONTINUE
        OPEN (UNIT=5,FILE=FILEID,ACCESS='APPEND',ERR=600)
        CLOSE (UNIT=5,DISPOSE='RENAME',FILE=CURFIL,ERR=600)
        OPEN (UNIT=5,FILE=CURFIL,ACCESS='SEQIN',ERR=600)
        CALL S1BYTE(1)
        IF (CODE.EQ.2) GO TO 400
300     READ(5,1000,END=500)UNAME,SUUN
        CALL CVTSTR(SUUN,UUN)
        CALL SUNAME(UNAME)
        CALL S3BYTE(UUN)
        GO TO 300
400     READ(5,1100,END=500)UNAME,NEWNAM,SUUN
        CALL CVTSTR(SUUN,UUN)
        CALL SUNAME(UNAME)
        CALL S3BYTE(UUN)
        CALL SUNAME(NEWNAM)
        GO TO 400
500     CALL S1BYTE("377)
        CLOSE(UNIT=5,DISPOSE='DELETE')
        GO TO 100
550     CALL S1BYTE(3)
        GO TO 100
600     CALL ERRSNS(ERR1,ERR2)
        IF (ERR2.NE.253) GO TO 610
        CALL SLEEPY(5)
        GO TO 200
610     IF (ERR2.NE.254) GO TO 620
        CALL NXTFIL(CURFIL,IERR)
        IF (IERR.EQ.-1) CALL DELET(CURFIL,IERR)
        GO TO 200
620     IF (ERR2.NE.250) GO TO 640
630     CALL S1BYTE(2)
        GO TO 100
640     CALL S1BYTE(4)
        GO TO 100
1000    FORMAT(2A5,A2,A6)
1100    FORMAT(2A5,A2,2A5,A2,A6)
        END
