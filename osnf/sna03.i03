
: ******************************************************************
: **                  PROPRIETARY INFORMATION                     **
: **                                                              **
: **  This  source  code  listing  constitutes  the proprietary   **
: **  property of MDC-TYMNET.  The recipient, by receiving this   **
: **  program listing, agrees that neither this listing nor the   **
: **  information disclosed herein nor any part thereof shall be  **
: **  reproduced or transferred to other documents or used or dis-**
: **  closed to others for manufacturing or for any other purpose **
: **  except as specifically authorized in writing by MDC-TYMNET. **
: ******************************************************************
: **                   PROGRAM IDENTIFICATION                     **
: **                                                              **
: **  Version Number     :  3.03         Release Date :	12/18/87  **
: **                                                              **
: **  File Name          :  SNA03.I03                             **
: **                                                              **
: **  File Description   :  SNA interface init file               **
: **                                                              **
: **  File Abstract      :                                        **
: **                                                              **
: ******************************************************************
: **                CONFIGURATION SPECIFICATION                   **
: **                                                              **
: **  Core Memory Requirement:                                    **
: **                                                              **
: **  Basic Code Size:                                            **
: **                                                              **
: **  Additional Code Size per Tymfile Parameter Unit:            **
: **                                                              **
: **  Estimated Code Growth for Next 12 Months:                   **
: **                                                              **
: **  Sample Configurations:                                      **
: **                                                              **
: **  Hardware/Firmware Requirements:                             **
: **                                                              **
: **  Other Software Requirements:                                **
: **                                                              **
: **  Slot Limitations:                                           **
: **                                                              **
: ******************************************************************
: **                   DOCUMENT SPECIFICATION                     **
: **                                                              **
: **  Software Requirements Specification       :                 **
: **                                                              **
: **  Functional Specification (GED)            :                 **
: **                                                              **
: ******************************************************************
: **                      MAINTENANCE HISTORY                     **
: **                                                              **
: **  Ver   Date    By   PIR/NSR         Reason for Change        **
: ** ----- -------- ---  -------- ------------------------------  **
: ******************************************************************
: **                 SUBROUTINE IDENTIFICATION                    **
: **                                                              **
: **  Routine Abstract   :                                        **
: **                                                              **
: **  Calling Sequence   :                                        **
: **                                                              **
: **  Parameters         :                                        **
: **                                                              **
: **  Returned Values    :                                        **
: **                                                              **
: **  Side Effects       :                                        **
: **                                                              **
: **  Optional Comments  :                                        **
: **                                                              **
: ******************************************************************
	SUBTTL	SNA INITIALIZATION -- SNA03.I03


:	::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
:	REVISION HISTORY --
:
:	::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

	RA	0		:RADIX IS HEX

:	VERSION AND REVISION
:	--------------------
	GL	PRODID,TID
SNA.TI	EQ	62		:PRODUCT ID FOR SNA TERMINAL INTERFACE
SNA.HI	EQ	63		:PRODUCT ID FOR SNA HOST INTERFACE
PRODID	EQ	63		:PRODUCT ID FOR SNA (HOST SNA PID)
TID	EQ	0C+0C0		:TID FOR SNA TERMINAL PORT
VERSION	EQ	3		:VERSION
REVLEV	EQ	03		:REVISION LEVEL
ISBREV	EQ	0121886		:SUB-REVISION LEVEL 01 ON 12/18/86

:		******  S N A / S D L C   I N T E R F A C E  ******
:			    VERSION 3    REVLEV 03
:			      DECEMBER 18, 1987 

DSPDAT	MACRO[
	REMARK	%%                     DECEMBER 18, 1987%%%
]


:	DEFINE GLOBAL  SYMBOLS
:	---------------------------
MONTYP	EQ	0			:MONITOR USER
SNAHST	EQ	1			:SNA HOST

:	DEFINE DEAULT DEBUGGING SWITCHES
:	---------------------------------
	GL	DB.TRC,DEBUG,FDEBUG,EXTDDT,BTRACE,FTRACE,RPTSUP,DB.NTC
	GL	INTRCE,GN.ERR,MN.ERR,LN.ERR,PU.ERR,LU.ERR	:(I01/8/28/87/HS)
DB.TRC	EQ	0			:"JUMP TRACE" - OFF
DB.NTC	EQ	0			:STATUS.LIB, NETWORK CONSOLE OFF
DEBUG	EQ	0			:DEBUGGING CODES - OFF
FDEBUG	EQ	0			:FOREGROUND DEBUGGING CODES - OFF
EXTDDT	EQ	1			:EXTENDED DD - ON
BTRACE	EQ	1			:BACKGROUND TRACE - ON
FTRACE	EQ	1			:BACKGROUND TRACE - ON
INTRCE	EQ	1			:INFORMATION TRACE - ON (10/10/85/TTW)
RPTSUP	EQ	0			:REPORT TO SUP'S LOG
VM	EQ	0			:NO VIRTUAL MODE SUPPORT YET
GN.ERR	EQ	0			:GENERAL MACRO ERR INDICATOR (I01/8/28/87/HS/BEGIN)
MN.ERR	EQ	0			:MONITOR MACRO ERR INDICATOR 
LN.ERR	EQ	0			:LINE MACRO ERR INDICATOR 
PU.ERR	EQ	0			:PU MACRO ERR INDICATOR
LU.ERR	EQ	0			:LU MACRO ERR INDICATOR (I01/8/28/87/HS/END)
LNEN	EQ	-1			:INIT LINE NUMBER  (I02/11/23/87/HS)

:	DEFINE SYSTEM PARAMETERS
:	-------------------------
ENGINE	EQ	1			:ONLY SUPPORT ENGINE
:BBFLSZ	EQ	$A80			:DEFAULT BUFFER SIZE 80 BYTES
BBFLSZ	EQ	$A140			:DEFAULT BUFFER SIZE OF 140 BYTES
MONBQA	EQ	$A10			:DEFAULT MONITOR BB QUOTA
NTOUT	EQ	4			:NUMBER OF TIMOUT LIST ENTRIES
CNTRL	EQ	1C			:SEG E CONTROL WORD
GAUGE	EQ	04			:GAUGING CHAR IS CNTL D

:	DEFINE SEGMENTS & PROTECTIONS
:	-----------------------------
:SEGMENT ASSIGNMENTS CHANGED TO HAVE CONTINUOUS SEGMENT 5 FOR ALL BASED
:ALLOCATIONS. THIS REQUIRES MODIFICATION OF BBFLET.LIB (01/22/85 MIA).

A.DATA	EQ	0			:AREA FOR DATA ALLOCATIONS
A.RING	EQ	0			:AREA FOR ISIS RINGS ALLOCATIONS
APROT0	EQ	6			:EXECUTION PROTECT
A.CODE	EQ	1			:AREA FOR CODE ALLOCATIONS
APROT1	EQ	5			:WRITE PROTECT
A.BDAT	EQ	5			:AREA FOR BASED DATA ALLOCATIONS
APROT3	EQ	6			:EXECUTION PROTECT
:A.BDA1	EQ	8			:AREA FOR BASED DATA ALLOCATIONS
APROT4	EQ	6			:EXECUTION PROTECT
A.RTBL	EQ	A.CODE			:AREA FOR READ ONLY TABLE
A.CMDB	EQ	5			:AREA FOR CMDLST
APROT5	EQ	6			:EXECUTION PROTECT
A.IO0	EQ	4			:AREA FOR SIO BUFFERS
:APROT6	EQ	6			:EXECUTION PROTECT
A.BUFF	EQ	5			:AREA FOR BIG BUFFERLETS
:APROT7	EQ	6			:EXECUTION PROTECT

:	DEFINE PARAMETERS FOR FRNTND
:	----------------------------
ECHO	EQ	0			:TYMSAT SHOULD NOT ECHO
AUTOBP	EQ	0			:NO AUTO-BACKPRESSURE RELEASE CODES
OUTPROC	EQ	1			:OUTPUT ACTIVATION CODES NOT INCLUDED
PTIMEO	EQ	1			:PORT TIMEOUT CODE INCLUDED
	GL	WAITZA
WAITZA	EQ	0			:NO BUFFER ZAPPER

:	DEFINE DEFAULT TIMER
:	---------------------
ONTIME	EQ	$A2			:TIME TO WATCH DSR UP
OFFTIM	EQ	$A32767			:TIME TO LEAVE DTR OFF, IF DSR NEVER DROP
LGINTV	EQ	$A60			:WAIT FOR 60 SEC. - LOGON INTERVAL
LOGTM	EQ	$A30			:CIRCUIT RQ/RSP TIMER
LOGCTM	EQ	$A300			:NETWORK LOGON DRATION TIMER
DCLTIM	EQ	$A30

:	DEFINE 3270 DEVICE SIZES
:	-----------------------
C480	EQ	0			:DEVICE SIZE 480
C960	EQ	1			:DEVICE SIZE 960
C1920	EQ	2			:DEVICE SIZE 1920
C2560	EQ	3			:DEVICE SIZE 2560
C3440	EQ	4			:DEVICE SIZE 3440
C3564	EQ	5			:DEVICE SIZE 3564

:	VENDOR SYSTEMS SUPPORTED
:	------------------------
IBM	EQ	0			:VENDOR SYSTEM - IBM
FUJITSU	EQ	1			:VENDOR SYSTEM - FUJITSU
HITACHI	EQ	2			:VENDOR SYSTEM - HITACHI

:	LANGUAGE SUPPORTED
:	------------------
ENGLISH	EQ	0
KATAKANA EQ	4
KANJI	EQ	5

:	PROTOCOL IDS
:	------------
DSP.TI	EQ	57			:PROTOCOL ID FOR IBM TERMINAL
DSP.HI	EQ	56			:PROTOCOL ID FOR IBM HOST
FNA.TI	EQ	67			:PROTOCOL ID FOR FUJITSU TERMINAL
FNA.HI	EQ	66			:PROTOCOL ID FOR FUJITSU HOST
HNA.TI	EQ	77			:PROTOCOL ID FOR FUJITSU TERMINAL
HNA.HI	EQ	76			:PROTOCOL ID FOR FUJITSU HOST

:	ASCII/EBCDIC CODE SET
:	---------------------
ASCII	EQ	0			:ASCII CODE SET
EBCDIC	EQ	1			:EBCDIC CODE SET

	SUBTTL	(SNA) INIT - UTILITY MACROS


:	DEFINE ERROR & WARNING CODES
:	----------------------------
ERR00	EQ	00			:00 - 
ERR01	EQ	01			:01 - 
ERR02	EQ	02			:02 - 
ERR03	EQ	03			:03 - 
ERR04	EQ	04			:04 - 
ERR05	EQ	05			:05 - 
ERR06	EQ	06			:06 - 
ERR07	EQ	07			:07 - 
ERR08	EQ	08			:08 - 
ERR09	EQ	09			:09 - 
ERR10	EQ	10			:10 - 
ERR11	EQ	11			:11 - 
ERR12	EQ	12			:12 - 
ERR13	EQ	13			:13 - 
ERR14	EQ	14			:14 - 
ERR15	EQ	15			:15 - 
WAN00	EQ	00			:00 - 
WAN01	EQ	01			:01 - 
WAN02	EQ	02			:02 - 
WAN03	EQ	03			:03 - 
WAN04	EQ	04			:03 - 
WAN05	EQ	05			:05 - 
WAN06	EQ	06			:06 - 
WAN07	EQ	07			:07 - 
WAN08	EQ	08			:08 - 
WAN09	EQ	09			:09 - 
WAN10	EQ	10			:10 - 
WAN11	EQ	11			:11 - 
WAN12	EQ	12			:12 - 
WAN13	EQ	13			:13 - 
WAN14	EQ	14			:14 - 
WAN15	EQ	15			:15 - 

.35.	EQ	$A 35
.GT.	MACRO(P1,P2)[((P2)-(P1))^-.35.]
.LT.	MACRO(P1,P2)[((P1)-(P2))^-.35.]
.EQ.	MACRO(P1,P2)[((((P1)-(P2))!((P2)-(P1)))%(1^.35.))^-.35.]

:	DSPNUM(VAL,RDX)
:	---------------
:	TO DISPLAY 'VAL' WITH RADIX 'RDX'
DSPNUM	MACRO(VAL,RDX)[
	IF	.LT.(VAL,0)
	REMARK -
TQ	EQ	$`RDX -VAL
	NUMBER	$`RDX TQ
	ELSE
	NUMBER	$`RDX VAL
	EI
	]

:	DSGEN(STMENT,PRM)
:	-------------------------
:	TO DISPLAY THE SYSGEN STATEMENT, IF DSPGEN IS ON
:	ARGS:	STMENT - STATEMENT KEYWORD
:		PRM - PARAMETER
DSGEN	MACRO(STMENT,PRM)[
:	NOLIST
	KILL	AVALUE,BVALUE
ERRFLG	EQ	0
	IF	DSPGEN
	REMARK	%  STMENT(PRM)
	EI	(DSPGEN)
	LIST
	]

:	DSTMET(STMENT,PRM,PMTYPE,RDX):
:	-------------------------
:	TO DISPLAY THE SYSGEN STATEMENT
:	ARGS:	PMTYPE - TYPE OF PRM (VALUE OR STRING)
:		STMENT - STATEMENT KEYWORD
:		RDX - RADIX FOR PRM1
:		PRM - PARAMETER
PMVALU	EQ	0			:SCALAR TYPE VALUE
PMSTRN	EQ	1			:STRING TYPE
DSTMET	MACRO(STMENT,PRM,PMTYPE,RDX)[
:	NOLIST
	IF	1-PMTYPE
	REMARK	STMENT(
	DSPNUM(PRM,RDX)
	REMARK )
	ELSE
	REMARK	STMENT(PRM)
	EI
	LIST
	]

:	ERROR(ERRTYP,ERRCOD,TEXT,NXTLIN): ERROR
:	-------------------------
:	INCREMENT ERROR COUNT AND DISPLAY STANDARD ERROR MESSAGE HEADER
:	ARGS:	ERRCOD - ERROR CODE
:		TEXT - ERROR MESSAGE TEXT
:		NXTLIN - CONTINUE INTO NEXT LINE
TYPWNG	EQ	0			:WARNING TYPE
TYPERR	EQ	1			:ERROR TYPE
FATCNT	EQ	0			:INITIALIZE ERROR COUNT
WARCNT	EQ	0			:INITIALIZE WARNING COUNT (I01/8/28/87/HS)
ERROR	MACRO(ERRTYP,ERRCOD,TEXT,NXTLIN)[
:	NOLIST
	IF	ERRTYP
FATCNT	EQ	FATCNT+1		:BUMP FATAL ERROR COUNT
ERRFLG	EQ	1			:SET SYSGEN ERROR FLAG
	ELSE
WARCNT	EQ	WARCNT+1		:BUMP WARNING COUNT (I01/8/28/87/HS)
	EI
	REMARK %
QLNENO	LINENO
	IF	ERRTYP
	REMARK	%!!!! 
	NUMBER $A QLNENO
	REMARK	 ** ERROR 
	ELSE
	REMARK	%>>>> 
	NUMBER $A QLNENO
	REMARK	 ** WARNING 
	EI
ERRCDE	EQ	$A ERRCOD
	NUMBER $A ERRCDE
	REMARK  ** TEXT
	IF	NXTLIN 0
	ELSE
	ERREND(ERRTYP)
	EI
	LIST
	]

:	ERRNXT(ERRTYP,TEXT,NXTLIN): NEXT ERROR LINE
:	--------------------
:	GENERATES HEADER FOR ADDITIONAL LINES OF INFORMATION IN STANDARD FORMAT
:	ARGS:	ERRTYP - INDICATE ERROR OR WARNING
:		TEXT - ERROR MESSAGE TEXT
:		NXTLIN - CONTINUE INTO NEXT LINE
ERRNXT	MACRO(ERRTYP,TEXT,NXTLIN)[
:	NOLIST
	IF	ERRTYPE
	REMARK %!!!!
	ELSE
	REMARK %>>>>
	EI
	REMARK  		TEXT
	IF NXTLIN 0
	ELSE
	ERREND(ERRTYP)
	EI
	LIST
	]

:	ERREND(ERRTYP,TEXT): END A LINE OF ERROR MSG
:	------------
:	ENDS A LINE OF ERROR TEXT IN STANDARD FORMAT
:	ARGS:	ERRTYP - ERROR OR WARNING
ERREND	MACRO(ERRTYP,TEXT)[
:	NOLIST
	IF	ERRTYP
	REMARK	 TEXT !!!!%
	ELSE
	REMARK	 TEXT <<<<%
	EI
	LIST
	]

:	RNGCHK(ERRTYP,STMENT,PRM,PMTYPE,RX,MIN,MAX,DFLT,PARM)
:	------------------------------------------
:	CHECK RANGE OF ARGUMENT VALUE, ISSUE ERROR/WARNING IF OUT OF RANGE
:	CANNOT HANDLE MIN, MAX, AND ARG ALL NEGATIVE
:	ARGS:	ERRTYP - DESIRED TYPE OF ERROR MSG IF ERROR
:		RX	- RADIX OF NUMBER ARG
:		MAX	- MAXXIMUM VALUE OF ARG (IN RADIX RX)
:		MIN	- MINIMUM VALUE OF ARG (IN RADIX RX)
:		STMENT - SYSGEN STATEMENT
:		PRM	- NUMBER TO BE CHECKED
:		PMTYPE - PARAMETER TYPE
:		PARM - SYMBOL FOR THE PARAMETER
:		DFLT  - DEFAULT VALUE
RNGCHK	MACRO(ERRTYP,STMENT,PRM,PMTYPE,RX,MIN,MAX,DFLT,PARM)[
:	NOLIST
QE	ERRCNT
QQ	EQ	PRM
QQQ	ERRCNT
	IF QQQ-QE
	ERROR(TYPERR,ERR00,Radix Error,1)
	ERRNXT(TYPERR,,1)
:	DSTMET(STMENT,PRM,PMTYPE,RX)			(I01/8/28/87/HS)
	DSTMET(STMENT,PRM,PMSTRN,RX)			:(I01/8/28/87/HS)
	ELSE				:(QQQ-QE)
QMIN	EQ $`RX MIN
QMAX	EQ $`RX MAX
	IF .LT.(QQ,QMIN)!.GT.(QQ,QMAX)
	IF	ERRTYP
	ERROR(TYPERR,ERR02,Value Out of Range,1)	:(I01/8/28/87/HS/BEGIN)
	REMARK	 {
	DSPNUM(MIN,RX)
	REMARK	,
	DSPNUM(MAX,RX)
	REMARK	}					
:							(I01/8/28/87/HS/END)
	ERRNXT(TYPERR,,1)
	DSTMET(STMENT,PRM,PMTYPE,RX)
	ELSE				:ERRTYP
	ERROR(TYPWNG,WAN01,Value Out of Range,1)
	REMARK	 {
	DSPNUM(MIN,RX)
	REMARK	,
	DSPNUM(MAX,RX)
	REMARK	}
	REMARK	,Default Value Assumed
	ERRNXT(TYPWNG,,1)
PARM	EQ	$`RX DFLT
	DSTMET(STMENT,PRM,PMTYPE,RX)
	REMARK	  -->>  
	DSTMET(STMENT,DFLT,PMTYPE,RX)
	EI				:ERRTYP
	ELSE				:COMPARE
PARM	EQ	QQ
	EI				:COMPARE
	EI				:QQQ-QE
	KILL	Q,QQ
	LIST
	]

:	PMPRCK(ERRTYP,STMENT,PRM,PMTYPE,RDX,DFLT,PARM): PARM PRESENT CHECKING
:	---------------
:	CHECKS TO SEE IF PARAMETER EXISTS OR NOT, ISSUES WARNING/ERROR IF NOT
:	ARGS:	STMENT - SYSGEN STATMENT KEYWORD
:		PMTYPE - PARAMETER TYPE
:		RDX - RADIX
:		PRM - PARAMETER
:		DFLT - DEFAULT, IF NOT PRESENT
:		PARM - NEW SYMBOL FOR THE PARAMETER
:		ERRTYP - ERROR OR WARNING
PMPRCK	MACRO(ERRTYP,STMENT,PRM,PMTYPE,RDX,DFLT,PARM)[
:	NOLIST
	ORG	0
	AC	/PRM/
IZ	EQ	.
	ORG	0
	IF	1-IZ
	IF	ERRTYP
	ERROR(TYPERR,ERR05, Parameter must be specified,1)
	ERRNXT(TYPERR,,1)
	ELSE
	KILL	PARM
PARM	EQ	$`RDX DFLT
	ERROR(TYPWNG,WNG05, Parameter missing Default Value Assumed,1)
	ERRNXT(TYPWNG,,1)
	EI
:	DSTMET(STMENT,PRM,PMTYPE,RDX)			(I01/8/28/87/HS)
	DSTMET(STMENT,PRM,PMSTRN,RDX)			:(I01/8/28/87/HS)
	ERREND(ERRTYP)
	ELSE
	IF	1-PMTYPE
PARM	EQ	$`RDX PRM
	EI	(1-PMTYPE)
	EI
	LIST
	]

SYSLVL	EQ	1			:SYSTEM LEVEL
MONLVL	EQ	2			:MONITOR LEVEL
MONSLV	EQ	3			:MONITOR SUB LEVEL
GENLVL	EQ	4			:GENERAL DEFAULT LEVEL
GENSLV	EQ	5			:GENERAL DEFAULT SUBL LEVEL
MENLVL	EQ	6			:MENU DEFINITION LEVEL
MENSLV	EQ	7			:MENU SUB LEVL
LGMLVL	EQ	8			:LOGON MENU DEFINITION LEVEL
LGMSLV	EQ	9			:LOGON MENU SUB LEVEL
LGMSSL	EQ	0A			:LOGON MENU SUB SUB LEVEL
LINLVL	EQ	0B			:LINE LEVEL
LINSLV	EQ	0C			:LINE SUB LEVEL
PULVL	EQ	0D			:PU LEVEL
PUSLVL	EQ	0E			:PU SUB LEVEL
LULVL	EQ	0F			:LU LEVEL
LUSLVL	EQ	10			:LU SUB LEVEL
LUSSLV	EQ	11			:LU SUB SUB LEVEL
LSMSSL	EQ	LUSSLV			:LSMSSL = LU SUB SUB LEVEL
LPVSSL	EQ	LUSSLV			:LPVSSL = LU SUB SUB LEVEL
CURLVL	EQ	0			:CURRENT LEVEL

:	LVLCHK(MACLVL,STMENT,PRM)
:	-------------------------
:	TESTS LEVEL OF MACRO AGAINST CURRENT LEVEL
:	ARGS:	STMENT - SYSGEN STATEMENT
:		PRM - PARAMETER
:		MACLVL - MACRO'S LEVEL
LVLCHK	MACRO(MACLVL,STMENT,PRM)[
:	NOLIST
	IF	.LT.(MACLVL,CURLVL)
	ERROR(TYPERR,ERR07,Sysgen Statement not at Correct Level,1)
	ERRNXT(TYPERR,,1)
	DSTMET(STMENT,PRM,PMSTRN)
	ERREND(TYPERR)
	ELSE
CURLVL	EQ	MACLVL
	EI
	LIST
	]

:	PREQMC(PREQST,PREQMF,PREQEI,STMENT,PRM)
:	--------------------------
:	TESTS IF THE PRE-QUISITIVE MACRO STATMENT HAS BEEN DEFINED
:	ARGS:
:		PREQST - PRE-QUISITIVE MACRO STATEMENT
:		PREQMF - PRE-QUISITIVE MACRO INDICATOR
:		PREQEI - PRE-QUISITIVE MACRO ERROR INDICATOR
:		STMENT - SYSGEN STATEMENT
:		PRM    - PARAMETER
PREQMC	MACRO(PREQST,PREQMF,PREQEI,STMENT,PRM)[		:(I01/8/28/87/HS)
:	NOLIST
	IF	1-PREQMF
	IF	1-PREQEI				:(I01/8/28/87/HS/BEGIN)
	ERROR(TYPERR,ERR08,Pre-Requested Macro Not Definied,1)
	ELSE
	ERROR(TYPERR,ERR08,Error In Pre-Requested Macro Definition,1) 
	EI				:(1-PREQEI)	(I01/8/28/87/HS/END)
	ERRNXT(TYPERR,,1)
	DSTMET(PREQST,,PMSTRN)
	REMARK	  Before  
	DSTMET(STMENT,PRM,PMSTRN)
	ERREND(TYPERR)
	EI
	LIST
	]

:	ABORT(): ABORT ASSEMBLY
:	-------
:	PRINTS COUNT OF WARNINGS AND ERRORS, WILL ABORT
:	ASSEMBLY IF ASSEMBLY/FATAL SYSGEN ERROR COUNT > 0
:	ARGS:	NONE
ABORT   MACRO[
:	NOLIST
Q	ERRCNT				:Q = ASSEMBLY ERROR COUNT
	IF WARCNT+FATCNT+Q
	REMARK	%***********************************************************
	REMARK	%***********************************************************
	IF WARCNT
		REMARK	%**** 
		NUMBER $A WARCNT
		REMARK  NON-FATAL WARNING(S) encountered during assembly
	EI (WARCNT)
	IF FATCNT
		REMARK	%**** 
		NUMBER $A FATCNT
		REMARK  FATAL ERROR(S) encountered during assembly
	EI (FATCNT)
	IF Q
		REMARK	%**** 
		NUMBER $A Q
		REMARK  ASSEMBLY ERROR(S) encountered during assembly
	EI(Q)
	REMARK	%***********************************************************
	REMARK	%***********************************************************
	IF FATCNT+Q
		QUIT FATCNT+Q	:QUIT IF FATAL SYSGEN ERRORS
	EI (FATCNT+Q)
	EI (WARCNT+FATCNT+Q)
	LIST
	]
	SUBTTL ** SNA INIT ** INITIALIZATION FILE - CONTROL DIRECTIVES


:	IF DSPGEN IS DEFINED TO BE ONE, THEN THE CONFIGURATION
:	STATEMENTS WILL BE LISTED.
:	NOTE: WHEN DSPGEN IS ENABLED, THE NOPRINT SWITCH SHOULD
:	BE SET, OTHERWISE THE CONFIGURATION STATEMENTS WILL
:	DISPERSEING ON A CONFIGURATISTING.
	GL	DSPGEN
	IF	1-\DSPGEN
DSPGEN	EQ	0
	EI	(1-\DSPGEN)

:	DSPSYGEN(): DISPLAY SYSGEN
:	TO TURN ON THE DISPLY SWITCH FOR THE LISTING OF CONFIGURATION LISTING
:	ARGS:	NONE
DSPSYSGEN	MACRO[
:	NOLIST
	REMARK	%DSPSYSGEN
	REMARK	%
	KILL	DSPGEN
DSPGEN	EQ	1			:TURN ON THE DISPLY SWITCH
	LIST
	]

:	PRINT(): PRINT CONFIGURATION INFORMATION
:	TO TURN ON THE DISPLY SWITCH FOR THE LISTING OF CONFIGURATION LISTING
:	ARGS:	NONE
DISPLY	EQ	1			:DEFALUT YES
PRINT	MACRO[
:	NOLIST
	DSGEN(PRINT)
	KILL	DISPLY
DISPLY	EQ	1			:TURN ON THE DISPLY SWITCH
	LIST
	]

:	NOPRINT(): NO LISTING OF SYSGEN INFO.
:	--------
:	TO TURN OFF THE DISPLY SWITCH FOR THE LISTING OF CONFIGURATION LISTING
:	ARGS:	NONE
NOPRINT	MACRO[
:	NOLIST
	DSGEN(NOPRINT)
	KILL	DISPLY
DISPLY	EQ	0			:TURN OFF THE DISPLY SWITCH
	LIST
	]

:	BEGINTYM: BEGINING OF TYMFILE PARAMETERS
:	---------
:	TO DENOTE THE BEGINING OF A TYMFILE, AND PRINT
:	THE TITLE OF THE CONFIGURATION LISTING.
:	ARGS:	NONE
BEGINTYM	MACRO[
:	NOLIST
	REMARK	%%***********************************************************%%
	REMARK       *****  S   N   A       I N T E R F A C E  *****
	REMARK	%%                  Version  
	NUMBER	VERSION
	REMARK     Revlev  
	NUMBER	REVLEV
	DSPDAT
	DSGEN(BEGINTYM)
	LIST
		]

:	ENDTYM: END OF TYMFILE
:	-----------
:	TO DENOTE HTE END OF A TYMFILE, AND PERFORM THE
:	SYSGEN CONSISTENCY CHECKINGS.
:	ARGS:	NONE
ENDTYM	MACRO[
:	NOLIST
	DSGEN(ENDTYM)
	REMARK	%%***********************************************************%%
:	ASSIGN DEFAULTS TO LINE PARAMETERS, IF NOT DEFINED BY USER

	ABORT()						:(I01/8/28/87/HS)

Q	EQ	0
	RE	NSLINE
	IF	LINK|Q|
TERMIF	EQ	1
	ELSE
HOSTIF	EQ	1
	EI
	IF	(1-\SHOS|Q|)&(1-LINK|Q|);SHOS|Q|	EQ	G.HOST;	EI
:	CONSISTENCY CHECKING FOR LINE LEVEL MACROS
	IF	\SHOS|Q|&LINK|Q|
	ERROR(TYPERR,ERR00,Host Defined for Terminal Line,1)
	ERRNXT(TYPERR,,1)
	REMARK	Line - 
	NUMBER	$A Q
	ERREND(TYPERR)
	EI	(\SHOS|Q|&LINE|Q|)
QP	EQ	0
	RE	MSTN|Q|
	IF	1-\IPTY|Q||QP|
IPTY|Q||QP|	EQ	G.IPTY
	EI
QP	EQ	QP+1
	ER
Q	EQ	Q+1
	ER
:	IF	TERMIF&HOSTIF
:	ERROR(TYPERR,ERR00,Termif and Hostif can not be in the same slot,1)
:	ERREND(TYPERR)
:	EI
:
: (F01/11/20/87-10/21/87/HS/START)
	IF	\HDPSUP
	 IF	HDPSUP
	  IF	HOSTIF			:IF NO SECONDARY LINES ARE DEFINED
	  ELSE				:THEN CANNOT HAVE HDSP SUPPORT
HDPSUP	EQ	NO
	  EI
	 EI
	EI

	IF	\VTISUP
	 IF	VTISUP
	  IF	TERMIF
	  ELSE
VTISUP	EQ	NO
	  EI
	 EI
	EI

: (F01/11/20/87-10/21/87/HS/END)
	KILL	ACTIVE,INACTIVE
	LIST
	]

	SUBTTL ** SNA INIT ** INITIALIZATION - NETWORK AND ISIS STATEMENTS


:	FREEZE(FRZARG): FREEZE WHEN CRASH
:	---------------
:	TO DEFINE CTSTOP TO 1, THIS WILL FREEZE THE SLOT WHEN SLOT CRASH.
:	ARGS:	FRZARG	-YES/NO
YES	EQ	1
NO	EQ	0
FREEZE	MACRO(FRZARG)[
:	NOLIST
	DSGEN(FREEZE,FRZARG)
	LVLCHK(SYSLVL,FREEZE,FRZARG)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,FREEZE,FRZARG,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,FREEZE,AVALUE,PMVALU,A,0,1,0,BVALUE)
CRSTOP	EQ	BVALUE			:SET TO DEFINED VALUE
	IF	DISPLY
	REMARK	%  Slot Action When Crash          = 
	IF	CRSTOP
	REMARK	Stop/Halt
	ELSE
	REMARK	Continue
	EI	(CRSTOP)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	LIST
	]

:	TIMEZONE(TFACTR): TIMEZONE CORRECTION
:	TO SPECIFY THE TIMEZONE CORRECTION FACTOR FROM
:	COORDINATED UNIVERSAL TIME. FOR EXAMPLE, THE
:	TIME-ZONE CORRECTION VALUE FOR PST IS -8.
:	ARGS:	TFACTR	-TIME-ZONE CORRECTION FACTOR
	GL	TIMZON
TIMZON	EQ	-8		:DEFAULT IS PST
TIMEZONE	MACRO(TFACTR)[
:	NOLIST
	KILL	TIMZON
	DSGEN(TIMEZONE,TFACTR)
	LVLCHK(SYSLVL,TIMEZONE,TFACTR)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,TIMEZONE,TFACTR,PMVALUE,A,-8,AVALUE)
	RNGCHK(TYPWNG,TIMEZONE,AVALUE,PMVALU,A,-23,23,-8,BVALUE)
TIMZON	EQ	BVALUE
	IF	DISPLY
	REMARK	%  The Time-Zone Correction Factor = 
	IF	TIMZON
	NUMBER	$A TIMZON
	ELSE
	REMARK	-
TQ	EQ	-TIMZON
	NUMBER	$A TQ
	EI	TIMZON
	EI	(DISPLY)
	EI	(1-ERRFLG)
	LIST
	]

:	ISIRING(VALUE): ISIS IRING SIZE
:	----------
:	TO SPECIFY THE IRSIZE OF ISIS DISPATCHER INPUT RING
:	THE VULE SPECIFIED SHOULD BE A MULTIPLE OF FOUR
:	ARGS:	VALUE	-IRSIZE OF INPUT RING
IRSIZE	EQ	$A4092		:DEFAULT SIZE
ISIRING	MACRO(VALUE)[
:	NOLIST
	KILL	IRSIZE
	DSGEN(ISIRING,VALUE)
	LVLCHK(SYSLVL,ISIRING,VALUE)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,ISIRING,VALUE,PMVALU,A,4092,AVALUE)
	RNGCHK(TYPWNG,ISIRING,AVALUE,PMVALU,A,256,8196,4092,BVALUE)
IRSIZE	EQ	BVALUE
IRSIZE	EQ	IRSIZE&0FFFC
	IF	1-.EQ.(IRSIZE,BVALUE)
	ERROR(TYPWNG,ERR00,Value Is Adjusted,1)
	ERRNXT(TYPWNG,,1)
	REMARK	ISIRING(VALUE)
	REMARK	 -->> 
	DSTMET(ISIRING,IRSIZE,PMVALU,A)
	EI
	IF	DISPLY
	REMARK	%  IRSIZE of Input Ring            = 
	NUMBER	$A IRSIZE
	REMARK	 Bytes
	EI	(DISPLY)
	EI	(1-ERRFLG)
	LIST
	]

:	ISORING(VALUE): ISIS ORING SIZE
:	----------
:	TO SPECIFY THE ORSIZE OF ISIS DISPATCHER OUTPUT RING
:	THE VULE SPECIFIED SHOULD BE A MULTIPLE OF FOUR.
:	ARGS:	VALUE	-ORSIZE OF OUTPUT RING
ORSIZE	EQ	$A4092		:DEFAULT SIZE
ISORING	MACRO(VALUE)[
:	NOLIST
	KILL	ORSIZE
	DSGEN(ISORING,VALUE)
	LVLCHK(SYSLVL,ISORING,VALUE)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,ISORING,VALUE,PMVALU,A,4092,AVALUE)
	RNGCHK(TYPWNG,ISORING,AVALUE,PMVALUE,A,256,8196,4092,BVALUE)
ORSIZE	EQ	BVALUE
ORSIZE	EQ	ORSIZE&0FFFC
	IF	1-.EQ.(ORSIZE,BVALUE)
	ERROR(TYPWNG,ERR00,Value Is Adjusted,1)
	ERRNXT(TYPWNG,,1)
	REMARK	ISORING(VALUE)
	REMARK	 -->> 
	DSTMET(ISORING,ORSIZE,PMVALUE,A)
	EI
	IF	DISPLY
	REMARK	%  ORSIZE of Output Ring           = 
	NUMBER	$A ORSIZE
	REMARK	 Bytes
	EI	(DISPLY)
	EI	(1-ERRFLG)
	LIST
	]

:	BUFSIZE(VALUE): BIG BUFFERLET SIZE
:	---------------
:	TO SPECIFY THE BUFFER SIZE FOR THE INTERNAL BIG
:	BUFFERLETS. THE SIZE OF THE BIF-BUFFERLETS SHOULD
:	BE SET TO BE ABLE TO BEST UTILIZE THE SPACES.
:	ARGS:	VALUE	- BIG-BUFFLERLET SIZE
BUFSIZE	MACRO(VALUE)[
:	NOLIST
	KILL	BBFLSZ
	DSGEN(BUFSIZE,VALUE)
	LVLCHK(SYSLVL,BUFSIZE,VALUE)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,BUFSIZE,VALUE,PMVALU,A,80,AVALUE)
	RNGCHK(TYPWNG,BUFSIZE,AVALUE,PMVALU,A,80,256,80,BVALUE)
BBFLSZ	EQ	BVALUE
	IF	DISPLY
	REMARK	%  Size of Big-Bufferlet           = 
	NUMBER	$A BBFLSZ
	REMARK	 Bytes
	EI	(DISPLY)
	EI	(1-ERRFLG)
	LIST
	]

:	PSEUDO.HOST(PDHOST)
:	--------------------
:	TO SPECIFY THE PSEUDO HOST # FOR THIS SNA
:	INTERFACE, IF THIS INTERFACE CONTAINS TERMINAL PORTS ONLY
:	ARGS:	PDHOST	- PSEUDO HOST #
PSDHOS	EQ	4000			:DEFAULT IS 4000
PSEUDO.HOST	MACRO(PDHOST)[
:	NOLIST
	KILL	PSDHOS
	DSGEN(PSEUDO.HOST,PDHOST)
	LVLCHK(SYSLVL,PSEUDO,HOST,PDHOST)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,PSEUDO.HOST,PDHOST,PMVALU,A,4000,AVALUE)
	RNGCHK(TYPWNG,PSESUDO.HOST,AVALUE,PMVALU,A,1,9999,4000,BVALUE)
PSDHOS	EQ	BVALUE
	IF	DISPLY
	REMARK	%  Pseudo Host # for this Slot     = 
	NUMBER	$A PSDHOS
	EI	(DISPLY)
	EI	(1-ERRFLG)
	LIST
	]

:	(5/10/85/CHS)
:	MSIOTP(GARG)
:	------------
:	TO SPECIFY THAT SIO MICRO CODE VERSION 'GARG' OR LATER IS USED
:	ARGS:	GARG	- M.TYP0, M.TYP1
:	FOR VERSION A TO D , SPECIFY AS M.TYP0
:	FOR VERSION E AND LATER, SPECIFY AS M.TYP1
SIOEVR	EQ	NO			:DEFAULT IS NO
M.TYP0	EQ	0
M.TYP1	EQ	1
MSIOTP	MACRO(GARG)[
:	NOLIST
	DSGEN(MSIOTP,GARG)
	LVLCHK(SYSLVL,MSIOTP,GARG)
	IF	1-ERRFLG
	PMPRCK(TYPERR,MSIOTP,GARG,PMSTRN)
	IF	1-ERRFLG
	IF	GARG-1
	ERROR(TYPERR,ERR11,Illegal Parameter Value,1)
	ERRNXT(TYPERR,,1)
	REMARK	MSIOTP(GARG)
	ERREND(TYPERR)
	ELSE
	IF	.EQ.(GARG,1)
SIOEVR	EQ	YES
	REMARK	%  SIO Microcode Version Required  = E or Later
	EI
	EI	(GARG-1)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	]

:	SNAFEATURE(GARG)
:	------------
:	TO SPECIFY THAT WHAT KIND OF FEATURES THE SNA INTERFACE SUPPORTED
:	ARGS:	GARG	- "NATIVE","HDSP","TDSP", ETC.
SNAFEATURE	MACRO(GARG)[
:	NOLIST
NATIVE	EQ	0
HDSP	EQ	1
TDSP	EQ	2
	DSGEN(SNAFEATURE,GARG)
	LVLCHK(SYSLVL,SNAFEATURE,GARG)
	IF	1-ERRFLG
	PMPRCK(TYPERR,SNAFEATURE,GARG,PMVALU,A,0,AVALUE)
	RNGCHK(TYPERR,SNAFEATURE,AVALUE,PMVALU,A,0,2,0,BVALUE)
	IF	BVALUE&TDSP
	ELSE
	IF	BVALUE&HDSP
HDPSUP	EQ	YES
	ELSE
	EI	(BVALUE&HDSP)
	EI	(BVALUE&TDSP)

	EI	(1-ERRFLG)
	]

	SUBTTL ** SNA INIT ** INITIALIZAION - MONITOR STATEMENTS


:	MONITOR(MHOST)
:	---------------
:	TO SPECIFY THAT THIS SNA INTERFACE HAS
:	MONITOR FUNCTION INCLUDED, AND AT THE SAME TIME
:	DEFINE THE MONITOR HOST #
:	ARGS:	MHOST #	- MONITOR HOST NUMBER
	GL	MONTOR
MONTOR	EQ	0			:ASSEMBLE SWITCH FOR MONITOR MODULE
MONPRT	EQ	0
NHOST	EQ	0			:INIT NHOST TO 0
DMNPRT	EQ	$A 3			:DEFAULT NUMBER OF MONITOR PORTS
MN.MAC	EQ	0			:INIT MONITOR MACRO DEFINED INDICATOR
MONITOR	MACRO(MHOST)[
:	NOLIST
MONTOR	EQ	1			:INDICATE MONITOR INCLUDED
MN.ERR	EQ	1			:PRESET ERR CONDITION (I01/8/28/87/HS)
	DSGEN(MONITOR,MHOST)
	IF	DISPLY
	REMARK	%%**********************************************************
	EI	(DISPLY)
	LVLCHK(MONSLV,MONTOR,MHOST)
	IF	1-ERRFLG
	PMPRCK(TYPERR,MONITOR,MHOST,PMVALU,A,,AVALUE)
	IF	1-ERRFLG
	RNGCHK(TYPERR,MONITOR,AVALUE,PMVALU,A,1,9999,,BVALUE)
	IF	1-ERRFLG
HOST|NHOST|	EQ	$A MHOST
HPRT|NHOST|	EQ	DMNPRT
MONPRT	EQ	DMNPRT
MNTRVL	EQ	1
MN.MAC	EQ	1			:MONITOR MACRO DEFINED
MN.ERR	EQ	0			:RESET ERR CONDITION (I01/8/28/87/HS)
	IF	DISPLY
	REMARK %%  Monitor With Host Number 
	NUMBER  $A HOST|NHOST|
	EI	DISPLY
NHOST	EQ	NHOST+1
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	MPORTS(MPORTT)
:	-------------
:	TO SPECIFY THE NUMBER OF MONITOR PORTS DESIRED.
:	ARGS:	MPORTT	- TOTAL NUMBER OF MONITOR PORTS.
MPORTS	MACRO(MPORTT)[
:	NOLIST
	KILL	MONPRT,HPRT0
	DSGEN(MPORTS,MPORTT)
	LVLCHK(MONSLV,MPORTS,MPORTT)
	IF	1-ERRFLG
	PREQMC(MONITOR,MN.MAC,MN.ERR,MPORTS,MPORTT)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,MPORTS,MPORTT,PMVALU,A,3,AVALUE)
	RNGCHK(TYPWNG,MPORTS,AVALUE,PMVALU,A,1,8,3,BVALUE)
	IF	1-ERRFLG				:(I01/8/28/87/HS)
MONPRT	EQ	BVALUE
HPRT|NHOST-1|	EQ	MONPRT
	IF	DISPLY
	REMARK %    Number of Monitor Ports = 
	NUMBER	$AMONPRT
	IF	MONPRT-1
	REMARK	 Ports
	ELSE
	REMARK	 Port
	EI	(MONPRT-1)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)			:(I01/8/28/87/HS)
	EI	(1-ERRFLG)
	LIST
	]

:	MUPD.INTERVAL(UVALUE)
:	----------------------
:	TO SPECIFY THE REFRESH INTERVAL IN  MINUTES FOR
:	THE MONITOR TO REFRESH ITS DISPLAY/PRINT.
:	ARGS:	UVALUE	- INTERVAL IN MINUTES.
MUPD.INTERVAL	MACRO(UVALUE)[
:	NOLIST
	KILL	MNTRVL
	DSGEN(MUPD.INTERVAL,UVALUE)
	LVLCHK(MONSLV,MUPD.INTERVAL,UVALUE)
	IF	1-ERRFLG
	PREQMC(MONITOR,MN.MAC,MN.ERR,MUPD.INTERVAL,UVALUE) :(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,MUPD.INTERVAL,UVALUE,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,MUPD.INTERVAL,AVALUE,PMVALU,A,1,1000,1,BVALUE)
MNTRVL	EQ	BVALUE
	IF	DISPLY
	REMARK %    Refresh Interval        = 
	NUMBER	$A MNTRVL
	REMARK	 Min.
	EI	DISPLY
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	MBUFQA(MVALUE)
:	---------------
:	TO SPECIFY THE OUTPUT BUFFER QUOTA FOR EACH MONITOR OUTPUT PORT
:	ARGS:	MVALUE	- NUMBER OF BUFFER PER PORT
MBUFQA	MACRO(MVALUE)[
:	NOLIST
	DSGEN(MBUFQA,MVALUE)
	LVLCHK(MONSLV,MBUFQA,MVALUE)
	IF	1-ERRFLG
	PREQMC(MONITOR,MN.MAC,MN.ERR,MBUFQZ,MVALUE)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,MBUFQA,MVALUE,PMVALU,A,10,AVALUE)
	RNGCHK(TYPWNG,MBUFQA,AVALUE,PMVALUE,A,2,20,10,BVALUE)
	IF	1-ERRFLG				:(I01/8/28/87/HS)
MONBQA	EQ	BVALUE	
	IF	DISPLY
	REMARK %    Monitor Output BB Quota = 
	NUMBER	$A MONBQA
	REMARK	 Buffers
	EI	DISPLY
	EI	(1-ERRFLG)				:(I01/8/28/87/HS)
	EI	(1-ERRFLG)	
	EI	(1-ERRFLG)
	LIST
	]

:	MLOG.TBL(MLOGSZ)
:	-----------------
:	TO SPECIFY THE NUMBER OF ENTRYIES OF MONITOR LOG TABLE.
:	ARGS:	MLOGSZ	- NUMBER OF ENTRIES
MLOGEN	EQ	$A 50			:DEFAULT 50 ENTRIES
MLOG.TBL	MACRO(MLOGSZ)[
:	NOLIST
	DSGEN(MLOG.TBL,MLOGSZ)
	LVLCHK(MONSLV,MLOG.TBL,MLOGSZ)
	IF	1-ERRFLG
	PREQMC(MONITOR,MN.MAC,MN.ERR,MLOG.TBL,MLOGSZ)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,MLOG.TBL,MLOGSZ,PMVALU,A,50,AVALUE)
	RNGCHK(TYPWNG,MLOG.TBL,AVALUE,PMVALU,A,5,100,50,BVALUE)
	KILL	MLOGEN
MLOGEN	EQ	$A BVALUE
	IF	DISPLY
	REMARK %    LOG Table Entries       = 
	NUMBER	$A MLOGEN
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	MUSER.TBL(MUSRSZ)
:	-----------------
:	TO SPECIFY THE NUMBER OF ENTRYIES OF MONITOR USER TABLE.
:	ARGS:	MUSRSZ	- NUMBER OF ENTRIES
MUSREN	EQ	$A 10			:DEFAULT 10 USERS
MUSR.TBL	MACRO(MUSRSZ)[
:	NOLIST
	DSGEN(MUSR.TBL,MUSRSZ)
	LVLCHK(MONSLV,MUSR.TBL,MUSRSZ)
	IF	1-ERRFLG
	PREQMC(MONITOR,MN.MAC,MN.ERR,MUSR.TBL,MUSRSZ)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,MUSR.TBL,MUSRSZ,PMVALU,A,10,AVALUE)
	RNGCHK(TYPWNG,MUSR.TBL,AVALUE,PMVALU,A,5,20,10,BVALUE)
	KILL	MUSREN
MUSREN	EQ	BVALUE
	IF	DISPLY
	REMARK %    USER Table Entries      = 
	NUMBER	$A MUSREN
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	MGOODGUY(MUSER)
:	-----------------
:	TO SPECIFY THE USER'S NAMES WHO ARE AUTHORIZED TO
:	ACCESS THE SNA MONITOR HOST.
:	ARGS:	MUSER	- USER'S NAME				:
MNUSER	EQ	0			:INIT TO NO USER NAME
MGOODGUY	MACRO(MUSER)[
:	NOLIST
	DSGEN(MGOODGUY,MUSER)
	LVLCHK(MONSLV,MGOODGUY,MUSER)
	IF	1-ERRFLG
	PREQMC(MONITOR,MN.MAC,MN.ERR,MGOODGUY,MUSER)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,MGOODGUY,MUSER,PMSTRN)
	IF	1-ERRFLG
	IF	MUSREN-MNUSER
	IF	DISPLY
	IF	1-MNUSER
	REMARK	%    Monitor Goodguy List   =  
	REMARK	MUSER
	ELSE	(MNUSER-MNUSER/4*4)
	REMARK	 , MUSER
	ELSE
	REMARK	%                              
	REMARK	MUSER
	EI	(1-MNUSER)
	EI	(DISPLY)
MUSR|MNUSER|	MACRO[
	AC	/`MUSER`/
	]
MNUSER	EQ	MNUSER+1
	ELSE
	ERROR(TYPWNG,ERR07,Table Overflow,1)
	ERRNXT(TYPWNG,,1)
	REMARK	MGOODGUY(MUSER)
	ERREND(TYPWNG)
	EI	(MUSREN-MNUSER)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

	SUBTTL ** SNA INIT ** SYSTEM DEFAULTS


:	INIT ASSEMBLE SWITCHES
:	----------------------
TERMIF	EQ	0
HOSTIF	EQ	0

:	INIT MACRO DEFINED INDICATOR
:	-----------------------------
GN.MAC	EQ	0			:INIT GENERAL NOT DEFINED
NS.MAC	EQ	0			:INIT NETWORK SERVICE NOT DEFINED
LG.MAC	EQ	0			:INIT LOGON SELECTION NOT DEFINED
LN.MAC	EQ	0			:INIT LINE DEFINED INDICATOR
PU.MAC	EQ	0			:INIT PU DEFINED INDICATOR
LU.MAC	EQ	0			:INIT LU DEFINED INDICATOR
PV.MAC	EQ	0			:INIT LU PVC NOT DEFINED
ET.MAC	EQ	0			:INIT LU LOGON.SEL NOT DEFINED

:	LINK LEVEL DEFAULTS
:	---------------------
G.LINK	EQ	1			:DEFAULT IS PRIMARY GROUP
G.SPED	EQ	9600			:DEFAULT SPEED IS 9600
G.MODE	EQ	1			:DEFAULT IS HALF-DUPLEX
G.DIAL	EQ	1			:DEFAULT IS CONNECTED TO DIAL PORT
G.SDTR	EQ	1			:DEFAULT DTR/DSR REQUIRED
G.SRTS	EQ	1			:DEFAULT RTS/CTS REQUIRED
G.IATM	EQ	0		:DEFAULT LINK INACTIVITY IS NON-TIMEOUT
G.DSTM	EQ	5		:DEFAULT LINK OFFTIME IS 5 SEC
G.RPTM	EQ	3			:DEFAULT REPLY TIMEOUT IS 3 SEC.
G.FRMS	EQ	$A 270			:DEFAULT FRAME SIZE IS 270 BYTES
G.WDWS	EQ	7			:DEFAULT WINDWO SIZE IS 7
G.RTYM	EQ	7			:DEFAULT RETRIES.M
G.RTYT	EQ	0			:DEFAULT RETRIES.T
G.RTYN	EQ	0			:DEFAULT RETRIES.N
G.PAUS	EQ	1			:DEFAULT POLLING PAUSE IS ONE SEC.
G.ISTS	EQ	0			:DEFAULT ISTATUS IS ACTIVE
G.RFRN	EQ	8			:DEFAULT # of SIO RCV FRM IS 8
G.SIOH	EQ	0			:DEFAULT TYPE OF SIO DAUGHTER CARD IS 0
G.SRUC	EQ	0			:DEFAULT TO SINGLE RU CHAIN(I3.01/8/19/87/ACH)
G.SDLC	EQ	0			:DEFAULT TO SDLC(I3.01/8/19/87/ACH)
G.CLR	EQ	0			:DEFAULT TO CLEAR(I3.01/8/19/87/ACH)

:	PU LEVEL DEFAULTS
:	-----------------
G.IPTY	EQ	4			:DEFAULT INTERNAL PUTYPE IS TYPE 2
G.EPTY	EQ	2			:DEFAULT EXTERNAL PUTYPE IS TYPE 2
G.EXTS	EQ	0			:DEFAULT EXTERNAL PU SYSTEM IS IBM
G.CHST	EQ	0			:DEFAULT PU LANGUAGE IS ENGLISH

:	LU LEVEL DEFAULTS
:	-------------------
G.LUTY	EQ	2			:DEFAULT LUTYPE IS TYPE 3
G.COLOR	EQ	0			:DEFAULT IS NO COLOR
G.SIZE	EQ	C1920			:DEFAULT IS 1920
G.PVC	EQ	0			:DEFAULT IS NOT PVC
G.ITIM	EQ	0			:DEFAULT IS NO INACT TO (10/3/84 MIA)
G.ATIM	EQ	0			:DEFAULT IS NO APPL TO (10/3/83 MIA)

:	LU.PVC LEVEL DEFAULTS
:	---------------------
G.PVDL	EQ	-1			:DEFAULT IS WILD CARD
G.PVPU	EQ	-1			:DEFAULT IS WILD CARD
G.PVLU	EQ	-1			:DEFAULT IS WILD CARD
G.PVLT	EQ	02			:DEFAULT IS LU TYPE 2
G.PVCO	EQ	0			:DEFAULT IS NO COLOR
O.PVSZ	EQ	C1920			:DEFAULT IS 1920
LVL	EQ	0			:INIT LVL
CLGLVL	EQ	0			:INIT CLGLVL

:	GENERAL():
:	-----------
:	TO SIGNIFY THE STARTING OF THE DEFINITION FOR THE GENERAL
:	CUSTOMIZED DEFAULTS
GENERAL	MACRO[
:	NOLIST
GN.ERR	EQ	1			:PRESET ERR CONDITION (I01/8/28/87/HS)
	DSGEN(GENERAL)
	LVLCHK(GENLVL,GENERAL)
	IF	1-ERRFLG
GN.MAC	EQ	1			:GENERAL MACRO DEFINED NOW
GN.ERR	EQ	0			:RESET ERR CONDITION (I01/8/28/87/HS)
	IF	DISPLY 
	REMARK	%%===========================================================%%
	REMARK	  General Customized Defaults%
	EI	DISPLY
	EI
	LIST
	]


	SUBTTL ** SNA INIT ** GENERAL CUSTOMIZED - LINK LEVEL


:	GPRIMARY():
:	----------
:	TO SPECIFY THE SDLC LINES IN THIS SLOT WILL BE DEFAULTED TO
:	PRIMARY, IF NOT OVERRIDED AT LINK LEVEL
:	ARGS:	NONE
PRIMRY	EQ	1			:
GPRIMARY	MACRO[
	DSGEN(GPRIMARY)
	LVLCHK(GENSLV,GPRIMARY)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GPRIMARY)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
G.LINK	EQ	PRIMRY
	IF	DISPLY
	REMARK	%    Link Protocol for this Slot    = Primary
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	SECONDARY():
:	-----------
:	TO SPECIFY THE SDLC LINES IN THIS SLOT WILL BE DEFAULTED TO
:	SECONDARY, IF NOT OVERRIDED AT LINK LEVEL
:	ARGS:	NONE
SECDRY	EQ	0			:
GSECONDARY	MACRO[
	DSGEN(GSECONDARY)
	LVLCHK(GENSLV,GSECONDARY)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GSECONDARY)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
G.LINK	EQ	SECDRY
	IF	DISPLY
	REMARK	%    Link Protocol for this Slot    = Secondary
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GHOST(SGHOST):
:	------------
:	TO SPECIFY THE SNA HOST # FOR ALL THE LINES WITHIN
:	THIS SLOT, IF NOT OVERRIDED AT LINK LEVEL
:	ARGS:	SGHOST	- SECONDARY GROUP'S HOST#
GHOST	MACRO(SGHOST)[
:	NOLIST
	DSGEN(GHOST,SGHOST)
	LVLCHK(GENSLV,GHOST,SGHOST)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GHOST,SGHOST)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,GHOST,SGHOST,PMVALU,A,,AVALUE)
	IF	1-ERRFLG
	RNGCHK(TYPERR,GHOST,AVALUE,PMVALU,A,1,9999,,BVALUE)
	IF	1-ERRFLG
G.HOST	EQ	$A SGHOST
	IF	DISPLY
	REMARK	%    Host # for this Slot           = 
	NUMBER	$A SGHOST
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GSPEED(SGSPED)
:	------------
:	TO SPECIFY THE SDLC LINE TRANSMISSION SPEED FOR
:	ALL THE LINES WITHIN THIS SLOT, CAN BE OVERRIDED AT LINK LEVEL
:	ARGS:	SGSPED	- GROUP LINE SPEED
SPD1	EQ	$A 2400
SPD2	EQ	$A 4800
SPD3	EQ	$A 9600
SPD4	EQ	$A 19200
SPD5	EQ	$A 56000
SP|SPD1|	EQ	1
SP|SPD2|	EQ	1
SP|SPD3|	EQ	1
SP|SPD4|	EQ	1
SP|SPD5|	EQ	1
GSPEED	MACRO(SGSPED)[
:	NOLIST
	DSGEN(GSPEED,SGSPED)
	LVLCHK(GENSLV,GSPEED,SGSPED)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GSPEED,SGSPED)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GSPEED,SGSPED,PMVALU,A,9600,AVALUE)
	IF	1-\SP|AVALUE|
	ERROR(TYPERR,ERR10,Value not Within Range {2.4k 4.8k 9.6k 19.2k 56k},1)
	ERRNXT(TYPERR,,1)
	REMARK	GSPEED(SGSPED)
	ERREND(TYPERR)
	ELSE
G.SPED	EQ	AVALUE
	IF	DISPLY
	REMARK	%    Trans. Speed for this Slot     = 
	NUMBER	$A AVALUE
	REMARK	 Bits/Sec.
	EI	(DISPLY)
	EI	(1-\SP|AVALUE|)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GDATAMODE(GDMODE):
:	-----------------
:	TO SPECIFY THE SDLC LINE DATA TRANSMISSION DATA
:	MODE. (I.E. PROTOCOL DATA MODE).
:	ARGS:	GDMODE	- KEYWORDS: 'HALF', 'HALFDUPLEX',
:			   'FULL', OR 'FULLDUPLEX'.
HALF	EQ	1			:...
HALFDUPLEX	EQ	1		:...
FULL	EQ	0			:...
FULLDUPLEX	EQ	0		:...
GDATAMODE	MACRO(GDMODE)[
:	NOLIST
	DSGEN(GDATAMODE,GDMODE)
	LVLCHK(GENSLV,GDATAMODE,GDMODE)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GDATAMODE,GDMODE)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GDATAMODE,GDMODE,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,GDATAMODE,GDMODE,PMVALU,A,0,1,1,BVALUE)
G.MODE	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Data Mode for this Slot        = 
	IF	BVALUE
	REMARK	Half_Duplex
	ELSE
	REMARK	Full_Duplex
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GDIAL(SGEXTS):
:	--------------
:	TO SPECIFY WHETHER THE LINK CAN DIAL THE EXTERNAL SYSTEMS
:	IF YES, WHEN CALL ARRIVING, THE INTERFACE RAISE DTR TO SIGNAL
:	THE HOST
:	ARGS:	SGEXTS	- KEYWORDS 'YES', OR 'NO'
GDIAL	MACRO(SGEXTS)[
:	NOLIST
	DSGEN(GDIAL,SGEXTS)
	LVLCHK(GENSLV,GDIAL,SGEXTS)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GDIAL,SGEXTS)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GDIAL,SGEXTS,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,GDIAL,SGEXTS,PMVALU,A,0,1,0,BVALUE)
G.DIAL	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Dial  Up  Mode for this Slot   = 
	IF	BVALUE
	REMARK	Dial
	ELSE
	REMARK	Non_Dial
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GDTRDSR(GSDTR):
:	-----------------
:	TO SPECIFY THE SDLC LINE'S ELECTRICAL SIGNAL
:	CHARACTERISTICS. THIS FUNCTION WILL SPECIFY
:	THE DTR/DSR HANDSHAKING REQUIREMENT.
:	ARGS:	GSDTR	- KEYWORD 'YES' OR 'NO'
GDTRDSR	MACRO(GSDTR)[
:	NOLIST
	DSGEN(GDTRDSR,GSDTR)
	LVLCHK(GENSLV,GDTRDSR,GSDTR)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GDTRDSR,GSDTR)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GDTRDSR,GSDTR,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,GDTRDSR,GSDTR,PMVALU,A,0,1,1,BVALUE)
G.SDTR	EQ	BVALUE
	IF	DISPLY
	REMARK	%    DTR/DSR Signals for this Slot  = 
	IF	BVALUE
	REMARK	Required
	ELSE
	REMARK	Not_Required
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERFLG)
	EI	(1-ERFLG)
	LIST
	]

:	GRSPCLEAR(GSRCLR):
:	-----------------
:	TO SPECIFY IF THE CLEAR RSP IS REQUIRED BY THE
:	SLOT.
:	ARGS:	GSRCLR	- KEYWORD 'YES' OR 'NO'
:		YES - CLEAR RSP IS REQUIRED
:		NO  - CLEAR RSP IS NOT REQUIRED
GRSPCLEAR	MACRO(GSRCLR)[
:	NOLIST
	DSGEN(GRSPCLEAR,GSRCLR)
	LVLCHK(GENSLV,GRSPCLEAR,GSRCLR)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GRSPCLEAR,GSRCLR)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GRSPCLEAR,GSRCLR,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,GRSPCLEAR,GSRCLR,PMVALU,A,0,1,1,BVALUE)
G.CLR	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Clear Rsp Req./Not Req. by this slot =
	IF	BVALUE
	REMARK	Required
	ELSE
	REMARK	Not_Required
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERFLG)
	EI	(1-ERFLG)
	LIST
	]

:	GRUCHAIN(GSRUCH):
:	-----------------
:	TO SPECIFY THAT IF THE SINGLE RU CHAIN IS REQUIRED
:	IN THE SLOT.
:	ARGS:	GSRUCH	- KEYWORD 'YES' OR 'NO'
:		YES - SINGLE RU CHAIN
:		NO  - MULTIPLE RU CHAINS
GRUCHAIN	MACRO(GSRUCH)[
:	NOLIST
	DSGEN(GRUCHAIN,GSRUCH)
	LVLCHK(GENSLV,GRUCHAIN,GSRUCH)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GRUCHAIN,GSRUCH)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GRUCHAIN,GSRUCH,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,GRUCHAIN,GSRUCH,PMVALU,A,0,1,1,BVALUE)
G.SRUC	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Single/Multiple RU Chains for this Slot  = 
	IF	BVALUE
	REMARK	Required
	ELSE
	REMARK	Not_Required
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERFLG)
	EI	(1-ERFLG)
	LIST
	]

:	GRTSCTS(GSRTS):
:	--------------
:	TO SPECIFY THE SDLC LINE'S ELECTRICAL SIGNAL
:	CHARACTERISTICS. THIS FUNCTION WILL SPECIFY
:	THE RTS/CTS HANDSHAKING REQUIREMENT PRIOR TO
:	THE TRANSMISSION OF A FRAME.
:	ARGS:	GSRTS	- KEYWORD 'YES' OR 'NO'.
GRTSCTS	MACRO(GSRTS)[
:	NOLIST
	DSGEN(GRTSCTS,GSRTS)
	LVLCHK(GENSLV,GRTSCTS,GSRTS)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GRTSCTS,GSRTS)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GRTSCTS,GSRTS,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,GRTSCTS,GSRTS,PMVALU,A,0,1,1,BVALUE)
G.SRTS	EQ	BVALUE
	IF	DISPLY
	REMARK	%    RTS/CTS Signals for this Slot  = 
	IF	BVALUE
	REMARK	Required
	ELSE
	REMARK	Not_Required
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GINACT(GIACTM):
:	--------------
:	TO SPECIFY THE LINK INACTIVITY TIMOUT VALUE, IN MINUTES, FOR
:	THE LINE/LINE GROUP.
:	ARGS:	GIACTM	- TIMEOUT VALUE, IN MINUTES
GINACTM	MACRO(GIACTM)[
:	NOLIST
	DSGEN(GINACTM,GIACTM)
	LVLCHK(GENSLV,GINACTM,GIACTM)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GINACTM,GIACTM)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GINACTM,GIACTM,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,GINACTM,GIACTM,PMVALU,A,0,32764,0,BVALUE)
	IF	1-ERRFLG				:(I01/8/28/87/HS)
G.IATM	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Link-Inactivity for this Slot  = 
	NUMBER	$A BVALUE
	REMARK	 Min.
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)				:(I01/8/28/87/HS)
	EI	(1-ERRFLG)
	LIST
	]

:	GLDSCT(GDSCTM):
:	--------------
:	TO SPECIFY THE LINK OFF (DROP DTR) DURATION, IN SECONDS, FOR
:	THE LINE/LINE GROUP.
:	ARGS:	GDSCTM	- TIME DURATION, IN SECONDS
GLDSCTM	MACRO(GDSCTM)[
:	NOLIST
	DSGEN(GLDSCTM,GDSCTM)
	LVLCHK(GENSLV,GLDSCTM,GDSCTM)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GLDSCTM,GDSCTM)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GLDSCTM,GDSCTM,PMVALU,A,5,AVALUE)
	RNGCHK(TYPWNG,GLDSCTM,GDSCTM,PMVALU,A,0,32764,5,BVALUE)
	IF	1-ERRFLG				:(I01/8/28/87/HS)
G.DSTM	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Link-Off time for this Slot    = 
	NUMBER	$A BVALUE
	REMARK	 Sec.
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)				:(I01/8/28/87/HS)
	EI	(1-ERRFLG)
	LIST
	]

:	GREPLTO(GTMOT):
:	--------------
:	TO SPECIFY THE REPLY TIMOUT VALUE, IN SECONDS, FOR
:	THE LINE/LINE GROUP.
:	ARGS:	GTMOT	- TIMEOUT VALUE, IN SECONDS
GREPLYTO	MACRO(GTMOT)[
:	NOLIST
	DSGEN(GREPLTO,GTMOT)
	LVLCHK(GENSLV,GREPLTO,GTMOT)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GREPLTO,GTMOT)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GREPLTO,GTMOT,PMVALU,A,3,AVALUE)
	RNGCHK(TYPWNG,GREPLTO,GTMOT,PMVALU,A,1,255,3,BVALUE)
	IF	1-ERRFLG				:(I01/8/28/87/HS)
G.RPTM	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Reply_Timout for this Slot     = 
	NUMBER	$A BVALUE
	REMARK	 Sec.
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)				:(I01/8/28/87/HS)
	EI	(1-ERRFLG)
	LIST
	]

:	GFRAMESIZE(GFRMS):
:	------------------
:	TO SPECIFY THE MAXIMUM SIZE IN BYTES A SINGLE FRAME
:	COULD BE TRANSMITTED OR RECEIVED.
:	ARGS:	GFRMS	- MAX. FRAME SIZE IN BYTES
GFRAMESIZE	MACRO(GFRMS)[
:	NOLIST
	DSGEN(GFRAMESIZE,GFRMS)
	LVLCHK(GENSLV,GFRAMESIZE,GFRMS)
	IF	1-ERRFLG
	PREQMC(GENRANL,GN.MAC,GN.ERR,GFRAMESIZE,GFRMS)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GFRAMESIZE,GFRMS,PMVALU,A,270,AVALUE)
	RNGCHK(TYPWNG,GFRAMESIZE,AVALUE,PMVALU,A,8,6000,270,BVALUE)
G.FRMS	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Framesize for this Slot        = 
	NUMBER	$A BVALUE
	REMARK	 Bytes
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GWINDOWSIZE(GWDWS):
:	----------------
:	TO SPECIFY THE MAXIMUM OUTSTANDING WINDOW SIZE.
:	ARGS:	GWDWS	- 1, 2, 3, 4, 5, 6, OR 7 FRAMES
WIWS1	EQ	1
WIWS2	EQ	2
WIWS3	EQ	3
WIWS4	EQ	4
WIWS5	EQ	5
WIWS6	EQ	6
WIWS7	EQ	7
WIW|WIWS1|	EQ	1
WIW|WIWS2|	EQ	1
WIW|WIWS3|	EQ	1
WIW|WIWS4|	EQ	1
WIW|WIWS5|	EQ	1
WIW|WIWS6|	EQ	1
WIW|WIWS7|	EQ	1
GWINDOWSIZE	MACRO(GWDWS)[
:	NOLIST
	DSGEN(GWINDOWSIZE,GWDWS)
	LVLCHK(GENSLV,GWINDOWSIZE,GWDWS)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GWINDOWSIZE,GWDWS)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GWINDOWSIZE,GWDWS,PMVALU,A,7,AVALUE)
	IF	1-\WIW|AVALUE|
	ERROR(TYPERR,ERR11,Value not Within Range {1 2 3 4 5 6 7},1)
	ERRNXT(TYPERR,,1)
	REMARK	WINDOWSIZE(GWDWS)
	ERREND(TYPERR)
	ELSE			:(\WIW|AVALUE|)
G.WDWS	EQ	AVALUE
	IF	DISPLY
	REMARK	%    Windowsize for this Slot       = 
	NUMBER	$A AVALUE
	REMARK	 Frames
	EI	(DISPLY)
	EI	(1-\WIW|AVALUE|)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	MACRO:	XXX.RETRIES
:	---------------------
:	TO SPECIFY THE NUMBER OF ATTEMPTS, VIA
:	RETRANSMISSION, TO RECOVER FROM TEXT ERRORS IN
:	MESSAGE DATA TRANSMITTED OVER A LINK.
:	PLEASE SEE SNA SYSGEN MANUAL FOR MORE INFORMATION.
:
:	THREE MACROS' ARE DEFINED FOR RETIRES:
:	NUM.RETRIES:	NUMBER OF RETRY IN EACH SEQUENCE
:	PAUS.RETRIES:	PAUSE BETWEEN RETRY SEQUENCES
:	SEQ.RETRIES:	NUMBER OF RETRY SEQUENCES
:


:	GNUM.RETRIES(GRTYM):
:	-------------------
:	TO SPECIFY THE NUMBER OF RETRY WITHIN ONE SEQUENCE
:	ARGS:	GRTYM	- NUMBER OF RETRY
GNUM.RETRIES	MACRO(GRTYM)[
:	NOLIST
	DSGEN(GNUM.RETRIES,GRTYM)
	LVLCHK(GENSLV,GNUM.RETRIES,GRTYM)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GNUM.RETRIES,GRTYM) :(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GNUM.RETRIES,GRTYM,PMVALU,A,3,AVALUE)
	RNGCHK(TYPWNG,GNUM.RETRIES,AVALUE,PMVALU,A,1,255,3,BVALUE)
G.RTYM	EQ	BVALUE
	IF	DISPLY
	REMARK	%    NUM.Retries for this Slot      = 
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GPAUS.RETRIES(GRTYT):
:	-------------------
:	TO SPECIFY THE PAUSE OF RETRY BETWRRN SEQUENCES
:	ARGS:	GRTYT	- PAUSE IN SEC.
GPAUS.RETRIES	MACRO(GRTYT)[
:	NOLIST
	DSGEN(GPAUS.RETRIES,GRTYT)
	LVLCHK(GENSLV,GPAUS.RETRIES,GRTYT)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GPAUS.RETRIES,GRTYT) :(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GPAUS.RETRIES,GRTYT,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,GPAUS.RETRIES,AVALUE,PMVALU,A,1,255,0,BVALUE)
G.RTYT	EQ	BVALUE
	IF	DISPLY
	REMARK	%    PAUS.Retries for this Slot     = 
	NUMBER	$A BVALUE
	REMARK	 Sec.
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GSEQ.RETRIES(GRTYN):
:	-------------------
:	TO SPECIFY THE NUMBER OF RETRYE QUENCE SEQUENCES
:	ARGS:	GRTYN	- NUMBER OF RETRY SEQUENCES
GSEQ.RETRIES	MACRO(GRTYN)[
:	NOLIST
	DSGEN(GSEQ.RETRIES,GRTYN)
	LVLCHK(GENSLV,GSEQ.RETRIES,GRTYN)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GSEQ.RETRIES,GRTYN) :(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GSEQ.RETRIES,GRTYN,PMVALU,A,3,AVALUE)
	RNGCHK(TYPWNG,GSEQ.RETRIES,AVALUE,PMVALU,A,1,255,3,BVALUE)
G.RTYN	EQ	BVALUE
	IF	DISPLY
	REMARK	%    SEQ.Retries for this Slot      = 
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GPAUSE(SGPAUS):
:	------------
:	TO SPECIFY THE AVERAGE DURATION OF THE POLLING
:	CYCLE IN SECONDS.
:	PLEASE SEE SNA SYSGEN MANUAL FOR MORE INFORMATION.
:	ARGS:	SGPAUS	- PAUSE IN SECONDS
GPAUSE	MACRO(SGPAUS)[
:	NOLIST
	DSGEN(GPAUSE,SGPAUS)
	LVLCHK(GENSLV,GPAUSE,SGPAUS)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GPAUSE,SGPAUS)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GPAUSE,SGPAUS,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,GPAUSE,AVALUE,PMVALU,A,1,255,1,BVALUE)
G.PAUS	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Polling Pause for this Slot    = 
	NUMBER	$A BVALUE
	REMARK	 Sec.
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GISTATUS(GISTS):
:	--------------
:		TO SPECIFY THE INITIAL STATUS OF THE SLOT
:	ARGS:	GISTS	- 'INACT' OR 'ACTIVE'
INACTIVE	EQ	1
INACT	EQ	1
ACTIVE	EQ	0
GISTATUS	MACRO(GISTS)[
	DSGEN(GSTATUS,GISTS)
	LVLCHK(GENSLV,GISTATUS,GISTS)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GISTATUS,GISTS)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GISTATUS,GISTS,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,GISTATUS,GISTS,PMVALU,A,0,1,0,BVALUE)
G.ISTS	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Init. Status for this Slot     = 
	IF	BVALUE
	KILL	INACTIVE
	REMARK	Inactive
INACTIVE	EQ	1
	ELSE
	KILL	ACTIVE
	REMARK	Active
ACTIVE	EQ	0
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GRCVSIOFR(GRFRN):
:	----------------
:	TO SPECIFY THE SIO BUFFER ROOM IN NUMBER OF FRAMES
:	ALLOCATED FOR THE RCV FOR EACH SDLC STATION
:	ARGS:	GRFRN	- NUMBER OF FRAMES
GRCVSIOFR	MACRO(GRFRN)[
:	NOLIST
	DSGEN(GRCVSIOFR,GRFRN)
	LVLCHK(GENSLV,RCVSIOFR,GRFRN)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,RCVSIOFR,GRFRN)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,RCVSIOFR,GRFRN,PMVALU,A,8,AVALUE)
	RNGCHK(TYPWNG,RCVSIOFR,AVALUE,PMVALU,A,2,8,8,BVALUE)
G.RFRN	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Rcvsiofr for this Slot         = 
	NUMBER	$A BVALUE
	REMARK	 Frames
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	(5/10/85/CHS)
:	GDSIOTP(GSIOH):
:	----------------
:	TO SPECIFY THE SIO DAUGHER CARD TYPE
:	ARGS:	GSIOH	- D.TYP0, D.TYP1
:	FOR SIO DAUGHTER CARD VERSION A TO G, SPECIFY D.TYP0
:	FOR SIO DAUGHTER CARD VERSION H AND LATER, SPECIFY D.TYP1
D.TYP0	EQ	0
D.TYP1	EQ	1
GDSIOTP	MACRO(GSIOH)[
:	NOLIST
	DSGEN(GDSIOTP,GSIOH)
	LVLCHK(GENSLV,DSIOTP,GSIOH)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,DSIOTPR,GSIOH)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,DSIOTP,GSIOH,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,DSIOTP,AVALUE,PMVALU,A,0,1,0,BVALUE)
G.SIOH	EQ	BVALUE
	IF	DISPLY
	REMARK	%    SIO Daughter Cards for the Slot= 
	IF	BVALUE
	REMARK	Type 1
	ELSE
	REMARK	Type 0
	EI
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

	SUBTTL  ** SNA INIT ** GENERAL CUSTOMIZED - PU LEVEL


:	GPU.ITYPE(GPUTY):
:	--------------
:		TO SPECIFY THE INTERNAL PU TYPE FOR THE PU'S FOR THE SLOT
:	ARGS:	GPUTY	- '1' , '2' OR '4'
GPU.ITYPE	MACRO(GPUTY)[
:	NOLIST
	DSGEN(GPU.ITYPE,GPUTY)
	LVLCHK(GENSLV,GPU.ITYPE,GPUTY)
	IF	1-ERRFLG				:(I01/8/28/87/HS)
	PREQMC(GENERAL,GN.MAC,GN.ERR,GPU.ITYPE,GPUTY)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GPU.ITYPE,GPUTY,PMVALU,A,2,AVALUE)
	RNGCHK(TYPWNG,GPU.ITYPE,AVALUE,PMVALU,A,1,4,2,BVALUE)
G.IPTY	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Internal PU Type for this Slot = 
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)				:(I01/8/28/87/HS)
	LIST
	]

:	GPU.ETYPE(GPUTY):
:	--------------
:		TO SPECIFY THE EXTERNAL PU TYPE FOR THE PU'S FOR THE SLOT
:	ARGS:	GPUTY	- '1' , '2' OR '4'
GPU.ETYPE	MACRO(GPUTY)[
:	NOLIST
	DSGEN(GPU.ETYPE,GPUTY)
	LVLCHK(GENSLV,GPU.ETYPE,GPUTY)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GPU.ETYPE,GPUTY,PMVALU,A,2,AVALUE)
	RNGCHK(TYPWNG,GPU.ETYPE,AVALUE,PMVALU,A,1,4,2,BVALUE)
G.EPTY	EQ	BVALUE
	IF	DISPLY
	REMARK	%    External PU Type for this Slot = 
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	LIST
	]

:	GPU.ESYS(SGEXTS):
:	--------------
:	TO SPECIFY THE EXTERNAL SYSTEM TYPE OF A PU.
:	THE SUPPORT TYPES OF VENDOR SYSTEMS ARE:
:		IBM - IBM
:		FUJITSU- FUJITSU 
:		HITACHI- HITACHI
:	ARGS:	SGEXTS	- KEYWORDS 'IBM' OR 'FUJITSU' OR 'HITACHI'.
GPU.ESYS	MACRO(SGEXTS)[
:	NOLIST
	DSGEN(GPU.ESYS,SGEXTS)
	LVLCHK(GENSLV,GPU.ESYS,SGEXTS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GPU.ESYS,SGEXTS,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,GPU.ESYS,SGEXTS,PMVALU,A,0,2,0,BVALUE)
G.EXTS	EQ	BVALUE
	IF	DISPLY
	REMARK	%    External system for this Slot  = 
	IF	BVALUE-1
	REMARK	Hitachi System
	ELSE	BVALUE
	REMARK	Fujitsu System
	ELSE
	REMARK	IBM System
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	LIST
	]

:	GPU.CHRSET(SGCHRS):
:	--------------
:	TO SPECIFY THE CHARACTER SET SUPPORTED BY THE PU.
:	THE SUPPORT TYPES OF CHARACTER SETS ARE:
:		ENGLISH - ENGLISH
:		KATAKANA - KATAKANA
:		KANJI - KANJI
:	ARGS:	SGCHRS	- KEYWORDS 'ENGLISH' OR 'KATAKANA' OR 'KANJI'
GPU.CHRSET	MACRO(SGCHRS)[
:	NOLIST
	DSGEN(GPU.CHRSET,SGCHRS)
	LVLCHK(GENSLV,GPU.CHRSET,SGCHRS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GPU.CHRSET,SGCHRS,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,GPU.CHRSET,SGCHRS,PMVALU,A,0,5,0,BVALUE)
G.CHST	EQ	BVALUE
	IF	BVALUE-3
JAPANESE	EQ	1
	EI	(BVALUE)
	IF	DISPLY
	REMARK	%    Language for this SLot         = 
	IF	BVALUE-4
	REMARK	Kanji and Katakana
	ELSE	BVALUE-3
	REMARK	Katakana
	ELSE
	REMARK	English
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	LIST
	]

:	GPU.PLABEL(GPULB):
:	--------------
:		TO SPECIFY DEFAULT PU LABEL FOR SPERCFIC CRM
:	ARGS:	GPULB - ANY HEX VALUE
GPU.PL	MACRO(GPULB)[
:	NOLIST
	DSGEN(GPU.PLAB,GPULB)
	LVLCHK(GENSLV,GPU.PLAB,GPULB)
	IF	1-ERRFLG
G.PLAB	EQ	GPULB
LABLSW	EQ	1
	IF	DISPLY
	REMARK	%    General default value for PU label is
	NUMBER	GPULB
	EI	(DISPLY)
	EI	(1-ERRFLG)
	LIST
	]

:	PU.QACTPU(GACPU):
:	--------------
:	TO DEFINE THE CANNED DATA FOR RQ(ACTPU)
:	ARG:	GACPU - DATA FOR ACTPU IN HEX FORMAT
GPU.QACTPU	MACRO(GACPU)[
:	NOLIST
	DSGEN(GPU.QACTPU,GACPU)
	LVLCHK(GENSLV,GPU.QACTPU,GACPU)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GPU.QACTPU,GACPU)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,GPU.QACTPU,GACPU,PMSTRN)
	IF	1-ERRFLG
G.ACPU	MACRO[
	XC	GACPU
	]
F.ACPU	EQ	1
	IF	DISPLY
	REMARK	%    RQ(ACTPU) Data fot this SLot   = GACPU
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GPU.QDACTPU(GDACPU):
:	--------------
:	TO DEFINE THE CANNED DATA FOR RQ(DACTPU)
:	ARG:	GDACPU - DATA FOR DACTPU IN HEX FORMAT
GPU.QDACTPU	MACRO(GDACPU)[
:	NOLIST
	DSGEN(GPU.QDACTPU,GDACPU)
	LVLCHK(GENSLV,GPU.QDACTPU,GDACPU)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GPU.QDACTPU,GDACPU) :(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,GPU.QDACTPU,GDACPU,PMSTRN)
	IF	1-ERRFLG
G.DACPU	MACRO[
	XC	GDACPU
	]
F.DACPU	EQ	1
	IF	DISPLY
	REMARK	%    RQ(DACTPU) Data fot this Slot  = GDACPU
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GPU.PACTPU(GACPU):
:	--------------
:	TO DEFINE THE CANNED DATA FOR RSP(ACTPU)
:	ARG:	GACPU - DATA FOR RSP(ACTPU) IN HEX FORMAT
GPU.PACTPU	MACRO(GACPU)[
:	NOLIST
	DSGEN(GPU.PACTPU,GACPU)
	LVLCHK(GENSLV,GPU.PACTPU,GACPU)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GPU.PACTPU,GACPU)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,GPU.PACTPU,GACPU,PMSTRN)
	IF	1-ERRFLG
R.ACPU	MACRO[
	XC	GACPU
	]
P.ACPU	EQ	1
	IF	DISPLY
	REMARK	%    RSP(ACTPU) Data for this Slot  = GACPU
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

	SUBTTL ** SNA INIT ** GENERAL CUSTOMIZED - LU LEVEL


:	GLU.TYPE(GLUTY):
:	--------------
:		TO SPECIFY THE LU TYPE FOR THE LU'S FOR THE SLOT
:	ARGS:	GLUTY	- '2' OR '3'
GLU.TYPE	MACRO(GLUTY)[
:	NOLIST
	DSGEN(GLU.TYPE,GLUTY)
	LVLCHK(GENSLV,GLU.TYPE,GLUTY)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GLU.TYPE,GLUTY,PMVALU,A,2,AVALUE)
	RNGCHK(TYPWNG,GLU.TYPE,AVALUE,PMVALU,A,1,4,2,BVALUE)
G.LUTY	EQ	BVALUE
	IF	DISPLY
	REMARK	%    LU Type for this Slot          = 
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	LIST
	]

:	GLU.LLABEL(GLULB):
:	--------------
:		TO SPECIFY DEFAULT LU LABEL FOR SPERCFIC CRM
:	ARGS:	GLULB - ANY HEX VALUE
GLU.LL	MACRO(GLULB)[
:	NOLIST
	DSGEN(GLU.LLAB,GLULB)
	LVLCHK(GENSLV,GLU.LLAB,GLULB)
	IF	1-ERRFLG
G.LLAB	EQ	GLULB
LABLSW	EQ	1
	IF	DISPLY
	REMARK	%    General default value for LU label is
	NUMBER	GLULB
	EI	(DISPLY)
	EI	(1-ERRFLG)
	LIST
	]

:	GLU.PVC(GPVC):
:	--------------
:	TO SPECIFY THE NETWORK LOGON METHOD
:	ARGS:	GPVC	- KEYWORD 'YES' OR 'NO'.
GLU.PVC	MACRO(GPVC)[
:	NOLIST
	DSGEN(GLU.PVC,GPVC)
	LVLCHK(GENSLV,GLU.PVC,GPVC)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GLU.PVC,GPVC)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GLU.PVC,GPVC,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,GLU.PVC,GPVC,PMVALU,A,0,1,1,BVALUE)
G.PVC	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Logon Method for this Slot     = 
	IF	BVALUE
	REMARK	PVC
	ELSE
	REMARK	Network Service Screen
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GLU.VHR(GVHR):
:	--------------
:	TO SPECIFY DEFAULT VHR FUNCTION.
:	ARGS:	GVHR	- KEYWORD 'YES' OR 'NO'.
GLU.VHR	MACRO(GVHR)[
:	NOLIST
	DSGEN(GLU.VHR,GVHR)
	LVLCHK(GENSLV,GLU.VHR,GVHR)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GLU.VHR,GVHR)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GLU.VHR,GVHR,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,GLU.VHR,GVHR,PMVALU,A,0,1,1,BVALUE)
G.VHR	EQ	BVALUE
VHRSUP	EQ	BVALUE
	IF	\HDPSUP
	IF	HDPSUP
	ELSE
HDPSUP	EQ	BVALUE
	EI
	ELSE
HDPSUP	EQ	BVALUE
	EI
	IF	DISPLY
	IF	BVALUE
	REMARK	VHR function requested as defualt for the slot
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GLU.VTI(GVTI):
:	--------------
:	TO SPECIFY DEFAULT VTI FUNCTION.
:	ARGS:	GVTI	- KEYWORD 'YES' OR 'NO'.
GLU.VTI	MACRO(GVTI)[
:	NOLIST
	DSGEN(GLU.VTI,GVTI)
	LVLCHK(GENSLV,GLU.VTI,GVTI)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GLU.VTI,GVTI)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GLU.VTI,GVTI,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,GLU.VTI,GVTI,PMVALU,A,0,1,1,BVALUE)
G.VTI	EQ	BVALUE
VTISUP	EQ	BVALUE
	IF	DISPLY
	IF	BVALUE
	REMARK	VTI function requested as defualt for the slot
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GLU.SRQ(GSRQ):
:	--------------
:	TO SPECIFY DEFAULT SYS/RQ FUNCTION.
:	ARGS:	GSRQ	- KEYWORD 'YES' OR 'NO'.
GLU.SRQ	MACRO(GSRQ)[
:	NOLIST
	DSGEN(GLU.SRQ,GSRQ)
	LVLCHK(GENSLV,GLU.SRQ,GSRQ)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GLU.SRQ,GSRQ)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GLU.SRQ,GSRQ,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,GLU.SRQ,GSRQ,PMVALU,A,0,1,1,BVALUE)
G.SRQ	EQ	BVALUE
	IF	DISPLY
	IF	BVALUE
	REMARK	SYS/RQ function requested as defualt for the slot
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GLU.QACTLU(GACLU):
:	--------------
:	TO DEFINE THE CANNED DATA FOR RQ(ACTLU)
:	ARG:	GACLU - DATA FOR ACTLU IN HEX FORMAT
GLU.QACTLU	MACRO(GACLU)[
:	NOLIST
	DSGEN(GLU.QACTLU,GACLU)
	LVLCHK(GENSLV,GLU.QACTLU,GACLU)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GLU.QACTLU,GACLU)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,GLU.QACTLU,GACLU,PMSTRN)
	IF	1-ERRFLG
G.ACLU	MACRO[
	XC	GACLU
	]
F.ACLU	EQ	1
	IF	DISPLY
	REMARK	%    RQ(ACTLU) Data fot this Slot   = GACLU
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GLU.QDACTLU(GDACLU):
:	--------------
:	TO DEFINE THE CANNED DATA FOR RQ(DACTLU)
:	ARG:	GDACLU - DATA FOR DACTLU IN HEX FORMAT
GLU.QDACTLU	MACRO(GDACLU)[
:	NOLIST
	DSGEN(GLU.QDACTLU,GDACLU)
	LVLCHK(GENSLV,GLU.QDACTLU,GDACLU)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GLU.QDACTLU,GDACLU) :(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,GLU.QDACTLU,GDACLU,PMSTRN)
	IF	1-ERRFLG
G.DACLU	MACRO[
	XC	GDACLU
	]
F.DACLU	EQ	1
	IF	DISPLY
	REMARK	%    RQ(DACTLU) Data fot this Slot  = GDACLU
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GLU.PACTLU(GACLU):
:	--------------
:	TO DEFINE THE CANNED DATA FOR RSP(ACTLU)
:	ARG:	GACLU - DATA FOR RSP(ACTLU) IN HEX FORMAT
GLU.PACTLU	MACRO(GACLU)[
:	NOLIST
	DSGEN(GLU.PACTLU,GACLU)
	LVLCHK(GENSLV,GLU.PACTLU,GACLU)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GLU.PACTLU,GACLU)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,GLU.PACTLU,GACLU,PMSTRN)
	IF	1-ERRFLG
R.ACLU	MACRO[
	XC	GACLU
	]
P.ACLU	EQ	1
	IF	DISPLY
	REMARK	%    RSP(ACTLU) Data for this Slot  = GACLU
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GLU.BIND(GBIND):
:	--------------
:	TO DEFINE THE CANNED DATA FOR RQ(BIND)
:	ARG:	GBIND - DATA FOR RQ(BIND) IN HEX. FORMAT
GLU.BIND	MACRO(GBIND)[
:	NOLIST
	DSGEN(GLU.BIND,GBIND)
	LVLCHK(GENSLV,GLU.BIND,GBIND)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GLU.BIND,GBIND)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,GLU.BIND,GBIND,PMSTRN)
	IF	1-ERRFLG
G.BIND	MACRO[
	XC	GBIND
	]
F.BIND	EQ	1
	IF	DISPLY
	REMARK	%    RQ(BIND) Data fot this Slot    = GBIND
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GLU.UNBIND(GUNBND):
:	--------------
:	TO DEFINE THE CANNED DATA FOR RQ(UNBIND)
:	ARG:	GUNBND - DATA FOR RQ(UNBIND) IN HEX. FORMAT
GLU.UNBIND	MACRO(GUNBND)[
:	NOLIST
	DSGEN(GLU.UNBIND,GUNBND)
	LVLCHK(GENSLV,GLU.UNBINDU,GUNBND)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GLU.UNBIND,GUNBND)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,GLU.UNBIND,GUNBND,PMSTRN)
	IF	1-ERRFLG
G.UNBIND	MACRO[
	XC	GUNBND
	]
F.UNBIND	EQ	1
	IF	DISPLY
	REMARK	%    RQ(UNBIND) Data fot this Slot  = GUNBND
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GLU.COLOR(GCOLOR):
:	--------------
:	TO SPECIFY THE DEVICES' COLOR ATTRIBUTE
:	ARGS:	GCOLOR	- KEYWORD 'YES' OR 'NO'.
GLU.COLOR	MACRO(GCOLOR)[
:	NOLIST
	DSGEN(GLU.COLOR,GCOLOR)
	LVLCHK(GENSLV,GLU.COLOR,GCOLOR)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GLU.COLOR,GCOLOR)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GLU.COLOR,GCOLOR,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,GLU.COLOR,GCOLOR,PMVALU,A,0,1,1,BVALUE)
G.COLOR	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Devices Color for this Slot    = 
	IF	BVALUE
	REMARK	Color
	ELSE
	REMARK	No-Color
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GLU.SIZE(GSIZE):
:	--------------
:	TO SPECIFY THE DEVICES' SIZE
:	ARGS:	GSIZE	- DEVICE'S SIZE, IN DECIMINAL
GLU.SIZE	MACRO(GSIZE)[
:	NOLIST
	DSGEN(GLU.SIZE,GSIZE)
	LVLCHK(GENSLV,GLU.SIZE,GSIZE)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GLU.SIZE,GSIZE)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GLU.SIZE,GSIZE,PMVALU,A,1920,AVALUE)
	RNGCHK(TYPWNG,GLU.SIZE,AVALUE,PMVALU,A,1,1920,1920,BVALUE)
G.SIZE	EQ	C|$ABVALUE|
	IF	DISPLY
	REMARK	%    Devices' Size for this Slot    = 
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GLU.ITIMOUT(GITIM):
:	--------------
:	TO SPECIFY THE INACTIVE TIMEOUT FOR DEVICE
:	ARGS:	GITIM	- IDLE TIMEOUT FOR DEVICE, IN DECIMAL (MINUTE)
GLU.ITIMOUT	MACRO(GITIM)[
:	NOLIST
	DSGEN(GLU.ITIMOUT,GITIM)
	LVLCHK(GENSLV,GLU.ITIMOUT,GITIM)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GLU.ITIMOUT,GITIM)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GLU.ITIMOUT,GITIM,PMVALU,A,60,AVALUE)
	RNGCHK(TYPWNG,GLU.ITIMOUT,AVALUE,PMVALU,A,0,60,60,BVALUE)
G.ITIM	EQ	$ABVALUE*$A60
	IF	DISPLY
	REMARK	%    Devices' Inactive timeout for this interface =
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GLU.ATIMOUT(GITIM):
:	--------------
:	TO SPECIFY THE APPLICATION NORMAL LOGOFF TIMER
:	ARGS:	GITIM	- IDLE TIMEOUT FOR DEVICE, IN DECIMAL (SECOND)
GLU.ATIMOUT	MACRO(GITIM)[
:	NOLIST
	DSGEN(GLU.ATIMOUT,GITIM)
	LVLCHK(GENSLV,GLU.ATIMOUT,GITIM)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GLU.ATIMOUT,GITIM)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GLU.ATIMOUT,GITIM,PMVALU,A,60,AVALUE)
	RNGCHK(TYPWNG,GLU.ATIMOUT,AVALUE,PMVALU,A,0,60,60,BVALUE)
G.ATIM	EQ	$ABVALUE		:(10/3/84 MIA)
	IF	DISPLY
	REMARK	%    Devices' application normal logoff timeout =
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]


AP.ETX	EQ	0			:DSP TRAILER IS ETX ONLY
AP.ETB	EQ	1			:DSP TRAILER IS ETX,ETB
AP.ITB	EQ	2			:DSP TRAILER IS ETX,ETB,ITB
:	GLU.TRAILER(GLUTRA):
:	--------------
:	TO SPECIFY THE LU DSP TRAILER FOR THE LU'S FOR THE SLOT
:	ARGS:	GLUTRA	- 'AP.ETX','AP.ETB' OR 'AP.ITB'
GLU.TRAILER	MACRO(GLUTRA)[
:	NOLIST
	DSGEN(GLU.TRAILER,GLUTRA)
	LVLCHK(GENSLV,GLU.TRAILER,GLUTRA)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GLU.TRAILER,GLUTRA,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,GLU.TRAILER,AVALUE,PMVALU,A,0,2,2,BVALUE)
G.LUTRA	EQ	BVALUE
	IF	DISPLY
	REMARK	%    LU DSP trailer for this Slot          = glutra
	EI	(DISPLY)
	EI	(1-ERRFLG)
	LIST
	]


	SUBTTL ** SNA INIT ** GENERAL CUSTOMIZED - LU.PVC LEVEL


:	GPV.LOGON(GLEVEL,GSTRN):
:	--------------------
:	TO SPECIFY THE LOGON STRING FOR THE PVC LOGON FOR DEVICES
:	ARGS:	GSTRN - LEGAL LOGON STRING
:		GLEVEL - LOGON LEVEL
GPV.LOGON	MACRO(GLEVEL,GSTRN)[
	IF	DSPGEN
	REMARK	%GPV.LOGON(GLEVEL,GSTRN)
	REMARK%
	EI	DSPGEN
	IF	.LT.(GENSLV,CURLVL)
	ERROR(TYPERR,ERR07,Sysgen Statement not at Correct Level,1)
	ERRNXT(TYPERR,,1)
	REMARK	GPV.LOGON(GLEVEL,GSTRN)
	ERREND(TYPERR)
	ELSE
CURLVL	EQ	GENSLV
	EI				:END OF LEVEL CHECK
	IF	1-ERRFLG
	IF	1-GN.MAC		:BEGIN PREQMC CHECK
	ERROR(TYPERR,ERR08,Pre-Requested Macro Not Defined,1)
	ERRNXT(TYPERR,,1)
	REMARK	GENERAL()  Before 
	REMARK	GPV.LOGON(GLEVEL,GSTRN)
	ERREND(TYPERR)
	EI				:END OF PREQMC CHECK
	IF	1-ERRFLG
	ORG	0			:BEGIN PARAMETER PRESEN CHECK
	AC	/GSTRN/
IZ	EQ	.
	ORG	0
	AC	/GLEVEL/
IY	EQ	.
	ORG	0
	IF	(1-IZ)!(1-IY)
	ERROR(TYPERR,ERR14,Logon Parameter Missing,1)
	ERRNXT(TYPERR,,1)
	REMARK	GPV.LOGON(GLEVEL,GSTRN)
	ERREND
	EI				:END OF PARAMETERS PRESETN CHECK
	IF	1-.EQ.(CLGLVL,GLEVEL)
	ERROR(TYPERR,ERR09,Logon String Statement Level not contiguous,1)
	ERRNXT(TYPERR,,1)
	REMARK	GPV.LOGON(GLEVEL,GSTRN)
	ERREND(TYPERR)
	EI
	IF	1-ERRFLG
	IF	GLEVEL-4
	ERROR(TYPERR,ERR17,Logon Parameter Level Too Large,1)
	ERRNXT(TYPERR,,1)
	REMARK	GPV.LOGON(GLEVEL,GSTRN)
	ERREND(TYPERR)
	EI				:END OF RANGE CHECK
	IF	1-ERRFLG
LVL	EQ	GLEVEL
CLGLVL	EQ	GLEVEL+1
G.PVLV	EQ	CLGLVL
G.PVL|LVL|	MACRO[
	SC	/GSTRN/
	]
	IF	DISPLY
	REMARK	%    Level GLEVEL 
	REMARK	PVC Logon String       = GSTRN
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GPV.LINE(GLINE):
:	--------------
:	TO SPECIFY THE DESINATION LINE # TO BE ATTACHED FOR PVC LOGON
:	ARG: GLINE - LINE # [-1, 0FF]
GPV.LINE	MACRO(GLINE)[
:	NOLIST
	DSGEN(PV.LINE,GLINE)
	LVLCHK(GENSLV,GPV.LINE,GLINE)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GPV.LINE,GLINE)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GPV.LINE,GLINE,PMVALU,0,-1,AVALUE)
	RNGCHK(TYPWNG,GPV.LINE,AVALUE,PMVALU,0,-1,0FF,0FF,BVALUE)
G.PVDL	EQ	BVALUE
	IF	DISPLY
	REMARK	%    PVC Logon DLINE for this Slot  = 
	DSPNUM(BVALUE,0)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	DPV.PUADDR(GPUADR)
:	------------------
:	TO SPECIFY THE DESTINATION CU ADDR TO BE ATTACHED FOR PVC
:	LOGON ONLY
:	ARG:	GPUADR - CU ADDR [ 1-0FF]
GPV.PUADDR	MACRO(GPUADR)[
:	NOLIST
	DSGEN(GPV.PUADDR,GPUADR)
	LVLCHK(GENSLV,GPV.PUADDR,GPUADR)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GPV.PUADDR,GPUADR)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GPV.PUADDR,GPUADR,PMVALU,0,0FF,AVALUE)
	RNGCHK(TYPWNG,GPV.PUADDR,AVALUE,PMVALU,0,-1,0FF,0FF,BVALUE)
G.PVPU	EQ	BVALUE
	IF	DISPLY
	REMARK	%    PVC Logon DCU for this Slot    = 
	DSPNUM(BVALUE,0)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GPV.LUADDR(GLUADR)
:	-------------------
:	TO SPECIFY THE DESTINATION LU ADDR TO BE ATTACHED FOR PVC
:	LOGON ONLY
:	ARG:	GLUADR - LU ADDR [-1, 0FF]
GPV.LUADDR	MACRO(GLUADR)[
:	NOLIST
	DSGEN(GPV.LUADDR,GLUADR)
	LVLCHK(GENSLV,GPV.LUADDR,GLUADR)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GPV.LUADDR,GLUADR)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GPV.LUADDR,GLUADR,PMVALU,0,0FF,AVALUE)
	RNGCHK(TYPWNG,GPV.LUADDR,AVALUE,PMVALU,0,-1,0FF,0FF,BVALUE)
G.PVLU	EQ	BVALUE
	IF	DISPLY
	REMARK	%    PVC Logon DLU for this Slot    = 
	DSPNUM(BVALUE,0)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GPV.LTYPE(GLTYPE):
:	-------------------
:	TO SPECIFY THE DESIRED LTYPE CAPABILITY ON THE DESTINATION
:	DEVICE, FOR PVC LOGON ONLY
:	ARG:	GLTYPE - 2 OR 3
GPV.LTYPE	MACRO(GLTYPE)[
:	NOLIST
	DSGEN(GPV.LTYPE,GLTYPE)
	LVLCHK(GENSLV,GPV.LTYPE,GLTYPE)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GPV.LTYPE,GLTYPE)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GPV.LTYPE,GLTYPE,PMVALU,A,2,AVALUE)
	RNGCHK(TYPWNG,GPV.LTYPE,AVALUE,PMVALU,A,2,3,2,BVALUE)
G.PVLT	EQ	BVALUE
	IF	DISPLY
	REMARK	%    PVC Logon DLTYPE for this Slot = 
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GPV.COLOR(GCOLOR):
:	-------------------
:	TO SPECIFY THE DESIRED COLOR CAPABILITY ON THE DESTINATION
:	DEVICE, FOR PVC LOGON ONLY
:	ARG:	GCOLOR - YES/NO
GPV.COLOR	MACRO(GCOLOR)[
:	NOLIST
	DSGEN(GPV.COLOR,GCOLOR)
	LVLCHK(GENSLV,GPV.COLOR,GCOLOR)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GPV.COLOR,GCOLOR)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GPV.COLOR,GCOLOR,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,GPV.COLOR,AVALUE,PMVALU,A,0,1,0,BVALUE)
G.PVCO	EQ	BVALUE
	IF	DISPLY
	REMARK	%    PVC Logon DCOLOR for this Slot = 
	IF	BVALUE
	REMARK	Color
	ELSE
	REMARK	Non_Color
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GPV.SIZE(GSIZE)
:	---------------
:	TO SPECIFY THE DESIRED DEVICE SIZE ON THE DESTINCATION 
:	DEVICE, FOR PVC LOGON ONLY
:	ARG:	GSIZE - 480, 1920, ETC..
GPV.SIZE	MACRO(GSIZE)[
:	NOLIST
	DSGEN(GPV.SIZE,GSIZE)
	LVLCHK(GENSLV,GPV.SIZE,GSIZE)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GPV.SIEZ,GSIZE)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GPV.SIZE,GSIZE,PMVALU,A,1920,AVALUE)
	RNGCHK(TYPWNG,GPV.SIZE,AVALUE,PMVALU,A,480,1920,1920,BVALUE)
G.PVSZ	EQ	C|$ABVALUE|
	IF	DISPLY
	REMARK	%    PVC Logon DSIZE for this Slot  = 
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GPV.CHRSET(GCHRST)
:	---------------
:	TO SPECIFY THE DESIRED CHAR SET ON THE DESTINCATION 
:	DEVICE, FOR PVC LOGON ONLY
:	ARG:	GCHRST - ENGLISH, KATAKANA, AND KANJI
GPV.CHRSET	MACRO(GCHRST)[
:	NOLIST
	DSGEN(GPV.CHRSET,GCHRST)
	LVLCHK(GENSLV,GPV.CHRSET,GCHRST)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GPV.CHRSET,GCHRST)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GPV.CHRSET,GCHRST,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,GPV.CHRSET,AVALUE,PMVALU,A,0,5,0,BVALUE)
G.PVCH	EQ	BVALUE
	IF	BVALUE-3
JAPANESE	EQ	1
	EI	(BVALUE)
	IF	DISPLY
	REMARK	%    PVC Logon CHARSET for this Slot=
	IF	BVALUE-4
	REMARK	Kanji and Katakana
	ELSE	VALUE-3
	REMARK	Katakana
	ELSE
	REMARK	English
	EI
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	GPV.CRM(GCRM)
:	---------------
:	TO SPECIFY THE DESIRED CRM ON THE DESTINCATION 
:	DEVICE, FOR PVC LOGON ONLY
:	ARG:	GCRM - 1,2,3,4
GPV.CRM	MACRO(GCRM)[
:	NOLIST
	DSGEN(GPV.CRM,GCRM)
	LVLCHK(GENSLV,GPV.CRM,GCRM)
	IF	1-ERRFLG
	PREQMC(GENERAL,GN.MAC,GN.ERR,GPV.CRM,GCRM)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,GPV.CRM,GCRM,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,GPV.CRM,AVALUE,PMVALU,A,1,4,1,BVALUE)
G.CRM	EQ	$ABVALUE
	IF	DISPLY
	REMARK	%    PVC Logon CRM for this Slot    = 
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

	SUBTTL ** SNA INIT ** NETWORK SERVICE/LOGON SELECTION DEFAULTS


:	DEFINE KEY SYMBOLS
:	------------------
PF1	EQ	1			:PF KET 1
PF2	EQ	2			:PF KET 2
PF3	EQ	3			:PF KET 3
PF4	EQ	4			:PF KET 4
PF5	EQ	5			:PF KET 5
PF6	EQ	6			:PF KET 6
PF7	EQ	7			:PF KET 7
PF8	EQ	8			:PF KET 8
PF9	EQ	9			:PF KET 9
PF10	EQ	$A10			:PF KEY 10
PF11	EQ	$A11			:PF KEY 11
PF12	EQ	$A12			:PF KEY 12
PF13	EQ	$A13			:PF KEY 13
PF14	EQ	$A14			:PF KEY 14
PF15	EQ	$A15			:PF KEY 15
PF16	EQ	$A16			:PF KEY 16
PF17	EQ	$A17			:PF KEY 17
PF18	EQ	$A18			:PF KEY 18
PF19	EQ	$A19			:PF KEY 19
PF20	EQ	$A20			:PF KEY 20
PF21	EQ	$A21			:PF KEY 21
PF22	EQ	$A22			:PF KEY 22
PF23	EQ	$A23			:PF KEY 23
PF24	EQ	$A24			:PF KEY 24
PA1	EQ	25			:PA KEY 1
PA2	EQ	26			:PA KEY 2
PA3	EQ	27			:PA KEY 3

:	NETWORK SERVICE DEFAULTS
:	--------------------------
G.NSMT	EQ	0			:TEXT IN ASCII
G.NSMENU	MACRO[
:	NOLIST
	HS	0
BEGORG	EQ	.
	HC	0
	AC	/TYMNET SNA/SDLC NETWORK INTERFACE/
	AC	/  /
	BC	((VERSION/8)&7)+0B0
	BC	(VERSION&7)+0B0
	AC	/./
	BC	((REVLEV/8)&7)+0B0
	BC	(REVLEV&7)+0B0
	AC	/ /
ENDORG	EQ	.
	ORG	BEGORG
	HC	ENDORG-BEGORG-2
	ORG	ENDORG
	LIST
	]

G.NSKY	EQ	PF5			:NS MENU INVOKED BY PF5

G.KWRD	MACRO[
	AC	/NETSCR/
	]

:	DEFINE LOGON SELECTION DEFAULTS
:	--------------------------------
G.SELC	MACRO[
:	NOLIST
	HS	0
BEGORG	EQ	.
	HC	0
	AC	/LOGON SELECTION MENU/
	AC	/  /
	BC	((VERSION/8)&7)+0B0
	BC	(VERSION&7)+0B0
	AC	/./
	BC	((REVLEV/8)&7)+0B0
	BC	(REVLEV&7)+0B0
	AC	/ /
ENDORG	EQ	.
	ORG	BEGORG
	HC	ENDORG-BEGORG-2
	ORG	ENDORG
	LIST
	]

G.PRM1	MACRO[
	AC	/MANUAL LOGON/
	]

G.MOD1	EQ	0			:MAUNAL LOGON

G.DLIN	EQ	0FF			:WILD CARD MATCH
G.DCUA	EQ	0FF			:WILD CARD MATCH
G.DLUA	EQ	0FF			:WILD CARD MATCH
G.DCOL	EQ	0			:NO COLOR
G.DSIZ	EQ	0			:480
G.MENT	EQ	-1			:INIT MAX ENTRY

	SUBTTL ** SNA INIT ** NETWORK SERVICE DEFINITIONS


:	DNS.MENU(GHEAD,GHAE):
:	----------------
:	TO SPECIFY THE HEADING LINE FOR THE NETWORK SERVICE MENU
:	ARG:	GHEAD - TEXT FOR HEADING
:		GHAE - TEXT IN ASCII OR EBCDIC
DNS.MENU	MACRO(GHEAD,GHAE)[
:	NOLIST
	DSGEN(DNS.MENU,GHEAD)
	LVLCHK(MENLVL,DNS.MENU,GHEAD)
	IF	1-ERRFLG
	PMPRCK(TYPERR,DNS.MENU,GHEAD,PMSTRN)
	IF	1-ERRFLG
	KILL	G.NSMENU
G.NSMT	EQ	GHAE
G.NSMENU	MACRO[
:	NOLIST
	HS	0
BEGORG	EQ	.
	HC	0
	IF	G.NSMT
	XC	GHEAD
	XC	4040
	BC	((VERSION/8)&7)+0F0
	BC	(VERSION&7)+0F0
	XC	4B
	BC	((REVLEV/8)&7)+0F0
	BC	(REVLEV&7)+0F0
	BC	40
	ELSE
	AC	/GHEAD/
	AC	/  /
	BC	((VERSION/8)&7)+0B0
	BC	(VERSION&7)+0B0
	AC	/./
	BC	((REVLEV/8)&7)+0B0
	BC	(REVLEV&7)+0B0
	AC	/ /
	EI
ENDORG	EQ	.
	ORG	BEGORG
	HC	ENDORG-BEGORG-2
	ORG	ENDORG
	LIST
	]
	IF	DISPLY
	REMARK	%%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++%%
	REMARK	  NETWORK SERVICE MENU%
	REMARK	%    Network Menu for this Slot     = GHEAD
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	DNS.KEY(GKEY):
:	-------------
:	TO SPECIFY THE FUNCTION KEY OR PROGRAM KET USED TO ENTER
:	THE NETWORK SERVICE MODE
:	ARG:	GKEY - PF KEYS OR PA KEYS
DNS.KEY	MACRO(GKEY)[
:	NOLIST
	DSGEN(DNS.KEY,GKEY)
	LVLCHK(MENSLV,DLS.KEY,GKEY)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,DNS.KEY,GKEY,PMVALU,A,PF5,AVALUE)
	RNGCHK(TYPWNG,DNS.KEY,AVALUE,PMVALUE,A,PF1,PA3,PF5,BVALUE)
G.NSKY	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Net_Service Key for this Slot  = 
	IF	BVALUE-PF24
	REMARK	PA
	ELSE
	REMARK	PF
	EI
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	LIST
	]

:	DNS.WORD(GWORD,GWAE):
:	-----------------
:	TO SPECIFY THE KEYWORD FOR ENTERING THE NETWORK SERVICE MODE
:	ARG:	GWORD - WORD
:		GWAE - TEXT IN ASCII OR EBCDIC
G.KWDT	EQ	0
DNS.WORD	MACRO(GWORD,GWAE)[
:	NOLIST
	DSGEN(DNS.WORD,GWORD)
	LVLCHK(MENSLV,DNS.WORD,GWORD)
	IF	1-ERRFLG
	PMPRCK(TYPERR,DNS.WORD,GWORD,PMSTRN)
	IF	1-ERRFLG
	KILL	G.KWRD
G.KWDT	EQ	GWAE
G.KWRD	MACRO[
	HS	0
BEGORG	EQ	.
	HC	0
	IF	G.KWDT
	XC	GWORD
	ELSE
	AC	/GWORD/
	EI
ENDORG	EQ	.
	ORG	BEGORG
	HC	ENDORG-BEGORG-2
	ORG	ENDORG
	]
	IF	DISPLY
	REMARK	%    Net_Service Word for this Slot = GWORD
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

	SUBTTL ** SNA INIT ** LOGON SELECTION DEFINTIONS


:	DLG.SELECTION(GHEAD,GHAE):
:	---------------------
:	TO SPECIFY THE HEADING LNE FOR THE LOGON SELECTION MENU
:	ARG:	GHEAD - TEXT
:		GHAE - TEXT IN ASCII OR EBCDIC
G.SLET	EQ	ASCII
DLG.SELECTION	MACRO(GHEAD,GHAE)[
:	NOLIST
	DSGEN(DLG.SELECTION,GHEAD)
	LVLCHK(LGMLVL,DLG.SELECTION,GHEAD)
	IF	1-ERRFLG
	PMPRCK(TYPERR,DLG.SELECTION,GHEAD,PMSTRN)
	IF	1-ERRFLG
	KILL	G.SELC
G.SELT	EQ	GHAE
G.SELC	MACRO[
:	NOLIST
	HS	0
BEGORG	EQ	.
	HC	0
	IF	G.SELT
	XC	GHEAD
	XC	4040
	BC	((VERSION/8)&7)+0F0
	BC	(VERSION&7)+0F0
	BC	4B
	BC	((REVLEV/8)&7)+0F0
	BC	(REVLEV&7)+0F0
	BC	40
	ELSE
	AC	/GHEAD/
	AC	/  /
	BC	((VERSION/8)&7)+0B0
	BC	(VERSION&7)+0B0
	AC	/./
	BC	((REVLEV/8)&7)+0B0
	BC	(REVLEV&7)+0B0
	AC	/ /
	EI
ENDORG	EQ	.
	ORG	BEGORG
	HC	ENDORG-BEGORG-2
	ORG	ENDORG
	LIST
	]
	IF	DISPLY
	REMARK	%%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++%%
	REMARK	  LOGON SELECTION MENU%
	REMARK	%    Logon Menu for this Slot       = GHEAD
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	DLG.ENTRY(GENTRY):
:	------------------
:	TO SPECIFY THE ENTRY # OF THE LOGON SELECTION MENU
:	ARG:	GENTRY - ENTRY #
DLG.ENTRY	MACRO(GENTRY)[
:	NOLIST
	DSGEN(DLG.ENTRY,GENTRY)
	IF	.EQ.(CURLVL,LGMSSL)
CURLVL	EQ	LGMSLV			:ADJUST LEVEL
	EI
	LVLCHK(LGMSLV,DLG.ENTRY,GENTRY)
	IF	1-ERRFLG
	PMPRCK(TYPERR,DLG.ENTRY,GENTRY,PMVALU,A,,AVALUE)
	IF	1-ERRFLG
	RNGCHK(TYPERR,DLG.ENTRY,AVALUE,PBVALU,A,0,10,,BVALUE)
	IF	1-ERRFLG
	IF	1-.EQ.(G.MENT+1,BVALUE)
	ERROR(TYPERR,ERR15,Logon Entry Not in Sequence,1)
	ERRNXT(TYPERR,,1)
	REMARK	DLG.ENTRY(GENTRY)
	ERREND(TYPERR)
	EI
	IF	1-ERRFLG
ENT	EQ	BVALUE
G.MENT	EQ	ENT
EN.MAC	EQ	1			:ENTRY DEFINED
CLGLVL	EQ	0			:INIT LOGON RCD LEVEL
DLN|ENT|	EQ	-1		:INIT WILD CARD MATCH
DCU|ENT|	EQ	-1		:INIT WILD CARD MATCH
DLU|ENT|	EQ	-1		:INIT WILD CARD MATCH
DTP|ENT|	EQ	2		:INIT LU TYPE 2
DCO|ENT|	EQ	NO		:INIT NO COLOR
DSZ|ENT|	EQ	C1920		:INIT 1920 SCREEN
DCR|ENT|	EQ	1			:INIT CRM 1
	IF	DISPLY
	REMARK	%%  ----------------------------------------------------------%
	REMARK	   Entry - GENTRY
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	DLG.PROMPT(GTEXT,GTAE):
:	------------------
:	TO SPECIFY THE PROMPT MESSAGE ON THE LOGON SELECTION MENU
:	FOR CURRENT ENTRY
:	ARG:	GTEXT-	PROMPT TEXT
:		GTAE - TEXT IN ASCII OR EBCDIC
G.PRMT	EQ	0
DLG.PROMPT	MACRO(GTEXT,GTAE)[
:	NOLIST
	DSGEN(DLG.PRMPT,GTEXT)
	LVLCHK(LGMSSL,DLG.PROMPT,GTEXT)
	IF	1-ERRFLG
	PREQMC(DLG.ENTRY,EN.MAC,0,DLG.PROMPT,GTEXT)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,DLG.PROMPT,GTEXT,PMSTRN)
	IF	1-ERRFLG
	IF	\LGPMP|ENT|
	ERROR(TYPERR,ERR13,Logon Prompt Double Defined,1)
	ERRNXT(TYPERR,,1)
	REMARK	DLG.PROMPT(GTEXT,GTAE)
	ERREND(TYPERR)
	EI
	IF	1-ERRFLG
	KILL	LGPMP|ENT|
PRMT|ENT|	EQ	GTAE G.PRMT
FLGPM|ENT|	EQ	1
LGPMP|ENT|	MACRO(CHS)[
	HS	0
BEGORG	EQ	.
	HC	0
	IF	PRMT|CHS|
	XC	GTEXT
	ELSE
	AC	/GTEXT/
	EI
ENDORG	EQ	.
	ORG	BEGORG
	HC	ENDORG-BEGORG-2
	ORG	ENDORG
	]
	IF	DISPLY
	REMARK	%    Logon Prompt for this Entry    = GTEXT
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	DLG.MODE(GMODE):
:	--------------------
:	TO SPECIFY THE LOGON MODE OF THIS ENTRY ON THE LOGON 
:	SELECTION MENU
:	ARG:	GMODE - MANUAL/PRESET
MANUAL	EQ	0			:MANUAL LOGON MODE
PRESET	EQ	1			:PRESET LOGON MODE
DLG.MODE	MACRO(GMODE)[
:	NOLIST
	DSGEN(DLG.MODE,GMODE)
	LVLCHK(LGMSSL,DLG.MODE,GMODE)
	IF	1-ERRFLG
	PREQMC(DLG.ENTRY,EN.MAC,0,DLG.MODE,GMODE)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,DLG.MODE,GMODE,PMSTRN)
	IF	1-ERRFLG
	IF	\LGMOD|ENT|
	ERROR(TYPERR,ERR13,Logon Mode Double Defined,1)
	ERRNXT(TYPERR,,1)
	REMARK	DLG.MODE(GMODE)
	ERREND(TYPERR)
	EI
	IF	1-ERRFLG
LGMOD|ENT|	EQ	GMODE
	IF	DISPLY
	REMARK	%    Logon Mode for this Entry      = GMODE
	EI	(DISPLY)
	EI	(1-ERRFLG
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	DLG.LOGON(GLEVEL,GSTRN):
:	--------------------
:	TO SPECIFY THE LOGON STRING FOR THE PRESET LOGON OF THIS
:	ENTRY ON THE LOGON SELECTION MENU
:	ARGS:	GSTRN - LEGAL LOGON STRING
:		GLEVEL - LOGON LEVEL
DLG.LOGON	MACRO(GLEVEL,GSTRN)[
	IF	DSPGEN
	REMARK	%DLG.LOGON(GLEVEL,GSTRN)
	REMARK%
	EI	DSPGEN
	IF	.LT.(LGMSSL,CURLVL)
	ERROR(TYPERR,ERR07,Sysgen Statement not at Correct Level,1)
	ERRNXT(TYPERR,,1)
	REMARK	DLG.LOGON(GLEVEL,GSTRN)
	ERREND(TYPERR)
	ELSE
CURLVL	EQ	LGMSSL
	EI				:END OF LEVEL CHECK
	IF	1-ERRFLG
	IF	1-EN.MAC		:BEGIN PREQMC CHECK
	ERROR(TYPERR,ERR08,Pre-Requested Macro Not Defined,1)
	ERRNXT(TYPERR,,1)
	REMARK	DLG.LOGON(GLEVEL,GSTRN)
	ERREND(TYPERR)
	EI				:END OF PREQMC CHECK
	IF	1-ERRFLG
	ORG	0			:BEGIN PARAMETER PRESEN CHECK
	AC	/GSTRN/
IZ	EQ	.
	ORG	0
	AC	/GLEVEL/
IY	EQ	.
	ORG	0
	IF	(1-IZ)!(1-IY)
	ERROR(TYPERR,ERR14,Logon Parameter Missing,1)
	ERRNXT(TYPERR,,1)
	REMARK	DLG.LOGON(GLEVEL,GSTRN)
	ERREND
	EI				:END OF PARAMETERS PRESETN CHECK
	IF	1-.EQ.(CLGLVL,GLEVEL)
	ERROR(TYPERR,ERR09,Logon String Statement Level not in Sequence,1)
	ERRNXT(TYPERR,,1)
	REMARK	DLG.LOGON(GLEVEL,GSTRN)
	ERREND(TYPERR)
	EI
	IF	1-ERRFLG
	IF	GLEVEL-4
	ERROR(TYPERR,ERR17,Logon Parameter Level Too Large,1)
	ERRNXT(TYPERR,,1)
	REMARK	DLG.LOGON(GLEVEL,GSTRN)
	ERREND(TYPERR)
	EI				:END OF RANGE CHECK
	IF	1-ERRFLG
LVL	EQ	GLEVEL
CLGLVL	EQ	GLEVEL+1
G.LGV|ENT|	EQ	CLGLVL
	KILL	G.LG|ENT||LVL|
G.LG|ENT||LVL|	MACRO[
	SC	/GSTRN/
	]
F.LG|ENT||LVL|	EQ	1
	IF	DISPLY
	REMARK	%    Level GLEVEL 
	REMARK	Logon String           = GSTRN
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	DLG.LINE(GLINE):
:	--------------
:	TO SPECIFY THE DESINATION LINE # TO BE ATTACHED FOR PRESET
:	LOGON
:	ARG: GLINE - LINE # [-1, 0FF]
DLG.LINE	MACRO(GLINE)[
:	NOLIST
	DSGEN(DLG.LINE,GLINE)
	LVLCHK(LGMSSL,DLG.LINE,GLINE)
	IF	1-ERRFLG
	PREQMC(DLG.ENTRY,EN.MAC,0,DLG.LINE,GLINE)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,DLG.LINE,GLINE,PMVALU,0,-1,AVALUE)
	RNGCHK(TYPWNG,DLG.LINE,AVALUE,PMVALU,0,-1,0FF,0FF,BVALUE)
DLN|ENT|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Logon DLINE for this Entry     = 
	DSPNUM(BVALUE,0)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	DLG.PUADDR(GCUADR)
:	------------------
:	TO SPECIFY THE DESTINATION CU ADDR TO BE ATTACHED FOR PRESET
:	LOGON ONLY
:	ARG:	GCUADR - CU ADDR [-1, 0FF]
DLG.PUADDR	MACRO(GCUADR)[
:	NOLIST
	DSGEN(DLG.PUADDR,GCUADR)
	LVLCHK(LGMSSL,DLG.PUADDR,GCUADR)
	IF	1-ERRFLG
	PREQMC(DLG.ENTRY,EN.MAC,0,DLG.PUADDR,GCUADR)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,DLG.PUADDR,GCUADR,PMVALU,0,0FF,AVALUE)
	RNGCHK(TYPWNG,DLG.PUADDR,AVALUE,PMVALU,0,-1,0FF,0FF,BVALUE)
DCU|ENT|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Logon DCU for this Entry       = 
	DSPNUM(BVALUE,0)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	DLG.LUADDR(GLUADR)
:	-------------------
:	TO SPECIFY THE DESTINATION LU ADDR TO BE ATTACHED FOR PRESET
:	LOGON ONLY
:	ARG:	GLUADR - LU ADDR [-1, 0FF]
DLG.LUADDR	MACRO(GLUADR)[
:	NOLIST
	DSGEN(DLG.LUADDR,GLUADR)
	LVLCHK(LGMSSL,DLG.LUADDR,GLUADR)
	IF	1-ERRFLG
	PREQMC(DLG.ENTRY,EN.MAC,0,DLG.LUADDR,GLUADR)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,DLG.LUADDR,GLUADR,PMVALU,0,0FF,AVALUE)
	RNGCHK(TYPWNG,DLG.LUADDR,AVALUE,PMVALU,0,-1,0FF,0FF,BVALUE)
DLU|ENT|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Logon DLU for this Entry       = 
	DSPNUM(BVALUE,0)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	DLG.LTYPE(GLTYPE):
:	-------------------
:	TO SPECIFY THE DESIRED LU TYPE  ON THE DESTINATION
:	DEVICE, FOR PRESET LOGON ONLY
:	ARG:	GLTYPE - 2 OR 3
DLG.LTYPE	MACRO(GLTYPE)[
:	NOLIST
	DSGEN(DLG.LTYPE,GLTYPE)
	LVLCHK(LGMSSL,DLG.LTYPE,GLTYPE)
	IF	1-ERRFLG
	PREQMC(DLG.ENTRY,EN.MAC,0,DLG.LTYPE,GLTYPE)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,DLG.LTYPE,GLTYPE,PMVALU,A,2,AVALUE)
	RNGCHK(TYPWNG,DLG.LTYPE,AVALUE,PMVALU,A,2,3,2,BVALUE)
DTP|ENT|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Logon DLTYPE for this Entry    = 
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	DLG.COLOR(GCOLOR):
:	-------------------
:	TO SPECIFY THE DESIRED COLOR CAPABILITY ON THE DESTINATION
:	DEVICE, FOR PRESET LOGON ONLY
:	ARG:	GCOLOR - YES/NO
DLG.COLOR	MACRO(GCOLOR)[
:	NOLIST
	DSGEN(DLG.COLOR,GCOLOR)
	LVLCHK(LGMSSL,DLG.COLOR,GCOLOR)
	IF	1-ERRFLG
	PREQMC(DLG.ENTRY,EN.MAC,0,DLG.COLOR,GCOLOR)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,DLG.COLOR,GCOLOR,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,DLG.COLOR,AVALUE,PMVALU,A,0,1,0,BVALUE)
DCO|ENT|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Logon DCOLOR for this Entry    = 
	IF	BVALUE
	REMARK	Color
	ELSE
	REMARK	Non_Color
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	DLG.SIZE(GSIZE)
:	---------------
:	TO SPECIFY THE DESIRED DEVICE SIZE ON THE DESTINCATION 
:	DEVICE, FOR PRESET LOGON ONLY
:	ARG:	GSIZE - 480, 1920, ETC..
DLG.SIZE	MACRO(GSIZE)[
:	NOLIST
	DSGEN(DLG.SIZE,GSIZE)
	LVLCHK(LGMSSL,DLG.SIZE,GSIZE)
	IF	1-ERRFLG
	PREQMC(DLG.ENTRY,EN.MAC,0,DLG.SIZE,GSIZE)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,DLG.SIZE,GSIZE,PMVALU,A,1920,AVALUE)
	RNGCHK(TYPWNG,DLG.SIZE,AVALUE,PMVALU,A,480,1920,1920,BVALUE)
DSZ|ENT|	EQ	C|$ABVALUE|
	IF	DISPLY
	REMARK	%    Logon DSIZE for this Entry     = 
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	DLG.CHRSET(GCHRST)
:	---------------
:	TO SPECIFY THE DESIRED CHAR SET ON THE DESTINCATION 
:	DEVICE, FOR PRESET LOGON ONLY
:	ARG:	GCHRST - ENGLISH, KATAKANA, AND KANJI
DLG.CHRSET	MACRO(GCHRST)[
:	NOLIST
	DSGEN(DLG.CHRSET,GCHRST)
	LVLCHK(LGMSSL,DLG.CHRSET,GCHRST)
	IF	1-ERRFLG
	PREQMC(DLG.ENTRY,EN.MAC,0,DLG.SIZE,GCHRST)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,DLG.CHRSET,GCHRST,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,DLG.CHRSET,AVALUE,PMVALU,A,0,5,0,BVALUE)
DCH|ENT|	EQ	BVALUE
	IF	BVALUE-3
JAPANESE	EQ	1
	EI	(BVALUE)
	IF	DISPLY
	REMARK	%    Logon CHAR SET for this Entry  = 
	IF	BVALUE
	REMARK	Kanji and Katakana
	ELSE	BVALUE-3
	REMARK	Katakana
	ELSE
	REMARK	English
	EI
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	DLG.CRM(GCRM)
:	---------------
:	TO SPECIFY THE DESIRED CRM MODE ON THE DESTINCATION 
:	DEVICE, FOR PRESET LOGON ONLY
:	ARG:	GCRM - 1,2,3,4
DLG.CRM	MACRO(GCRM)[
:	NOLIST
	DSGEN(DLG.CRM,GCRM)
	LVLCHK(LGMSSL,DLG.CRM,GCRM)
	IF	1-ERRFLG
	PREQMC(DLG.ENTRY,EN.MAC,0,DLG.CRM,GCRM)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,DLG.CRM,GCRM,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,DLG.CRM,AVALUE,PMVALU,A,1,4,1,BVALUE)
DCR|ENT|	EQ	$ABVALUE
	IF	DISPLY
	REMARK	%    Logon CRM for this Entry       = 
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

	SUBTTL ** SNA INIT ** INITIALIZATION - LINE STATEMENTS


:	LINE(NLNE):
:	------------
:	DESCRIPTION: THIS STATEMENT SPECIFIES THE BEGINING OF THE DEFINITION
:	OF SDLC CHARACTERISTICS	FOR AN SDLC LINE. FOR EACH OF THE SIO LINES,
:	THERE MUST BE ONE LINE STATEMENT ASSOCIATED WITH IT.
:	ARGS:	NLNE	- LOGICAL LINE NUMBER
:			  RADIX: DECIMAL
:			  RANGE: 0 =< NLNE <16
:			  DEFAULT: NONE
NSLINE	EQ	0			:INIT TO 0
LINE	MACRO(NLNE)[
:	NOLIST
	DSGEN(LINE,NLNE)
LN.ERR	EQ	1			:PRESET ERR CONDITION (I01/8/28/87/HS)
	IF	.LT.(LINLVL,CURLVL)
CURLVL	EQ	LINLVL			:ADJUST
	EI
	LVLCHK(LINLVL,LINE,NLNE)			:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,LINE,NLNE,PMVALU,A,,AVALUE)
	IF	1-ERRFLG
	RNGCHK(TYPERR,LINE,NLNE,PMVALU,A,0,15,,BVALUE)
	IF	1-ERRFLG
LNE	EQ	BVALUE

:(I02/11/23/87/START)
	IF 	1-.EQ.(LNEN+1,BVALUE)	
	ERROR(TYPERR,ERR08,LINE NOT DEFINED CONSECUTIVELY,1)
	ERRNXT(TYPERR,,1)
	REMARK	LINE(NLNE)
	ERREND(TYPERR)
	EI
:(I02/11/23/87/HS/END)

	IF	\LINE|LNE|
	ERROR(TYPERR,ERR10,Line Double Defined,1)
	ERRNXT(TYPERR,,1)
	REMARK	LINE(NLNE)
	ERREND
	EI	(\LINE|LNE|)
LNEN	EQ	BVALUE			:(I02/11/23/87/HS)
LINE|LNE|	EQ	BVALUE
NSLINE	EQ	NSLINE+1		:TALLY LINE NUMBER
MSTN|LNE|	EQ	0		:INIT
PUN	EQ	-1			:INIT
LINK|LNE|	EQ	G.LINK		:INIT
SPED|LNE|	EQ	G.SPED		:INIT
MODE|LNE|	EQ	G.MODE		:INIT
DIAL|LNE|	EQ	G.DIAL		:INIT
SDTR|LNE|	EQ	G.SDTR		:INIT
SRTS|LNE|	EQ	G.SRTS		:INIT
LIAC|LNE|	EQ	G.IATM		:INIT
LDSC|LNE|	EQ	G.DSTM		:INIT
RPTM|LNE|	EQ	G.RPTM		:INIT
FRMS|LNE|	EQ	G.FRMS		:INIT
WDWS|LNE|	EQ	G.WDWS		:INIT
RTYM|LNE|	EQ	G.RTYM		:INIT
RTYT|LNE|	EQ	G.RTYT		:INIT
RTYN|LNE|	EQ	G.RTYN		:INIT
PUSE|LNE|	EQ	G.PAUS		:INIT
RFRN|LNE|	EQ	G.RFRN		:INIT
SIOH|LNE|	EQ	G.SIOH		:INIT
EXT.S|LNE|	EQ	G.EXTS		:INIT
LN.MAC	EQ	1			:TURN ON LINE MACRO DEFINED SW
PU.MAC	EQ	0			:TURN OFF PU MACRO DEFINED SW
LU.MAC	EQ	0			:TURN OFF LU MACRO DEFINED SW
ET.MAC	EQ	0			:TURN OFF LU.ENTRY MACRO DEFINED SW
PV.MAC	EQ	0			:TURN OFF LU.PVCRY MACRO DEFINED SW
:(I3.02/8/20/87/ACH/BEGIN)
RUCHN|LNE|	EQ	G.SRUCH		:(0=MULTIPLE, 1=SINGLE CHAINS)
RSPCL|LNE|	EQ	G.CLR		:(0=NEG RSP, 1=POS RSP)
SNADL|LNE|	EQ	G.SDLC		:(0=SNA, 1=SDLC)
LN.ERR	EQ	0			:RESET ERR CONDITION (I01/8/28/87/HS)
:(I3.02/8/20/87/ACH/END)
	IF	DISPLY
	REMARK	%%%==========================================================%%
	REMARK	  LINE - NLNE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

	SUBTTL ** SNA INIT ** LINE - OPERANDS STATEMENTS


:	PRIMARY():
:	----------
:	TO SPECIFY THE SDLC LINE IS A PRIMARY LINE (TERMINAL)
:	ARGS:	NONE
PRIMARY	MACRO[
	DSGEN(PRIMARY)
	LVLCHK(LINSLV,PRIMARY)
	IF	1-ERRFLG
	PREQMC(LINE,LN.MAC,LN.ERR,PRIMARY)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
LINK|LNE|	EQ	PRIMRY
	IF	DISPLY
	REMARK	%    Link Protocol for this Line   = Primary
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	SECONDARY():
:	-----------
:	TO SPECIFY THE SDLC LINE FOR ALL NODES ON THIS LINK ARE SECONDARY
:	ARGS:	NONE
SECDRY	EQ	0			:
SECONDARY	MACRO[
	DSGEN(SECONDARY)
	LVLCHK(LINSLV,SECONDARY)
	IF	1-ERRFLG
	PREQMC(LINE,LN.MAC,LN.ERR,SECONDARY)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
LINK|LNE|	EQ	SECDRY
	IF	DISPLY
	REMARK	%    Link Protocol for this Line    = Secondary
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	HOST(SHOST):
:	------------
:	TO SPECIFY THE SNA HOST # FOR ALL THE NODES WITHIN
:	THIS LINE.
:	ARGS:	SHOST	- SECONDARY LINK'S HOST#
HOST	MACRO(SHOST)[
:	NOLIST
	DSGEN(HOST,SHOST)
	LVLCHK(LINSLV,HOST,SHOST)
	IF	1-ERRFLG
	PREQMC(LINE,LN.MAC,LN.ERR,HOST,SHOST)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,HOST,SHOST,PMVALU,A,,AVALUE)
	IF	1-ERRFLG
	RNGCHK(TYPERR,HOST,AVALUE,PMVALU,A,1,9999,,BVALUE)
	IF	1-ERRFLG
SHOS|LNE|	EQ	$A SHOST
	IF	DISPLY
	REMARK	%    Host # for this Line           = 
	NUMBER	$A SHOST
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	SPEED(SSPED)
:	------------
:	TO SPECIFY THE SDLC LINE TRANSMISSION SPEED FOR
:	ALL THE NODES WITHIN THIS LINE.
:	ARGS:	SSPED	- LINE SPEED
SPEED	MACRO(SSPED)[
:	NOLIST
	DSGEN(SPEED,SSPED)
	LVLCHK(LINSLV,SPEED,SSPED)
	IF	1-ERRFLG
	PREQMC(LINE,LN.MAC,LN.ERR,SPEED,SSPED)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,SPEED,SSPED,PMVALU,A,9600,AVALUE)
	IF	1-ERRFLG				:(I01/8/28/87/HS)
	IF	1-\SP|AVALUE|
	ERROR(TYPERR,ERR10,Value not Within Range {2.4k 4.8k 9.6k 19.2k 56k},1)
	ERRNXT(TYPERR,,1)
	REMARK	SPEED(SSPED)
	ERREND(TYPERR)
	ELSE
SPED|LNE|	EQ	AVALUE
	IF	DISPLY
	REMARK	%    Trans. Speed for this Line     = 
	NUMBER	$A AVALUE
	REMARK	 Bits/Sec.
	EI	(DISPLY)
	EI	(1-\SP|AVALUE|)
	EI	(1-ERRFLG)				:(I01/8/28/87/HS)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	DATAMODE(DMODE):
:	-----------------
:	TO SPECIFY THE SDLC LINE DATA TRANSMISSION DATA
:	MODE. (I.E. PROTOCOL DATA MODE).
:	ARGS:	DMODE	- KEYWORDS: 'HALF', 'HALFDUPLEX',
:			   'FULL', OR 'FULLDUPLEX'.
DATAMODE	MACRO(DMODE)[
:	NOLIST
	DSGEN(DATAMODE,DMODE)
	LVLCHK(LINSLV,DATAMODE,DMODE)
	IF	1-ERRFLG
	PREQMC(LINE,LN.MAC,LN.ERR,DATAMODE,DMODE)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,DATAMODE,DMODE,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,DATAMODE,DMODE,PMVALU,A,0,1,1,BVALUE)
MODE|LNE|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Data Mode for this Line        = 
	IF	BVALUE
	REMARK	Half_Duplex
	ELSE
	REMARK	Full_Duplex
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	DIAL(SDIAL):
:	--------------
:	TO SPECIFY WHETHER THE LINK CAN DIAL THE EXTERNAL SYSTEMS
:	IF YES, WHEN CALL ARRIVING, THE INTERFACE RAISE DTR TO SIGNAL
:	THE HOST
:	ARGS:	SDIAL	- KEYWORDS 'YES', OR 'NO'
DIAL	MACRO(SDIAL)[
:	NOLIST
	DSGEN(DIAL,SDIAL)
	LVLCHK(LINSLV,DIAL,SDIAL)
	IF	1-ERRFLG
	PREQMC(LINE,LN.MAC,LN.ERR,DIAL,SDIAL)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,DIAL,SDIAL,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,DIAL,SDIAL,PMVALU,A,0,1,0,BVALUE)
DIAL|LNE|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Dial  Up  Mode for this Line   = 
	IF	BVALUE
	REMARK	Dial
	ELSE
	REMARK	Non_Dial
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	EXT.SY(SEXTSY):
:	--------------
:	TO SPECIFY THE EXTERNAL SYSTEM CONNECTED TO THIS LINK.
:	THE SUPPORT TYPES OF VENDOR SYSTEMS ARE:
:		IBM - USA LANGUAGE
:		FUJITSU- FUJITSU 
:		HITACHI- HITACHI
:	ARGS:	SEXTSY	- KEYWORDS 'IBM' OR 'FUJITSU' OR 'HITACHI'.
EXT.SY	MACRO(SEXTSY)[
:	NOLIST
	DSGEN(EXT.SY,SEXTSY)
	LVLCHK(LINSLV,EXT.SY,SEXTSY)
	IF	1-ERRFLG
	PREQMC(LINE,LN.MAC,LN.ERR,EXT.SY,SEXTSY)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,EXT.SY,SEXTSY,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,EXT.SY,SEXTSY,PMVALU,A,0,3,0,BVALUE)
EXT.S|LNE|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    External system for this Line  = 
	IF	BVALUE-1
	REMARK	Hitachi System
	ELSE	BVALUE
	REMARK	Fujitsu System
	ELSE
	REMARK	IBM System
	ELSE
	REMARK	IBM System
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	DTRDSR(DSDTR):
:	-----------------
:	TO SPECIFY THE SDLC LINE'S ELECTRICAL SIGNAL
:	CHARACTERISTICS. THIS FUNCTION WILL SPECIFY
:	THE DTR/DSR HANDSHAKING REQUIREMENT.
:	ARGS:	DSDTR	- KEYWORD 'YES' OR 'NO'
DTRDSR	MACRO(DSDTR)[
:	NOLIST
	DSGEN(DTRDSR,DSDTR)
	LVLCHK(LINSLV,DTRDSR,DSDTR)
	IF	1-ERRFLG
	PREQMC(LINE,LN.MAC,LN.ERR,DTRDSR,DSDTR)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,DTRDSR,DSDTR,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,DTRDSR,DSDTR,PMVALU,A,0,1,1,BVALUE)
SDTR|LNE|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    DTR/DSR Signals for this Line  = 
	IF	BVALUE
	REMARK	Required
	ELSE
	REMARK	Not_Required
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERFLG)
	EI	(1-ERFLG)
	LIST
	]

:	RUCHAIN(DSRUCH)
:	-----------------
:	TO SPECIFY IF THE SINGLE RU CHAIN IS REQUIRED
:	BY THIS LINE.
:	ARGS:	DSRUCH	- KEYWORD 'YES' OR 'NO'
:		YES - SINGLE RU CHAIN
:		NO  - MULTIPLE RU CHAIN
RUCHAIN	MACRO(DSRUCH)[
:	NOLIST
	DSGEN(RUCHAIN,DSRUCH)
	LVLCHK(LINSLV,RUCHAIN,DSRUCH)
	IF	1-ERRFLG
	PREQMC(LINE,LN.MAC,LN.ERR,RUCHAIN,DSRUCH)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,RUCHAIN,DSRUCH,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,RUCHAIN,DSRUCH,PMVALU,A,0,1,1,BVALUE)
RUCHN|LNE|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Single RU Chain for this Line  = 
	IF	BVALUE
	REMARK	Required
	ELSE
	REMARK	Not_Required
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERFLG)
	EI	(1-ERFLG)
	LIST
	]

:	RSPCLEAR(DSRCLR):
:	-----------------
:	TO SPECIFY IF THE CLEAR RSP IS REQUIRED BY
:	THE LINE.
:	ARGS:	DSRCLR	- KEYWORD 'YES' OR 'NO'
:		YES - CLEAR RSP IS REQUIRED
:		NO  - CLEAR RSP IS NOT REQUIRED
RSPCLEAR	MACRO(DSRCLR)[
:	NOLIST
	DSGEN(RSPCLEAR,DSRCLR)
	LVLCHK(LINSLV,RSPCLEAR,DSRCLR)
	IF	1-ERRFLG
	PREQMC(LINE,LN.MAC,LN.ERR,RSPCLEAR,DSRCLR)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,RSPCLEAR,DSRCLR,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,RSPCLEAR,DSRCLR,PMVALU,A,0,1,1,BVALUE)
RSPCL|LNE|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Clear Rsp for this Line  = 
	IF	BVALUE
	REMARK	Required
	ELSE
	REMARK	Not_Required
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERFLG)
	EI	(1-ERFLG)
	LIST
	]

:	RTSCTS(DSRTS):
:	--------------
:	TO SPECIFY THE SDLC LINE'S ELECTRICAL SIGNAL
:	CHARACTERISTICS. THIS FUNCTION WILL SPECIFY
:	THE RTS/CTS HANDSHAKING REQUIREMENT PRIOR TO
:	THE TRANSMISSION OF A FRAME.
:	ARGS:	DSRTS	- KEYWORD 'YES' OR 'NO'.
RTSCTS	MACRO(DSRTS)[
:	NOLIST
	DSGEN(RTSCTS,DSRTS)
	LVLCHK(LINSLV,RTSCTS,DSRTS)
	IF	1-ERRFLG
	PREQMC(LINE,LN.MAC,LN.ERR,RTSCTS,DSRTS)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,RTSCTS,DSRTS,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,RTSCTS,DSRTS,PMVALU,A,0,1,1,BVALUE)
SRTS|LNE|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    RTS/CTS Signals for this Line  = 
	IF	BVALUE
	REMARK	Required
	ELSE
	REMARK	Not_Required
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	INACTM(DIATIM):
:	--------------
:	TO SPECIFY THE SDLC LINK'S INACTIVITY TIMER, IN MINUTES, FOR THE LIN.
:	IF THERE IS NO INF FRAME SENT OR RECEIVED,
:	LINK WILL BE BROKEN.
:	ARGS:	DIATIM	- TIMEOUT VALE, IN MINUTES
INACTM	MACRO(DIATIM)[
:	NOLIST
	DSGEN(INACTM,DIATIM)
	LVLCHK(LINSLV,INACTM,DIATIM)
	IF	1-ERRFLG
	PREQMC(LINE,LN.MAC,LN.ERR,INACTM,DIATIM)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,INACTM,DIATIM,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,INACTM,DIATIM,PMVALU,A,0,32764,0,BVALUE)
LIAC|LNE|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Link-Inactivity for this Line  = 
	NUMBER	$A BVALUE
	REMARK	 Min.
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	LDSCTM(DSCTIM):
:	--------------
:	TO SPECIFY THE OFF TIME (I.E. DROP DTR) FOR A DIAL UP LINK, IN SECONDS,
:	FOR THE LINE.
:	ARGS:	DSCTIM	- DURATION, IN SECONDS
LDSCTM	MACRO(DSCTIM)[
:	NOLIST
	DSGEN(LDSCTM,DSCTIM)
	LVLCHK(LINSLV,LDSCTM,DSCTIM)
	IF	1-ERRFLG
	PREQMC(LINE,LN.MAC,LN.ERR,LDSCTM,DSCTIM)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,LDSCTM,DSCTIM,PMVALU,A,5,AVALUE)
	RNGCHK(TYPWNG,LDSCTM,DSCTIM,PMVALU,A,0,32764,5,BVALUE)
LDSC|LNE|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Link-Off Time for this Line    = 
	NUMBER	$A BVALUE
	REMARK	 Sec.
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	REPLTO(DTMOT):
:	--------------
:	TO SPECIFY THE REPLY TIMOUT VALUE, IN SECONDS, FOR
:	THE LINE/LINE GROUP.
:	ARGS:	DTMOT	- TIMEOUT VALUE, IN SECONDS
REPLYTO	MACRO(DTMOT)[
:	NOLIST
	DSGEN(REPLTO,DTMOT)
	LVLCHK(LINSLV,REPLTO,DTMOT)
	IF	1-ERRFLG
	PREQMC(LINE,LN.MAC,LN.ERR,REPLTO,DTMOT)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,REPLTO,DTMOT,PMVALU,A,3,AVALUE)
	RNGCHK(TYPWNG,REPLTO,DTMOT,PMVALU,A,1,255,3,BVALUE)
RPTM|LNE|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Reply_Timout for this Line     = 
	NUMBER	$A BVALUE
	REMARK	 Sec.
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	FRAMESIZE(DFRMS):
:	------------------
:	TO SPECIFY THE MAXIMUM SIZE IN BYTES A SINGLE FRAME
:	COULD BE TRANSMITTED OR RECEIVED.
:	ARGS:	DFRMS	- MAX. FRAME SIZE IN BYTES
FRAMESIZE	MACRO(DFRMS)[
:	NOLIST
	DSGEN(FRAMESIZE,DFRMS)
	LVLCHK(LINSLV,FRAMESIZE,DFRMS)
	IF	1-ERRFLG
	PREQMC(GENRANL,LN.MAC,LN.ERR,FRAMESIZE,DFRMS)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,FRAMESIZE,DFRMS,PMVALU,A,270,AVALUE)
	RNGCHK(TYPWNG,FRAMESIZE,AVALUE,PMVALU,A,8,6000,270,BVALUE)
FRMS|LNE|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Framesize for this Line        = 
	NUMBER	$A BVALUE
	REMARK	 Bytes
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	WINDOWSIZE(DWDWS):
:	----------------
:	TO SPECIFY THE MAXIMUM OUTSTANDING WINDOW SIZE.
:	ARGS:	DWDWS	- 1, 2, 3, 4, 5, 6, OR 7 FRAMES
WINDOWSIZE	MACRO(DWDWS)[
:	NOLIST
	DSGEN(WINDOWSIZE,DWDWS)
	LVLCHK(LINSLV,WINDOWSIZE,DWDWS)
	IF	1-ERRFLG
	PREQMC(LINE,LN.MAC,LN.ERR,WINDOWSIZE,DWDWS)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,WINDOWSIZE,DWDWS,PMVALU,A,7,AVALUE)
	IF	1-\WIW|AVALUE|
	ERROR(TYPERR,ERR11,Value not Within Range {1 2 3 4 5 6 7},1)
	ERRNXT(TYPERR,,1)
	REMARK	WINDOWSIZE(DWDWS)
	ERREND(TYPERR)
	ELSE			:(\WIW|AVALUE|)
WDWS|LNE|	EQ	AVALUE
	IF	DISPLY
	REMARK	%    Windowsize for this Line       = 
	NUMBER	$A AVALUE
	REMARK	 Frames
	EI	(DISPLY)
	EI	(1-\WIW|AVALUE|)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	MACRO:	XXX.RETRIES
:	---------------------
:	TO SPECIFY THE NUMBER OF ATTEMPTS, VIA
:	RETRANSMISSION, TO RECOVER FROM TEXT ERRORS IN
:	MESSAGE DATA TRANSMITTED OVER A LINK.
:	PLEASE SEE SNA SYSGEN MANUAL FOR MORE INFORMATION.
:
:	THREE MACROS' ARE DEFINED FOR RETIRES:
:	NUM.RETRIES:	NUMBER OF RETRY IN EACH SEQUENCE
:	PAUS.RETRIES:	PAUSE BETWEEN RETRY SEQUENCES
:	SEQ.RETRIES:	NUMBER OF RETRY SEQUENCES
:


:	NUM.RETRIES(DRTYM):
:	-------------------
:	TO SPECIFY THE NUMBER OF RETRY WITHIN ONE SEQUENCE
:	ARGS:	DRTYM	- NUMBER OF RETRY
NUM.RETRIES	MACRO(DRTYM)[
:	NOLIST
	DSGEN(NUM.RETRIES,DRTYM)
	LVLCHK(LINSLV,NUM.RETRIES,DRTYM)
	IF	1-ERRFLG
	PREQMC(LINE,LN.MAC,LN.ERR,NUM.RETRIES,DRTYM)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,NUM.RETRIES,DRTYM,PMVALU,A,3,AVALUE)
	RNGCHK(TYPWNG,NUM.RETRIES,AVALUE,PMVALU,A,1,255,3,BVALUE)
RTYM|LNE|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    NUM.Retries for this Line      = 
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	PAUS.RETRIES(DRTYT):
:	-------------------
:	TO SPECIFY THE PAUSE OF RETRY BETWRRN SEQUENCES
:	ARGS:	DRTYT	- PAUSE IN SEC.
PAUS.RETRIES	MACRO(DRTYT)[
:	NOLIST
	DSGEN(PAUS.RETRIES,DRTYT)
	LVLCHK(LINSLV,PAUS.RETRIES,DRTYT)
	IF	1-ERRFLG
	PREQMC(LINE,LN.MAC,LN.ERR,PAUS.RETRIES,DRTYT)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,PAUS.RETRIES,DRTYT,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,PAUS.RETRIES,AVALUE,PMVALU,A,1,255,0,BVALUE)
RTYT|LNE|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    PAUS.Retries for this Line     = 
	NUMBER	$A BVALUE
	REMARK	 Sec.
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	SEQ.RETRIES(DRTYN):
:	-------------------
:	TO SPECIFY THE NUMBER OF RETRYE QUENCE SEQUENCES
:	ARGS:	DRTYN	- NUMBER OF RETRY SEQUENCES
SEQ.RETRIES	MACRO(DRTYN)[
:	NOLIST
	DSGEN(SEQ.RETRIES,DRTYN)
	LVLCHK(LINSLV,SEQ.RETRIES,DRTYN)
	IF	1-ERRFLG
	PREQMC(LINE,LN.MAC,LN.ERR,SEQ.RETRIES,DRTYN)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,SEQ.RETRIES,DRTYN,PMVALU,A,3,AVALUE)
	RNGCHK(TYPWNG,SEQ.RETRIES,AVALUE,PMVALU,A,1,255,3,BVALUE)
RTYN|LNE|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    SEQ.Retries for this Line      = 
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	PAUSE(SGPAUS):
:	------------
:	TO SPECIFY THE AVERAGE DURATION OF THE POLLING
:	CYCLE IN SECONDS.
:	PLEASE SEE SNA SYSGEN MANUAL FOR MORE INFORMATION.
:	ARGS:	SGPAUS	- PAUSE IN SECONDS
PAUSE	MACRO(SGPAUS)[
:	NOLIST
	DSGEN(PAUSE,SGPAUS)
	LVLCHK(LINSLV,PAUSE,SGPAUS)
	IF	1-ERRFLG
	PREQMC(LINE,LN.MAC,LN.ERR,PAUSE,SGPAUS)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,PAUSE,SGPAUS,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,PAUSE,AVALUE,PMVALU,A,1,255,1,BVALUE)
PUSE|LNE|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Polling Pause for this Line    = 
	NUMBER	$A BVALUE
	REMARK	 Sec.
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	RCVSIOFR(SRFRN):
:	----------------
:	TO SPECIFY THE SIO BUFFER ROOM IN NUMBER OF FRAMES
:	ALLOCATED FOR THE RCV FOR EACH SDLC STATION
:	ARGS:	SRFRN	- NUMBER OF FRAMES
RCVSIOFR	MACRO(SRFRN)[
:	NOLIST
	DSGEN(RCVSIOFR,SRFRN)
	LVLCHK(LINSLV,RCVSIOFR,SRFRN)
	IF	1-ERRFLG
	PREQMC(LINE,LN.MAC,LN.ERR,RCVSIOFR,SRFRN)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,RCVSIOFR,SRFRN,PMVALU,A,8,AVALUE)
	RNGCHK(TYPWNG,RCVSIOFR,AVALUE,PMVALU,A,2,8,8,BVALUE)
RFRN|LNE|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Rcvsiofr for this Line         = 
	NUMBER	$A BVALUE
	REMARK	 Frames
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	(5/10/85/CHS)
:	DSIOTP(SSIOH):
:	----------------
:	TO SPECIFY THE SIO DAUGHER CARD TYPE
:	ARGS:	GSIOH	- D.TYP0, D.TYP1
:	FOR SIO DAUGHTER CARD VERSION A TO G, SPECIFY D.TYP0
:	FOR SIO DAUGHTER CARD VERSION H AND LATER, SPECIFY D.TYP1
DSIOTP	MACRO(SSIOH)[
:	NOLIST
	DSGEN(DSIOTP,SSIOH)
	LVLCHK(LINSLV,DSIOTP,SSIOH)
	IF	1-ERRFLG
	PREQMC(LINE,LN.MAC,LN.ERR,DSIOTPR,SSIOH)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,DSIOTP,SSIOH,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,DSIOTP,AVALUE,PMVALU,A,0,1,0,BVALUE)
SIOH|LNE|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    SIO Daughter Cards for the Line= 
	IF	BVALUE
	REMARK	Type 1
	ELSE
	REMARK	Type 0
	EI
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

	SUBTTL ** SNA INIT ** INITIALIZATION - PU STATEMENTS


:	PU(PUID): PU
:	-----------
:	DESCRIPTION: THIS STATEMENT SPECIFIES THE BEGINING OF THE DEFINITION 
:	OF SDLC CHARACTERISTICS FOR AN SDLC STATION.
:	ARGS:	PUID - RELATIVE # OF PU ON THE SAME LINK
:		       RADIX: DECIMAL
:		       RANGE: 0 =< PUID < 9
:		       DEFAULT: NONE
PU	MACRO(PUID)[
:	NOLIST
	DSGEN(PU,PUID)
PU.ERR	EQ	1			:PRESET ERR CONDITION (I01/8/28/87/HS)
	IF	.LT.(PULVL,CURLVL)
CURLVL	EQ	PULVL			:ADJUST
	EI
	LVLCHK(PULVL,PU,PUID)
	IF	1-ERRFLG				:(I01/8/28/87/HS)
	PREQMC(LINE,LN.MAC,LN.ERR,PU,PUID)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPER,PU,PUID,PMVALU,A,,AVALUE)
	IF	1-ERRFLG
	RNGCHK(TYPERR,PU,PUID,PMVALU,A,0,8,,BVALUE)
	IF	1-ERRFLG
	IF	1-.EQ.(PUN+1,BVALUE)
	ERROR(TYPERR,ERR08,PU not defined consecutively,1)
	ERRNXT(TYPERR,,1)
	REMARK	PU(PUID)
	ERREND(TYPERR)
	EI				:(1-.EQ.(STN,BVALUE))
	IF	1-ERRFLG
PUN	EQ	BVALUE
MSTN|LNE|	EQ	MSTN|LNE|+1
MLU|LNE||PUN|	EQ	1
MLID|LNE||PUN|	EQ	1
EXTS|LNE||PUN|	EQ	EXT.S|LNE|	:INIT
CHST|LNE||PUN|	EQ	G.CHST		:INIT
LUN	EQ	0			:INIT LU NO (0 = PU)
	IF	LINK|LNE|
LT|LNE||PUN||LUN| EQ	G.EPTY!80	:PU TYPE FOR LU 0
	ELSE
LT|LNE||PUN||LUN| EQ	G.IPTY!80	:PU TYPE FOR LU 0
	EI
LV|LNE||PUN||LUN| EQ	EXTS|LNE||PUN|		:PU SYSTEM FOR LU 0
LL|LNE||PUN||LUN| EQ	G.CHST		:PU CHAR SET FOR LU 0
LX|LNE||PUN||LUN| EQ	LUN		:LU 0 
LY|LNE||PUN||LUN| EQ	LUN		:LU 0 
PU.MAC	EQ	1			:TURN ON PU MACRO DEFINED SW
LU.MAC	EQ	0			:TURN OFF LU MACRO DEFINED SW
ET.MAC	EQ	0			:TURN OFF LU ENTRY MACRO DEFINED SW
PV.MAC	EQ	0			:TURN OFF LU PVC MACRO DEFINED SW
PU.ERR	EQ	0			:RESET ERR CONDITION (I01/8/28/87/HS)
	IF	DISPLY
	REMARK %%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++%%
	REMARK	   STATION/NODE/PU - PUID
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)				:(I01/8/28/87/HS)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

	SUBTTL  ** SNA INIT ** PU - OPERANDS STATEMENTS


:	PU.ADDR(PUADR):
:	---------------
:	TO SPECIFY THE POLLING ADDRESS FOR THE SPECIFIED
:	SDLC STATION. THE POLLING ADDRESS MUST BE CODED IN
:	HECADECIMAL VALUE. IT MUST ALSO BE UNIQUE WITHIN
:	A LINE.
:	ARGS:	PUADR	- POLLING ADDRESS IN HEX. VALUE
PU.ADDR	MACRO(PUADR)[
:	NOLIST
	DSGEN(PU.ADDR,PUADR)
	LVLCHK(PUSLVL,PU.ADDR,PUADR)
	IF	1-ERRFLG
	PREQMC(PU,PU.MAC,PU.ERR,PU.ADDR,PUADR)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,PU.ADDR,PUADR,PMVALU,0,,AVALUE)
	IF	1-ERRFLG
	RNGCHK(TYPERR,PU.ADDR,PUADR,PMVALU,0,1,0FE,,BVALUE)
	IF	1-ERRFLG
CUAD|LNE||PUN|	EQ	PUADR
PID|LNE||PUADR|	EQ	PUN
	IF	DISPLY
	REMARK	%    Polling Address for this PU    = 
	NUMBER	$0 PUADR
	REMARK	 (Hexadecimal)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	PU.LABEL(PULAB):
:	---------------
:	TO SPECIFY PU LABEL FOR SPECIFIC CRM.
:	ARGS:	PULAB	- PU LABEL IN HEX. VALUE
PU.LAB	MACRO(PULAB)[
:	NOLIST
	DSGEN(PU.LABEL,PULAB)
	LVLCHK(PUSLVL,PU.LABEL,PULAB)
	IF	1-ERRFLG				:(I01/8/28/87/HS)
	PREQMC(PU,PU.MAC,PU.ERR,PU.LAB,PULAB)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
PLB|LNE||PUN|	EQ	PULAB
LABLSW	EQ	1
	IF	DISPLY
	REMARK	%    Label for this PU    = 
	NUMBER	$0 PULAB
	REMARK	 (Hexadecimal)
	EI	(DISPLY)
	EI	(1-ERRFLG)				:(I01/8/28/87/HS)
	EI	(1-ERRFLG)
	LIST
	]

:	PU.ITYPE(SPUTY):
:	--------------
:	TO SPECIFY THE PU'S INTERNAL TYPE FOR THE SPECIFIED PU
:	ARGS:	SPUTY	- '1' , '2' OR '4'
PU.ITYPE	MACRO(SPUTY)[
:	NOLIST
	DSGEN(PU.ITYPE,SPUTY)
	LVLCHK(PUSLVL,PU.ITYPE,SPUTY)
	IF	1-ERRFLG
	PREQMC(PU,PU.MAC,PU.ERR,PU.ITYPE,SPUTY)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,PU.ITYPE,SPUTY,PMVALU,A,2,AVALUE)
	RNGCHK(TYPWNG,PU.ITYPE,AVALUE,PMVALU,A,1,4,2,BVALUE)
	IF	1-ERRFLG				:(I01/8/28/87/HS)
IPTY|LNE||PUN|	EQ	BVALUE
	IF	1-LINK|LNE|
LT|LNE||PUN||LUN| EQ	BVALUE!80	:LU 0 = PU
	EI
	IF	DISPLY
	REMARK	%    Internal PU Type for this PU   = 
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)				:(I01/8/28/87/HS)
	EI	(1-ERRFLG)
	LIST
	]

:	PU.ETYPE(SPUTY):
:	--------------
:	TO SPECIFY THE PU'S INTERNAL TYPE FOR THE SPECIFIED PU
:	ARGS:	SPUTY	- '1' , '2' OR '4'
PU.ETYPE	MACRO(SPUTY)[
:	NOLIST
	DSGEN(PU.ETYPE,SPUTY)
	LVLCHK(PUSLVL,PU.ETYPE,SPUTY)
	IF	1-ERRFLG
	PREQMC(PU,PU.MAC,PU.ERR,PU.ETYPE,SPUTY)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,PU.ETYPE,SPUTY,PMVALU,A,2,AVALUE)
	RNGCHK(TYPWNG,PU.ETYPE,AVALUE,PMVALU,A,1,4,2,BVALUE)
	IF	1-ERRFLG				:(I01/8/28/87/HS)
EPTY|LNE||PUN|	EQ	BVALUE
	IF	LINK|LNE|
LT|LNE||PUN||LUN| EQ	BVALUE!80	:LU 0 = PU
	EI
	IF	DISPLY
	REMARK	%    External PU Type for this PU   = 
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)				:(I01/8/28/87/HS)
	EI	(1-ERRFLG)
	LIST
	]

:	PU.ESYS(SEXTSY)
:	--------------
:	TO SPECIFY THE EXTERNAL SYSTE TYPE OF THE PU.
:	THE SUPPORT TYPES OF VENDOR SYSTEMS ARE:
:		IBM - IBM
:		FUJITSU- FUJITSU 
:		HITACHI- HITACHI
:	ARGS:	SEXTSY	- KEYWORDS 'IBM' OR 'FUJITSU' OR 'HITACHI'.
PU.ESYS	MACRO(SEXTSY)[
:	NOLIST
	DSGEN(PU.ESYS,SEXTSY)
	LVLCHK(PUSLVL,PUESYSY,SEXTSY)
	IF	1-ERRFLG
	PREQMC(PU,PU.MAC,PU.ERR,PU.ESYS,SEXTSY)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,PU.ESYS,SEXTSY,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,PU.ESYS,SEXTSY,PMVALU,A,0,2,0,BVALUE)
	IF	1-ERRFLG				:(I01/8/28/87/HS)
EXTS|LNE||PUN|	EQ	BVALUE
LV|LNE||PUN||LUN|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    External system for this PU    = 
	IF	BVALUE-1
	REMARK	Hitachi System
	ELSE	BVALUE
	REMARK	Fujitsu System
	ELSE
	REMARK	IBM System
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)				:(I01/8/28/87/HS)
	EI	(1-ERRFLG)
	LIST
	]

:	PU.CHRSET(SCHRST)
:	--------------
:	TO SPECIFY THELANGUALE SUPPORTED BY THE PU
:	THE SUPPORT TYPES OF LANGUALGES ARE:
:		ENGLISH, KATAKANA, AND KANJI
:	ARGS:	SCHRST	- KEYWORDS 'ENGLISH' OR 'KATAKANA' OR 'KANJI'
PU.CHRSET	MACRO(SCHRST)[
:	NOLIST
	DSGEN(PU.CHRSET,SCHRST)
	LVLCHK(PUSLVL,PU.CHRSET,SCHRST)
	IF	1-ERRFLG
	PREQMC(PU,PU.MAC,PU.ERR,PU.CHRSET,SCHRST)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,PU.CHRSET,SCHRST,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,PU.CHRSET,SCHRST,PMVALU,A,0,5,0,BVALUE)
	IF	1-ERRFLG				:(I01/8/28/87/HS)
CHST|LNE||PUN|	EQ	BVALUE
LL|LNE||PUN||LUN|	EQ	BVALUE
	IF	BVALUE-3
JAPANESE	EQ	1
	EI	(BVALUE)
	IF	DISPLY
	REMARK	%    Language for this PU           = 
	IF	BVALUE-4
	REMARK	Kanji and Katakana
	ELSE	BVALUE-3
	REMARK	Katakana
	ELSE
	REMARK	English
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)				:(I01/8/28/87/HS)
	EI	(1-ERRFLG)
	LIST
	]

:	PU.ISTATUS(GISTS):
:	--------------
:		TO SPECIFY THE INITIAL STATUS OF THE PU
:	ARGS:	GISTS	- 'INACT' OR 'ACTIVE'
PU.ISTATUS	MACRO(GISTS)[
	DSGEN(PU.ISTATUS,GISTS)
	LVLCHK(PUSLVL,PU.ISTATUS,GISTS)
	IF	1-ERRFLG
	PREQMC(PU,,PU.MAC,PU.ERR,PU.ISTATUS,GISTS)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,PU.ISTATUS,GISTS,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,PU.ISTATUS,GISTS,PMVALU,A,0,1,0,BVALUE)
	IF	1-ERRFLG				:(I01/8/28/87/HS)
ISTS|LNE||PUN|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Init. Status for this PU       = 
	IF	BVALUE
	KILL	INACTIVE
	REMARK	Inactive
INACTIVE	EQ	1
	ELSE
	KILL	ACTIVE
	REMARK	Active
ACTIVE	EQ	0
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)				:(I01/8/28/87/HS)
	EI	(1-ERRFLG)
	LIST
	]

:	PU.QACTPU(SACPU):
:	--------------
:	TO DEFINE THE CANNED DATA FOR RQ(ACTPU)
:	ARG:	SACPU - DATA FOR ACTPU IN HEX FORMAT
PU.QACTPU	MACRO(SACPU)[
:	NOLIST
	DSGEN(PU.QACTPU,SACPU)
	LVLCHK(PUSLVL,PU.QACTPU,SACPU)
	IF	1-ERRFLG
	PREQMC(PU,PU.MAC,PU.ERR,PU.QACTPU,SACPU)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,PU.QACTPU,SACPU,PMSTRN)
	IF	1-ERRFLG
QAPU|LNE||PUN|	MACRO[
	XC	SACPU
	]
FQAP|LNE||PUN|	EQ	1
	IF	DISPLY
	REMARK	%    RQ(ACTPU) Data fot this PU     = SACPU
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	PU.QDACTPU(SDACPU):
:	--------------
:	TO DEFINE THE CANNED DATA FOR RQ(DACTPU)
:	ARG:	SDACPU - DATA FOR DACTPU IN HEX FORMAT
PU.QDACTPU	MACRO(SDACPU)[
:	NOLIST
	DSGEN(PU.QDACTPU,SDACPU)
	LVLCHK(PUSLVL,PU.QDACTPU,SDACPU)
	IF	1-ERRFLG
	PREQMC(PU,PU.MAC,PU.ERR,PU.QDACTPU,SDACPU)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,PU.QDACTPU,SDACPU,PMSTRN)
	IF	1-ERRFLG
QDPU|LNE||PUN|	MACRO[
	XC	SDACPU
	]
FQDP|LNE||PUN|	EQ	1
	IF	DISPLY
	REMARK	%    RQ(DACTPU) Data fot this PU    = SDACPU
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	PU.PACTPU(SACPU):
:	--------------
:	TO DEFINE THE CANNED DATA FOR RSP(ACTPU)
:	ARG:	SACPU - DATA FOR RSP(ACTPU) IN HEX FORMAT
PU.PACTPU	MACRO(SACPU)[
:	NOLIST
	DSGEN(PU.PACTPU,SACPU)
	LVLCHK(PUSLVL,PU.PACTPU,SACPU)
	IF	1-ERRFLG
	PREQMC(PU,PU.MAC,PU.ERR,PU.PACTPU,SACPU)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,PU.PACTPU,SACPU,PMSTRN)
	IF	1-ERRFLG
RAPU|LNE||PUN|	MACRO[
	XC	SACPU
	]
PAPU|LNE||PUN|	EQ	1
	IF	DISPLY
	REMARK	%    RSP(ACTPU) Data for this PU    = SACPU
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

	SUBTTL ** SNA INIT ** INITIALIZATION - LU STATEMENT


:	LU(LUID): LU
:	-----------
:	DESCRIPTION: THIS STATEMENT SPECIFIES THE BEGINING OF THE DEFINITION
:	OF SNA/SDLC CHARACTERISTICS FOR AN SNA/SDLC LU(DEVICE).
:	ARGS:	LUID - RELATIVE # OF LU ON THE SAME PU
:		       RADIX: DECIMAL
:		       RANGE: 0 =< LUID < 32
:		       DEFAULT: NONE
LU	MACRO(LUID)[
:	NOLIST
	DSGEN(LU,LUID)
LU.ERR	EQ	1			:PRESET ERR CONDITION (I01/8/28/87/HS)
	IF	.LT.(LULVL,CURLVL)
CURLVL	EQ	LULVL			:ADJUST
	EI
	LVLCHK(LULVL,LU,LUID)
	IF	1-ERRFLG				:(I01/8/28/87/HS)
	PREQMC(PU,PU.MAC,PU.ERR,LU,LUID)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,LU,LUID,PMVALU,A,,AVALUE)
	IF	1-ERRFLG
	RNGCHK(TYPERR,LU,AVALUE,PMVALU,A,0,32,,BVALUE)
	IF	1-ERRFLG
	IF	1-.EQ.(LUN,BVALUE)
	ERROR(TYPERR,ERR08,LU not in Sequence,1)
	ERRNXT(TYPERR,,1)
	REMARK	LU(LUID)
	ERREND(TYPERR)
	EI				:(1-.EQ.(DEV,BVALUE))
	IF	1-ERRFLG
LUN	EQ	BVALUE+1
MLU|LNE||PUN|	EQ	MLU|LNE||PUN|+1
ME|LNE||PUN||LUN| EQ	G.MENT		:INIT
LT|LNE||PUN||LUN| EQ	G.LUTY		:INIT
LP|LNE||PUN||LUN| EQ	G.PVC		:INIT
LC|LNE||PUN||LUN| EQ	G.COLOR		:INIT
LS|LNE||PUN||LUN| EQ	G.SIZE		:INIT
LV|LNE||PUN||LUN| EQ	EXTS|LNE||PUN|	:INIT VENDOR
LL|LNE||PUN||LUN| EQ	CHST|LNE||PUN|	:INIT CHARSET
LU.MAC	EQ	1			:TURN ON PU MACRO DEFINED SW
ET.MAC	EQ	0			:TURN OFF LU ENTRY MACRO DEFINED SW
PV.MAC	EQ	0			:TURN OFF LU PVC MACRO DEFINED SW
LU.ERR	EQ	0			:RESET ERR CONDITION (I01/8/28/87/HS)
	IF	DISPLY
	REMARK %%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++%%
	REMARK	   LU/DEVICE - LUID
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)				:(I01/8/28/87/HS)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

	SUBTTL ** SNA INIT ** LU - OPERANDS STATMENTS


:	LU.ADDR(GLUAD):
:	---------------
:	(3.F03/12/16/87/DB) MADE CHANGES TO USE A RADIX OF
:	DECIMAL INSTEAD OF HEX
:
:	TO SPECIFY THE LOGICAL UNITS ADDRESS FOR THE
:	SPECIFIED SDLC DEVICE. THE LUADDR
:	MUST BE CODED IN DECIMAL VALUE IN ASCENDING ORDER.
:	ARGS:	GLUAD	- LOCAL ADDRESS FOR A LOGICAL UNIT
LU.ADDR	MACRO(GLUAD)[
:	NOLIST
	DSGEN(LU.ADDR,GLUAD)
	LVLCHK(LUSLVL,LU.ADDR,GLUAD)
	IF	1-ERRFLG
	PREQMC(LU,LU.MAC,LU.ERR,LU.ADDR,GLUAD)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,LU.ADDR,GLUAD,PMVALU,A,,AVALUE)
	IF	1-ERRFLG
	RNGCHK(TYPERR,LU.ADDR,AVALUE,PMVALU,A,1,254,,BVALUE)
	IF	1-ERRFLG
	IF	LUN-1
LID	EQ	$A GLUAD
	IF	LX|LNE||PUN||LUN-1|-LID
	ERROR(13,LU address is not correctly defined,1)	:(I01/8/28/87/HS)
	REMARK	LU.ADDR(GLUAD)
	EI
	EI	(LUN)
	IF	1-ERRFLG
LID	EQ	$A GLUAD
LX|LNE||PUN||LUN|	EQ	LID
MLID|LNE||PUN||LUN|	EQ	LID
LY|LNE||PUN||LID|	EQ	LUN
	IF	DISPLY
	REMARK	%    LU Address in decimal is    = 
	NUMBER	$A GLUAD
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	LU.LABEL(LULAB):
:	---------------
:	TO SPECIFY LU LABEL FOR SPECIFIC CRM.
:	ARGS:	LULAB	- LU LABEL IN HEX. VALUE
LU.LAB	MACRO(LULAB)[
:	NOLIST
	DSGEN(LU.LABEL,LULAB)
	LVLCHK(LUSLVL,LU.LABEL,LULAB)
	IF	1-ERRFLG				:(I01/8/28/87/HS)
	PREQMC(LU,LU.MAC,LU.ERR,LU.LAB,LULAB)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
LB|LNE||PUN||LUN|	EQ	LULAB
LABLSW	EQ	1
	IF	DISPLY
	REMARK	%    Label for this LU    = 
	NUMBER	$0 LULAB
	REMARK	 (Hexadecimal)
	EI	(DISPLY)
	EI	(1-ERRFLG)				:(I01/8/28/87/HS)
	EI	(1-ERRFLG)
	LIST
	]

:	LU.TYPE(SLUTY):
:	--------------
:	TO SPECIFY THE LU TYPE FOR THE LU'S FOR THE SLOT
:	ARGS:	SLUTY	- '2' OR '3'
LU.TYPE	MACRO(SLUTY)[
:	NOLIST
	DSGEN(LU.TYPE,SLUTY)
	LVLCHK(LUSLVL,LU.TYPE,SLUTY)
	IF	1-ERRFLG
	PREQMC(LU,LU.MAC,LU.ERR,LU.TYPE,SLUTY)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,LU.TYPE,SLUTY,PMVALU,A,2,AVALUE)
	RNGCHK(TYPWNG,LU.TYPE,AVALUE,PMVALU,A,1,4,2,BVALUE)
	IF	1-ERRFLG				:(I01/8/28/87/HS)
LT|LNE||PUN||LUN|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    LU Type for this LU            = 
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)				:(I01/8/28/87/HS)
	EI	(1-ERRFLG)
	LIST
	]

:	LU.ISTATUS(GISTS):
:	--------------
:		TO SPECIFY THE INITIAL STATUS OF THE LU
:	ARGS:	GISTS	- 'INACT' OR 'ACTIVE'
LU.ISTATUS	MACRO(GISTS)[
	DSGEN(LU.ISTATUS,GISTS)
	LVLCHK(LUSLVL,LU.ISTATUS,GISTS)
	IF	1-ERRFLG
	PREQMC(LU,LU.MAC,LU.ERR,LU.ISTATUS,GISTS)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,LU.ISTATUS,GISTS,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,LU.ISTATUS,GISTS,PMVALU,A,0,1,0,BVALUE)
LI|LNE||PUN||LUN|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Init. Status for this LU        = 
	IF	BVALUE
	KILL	INACTIVE
	REMARK	Inactive
INACTIVE	EQ	1
	ELSE
	KILL	ACTIVE
	REMARK	Active
ACTIVE	EQ	0
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	LU.PVC(SPVC):
:	--------------
:	TO SPECIFY THE NETWORK LOGON METHOD
:	ARGS:	SPVC	- KEYWORD 'YES' OR 'NO'.
LU.PVC	MACRO(SPVC)[
:	NOLIST
	DSGEN(LU.PVC,SPVC)
	LVLCHK(LUSLVL,LU.PVC,SPVC)
	IF	1-ERRFLG
	PREQMC(LU,LU.MAC,LU.ERR,LU.PVC,SPVC)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,LU.PVC,SPVC,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,LU.PVC,SPVC,PMVALU,A,0,1,1,BVALUE)
	IF	1-ERRFLG				:(I01/8/28/87/HS)
LP|LNE||PUN||LUN|	EQ	BVALUE
PV.MAC	EQ	1			:TURN ON LU.PVC DEFINED SW
CLGLVL	EQ	0			:INIT LOGON STRING LEVEL
	IF	DISPLY
	REMARK	%    Logon Method for this LU       = 
	IF	BVALUE
	REMARK	PVC
	ELSE
	REMARK	Network Service Screen
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)				:(I01/8/28/87/HS)
	EI	(1-ERRFLG)
	LIST
	]

:	LU.VHR(SVHR):
:	--------------
:	TO SPECIFY VHR FUNCTION FOR LU
:	ARGS:	SVHR	- KEYWORD 'YES' OR 'NO'.
LU.VHR	MACRO(SVHR)[
:	NOLIST
	DSGEN(LU.VHR,SVHR)
	LVLCHK(LUSLVL,LU.VHR,SVHR)
	IF	1-ERRFLG
	PREQMC(LU,LU.MAC,LU.ERR,LU.VHR,SVHR)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,LU.VHR,SVHR,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,LU.VHR,SVHR,PMVALU,A,0,1,1,BVALUE)
	IF	1-ERRFLG				:(I01/8/28/87/HS)
VR|LNE||PUN||LUN|	EQ	BVALUE
	IF	\VHRSUP
	IF	VHRSUP
	ELSE
VHRSUP	EQ	BVALUE
	EI
	ELSE
VHRSUP	EQ	BVALUE
	EI
	IF	\HDPSUP
	IF	HDPSUP
	ELSE
HDPSUP	EQ	BVALUE
	EI
	ELSE
HDPSUP	EQ	BVALUE
	EI
	IF	DISPLY
	IF	BVALUE
	REMARK	% This LU operates in VHR mode
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)				:(I01/8/28/87/HS)
	EI	(1-ERRFLG)
	LIST
	]

:	LU.VTI(SVTI):
:	--------------
:	TO SPECIFY VTI FUNCTION FOR LU
:	ARGS:	SVTI	- KEYWORD 'YES' OR 'NO'.
LU.VTI	MACRO(SVTI)[
:	NOLIST
	DSGEN(LU.VTI,SVTI)
	LVLCHK(LUSLVL,LU.VTI,SVTI)
	IF	1-ERRFLG
	PREQMC(LU,LU.MAC,LU.ERR,LU.VTI,SVTI)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,LU.VTI,SVTI,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,LU.VTI,SVTI,PMVALU,A,0,1,1,BVALUE)
	IF	1-ERRFLG				:(I01/8/28/87/HS)
VT|LNE||PUN||LUN|	EQ	BVALUE
	IF	\VTISUP
	IF	VTISUP
	ELSE
VTISUP	EQ	BVALUE
	EI
	ELSE
VTISUP	EQ	BVALUE
	EI
	IF	DISPLY
	IF	BVALUE
	REMARK	% This LU operates in VTI mode
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)				:(I01/8/28/87/HS)
	EI	(1-ERRFLG)
	LIST
	]


:	LU.SRQ(SSRQ):
:	--------------
:	TO SPECIFY SYS/RQ FUNCTION FOR LU
:	ARGS:	SSRQ	- KEYWORD 'YES' OR 'NO'.
LU.SRQ	MACRO(SSRQ)[
:	NOLIST
	DSGEN(LU.SRQ,SSRQ)
	LVLCHK(LUSLVL,LU.SRQ,SSRQ)
	IF	1-ERRFLG
	PREQMC(LU,LU.MAC,LU.ERR,LU.SRQ,SSRQ)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,LU.SRQ,SSRQ,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,LU.SRQ,SSRQ,PMVALU,A,0,1,1,BVALUE)
SR|LNE||PUN||LUN|	EQ	BVALUE
	IF	DISPLY
	IF	BVALUE
	REMARK	% This LU operates in SYS/RQ mode
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	LU.QACTLU(SACLU):
:	--------------
:	TO DEFINE THE CANNED DATA FOR RQ(ACTLU)
:	ARG:	SACLU - DATA FOR ACTLU IN HEX FORMAT
LU.QACTLU	MACRO(SACLU)[
:	NOLIST
	DSGEN(LU.QACTLU,SACLU)
	LVLCHK(LUSLVL,LU.QACTLU,SACLU)
	IF	1-ERRFLG
	PREQMC(LU,LU.MAC,LU.ERR,LU.QACTLU,SACLU)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,LU.QACTLU,SACLU,PMSTRN)
	IF	1-ERRFLG
AL|LNE||PUN||LUN|	MACRO[
	XC	SACLU
	]
FA|LNE||PUN||LUN|	EQ	1
	IF	DISPLY
	REMARK	%    RQ(ACTLU) Data fot this LU     = SACLU
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	LU.QDACTLU(SDACLU):
:	--------------
:	TO DEFINE THE CANNED DATA FOR RQ(DACTLU)
:	ARG:	SDACLU - DATA FOR DACTLU IN HEX FORMAT
LU.QDACTLU	MACRO(SDACLU)[
:	NOLIST
	DSGEN(LU.QDACTLU,SDACLU)
	LVLCHK(LUSLVL,LU.QDACTLU,SDACLU)
	IF	1-ERRFLG
	PREQMC(LU,LU.MAC,LU.ERR,LU.QDACTLU,SDACLU)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,LU.QDACTLU,SDACLU,PMSTRN)
	IF	1-ERRFLG
DL|LNE||PUN||LUN|	MACRO[
	XC	SDACLU
	]
FD|LNE||PUN||LUN|	EQ	1
	IF	DISPLY
	REMARK	%    RQ(DACTLU) Data fot this LU    = SDACLU
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	LU.PACTLU(SACLU):
:	--------------
:	TO DEFINE THE CANNED DATA FOR RSP(ACTLU)
:	ARG:	SACLU - DATA FOR RSP(ACTLU) IN HEX FORMAT
LU.PACTLU	MACRO(SACLU)[
:	NOLIST
	DSGEN(LU.PACTLU,SACLU)
	LVLCHK(LUSLVL,LU.PACTLU,SACLU)
	IF	1-ERRFLG
	PREQMC(LU,LU.MAC,LU.ERR,LU.PACTLU,SACLU)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,LU.PACTLU,SACLU,PMSTRN)
	IF	1-ERRFLG
RA|LNE||PUN||LUN|	MACRO[
	XC	SACLU
	]
PA|LNE||PUN||LUN|	EQ	1
	IF	DISPLY
	REMARK	%    RSP(ACTLU) Data for this LU    = SACLU
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	LU.BIND(SBIND):
:	--------------
:	TO DEFINE THE CANNED DATA FOR RQ(BIND)
:	ARG:	SBIND - DATA FOR RQ(BIND) IN HEX. FORMAT
LU.BIND	MACRO(SBIND)[
:	NOLIST
	DSGEN(LU.BIND,SBIND)
	LVLCHK(LUSLVL,LU.BIND,SBIND)
	IF	1-ERRFLG
	PREQMC(LU,LU.MAC,LU.ERR,LU.BIND,SBIND)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,LU.BIND,SBIND,PMSTRN)
	IF	1-ERRFLG
BN|LNE||PUN||LUN|	MACRO[
	XC	SBIND
	]
FB|LNE||PUN||LUN|	EQ	1
	IF	DISPLY
	REMARK	%    RQ(BIND) Data fot this LU      = SBIND
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	LU.UNBIND(SUNBND):
:	--------------
:	TO DEFINE THE CANNED DATA FOR RQ(UNBIND)
:	ARG:	SUNBND - DATA FOR RQ(UNBIND) IN HEX. FORMAT
LU.UNBIND	MACRO(SUNBND)[
:	NOLIST
	DSGEN(LU.UNBIND,SUNBND)
	LVLCHK(LUSLVL,LU.UNBINDU,SUNBND)
	IF	1-ERRFLG
	PREQMC(LU,LU.MAC,LU.ERR,LU.UNBIND,SUNBND)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,LU.UNBIND,SUNBND,PMSTRN)
	IF	1-ERRFLG
UB|LNE||PUN||LUN|	MACRO[
	XC	SUNBND
	]
FU|LNE||PUN||LUN|	EQ	1
	IF	DISPLY
	REMARK	%    RQ(UNBIND) Data fot this LU    = SUNBND
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	LU.COLOR(GCOLOR):
:	--------------
:	TO SPECIFY THE DEVICES' COLOR ATTRIBUTE
:	ARGS:	GCOLOR	- KEYWORD 'YES' OR 'NO'.
LU.COLOR	MACRO(GCOLOR)[
:	NOLIST
	DSGEN(LU.COLOR,GCOLOR)
	LVLCHK(LUSLVL,LU.COLOR,GCOLOR)
	IF	1-ERRFLG
	PREQMC(LU,LU.MAC,LU.ERR,LU.COLOR,GCOLOR)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,LU.COLOR,GCOLOR,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,LU.COLOR,GCOLOR,PMVALU,A,0,1,1,BVALUE)
LC|LNE||PUN||LUN|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Devices Color for this LU      = 
	IF	BVALUE
	REMARK	Color
	ELSE
	REMARK	No-Color
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	LU.SIZE(GSIZE):
:	--------------
:	TO SPECIFY THE DEVICES' SIZE
:	ARGS:	GSIZE	- DEVICE'S SIZE, IN DECIMINAL
LU.SIZE	MACRO(GSIZE)[
:	NOLIST
	DSGEN(LU.SIZE,GSIZE)
	LVLCHK(LUSLVL,LU.SIZE,GSIZE)
	IF	1-ERRFLG
	PREQMC(LU,LU.MAC,LU.ERR,LU.SIZE,GSIZE)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,LU.SIZE,GSIZE,PMVALU,A,1920,AVALUE)
	RNGCHK(TYPWNG,LU.SIZE,AVALUE,PMVALU,A,1,1920,1920,BVALUE)
LS|LNE||PUN||LUN|	EQ	C|$ABVALUE|
	IF	DISPLY
	REMARK	%    Devices' Size for this Line    = 
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]


:	LU.ITIMOUT(GITIM):
:	--------------
:	TO SPECIFY THE INACTIVE TIMEOUT FOR DEVICE
:	ARGS:	GITIM	- IDLE TIMEOUT FOR DEVICE, IN DECIMAL (MINUTE)
LU.ITIMOUT	MACRO(GITIM)[
:	NOLIST
	DSGEN(LU.ITIMOUT,GITIM)
	LVLCHK(LUSLVL,LU.ITIMOUT,GITIM)
	IF	1-ERRFLG
	PREQMC(LU,LU.MAC,LU.ERR,LU.ITIMOUT,GITIM)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,LU.ITIMOUT,GITIM,PMVALU,A,60,AVALUE)
	RNGCHK(TYPWNG,LU.ITIMOUT,AVALUE,PMVALU,A,0,60,60,BVALUE)
LD|LNE||PUN||LUN|	EQ	$ABVALUE*$A60
	IF	DISPLY
	REMARK	%    Devices' Inactive timeout for this device =
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]


:	LU.ATIMOUT(GITIM):
:	--------------
:	TO SPECIFY THE APPLICATION NORMAL LOGOFF TIMER,
:	IF TIMER IS NOT SPECIFIED,ZAP CIRCUIT WHENEVER RCV DACTLU
:	IF TIMER IS SPECIFIED,WAIT FOR TIMER AND DECIDE ZAP OR NOT
:	ARGS:	GITIM	- IDLE TIMEOUT FOR DEVICE, IN DECIMAL (SECOND)
LU.ATIMOUT	MACRO(GITIM)[
:	NOLIST
	DSGEN(LU.ATIMOUT,GITIM)
	LVLCHK(LUSLVL,LU.ATIMOUT,GITIM)
	IF	1-ERRFLG
	PREQMC(LU,LU.MAC,LU.ERR,LU.ATIMOUT,GITIM)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,LU.ATIMOUT,GITIM,PMVALU,A,60,AVALUE)
	RNGCHK(TYPWNG,LU.ATIMOUT,AVALUE,PMVALU,A,0,60,60,BVALUE)
LO|LNE||PUN||LUN|	EQ	$ABVALUE
	IF	DISPLY
	REMARK	%    Devices' Application logoff timer for this device =
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	LU.TRAILER(SLUTRA):
:	--------------
:	TO SPECIFY THE LU DSP TRAILER FOR THE LU'S FOR THE SLOT
:	ARGS:	SLUTRA	- 'AP.ETX','AP.ETB' OR 'AP.ITB'
LU.TRAILER	MACRO(SLUTRA)[
:	NOLIST
	DSGEN(LU.TRAILER,SLUTRA)
	LVLCHK(LUSLVL,LU.TRAILER,SLUTRA)
	IF	1-ERRFLG
	PREQMC(LU,LU.MAC,LU.ERR,LU.TRAILER,SLUTRA)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,LU.TRAILER,SLUTRA,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,LU.TRAILER,AVALUE,PMVALU,A,0,2,2,BVALUE)
LZ|LNE||PUN||LUN|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    LU DSP trailer for this LU            = slutra
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]



	SUBTTL ** SNA INIT ** LU - PVC OPERANDS


:	PV.LOGON(GLEVEL,GSTRN):
:	--------------------
:	TO SPECIFY THE LOGON STRING FOR THE PVC LOGON OF THIS LU
:	ARGS:	GSTRN - LEGAL LOGON STRING
:		GLEVEL - LOGON LEVEL
PV.LOGON	MACRO(GLEVEL,GSTRN)[
	IF	DSPGEN
	REMARK	%PV.LOGON(GLEVEL,GSTRN)
	REMARK%
	EI	DSPGEN
	IF	.LT.(LPVSSL,CURLVL)
	ERROR(TYPERR,ERR07,Sysgen Statement not at Correct Level,1)
	ERRNXT(TYPERR,,1)
	REMARK	PV.LOGON(GLEVEL,GSTRN)
	ERREND(TYPERR)
	ELSE
CURLVL	EQ	LPVSSL
	EI				:END OF LEVEL CHECK
	IF	1-ERRFLG
	IF	1-PV.MAC		:BEGIN PREQMC CHECK
	ERROR(TYPERR,ERR08,Pre-Requested Macro Not Defined,1)
	ERRNXT(TYPERR,,1)
	REMARK	LU.PVC()  Before  
	REMARK	PV.LOGON(GLEVEL,GSTRN)
	ERREND(TYPERR)
	EI				:END OF PREQMC CHECK
	IF	1-ERRFLG
	ORG	0			:BEGIN PARAMETER PRESEN CHECK
	AC	/GSTRN/
IZ	EQ	.
	ORG	0
	AC	/GLEVEL/
IY	EQ	.
	ORG	0
	IF	(1-IZ)!(1-IY)
	ERROR(TYPERR,ERR14,Logon Parameter Missing,1)
	ERRNXT(TYPERR,,1)
	REMARK	PV.LOGON(GLEVEL,GSTRN)
	ERREND
	EI				:END OF PARAMETERS PRESETN CHECK
	IF	1-.EQ.(CLGLVL,GLEVEL)
	ERROR(TYPERR,ERR09,Logon String Statement Level not contiguous,1)
	ERRNXT(TYPERR,,1)
	REMARK	PV.LOGON(GLEVEL,GSTRN)
	ERREND(TYPERR)
	EI
	IF	1-ERRFLG
	IF	GLEVEL-4
	ERROR(TYPERR,ERR17,Logon Parameter Level Too Large,1)
	ERRNXT(TYPERR,,1)
	REMARK	PV.LOGON(GLEVEL,GSTRN)
	ERREND(TYPERR)
	EI				:END OF RANGE CHECK
	IF	1-ERRFLG
LVL	EQ	GLEVEL
CLGLVL	EQ	GLEVEL+1
GV|LNE||PUN||LUN|	EQ	CLGLVL
	KILL	G|LNE||PUN||LUN||LVL|
G|LNE||PUN||LUN||LVL|	MACRO[
	SC	/GSTRN/
	]
	IF	DISPLY
	REMARK	%    Level GLEVEL 
	REMARK	PVC Logon String       = GSTRN
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	PV.LINE(GLINE):
:	--------------
:	TO SPECIFY THE DESINATION LINE # TO BE ATTACHED FOR PVC LOGON
:	ARG: GLINE - LINE # [-1, 0FF]
PV.LINE	MACRO(GLINE)[
:	NOLIST
	DSGEN(PV.LINE,GLINE)
	LVLCHK(LPVSSL,PV.LINE,GLINE)
	IF	1-ERRFLG
	PREQMC(LU.PVC,PV.MAC,0,PV.LINE,GLINE)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,PV.LINE,GLINE,PMVALU,0,G.PVDL,AVALUE)
	RNGCHK(TYPWNG,PV.LINE,AVALUE,PMVALU,0,-1,0FF,0FF,BVALUE)
PL|LNE||PUN||LUN|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    PVC Logon DLINE for this LU    = 
	DSPNUM(BVALUE,0)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	PV.PUADDR(GPUADR)
:	------------------
:	TO SPECIFY THE DESTINATION CU ADDR TO BE ATTACHED FOR PVC
:	LOGON ONLY
:	ARG:	GPUADR - CU ADDR [-1, 0FF]
PV.PUADDR	MACRO(GPUADR)[
:	NOLIST
	DSGEN(PV.PUADDR,GPUADR)
	LVLCHK(LPVSSL,PV.PUADDR,GPUADR)
	IF	1-ERRFLG
	PREQMC(LU.PVC,PV.MAC,0,PV.PUADDR,GPUADR)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,PV.PUADDR,GPUADR,PMVALU,0,G.PVPU,AVALUE)
	RNGCHK(TYPWNG,PV.PUADDR,AVALUE,PMVALU,0,-1,0FF,0FF,BVALUE)
PP|LNE||PUN||LUN|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    PVC Logon DCU for this LU      = 
	DSPNUM(BVALUE,0)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	PV.LUADDR(GLUADR)
:	-------------------
:	TO SPECIFY THE DESTINATION LU ADDR TO BE ATTACHED FOR PVC
:	LOGON ONLY
:	ARG:	GLUADR - LU ADDR [-1, 0FF]
PV.LUADDR	MACRO(GLUADR)[
:	NOLIST
	DSGEN(PV.LUADDR,GLUADR)
	LVLCHK(LPVSSL,PV.LUADDR,GLUADR)
	IF	1-ERRFLG
	PREQMC(LU.PVC,PV.MAC,0,PV.LUADDR,GLUADR)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,PV.LUADDR,GLUADR,PMVALU,0,G.PVLU,AVALUE)
	RNGCHK(TYPWNG,PV.LUADDR,AVALUE,PMVALU,0,-1,0FF,0FF,BVALUE)
PD|LNE||PUN||LUN|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    PVC Logon DLU for this LU      = 
	DSPNUM(BVALUE,0)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	PV.LTYPE(GLTYPE):
:	-------------------
:	TO SPECIFY THE DESIRED LTYPE CAPABILITY ON THE DESTINATION
:	DEVICE, FOR PRESET LOGON ONLY
:	ARG:	GLTYPE - 2 OR 3
PV.LTYPE	MACRO(GLTYPE)[
:	NOLIST
	DSGEN(PV.LTYPE,GLTYPE)
	LVLCHK(LPVSSL,PV.LTYPE,GLTYPE)
	IF	1-ERRFLG
	PREQMC(LU.PVC,PV.MAC,0,PV.LTYPE,GLTYPE)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,PV.LTYPE,GLTYPE,PMVALU,A,2,AVALUE)
	RNGCHK(TYPWNG,PV.LTYPE,AVALUE,PMVALU,A,2,3,2,BVALUE)
PT|LNE||PUN||LUN|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    PVC Logon DLTYPE for this LU   = 
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	PV.COLOR(GCOLOR):
:	-------------------
:	TO SPECIFY THE DESIRED COLOR CAPABILITY ON THE DESTINATION
:	DEVICE, FOR PRESET LOGON ONLY
:	ARG:	GCOLOR - YES/NO
PV.COLOR	MACRO(GCOLOR)[
:	NOLIST
	DSGEN(PV.COLOR,GCOLOR)
	LVLCHK(LPVSSL,PV.COLOR,GCOLOR)
	IF	1-ERRFLG
	PREQMC(LU.PVC,PV.MAC,0,PV.COLOR,GCOLOR)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,PV.COLOR,GCOLOR,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,PV.COLOR,AVALUE,PMVALU,A,0,1,0,BVALUE)
PC|LNE||PUN||LUN|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    PVC Logon DCOLOR for this LU   = 
	IF	BVALUE
	REMARK	Color
	ELSE
	REMARK	Non_Color
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	PV.SIZE(GSIZE)
:	---------------
:	TO SPECIFY THE DESIRED DEVICE SIZE ON THE DESTINCATION 
:	DEVICE, FOR PRESET LOGON ONLY
:	ARG:	GSIZE - 480, 1920, ETC..
PV.SIZE	MACRO(GSIZE)[
:	NOLIST
	DSGEN(PV.SIZE,GSIZE)
	LVLCHK(LPVSSL,PV.SIZE,GSIZE)
	IF	1-ERRFLG
	PREQMC(LU.PVC,PV.MAC,0,PV.SIEZ,GSIZE)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,PV.SIZE,GSIZE,PMVALU,A,1920,AVALUE)
	RNGCHK(TYPWNG,PV.SIZE,AVALUE,PMVALU,A,480,1920,1920,BVALUE)
PS|LNE||PUN||LUN|	EQ	C|$ABVALUE|
	IF	DISPLY
	REMARK	%    PVC Logon DSIZE for this LU    = 
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	PV.CHRSET(GCHRST)
:	---------------
:	TO SPECIFY THE DESIRED CHAR SET ON THE DESTINCATION 
:	DEVICE, FOR PRESET LOGON ONLY
:	ARG:	GCHRST - ENGLISH, KATAKANA, AND KANJI
PV.CHRSET	MACRO(GCHRST)[
:	NOLIST
	DSGEN(PV.CHRSET,GCHRST)
	LVLCHK(LPVSSL,PV.CHRSET,GCHRST)
	IF	1-ERRFLG
	PREQMC(LU.PVC,PV.MAC,0,PV.CHRSET,GCHRST)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,PV.CHRSET,GCHRST,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,PV.CHRSET,AVALUE,PMVALU,A,0,5,0,BVALUE)
PC|LNE||PUN||LUN|	EQ	BVALUE
	IF	BVALUE-3
JAPANESE	EQ	1
	EI	(BVALUE)
	IF	DISPLY
	REMARK	%    PVC Logon CHAR SET for this LU = 
	IF	BVALUE-4
	REMARK	Kanji and Katakana
	ELSE-3
	REMARK	Katakana
	ELSE
	REMARK	English
	EI
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	PV.CRM(GCRM)
:	---------------
:	TO SPECIFY THE DESIRED CRM MODE ON THE DESTINCATION 
:	DEVICE, FOR PRESET LOGON ONLY
:	ARG:	GCRM - 1, 2, 3, 4
PV.CRM	MACRO(GCRM)[
:	NOLIST
	DSGEN(PV.CRM,GCRM)
	LVLCHK(LPVSSL,PV.CRM,GCRM)
	IF	1-ERRFLG
	PREQMC(LU.PVC,PV.MAC,0,PV.CRM,GCRM)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,PV.CRM,GCRM,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,PV.CRM,AVALUE,PMVALU,A,1,4,1,BVALUE)
PR|LNE||PUN||LUN|	EQ	$ABVALUE
	IF	DISPLY
	REMARK	%    PVC Logon CRM for this LU      = 
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

	SUBTTL ** SNA INIT ** LU - NETWORK SERVICE DEFINITIONS


:	NS.MENU(GHEAD,GHAE):
:	----------------
:	TO SPECIFY THE HEADING LINE OF THE NETWORK SERVICE MENU
:	FOR THE SPECIFIED LU.
:	ARG:	GHEAD - TEXT FOR HEADING
:		GHAE - TEXT IN ASCII OR EBCDIC
NS.MENU	MACRO(GHEAD,GHAE)[
:	NOLIST
	DSGEN(NS.MENU,GHEAD)
	LVLCHK(LUSLVL,NS.MENU,GHEAD)
	IF	1-ERRFLG
	PREQMC(LU,LU.MAC,LU.ERR,NS.MENU,GHEAD)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,NS.MENU,GHEAD,PMSTRN)
	IF	1-ERRFLG
MT|LNE||PUN||LUN|	EQ	GHAE G.NSMT
MU|LNE||PUN||LUN|	MACRO[
:	NOLIST
	HS	0
BEGORG	EQ	.
	HC	0
	IF	MT|LNE||PUN||LUN|
	XC	GHEAD
	XC	4040
	BC	((VERSION/8)&7)+0F0
	BC	(VERSION&7)+0F0
	BC	4B
	BC	((REVLEV/8)&7)+0F0
	BC	(REVLEV&7)+0F0
	BC	40
	ELSE
	AC	/GHEAD/
	AC	/  /
	BC	((VERSION/8)&7)+0B0
	BC	(VERSION&7)+0B0
	AC	/./
	BC	((REVLEV/8)&7)+0B0
	BC	(REVLEV&7)+0B0
	AC	/ /
	EI
ENDORG	EQ	.
	ORG	BEGORG
	HC	ENDORG-BEGORG-2
	ORG	ENDORG
	LIST
	]
MF|LNE||PUN||LUN|	EQ	1
	IF	DISPLY
	REMARK	%%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++%%
	REMARK	NETWORK SERVICE MENU%
	REMARK	%    Network Menu for this LU       = GHEAD
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	NS.KEY(GKEY):
:	-------------
:	TO SPECIFY THE FUNCTION KEY OR PROGRAM KET USED TO ENTER
:	THE NETWORK SERVICE MODE FOR THE SPECIFIED LU.
:	ARG:	GKEY - PF KEYS OR PA KEYS
NS.KEY	MACRO(GKEY)[
:	NOLIST
	DSGEN(NS.KEY,GKEY)
	LVLCHK(LUSLVL,NS.KEY,GKEY)
	IF	1-ERRFLG
	PREQMC(LU,LU.MAC,LU.ERR,NS.KEY,GKEY)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,NS.KEY,GKEY,PMVALU,A,PF5,AVALUE)
	RNGCHK(TYPWNG,NS.KEY,AVALUE,PMVALUE,A,PF1,PA3,PF5,BVALUE)
NK|LNE||PUN||LUN|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Net_Service Key for this LU    = 
	IF	BVALUE-PF24
	REMARK	PA
	ELSE
	REMARK	PF
	EI
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	NS.WORD(GWORD,GWAT):
:	-----------------
:	TO SPECIFY THE KEYWORD FOR ENTERING THE NETWORK SERVICE MODE
:	FOR THE SPECIFIED LU.
:	ARG:	GWORD - WORD
:		GWAE - TEXT IN ASCII OR EBCDIC
NS.WORD	MACRO(GWORD,GWAE)[
:	NOLIST
	DSGEN(NS.WORD,GWORD)
	LVLCHK(LUSLVL,NS.WORD,GWORD)
	IF	1-ERRFLG
	PREQMC(LU,LU.MAC,LU.ERR,NS.WORD,GWORD)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,NS.WORD,GWORD,PMSTRN)
	IF	1-ERRFLG
KT|LNE||PUN||LUN|	EQ	GWAE G.KWDT
KW|LNE||PUN||LUN|	MACRO[
	HS	0
BEGORG	EQ	.
	HC	0
	IF	KT|LNE||PUN||LUN|
	XC	GWORD
	ELSE
	AC	/GWORD/
	EI
ENDORG	EQ	.
	ORG	BEGORG
	HC	ENDORG-BEGORG-2
	ORG	ENDORG
	]
FW|LNE||PUN||LUN|	EQ	1
	IF	DISPLY
	REMARK	%    Net_Service Word for this LU   = GWORD
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

	SUBTTL ** SNA INIT ** LU - LOGON SELECTION DEFINTIONS


:	LG.SELECTION(GHEAD,GHAE):
:	---------------------
:	TO SPECIFY THE HEADING LNE FOR THE LOGON SELECTION MENU
:	FOR THE SPECIFIED LU.
:	ARG:	GHEAD - TEXT
:		GHAE - TEXT IN ASCII OR EBCDIC
LG.SELECTION	MACRO(GHEAD,GHAE)[
:	NOLIST
	DSGEN(LG.SELECTION,GHEAD)
	LVLCHK(LUSLVL,LG.SELECTION,GHEAD)
	IF	1-ERRFLG
	PREQMC(LU,LU.MAC,LU.ERR,LG.SECLECTION,GHEAD)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,LG.SELECTION,GHEAD,PMSTRN)
	IF	1-ERRFLG
ST|LNE||PUN||LUN|	EQ	GHAE G.SELT
SL|LNE||PUN||LUN|	MACRO(QA,QB,QC)[
:	NOLIST
	HS	0
BEGORG	EQ	.
	HC	0
	IF	ST|QA||QB||QC|
	XC	GHEAD
	XC	4040
	BC	((VERSION/8)&7)+0F0
	BC	(VERSION&7)+0F0
	BC	4B
	BC	((REVLEV/8)&7)+0F0
	BC	(REVLEV&7)+0F0
	BC	40
	ELSE
	AC	/GHEAD/
	AC	/  /
	BC	((VERSION/8)&7)+0B0
	BC	(VERSION&7)+0B0
	AC	/./
	BC	((REVLEV/8)&7)+0B0
	BC	(REVLEV&7)+0B0
	AC	/ /
	EI
ENDORG	EQ	.
	ORG	BEGORG
	HC	ENDORG-BEGORG-2
	ORG	ENDORG
	LIST
	]
SF|LNE||PUN||LUN|	EQ	1
	IF	DISPLY
	REMARK	%%  .........................................................%%
	REMARK	  LOGON SELECTION MENU%
	REMARK	%    Logon Menu for this LU         = GHEAD
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	LG.ENTRY(GENTRY):
:	------------------
:	TO SPECIFY THE ENTRY # OF THE LOGON SELECTION MENU
:	FOR THE SPECIFIED LU.
:	ARG:	GENTRY - ENTRY #
LG.ENTRY	MACRO(GENTRY)[
:	NOLIST
	DSGEN(LG.ENTRY,GENTRY)
	IF	.EQ.(CURLVL,LSMSSL)
CURLVL	EQ	LUSLVL			:ADJUST LEVEL
	EI
	LVLCHK(LSMSSL,LG.ENTRY,GENTRY)
	IF	1-ERRFLG
	PMPRCK(TYPERR,LG.ENTRY,GENTRY,PMVALU,A,,AVALUE)
	IF	1-ERRFLG
	RNGCHK(TYPERR,LG.ENTRY,AVALUE,PBVALU,A,0,10,,BVALUE)
	IF	1-ERRFLG
	IF	\E|LNE||PUN||LUN||BVALUE|
	ERROR(TYPERR,ERR15,Logon Entry Double Defined,1)
	ERRNXT(TYPERR,,1)
	REMARK	LG.ENTRY(GENTRY)
	ERREND(TYPERR)
	EI
	IF	1-ERRFLG
ENT	EQ	BVALUE
E|LNE||PUN||LUN||ENT|	EQ	ENT
	IF	.GT.(ENT,ME|LNE||PUN||LUN|)
ME|LNE||PUN||LUN|	EQ	ENT
	EI
EN.MAC	EQ	1			:ENTRY DEFINED
CLGLVL	EQ	0			:INIT LOGON RCD LEVEL
	IF	DISPLY
	REMARK	%%------------------------------------------------------------%
	REMARK	   Entry - GENTRY
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	LG.PROMPT(GTEXT,GTAE):
:	------------------
:	TO SPECIFY THE PROMPT MESSAGE ON THE LOGON SELECTION MENU
:	FOR CURRENT ENTRY
:	ARG:	GTEXT:	PROMPT TEXT
:		GTAE - TEXT IN ASCII OR EBCDIC
LG.PROMPT	MACRO(GTEXT,GTAE)[
:	NOLIST
	DSGEN(LG.PRMPT,GTEXT)
	LVLCHK(LSMSSL,LG.PROMPT,GTEXT)
	IF	1-ERRFLG
	PREQMC(LG.ENTRY,EN.MAC,0,LG.PROMPT,GTEXT)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,LG.PROMPT,GTEXT,PMSTRN)
	IF	1-ERRFLG
	IF	\R|LNE||PUN||LUN||ENT|
	ERROR(TYPERR,ERR13,Logon Prompt Double Defined,1)
	ERRNXT(TYPERR,,1)
	REMARK	LG.PROMPT(GTEXT)
	ERREND(TYPERR)
	EI
	IF	1-ERRFLG
	IF	\PRMT|ENT|
I|LNE||PUN||LUN||ENT|	EQ	GTAE PRMT|ENT|
	ELSE
I|LNE||PUN||LUN||ENT|	EQ	GTAE 0
	EI
R|LNE||PUN||LUN||ENT|	MACRO(QA,QB,QC,QD)[
	HS	0
BEGORG	EQ	.
	HC	0
	IF	I|QA||QB||QC||QD|
	XC	GTEXT
	ELSE
	AC	/GTEXT/
	EI
ENDORG	EQ	.
	ORG	BEGORG
	HC	ENDORG-BEGORG-2
	ORG	ENDORG
	]
N|LNE||PUN||LUN||ENT|	EQ	1
	IF	DISPLY
	REMARK	%    Logon Prompt for this Entry    = GTEXT
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	LG.MODE(GMODE):
:	--------------------
:	TO SPECIFY THE LOGON MODE OF THIS ENTRY ON THE LOGON 
:	SELECTION MENU
:	ARG:	GMODE - MANUAL/PRESET
LG.MODE	MACRO(GMODE)[
:	NOLIST
	DSGEN(LG.MODE,GMODE)
	LVLCHK(LSMSSL,LG.MODE,GMODE)
	IF	1-ERRFLG
	PREQMC(LG.ENTRY,EN.MAC,0,LG.MODE,GMODE)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPERR,LG.MODE,GMODE,PMSTRN)
	IF	1-ERRFLG
	IF	\M|LNE||PUN||LUN||ENT|
	ERROR(TYPERR,ERR13,Logon Mode Double Defined,1)
	ERRNXT(TYPERR,,1)
	REMARK	LG.MODE(GMODE)
	ERREND(TYPERR)
	EI
	IF	1-ERRFLG
M|LNE||PUN||LUN||ENT|	EQ	GMODE
	IF	DISPLY
	REMARK	%    Logon Mode for this Entry      = GMODE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	LG.LOGON(GLEVEL,GSTRN):
:	--------------------
:	TO SPECIFY THE LOGON STRING FOR THE PRESET LOGON OF THIS
:	ENTRY ON THE LOGON SELECTION MENU
:	ARGS:	GSTRN - LEGAL LOGON STRING
:		GLEVEL - LOGON LEVEL
LG.LOGON	MACRO(GLEVEL,GSTRN)[
	IF	DSPGEN
	REMARK	%LG.LOGON(GLEVEL,GSTRN)
	REMARK%
	EI	DSPGEN
	IF	.LT.(LSMSSL,CURLVL)
	ERROR(TYPERR,ERR07,Sysgen Statement not at Correct Level,1)
	ERRNXT(TYPERR,,1)
	REMARK	LG.LOGON(GLEVEL,GSTRN)
	ERREND(TYPERR)
	ELSE
CURLVL	EQ	LSMSSL
	EI				:END OF LEVEL CHECK
	IF	1-ERRFLG
	IF	1-EN.MAC		:BEGIN PREQMC CHECK
	ERROR(TYPERR,ERR08,Pre-Requested Macro Not Defined,1)
	ERRNXT(TYPERR,,1)
	REMARK	LG.LOGON(GLEVEL,GSTRN)
	ERREND(TYPERR)
	EI				:END OF PREQMC CHECK
	IF	1-ERRFLG
	ORG	0			:BEGIN PARAMETER PRESEN CHECK
	AC	/GSTRN/
IZ	EQ	.
	ORG	0
	AC	/GLEVEL/
IY	EQ	.
	ORG	0
	IF	(1-IZ)!(1-IY)
	ERROR(TYPERR,ERR14,Logon Parameter Missing,1)
	ERRNXT(TYPERR,,1)
	REMARK	LG.LOGON(GLEVEL,GSTRN)
	ERREND
	EI				:END OF PARAMETERS PRESETN CHECK
	IF	1-.EQ.(CLGLVL,GLEVEL)
	ERROR(TYPERR,ERR09,Logon String Statement Level not contiguous,1)
	ERRNXT(TYPERR,,1)
	REMARK	LG.LOGON(GLEVEL,GSTRN)
	ERREND(TYPERR)
	EI
	IF	1-ERRFLG
	IF	GLEVEL-4
	ERROR(TYPERR,ERR17,Logon Parameter Level Too Large,1)
	ERRNXT(TYPERR,,1)
	REMARK	LG.LOGON(GLEVEL,GSTRN)
	ERREND(TYPERR)
	EI				:END OF RANGE CHECK
	IF	1-ERRFLG
LVL	EQ	GLEVEL
CLGLVL	EQ	GLEVEL+1
V|LNE||PUN||LUN||ENT|	EQ	CLGLVL
	IF	.EQ.(LVL,0)
A|LNE||PUN||LUN||ENT|	MACRO[
	SC	/GSTRN/
	]
	ELSE	.EQ.(LVL,1)
B|LNE||PUN||LUN||ENT|	MACRO[
	SC	/GSTRN/
	]
	ELSE	.EQ.(LVL,2)
C|LNE||PUN||LUN||ENT|	MACRO[
	SC	/GSTRN/
	]
	ELSE	.EQ.(LVL,3)
D|LNE||PUN||LUN||ENT|	MACRO[
	SC	/GSTRN/
	]
	ELSE	.EQ.(LVL,4)
F|LNE||PUN||LUN||ENT|	MACRO[
	SC	/GSTRN/
	]
	EI
	IF	DISPLY
	REMARK	%    Level GLEVEL 
	REMARK	Logon String           = GSTRN
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	LG.LINE(GLINE):
:	--------------
:	TO SPECIFY THE DESINATION LINE # TO BE ATTACHED FOR PRESET
:	LOGON
:	ARG: GLINE - LINE # [-1, 0FF]
LG.LINE	MACRO(GLINE)[
:	NOLIST
	DSGEN(LG.LINE,GLINE)
	LVLCHK(LSMSSL,LG.LINE,GLINE)
	IF	1-ERRFLG
	PREQMC(LG.ENTRY,EN.MAC,0,LG.LINE,GLINE)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,LG.LINE,GLINE,PMVALU,0,DLN|ENT|,AVALUE)
	RNGCHK(TYPWNG,LG.LINE,AVALUE,PMVALU,0,-1,0FF,0FF,BVALUE)
L|LNE||PUN||LUN||ENT|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Logon DLINE for this Entry     = 
	DSPNUM(BVALUE,0)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	LG.PUADDR(GPUADR)
:	------------------
:	TO SPECIFY THE DESTINATION CU ADDR TO BE ATTACHED FOR PRESET
:	LOGON ONLY
:	ARG:	GPUADR - CU ADDR [-1, 0FF]
LG.PUADDR	MACRO(GPUADR)[
:	NOLIST
	DSGEN(LG.PUADDR,GPUADR)
	LVLCHK(LSMSSL,LG.PUADDR,GPUADR)
	IF	1-ERRFLG
	PREQMC(LG.ENTRY,EN.MAC,0,LG.PUADDR,GPUADR)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,LG.PUADDR,GPUADR,PMVALU,0,DCU|ENT|,AVALUE)
	RNGCHK(TYPWNG,LG.PUADDR,AVALUE,PMVALU,0,-1,0FF,0FF,BVALUE)
P|LNE||PUN||LUN||ENT|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Logon DCU for this Entry       = 
	DSPNUM(BVALUE,0)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	LG.LUADDR(GLUADR)
:	-------------------
:	TO SPECIFY THE DESTINATION LU ADDR TO BE ATTACHED FOR PRESET
:	LOGON ONLY
:	ARG:	GLUADR - LU ADDR [-1, 0FF]
LG.LUADDR	MACRO(GLUADR)[
:	NOLIST
	DSGEN(LG.LUADDR,GLUADR)
	LVLCHK(LSMSSL,LG.LUADDR,GLUADR)
	IF	1-ERRFLG
	PREQMC(LG.ENTRY,EN.MAC,0,LG.LUADDR,GLUADR)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,LG.LUADDR,GLUADR,PMVALU,0,DLU|ENT|,AVALUE)
	RNGCHK(TYPWNG,LG.LUADDR,AVALUE,PMVALU,0,-1,0FF,0FF,BVALUE)
U|LNE||PUN||LUN||ENT|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Logon DLU for this Entry       = 
	DSPNUM(BVALUE,0)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	LG.LTYPE(GLTYPE):
:	-------------------
:	TO SPECIFY THE DESIRED LTYPE CAPABILITY ON THE DESTINATION
:	DEVICE, FOR PRESET LOGON ONLY
:	ARG:	GLTYPE - 2 OR 3
LG.LTYPE	MACRO(GLTYPE)[
:	NOLIST
	DSGEN(LG.LTYPE,GLTYPE)
	LVLCHK(LSMSSL,LG.LTYPE,GLTYPE)
	IF	1-ERRFLG
	PREQMC(LG.ENTRY,EN.MAC,0,LG.LTYPE,GLTYPE)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,LG.LTYPE,GLTYPE,PMVALU,A,2,AVALUE)
	RNGCHK(TYPWNG,LG.LTYPE,AVALUE,PMVALU,A,2,3,2,BVALUE)
T|LNE||PUN||LUN||ENT|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Logon DLTYPE for this Entry    = 
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	LG.COLOR(GCOLOR):
:	-------------------
:	TO SPECIFY THE DESIRED COLOR CAPABILITY ON THE DESTINATION
:	DEVICE, FOR PRESET LOGON ONLY
:	ARG:	GCOLOR - YES/NO
LG.COLOR	MACRO(GCOLOR)[
:	NOLIST
	DSGEN(LG.COLOR,GCOLOR)
	LVLCHK(LSMSSL,LG.COLOR,GCOLOR)
	IF	1-ERRFLG
	PREQMC(LG.ENTRY,EN.MAC,0,LG.COLOR,GCOLOR)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,LG.COLOR,GCOLOR,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,LG.COLOR,AVALUE,PMVALU,A,0,1,0,BVALUE)
O|LNE||PUN||LUN||ENT|	EQ	BVALUE
	IF	DISPLY
	REMARK	%    Logon DCOLOR for this Entry    = 
	IF	BVALUE
	REMARK	Color
	ELSE
	REMARK	Non_Color
	EI	(BVALUE)
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	LG.SIZE(GSIZE)
:	---------------
:	TO SPECIFY THE DESIRED DEVICE SIZE ON THE DESTINCATION 
:	DEVICE, FOR PRESET LOGON ONLY
:	ARG:	GSIZE - 480, 1920, ETC..
LG.SIZE	MACRO(GSIZE)[
:	NOLIST
	DSGEN(LG.SIZE,GSIZE)
	LVLCHK(LSMSSL,LG.SIZE,GSIZE)
	IF	1-ERRFLG
	PREQMC(LG.ENTRY,EN.MAC,0,LG.SIZE,GSIZE)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,LG.SIZE,GSIZE,PMVALU,A,1920,AVALUE)
	RNGCHK(TYPWNG,LG.SIZE,AVALUE,PMVALU,A,480,1920,1920,BVALUE)
Z|LNE||PUN||LUN||ENT|	EQ	C|$ABVALUE|
	IF	DISPLY
	REMARK	%    Logon DSIZE for this Entry     = 
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	LG.CHRSET(GCHRST)
:	---------------
:	TO SPECIFY THE DESIRECHAR SET ON THE DESTINCATION 
:	DEVICE, FOR PRESET LOGON ONLY
:	ARG:	GCHRST - ENGLISH, KATAKANA, AND KANJI
LG.CHRSET	MACRO(GCHRST)[
:	NOLIST
	DSGEN(LG.CHRSET,GCHRST)
	LVLCHK(LSMSSL,LG.CHRSET,GCHRST)
	IF	1-ERRFLG
	PREQMC(LG.ENTRY,EN.MAC,0,LG.CHRSET,GCHRST)	:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,LG.CHRSET,GCHRST,PMVALU,A,0,AVALUE)
	RNGCHK(TYPWNG,LG.CHRSET,AVALUE,PMVALU,A,0,5,0,BVALUE)
Y|LNE||PUN||LUN||ENT|	EQ	BVALUE
	IF	BVALUE-3
JAPANESE	EQ	1
	EI	(BVALUE)
	IF	DISPLY
	REMARK	%    Logon CHAR SET for this Entry  = 
	IF	BVALUE-4
	REMARK	Kanji and Katakana
	ELSE	BVALUE-3
	REMARK	Katakana
	ELSE
	REMARK	English
	EI
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

:	LG.CRM(GCRM)
:	---------------
:	TO SPECIFY THE DESIRED CRM MODE ON THE DESTINCATION 
:	DEVICE, FOR PRESET LOGON ONLY
:	ARG:	GCRM - 1,2,3,4
LG.CRM	MACRO(GCRM)[
:	NOLIST
	DSGEN(LG.CRM,GCRM)
	LVLCHK(LSMSSL,LG.CRM,GCRM)
	IF	1-ERRFLG
	PREQMC(LG.ENTRY,EN.MAC,0,LG.CRM,GCRM)		:(I01/8/28/87/HS)
	IF	1-ERRFLG
	PMPRCK(TYPWNG,LG.CRM,GCRM,PMVALU,A,1,AVALUE)
	RNGCHK(TYPWNG,LG.CRM,AVALUE,PMVALU,A,1,4,1,BVALUE)
W|LNE||PUN||LUN||ENT|	EQ	$ABVALUE
	IF	DISPLY
	REMARK	%    Logon CRM for this Entry       = 
	NUMBER	$A BVALUE
	EI	(DISPLY)
	EI	(1-ERRFLG)
	EI	(1-ERRFLG)
	LIST
	]

	SUBTTL ** SNA INIT ** INITIALIZATION - MISCELLANEOUS MACROS


:	OPTION(LABEL,VALUE):
:	-------------------
:	LABEL is the mnemonic for a particular sysgen parameter
:	VALUE is the new parameter setting
:
:	This macro is used to override default sysgen parameter settings
:
OPTION	MACRO(L1,V1)[NOLIST
L1	EQ	V1
	GL	L1
	LIST]

:	LOPTION(LINE,LABEL,VALUE):
:	--------------------------
:	LINE is the line number
:	LABEL is the mnemonic for a particular sysgen parameter minus
:	the line number
:	VALUE is the new parameter setting
:
:	This macro can be used to override default line sysgen parameters
:
LOPTION MACRO(L2,L1,V1)[NOLIST
	OPTION(L1|L2|,V1)
	LIST]

:	This macro can be used to set a value for a switch
SYS.SWITCH	MACRO(SWNAME,SWVAL)[
		OPTION(SWNAME,SWVAL)
		IF	SWVAL
		REMARK % Switch SWNAME set on
		ELSE
		REMARK % Switch SWNAME set off
		EI
		]

:	SWITCHED MACRO HAS BEEN RE-NAMED TO DTRDSR SINCE 1.05
:	TO ENSURE COMPATIBILITY WITH PREVIOUS VERSION
:	SWITCHED MACRO IS STILL KEPT.
GSWITCHED	MACRO(GDTR)[
	GDTRDSR(GDTR)
		]

SWITCHED	MACRO(DDTR)[
	DTRDSR(DDTR)
		]


:SPECIAL SWITCHES
IG2RSP	EQ	1		:FOR IGNORING RCV 2ND RSP FOR SAME SEG.
:
:BEGIN (11/12/86 YLH)
:
:MACRO TO REMEMBER THE TOTAL NUMBER OF UNBIND REASON CODES AND THE REASON
:CODES WHICH DO NOT CAUSE THE NETWORK CIRCUIT TO BE ZAPPED.
:
UNBNDS	EQ	0		:INIT THE SWITCH AS OFF
RETNUM	EQ	0		:INIT THE TOTAL NUMBER TO ZERO
RETAIN	MACRO(RCODE)[
RETNUM	EQ	RETNUM+1	:INC. THE TOTAL NUMBER AS IT IS CALLED
RCOD|RETNUM|	EQ	RCODE	:REMEMBER THE REASON CODE
	]
:
:END (11/12/86 YLH)
:

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
::									::
::	MACRO     :		PTCHSZ					::
::									::
::	PURPOSE   :							::
::			THIS MACRO SPECIFIES IN HEXADECIMAL BYTES	::
::			THE PATCH AREA SIZES FOR THE PATCH HISTORY	::
::			AREA, THE SEGMENT 0 PATCH AREA, AND THE		::
::			SEGMENT 1 PATCH AREA.				::
::									::
::	ARGUMENTS :							::
::			ARGH - SIZE OF PATCH HISTORY AREA		::
::			ARG0 - SIZE OF SEGMENT 0 PATCH AREA		::
::			ARG1 - SIZE OF SEGMENT 1 PATCH AREA		::
::									::
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

PHSIZE	EQ	$0140			:DEFAULT SIZE OF PATCH HISTORY AREA
P0SIZE	EQ	$0200			:DEFAULT SIZE OF SEGMENT 0 PATCH AREA
P1SIZE	EQ	$0400			:DEFAULT SIZE OF SEGMENT 1 PATCH AREA

PTCHSZ	MACRO(ARGH,ARG0,ARG1)[		:BEGINNING OF MACRO

	KILL	PHSIZE,P0SIZE,P1SIZE	:UNDEFINE PHSIZE, P0SIZE, AND P1SIZE

PHSIZE	EQ	$0 ARGH			:DEFINE PHSIZE IF ARGH PRESENT
P0SIZE	EQ	$0 ARG0			:DEFINE P0SIZE IF ARG0 PRESENT
P1SIZE	EQ	$0 ARG1			:DEFINE P1SIZE IF ARG1 PRESENT

 IF	PHSIZE				:CHECK IF PHSIZE IS POSITIVE
 ELSE					:PHSIZE IS NOT POSITIVE
PHSIZE	EQ	$0140			:USE DEFAULT VALUE
 EI					:(IF PHSIZE)

 IF	P0SIZE				:CHECK IF P0SIZE IS POSITIVE
 ELSE					:P0SIZE IS NOT POSITIVE
P0SIZE	EQ	$0200			:USE DEFAULT VALUE
 EI					:(IF P0SIZE)

 IF	P1SIZE				:CHECK IF P1SIZE IS POSITIVE
 ELSE					:P1SIZE IS NOT POSITIVE
P1SIZE	EQ	$0400			:USE DEFAULT VALUE
 EI					:(IF P1SIZE)

	]				:END OF MACRO
    APQ