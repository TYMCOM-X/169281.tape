SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 1
S.MAC	 6-JUL-89 16:37		S.MAC - with system parameter file for P035/E, March 1989

     1				SUBTTL	S.MAC - with system parameter file for P035/E, March 1989
     2
     3				IF2,<IFNDEF LISTSN,<TAPE>>	;Skip to PASS2 in all but COMMON.LST
     4				;THIS MODULE ASSEMBLED WITH KS-10 PARAMETER FILE - KSSYM.MAC
     5
     6					IF2,<IFNDEF LISTSN,<		;LIST KSSYM.MAC IN COMMON ONLY
     7					.CREF
     8									TAPE>>
     9				; This file is PRINTF.MAC
    10				DEFINE PRINTF(A,B,C,D),<IF2,<;;Output message on MONKS build only
    11				PRINTX A B C D>>
    12
    13				TITLE SCNSER - TYMNET VERSION OF SCNSER
    14
    15					STOPCD(,ENTRY,SCNSER)^
    16					ENTRY	SCNSER		;For library searches
    17	000000'	260040	000000*	SCNSER::PUSHJ	P,DIE		;**** Default stopcode for "SCNSER" ****
    18	000001'	634356	634562		SIXBIT	/SCNSER/  	;Title of module
    19	000002'	000000	000000		S$NONAME,,0		;?NONAME stopcode "SCNSER+nnn(nnnnnn)"
    20			000000'	S$NAME==SCNSER			;For STOPCDs with no arguments
    21					SALL>
    22				^
    23
    24			000001		SCNVER==1	;Version number reported to the base
    25			000000		SCNREL==0	;Release number reported to the base
    26
    27				;THE 620 AND PDP-10 SHARE CORE AS A MEANS OF COMMUNICATION.
    28				;THE 620 PUTS THINGS DESTINED FOR THE PDP-10 INTO A RING
    29				;BUFFER AND VICE VERSA. THE PDP-10 EXAMINES THE STATE OF THE
    30				;RING BUFFER EVERY CLOCK TICK. FOR OUTPUT, THE PDP-10 NEVER
    31				;PUTS OUT MORE THAN 30 (=%CHRMX) CHARACTERS ON A GIVEN LINE
    32				;WITHOUT CHECKING THE INPUT RINGS IN CASE THE 620 REQUESTS
    33				;THE PDP-10 TO STOP DOING OUTPUT ON THAT LINE.
    34
    35				;NOTE VERY CAREFULLY THAT THESE ROUTINES DEPEND ON THE FACT THAT
    36				;CLOCK LEVEL NEVER INTERRUPTS UUO LEVEL AND VICE VERSA.
    37				;FOR THIS REASON THERE ARE NO INTERLOCKS BETWEEN THE TWO
    38				;LEVELS. ANYONE WHO CHANGES THIS BEWARE!!!!!!!!!!
    39
    40				SUBTTL	TABLE OF CONTENTS
    41						;Insert table of contents here
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 2
SCNSER.MAC	25-JAN-91 22:40		DEFINITIONS

    42				SUBTTL	DEFINITIONS
    43
    44			000035	AUXSTM==:^D29		;MAX NUMBER OF CHRS ALLOWED IN AUX STRING
    45			000010	AUXSTL==1+<<AUXSTM+6>/5>;SIZE OF AUX STRING STORAGE BLOCK
    46
    47			000033	STDALT==33		;STANDARD ALTMODE
    48
    49			000004	TTCHKS==4		;SIZE OF TELETYPE BUFFERLETS
    50			000010	TT2CHK==TTCHKS*2
    51
    52			000002	IMGDIM==2		;TIME TO WAIT IN IMAGE AFTER FIRST CHR
    53			000012	IMGTIM==^D10		;TIME TO WAIT IN IMAGE MODE FOR FIRST CHR
    54			000003	TIRSVD==3		;Number of chunks reserved for emergencies
    55			000110	TIWKC==^D72		;# of input chars to wake job (72 or 132)
    56				IFG TIWKC-^D72,<PRINTX Setting TIWKC above 72 causes PTY backpressure problems
    57						TIWKC==^D72>
    58			000120	TILOW==TIWKC+^D8	;# of unread input chars to trigger backpressure
    59							;(TIWRNN set to TILOW.  TIHLTN based on IRING size)
    60			000024	OWTIM==^D20		;1/2 OF ORANGE-BALL-WAIT TIMEOUT ON ZAP
    61							;(SEE TTYZAP)
    62
    63			000120	CTY==120		;FOR SPECIAL TYPOUT ON PARITY ERR
    64
    65			000036	%CHRMX==^D30		;MAX NUMBER OF CHRS TO OUTPUT ON LINE WITHOUT
    66							;RETURNING TO INPUT RING CODE (THE EFFECT IS
    67							;THAT %CHRMX IS THE NUMBER OF CHARACTERS OF
    68							;"DELAY" IN GETTING BACKPRESSURE APPLIED
    69							;TO THE LINE)  Should be <4*N>-2 for efficiency
    70
    71			000017	%PBTIM==^D15		;PTY BLOCK INPUT TIMEOUT
    72
    73				;CONDITIONAL ASSEMBLY FLAGS
    74
    75			000000	YLBUG==0		;1 IF BASE TURNS ALL ORANGE BALLS INTO YELLOW
    76			000001	OPCRET==1		;1 IF PROGRAMS THINK TTCALLS IGNORE IMAGE
    77
    78				SUBTTL	THE EXTERNALS FOR SCNSER
    79
    80				;FROM COMMON
    81				EXTERNAL BITNTB,LINFLG,NMXFLG,ALR620,JBTABT,JBTUNM,JBTUN1
    82				EXTERNAL JBTCIN,JBTCOT,JBTBCS,JBTLIC,JBTAWQ,JBTBET,JBTBIO
    83				EXTERNAL IRING,ORING,ORPPDP,IRPPDP,ORP620,IRP620,MSKIRG,MSKORG
    84				EXTERNAL JOBN,HIGHJB,CONFIG,QUEPCB
    85
    86				;GENERAL EXTERNALS
    87				EXTERNAL TPOPJ,TPOPJ1,CPOPJ,CPOPJ1,IPOPJ,IPOPJ1
    88				EXTERNAL STTIOD,JBTSTS,LINTAB,JBTPRV
    89				EXTERNAL PJOBN,WSYNC,SETRUN,PEVEN8,JOB,REFLAG
    90				EXTERNAL TTYTAB,PUNIT,STATES,UPTIME,PVYMOD
    91				EXTERNAL DEVOPR,THSDAT,JFYSEC,TIME	;NAME OF OPER CONSOLE
    92				EXTERNAL GET4WD,GIV4WD,BIOCOR
    93
    94				;EXTERNALS USED BY MUUO ROUTINES
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 2-2
SCNSER.MAC	25-JAN-91 22:40		THE EXTERNALS FOR SCNSER

    95				EXTERNAL OUT,BUFCLR,ADRERR,ADVBFF,ADVBFE
    96				EXTERNAL GTCGSZ,RELEA6
    97				EXTERNAL CHKSEG,SETIO2
    98
    99				EXTERNAL TTVINI,TTVIN2		;BIT IN LINTAB (LH) TO SAY SHOULD RUN INITIA
   100
   101				;UUOCON ALSO USES TTYFND,LDLCOM,TTYU;STC,TTYFUW
   102				;AND DDBLDB,LDBDCH,LDBDDB
   103
   104				;FOR CLOCK1
   105				EXTERNAL AXAVAL,AXREQ,AXSWT,AXWAIT,MLOWQ,RNQ,WSCHED,CHGCLK
   106				EXTERNAL FCREQ,FCWAIT
   107				EXTERNAL BPAVAL,BPREQ,BPWAIT
   108
   109				;FILSER ALSO USES TTYFUW,TTYSTR
   110
   111				;PICON
   112				EXTERNAL ABTUUO,TAKTRJ,TAKNZJ,TAKOTJ,TSTKTJ,TSTKTP,TSTTRJ,JBTPIP,TAKTRP
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 3
SCNSER.MAC	25-JAN-91 22:40		TERMINAL CHARACTERISTICS DEFINITIONS

   113				SUBTTL	TERMINAL CHARACTERISTICS DEFINITIONS
   114
   115				;TERMINAL CHARACTERISTICS
   116
   117				DEFINE TCHARS <;;Define TCNxxx, also expanded at TCNDSP and TCVMAX
   118				Z(CRD,1,TYMTC,TMCCRD)
   119				Z(IR,17,TYMTC,TMCIR)
   120				Z(OR,17,TYMTC,TMCOR)
   121				Z(PAR,1,TYMTC,TMCPAR)
   122				Z(HDX,1,TYMTC,TMCHDX)
   123				Z(PA,7,TYMTC,TMCPA)
   124				Z(PB,7,TYMTC,TMCPB)
   125				Z(PC,17,TYMTC,TMCPC)
   126				Z(XON,1,TYMTC,TMCXON)
   127				Z(ECH,1,TYMTC,TMCECH)
   128				Z(RXE,1,TYMTC,TMCRXE)
   129				Z(PD,17,TYMTC,TMCPD)	;PARM D, was TCNTYP/TMCTYP
   130				Z(NXO,1,BYTTC,LDPNXO)
   131				Z(WID,377,ACWIDC,0)
   132				Z(FC1,3,BYTTC,LDPFC1)
   133				Z(FC2,3,BYTTC,LDPFC2)
   134				Z(BSP,1,ACBSPC,0)
   135				Z(ERA,1,ACERAC,0)
   136				Z(DEF,1,ACDEFC,0)
   137				Z(LCO,1,BYTTC,LDPLCO)
   138				Z(TAB,1,BYTTC,LDPTAB)
   139				Z(FRM,1,BYTTC,LDPFRM)
   140				Z(LCT,1,BYTTC,LDPLCT)
   141				Z(NFC,1,BYTTC,LDPNFC)
   142				Z(PTP,1,ACPTPC,0)
   143				Z(BSD,1,BYTTC,LDPBSD)
   144				Z(CLA,377777777777,ACTCLA,0)	;Class (was TMCTTP)
   145				Z(RTC,1,BYTTC,LDPRTC)
   146				Z(KAT,1,TYMTC,TMCKAT)		;KATAKANA (Japanese modes), was TMCTYP
   147				Z(TYP,377777777777,ACTTYP,0)
   148				>  ;Max of 36 fields, so that TYMNET or PTY can be notified
   149
   150			000000	ZZN==0
   151				DEFINE Z(NAME,MAXVAL,TYPE,ARG) = <
   152					TCN'NAME==ZZN
   153					ZZN==ZZN+1
   154				>
   155				TCHARS
   156			000036	TCNN==ZZN
   157				IFG <TCNN-^D36>,<
   158					PRINTX MORE THAN 36 TYMCOM-X TERMINAL CHARACTERISTICS
   159					QQQQQQ
   160				>
   161	000003'	777777	777700	TCBALL:	<-1 _ <^D36-TCNN>>
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 4
SCNSER.MAC	25-JAN-91 22:40		TYMNET TERMINAL CHARACTERISTICS

   162				SUBTTL TYMNET TERMINAL CHARACTERISTICS
   163
   164				;DEFINE NAMES AND FIELD WIDTHS
   165
   166				DEFINE TERCHR <;;Terminal characteristics that TYMNET-II responds to
   167				TC(ECO,1)	; 0. ECHO
   168				TC(CIE,1)	; 1. ECHO CONTROL-I
   169				TC(ELF,1)	; 2. ECHO LF AS LF/CR/DELAY
   170				TC(ECR,1)	; 3. ECHO CR AS CR/LF
   171				TC(CRD,1)	; 4. CR DELAY
   172				TC(IR,4)	; 5. INPUT BAUD RATE CODE
   173				TC(OR,4)	; 6. OUTPUT BAUD RATE CODE
   174				TC(PAR,1)	; 7. PARITY (EVEN OR NONE)
   175				TC(HDX,1)	; 8. HALF DUPLEX
   176				TC(PA,3)	; 9. PARAMETER A
   177				TC(PB,3)	;10. PARAMETER B
   178				TC(PC,4)	;11. PARAMETER C
   179				TC(XON,1)	;12. X-ENABLE FOR REMOTE
   180				TC(ECH,1)	;13. ECHO CONTROL-H
   181				TC(RXE,1)	;14. REVERSE X-ENABLE
   182				TC(PD,4)	;15. PARAMETER D to ISIS (TMCPD was TMCTYP)
   183				TC(KAT,1)	;16. KATAKANA MODE (See comments at TYMTC2)
   184				TC(TOB,1)	;17. TERMINATE OUTPUT ON BREAK
   185				TC(ESC,1)	;18. ECHO ESCAPE
   186				TC(QM,1)	;19. Q-MODE (echo } and ~, they are not ALTMODEs)
   187				TC(SPA,1)	;20. SPACE PARITY  (not in EBUS02.J01!!)
   188				>
   189
   190				;DEFINE TERMINAL CHARACTERISTICS CODES
   191
   192			000000	ZZN==0
   193				DEFINE TC(N,Z)  <TMC'N==ZZN
   194				ZZN==ZZN+1>
   195				TERCHR
   196
   197			000077	TMCALL==77	;PROBE CODE TO GET ALL TERMINAL CHARACTERISTICS
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 5
SCNSER.MAC	25-JAN-91 22:40		DEFINE RECEIVED CHARACTERISTICS BYTE POINTERS

   198				SUBTTL	DEFINE RECEIVED CHARACTERISTICS BYTE POINTERS
   199
   200			000000	ZZWORD==0
   201		777777	777777	ZZPOS==-1
   202				DEFINE TC(N,W) <IFG <ZZPOS+W>-^D35,<ZZPOS==-1
   203				ZZWORD==ZZWORD+1>
   204				ZZPOS==ZZPOS+W
   205				LDP'N:	POINT W,LDBTMR+ZZWORD(U),ZZPOS>
   206
   207	000004'	430105	000044	TABTMR:	TERCHR
   208	000005'	420105	000044
   209	000006'	410105	000044
   210	000007'	400105	000044
   211	000010'	370105	000044
   212	000011'	330405	000044
   213	000012'	270405	000044
   214	000013'	260105	000044
   215	000014'	250105	000044
   216	000015'	220305	000044
   217	000016'	170305	000044
   218	000017'	130405	000044
   219	000020'	120105	000044
   220	000021'	110105	000044
   221	000022'	100105	000044
   222	000023'	040405	000044
   223	000024'	030105	000044
   224	000025'	020105	000044
   225	000026'	010105	000044
   226	000027'	000105	000044
   227	000030'	430105	000045
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 6
SCNSER.MAC	25-JAN-91 22:40		DEFINE SENT CHARACTERISTICS BYTE POINTERS

   228				SUBTTL	DEFINE SENT CHARACTERISTICS BYTE POINTERS
   229
   230			000000	ZZWORD==0
   231		777777	777777	ZZPOS==-1
   232				DEFINE TC(N,W) <IFG <ZZPOS+W>-^D35,<ZZPOS==-1
   233				ZZWORD==ZZWORD+1>
   234				ZZPOS==ZZPOS+W
   235				LDS'N:	POINT W,LDBTMS+ZZWORD(U),ZZPOS>
   236
   237	000031'	430105	000046	TABTMS:	TERCHR
   238	000032'	420105	000046
   239	000033'	410105	000046
   240	000034'	400105	000046
   241	000035'	370105	000046
   242	000036'	330405	000046
   243	000037'	270405	000046
   244	000040'	260105	000046
   245	000041'	250105	000046
   246	000042'	220305	000046
   247	000043'	170305	000046
   248	000044'	130405	000046
   249	000045'	120105	000046
   250	000046'	110105	000046
   251	000047'	100105	000046
   252	000050'	040405	000046
   253	000051'	030105	000046
   254	000052'	020105	000046
   255	000053'	010105	000046
   256	000054'	000105	000046
   257	000055'	430105	000047
   258				INTERN LDSRXE	;CTYSIM needs this pointer
   259
   260			000024	MAXTMC==.-TABTMS-1
   261			000025	TMCSLP==^D21	;IF MAXTMC .lt. TMC .ge. MAXTMC+TMCSLP, WE WILL
   262						;IGNORE TYMNET MESSAGES FOR THE <TMC> RATHER
   263						;THAN CRASHING (THIS LETS TYMNET GET AHEAD OF US)
   264			000002	TMCSIZ==ZZWORD+1
   265				IFG MAXTMC-^D35,<PRINTX MORE THAN 36 TERMINAL CHARACTERISTICS
   266				QQQQQQ>
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 7
SCNSER.MAC	25-JAN-91 22:40		OUTPUT REQUEST BITS

   267				SUBTTL OUTPUT REQUEST BITS
   268
   269				;WHEN A PORT WANTS SOMETHING SENT TO TYMNET, IT SETS ONE OF
   270				;THESE BITS IN ITS LDBOUT WORD. MESSAGES CORRESPONDING TO
   271				;HIGH-ORDER BITS ARE SENT FIRST.
   272
   273				DEFINE OUTBIT, <
   274				ZZZ(HSH)	;HUSH - SUPRESS MESSAGES FROM INITIALIZATION ROUTINE
   275				ZZZ(TRO)	;TERMINATE BLOCK OUTPUT
   276				ZZZ(CGB)	;CHARACTER GOBBLER
   277				ZZZ(BIN)	;BLOCK INPUT
   278				ZZZ(TRI)	;TERMINATE BLOCK INPUT
   279				ZZZ(BPN)	;BACKPRESSURE ON
   280				ZZZ(BPF)	;BACKPRESSURE OFF
   281				;-------messages above this line may be output on a backpressured port
   282				ZZZ(BOP)	;BLOCK OUTPUT IN PROGRESS (PTYS ONLY)
   283				ZZZ(SRD)	;RED BALL
   284				ZZZ(SEC)	;ECHO MODE
   285				ZZZ(STP)	;TERMINAL CHARACTERISTICS PROBE
   286				ZZZ(STC)	;SET TERMINAL CHARACTERISTICS
   287				ZZZ(SBL)	;SEND BELL (!)
   288				ZZZ(FIL)	;FILLER CHARACTERS
   289				ZZZ(RUB)	;RUBOUT CHARACTERS
   290				ZZZ(OUT)	;OUTPUT CHARACTERS
   291				ZZZ(BOT)	;BLOCK OUTPUT
   292				ZZZ(SYL)	;YELLOW BALL	(Set by TTYZAP if not a zap from Tymnet)
   293				ZZZ(HNG)	;SOFT ZAP	(Drop DTR to autodial modem, keep circuit)
   294				ZZZ(ZAP)	;HARD ZAP	(Wait for orange ball if host initiated)
   295				ZZZ(ECO)	;ECHO CHARACTERS
   296				ZZZ(SGR)	;GREEN BALL
   297				ZZZ(SOG)	;ORANGE BALL
   298				>
   299
   300			000000	ZZN==0
   301				DEFINE ZZZ(NAME), <
   302					IFE <ZZN-36>, <
   303						PRINTX MORE THAN 36 OUTPUT BITS
   304						QQQQQQ
   305					>
   306					LOP'NAME:POINT 1,LDBOUT(U),ZZN
   307					ZZN==ZZN+1
   308				>
   309	000056'	430105	000003	OUTBIT
   310	000057'	420105	000003
   311	000060'	410105	000003
   312	000061'	400105	000003
   313	000062'	370105	000003
   314	000063'	360105	000003
   315	000064'	350105	000003
   316	000065'	340105	000003
   317	000066'	330105	000003
   318	000067'	320105	000003
   319	000070'	310105	000003
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 7-2
SCNSER.MAC	25-JAN-91 22:40		OUTPUT REQUEST BITS

   320	000071'	300105	000003
   321	000072'	270105	000003
   322	000073'	260105	000003
   323	000074'	250105	000003
   324	000075'	240105	000003
   325	000076'	230105	000003
   326	000077'	220105	000003
   327	000100'	210105	000003
   328	000101'	200105	000003
   329	000102'	170105	000003
   330	000103'	160105	000003
   331	000104'	150105	000003
   332
   333			000006	BPOKBN==LOPBPF-LOPHSH	;BIT# OF LOWEST-PRIORITY MESSAGE
   334							;THAT CAN BE SENT ON A BACKPRESSURED PORT
   335			000024	NUMECO==LOPECO-LOPHSH	;BIT # OF ECHO
   336			000026	LAPBIT==LOPSOG-LOPHSH   ;LAST LEGAL PRIORITY BIT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 8
SCNSER.MAC	25-JAN-91 22:40		LINE DATA BLOCK

   337				SUBTTL LINE DATA BLOCK
   338
   339				;LINTAB:	ONE WORD PER PORT. RH = ADR OF LINE DATA BLOCK
   340				;		LH 13-17 =0 FOR @ LINTAB
   341
   342				;LDBDDB		ONE LINE DATA BLOCK PER PORT. LINK BETWEEN
   343				;		THE LINE DATA BLOCK AND THE TTY DDB IS THE
   344				;		THING MANIPULATED BY ATTACH AND DETACH.
   345
   346	000000			CTYLDB::PHASE	0	;TTY LDB PROTOTYPE
   347	000000			LDICLR:!
   348	000105'	000000	000000	LDBDDB::!0	;(RH)	ADDR OF ATTACHED DDB, IF ATTACHED
   349	000106'	000000	000000	LDBLIN:! 0	;27-35	Port number (LDPLNO, 9 bits)
   350						;18-26	9 unused bits
   351						; 2-17	Origination host number (LDPHST, 16 bits)
   352						; 1	1 unused bit
   353			400000	LNLZIN==400000	; 0	Zapper received from TYMNET & not echoed yet
   354	000107'	000000	000000	LDBOPB:! 0	;BYTE POINTER TO SET NEED-OUTPUT BIT
   355	000110'	000000	000000	LDBOUT:! 0	;BITS SPECIFYING WHAT WANTS TO BE OUTPUT
   356	000111'	000000	000000	LDBTCB:! 0	;(PTYS) BITS INDICATING CHANGED TERMINAL CHARACTERISTICS
   357
   358	000112'	000000	000000	LDBBIO:! 0	;(LH)	BLOCK OUTPUT BUFFER ADDR
   359						;(RH)	BLOCK INPUT BUFFER ADDR
   360
   361	000113'	000000	000000	LDBBKP:! 0	;^U POINTER, RESET TO HERE
   362	000114'	000000	000000	LDBBKI:! 0	;(RH)	# INPUT CHARACTERS SINCE LBBBKP
   363						;(LH)	# BREAK2 CHARACTERS SINCE LDBBKP
   364
   365	000115'	000000	000000	LDBTIP:! 0	;INPUT PUTTER
   366	000116'	000000	000000	LDBTIT:! 0	;INPUT TAKER
   367	000117'	000000	000000	LDBTIC:! 0	;# CHARACTERS IN INPUT BUFFER
   368	000120'	000000	000000	LDBECT:! 0	;ECHO TAKER
   369	000121'	000000	000000	LDBECC:! 0	;# CHARACTERS IN ECHO BUFFER
   370	000122'	000000	000000	LDBBKC:! 0	;(RH)	# BREAK CHARACTERS IN INPUT BUFFER
   371						;(LH)	# BREAK CHARACTERS IN ECHO BUFFER
   372	000123'	000000	000000	LDBBK2:! 0	;(RH)	# BREAK2 CHARACTERS IN INPUT BUFFER
   373						;(LH)	# BREAK2 CHARACTERS IN ECHO BUFFER
   374
   375	000124'	000000	000000	LDBTOP:! 0	;OUTPUT PUTTER
   376	000125'	000000	000000	LDBTOT:! 0	;OUTPUT TAKER
   377	000126'	000000	000000	LDBTOC:! 0	;# CHARACTERS IN OUTPUT BUFFER
   378
   379	000127'	000000	000000	LDBFLP:! 0	;OUTPUT FILLER POINTER (FOR HT/VT/FF PADDING)
   380
   381	000130'	000000	000000	LDBRBI:! 0	;RUBOUT ECHO PUTTER
   382	000131'	000000	000000	LDBRBO:! 0	;RUBOUT ECHO TAKER
   383	000132'	000000	000000	LDBRBC:! 0	;# RUBOUT ECHO CHARACTERS
   384	000133'	000000	000000	LDBLOG::!0	;TYMNET login data
   385						;< 0	logged-in, bits 4-35 hold data from supervisor
   386						;= 0	not in use
   387						;> 0	in the process of logging in
   388			200000	LLLZAP==200000	; 1	zapper received or HANG uuo done on port
   389			100000	LLLNLN==100000	; 2	no line, the base has given up on this port
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 8-2
SCNSER.MAC	25-JAN-91 22:40		LINE DATA BLOCK

   390						; 3     unused TYMCOM-X bit
   391						; 4-11  first byte from needle (bits 4&5 not used by EBUS)
   392			004000	LLLHDX==004000	; 6	terminal is half duplex (32.-63. decimal)
   393						; 7-11	terminal identifier code (0.-31. decimal)
   394						;14-19	originating node # (high-order 8 bits)
   395						;22-27	originating node # (low-order 6 bits) (20&21 unused)
   396						;29-35	originating port # (obsolete, not valid in ISIS CONSAT)
   397	000134'	000000	000000	LDBBYT:! 0	;RANDOM BYTES
   398
   399			400000	L2LOEX==400000	;0	(MUST BE SIGN BIT) OUTPUT SHOULD BE
   400						;	GIVEN MORE ROOM (TO KEEP FROM TRAPPING
   401						;	DURING AN OUTSTR)
   402			200000	L2LCCS==200000	;1	SEEN 1 ESCAPE/^C
   403			100000	L2LTBK==100000	;2	(LDPTBK) TABS ARE BREAKS (BREAKSET 2 MODE)
   404			040000	L2LBBP==040000	;3	(LDPBBP) BACKSPACE IS PUNCTATION, NOT A BREAK
   405			020000	L2LNTB==020000	;4	(LDPNTB) DON'T ECHO HT, VT, FF
   406			010000	L2LLDF==010000	;5	JOB WANTS TO LEAVE DEFERRED ECHO MODE
7			004000	L2LDEL==004000	;6	DELETE IN PROGRESS (I.E., WE HAVE TYPED
   408						;	A SLASH AND ARE ECHOING DELETED CHARS)
   409			002000	L2LOWS==002000	;7	ONCE-IN-20-SECOND LOGIC HAS FOUND
   410						;	L2LOWT SET
   411			001000	L2LBSP==001000	;8	(LDPBSP) SEND BACKSPACE FOR CHARACTER-DELETES
   412			000400	L2LOWT==000400	;9	LOGOUT LOGIC HAS SENT A YELLOW BALL AND
   413						;	IS WAITING FOR AN ORANGE BALL BACK
   414						;10-11	(LDPMOD) MONITOR MODE
   415						;12-13	(LDPFC2) FILLER CLASS 2 (HT)
   416						;14-21	(LDPWID) LINE WIDTH
   417						;22-23	(LDPFC1) FILLER CLASS 1 (VT FF)
   418						;24-27	(LDPTIM) IMAGE-INPUT-TIMEOUT TIMER
   419						;28-35	(LDPPOS) CURRENT LINE POSITION (0-511.)
   420	000135'	000000	000000	LDBMOD:! 0	;BYTES TO INDICATE THE MODE LINE IS IN
   421
   422			400000	LMLTBI==400000	;0	TRMI REQUESTED BUT TRMIHR NOT RECEIVED
   423			200000	LMLPSP==200000	;1	1 IF PORT STATUS RECEIVED BUT NOT READ
   424						;2-5	LAST PORT STATUS MESSAGE RECEIVED (see comment @ ACPSM)
   425			001000	LMLBIO==001000	;8	PORT ENABLED FOR BLOCK I/O
   426						;9-15	IMAGE COUNT FOR CHARGING
   427						;16-22	LINE MODE BITS FOR INPUT
   428						;16-18	ECHO MODE
   429						;19-22	INPUT MODE
   430						;23-31	IMAGE MODE BREAK CHARACTER
   431						;32-35	(UNUSED)
   432	000136'	000000	000000	LDBDCH::!0	;DEVICE CHARACTERISTICS
   433
   434				;BITS IN LH
   435
   436			400000	LDLNOP==400000	; *0	TYMNET REQUESTS NO MORE OUTPUT
   437						;	(MUST BE SIGN BIT)
   438			200000	LDLSOX==200000	;  1	SUPPRESS OUTPUT TRANSLATION
   439			100000	LDLECS==100000	; *2	EAT COMMAND SYNC
   440			040000	LDLPTY==040000	;  3	PSEUDO-TTY
   441			020000	LDLCOM==:20000	;! 4	IN COMMAND MODE
   442			010000	LDLBKA==010000	;! 5	SINGLE CHARACTER ACTIVATES
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 8-3
SCNSER.MAC	25-JAN-91 22:40		LINE DATA BLOCK

   443			004000	LDLBK2==004000	;! 6	IN BREAK2 MODE
   444			002000	LDLIMI==002000	;! 7	IN IMAGE MODE
   445			001000	LDLDEF==001000	;!*8	DEFERRED ECHO MODE
   446			000400	LDLOSU==000400	; *9	OUTPUT SUPRESS (^O)
   447			000200	LDLNFC==000200	; *10	NO FREE CRS ON LONG LINES
   448			000100	LDLNEC==000100	; *11	NO ECHO
   449			000040	LDLAUX==000040	; *12	AUX CIRCUIT
   450			000020	LDLLCT==000020	; *13	LOWER CASE TO UPPER CASE
   451			000010	LDLTAB==000010	; *14	TTY DOES TABS
   452			000004	LDLLCP==000004	; *15	LOCAL COPY (2741)
   453			000002	LDLPTP==000002	; *16	IN PAPER TAPE MODE
   454			000001	LDLFRM==000001	; *17	TTY DOES FORMS AND VTABS
   455
   456				;! -- REFERENCED THROUGH LDPMDF TO SET LINE MODE
   457				;* -- GIVEN TO USER IN SAME BIT POSITION BY GETLCH
   458
   459				;BITS IN RH
   460
   461			400000	LDRBPS==400000	;BACKPRESSURE HAS BEEN SENT
   462			200000	LDRXOS==200000	;XOFF HAS BEEN SENT
   463			100000	LDRNXO==100000	;(LDPNXO) DON'T SEND XON/XOFF
   464			040000	LDRDEM==040000	;STAY IN DEFERRED ECHO MODE
   465			020000	LDRFCS==020000	;FULL CHARACTER SET MODE
   466			010000	LDRBIP==010000	;PTY BLOCK INPUT IN PROGRESS
   467	000137'	000000	000000	LDBDCX:! 0	;DEVICE CHARACTERISTICS EXTENSION
   468
   469				;BITS IN LH
   470
   471			400000	LXL120==400000	;1 IF FAST LINE, 0 IF SLOW (MUST BE SIGN BIT)
   472				;LXLxx==200000	;(UNUSED 2-6-81)
   473			100000	LXLBSD==100000	;BACKSPACE == RUBOUT/^A (LPDBSD)
   474			040000	LXLERA==040000	;IF L2LBSP SET: SEND <BS><SP><BS> NOT JUST <BS>
   475						;FOR CHARACTER DELETE (LDPERA)
   476			020000	LXLDLR==020000	;SUPPRESS $ ECHO ON ALTMODES
   477			010000	LXLLCO==010000	;SET FOR CONV OF UPPER TO LOWER CASE ON OUTPUT (LDPLCO)
   478			004000	LXLOOK==004000	;OK TO SEND ORANGE BALL -- SET WHEN A YELLOW BALL
   479						;ARRIVES THAT THE MONITOR DIDN'T REFLECT (BECAUSE
   480						;THE USER WAS TRAPPING YELLOW BALLS)
   481			002000	LXLRTC==002000	;[Darren] Half-assed ^R/^T compatibility - says to
   482						; treat ^T as .USESTAT command if set.
   483
   484				;BITS IN RH -- SET WHEN EVENTS THAT COULD CAUSE INTERRUPTS
   485				;	       HAPPEN TO A PORT FOR LATER POLLING WITH
   486				;	       GETLCH OR THE POLPRT UUO (WHICH CLEAR
   487				;	       THE BITS READ)
   488
   489			400000	LXRESC==400000	;ESCAPE SEEN
   490			200000	LXROBS==200000	;ORANGE BALL SEEN
   491			100000	LXRPSS==100000	;PORT STATUS MESSAGE SEEN (see comment at ACPSM)
   492			040000	LXRICL==040000	;INPUT CHARACTERS LOST
   493			020000	LXROCL==020000	;OUTPUT CHARACTERS LOST
   494			010000	LXRCHR==010000	;CHARACTER SEEN
   495			004000	LXRBRK==004000	;BREAK CONDITION SEEN:
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 8-4
SCNSER.MAC	25-JAN-91 22:40		LINE DATA BLOCK

   496						;1) BREAK CHARACTER READ IN NORMAL STATE
   497						;2) IMAGE BREAK HAPPENED IN IMAGE STATE
   498						;3) BREAK2 CHARACTER READ WITH BK2 SET
   499						;4) BLOCK RECEIVED IN BLOCK INPUT MODE
   500			002000	LXRYBS==002000	;YELLOW BALL SEEN
   501			001000	LXRCGS==001000	;CHARACTER GOBBLER SEEN
   502			000400	LXRIOS==000400	;OUTPUT DONE
   503			000200	LXRTCC==000200	;TERMINAL CHARACTERISTIC CHANGED OR PORT JUST ATTACHED
   504
   505	000140'	000000	000000	LDBCLA:! 0	; [dws] Optional sixbit terminal class
   506			000033	LDBTYP==LDBCLA	;[JMS] TYPE same as CLASS for now
   507	000034			LDBSTR::!BLOCK AUXSTL	;SPACE FOR AUX CIRCUIT STRING (LH of CONFIG item 154)
   508	000044			LDBTMR:! BLOCK TMCSIZ	;TERMINAL CHARACTERISTICS RECEIVED
   509	000046			LDBTMS:! BLOCK TMCSIZ	;TERMINAL CHARACTERISTICS TO BE SENT
   510	000155'	000000	000000	LDBTMT:! 0		;BIT N=1 TO SEND T.C. N
   511
   512				;LDBTMT BIT DEFINITIONS
   513
   514			000000	ZZN==0
   515				DEFINE TC(N,Z) <LTS'N==1B<ZZN>
   516				ZZN==ZZN+1>
   517				;TTY LDB. THERE IS ONE OF THESE PER PORT.
   518				TERCHR
   519
   520			000050	LDICLE==.-1
   521	000156'			DEPHASE
   522			000051	LDBLEN==:.-CTYLDB
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 9
SCNSER.MAC	25-JAN-91 22:40		RANDOM LDB BYTE POINTERS

   523				SUBTTL	RANDOM LDB BYTE POINTERS
   524
   525	000156'	300505	000026	TRMBYP:	POINT  5,LDBLOG(U),11	;Terminal ID code (see also LLLHDX)
   526
   527	000157'	001105	000001	LDPLNO::POINT  9,LDBLIN(U),35	;Port number (TTY0 thru TTY777)
   528	000160'	222005	000001	LDPHST:	POINT 16,LDBLIN(U),17	;Origination host number (new in EBUS 2.01)
   529
   530	000161'	410105	000027	LDPTBK:	POINT 1,LDBBYT(U),2	;TABS-AS-BREAKS
   531	000162'	400105	000027	LDPBBP:	POINT 1,LDBBYT(U),3	;BACKSPACE-AS-PUNCTUATION
   532	000163'	370105	000027	LDPNTB:	POINT 1,LDBBYT(U),4	;NO SPECIAL TAB HANDLING
   533	000164'	330105	000027	LDPBSP:	POINT 1,LDBBYT(U),8	;BS OR ERASE FOR CHAR DELETE
   534	000165'	300205	000027	LDPMOD:	POINT 2,LDBBYT(U),11	;MONITOR MODE
   535	000166'	260205	000027	LDPFC2:	POINT 2,LDBBYT(U),13	;FILLER CLASS 2
   536	000167'	260214	000027	LDPFA2:	POINT 2,LDBBYT(P1),13
   537	000170'	161005	000027	LDPWID:	POINT 8,LDBBYT(U),21	;LINE WIDTH
   538	000171'	161014	000027	LDPWDA:	POINT 8,LDBBYT(P1),21
   539	000172'	140205	000027	LDPFC1:	POINT 2,LDBBYT(U),23	;FILLER CLASS 1
   540	000173'	140214	000027	LDPFA1:	POINT 2,LDBBYT(P1),23
   541	000174'	100405	000027	LDPTIM:	POINT 4,LDBBYT(U),27	;IMAGE INPUT TIMEOUT TIMER
   542	000175'	001005	000027	LDPPOS:	POINT 8,LDBBYT(U),35	;ESTIMATED POSITION ON LINE
   543
   544	000176'	360405	000030	LDPPSM:	POINT 4,LDBMOD(U),5	;LAST PORT-STATUS MSG
   545	000177'	240705	000030	LDPCHG:	POINT 7,LDBMOD(U),15	;IMAGE COUNT FOR CHARGING
   546	000200'	150705	000030	LDPLMD:	POINT 7,LDBMOD(U),22	;ALL THE LINE MODE (INPUT AND ECHO)
   547	000201'	210305	000030	LDPMEC:	POINT 3,LDBMOD(U),18	;ECHO LINE MODE
   548	000202'	150405	000030	LDPMIN:	POINT 4,LDBMOD(U),22	;INPUT LINE MODE
   549	000203'	041105	000030	LDPIMB:	POINT 9,LDBMOD(U),31	;IMAGE MODE BREAK CHARACTER
   550	000204'	000405	000030	LDPMOU:	POINT 4,LDBMOD(U),35	;OUTPUT LINE MODE
   551
   552	000205'	420105	000031	LDPSOX:	POINT 1,LDBDCH(U),1	;SUPPRESS OUTPUT TRANSLATION
   553	000206'	370105	000031	LDPCOM:	POINT 1,LDBDCH(U),4	;COMMAND MODE BIT
   554	000207'	330505	000031	LDPMDF:	POINT 5,LDBDCH(U),8	;SOURCE OF LINE MODE INFO
   555	000210'	310105	000031	LDPNFC:	POINT 1,LDBDCH(U),10	;NO FREE CRLFS
   556	000211'	260105	000031	LDPLCT:	POINT 1,LDBDCH(U),13	;LOWER CASE TRANSLATION (TO UPPER)
   557	000212'	250105	000031	LDPTAB:	POINT 1,LDBDCH(U),14	;HARDWARE TABS
   558	000213'	230105	000031	LDPPTP:	POINT 1,LDBDCH(U),16	;PAPER TAPE MODE
   559	000214'	220105	000031	LDPFRM:	POINT 1,LDBDCH(U),17	;HARDWARE FF/VT
   560	000215'	170105	000031	LDPNXO:	POINT 1,LDBDCH(U),20	;DON'T SEND XON/XOFF
   561	000216'	160105	000031	LDPDEM:	POINT 1,LDBDCH(U),21	;PERPETUAL DEFERRED ECHO MODE
   562
   563	000217'	410105	000032	LDPBSD:	POINT 1,LDBDCX(U),2	;BACKSPACE == RUBOUT/^A
   564	000220'	400105	000032	LDPERA:	POINT 1,LDBDCX(U),3	;ERASE ON CHAR DEL
   565	000221'	360105	000032	LDPLCO:	POINT 1,LDBDCX(U),5	;LOWER CASE OUTPUT ONLY
   566	000222'	340105	000032	LDPRTC:	POINT 1,LDBDCX(U),7	;[Darren] special ^T mode
   567	000223'	004405	000033	LDPCLA:	POINT 36,LDBCLA(U),35	;Terminal CLASS
   568	000224'	004405	000033	LDPTYP:	POINT 36,LDBTYP(U),35	;Terminal TYPE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 10
SCNSER.MAC	25-JAN-91 22:40		DEVICE DATA BLOCK

   569				SUBTTL DEVICE DATA BLOCK
   570
   571				;TTY DDB INTERRUPT-TO-CHANNEL BYTE POINTERS
   572
   573			000000	ZZWORD==0
   574		777777	777777	ZZBIT==-1
   575				DEFINE ZZZ(N) = <IFG <ZZBIT+6>-^D35,<ZZBIT==-1
   576				ZZWORD==ZZWORD+1>
   577				ZZBIT==ZZBIT+6
   578				DDPT'N:	POINT 6,DDBTRP+ZZWORD(F),ZZBIT>
   579
   580	000225'			DDPTAB:
   581
   582	000225'	360604	000014	ZZZ(SC)	;ESCAPE/^C RECEIVED
   583	000226'	300604	000014	ZZZ(CH)	;CHARACTER RECEIVED
   584	000227'	220604	000014	ZZZ(LN)	;BREAK RECEIVED
   585	000230'	140604	000014	ZZZ(TI)	;I/O WAIT
   586	000231'	060604	000014	ZZZ(TS)	;I/O WAIT SATISFIED
   587	000232'	000604	000014	ZZZ(LC)	;LOST CHARACTERS
   588	000233'	360604	000015	ZZZ(OB)	;ORANGE BALL RECEIVED
   589	000234'	300604	000015	ZZZ(ZP)	;ZAPPER RECEIVED
   590	000235'	220604	000015	ZZZ(PS)	;PORT STATUS MESSAGE RECEIVED   (See comment at ACPSM)
   591	000236'	140604	000015	ZZZ(YB)	;YELLOW BALL RECEIVED
   592	000237'	060604	000015	ZZZ(CG)	;CHARACTER GOBBLER RECEIVED
   593	000240'	000604	000015	ZZZ(TC)	;TERMINAL CHARACTERISTIC CHANGED AT OTHER END OF PTY
   594
   595			000014	TRPLEN==.-DDPTAB
   596
   597				;TRAP NUMBER INTERNALS
   598
   599			000000	TTNESC==:DDPTSC-DDPTAB
   600			000001	TTNCHR==:DDPTCH-DDPTAB
   601			000002	TTNLIN==:DDPTLN-DDPTAB
   602			000006	TTNYLB==:DDPTOB-DDPTAB
   603
   604				;OTHER DDB BYTE POINTERS
   605
   606	000241'	430104	000012	DDPBBP:	POINT 1,DDBDCH(F),0	;BACKSPACE AS PUNCTUATION
   607	000242'	420104	000012	DDPTBK:	POINT 1,DDBDCH(F),1	;TABS ARE BREAKS
   608	000243'	410104	000012	DDPNTB:	POINT 1,DDBDCH(F),2	;NO SPECIAL TAB ACTION
   609	000244'	001104	000012	DDPIMB: POINT 9,DDBDCH(F),35	;IMAGE MODE BREAK CHARACTER
   610	000245'	000404	000002	DDPMOD: POINT 4,DEVIOS(F),35	;DATA MODE
   611	000246'	400104	000012	DDPCOM: POINT 1,DDBDCH(F),3	;SAVED STATE OF LDLCOM
   612	000247'	360104	000004	DDPNZP:	POINT 1,DEVMOD(F),5	;NO-ZAP BIT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 11
SCNSER.MAC	25-JAN-91 22:40		TTY DDB. ONCE CREATES ONE OF THESE PER JOB FOR TTYTAB TO POINT TO.

   613				SUBTTL	TTY DDB. ONCE CREATES ONE OF THESE PER JOB FOR TTYTAB TO POINT TO.
   614
   615	000250'			TTYLST:		;LABEL FOR FIRST TTY DDB IN CHAIN
   616	000000			SCNDDB::PHASE	0	;GLOBAL LABEL
   617	000250'	646471	200000		SIXBIT /TTY0/		;DEVNAM (PHYSICAL NAME)
   618	000251'	000000	000021		XWD 0,STTYBF+1		;DEVCHR. SIZE OF USER BUFFER
   619	000252'	000000	000000		0			;DEVIOS
   620	000253'	000000	006331'		XWD 0,SCNDSP		;DEVSER
   621	000254'	000013	014407		XWD DVTTY+DVIN+DVOUT,<<1_B>+<1_A>+<1_AL>+<1_I>+<1_IB>+<1_XA>>
   622								;DEVMOD
   623	000255'	000000	000000		0			;DEVLOG (LOGICAL NAME)
   624	000256'	000000	000000		0			;DEVBUF
   625	000257'	000000	000000		0			;DEVIAD
   626	000260'	000000	000000		0			;DEVOAD
   627	000261'	200000	000000	DEVCLS:! XWD 200000,0		;CLASS
   628	000262'	000000	000000	DDBDCH:! 0	;PROCESS-RELATED DEVICE CHARACTERISTICS NOT IN DEVIOS
   629			400000		DCLBBP==400000	;0	BACKSPACE IS PUNCTATION (DDPBBP)
   630			200000		DCLTBK==200000	;1	TABS ARE BREAKS (DDPTBK)
   631			100000		DCLNTB==100000	;2	DON'T ECHO HT/VT/FF (DDPNTB)
   632			040000		DCLCOM==040000	;3	SAVED STATE OF LDLCOM (DDPCOM)
   633							;27-35	IMAGE MODE BREAK CHARACTER (DDPIMB)
   634	000013			DDBBLK::!			;(LH) BACK LINK (PREVIOUS TTY DDB)
   635	000263'	000000	000000	DDBLDB::!0			;(RH) LDB ADDR
   636	000014			DDBTRP:! BLOCK <TRPLEN+5>/6	;INTERRUPT-TO-CHANNEL ASSIGNMENTS
   637
   638	000266'			DEPHASE
   639
   640			000016	SCNDDS==:.-SCNDDB
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 12
SCNSER.MAC	25-JAN-91 22:40		TTY FILE STATUS BITS

   641				SUBTTL	TTY FILE STATUS BITS
   642
   643				;LEFT HALF
   644
   645			400000	TTYOUW==:400000	;0	TI MEANS OUTPUT WAIT, NOT INPUT WAIT
   646			200000	TWTSPC== 200000	;1	TI BECAUSE SYSTEM OUT OF BUFFERLETS
   647			100000	IOSBKA== 100000	;2	BREAK ON ALL CHARACTERS
   648			040000	TINFIO== 040000	;3	CAUSE AN OUTPUT-DONE INTERRUPT WHEN OUTPUT DONE
   649			020000	TIOUSE== 020000	;4	UUO IN PROGRESS, DON'T ZAP DDB
   650
   651				;RIGHT HALF
   652
   653			001000	BK2IOS== 001000	;26	BREAK ON PUNCTUATION
   654			000400	DLRSUP== 000400	;27	NO ESCAPE ECHO
   655			000200	NOECHO== 000200	;28	NO ECHO
   656			000100	FCS==    000100	;29	FULL CHARACTER SET
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 13
SCNSER.MAC	25-JAN-91 22:40		HOST TO BASE AND BASE TO HOST MESSAGE TYPES

   657				SUBTTL	HOST TO BASE AND BASE TO HOST MESSAGE TYPES
   658
   659				;Buffer ring message formats
   660
   661				;Each logical record in the buffer ring is some number of 8-bit bytes.
   662				;These start on a word boundry, the last 4 bits of each PDP-10 word are
   663				;ignored, and records currently do not wrap around in the buffer.
   664
   665				;The first byte of each logical record is the message type, the next 8 bits
   666				;is the port number.  If the high order bit is set in the message type, then
   667				;the remaining 7 bits in the first byte specify the number of characters that
   668				;follow.  Otherwise the first byte is a command code.
   669
   670				;BASE HOST    "{"=from host, "}"=to host, "#"=crash, "-"=ignore
   671				;00##00	UNUSED, ERROR
   672				;TYP.00,xxx,xxx,xxx
   673
   674				;01{-01	SYSTEM IS ANSWERED, IGNORED ON INPUT BY KI/KL/F3, CHECKED BY KS
   675			000001	TYPANS==01 ;xxx,xxx,xxx
   676
   677				;02{-01	SYSTEM IS SHUT, IGNORED ON INPUT
   678			000002	TYPSHT==02 ;xxx,xxx,xxx
   679
   680				;03{}03	RESET THE INTERFACE, QUIETLY ZAP ALL CIRCUITS (DR11 IS BAD ON KS)
   681			000003	TYPRES==03 ;DEBUGF,VER,REV      (used to be TYPCRS - sender has crashed)
   682
   683				;04#}04	RESET ACKNOWLEGE, TELL DEBUG STATUS, VERSION NUMBER, REVISION LEVEL
   684			000004	TYPRAK==04 ;DEBUGF,VER,REV      (used to be TYPDIE - recipient should crash)
   685
   686				;05#}05	THE NODE HAS BEEN TAKEN OVER BY A NEW SUPERVISOR
   687			000005	TYPNSP==05 ;000,xxx,xxx
   688
   689				;06#}06	EXTERNALLY INITIATED NEW CIRCUIT.  TREAT NEXT SET OF DATA BYTES SPECIAL
   690			000006	TYPLOG==06 ;PORT,xxx,xxx
   691
   692				;07#}07	SUPERVISOR RESPONSE TO ESTABLISHING AN AUX CIRCUIT
   693			000007	TYPAUX==07 ;NEWPORT,KEY,xxx
   694
   695				;08{}10	BACKPRESSURE ON
   696			000010	TYPNOP==10 ;PORT,xxx,xxx
   697
   698				;09{}11	BACKPRESSURE OFF
   699			000011	TYPOUP==11 ;PORT,xxx,xxx
   700
   701				;0A{}12	CHARACTER GOBBLER, IGNORED ON INPUT
   702			000012	TYPGOB==12 ;PORT,xxx,xxx
   703
   704				;0B{}13	CIRCUIT ZAPPER, RECIPIENT MUST ECHO ZAPPER ON SAME PORT
   705			000013	TYPZAP==13 ;PORT,xxx,xxx
   706
   707				;0C{}14	ENTER DEFERED ECHO MODE
   708			000014	TYPEDC==14 ;PORT,xxx,xxx
   709
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 13-2
SCNSER.MAC	25-JAN-91 22:40		HOST TO BASE AND BASE TO HOST MESSAGE TYPES

   710				;0D{}15	LEAVE DEFERRED ECHO MODE
   711			000015	TYPLDC==15 ;PORT,xxx,xxx
   712
   713				;0E{}16	GREEN BALL
   714			000016	TYPGRN==16 ;PORT,xxx,xxx
   715
   716				;0F{}17	RED BALL
   717			000017	TYPRED==17 ;PORT,xxx,xxx
   718
   719				;10{}20	YELLOW BALL
   720			000020	TYPYEL==20 ;PORT,xxx,xxx
   721
   722				;11{}21	ORANGE BALL
   723			000021	TYPORG==21 ;PORT,xxx,xxx
   724
   725				;12{-22	HANG CHARACTER (DROP DTR, DON'T ZAP CIRCUIT, IGNORED ON INPUT)
   726			000022	TYPHNG==22 ;PORT,xxx,xxx
   727
   728				;13{-23	ENTER 2741 TRANSPARENT MODE (IGNORED ON INPUT)
   729			000023	TYPETM==23 ;PORT,xxx,xxx
   730
   731				;14{-24	LEAVE 2741 TRANSPARENT MODE (IGNORED ON INPUT)
   732			000024	TYPLTM==24 ;PORT,xxx,xxx
   733
   734				;15#}25	LOST BALL.  BLACK BALL IF DATA=FF, GRAY BALL IF DATA=00
   735			000025	TYPLOS==25 ;PORT,DATA,xxx
   736
   737				;16{#26	REQUEST NEW PORT NUMBER FOR BUILDING AUX CIRCUIT (KEY RETURNED BY 07)
   738			000026	TYPSUP==26 ;KEY,000,xxx
   739
   740				;17#}27	SUPERVISOR RESPONSE, 3RD BYTE IS ERROR CODE
   741			000027	TYPSUR==27 ;KEY,ERRCODE,xxx
   742
   743				;18{#30	SUPERVISOR LOGIN CHARACTER IN 3RD BYTE
   744			000030	TYPAXC==30 ;KEY,CHAR,xxx
   745
   746				;19{#31	TEST PATTERN PROBE (32 BITS OF TEST DATA)
   747			000031	TYPTSP==31 ;PORT,DATA1,DATA2,  DATA3,DATA4,xxx,xxx
   748
   749				;1A#}32	TEST PATTERN RESPONSE
   750			000032	TYPTSR==32 ;PORT,DATA1,DATA2,  DATA3,DATA4,xxx,xxx
   751
   752				;1B{#33	HOST SAD, 32 UNHAPPY BITS
   753			000033	TYPSAD==33 ;000,DATA1,DATA2,  DATA3,DATA4
   754
   755				;1C{#34	ECHO ON
   756			000034	TYPECN==34 ;PORT,xxx,xxx
   757
   758				;1D{#35	ECHO OFF
   759			000035	TYPECF==35 ;PORT,xxx,xxx
   760
   761				;1E{#36	SET TERMINAL CHARACTERISTICS, NUMBER AND VALUE
   762			000036	TYPTCS==36 ;PORT,TCHNUM,VALUE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 13-3
SCNSER.MAC	25-JAN-91 22:40		HOST TO BASE AND BASE TO HOST MESSAGE TYPES

   763
   764				;1F{#37	TERMINAL CHARACTERISTICS PROBE, FOR A PARTICULAR TCHNUM
   765			000037	TYPTCP==37 ;PORT,TCHNUM,xxx
   766
   767				;20#}40	TERMINAL CHARACTERISTICS RESPONSE, ANSWER TO PROBE
   768			000040	TYPTCR==40 ;PORT,TCHNUM,VALUE
   769
   770				;21{#41	TELL SUPERVISOR NUMBER OF PORTS AND HOST NUMBER
   771			000041	TYPHSI==41 ;MAXPORT,HOST#,xxx
   772
   773				;22{#42	REQUEST FOR SUPERVISOR CLOCK INFO (BASE IGNORES THIS)
   774			000042	TYPCLP==42 ;xxx,xxx,xxx
   775
   776				;23#}43	RESPONSE WITH SUPERVISOR CLOCK INFO IN SECONDS SINCE 1-JAN-1974
   777			000043	TYPCLR==43 ;000,DATA1,DATA2,  DATA3,DATA4,xxx,xxx
   778
   779				;24{#44	INITIATE BLOCK OUTPUT
   780			000044	TYPBKO==44 ;PORT,COUNT1,COUNT2,  ADDR1,ADDR2,ADDR3,xxxx
   781
   782				;25#}45	BLOCK OUTPUT COMPLETE
   783			000045	TYPBOC==45 ;PORT,xxx,xxx
   784
   785				;26{#46	INITIATE BLOCK INPUT
   786			000046	TYPBIN==46 ;PORT,COUNT1,COUNT2,  ADDR1,ADDR2,ADDR3,xxxx
   787
   788				;27#}47	BLOCK INPUT TERMINATED - OUT OF BUFFER
   789			000047	TYPINB==47 ;PORT,COUNT1,COUNT2
   790
   791				;28#}50	BLOCK INPUT TERMINATED - END OF TRANSMISSION
   792			000050	TYPINE==50 ;PORT,COUNT1,COUNT2
   793
   794				;29#}51	BLOCK INPUT TERMINATED - TIMEOUT BY BASE
   795			000051	TYPINT==51 ;PORT,COUNT1,COUNT2
   796
   797				;2A{#52	REQUEST BLOCK INPUT TERMINATION
   798			000052	TYPIRQ==52 ;PORT,xxx,xxx
   799
   800				;2B#}53	BLOCK INPUT TERMINATED - BY HOST REQUEST
   801			000053	TYPIHR==53 ;PORT,COUNT1,COUNT2
   802
   803				;2C{#54	REQUEST BLOCK OUTPUT TERMINATION
   804			000054	TYPORQ==54 ;PORT,xxx,xxx
   805
   806				;2D#}55	BLOCK OUTPUT TERMINATED - BY HOST REQUEST
   807			000055	TYPOHR==55 ;PORT,xxx,xxx
   808
   809				;2E{}56	NEGOTIATE FOR NUMBER OF BLOCK I/O PORTS
   810			000056	TYPNEG==56 ;PORT,DATA,xxx
   811
   812				;2F#}57	BREAK RECIEVED
   813			000057	TYPBRK==57 ;PORT,xxx,xxx
   814
   815				;30#}60	PORT STATUS RECEIVED  (Obsolete, not in EBUS, see comment at ACPSM)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 13-4
SCNSER.MAC	25-JAN-91 22:40		HOST TO BASE AND BASE TO HOST MESSAGE TYPES

   816			000060	TYPPSR==60 ;PORT,DATA,xxx
   817
   818				;31{-61	ENTER ALTERNATE DEVICE MODE (TURN ON PRINTER), IGNORED ON INPUT
   819			000061	TYPEAD==61 ;PORT,xxx,xxx
   820
   821				;32{-62	LEAVE ALTERNATE DEVICE MODE (TURN OFF PRINTER), IGNORED ON INPUT
   822			000062	TYPLAD==62 ;PORT,xxx,xxx
   823
   824				;33{#63	SET KEEP-ALIVE-FAILURE TIMER
   825			000063	TYPKAF==63 ;000,DATA1,DATA2
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 14
SCNSER.MAC	25-JAN-91 22:40		Special KS2020 microcode for KMC

   826				SUBTTL	Special KS2020 microcode for KMC
   827
   828				IFKMC<
   829			000011		BYP1==^D9	;RIGHTMOST BIT POSITION OF FIRST BYTE
   830			000021		BYP2==^D17	;      SECOND BYTE OF A BUFFER RING WORD
   831			000033		BYP3==^D27	;      THIRD BYTE
   832			000043		BYP4==^D35	;      LAST BYTE POSITION IN A BUF RING WORD
   833					OPDEF	UUILDB	[101000,,0]	;KMC ILDB
   834					OPDEF	UUIDPB	[102000,,0]	;KMC IDPB
   835					OPDEF	EXTEND	[123000,,0]	;EXTENDED INSTRUCTION OPCODE
   836					OPDEF	MOVSLJ	[016000,,0]	;MOVE STRING LEFT JUSTIFIED
   837					DEFINE	TYPI(TYPE)		;FOR LOADING TYPES WITH A
   838					<TYPE_^D8>			;	MOVSI INSTR
   839					>;END IFKMC
   840				IFNKMC<
   841					BYP1==^D7	;RIGHTMOST BIT POSITION OF FIRST BYTE
   842					BYP2==^D15	;      SECOND BYTE OF A BUFFER RING WORD
   843					BYP3==^D23	;      THIRD BYTE
   844					BYP4==^D31	;      LAST BYTE POSITION IN A BUF RING WORD
   845					OPDEF	UUILDB	[ILDB 0]	;NORMAL ILDB
   846					OPDEF	UUIDPB	[IDPB 0]	;NORMAL IDPB
   847					DEFINE	TYPI(TYPE)		;FOR LOADING TYPES WITH A
   848					<TYPE_^D10>			;	MOVSI INSTR
   849					>;END IFNKMC
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 15
SCNSER.MAC	25-JAN-91 22:40		BUFFER RING BYTE POINTERS

   850				SUBTTL	BUFFER RING BYTE POINTERS
   851
   852	000266'	321017	000000*	INPTYP:	POINT 8,IRING(P4),BYP1	;TYPE
   853	000267'	221017	000266*	INPLIN:	POINT 8,IRING(P4),BYP2	;LINE NUMBER
   854	000270'	101017	000267*	INPCHR:	POINT 8,IRING(P4),BYP3	;CHARACTER
   855	000271'	001017	000270*	INPCH2:	POINT 8,IRING(P4),BYP4	;SECOND DATA CHARACTER
   856	000272'	222017	000271*	INPDL1:	POINT 16,IRING(P4),BYP2	;FIRST TWO CHRS
   857	000273'	002017	000272*	INPDL2:	POINT 16,IRING(P4),BYP4	;SECOND TWO CHRS
   858
   859				;POINTER FOR PUTTING THINGS IN THE OUTPUT RING
   860
   861	000274'	321017	000000*	OUPTYP:	POINT 8,ORING(P4),BYP1	;TYPE
   862	000275'	221017	000274*	OUPLIN:	POINT 8,ORING(P4),BYP2	;PORT NUMBER
   863
   864				;POINTERS FOR ASSEMBLING FULL WORDS FOR OUTPUT (IN P3)
   865
   866	000276'	221000	000016	WRPLIN:	POINT 8,P3,BYP2		;PORT NUMBER (TYPE is set via TYPI macro)
   867	000277'	101000	000016	WRPCHR:	POINT 8,P3,BYP3		;DATA CHARACTER
   868	000300'	001000	000016	WRPCH2:	POINT 8,P3,BYP4		;SECOND DATA CHARACTER
   869	000301'	002000	000016	WRP3N4:	POINT 16,P3,BYP4	;Bytes 3 and 4
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 16
SCNSER.MAC	25-JAN-91 22:40		CHARACTER TABLES

   870				SUBTTL CHARACTER TABLES
   871
   872				;HERE IS THE CHARACTER TABLE. IT INCLUDES A CHARACTER MODE FOR
   873				;EACH OF INPUT, OUTPUT, ECHO, AND READ (BY PROGRAM). IT ALSO
   874				;INCLUDES A SPECIAL ACTION CODE FOR EACH OF THESE.
   875
   876				DEFINE CHRATR (INP,OUT,RED,ECH,SPAI,SPAO,SPAR,SPAE)
   877					<BYTE (2) INP,OUT (3) SPAO,RED,ECH,SPAR (5) SPAI (4) SPAE>
   878
   879	000302'	420200	000016	CHPINP:	POINT 2,P3,1	;POINTER TO THE INPUT FIELD
   880	000303'	400200	000016	CHPOUT:	POINT 2,P3,3	;POINTER TO THE OUTPUT FIELD
   881	000304'	350300	000016	CHPSPO:	POINT 3,P3,6	;POINTER TO THE OUTPUT SPECIAL ACTION FIELD
   882	000305'	320300	000016	CHPRED:	POINT 3,P3,9	;POINTER TO THE READ FIELD
   883	000306'	270300	000016	CHPECH:	POINT 3,P3,12	;POINTER TO THE ECHO FIELD
   884	000307'	240300	000016	CHPSPR:	POINT 3,P3,15	;POINTER TO THE READ SPECIAL ACTION FIELD
   885	000310'	170500	000016	CHPSPI:	POINT 5,P3,20	;POINTER TO THE INPUT SPECIAL ACTION FIELD
   886	000311'	130400	000016	CHPSPE:	POINT 4,P3,24	;POINTER TO THE ECHO SPECIAL ACTION FIELD
   887
   888				SALL
   889	000312'			CHRTAB:
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 17
SCNSER.MAC	25-JAN-91 22:40		CONTROL CHARACTERS

   890				SUBTTL	CONTROL CHARACTERS
   891
   892	000312'	101100	000000	CHRATR 0,2,2,2,0		;NULL
   893	000313'	101101	300000	CHRATR 0,2,2,2,13		;^A
   894	000314'	501100	000000	CHRATR 2,2,2,2			;^B
   895	000315'	100000	100000	CHRATR 0,2,0,0,1,0,0,0		;^C
   896				REPEAT 3,<
   897				CHRATR 2,2,2,2>			;^D,^E,^F
   898	000316'	501100	000000
   899	000317'	501100	000000
   900	000320'	501100	000000
   901	000321'	501140	000000	CHRATR 2,2,2,3			;^G
   902	000322'	020031	744000	CHRATR 0,0,0,0,17,4,6,11	;BACKSPACE
   903	000323'	004024	614000	CHRATR 0,0,0,0,6,1,5,3		;^I
   904	000324'	501140	000000	CHRATR 2,2,2,3			;LINE FEED
   905	000325'	411000	024000	CHRATR 2,0,2,0,0,2,0,5		;VERTICAL TAB
   906	000326'	415000	030000	CHRATR 2,0,2,0,0,3,0,6		;FORM FEED
   907	000327'	000400	204000	CHRATR 0,0,1,0,2,0,0,1		;RETURN
   908	000330'	501100	000000	CHRATR 2,2,2,2			;^N
   909	000331'	101100	300000	CHRATR 0,2,2,2,3		;^O
   910	000332'	501100	000000	CHRATR 2,2,2,2			;^P
   911	000333'	101100	400000	CHRATR 0,2,2,2,4		;^Q
   912				REPEAT 2,<
   913				CHRATR 2,2,2,2>			;^R,^S
   914	000334'	501100	000000
   915	000335'	501100	000000
   916	000336'	101102	000000	CHRATR 0,2,2,2,20		;^T
   917	000337'	101000	510000	CHRATR 0,2,2,0,5,0,0,2		;^U
   918				REPEAT 4,<
   919				CHRATR 2,2,2,2>			;^V,^W,^X,^Y
   920	000340'	501100	000000
   921	000341'	501100	000000
   922	000342'	501100	000000
   923	000343'	501100	000000
   924	000344'	500014	034000	CHRATR 2,2,0,0,0,0,3,7		;^Z
   925	000345'	100004	720000	CHRATR 0,2,0,0,7,0,1,4		;ESCAPE (33)
   926	000346'	101101	600000	CHRATR 0,2,2,2,16		;^\
   927	000347'	501100	000000	CHRATR 2,2,2,2			;^]
   928	000350'	101101	000000	CHRATR 0,2,2,2,10		;^^
   929	000351'	100111	100000	CHRATR 0,2,0,2,11,0,2,0		;^_
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 18
SCNSER.MAC	25-JAN-91 22:40		NUMBERS AND PUNCTUATION

   930				SUBTTL	NUMBERS AND PUNCTUATION
   931
   932				REPEAT 20,<
   933				CHRATR 3,1,3,4>			;PUNCTUATION
   934	000352'	641600	000000
   935	000353'	641600	000000
   936	000354'	641600	000000
   937	000355'	641600	000000
   938	000356'	641600	000000
   939	000357'	641600	000000
   940	000360'	641600	000000
   941	000361'	641600	000000
   942	000362'	641600	000000
   943	000363'	641600	000000
   944	000364'	641600	000000
   945	000365'	641600	000000
   946	000366'	641600	000000
   947	000367'	641600	000000
   948	000370'	641600	000000
   949	000371'	641600	000000
   950				REPEAT 12,<
   951				CHRATR 1,1,1,1>			;0-9
   952	000372'	240440	000000
   953	000373'	240440	000000
   954	000374'	240440	000000
   955	000375'	240440	000000
   956	000376'	240440	000000
   957	000377'	240440	000000
   958	000400'	240440	000000
   959	000401'	240440	000000
   960	000402'	240440	000000
   961	000403'	240440	000000
   962				REPEAT 7,<
   963				CHRATR 3,1,3,4>			;PUNCTUATION
   964	000404'	641600	000000
   965	000405'	641600	000000
   966	000406'	641600	000000
   967	000407'	641600	000000
   968	000410'	641600	000000
   969	000411'	641600	000000
   970	000412'	641600	000000
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 19
SCNSER.MAC	25-JAN-91 22:40		UPPER CASE

   971				SUBTTL	UPPER CASE
   972
   973				REPEAT 32,<
   974				CHRATR 1,3,1,1>			;A-Z
   975	000413'	340440	000000
   976	000414'	340440	000000
   977	000415'	340440	000000
   978	000416'	340440	000000
   979	000417'	340440	000000
   980	000420'	340440	000000
   981	000421'	340440	000000
   982	000422'	340440	000000
   983	000423'	340440	000000
   984	000424'	340440	000000
   985	000425'	340440	000000
   986	000426'	340440	000000
   987	000427'	340440	000000
   988	000430'	340440	000000
   989	000431'	340440	000000
   990	000432'	340440	000000
   991	000433'	340440	000000
   992	000434'	340440	000000
   993	000435'	340440	000000
   994	000436'	340440	000000
   995	000437'	340440	000000
   996	000440'	340440	000000
   997	000441'	340440	000000
   998	000442'	340440	000000
   999	000443'	340440	000000
  1000	000444'	340440	000000
  1001				REPEAT 4,<
  1002				CHRATR 3,1,3,4>			;PUNCTUATION
  1003	000445'	641600	000000
  1004	000446'	641600	000000
  1005	000447'	641600	000000
  1006	000450'	641600	000000
  1007	000451'	041601	500000	CHRATR 0,1,3,4,15		;_ (FOR TYMEX2 MODE)
  1008	000452'	641600	000000	CHRATR 3,1,3,4			;^
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 20
SCNSER.MAC	25-JAN-91 22:40		LOWER CASE

  1009				SUBTTL	LOWER CASE
  1010
  1011				REPEAT 32,<
  1012				CHRATR 1,1,4,1>			;a-z
  1013	000453'	242040	000000
  1014	000454'	242040	000000
  1015	000455'	242040	000000
  1016	000456'	242040	000000
  1017	000457'	242040	000000
  1018	000460'	242040	000000
  1019	000461'	242040	000000
  1020	000462'	242040	000000
  1021	000463'	242040	000000
  1022	000464'	242040	000000
  1023	000465'	242040	000000
  1024	000466'	242040	000000
  1025	000467'	242040	000000
  1026	000470'	242040	000000
  1027	000471'	242040	000000
  1028	000472'	242040	000000
  1029	000473'	242040	000000
  1030	000474'	242040	000000
  1031	000475'	242040	000000
  1032	000476'	242040	000000
  1033	000477'	242040	000000
  1034	000500'	242040	000000
  1035	000501'	242040	000000
  1036	000502'	242040	000000
  1037	000503'	242040	000000
  1038	000504'	242040	000000
  1039				REPEAT 2,<
  1040				CHRATR 3,1,3,4>			;PUNCTUATION
  1041	000505'	641600	000000
  1042	000506'	641600	000000
  1043	000507'	040021	440000	CHRATR 0,1,0,0,14,0,4,10	;ALTMODE (175) OR }
  1044	000510'	040021	440000	CHRATR 0,1,0,0,14,0,4,10	;ALTMODE (176) OR ~
  1045	000511'	101101	200000	CHRATR 0,2,2,2,12		;RUBOUT (177)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 21
SCNSER.MAC	25-JAN-91 22:40		LOWER CASE

  1046				COMMENT ;
  1047				SUMMARY OF MEANING OF FIELDS
  1048
  1049				INPUT
  1050					0-SPECIAL ACTION
  1051					1-NORMAL CHARACTER
  1052					2-BREAK CHARACTER
  1053					3-CLASS 2 BREAK CHARACTER
  1054
  1055				OUTPUT
  1056					0-SPECIAL ACTION
  1057					1-OUTPUT AND COUNT FOR FREE RETURN
  1058					2-OUTPUT BUT DO NOT COUNT
  1059					3-UPPER CASE CHARACTER
  1060
  1061				REMOTE ECHO
  1062					0-SPECIAL ACTION
  1063					1-COUNT FOR FREE RETURN
  1064					2-DO NOT COUNT FOR FREE RETURN
  1065					3-SAME AS 2
  1066					4-SAME AS 1
  1067
  1068				DEFERED ECHO
  1069					0-SPECIAL ACTION
  1070					1-PRINT CHARACTER AND COUNT FOR FREE RETURN
  1071					2-BREAK CHARACTER, DO NOT PRINT, DO NOT COUNT
  1072					3-BREAK CHARACTER, PRINT, DO NOT COUNT
  1073					4-CLASS 2 BREAK CHARACTER, PRINT AND COUNT
  1074					5-IMAGE CHARACTER
  1075					6-BREAK CHARACTER, PRINT AND COUNT
  1076
  1077				READ
  1078					0-SPECIAL ACTION
  1079					1-NORMAL CHARACTER
  1080					2-BREAK CHARACTER
  1081					3-CLASS 2 BREAK CHARACTER
  1082					4-LOWER CASE CHARACTER
  1083				;
  1084
  1085				;DEFINE STOP CHARACTERS (ESCAPES) FOR VARIOUS MODES
  1086
  1087			000003	STOP10==3	;^C
  1088			000037	STOP9==37	;^_
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 22
SCNSER.MAC	25-JAN-91 22:40		Channel 1 interrupt processing

  1089				SUBTTL	Channel 1 interrupt processing
  1090
  1091	000512'	633751	506262	KEY10:	633751506262		;Magic value that TYMNET BASE wants to see
  1092
  1093				;UPDKEY - Update the KEY 60 times per second, at channel 1 level
  1094				;Called by JSP T1,UPDKEY    (T2 is scratch).
  1095
  1096	000513'	200340	000512'	UPDKEY::MOVE	T2,KEY10		;Set key for TYMNET
  1097	000514'	250340	000000*	KEYSET::EXCH	T2,KEY620##		;(JFCL if base is not being used)
  1098	000515'	336000	000007		SKIPN	T2			;If it was zero,
  1099	000516'	402000	000000*		 SETZM	KEYTIM##		; reset KEY620 timer
  1100	000517'	332000	000007		SKIPE	T2			;If zero,
  1101	000520'	316340	000512'		CAMN	T2,KEY10		; or the value we set,
  1102	000521'	334000	000000		 SKIPA				;OK
  1103	000522'	202340	017207'		  MOVEM	T2,BADKEY		;Remember bad key for later
  1104	000523'	200340	000000*		MOVE	T2,UPTIME##		;Get current system uptime
  1105	000524'	332000	000000*		SKIPE	DINITF##		;Is ONCE initializing the disks?
  1106	000525'	202340	000000*		 MOVEM	T2,THSTIM##		;Yes, make THSTIM look current
  1107	000526'	274340	000525*		SUB	T2,THSTIM##		;Check on how long since SCNTIC ran
  1108	000527'	311340	000000*		CAML	T2,JFYMIN##		;More than one minute?
  1109	000530'	256000	000000*	KAF1::	 STOPCD (,XCT,S..KAF)
  1110						;Keep alive failure
  1111	000531'	254006	000000		JRST	(T1)			;Return to PICON
  1112
  1113				;CHKBAS - Check if the nonzero value in 30 came from the base.
  1114				;Called by JSP T1,CHKBAS whenever CRSHWD is nonzero.
  1115				;T2 is scratch, stack is not set up.
  1116				;Error return of PDP-10 should crash, skip return to continue.
  1117
  1118	000532'	135340	017217'	CHKBAS::LDB	T2,[POINT 16,CRSHWD,15]	;Check if first 16 bits
  1119	000533'	312340	000000*		CAME	T2,ORP620		; match the base's ORING pointer
  1120	000534'	316340	017211'		CAMN	T2,ORPOLD
  1121	000535'	334000	000000		 SKIPA				;OK
  1122	000536'	254006	000000		  JRST	(T1)			;No match, don't blame it on base
  1123	000537'	135340	017220'		LDB	T2,[POINT 16,CRSHWD,31]	;Check if second 16 bits
  1124	000540'	312340	000000*		CAME	T2,IRP620		; match the base's IRING pointer
  1125	000541'	316340	017210'		CAMN	T2,IRPOLD
  1126	000542'	334000	000000		 SKIPA
  1127	000543'	254006	000000		  JRST	(T1)			;No match, don't blame it on base
  1128	000544'	476000	000000*		SETOM	BASDWN##		;Base problems.  Mark it as down
  1129	000545'	201340	035230		MOVEI	T2,^D15000		;Delay for about 1/60th of a second
  1130	000546'	367340	000546'		SOJG	T2,.			; for base to write into KEY620
  1131	000547'	200340	000514*		MOVE	T2,KEY620##		;Get the key
  1132	000550'	316340	000512'		CAMN	T2,KEY10		;If we overwrote it,
  1133	000551'	200340	017207'		 MOVE	T2,BADKEY		; get previous value
  1134	000552'	202340	000547*		MOVEM	T2,KEY620##		;Reset it if necessary
  1135	000553'	242340	777754		LSH	T2,^D<16-36>		;Get 16 bits of KEY620
  1136	000554'	202040	000564'		MOVEM	P,SCN1PD		;Need a stack for STOPCD
  1137	000555'	201040	000564'		MOVEI	P,SCN1PD
  1138	000556'	306340	000004		CAIN	T2,04			;Did base complain about a bad message?
  1139	000557'	256000	017221'		 STOPCD (.,STOP,BASE04,PRTCRS,<Bad message type from host>)
  1140	000560'	256000	017225'		 STOPCD (.+1,INFO,BASE,PRTCRS,<BASE has crashed - bad KEY620>)
  1141	000561'	200040	000564'		MOVE	P,SCN1PD		;Restore AC
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 22-2
SCNSER.MAC	25-JAN-91 22:40		Channel 1 interrupt processing

  1142	000562'	402000	000000*		SETZM	CRSHWD##		;Clear out location 30 to keep system up
  1143	000563'	254006	000001		JRST	1(T1)			;Skip return back to PICON
  1144
  1145	000564'			SCN1PD:	BLOCK	2			;Dummy stack for PUSHJ P,DIE
  1146
  1147				;Here from PRTIRP to output SAV30, ORP620, IRP620, and KEY620
  1148
  1149	000566'	260040	000000*	PRTCRS:	PUSHJ	P,INLMES##
  1150	000567'	476452	033144		 ASCIZ /ORP620: /
	000570'	301644	000000
  1151	000571'	200300	000533*		MOVE	T1,ORP620
  1152	000572'	260040	000000*		PUSHJ	P,PRTOCT##
  1153	000573'	260040	000566*		PUSHJ	P,INLMES##
  1154	000574'	201011	151240		 ASCIZ /  IRP620: /
	000575'	331446	035100
	000576'	000000	000000
  1155	000577'	200300	000540*		MOVE	T1,IRP620
  1156	000600'	260040	000572*		PUSHJ	P,PRTOCT##
  1157	000601'	260040	000573*		PUSHJ	P,INLMES##		;Called from STOPCD(BASE),STOPCD(BASE04)
  1158	000602'	201004	051602		 ASCIZ /   SAV30: /
	000603'	531466	035100
	000604'	000000	000000
  1159	000605'	200300	000000*		MOVE	T1,SAV30##		;Saved contents of CRSHWD
  1160	000606'	260040	000000*		PUSHJ	P,HWDPNT##
  1161	000607'	260040	000601*		PUSHJ	P,INLMES##
  1162	000610'	201724	000000		 ASCIZ / = /
  1163	000611'	135300	017231'		LDB	T1,[POINT 16,SAV30,15]	; Get Base ORING pointer field
  1164	000612'	260040	000600*		PUSHJ	P,PRTOCT##
  1165	000613'	260040	000000*		PUSHJ	P,PRCOM##		;Comma
  1166	000614'	135300	017232'		LDB	T1,[POINT 16,SAV30,31]	; Get Base IRING pointer field
  1167	000615'	260040	000612*		PUSHJ	P,PRTOCT##
  1168	000616'	260040	000607*	PRTKEY::PUSHJ	P,INLMES##		;Here from STOPCD(CRASH)
  1169	000617'	201004	045712		 ASCIZ /   Key: /
	000620'	745644	000000
  1170	000621'	200300	000552*		MOVE	T1,KEY620		;Get Key value
  1171	000622'	316300	000512'		CAMN	T1,KEY10
  1172					 JRST	[JSP T1,CONMES##
  1173						 ASCIZ /OK
  1174	000623'	254000	017233'	/]
  1175	000624'	242300	777754		LSH	T1,^D<16-36>		;Get high order 16 bits and
  1176	000625'	260040	000615*		PUSHJ	P,PRTOCT##		; print as an octal number.
  1177	000626'	324740	000000*		PJRST	CRLF##			;Finish the line.
  1178
  1179				COMMENT ~	Values stored in KEY620 when the Varian base goes down
  1180				* 00="Normal - host going down - key not refreshed.",
  1181				  01="Host crashing due to base crash.",
  1182				  02="MIC error or MIC reject tring to read key.",
  1183				* 03="Read bad key from host.",
  1184				* 04="Bad data type or port number from host.",  HOST MUST CRASH
  1185				  05="Illogical data type from host.",
  1186				  06="MIC busy trying to read host (IN10).",
  1187				  07="Input ring processing time-out.",
  1188				* 10="MIC time-out error (sen 337).",
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 22-3
SCNSER.MAC	25-JAN-91 22:40		Channel 1 interrupt processing

  1189				* 11="Parity error from MIC (sen 237).",
  1190				* 12="MIC busy for 232 cycles in addr portion of 'look'.",
  1191				  13="Host told base to crash...this is a no-no!!",
  1192				  14="MIC busy (look) from prior operation in 'look'.",
  1193				  15="Overran block i/o table.",
  1194				  16="Terminate block input req. is invalid.",
  1195				  17="Base crash...power failure.",
  1196				  20="Base crash...manual restart.",
  1197				  21="Base crash....",
  1198				**22="Base crash...GCI crash.", BASE CRASHES ITSELF
  1199				  23="Base crash...WCD crash.",
  1200				**24="Base crash...WCI crash.", BASE CRASHES ITSELF
  1201				* 25="Base crash...GCOL crash.",
  1202				  26="Base crash...speed crash.",
  1203				  27="Base crash...unidentified crash.",
  1204				  30="Base crash....",
  1205				  31="Base crash...WWI crash.",
  1206				  32="Base crash...empty crash.",
  1207				  33="Base crash...parity error.",
  1208				  34="Base crash...bad 201 interrupt.",
  1209				  35="Base crash....",
  1210				  36="Base crash....",
  1211				  37="Base crash....";
  1212				**120="Bad ISIS message.", BASE CRASHES ITSELF
  1213				**140="Bad stack usage.", BASE CRASHES ITSELF
  1214				**202="Buss Error.", BASE CRASHES ITSELF
  1215				**203="Address Error", BASE CRASHES ITSELF
  1216				**204="Illegal Instruction.", BASE CRASHES ITSELF
  1217				**354="Engine told 68K to crash.", BASE CRASHES ITSELF
  1218				**355="Split Char Pair.", BASE CRASHES ITSELF
  1219				~  ;End of COMMENT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 23
SCNSER.MAC	25-JAN-91 22:40		INPUT RING DISPATCHER

  1220				SUBTTL INPUT RING DISPATCHER
  1221
  1222				;HERE EVERY TICK FROM CHANNEL 7
  1223
  1224				    ;KEEP TRACK OF MAXIMUM INTER-CALL DELAY
  1225
  1226	000627'	200440	000523*	SCNINT::MOVE	T4,UPTIME	;Check on how long it has been since SCNSER
  1227	000630'	250440	000526*		EXCH	T4,THSTIM##	; last had a chance to run
  1228	000631'	321440	000641'		JUMPL	T4,SCNNT0	;Don't check on the very first tick
  1229	000632'	274440	000630*		SUB	T4,THSTIM##
  1230	000633'	213000	000011		MOVNS	T4
  1231	000634'	313440	000000*		CAMLE	T4,MXTIM##
  1232	000635'	202440	000634*		 MOVEM	T4,MXTIM##	;Save maximum so far
  1233	000636'	350000	000516*		AOS	KEYTIM##	;Increment # of ticks since key was reset
  1234	000637'	350000	000000*		AOS	IRPTIM##	;          # of ticks since last input message
  1235	000640'	350000	000000*		AOS	ORPTIM##	;          # of ticks since last output message
  1236
  1237				    ;CHECK FOR CTY OUTPUT
  1238
  1239	000641'	337000	000126'	SCNNT0:	SKIPG	CTYLDB+LDBTOC	;If there are characters for the CTY
  1240	000642'	335000	014262'		SKIPGE	CTYBLF		; or if someone wants to ding its bell,
  1241	000643'	260040	014264'		 PUSHJ	P,OPRCTY	; go do it
  1242	000644'	260040	000000*		PUSHJ	P,CTYINP##	;Check for input on the CTY
  1243	000645'	255000	000000		  JFCL			;No input (character in T3 if CTYINP skips)
  1244
  1245				    ;CHECK IF RING NEEDS TO BE RESET
  1246
  1247	000646'	336300	000544*		SKIPN	T1,BASDWN##	;Has base crashed or 10 in system restart?
  1248	000647'	254000	000717'		 JRST	SCNTIC		;No, rings are fine
  1249				;BASDWN=-1 means base has crashed or is not responding.
  1250				;BASDWN=+1 means system startup - ask for date/time from the supervisor.
  1251	000650'	337000	000006		SKIPG	T1		;Startup?
  1252	000651'	260040	012772'		 PUSHJ	P,DETALL	;No, detach all jobs when base dies
  1253	000652'	403340	000000*		SETZB	T2,IRPPDP
  1254	000653'	250340	000577*		EXCH	T2,IRP620	;Reset IRING pointers
  1255	000654'	332000	000007		SKIPE	T2
  1256	000655'	202340	017210'		 MOVEM	T2,IRPOLD	;Save old pointer for CHKBAS
  1257	000656'	403340	000000*		SETZB	T2,ORPPDP
  1258	000657'	250340	000571*		EXCH	T2,ORP620	;Reset ORING pointers
  1259	000660'	332000	000007		SKIPE	T2
  1260	000661'	202340	017211'		 MOVEM	T2,ORPOLD	;Save old pointer for CHKBAS
  1261				IFCPU (F3),<
  1262					PUSHJ	P,FNSYNC	;Synchronize with the PDP-11 base
  1263					  POPJ	P,		;Not ready yet, try again next time
  1264				>;END IFCPU F3
  1265	000662'	200740	000656*		MOVE	P4,ORPPDP	;Get current ORING pointer (starts at zero)
  1266	000663'	200700	017235'		MOVE	P3,[<TYPRAK>B<BYP1>+<SCNVER>B<BYP3>+<SCNREL>B<BYP4>]
  1267	000664'	331000	000646*		SKIPL	BASDWN		;Send reset-ack if base died, CLK at startup
  1268	000665'	200700	017236'		 MOVE	P3,[<TYPCLP>B<BYP1>+<SCNVER>B<BYP3>+<SCNREL>B<BYP4>]
  1269	000666'	335000	000000*		SKIPGE	DEBUGF##	;System being debugged?
  1270	000667'	661700	000001		 TLO	P3,(1B<BYP2>)	;Yes, set LSB of 2nd byte
  1271	000670'	202717	000275*		MOVEM	P3,ORING(P4)	;Put first message in ring
  1272	000671'	260040	016501'		PUSHJ	P,ORPLOG	;Put message into ORING log
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 23-2
SCNSER.MAC	25-JAN-91 22:40		INPUT RING DISPATCHER

  1273	000672'	271740	000001		ADDI	P4,1
  1274	000673'	205700	020400		MOVSI	P3,TYPI TYPHSI	;Message type 41
  1275	000674'	201300	000000*		MOVEI	T1,RPORTN##	;Number of real ports
  1276			000100	IFKMC<	LPERDR==<^D16>*4	;ONE OF 64. 32. or 16. LINES PER DR
  1277					;LPERDR must match that defined in the KMC microcode
  1278			013575		MAXDR==RPORTN##/LPERDR	;HIGHEST DR = # OF PORTS/LINES PER DR
  1279	000675'	620300	000003		TRZ	T1,3		;Must have a multiple of 4
  1280	000676'	301300	000100		CAIL	T1,LPERDR	;Determine lines on 1st node
  1281	000677'	201300	000074		 MOVEI	T1,<LPERDR-1>&74;Must be a multiple of 4 .LT. ^D64
  1282				>;END IFKMC
  1283	000700'	137300	000276'		DPB	T1,WRPLIN	;Highest port number we will accept
  1284	000701'	200300	000000*		MOVE	T1,SYSNUM##	;Our host number
  1285	000702'	137300	000277'		DPB	T1,WRPCHR	; in 3rd byte
  1286	000703'	202717	000670*		MOVEM	P3,ORING(P4)
  1287	000704'	260040	016501'		PUSHJ	P,ORPLOG	;Put message into ORING log
  1288	000705'	271740	000001		ADDI	P4,1
  1289	000706'	202740	000662*		MOVEM	P4,ORPPDP	;Let base see those 2 messages
  1290	000707'	201300	000000*	IFKMC<	MOVEI	T1,<4320000&<7777_<3*MAXDR>>>_-9
  1291						;T1/4320 or 320 or 20 or 0 (SEE DRFLAG:) SO AS TO PUT
  1292						;OUT 41 MESSAGES TO DRs 2,3 & 4 IF THEY ARE THERE
  1293	000710'	400500	000000		SETZ	W,		;INITIALIZE W FOR NON-PTY OUTPUT
  1294	000711'	205700	020400		MOVSI	P3,TYPI TYPHSI	;41 MESSAGES
  1295	000712'	260040	012653'		PUSHJ	P,MDRMSG
  1296				>;END IFKMC
  1297	000713'	402000	000664*		SETZM	BASDWN##	;Flag that we think the base is up
  1298	000714'	402000	000000*		SETZM	BASVER##	;Zero version number for BASEOK message
  1299	000715'	402000	017207'		SETZM	BADKEY		;Reset saved bad key
  1300	000716'	263040	000000		POPJ	P,		;Come back next tick
  1301
  1302				    ;CHECK OTHER UNUSUAL OUTPUT REQUESTS
  1303
  1304	000717'	400500	000000	SCNTIC:	SETZ	W,		;LET OUTPUT CODE KNOW IT'S REAL NOT PTY OUTPUT
  1305	000720'	260040	004140'		PUSHJ	P,SETOUT
  1306	000721'	254000	000741'		  JRST	SCNIN		;NO ROOM FOR CHARACTERS
  1307	000722'	336700	017030'		SKIPN	P3,UPSHUT	;IS THERE A SHUT OR ANSWERED MESSAGE
  1308	000723'	254000	000733'		 JRST	SCNNT2
  1309				IFNKMC<	PUSHJ	P,CLSCHR	;JUST FOR THE SAKE OF GOOD FORM
  1310					  JRST	SCNIN		;DON'T UNDERSTAND HOW WE GOT HERE BUT OK
  1311					SETZM	UPSHUT		;WILL SEND NOW, MARK NO MORE MSG
  1312					PUSHJ	P,WRDOUT	;SEND IT
  1313					  JRST	SCNIN		;THE LAST OF THE SPACE
  1314				>;END IFNKMC
  1315	000724'	260040	012726'	IFKMC<	PUSHJ	P,MDRUP		;GET 3-BIT UP FLAGS
  1316	000725'	554700	000016		HLRZ	P3,P3
  1317	000726'	306700	001000		CAIN	P3,TYPI TYPSHT
  1318	000727'	202300	016670'		 MOVEM	T1,DRMSHT
  1319	000730'	306700	000400		CAIN	P3,TYPI TYPANS
  1320	000731'	202300	016672'		 MOVEM	T1,DRMANS
  1321	000732'	402000	017030'		SETZM	UPSHUT>;END IFKMC
  1322	000733'	260040	015206'	SCNNT2:	PUSHJ	P,SNDSAD	;SEND A SAD MESSAGE IF APPROPRIATE
  1323	000734'	254000	000741'		  JRST	SCNIN
  1324	000735'	260040	012571'	IFKMC<	PUSHJ	P,SNDHSI	;SEE IF ANY DRs NEED A TYPHSI MSG ETC.
  1325	000736'	254000	000741'		  JRST	SCNIN>;END IFKMC
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 23-3
SCNSER.MAC	25-JAN-91 22:40		INPUT RING DISPATCHER

  1326	000737'	260040	011406'		PUSHJ	P,SNDAUX	;Check progress on AUX circuit builds
  1327	000740'	254000	000741'		  JRST	SCNIN		;OUT OF ROOM NOW
  1328				IFCPU (<KI,KL>), <	;TYMNET BASES REQUIRE BIO PORT NEGOTIATION,
  1329							; NEXILIS BASES DO NOT
  1330					SKIPGE	BIOCNT+0	;ANY CHANGE IN THE NUMBER OF BIO PORTS?
  1331					PUSHJ	P,SNDBIO	;REQUEST TO THE BASE.
  1332					  JRST	SCNIN
  1333				> ;END IFCPU (<KI,KL>)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 24
SCNSER.MAC	25-JAN-91 22:40		HERE TO PROCESS ALL THE MESSAGES IN THE INPUT RING, THEN

  1334				SUBTTL	HERE TO PROCESS ALL THE MESSAGES IN THE INPUT RING, THEN
  1335				;JUMP TO OUTPUT CODE. FSCN GETS SET TO -1 IF ANY MESSAGES
  1336				;WERE PROCESSED.
  1337
  1338	000741'	200740	000652*	SCNIN:	MOVE	P4,IRPPDP
  1339	000742'	316740	000653*		CAMN	P4,IRP620	;Anything in the input ring?
  1340	000743'	254000	003175'		 JRST	SCNOUT		;No, try output ring
  1341	000744'	476000	017016'		SETOM	FSCN		;Yes, flag that we found something
  1342				IFCPU (<F3,KS>),<
  1343	000745'	335000	000637*		SKIPGE	IRPTIM##	;Is this the first message after base went down?
  1344	000746'	256000	012744'		 STOPCD (,XCT,BASEOK)
  1345					;Yes, output BASEOK message
  1346				>  ;End IFCPU(F3,KS)
  1347	000747'	402000	000745*		SETZM	IRPTIM##	;Reset IRING timer
  1348	000750'	200300	000742*		MOVE	T1,IRP620	;Remember current IRING pointer so that
  1349	000751'	202300	017206'		MOVEM	T1,IRPSTP	; we can tell when it is time to pause input
  1350								; and send backpressure on lines that need it
  1351	000752'	316740	017206'	SCNIN0:	CAMN	P4,IRPSTP	;Processed all data present at start of pass?
  1352	000753'	254000	003175'		 JRST	SCNOUT		;Yes, go do output
  1353	000754'	260040	016470'		PUSHJ	P,IRPLOG	;No, LOG current IRING data, P4=INDEX
  1354				;;;;;;;;BEGIN KMC DEBUG CODE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  1355				IFKMC<
  1356	000755'	200600	017013'		MOVE	P1,IRPMB2	;SAVE PREVIOUS BASE POINTER
  1357	000756'	202600	017014'		MOVEM	P1,IRPMB3
  1358	000757'	200600	017012'		MOVE	P1,IRPMB1	;SAVE PREVIOUS BASE POINTER
  1359	000760'	202600	017013'		MOVEM	P1,IRPMB2
  1360	000761'	200600	000750*		MOVE	P1,IRP620
  1361	000762'	202600	017012'		MOVEM	P1,IRPMB1	;SAVE CURRENT BASE POINTER TOO
  1362
  1363	000763'	200600	017010'		MOVE	P1,IRPMP2	;SAVE PREVIOUS MESSAGE POINTER
  1364	000764'	202600	017011'		MOVEM	P1,IRPMP3
  1365	000765'	200600	017007'		MOVE	P1,IRPMP1	;SAVE PREVIOUS MESSAGE POINTER
  1366	000766'	202600	017010'		MOVEM	P1,IRPMP2
  1367	000767'	202740	017007'		MOVEM	P4,IRPMP1	;SAVE MESSAGE POINTER TOO
  1368
  1369	000770'	200600	017005'		MOVE	P1,IRPMS2	;SAVE PREVIOUS MESSAGE
  1370	000771'	202600	017006'		MOVEM	P1,IRPMS3
  1371	000772'	200600	017004'		MOVE	P1,IRPMSG	;SAVE PREVIOUS MESSAGE
  1372	000773'	202600	017005'		MOVEM	P1,IRPMS2
  1373	000774'	200617	000273*		MOVE	P1,IRING(P4)	;SAVE FIRST WORD OF MESSAGE IN IRPMSG
  1374	000775'	202600	017004'		MOVEM	P1,IRPMSG
  1375				>;END IFKMC
  1376				;;;;;;;;END KMC DEBUG CODE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  1377	000776'	135600	000266'		LDB	P1,INPTYP	;P1/ MESSAGE TYPE
  1378	000777'	135240	000267'		LDB	U,INPLIN	;U/ PORT #
  1379	001000'	303240	000000*		CAILE	U,RMXLIN##
  1380	001001'	254000	001015'		 JRST	BADPRT		;Check if message does not use port number
  1381	001002'	200245	000000*	BADPR1:	MOVE	U,LINTAB(U)	;U/ PORT LDB
  1382	001003'	500245	000031		HLL	U,LDBDCH(U)
  1383	001004'	622600	000200		TRZE	P1,200		;IF 200 BIT SET, IT'S DATA
  1384	001005'	254000	001547'		 JRST	CHRMLT		;P1 has count of characters to be input
  1385	001006'	303600	000063		CAILE	P1,MXTYP	;Check if in range
  1386	001007'	256000	017237'	TTYBMT:: STOPCD (SCNIN2,INFO,TTYBMT,PRTIRG,<Bad Message Type from Base>);;CNTPRT-1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 24-2
SCNSER.MAC	25-JAN-91 22:40		HERE TO PROCESS ALL THE MESSAGES IN THE INPUT RING, THEN

  1387	001010'	256014	001073'	CNTPRT:	XCT	TYPTRN(P1)	;DISPATCH TO IT
  1388	001011'	405740	000000*	SCNIN1:	ANDI	P4,MSKIRG	;MASK FOR WRAP AROUND
  1389	001012'	202740	000741*		MOVEM	P4,IRPPDP	;PUT IT AWAY FOR 620
  1390	001013'	254000	000752'		JRST	SCNIN0		;GO SEE IF MORE INPUT
  1391
  1392	001014'	344740	001011'	SCNIN2:	AOJA	P4,SCNIN1	;Ignore this word, go get next one
  1393
  1394				;Check for legal messages that do not have port number in 2nd byte
  1395
  1396	001015'	302600	000001	BADPRT:	CAIE	P1,TYPANS	;(1) Answered, port = 0
  1397	001016'	306600	000002		CAIN	P1,TYPSHT	;(2) Shut, port = 0
  1398	001017'	254000	001010'		 JRST	CNTPRT
  1399	001020'	302600	000003		CAIE	P1,TYPRES	;(3) Reset, port = flag bits (0,1,200,201)
  1400	001021'	306600	000004		CAIN	P1,TYPRAK	;(4) Reset ack, port = flag bits
  1401	001022'	254000	001010'		 JRST	CNTPRT
  1402	001023'	302600	000005		CAIE	P1,TYPNSP	;(5) New supervisor, port = 0
  1403	001024'	306600	000027		CAIN	P1,TYPSUR	;(27) Supervisor Response, port = key
  1404	001025'	254000	001010'		 JRST	CNTPRT
  1405	001026'	302600	000032		CAIE	P1,TYPTSR	;(32) Test pattern response, port = data
  1406	001027'	306600	000043		CAIN	P1,TYPCLR	;(43) Clock Response, port = 0
  1407	001030'	254000	001010'		 JRST	CNTPRT
  1408	001031'	201240	000000		MOVEI	U,0		;Use port 0 if out of range
  1409	001032'	256000	017243'		STOPCD (BADPR1,INFO,TTYBPN,PRTIRG,<Bad Port Number from Base>);;BADPRT+3
  1410				PRINTF([TTYBPN needs filter to skip multi-word IRING messages to continue])
  1411
  1412				;PRTIRG - Print PDP-10 ring pointers, and word at IRING+IRPPDP for STOPCD
  1413
  1414	001033'	260040	000616*	PRTIRG::PUSHJ	P,INLMES##	;Called from stopcodes TTYBMT,TTYBPN,CTYBMT
  1415	001034'	476452	050210		 ASCIZ /ORPPDP: /
	001035'	501644	000000
  1416	001036'	200300	000706*		MOVE	T1,ORPPDP
  1417	001037'	260040	000625*		PUSHJ	P,PRTOCT##
  1418	001040'	260040	001033*		PUSHJ	P,INLMES##
  1419	001041'	201011	151240		 ASCIZ /  IRPPDP: /
	001042'	502112	035100
	001043'	000000	000000
  1420	001044'	200300	001012*		MOVE	T1,IRPPDP
  1421	001045'	260040	001037*		PUSHJ	P,PRTOCT##
  1422	001046'	260040	001040*		PUSHJ	P,INLMES##	;Output word that IRPPDP points to
  1423	001047'	201004	044644		 ASCIZ /   IRING+/
	001050'	446350	725400
  1424	001051'	200740	001044*		MOVE	P4,IRPPDP	;In case called from CTYBMT in CTYSIM
  1425	001052'	550300	000017		HRRZ	T1,P4
  1426	001053'	260040	001045*		PUSHJ	P,PRTOCT##
  1427	001054'	260040	001046*		PUSHJ	P,INLMES##
  1428	001055'	275000	000000		 ASCIZ \/ \
  1429	001056'	135300	000266'		LDB	T1,INPTYP	;Message type
  1430	001057'	260040	001053*		PUSHJ	P,PRTOCT##
  1431	001060'	260040	000613*		PUSHJ	P,PRCOM##
  1432	001061'	135300	000267'		LDB	T1,INPLIN	;Get port number (U has LDB address)
  1433	001062'	260040	001057*		PUSHJ	P,PRTOCT##
  1434	001063'	260040	001060*		PUSHJ	P,PRCOM##
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 24-3
SCNSER.MAC	25-JAN-91 22:40		HERE TO PROCESS ALL THE MESSAGES IN THE INPUT RING, THEN

  1435	001064'	135300	000270'		LDB	T1,INPCHR	;Get first data byte
  1436	001065'	260040	001062*		PUSHJ	P,PRTOCT##
  1437	001066'	260040	001063*		PUSHJ	P,PRCOM##
  1438	001067'	135300	000271'		LDB	T1,INPCH2	;Get 2nd data byte
  1439	001070'	260040	001065*		PUSHJ	P,PRTOCT##
  1440	001071'	260040	000626*		PUSHJ	P,CRLF##
  1441	001072'	324740	000566'		PJRST	PRTCRS		;Output ORP620 and IRP620
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 25
SCNSER.MAC	25-JAN-91 22:40		IRING message type dispatch table

  1442				SUBTTL	IRING message type dispatch table
  1443
  1444	000000			TYPTRN:	PHASE	0		;Use XCT TYPTRN(P1)
  1445	001073'	256000	001007'	TYP.00:	 STOPCD (,XCT,TTYBMT)
  1446					; 0 ILLEGAL
  1447	001074'	254000	013007'	TYPANS:	JRST	RCVANS		; 1 KMC ANSWERED, IGNORED BY KL & KI
  1448	001075'	344740	001011'	TYPSHT:	AOJA	P4,SCNIN1	; 2 SHUT, IGNORE
  1449	001076'	254000	012746'	TYPRES:	JRST	RCVRES		; 3 BASE CRASHED AND RELOADED OR DR-11 DIED
  1450	001077'	254000	012742'	TYPRAK:	JRST	RCVRAK		; 4 BASE ACK TO MESSAGE TYPE 3
  1451	001100'	254000	011262'	TYPNSP:	JRST	RCVNSP		; 5 TAKEOVER OF BASE, RESET AUX CIRS
  1452	001101'	254000	001214'	TYPLOG:	JRST	LOGIN		; 6 START LOGIN PROCESS ON THIS PORT
  1453	001102'	254000	011342'	TYPAUX:	JRST	RCVAUX		; 7 AUX CIRCUIT PORT ESTABLISHED
  1454	001103'	260040	001177'	TYPNOP:	PUSHJ	P,NOOUT		;10 BACKPRESSURE ON
  1455	001104'	260040	001206'	TYPOUP:	PUSHJ	P,DOOUT		;11 BACKPRESSURE OFF
  1456	001105'	260040	001157'	TYPGOB:	PUSHJ	P,GOBCHR	;12 CHR. GOBBLER, CLEAR INPUT BUFFER
  1457	001106'	260040	001514'	TYPZAP:	PUSHJ	P,RCVZAP	;13 CIRCUIT ZAPPER
  1458	001107'	260040	001237'	TYPEDC:	PUSHJ	P,EDEC		;14 ENTER DEFFERED ECHO MODE
  1459	001110'	260040	001231'	TYPLDC:	PUSHJ	P,LDEC		;15 LEAVE DEFERRED ECHO MODE
  1460	001111'	254000	001243'	TYPGRN:	JRST	GREEN		;16 GREEN BALL
  1461	001112'	254000	001247'	TYPRED:	JRST	RED		;17 RED BALL
  1462	001113'	260040	001265'	TYPYEL:	PUSHJ	P,YELLOW	;20 YELLOW BALL
  1463	001114'	260040	001255'	TYPORG:	PUSHJ	P,ORANGE	;21 ORANGE BALL
  1464	001115'	344740	001011'	TYPHNG:	AOJA	P4,SCNIN1	;22 HANG, IGNORE
  1465	001116'	344740	001011'	TYPETM:	AOJA	P4,SCNIN1	;23 ENTER 2741 TRANSPARENT MODE
  1466	001117'	344740	001011'	TYPLTM:	AOJA	P4,SCNIN1	;24 LEAVE 2741 TRANSPARENT MODE
  1467	001120'	260040	001437'	TYPLOS:	PUSHJ	P,RCVLOS	;25 LOST BALL (CHARACTERS LOST ON INPT)
  1468	001121'	256000	001007'	TYPSUP:	 STOPCD (,XCT,TTYBMT)
  1469					;26 SUPERVISOR REQUEST
  1470	001122'	254000	011273'	TYPSUR:	JRST	RCVSUR		;27 SUPERVISOR RESPONSE
  1471	001123'	256000	001007'	TYPAXC:	 STOPCD (,XCT,TTYBMT)
  1472					;30 AUX CIRCUIT CHARACTER
  1473	001124'	256000	001007'	TYPTSP:	 STOPCD (,XCT,TTYBMT)
  1474					;31 TEST PROBE
  1475	001125'	344740	001011'	TYPTSR:	AOJA	P4,SCNIN1	;32 TEST RESPONSE, IGNORE
  1476	001126'	256000	001007'	TYPSAD:	 STOPCD (,XCT,TTYBMT)
  1477					;33 HOST SAD
  1478	001127'	256000	001007'	TYPECN:	 STOPCD (,XCT,TTYBMT)
  1479					;34 ECHO ON, SHOULD NOT COME IN
  1480	001130'	256000	001007'	TYPECF:	 STOPCD (,XCT,TTYBMT)
  1481					;35 ECHO OFF, SHOULD NOT COME IN
  1482	001131'	256000	001007'	TYPTCS:	 STOPCD (,XCT,TTYBMT)
  1483					;36 SEND TERMINAL CHRS. SHOULD NOT COME IN
  1484	001132'	256000	001007'	TYPTCP:	 STOPCD (,XCT,TTYBMT)
  1485					;37 TERM CHRS PROBE. SHOULD NOT COME IN
  1486	001133'	254000	001454'	TYPTCR:	JRST	RCVTMC		;40 TERM CHRS RESPONSE
  1487	001134'	256000	001007'	TYPHSI:	 STOPCD (,XCT,TTYBMT)
  1488					;41 PORT AND SYSTEM NUMBER
  1489	001135'	256000	001007'	TYPCLP:	 STOPCD (,XCT,TTYBMT)
  1490					;42 REQUEST FOR SUPERVISOR TIME
  1491	001136'	254000	001464'	TYPCLR:	JRST	CLKRSP		;43 CLOCK RESPONSE FROM SUP.
  1492	001137'	256000	001007'	TYPBKO:	 STOPCD (,XCT,TTYBMT)
  1493					;44 INITIATE BLOCK OUTPUT
  1494	001140'	260040	001417'	TYPBOC:	PUSHJ	P,BLKOHR	;45 BLOCK OUTPUT COMPLETE SAME AS TERMINATED
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 25-2
SCNSER.MAC	25-JAN-91 22:40		IRING message type dispatch table

  1495	001141'	256000	001007'	TYPBIN:	 STOPCD (,XCT,TTYBMT)
  1496					;46 INITIATE BLOCK INPUT
  1497	001142'	260040	001312'	TYPINB:	PUSHJ	P,BLKIBF	;47 BLOCK INPUT TERMINATED: OUT OF BUFFER
  1498	001143'	260040	001332'	TYPINE:	PUSHJ	P,BLKEOT	;50 BLOCK INPUT TERMINATED: END OF TRANSMISSION
  1499	001144'	260040	001350'	TYPINT:	PUSHJ	P,BLKITM	;51 BLOCK INPUT TERMINATED: TIMEOUT BY BASE
  1500	001145'	256000	001007'	TYPIRQ:	 STOPCD (,XCT,TTYBMT)
  1501					;52 REQUEST BLOCK INPUT TERMINATION
  1502	001146'	260040	001403'	TYPIHR:	PUSHJ	P,BLKIHR	;53 BLOCK INPUT TERMINATED: BY HOST REQUEST
  1503	001147'	256000	001007'	TYPORQ:	 STOPCD (,XCT,TTYBMT)
  1504					;54 REQUEST BLOCK OUTPUT TERMINATION.
  1505	001150'	260040	001417'	TYPOHR:	PUSHJ	P,BLKOHR	;55 BLOCK OUTPUT TERMINATED: BY HOST REQUEST
  1506	001151'	254000	001436'	TYPNEG:	JRST	BLKNEG		;56 NEGOTIATE FOR NUMBER OF BLOCK I/O PORTS
  1507	001152'	344740	001011'	TYPBRK:	AOJA	P4,SCNIN1	;57 BREAK, IGNORE FOR NOW
  1508	001153'	254000	001501'	TYPPSR:	JRST	RCVPS		;60 PORT STATUS RECEIVED (not used)
  1509	001154'	344740	001011'	TYPEAD:	AOJA	P4,SCNIN1	;61 ENTER ALTERNATE DEVICE MODE, IGNORE
  1510	001155'	344740	001011'	TYPLAD:	AOJA	P4,SCNIN1	;62 LEAVE ALTERNATE DEVICE MODE, IGNORE
  1511	001156'	256000	001007'	TYPKAF:	 STOPCD (,XCT,TTYBMT)
  1512					;63 SET KEEP-ALIVE FAILURE TIMER
  1513	001157'				DEPHASE
  1514
  1515			000063	MXTYP==.-TYPTRN-1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 26
SCNSER.MAC	25-JAN-91 22:40		NON-CHARACTER INPUT HANDLER ROUTINES

  1516				SUBTTL NON-CHARACTER INPUT HANDLER ROUTINES
  1517
  1518	001157'	550205	000000	GOBCHR:	HRRZ	F, LDBDDB(U)
  1519	001160'	322200	001521'		JUMPE	F, SIMRZP		;IF NO JOB, TREAT AS ZAPPER
  1520	001161'	135100	000000*		LDB	J, PJOBN
  1521	001162'	200342	000000*		MOVE	T2, JBTSTS(J)
  1522	001163'	607340	000004		TLNN	T2, JLOG		;IF NOT LOGGED-IN,
  1523	001164'	254000	001521'		 JRST	SIMRZP			;  TREAT AS ZAPPER
  1524	001165'	340740	001171'		AOJ	P4, GOBCH1
  1525	001166'	550205	000000	FRCCGB:	HRRZ	F, LDBDDB(U)
  1526	001167'	322200	001174'		JUMPE	F, GOBCH2		;IF IT'S ATTACHED
  1527	001170'	135100	001161*		LDB	J, PJOBN
  1528	001171'	135300	000237'	GOBCH1:	LDB	T1, DDPTCG
  1529	001172'	322300	001174'		JUMPE	T1, GOBCH2		;AND IT'S TRAPPING GOBBLERS,
  1530	001173'	260040	000000*		PUSHJ	P, TAKTRP		;  TAKE THE TRAP
  1531	001174'	201300	001000	GOBCH2:	MOVEI	T1, LXRCGS
  1532	001175'	436305	000032		IORM	T1, LDBDCX(U)		;SET CHARACTER-GOBBLER SEEN
  1533	001176'	324740	006257'		PJRST	TSETBI			;CLEAR THE INPUT BUFFERS
  1534
  1535	001177'	340740	000000	NOOUT:	AOJ	P4,
  1536	001200'	135300	000101'	FRCNOO:	LDB	T1, LOPZAP
  1537	001201'	326300	000000*		JUMPN	T1, CPOPJ		;IF ABOUT TO SEND ZAPPER, DO NOTHING
  1538	001202'	205300	400000		MOVSI	T1, LDLNOP
  1539	001203'	436305	000031		IORM	T1, LDBDCH(U)		;SET BACKPRESSURE FLAG
  1540	001204'	137305	000002		DPB	T1, LDBOPB(U)		;CLEAR NEED-OUTPUT
  1541	001205'	263040	000000		POPJ	P,
  1542
  1543	001206'	340740	000000	DOOUT:	AOJ	P4,
  1544	001207'	205300	400000	FRCDOO:	MOVSI	T1, LDLNOP
  1545	001210'	412305	000031		ANDCAM	T1, LDBDCH(U)		;CLEAR BACKPRESSURE FLAG
  1546	001211'	201300	000001		MOVEI	T1, 1
  1547	001212'	137305	000002		DPB	T1, LDBOPB(U)		;SET NEED-OUTPUT
  1548	001213'	263040	000000		POPJ	P,
  1549
  1550				;Here for message 06 - externally initiated login request
  1551
  1552	001214'	200305	000001	LOGIN:	MOVE	T1,LDBLIN(U)
  1553	001215'	603300	400000		TLNE	T1,LNLZIN		;IF THERE'S AN UNECHOED ZAPPER,
  1554					 JRST	[MOVEI	T1,NZAPLG
  1555						 PUSHJ	P,ZAPBUG	;NOTE IT
  1556	001216'	254000	017247'			 JRST	.+1	]
  1557	001217'	332005	000026		SKIPE	LDBLOG(U)		;IF LOGGED-IN OR LOGGING IN,
  1558									;  TREAT AS CIRCUIT ZAPPER
  1559					  JRST	[PUSHJ	P,ZAPLOG	;NOTE THE ZAP (increment P4)
  1560	001220'	254000	017252'			 JRST	SCNIN1]		;  Return to loop
  1561
  1562	001221'	201300	000010		MOVEI	T1,1B32			;This bit will be shifted to
  1563	001222'	202305	000026		MOVEM	T1,LDBLOG(U)		; 1B0 after reading 4 characters
  1564	001223'	135300	000273'		LDB	T1,INPDL2		;Get 3rd+4th byte of login message
  1565	001224'	135340	017254'		LDB	T2,[POINT 16,BASVER,31]	;Check version of base code
  1566	001225'	301340	001001		CAIL	T2,<02_^D8>+01		;If EBUS version 2.01 or later,
  1567	001226'	137300	000160'		 DPB	T1,LDPHST		; store originating host number
  1568	001227'	402005	000030		SETZM	LDBMOD(U)		;NOTHING SO FAR
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 26-2
SCNSER.MAC	25-JAN-91 22:40		NON-CHARACTER INPUT HANDLER ROUTINES

  1569	001230'	344740	001011'		AOJA	P4,SCNIN1
  1570
  1571				PRINTF (<[BUG at LDEC has not been completely fixed, causes TTYNNC]>)
  1572	001231'	332005	000014	LDEC:	SKIPE	LDBECC(U)		;ARE WE STILL ECHOING?
  1573	001232'	255000	001304'		 JFCL	ZAPDFR			;YES, TREAT AS CIRCUIT ZAPPER
  1574	001233'	205300	001000		MOVSI	T1,LDLDEF
  1575	001234'	607240	000040		TLNN	U,LDLAUX		;NOT FOR AUX CIRCUITS
  1576	001235'	412305	000031		 ANDCAM	T1,LDBDCH(U)		;RESET DEFERED ECHO FLAG
  1577	001236'	344740	007603'		AOJA	P4,SETLMD		;AND RESET LINE MODE
  1578
  1579	001237'	205300	001000	EDEC:	MOVSI	T1,LDLDEF
  1580	001240'	607240	000040		TLNN	U,LDLAUX
  1581	001241'	436305	000031		 IORM	T1,LDBDCH(U)		;ENTER DEFFERED ECHO MODE
  1582	001242'	344740	007603'		AOJA	P4,SETLMD
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 27
SCNSER.MAC	25-JAN-91 22:40		NON-CHARACTER INPUT HANDLER ROUTINES

  1583	001243'	201300	000001	GREEN:	MOVEI	T1, 1
  1584	001244'	137300	000103'		DPB	T1, LOPSGR	;SET SEND-GREEN-BALL FLAG
  1585	001245'	137305	000002		DPB	T1, LDBOPB(U)	;AND NEED-OUTPUT BIT
  1586	001246'	344740	001011'		AOJA	P4, SCNIN1
  1587
  1588	001247'	201300	000000	RED:	MOVEI	T1, 0
  1589	001250'	137300	000103'		DPB	T1, LOPSGR	;CLEAR SEND-GREEN-BALL FLAG
  1590	001251'	201300	000001		MOVEI	T1, 1
  1591	001252'	137300	000066'		DPB	T1, LOPSRD	;SET SEND-RED
  1592	001253'	137305	000002		DPB	T1, LDBOPB(U)	;AND WANNA-OUTPUT
  1593	001254'	344740	001011'		AOJA	P4, SCNIN1
  1594
  1595	001255'	340740	000000	ORANGE:	AOJ	P4,
  1596	001256'	260040	016060'	FRCORG:	PUSHJ	P, OBREC	;HANDLE INTERRUPT OR HIBER
  1597	001257'	255000	000000		  JFCL
  1598	001260'	205300	000400	OBFND:	MOVSI	T1, L2LOWT
  1599	001261'	412305	000027	OBFND1:	ANDCAM	T1, LDBBYT(U)	;CLEAR ORANGE-WAIT FLAG
  1600	001262'	201300	000001		MOVEI	T1, 1
  1601	001263'	137305	000002		DPB	T1, LDBOPB(U)	;SET NEED-OUTPUT (ZAP CODE MAY WAIT)
  1602	001264'	263040	000000		POPJ	P,
  1603
  1604	001265'	340740	000000	YELLOW:	AOJ	P4,
  1605				FRCYEL:	IFN YLBUG, <
  1606					PUSHJ	P, OBREC	;WAS JOB WAITING FOR AN ORANGE BALL?
  1607					  JRST	.+2		;NO
  1608					 JRST	OBFND		;YES, TREAT AS ORANGE BALL
  1609					MOVSI	T1, L2LOWT
  1610					TDNE	T1, LDBBYT(U)	;IS ZAP LOGIC WAITING FOR ORANGE?
  1611					 JRST	OBFND1		;YES, TREAT AS ORANGE
  1612					>
  1613	001266'	201300	002000		MOVEI	T1, LXRYBS
  1614	001267'	436305	000032		IORM	T1, LDBDCX(U)	;SET YELLOW-BALL-RECEIVED BIT
  1615	001270'	550205	000000		HRRZ	F, LDBDDB(U)
  1616	001271'	322200	001300'		JUMPE	F, YELLW1	;IF IT'S ATTACHED,
  1617	001272'	135300	000236'		LDB	T1, DDPTYB
  1618	001273'	322300	001300'		JUMPE	T1, YELLW1	;AND IT'S TRAPPING YELLOW BALLS,
  1619	001274'	260040	000000*		PUSHJ	P, TAKTRJ	;  TAKE THE TRAP
  1620	001275'	205300	004000		MOVSI	T1, LXLOOK
  1621	001276'	436305	000032		IORM	T1, LDBDCX(U)	;  AND ALLOW JOB TO SEND 1 ORANGE BALL
  1622	001277'	263040	000000		POPJ	P,		;OTHERWISE,
  1623	001300'	201300	000001	YELLW1:	MOVEI	T1, 1
  1624	001301'	137300	000104'		DPB	T1, LOPSOG	;  SET SEND-ORANGE
  1625	001302'	137305	000002		DPB	T1, LDBOPB(U)	;  AND NEED-OUTPUT
  1626	001303'	263040	000000		POPJ	P,
  1627
  1628	001304'	354000	017140'	ZAPDFR:	AOSA	DFRZAP		;RECORD NUMBER
  1629	001305'	350000	017136'	ZAPLOG:	AOS	LOGZAP		; NOTE THE ZAP
  1630	001306'	202240	017137'		MOVEM	U,ZAPLPT	; SAVE PORT LDB ADDRESS
  1631	001307'	260040	004500'		PUSHJ	P,ZAPBG0	;Save info, but use different stopcode
  1632	001310'	256000	017255'		 STOPCD (.+1,DEBUG,TTYZNE,PRTIRG,<Zapper not echoed for port>)
  1633	001311'	324740	001521'		PJRST	SIMRZP		; Simulate/force a zap (increment P4)
  1634	
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 28
SCNSER.MAC	25-JAN-91 22:40		BLKIBF - HERE WHEN A TYPE 47 (INPUT BUFFER FULL) IS RECEIVED

  1635				SUBTTL	BLKIBF - HERE WHEN A TYPE 47 (INPUT BUFFER FULL) IS RECEIVED
  1636				;	   FROM THE BASE.
  1637
  1638	001312'	135440	000273'	BLKIBF:	LDB	T4, INPDL2	; T4/ COUNT
  1639	001313'	340740	000000		AOJ	P4,
  1640	001314'	260040	001374'	FRCIBF:	PUSHJ	P,BLKICK	; EVERYTHING OK?
  1641	001315'	256000	017261'	TTYBNP:: STOPCD (FRCZAP,INFO,TTYBNP,,<Block mode io Not in Progress>)
  1642				 ;;FRCIBF+1
  1643	001316'	322200	001371'		JUMPE	F, FREBUF	; DETACHED: GIVE UP
  1644
  1645				    ;STORE THE CHARACTER COUNT INTO THE USER'S BUFFER
  1646
  1647	001317'	550305	000005	BLKIB1:	HRRZ	T1, LDBBIO(U)	; T1/ INPUT BUFFER ADDR
  1648	001320'	552446	000005		HRRZM	T4, BIOCHR(T1)	; STORE THE COUNT
  1649
  1650				    ;WAKE/INTERRUPT THE JOB
  1651
  1652	001321'	260040	006000'	BLKIB2:	PUSHJ	P, BIOWAK	; WAKE UP JOB
  1653	001322'	201300	004000		MOVEI	T1, LXRBRK
  1654	001323'	436305	000032		IORM	T1, LDBDCX(U)	; SET BIT FOR POLPRT
  1655	001324'	135300	000227'		LDB	T1, DDPTLN	; IF INTERRUPT-ON-BREAK ENABLED
  1656	001325'	260040	001274*		PUSHJ	P, TAKTRJ	; TAKE IT
  1657
  1658				    ;FREE THE BUFFER (AND, IF NO OUTPUT PENDING, THE BASE PORT)
  1659				    ;IF THE PORT HAS LEFT BLOCK MODE
  1660
  1661	001326'	205340	001000	BLKIB3:	MOVSI	T2, LMLBIO
  1662	001327'	616345	000030		TDNN	T2, LDBMOD(U)	; BLOCK I/O ENABLED?
  1663	001330'	324740	001371'		PJRST	FREBUF		; NO: FREE THE BUFFER
  1664	001331'	263040	000000		POPJ	P,
  1665
  1666				;BLKEOT - HERE WHEN A "INPUT TERMINATED - END OF TRANSMISSION"
  1667				; (TYPE 50) IS RECEIVED FROM THE BASE.
  1668
  1669	001332'	135440	000273'	BLKEOT:	LDB	T4, INPDL2	; T4/ COUNT
  1670	001333'	340740	000000		AOJ	P4,
  1671	001334'	260040	001374'	FRCEOT:	PUSHJ	P, BLKICK	; EVERYTHING OK?
  1672	001335'	256000	001315'		 STOPCD (,XCT,TTYBNP)
  1673					;Block mode io Not in Progress ;;FRCEOT+1
  1674	001336'	322200	001371'		PJUMPE	F, FREBUF	; DETACHED: GIVE UP
  1675	001337'	135300	000245'		LDB	T1, DDPMOD	; T1/ DATA MODE
  1676	001340'	306300	000014		CAIN	T1, B
  1677	001341'	254000	001317'		JRST	BLKIB1		; BINARY: JUST RETURN THE DATA
  1678	001342'	260040	013107'	IMGITM:	PUSHJ	P, BLKTRQ	; REQUEST INPUT TERMINATION
  1679	001343'	205000	000040	IMGIT2:	MOVSI	S, IOEND
  1680	001344'	437004	000002		IORB	S, DEVIOS(F)	; SET IOEND
  1681	001345'	326440	001317'		JUMPN	T4, BLKIB1	; COUNT .gt. 0: RETURN THE DATA
  1682	001346'	260040	012366'		PUSHJ	P, RELBI	; COUNT = 0: DONE WITH BLOCK INPUT
  1683	001347'	254000	001321'		JRST	BLKIB2		; WAKE THE JOB AND RETURN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 29
SCNSER.MAC	25-JAN-91 22:40		BLKITM - HERE WHEN AN "INPUT TERMINATED - TIMEOUT BY BASE"

  1684				SUBTTL	BLKITM - HERE WHEN AN "INPUT TERMINATED - TIMEOUT BY BASE"
  1685				; (TYPE 51) MESSAGE IS RECEIVED FROM THE BASE.
  1686
  1687	001350'	135440	000273'	BLKITM:	LDB	T4,INPDL2	; T4/ COUNT
  1688	001351'	340740	000000		AOJ	P4,
  1689	001352'	260040	001374'	FRCITM:	PUSHJ	P,BLKICK	; EVERYTHING OK?
  1690	001353'	263040	000000		  POPJ	P,		; NO: IGNORE THE MESSAGE
  1691	001354'	322200	001371'		PJUMPE	F, FREBUF	; DETACHED: GIVE UP
  1692	001355'	201000	040000		MOVEI	S, IOBKTL
  1693	001356'	437004	000002		IORB	S, DEVIOS(F)	; SET IO.BKT
  1694	001357'	135300	000245'		LDB	T1, DDPMOD	; T1/ DATA MODE
  1695	001360'	306300	000010		CAIN	T1, I
  1696	001361'	254000	001342'		JRST	IMGITM		; IMAGE: REQ TRM, RETURN DATA
  1697	001362'	326440	001317'		JUMPN	T4, BLKIB1	; COUNT.gt.0: WAKE JOB, RETURN DATA
  1698
  1699				    ;HERE WHEN NOT IN IMAGE MODE, TO REPEAT THE REQUEST
  1700
  1701	001363'	200305	000030		MOVE	T1, LDBMOD(U)
  1702	001364'	603300	400000		TLNE	T1, LMLTBI	; TERMINATE PENDING?
  1703	001365'	263040	000000		 POPJ	P,		; YES: DON'T REREQUEST INPUT
  1704	001366'	550305	000005		HRRZ	T1, LDBBIO(U)	; T1/ INPUT BUFFER ADDRESS
  1705	001367'	550346	000005		HRRZ	T2, BIOCHR(T1)	; T2/ SAME COUNT AS BEFORE
  1706	001370'	324740	012232'		PJRST	BLKIRQ		; REQUEST INPUT
  1707
  1708				;FREBUF - CALLED WHEN A PORT WITH LMLBIO CLEAR RECEIVES
  1709				;	   A BLOCK INPUT TERMINATED MESSAGE
  1710
  1711	001371'	260040	012366'	FREBUF:	PUSHJ	P, RELBI	; DONE WITH BLOCK INPUT
  1712	001372'	326300	001201*		JUMPN	T1, CPOPJ	; IF NO PENDING OUTPUT,
  1713	001373'	324740	012326'		PJRST	DECBC		;   FLAG 1 FEWER BLOCK PORT
  1714
  1715				; BLKICK - COMMON SUBROUTINE FOR BLOCK-INPUT-TERMINATED
  1716				;	    MESSAGES.
  1717
  1718	001374'	550305	000005	BLKICK:	HRRZ	T1,LDBBIO(U)	; T1/ INPUT BUFFER ADDRESS
  1719	001375'	332000	000006		SKIPE	T1		; IF NO BUFFER
  1720	001376'	331006	000005		SKIPL	BIOCHR(T1)	; OR NO REQUEST PENDING
  1721	001377'	263040	000000		 POPJ	P,		; FAIL-RETURN
  1722	001400'	550205	000000		HRRZ	F,LDBDDB(U)	; F/ DDB
  1723	001401'	350001	000000		AOS	(P)
  1724	001402'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 30
SCNSER.MAC	25-JAN-91 22:40		BLKIHR - HERE WHEN "INPUT TERMINATED - BY HOST REQUEST"

  1725				SUBTTL	BLKIHR - HERE WHEN "INPUT TERMINATED - BY HOST REQUEST"
  1726				; (TYPE 52)MESSAGE IS RECEIVED FROM THE BASE.
  1727
  1728	001403'	135440	000273'	BLKIHR:	LDB	T4, INPDL2	; T4/ COUNT
  1729	001404'	340740	000000		AOJ	P4,
  1730	001405'	205300	400000	FRCIHR:	MOVSI	T1, LMLTBI
  1731	001406'	412305	000030		ANDCAM	T1, LDBMOD(U)	; CLEAR TERMINATE-PENDING FLAG
  1732	001407'	550305	000005		HRRZ	T1, LDBBIO(U)	; T1/ INPUT BUFFER ADDRESS
  1733	001410'	336000	000006		SKIPN	T1		; IF THERE'S NONE THERE,
  1734	001411'	263040	000000		POPJ	P,		;   NOTHING MORE TO DO
  1735	001412'	200346	000005		MOVE	T2, BIOCHR(T1)	; T2/ IN-PROGRESS FLAG,,COUNT
  1736	001413'	325340	001326'		JUMPGE	T2, BLKIB3	; NO BLOCK INPUT IN PROGRESS
  1737	001414'	550205	000000		HRRZ	F, LDBDDB(U)	; F/ DDB
  1738	001415'	322200	001371'		PJUMPE	F, FREBUF	; DETACHED: FREE THE BUFFER
  1739	001416'	254000	001343'		JRST	IMGIT2		; SET IOEND, RETURN DATA
  1740
  1741				;BLKOHR - HERE WHEN AN "OUTPUT TERMINATED" (TYPE 52)
  1742				;	   OR AN "OUTPUT TERMINATED BY HOST REQUEST" (TYPE 53)
  1743				;	   MESSAGE IS RECEIVED FROM THE BASE
  1744
  1745	001417'	340740	000000	BLKOHR:	AOJ	P4,
  1746	001420'	205300	400000		MOVSI T1,LDLNOP
  1747	001421'	412305	000031		ANDCAM T1,LDBDCH(U)	;CLEAR OUTPUT BACKPRESSURE
  1748	001422'	201300	000001		MOVEI T1,1
  1749	001423'	137305	000002		DPB T1,LDBOPB(U)	;AND SET NEED-OUTPUT BIT
  1750	001424'	554305	000005	FRCOHR:	HLRZ T1,LDBBIO(U)	;T1/ OUTPUT BUFFER
  1751	001425'	322300	001433'		JUMPE T1,BLKOH1		;IF NONE, DO (ALMOST) NOTHING
  1752	001426'	260040	012372'		PUSHJ P,RELBO		;DONE WITH BLOCK OUTPUT
  1753	001427'	326300	001433'		JUMPN T1,BLKOH1		;IF NO ACTIVE BLOCK I/O
  1754	001430'	200345	000030		MOVE T2,LDBMOD(U)
  1755	001431'	607340	001000		TLNN T2,LMLBIO		;AND PORT WANTS OUT OF BLOCK MODE,
  1756	001432'	260040	012326'		PUSHJ P,DECBC		;  GET IT OUT
  1757	001433'	550205	000000	BLKOH1:	HRRZ F,LDBDDB(U)
  1758	001434'	322200	001372*		JUMPE F, CPOPJ		;IF ATTACHED,
  1759	001435'	324740	006126'		PJRST XMTWAK		;WAKE THE JOB
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 31
SCNSER.MAC	25-JAN-91 22:40		BLKIHR - HERE WHEN "INPUT TERMINATED - BY HOST REQUEST"

  1760				IFNCPU (<KI,KL>), <
  1761	001436'	256000	001007'	BLKNEG:	 STOPCD (,XCT,TTYBMT)
  1762					;56 NEGOTIATE FOR # BLOCK I/O PORTS NOT USED
  1763				>; END IFNCPU (<KI,KL>)
  1764
  1765				IFCPU (<KI,KL>), <
  1766				;SNDBIO - HERE AT CHANNEL 7 LEVEL FROM SCNINT WHEN THERE ARE
  1767				;ANY BLOCK I/O PORT REQUESTS (EITHER INCREASE OR DECREASE)
  1768				;PENDING.
  1769				
  1770				SNDBIO:	PUSHJ	P,CLSCHR	;FINISH PREVIOUS MESSAGE AND
  1771					  POPJ	P,		; RETURN IF NO MORE SPACE.
  1772					MOVSI	P3,TYPI TYPNEG	;PORT REQUEST TYPE FOR
  1773				;Following code commented out since there are no KMC's on
  1774				; KI's and KL's.
  1775				;IFKMC<	PUSHJ	P,MDRUP		;GET UP DRs
  1776				;	JUMPE	T1,CPOPJ	;IF NO NODES ARE UP THEN GIVEUP
  1777				;	SKIPA			;Don't shift the first time
  1778				;SNDBI1: LSH	T1,-3
  1779				;	TRNN	T1,7		;NO SKIP IF LOW 3 BITS ARE ALL 0s
  1780				;	  JRST	SNDBI1		;Go try the next one
  1781				;	SUBI	T1,1
  1782				;	ANDI	T1,3
  1783				;	LSH	T1,6
  1784				;	DPB	T1,WRPLIN	;STUFF THE UP DR NUMBER IN PORT
  1785				;>;IFKMC.END
  1786					HRRZS	T1,BIOCNT+0	;GET THE NEW REQUEST COUNT
  1787					DPB	T1,WRPCHR	;AND WRITE INTO 1ST DATA CHAR
  1788					AOS	BIOANS		;INC RESP COUNT EXPECTED OF BASE
  1789					JRST	WRDOUT		;SEND THE REQUEST AND SKIP RETURN.
  1790				
  1791				;BLKNEG - AT SNDBIO, WE SENT A TYPE 54, ASKING FOR <BIOCNT+0>
  1792				;BLOCK I/O PORTS. WE GET HERE WHEN WE GET A TYPE 54 BACK FROM
  1793				;THE BASE, TELLING US HOW MANY WE CAN HAVE.
  1794				
  1795				BLKNEG:	SKIPG	BIOANS		;IF WE DIDN'T SEND A REQUEST
  1796					JRST	[
  1797						AOS ERRBNG
  1798						AOJA P4, SCNIN1	;  IGNORE THE "RESPONSE"
  1799					]
  1800					SOSG	BIOANS		;IF THERE'RE MORE RESPONSES COMING
  1801					SKIPGE	T2,BIOCNT+0	;OR THERE'S ANOTHER REQUEST PENDING,
  1802					AOJA	P4,SCNIN1	;  IGNORE THE RESPONSE
  1803					LDB	T4,INPCHR	;T4/ # OF PORTS WE CAN HAVE
  1804					MOVN	T1,T4
  1805					ADD	T1,BIOPRT	;T1/ #PORTS BEFORE - #PORTS NOW
  1806					JUMPE	T1,BLKNG4
  1807					JUMPLE	T1,BLKNG2
  1808					CAML	T2,BIOPRT	;IF NOW .LT. BEFORE .LE. #JOBS
  1809					 STOPCD 		;  SOMEONE'S GOING THE WRONG WAY
  1810				BLKNG2:	MOVE	T2,BPREQ	;T2/ OLD BLOCK-PORT-REQ
  1811					ADDM	T1,BPREQ	;UPDATE BPREQ
  1812					JUMPLE	T2,BLKNG3	;IF SOMEONE WAS IN BLOCK-PORT WAIT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 31-2
SCNSER.MAC	25-JAN-91 22:40		BLKIHR - HERE WHEN "INPUT TERMINATED - BY HOST REQUEST"

  1813					SKIPG	T1		;AND THERE'RE MORE PORTS NOW,
  1814					SETOM	BPAVAL		;  TELL THE SCHEDULER
  1815				BLKNG3:	MOVEM	T4,BIOPRT	;SET THE NEW # OF PORTS
  1816				BLKNG4:	SKIPN	J,BIOJOB	;IF THERE'S A JOB IN AX WAIT,
  1817					AOJA	P4,SCNIN1
  1818					SETZM	BIOJOB
  1819					MOVEI	T1,RNQ
  1820					DPB	T1,PJBSTS##
  1821					PUSHJ	P,SETRUN	;  WAKE IT UP
  1822					AOJA	P4,SCNIN1
  1823				> ;END IFCPU (<KI,KL>)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 32
SCNSER.MAC	25-JAN-91 22:40		HERE WHEN A "CHARACTERS LOST" MESSAGE (BUFFER ZAP) IS

  1824				SUBTTL	HERE WHEN A "CHARACTERS LOST" MESSAGE (BUFFER ZAP) IS
  1825				;RECEIVED: IF THE DATA BYTE IS 0, OUTPUT CHARACTERS WERE
  1826				;LOST; OTHERWISE, INPUT CHARACTERS WERE LOST
  1827
  1828	001437'	340740	000000	RCVLOS:	AOJ	P4,
  1829	001440'	350000	017134'		AOS	TTYLOS		;RECORD CHARACTER LOST BY TYMNET
  1830	001441'	135300	000270'		LDB	T1,INPCHR	;T1/ DIRECTION
  1831	001442'	336000	000006	FRCLOS:	SKIPN	T1
  1832	001443'	664300	020000		TROA	T1,LXROCL	; 0 = OUTPUT LOST
  1833	001444'	201300	040000		MOVEI	T1,LXRICL	; 1 = INPUT LOST
  1834	001445'	436305	000032		IORM	T1,LDBDCX(U)
  1835	001446'	550205	000000		HRRZ	F,LDBDDB(U)
  1836	001447'	322200	001434*		JUMPE	F,CPOPJ		;NOTHING TO DO IF NO DDB
  1837	001450'	201300	040000		MOVEI	T1,IOBKTL
  1838	001451'	436304	000002		IORM	T1,DEVIOS(F)	;SET ERROR FLAG
  1839	001452'	135300	000232'		LDB	T1,DDPTLC
  1840	001453'	324740	001325*		PJRST	TAKTRJ		;SET TO INTERRUPT
  1841
  1842				;HERE WHEN A TERMINAL CHARACTERISTICS VALUE IS RECEIVED
  1843
  1844	001454'	135300	000271'	RCVTMC:	LDB	T1,INPCH2	;VALUE
  1845	001455'	135340	000270'		LDB	T2,INPCHR	;AND TYPE NUMBER
  1846	001456'	303340	000024		CAILE	T2,MAXTMC	;CHECK RANGE
  1847	001457'	254000	001462'		 JRST	RCVTCX		;(BAD)
  1848	001460'	137307	000004'		DPB	T1,TABTMR(T2)
  1849	001461'	344740	001011'		AOJA	P4,SCNIN1	;FINISHED
  1850
  1851	001462'			RCVTCX:
  1852				;*;	CAILE	T2,<MAXTMC+TMCSLP>
  1853				;*;	 STOPCD			;AMAZINGLY BAD
  1854	001462'	350000	017147'		AOS	TMCOOR		;SLIGHTLY BAD - BUMP OUT-OF-RANGE COUNT
  1855	001463'	344740	001011'		AOJA	P4,SCNIN1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 33
SCNSER.MAC	25-JAN-91 22:40		HERE WHEN THE TIME AND DATE ARE RECEIVED

  1856				SUBTTL	HERE WHEN THE TIME AND DATE ARE RECEIVED
  1857
  1858	001464'	135340	000273'	CLKRSP:	LDB	T2,INPDL2	;GET HIGH ORDER BITS OF TIME
  1859	001465'	271740	000001		ADDI	P4,1
  1860	001466'	405740	001011*		ANDI	P4,MSKIRG
  1861	001467'	135300	000272'		LDB	T1,INPDL1	;GET LOW ORDER BITS
  1862	001470'	137340	017264'		DPB	T2,[POINT 16,T1,19]
  1863	001471'	231300	250600		IDIVI	T1,^D<24*60*60>	;DAYS IN T1, SEC IN T2
  1864	001472'	271300	007105		ADDI	T1,^D3653	;Convert 1-JAN-74 to 1-JAN-64
  1865	001473'	220340	000000*		IMUL	T2,JFYSEC
  1866	001474'	250300	000007		EXCH	T1,T2		;Time in T1, Date in T2
  1867	001475'	260040	000000*		PUSHJ	P,COMGMS##	;Set GMT time (in UUOCON)
  1868	001476'	200300	000000*		MOVE	T1,DATE##	;Remember the date/time of when
  1869	001477'	202300	000000*		MOVEM	T1,SUPTIM##	; the Supervisor saw us
  1870	001500'	344740	001011'		AOJA	P4,SCNIN1
  1871
  1872				;HERE WHEN A PORT STATUS MESSAGE IS RECEIVED (see comment at ACPSM)
  1873
  1874	001501'	135300	000270'	RCVPS:	LDB	T1,INPCHR	; GET THE 4 BITS
  1875	001502'	137300	000176'		DPB	T1,LDPPSM	; STORE PORT STATUS MSG
  1876	001503'	201300	100000		MOVEI	T1,LXRPSS
  1877	001504'	436305	000032		IORM	T1,LDBDCX(U)	; AND NOTE THAT IT'S BEEN SEEN
  1878	001505'	205300	200000		MOVSI	T1,LMLPSP
  1879	001506'	436305	000030		IORM	T1,LDBMOD(U)
  1880	001507'	550205	000000		HRRZ	F,LDBDDB(U)
  1881	001510'	322200	001513'		JUMPE	F,PSDONE	; NO TRAP IF NO DDB
  1882	001511'	135300	000235'		LDB	T1,DDPTPS
  1883	001512'	260040	001453*		PUSHJ	P,TAKTRJ	; SET TO INTERRUPT
  1884	001513'	344740	001011'	PSDONE:	AOJA	P4,SCNIN1	; DONE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 34
SCNSER.MAC	25-JAN-91 22:40		HERE WHEN A CIRCUIT ZAPPER IS RECEIVED

  1885				SUBTTL	HERE WHEN A CIRCUIT ZAPPER IS RECEIVED
  1886
  1887	001514'	350000	017141'	RCVZAP:	AOS	NZAPIN		;# REAL, TRUE ZAPPERS IN
  1888	001515'	200305	000001		MOVE	T1,LDBLIN(U)	;Mark as zapper coming from TYMNET
  1889	001516'	663300	400000		TLOE	T1,LNLZIN	;If there's one already in,
  1890					 JRST	[MOVEI	T1,NZAPN2
  1891						 PUSHJ	P,ZAPBUG  ;NOTE IT
  1892	001517'	254000	017265'			 JRST	SIMRZP	]
  1893	001520'	202305	000001		MOVEM	T1,LDBLIN(U)
  1894	001521'	271740	000001	SIMRZP:	ADDI	P4,1		;Skip past the zap command in IRING
  1895
  1896				;Enter at FRCZAP to pretend we received a zapper from the base
  1897
  1898	001522'	402005	000003	FRCZAP:	SETZM	LDBOUT(U)		;Cancel any pending output bits
  1899	001523'	205300	000400		MOVSI	T1,L2LOWT
  1900	001524'	412305	000027		ANDCAM	T1,LDBBYT(U)		;Cancel wait for orange ball
  1901	001525'	331005	000026		SKIPL	LDBLOG(U)		;If port's not logged-in,
  1902					 JRST	[SETZB	T1,LDBLOG(U)	; cancel "login in progress"
  1903						 DPB	T1,LDPHST	;Clear host number
  1904						 MOVEI	T1,1
  1905						 DPB	T1,LOPZAP	;Set send-zapper
  1906						 DPB	T1,LDBOPB(U)	; and need-output
  1907						 MOVSI	T1,LDLNOP
  1908						 ANDCAM	T1,LDBDCH(U)	;Ignore backpressure
  1909	001526'	254000	017270'			 POPJ	P,	]
  1910	001527'	205300	300000		MOVSI	T1,LLLNLN!LLLZAP	;Line not there (TYMNET has zapped it)
  1911	001530'	436305	000026		IORM	T1,LDBLOG(U)		;Mark port as externally zapped
  1912	001531'	200305	000030		MOVE	T1,LDBMOD(U)
  1913	001532'	607300	001000		TLNN	T1,LMLBIO		;IF BLOCK-MODE SET,
  1914	001533'	332005	000005		SKIPE	LDBBIO(U)		;OR BLOCK I/O'S STILL IN PROGRESS,
  1915	001534'	260040	012077'		 PUSHJ	P,BIOZAP		;  RELEASE BUFFERS & CLEAR BLOCK-MODE
  1916	001535'	603240	000040		TLNE	U,LDLAUX		;IF IT'S AN AUX PORT
  1917	001536'	324740	011235'		 PJRST	ZAPAUX
  1918	001537'	550205	000000		HRRZ	F,LDBDDB(U)
  1919	001540'	322200	001447*		JUMPE	F,CPOPJ
  1920	001541'	205300	020000		MOVSI	T1,TTYATC
  1921	001542'	616304	000004		TDNN	T1,DEVMOD(F)		;OR AT ANY RATE NOT A COMMAND PORT,
  1922	001543'	324740	011235'		 PJRST	ZAPAUX			;  DETACH & TRY TO FREE DDB
  1923
  1924				    ;HERE WHEN A ZAPPER IS RECEIVED ON A JOB'S COMMAND PORT
  1925
  1926	001544'	135100	001170*		LDB	J,PJOBN			;J/ DON't FORCE,,JOB#
  1927	001545'	260040	006640'		PUSHJ	P,HNGTTY		;Force hangup for job/frame
  1928	001546'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 35
SCNSER.MAC	25-JAN-91 22:40		INPUT CHARACTER HANDLER

  1929				SUBTTL INPUT CHARACTER HANDLER
  1930
  1931	001547'	336005	000026	CHRMLT:	SKIPN	LDBLOG(U)		;MIGHT BE LINE WE HAVE JUST
  1932	001550'	254000	001572'		 JRST	MLTNDB			; SENT ZAPPER ON, FIX INPUT RING
  1933	001551'	201317	000774*		MOVEI	T1,IRING(P4)
  1934	001552'	505300	221000		HRLI	T1,(POINT 8,0,BYP2)	;SET UP A BYTE POINTER
  1935	001553'	202300	017040'		MOVEM	T1,CHRRDP
  1936	001554'	101400	017040'	CHRML1:	UUILDB	T3,CHRRDP
  1937	001555'	260040	001606'		PUSHJ	P,MOVCHR
  1938	001556'	367600	001554'		 SOJG	P1,CHRML1		;CONTINUE
  1939	001557'	327600	001601'		JUMPG	P1,CHRML3		;HERE AT END OR DEF ECHO MODE
  1940	001560'			CLRMLT:
  1941				;;;;;;;; MORE KMC DEBUG CODE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  1942	001560'	200600	017004'	IFKMC<	MOVE	P1,IRPMSG
  1943	001561'	312617	001551*		CAME	P1,IRING(P4)
  1944	001562'	256000	000000'		 STOPCD 		;CRASH ON KMC IRING OVERWRITE or bad P4
  1945				>;END_IFKMC
  1946				;;;;;;;; END KMC DEBUG CODE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  1947	001563'	135600	000266'		LDB	P1,INPTYP		;NOW CLEAR OUT THE INPUT RING
  1948	001564'	620600	000200		TRZ	P1,200			;GET COUNT BACK
  1949	001565'	550205	000000		HRRZ	F,LDBDDB(U)		;CHARGE
  1950	001566'	322200	001572'		JUMPE	F,MLTNDB
  1951	001567'	135300	001544*		LDB	T1,PJOBN
  1952	001570'	272606	000000*		ADDM	P1,JBTCIN(T1)
  1953	001571'	272600	001570*		ADDM	P1,JBTCIN		;System-wide # of characters input
  1954	001572'	271600	000005	MLTNDB:	ADDI	P1,5	;GET NUMBER OF WORDS USED (2 BYTES FOR COUNT AND PORT)
  1955	001573'	242600	777776		LSH	P1,-2
  1956	001574'	270740	000014		ADD	P4,P1			;INCREMENT POINTER BY NUMBER USED
  1957	001575'	254000	001011'		JRST	SCNIN1
  1958
  1959	001576'	101400	017040'	CHRML2:	UUILDB	T3,CHRRDP
  1960	001577'	260040	001606'		PUSHJ	P,MOVCHR		;THIS IS THE DEFERED ECHO LOOP
  1961	001600'	255000	000000		 JFCL				;SHOULD NOT BE GETTING HERE
  1962	001601'	367600	001576'	CHRML3:	SOJG	P1,CHRML2
  1963	001602'	201300	000001		MOVEI	T1, 1
  1964	001603'	137300	000102'		DPB	T1, LOPECO		;SET SEND-ECHO
  1965	001604'	137305	000002		DPB	T1, LDBOPB(U)		;AND NEED-OUTPUT
  1966	001605'	254000	001560'		JRST	CLRMLT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 36
SCNSER.MAC	25-JAN-91 22:40		CALLED WITH CHARACTER IN T3. DISPATCH ON CHARACTER TYPE AND LINE MODE

  1967				SUBTTL	CALLED WITH CHARACTER IN T3. DISPATCH ON CHARACTER TYPE AND LINE MODE
  1968
  1969	001606'	135640	000202'	MOVCHR:	LDB	P2,LDPMIN	;Get the input mode
  1970	001607'	606400	000200		TRNN	T3,200
  1971	001610'	334710	000312'	MOVCH2:	SKIPA	P3,CHRTAB(T3)	;Get character bits
  1972	001611'	200710	000112'		MOVE	P3,CHRTAB-200(T3)
  1973	001612'	135340	000302'		LDB	T2,CHPINP	;GET INPUT TYPE
  1974	001613'	256015	001615'	MOVCH1:	XCT	CIMTAB(P2)	;DO THE RIGHT THING FOR THE LINE MODE
  1975	001614'	254006	000000		JRST	(T1)		;THIS WILL USUALLY LOAD AN ADDRESS IN T1
  1976
  1977				;LINE MODE DISPATCH TABLE
  1978
  1979	001615'	254000	001746'	CIMTAB:	JRST	LOGCHR		;LOGIN
  1980	001616'	254000	002123'		JRST	IMGDEF		;IMAGE,DEF ECHO
  1981	001617'	254000	002136'		JRST	IMGRMA		;IMAGE,REM ECHO,BKA=1
  1982	001620'	254000	002152'		JRST	IMGRMT		;IMAGE,REM ECHO,BKA=0
  1983	001621'	554307	001631'		HLRZ	T1,MD0405(T2)	;NORMAL,DEF ECHO,BK2=0
  1984	001622'	550307	001631'		HRRZ	T1,MD0405(T2)	;NORMAL,DEF ECHO,BK2=1
  1985	001623'	554307	001635'		HLRZ	T1,MD0607(T2)	;NORMAL,REM ECHO,BKA=1,BK2=0
  1986	001624'	550307	001635'		HRRZ	T1,MD0607(T2)	;NORMAL,REM ECHO,BKA=1,BK2=1
  1987	001625'	554307	001641'		HLRZ	T1,MD1011(T2)	;NORMAL,REM ECHO,BKA=0,BK2=1
  1988	001626'	550307	001641'		HRRZ	T1,MD1011(T2)	;NORMAL,REM ECHO,BKA=0,BK2=0
  1989	001627'	554307	001645'		HLRZ	T1,MD1213(T2)	;COMMAND,REM ECHO
  1990	001630'	550307	001645'		HRRZ	T1,MD1213(T2)	;COMMAND,DEF ECHO
  1991
  1992				;CHARACTER TYPE DISPATCH TABLES
  1993
  1994				; CHARACTER TYPES FOR INPUT
  1995				;
  1996				; 0 - SPECIAL ACTION
  1997				; 1 - NORMAL CHARACTER
  1998				; 2 - BREAK (CONTROL) CHARACTER
  1999				; 3 - BREAK2 (PUNCTUATION) CHARACTER
  2000
  2001	001631'	002517'	002517'	MD0405:	IACT0,,IACT0	; 0,, 0
  2002	001632'	002167'	002167'		IACT1,,IACT1	; 1,, 1
  2003	001633'	002172'	002172'		IACT2,,IACT2	; 2,, 2
  2004	001634'	002201'	002207'		IACT3,,IACT4	; 3,, 4
  2005
  2006	001635'	002517'	002517'	MD0607:	IACT0,,IACT0	; 0,, 0
  2007	001636'	002214'	002214'		IACT5,,IACT5	; 5,, 5
  2008	001637'	002221'	002221'		IACT6,,IACT6	; 6,, 6
  2009	001640'	002225'	002233'		IACT7,,IACT10	; 7,,10
  2010
  2011	001641'	002517'	002517'	MD1011:	IACT0,,IACT0	; 0,, 0
  2012	001642'	002241'	002241'		IACT11,,IACT11	;11,,11
  2013	001643'	002221'	002221'		IACT6,,IACT6	; 6,, 6
  2014	001644'	002233'	002450'		IACT10,,IACT12	;10,,12
  2015
  2016	001645'	002517'	002517'	MD1213:	IACT0,,IACT0	; 0,, 0
  2017	001646'	002456'	002505'		IACT13,,IACT21	;13,,21
  2018	001647'	002461'	002510'		IACT14,,IACT22	;14,,22
  2019	001650'	002467'	002477'		IACT15,,IACT17	;15,,17
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 37
SCNSER.MAC	25-JAN-91 22:40		THIS ROUTINE IS CALLED BY ALMOST EVERYONE TO PUT A CHR INTO

  2020				SUBTTL	THIS ROUTINE IS CALLED BY ALMOST EVERYONE TO PUT A CHR INTO
  2021				;THE INPUT BUFFER
  2022
  2023	001651'	200440	017017'	RCVCHR:	MOVE	T4,TTFREN
  2024	001652'	307440	000003		CAIG	T4,TIRSVD
  2025	001653'	254000	001731'		 JRST	RECHLT		;OUT OF BUFFERLETS. GIVE HIM BELL
  2026	001654'	200445	000012		MOVE	T4,LDBTIC(U)
  2027	001655'	270445	000014		ADD	T4,LDBECC(U)
  2028	001656'	311440	017117'		CAML	T4,TIWRNN	;OVER SMALL QUOTA?
  2029	001657'	254000	001717'		 JRST	RWARN		;TRY TO STOP HIS INPUT
  2030	001660'	260040	016010'	RCVCH1:	PUSHJ	P,CHRTRP	;TAKE A CHARACTER TRAP
  2031	001661'	336345	000010		SKIPN	T2,LDBTIP(U)
  2032	001662'	260040	001704'		 PUSHJ	P,RECVRG	;MUST SET UP THE INPUT POINTERS
  2033	001663'	260040	006177'		PUSHJ	P,TTPUTC	;PUT THE CHR IN THE BUFFER
  2034	001664'	202345	000010		MOVEM	T2,LDBTIP(U)
  2035	001665'	350005	000007		AOS	LDBBKI(U)
  2036	001666'	205300	004000		MOVSI	T1,L2LDEL	;SHOULD WE RESET THE \ FLAG?
  2037	001667'	616305	000027		TDNN	T1,LDBBYT(U)
  2038	001670'	254000	001700'		 JRST	RCVCH2		;NOT ON
  2039	001671'	261040	000007		PUSH	P,T2
  2040	001672'	201400	000134		MOVEI	T3,"\"
  2041	001673'	260040	002427'		PUSHJ	P,ENTRUB
  2042	001674'	201300	000001		MOVEI	T1,1
  2043	001675'	137300	000074'		DPB	T1,LOPRUB	;SET SEND-RUBOUT
  2044	001676'	137305	000002		DPB	T1,LDBOPB(U)	;AND NEED-OUTPUT
  2045	001677'	262040	000007		POP	P,T2
  2046	001700'	205300	204000	RCVCH2:	MOVSI	T1,L2LDEL!L2LCCS
  2047	001701'	412305	000027		ANDCAM	T1,LDBBYT(U)
  2048	001702'	350001	000000		AOS	(P)
  2049	001703'	263040	000000		POPJ	P,
  2050
  2051	001704'	260040	006243'	RECVRG:	PUSHJ	P,GETCHK
  2052	001705'	202345	000010		MOVEM	T2,LDBTIP(U)	;SET UP INPUT POINTERS
  2053	001706'	202345	000011		MOVEM	T2,LDBTIT(U)
  2054	001707'	202345	000013		MOVEM	T2,LDBECT(U)
  2055	001710'	402005	000007		SETZM	LDBBKI(U)
  2056	001711'	402005	000006		SETZM	LDBBKP(U)
  2057	001712'	402005	000012		SETZM	LDBTIC(U)
  2058	001713'	402005	000014		SETZM	LDBECC(U)
  2059	001714'	402005	000015		SETZM	LDBBKC(U)
  2060	001715'	402005	000016		SETZM	LDBBK2(U)
  2061	001716'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 38
SCNSER.MAC	25-JAN-91 22:40		THIS ROUTINE IS CALLED BY ALMOST EVERYONE TO PUT A CHR INTO

  2062	001717'	311440	017120'	RWARN:	CAML	T4,TIHLTN	;OVER LARGE QUOTA?
  2063	001720'	254000	001725'		 JRST	RWARN1		;YES: GO SEE HOW BADLY WE LOST
  2064	001721'	201300	000001		MOVEI	T1,1
  2065	001722'	137300	000063'		DPB	T1,LOPBPN	;NO: SET BACKPRESSURE-ON
  2066	001723'	137305	000002		DPB	T1,LDBOPB(U)	;    AND NEED-OUTPUT
  2067	001724'	254000	001660'		JRST	RCVCH1
  2068
  2069	001725'	135300	000063'	RWARN1:	LDB	T1,LOPBPN	;STILL WAITING TO SEND BACKPRESSURE?
  2070	001726'	332000	000006		SKIPE	T1
  2071	001727'	354000	017122'		 AOSA	LOSPDP		;YES: WE'RE TOO SLOW
  2072	001730'	350000	017123'		AOS	LOS620		;NO: BACKPRESSURE BROKEN
  2073					PFALL	RECHLT		;SEND BELL AND DROP CHARACTERS
  2074
  2075	001731'	350000	017121'	RECHLT:	AOS	TTYRHT		;RECORD CHARACTER LOST
  2076	001732'	201300	040000		MOVEI	T1,LXRICL
  2077	001733'	436305	000032		IORM	T1,LDBDCX(U)	;NOTE THE DIRECTION
  2078	001734'	550205	000000		HRRZ	F,LDBDDB(U)
  2079	001735'	322200	001742'		JUMPE	F,RECHT1
  2080	001736'	201300	040000		MOVEI	T1,IOBKTL	;SET IO.BKT
  2081	001737'	436304	000002		IORM	T1,DEVIOS(F)
  2082	001740'	135300	000232'		LDB	T1,DDPTLC	;IF CHARACTERS-LOST ENABLED
  2083	001741'	260040	001512*		PUSHJ	P,TAKTRJ	;TAKE IT
  2084	001742'	201300	000001	RECHT1:	MOVEI	T1,1
  2085	001743'	137300	000072'		DPB	T1,LOPSBL	;SET SEND-BELL
  2086	001744'	137305	000002		DPB	T1,LDBOPB(U)	;AND NEED-OUTPUT
  2087	001745'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 39
SCNSER.MAC	25-JAN-91 22:40		HERE ON A LOGIN CHARACTER (ONE OF FIRST 4 ON LINE)

  2088				SUBTTL	HERE ON A LOGIN CHARACTER (ONE OF FIRST 4 ON LINE)
  2089
  2090	001746'	337445	000026	LOGCHR:	SKIPG	T4,LDBLOG(U)	;Are we really logging him in?
  2091	001747'	263040	000000		 POPJ	P,		;No, return from MOVCHR
  2092	001750'	242440	000010		LSH	T4,^D8		;Put login char
  2093	001751'	434440	000010		IOR	T4,T3		; into
  2094	001752'	202445	000026		MOVEM	T4,LDBLOG(U)	;  LDBLOG
  2095	001753'	325440	001540*		JUMPGE	T4,CPOPJ	;More to come
  2096
  2097				;WE'VE RECEIVED THE 32 BITS OF LOGIN DATA FROM TYMNET - NOW LOG THE LINE IN
  2098
  2099	001754'	350000	017034'		AOS	INTERM		;COUNT 1 MORE LINE LOGGED-IN
  2100	001755'	135300	000156'		LDB	T1,TRMBYP	;T1/ TERMINAL ID CODE
  2101	001756'	200306	002063'		MOVE	T1,TRMTAB(T1)	;T1/ IBM,FAST,FC1,FC2,WIDTH CODES
  2102	001757'	607300	200000		TLNN	T1,200000	;FAST TERMINAL?
  2103	001760'	634400	000010		 TDZA	T3,T3		;NO
  2104	001761'	205400	400000		MOVSI	T3,LXL120	;YES
  2105	001762'	202405	000032		MOVEM	T3,LDBDCX(U)	;SET LDBDCX (0 EXCEPT FOR FAST BIT)
  2106	001763'	205400	021020		MOVSI	T3,LDLDEF!LDLLCT!LDLCOM
  2107	001764'	337000	000006		SKIPG	T1		;IS IT A 2741?
  2108	001765'	661400	000004		 TLO	T3,LDLLCP	;YES: SET LOCAL-COPY FLAG
  2109	001766'	402005	000027		SETZM	LDBBYT(U)	;MOST FIELDS ARE 0
  2110	001767'	137300	000172'		DPB	T1,LDPFC1	;SET FC1
  2111	001770'	242300	777776		LSH	T1,-2
  2112	001771'	137300	000166'		DPB	T1,LDPFC2	;AND FC2
  2113	001772'	242300	777776		LSH	                   !sq1Th\A&X	| DS  @                                          @                                 !s                                             a3                          8 8^ 8 8_ 8 8` 8 8a 8 8b 8 A* Ap A Aq A Ar A As A BB B BC B BD B BE B BF B BG B 1 1 1 1 1 1 1 1 1 1 1 4; 4 4< 4 4= 4 4> 4 4? 4 4e 4 4f 5 5- 5 5 5x 6* 6 6+ 6 6, 6 6- 6 6` 7* 7 7e 7 7f 7 7g 7 7h 7 7i 7 7j 7 7k 7 7l 7 7m 7 7n 7 7o 7 ; ;u ; ;v ; ;w ; ;x ; <* < <+ < <, < <- < <. < </ < <0 < <1 < <2 < <3 < <4 < <5 < <6 < <7 < <8 < <9 < <: @u @ @v @                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               m[ `  2161	002034'	201300	200000		MOVEI	T1,STSUPR	;200000
  2162	002035'	612300	000000*		TDNE	T1,STATES
  2163	002036'	254000	002042'		 JRST	LOGCH1		;System is super-shut, zap always
  2164	002037'	603240	000040		TLNE	U,LDLAUX	;Is this an AUX circuit ?
  2165	002040'	331000	002035*		SKIPL	STATES		;Yes, is system plain shut ?
  2166	002041'	254000	002045'		 JRST	LOGCH2		;No, o.k. to log in
  2167	002042'	202305	000026	LOGCH1:	MOVEM	T1,LDBLOG(U)	;Must be non-zero and non-negative
  2168	002043'	370000	017034'		SOS	INTERM		;Leave INTERM alone in case
  2169	002044'	254000	015372'		JRST	TTYZAP		; of Auto-Restart
  2170
  2171	002045'	260040	007603'	LOGCH2:	PUSHJ	P,SETLMD	;Set the line mode
  2172				;;
  2173				;; Here (finally!) to assign a frame for this port and initiate
  2174				;; LOGIN.
  2175				;;
  2176	002046'	400200	000000		SETZ	F,		;Indicate no DDB assigned yet
  2177	002047'	260040	000000*		PUSHJ	P,FRMASN##	;Assign a free frame number
  2178	002050'	254000	002055'		  JRST	NEWJER		;No free frames...
  2179	002051'	260040	015416'		PUSHJ	P,TTYATI	;Attach a TTY DDB to this LDB
  2180	002052'	254000	002060'		  JRST	NEWTER		;No free TTY DDB's
  2181	002053'	201300	000000*		MOVEI	T1,CMFCXN##	;Forced command index for LOGIN
  2182	002054'	324740	014046'		PJRST	TTFORC		;Force a LOGIN command on this port
  2183
  2184				NEWJER:	MOVEI	T1,[ASCIZ /
  2185				frame capacity exceeded
  2186	002055'	201300	017301'	/]
  2187	002056'	260040	000000*		PUSHJ	P,CONMES##	;Type out error message
  2188	002057'	324740	015372'		PJRST	TTYZAP		;Kill off TTY
  2189
  2190				NEWTER:	MOVEI	T1,[ASCIZ /
  2191				port capacity exceeded
  2192	002060'	201300	017307'	/]
  2193	002061'	260040	002056*		PUSHJ	P,CONMES##	;Type out error message
  2194	002062'	324740	000000*		PJRST	FRMKJF##	;Free up frame slot and kill off TTY
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 41
SCNSER.MAC	25-JAN-91 22:40		HERE ON A LOGIN CHARACTER (ONE OF FIRST 4 ON LINE)

  2195				;TERMINAL ID CODE = INITIAL TERMINAL CHARACTERISTICS TABLE
  2196
  2197				DEFINE TERCH (IBM,FAST,F1,F2,WIDTH)
  2198					<BYTE (1) IBM,FAST (22) 0 (8) WIDTH (2) F2,F1>
  2199
  2200	002063'	200000	002400	TRMTAB:	TERCH (0,1,0,0,^D80)	;0    AUX circuit
  2201	002064'	000000	002400		TERCH (0,0,0,0,^D80)	;1  A 300 baud
  2202	002065'	000000	003613		TERCH (0,0,3,2,^D120)	;2  C 300 baud printer, wide carriage, delay
  2203	002066'	000000	002205		TERCH (0,0,1,1,^D72)	;3  E 300 baud thermal printer, small delay
  2204	002067'	000000	003603		TERCH (0,0,3,0,^D120)	;4  G 300 baud belt printer (GE Terminet), delay
  2205	002070'	000000	002205		TERCH (0,0,1,1,^D72)	;5  B 150 baud Teletype 37, no parity
  2206	002071'	000000	003613		TERCH (0,0,3,2,^D120)	;6  F 150 in, 300 out, Syner-Data Beta terminal
  2207	002072'	000000	002205		TERCH (0,0,1,1,^D72)	;7  J 150 baud Teletype 37, even parity
  2208	002073'	000000	002205		TERCH (0,0,1,1,^D72)	;8 CR 300 baud IBM 3767 in 2471 mode 32.4 cps
  2209	002074'	400000	002406		TERCH (1,0,2,1,^D80)	;9 CR 134.5 baud IBM 2471 EBCDIC
  2210	002075'	000000	002205		TERCH (0,0,1,1,^D72)	;10 D 110 baud Teletype ASR-33
  2211	002076'	000000	002405		TERCH (0,0,1,1,^D80)	;11 I (was dot-matrix printer) SYNC - HSA
  2212	002077'	200000	002403		TERCH (0,1,3,0,^D80)	;12 A,G,I 1200 baud (GOUGING=1, 120 cps)
  2213	002100'	200000	002400		TERCH (0,1,0,0,^D80)	;13 Burroughs 1200 polled terminal
  2214	002101'	200000	002400		TERCH (0,1,0,0,^D80)	;14 AUX through gateway
  2215	002102'	000000	002200		TERCH (0,0,0,0,^D72)	;15 BAUDOT, 50 or 75 baud
  2216	002103'	200000	002403		TERCH (0,1,3,0,^D80)	;16 A,G,I 2400 baud (GOUGING=2, 240 cps)
  2217	002104'	200000	002400		TERCH (0,1,0,0,^D80)	;17   SYNC - Polled Terminals
  2218	002105'	200000	002400		TERCH (0,1,0,0,^D80)	;18   SYNC - Point-to-Point
  2219	002106'	200000	002403		TERCH (0,1,3,0,^D80)	;19 A,G,I 4800 baud (GOUGING=2, 240 cps)
  2220	002107'	200000	002403		TERCH (0,1,3,0,^D80)	;20 A,G,I 9600 baud (GOUGING=3, 960 cps)
  2221	002110'	200000	002403		TERCH (0,1,3,0,^D80)	;21 multiplexed PVC
  2222	002111'	200000	002403		TERCH (0,1,3,0,^D80)	;22 audio response on T-1 carrier (56000 bps)
  2223	002112'	200000	002403		TERCH (0,1,3,0,^D80)	;23 75 baud in 1200 out (VideoText)
  2224	002113'	200000	002403		TERCH (0,1,3,0,^D80)	;24   SYNC - SDLC
  2225	002114'	200000	002403		TERCH (0,1,3,0,^D80)	;25 Transaction Terminals
  2226	002115'	200000	002403		TERCH (0,1,3,0,^D80)	;26 Host originated
  2227	002116'	200000	002403		TERCH (0,1,3,0,^D80)	;27     unused
  2228	002117'	200000	002403		TERCH (0,1,3,0,^D80)	;28     unused
  2229	002120'	200000	002403		TERCH (0,1,3,0,^D80)	;29     unused
  2230	002121'	200000	002403		TERCH (0,1,3,0,^D80)	;30     unused
  2231	002122'	200000	002403		TERCH (0,1,3,0,^D80)	;31     unused
  2232								;32-63   HDX same as 0-31 but with Half Duplex
  2233
  2234			000000	TRMAUX==0	;CODE FOR AUX CIRCUIT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 42
SCNSER.MAC	25-JAN-91 22:40		HERE ON IMAGE MODE IN DEFERRED ECHO

  2235				SUBTTL	HERE ON IMAGE MODE IN DEFERRED ECHO
  2236
  2237	002123'	660400	000400	IMGDEF:	TRO T3,400	;FLAG AS IMAGE CHARACTER
  2238	002124'	201300	000002		MOVEI T1,IMGDIM
  2239	002125'	137300	000174'		DPB T1,LDPTIM	;RESET INPUT TIMER
  2240	002126'	260040	001651'		PUSHJ P,RCVCHR	;GET CHR INTO BUFFER
  2241	002127'	263040	000000		 POPJ P,
  2242	002130'	260040	006420'		PUSHJ P,IMGCNT	;COUNT. IF T3 = IMAGE BREAK, T4 := TIWKC
  2243	002131'	301440	000110	DEFCHR:	CAIL T4,TIWKC	;IF IT'S A LINE'S WORTH,
  2244	002132'	260040	016021'	DEFBRK:	PUSHJ P,LINTRP	;SET LINE TRAP BITS
  2245	002133'	350005	000014	DEFNBK:	AOS LDBECC(U)
  2246	002134'	350001	000000		AOS (P)
  2247	002135'	263040	000000		POPJ P,		;SKIP-RETURN TO START ECHOING
  2248
  2249				;HERE ON IMAGE MODE, REMOTE ECHO, BREAK ON ALL CHRS
  2250
  2251	002136'	660400	000400	IMGRMA:	TRO T3,400
  2252	002137'	201300	000002		MOVEI T1,IMGDIM
  2253	002140'	137300	000174'		DPB T1,LDPTIM
  2254	002141'	260040	001651'		PUSHJ P,RCVCHR
  2255	002142'	263040	000000		 POPJ P,
  2256	002143'	260040	006432'		PUSHJ P,IMGCHG	;CHARGE FOR AN IMAGE BREAK CHR
  2257	002144'	260040	005774'		PUSHJ P,USRWAK	;WAKE JOB IF ASLEEP
  2258	002145'	135300	000203'		LDB T1,LDPIMB
  2259	002146'	312300	000010		CAME T1,T3	;IF IT'S THE IMAGE BREAK CHARACTER,
  2260	002147'	301440	000110		CAIL T4,TIWKC	;OR IF THERE'S A LINEFULL,
  2261	002150'	260040	016021'		 PUSHJ P,LINTRP	;  SET TRAP BITS
  2262	002151'	254000	002164'		JRST IMGRM1
  2263
  2264				;HERE ON IMAGE MODE, REMOTE ECHO, NOT BREAK ON ALL
  2265
  2266	002152'	660400	000400	IMGRMT:	TRO T3,400
  2267	002153'	201300	000002		MOVEI T1,IMGDIM
  2268	002154'	137300	000174'		DPB T1,LDPTIM
  2269	002155'	260040	001651'		PUSHJ P,RCVCHR
  2270	002156'	263040	000000		 POPJ P,
  2271	002157'	260040	006420'		PUSHJ P,IMGCNT	;COUNT. IF T3 = IMAGE BREAK CHAR, T4 := TIWKC
  2272	002160'	305440	000110		CAIGE T4,TIWKC	;IF IMAGE BREAK OR A LINE'S WORTH,
  2273	002161'	254000	002164'		 JRST IMGRM1
  2274	002162'	260040	005774'		PUSHJ P,USRWAK	;  WAKE UP JOB IF ASLEEP
  2275	002163'	260040	016021'		PUSHJ P,LINTRP	;  SET TRAP BITS
  2276	002164'	202345	000013	IMGRM1:	MOVEM T2,LDBECT(U)	;FIX ECHO POINTER
  2277	002165'	350005	000012		AOS LDBTIC(U)
  2278	002166'	263040	000000		POPJ P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 43
SCNSER.MAC	25-JAN-91 22:40		NORMAL CHR DEF ECHO

  2279				SUBTTL	NORMAL CHR DEF ECHO
  2280
  2281	002167'	260040	001651'	IACT1:	PUSHJ P,RCVCHR
  2282	002170'	263040	000000		 POPJ P,
  2283	002171'	254000	002131'		JRST DEFCHR
  2284
  2285				;BREAK CHR DEF ECHO
  2286
  2287	002172'	260040	001651'	IACT2:	PUSHJ P,RCVCHR
  2288	002173'	263040	000000		 POPJ P,
  2289	002174'	205300	000001		MOVSI T1,1
  2290	002175'	272305	000015		ADDM T1,LDBBKC(U)	;RECODR BREAK CHR
  2291	002176'	402005	000007	IACT2A:	SETZM LDBBKI(U)		;RESET ^U POINTERS
  2292	002177'	202345	000006		MOVEM T2,LDBBKP(U)
  2293	002200'	254000	002132'		JRST DEFBRK
  2294
  2295				;BREAK2 CHR DEF ECHO, NOT BREAK2 MODE
  2296
  2297	002201'	260040	001651'	IACT3:	PUSHJ P,RCVCHR
  2298	002202'	263040	000000		 POPJ P,
  2299	002203'	205300	000001		MOVSI T1,1
  2300	002204'	272305	000007		ADDM T1,LDBBKI(U)
  2301	002205'	272305	000016		ADDM T1,LDBBK2(U)	;COUNT BREAK2 AND IN ^U INFO
  2302	002206'	254000	002131'		JRST DEFCHR
  2303
  2304				;BREAK2 CHR DEF ECHO, BREAK2 MODE OR BREAK ON ALL AND BREAK2
  2305
  2306	002207'	260040	001651'	IACT4:	PUSHJ P,RCVCHR
  2307	002210'	263040	000000		 POPJ P,
  2308	002211'	205300	000001		MOVSI T1,1
  2309	002212'	272305	000016		ADDM T1,LDBBK2(U)	;RECORD BREAK2
  2310	002213'	254000	002176'		JRST IACT2A		;GO RESET ^U POINTER
  2311
  2312				;NORMAL CHR, RMT ECHO, BREAK ON ALL
  2313
  2314	002214'	260040	001651'	IACT5:	PUSHJ P,RCVCHR
  2315	002215'	263040	000000		 POPJ P,
  2316	002216'	301440	000110	IACT5A:	CAIL T4,TIWKC
  2317	002217'	254000	002245'		 JRST IAC11B
  2318	002220'	254000	002246'		JRST IAC11C
  2319
  2320				;BREAK CHR, RMT ECHO, ANY BREAK MODE
  2321
  2322	002221'	260040	001651'	IACT6:	PUSHJ P,RCVCHR
  2323	002222'	263040	000000		 POPJ P,
  2324	002223'	350005	000015		AOS LDBBKC(U)	;COUNT BREAK
  2325	002224'	254000	002236'		JRST IAC10A
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 44
SCNSER.MAC	25-JAN-91 22:40		BREAK2 CHR, RMT ECHO, BREAK ON ALL, NOT BREAK2

  2326				SUBTTL	BREAK2 CHR, RMT ECHO, BREAK ON ALL, NOT BREAK2
  2327
  2328	002225'	260040	001651'	IACT7:	PUSHJ P,RCVCHR
  2329	002226'	263040	000000		 POPJ P,
  2330	002227'	350005	000016		AOS LDBBK2(U)	;COUNT BREAK2
  2331	002230'	205300	000001		MOVSI T1,1
  2332	002231'	272305	000007		ADDM T1,LDBBKI(U)	;AND IN ^U INFO
  2333	002232'	254000	002216'		JRST IACT5A
  2334
  2335				;BREAK2 CHR, RMT ECHO, BREAK2 OR BREAK ALL AND BREAK2
  2336
  2337	002233'	260040	001651'	IACT10:	PUSHJ P,RCVCHR
  2338	002234'	263040	000000		 POPJ P,
  2339	002235'	350005	000016		AOS LDBBK2(U)
  2340	002236'	402005	000007	IAC10A:	SETZM LDBBKI(U)
  2341	002237'	202345	000006		MOVEM T2,LDBBKP(U)
  2342	002240'	254000	002245'		JRST IAC11B
  2343
  2344				;BREAK CHR, RMT ECHO, BREAK OR BREAK2 MODE
  2345
  2346	002241'	260040	001651'	IACT11:	PUSHJ P,RCVCHR
  2347	002242'	263040	000000		 POPJ P,
  2348	002243'	305440	000110	IAC11A:	CAIGE T4,TIWKC	;COUNT BIG ENOUGH?
  2349	002244'	254000	002247'		 JRST IAC11D	;NO
  2350	002245'	260040	016021'	IAC11B:	PUSHJ P,LINTRP
  2351	002246'	260040	005774'	IAC11C:	PUSHJ P,USRWAK
  2352	002247'	202345	000013	IAC11D:	MOVEM T2,LDBECT(U)
  2353	002250'	350005	000012		AOS LDBTIC(U)
  2354	002251'	135300	000306'		LDB T1,CHPECH	;GET THE ECHO TYPE FIELD
  2355	002252'	256006	002270'		XCT RMTECT(T1)
  2356					PFALL RMTCNT	;NOW FALL INTO THE REMOTE ECHO CODE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 45
SCNSER.MAC	25-JAN-91 22:40		REMOTE ECHO CODE

  2357				SUBTTL	REMOTE ECHO CODE
  2358
  2359	002253'	271440	000001	RMTCNT:	ADDI T4,1	;SEVERAL JUST LDB T4,LDPPOS
  2360	002254'	606440	000400		TRNN T4,400	;TOO BIG?
  2361	002255'	137440	000175'		 DPB T4,LDPPOS	;NO RESET
  2362	002256'	603240	000006		TLNE U,LDLLCP!LDLPTP ;LOCAL COPY OR TAPE
  2363	002257'	263040	000000		 POPJ P,	;NEVER A FREE RETURN FOR THEM
  2364	002260'	135300	000170'		LDB T1,LDPWID
  2365	002261'	607240	000200		TLNN U,LDLNFC	;IF NO FREE RETURN WANTED
  2366	002262'	317440	000006		CAMG T4,T1	;OR NOT ENOUGH CHRS
  2367	002263'	263040	000000		 POPJ P,		;FINISHED
  2368	002264'	201300	000000	RMTECR:	MOVEI T1,0
  2369	002265'	137300	000175'		DPB T1,LDPPOS	;RESET POSITION TO 0
  2370	002266'	200440	005521'		MOVE T4,CRPTR
  2371	002267'	324740	002444'		PJRST RUBSTR	;PUT INTO "RUBOUT" STRING
  2372
  2373	002270'	254000	002275'	RMTECT:	JRST RMTSPA	;0 SPECIAL ACTION FOR THESE
  2374	002271'	135440	000175'		LDB T4,LDPPOS	;1 COUNT
  2375	002272'	263040	000000		POPJ P,		;2 DO NOT COUNT THIS ONE
  2376	002273'	263040	000000		POPJ P,		;3 "
  2377	002274'	135440	000175'		LDB T4,LDPPOS	;4 COUNT
  2378
  2379	002275'	135300	000165'	RMTSPA:	LDB T1,LDPMOD	;GET THE MODE WE ARE IN
  2380	002276'	135340	000311'		LDB T2,CHPSPE	;ECHO SPECIAL ACTION TYPE
  2381	002277'	256026	002300'		XCT @RMTSPT(T1)
  2382
  2383	002300'	256007	002304'	RMTSPT:	XCT RMTS10(T2)
  2384	002301'	256007	002316'		XCT RMTS94(T2)
  2385	002302'	256007	002316'		XCT RMTS94(T2)
  2386	002303'	256007	002304'		XCT RMTS10(T2)	;10 AND SUDS SAME
  2387
  2388	002304'	254000	002352'	RMTS10:	JRST RMTEXC	;^C ECHO ^C RETURN
  2389	002305'	254000	002347'		JRST RMTCR	;RETURN
  2390	002306'	254000	002356'		JRST RMTEXU	;^U  ECHO ^U
  2391	002307'	254000	002405'		JRST RMTTAB	;TAB
  2392	002310'	254000	002336'		JRST RMTALT	;ALTMODE POSSIBLE $ ECHO
  2393	002311'	254000	002371'		JRST RMTVT	;V. TAB
  2394	002312'	254000	002377'		JRST RMTFF	;FF
  2395	002313'	254000	002352'		JRST RMTEXC	;^Z  ECHO ^Z RETURN
  2396	002314'	254000	002334'		JRST RMTAL1	;175-176 POSSIBLE ALTMODE
  2397	002315'	254000	002426'		JRST RMTBSP	;BACKSPACE
  2398	002316'	263040	000000	RMTS94:	POPJ P,		;^C
  2399	002317'	254000	002347'		JRST RMTCR	;RETURN
  2400	002320'	263040	000000		POPJ P,		;^U
  2401	002321'	254000	002405'		JRST RMTTAB	;TAB
  2402	002322'	263040	000000		POPJ P,		;ALTMODE
  2403	002323'	254000	002371'		JRST RMTVT	;V. TAB
  2404	002324'	254000	002377'		JRST RMTFF	;F.F.
  2405	002325'	263040	000000		POPJ P,		;^Z
  2406	002326'	254000	002330'		JRST RMTPAT	;175-176 POSSIBLE ALTMODE
  2407	002327'	254000	002426'		JRST RMTBSP	;BACKSPACE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 46
SCNSER.MAC	25-JAN-91 22:40		REMOTE ECHO CODE

  2408	002330'	603240	000020	RMTPAT:	TLNE U,LDLLCT
  2409	002331'	263040	000000		POPJ P,		;ALTMODE, IGNORE
  2410	002332'	135440	000175'	RMTCN1:	LDB T4,LDPPOS
  2411	002333'	254000	002253'		JRST RMTCNT	;ASSUME PRINTING CHR
  2412
  2413	002334'	607240	000020	RMTAL1:	TLNN U,LDLLCT
  2414	002335'	254000	002332'		JRST RMTCN1	;ASSUME PRINTING CHR
  2415	002336'	603240	000006	RMTALT:	TLNE U,LDLPTP!LDLLCP	;NOTHING FOR THESE NUTS
  2416	002337'	263040	000000		POPJ P,
  2417	002340'	205400	020000		MOVSI T3,LXLDLR
  2418	002341'	612405	000032		TDNE T3,LDBDCX(U) ;IF USER SUPPRESSING $ ECHO
  2419	002342'	603240	020000		TLNE U,LDLCOM	;OR WE'RE AT COMMAND LEVEL
  2420	002343'	334000	000000		SKIPA		;ECHO A $
  2421	002344'	263040	000000		POPJ P,
  2422	002345'	201400	000044		MOVEI T3,"$"
  2423	002346'	254000	002364'		JRST RMTRUB	;PUT IN RBS STRING
  2424
  2425	002347'	201300	000000	RMTCR:	MOVEI T1,0
  2426	002350'	137300	000175'		DPB T1,LDPPOS
  2427	002351'	263040	000000		POPJ P,		;RETURN, JUST SET POSITION TO 0
  2428
  2429	002352'	603240	000006	RMTEXC:	TLNE U,LDLLCP!LDLPTP	;NOTHING FOR THESE NUTS
  2430	002353'	263040	000000		POPJ P,		;NOTHING WE CN DO
  2431	002354'	260040	002360'		PUSHJ P,RMTEU1	;ECHO THE ^X
  2432	002355'	254000	002264'		JRST RMTECR	;AND THE RETURN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 47
SCNSER.MAC	25-JAN-91 22:40		REMOTE ECHO CODE

  2433	002356'	603240	000006	RMTEXU:	TLNE	U,LDLLCP!LDLPTP	;NOTHING FOR THESE NUTS
  2434	002357'	263040	000000		POPJ	P,
  2435	002360'	201400	000136	RMTEU1:	MOVEI	T3,"^"
  2436	002361'	260040	002427'		PUSHJ	P,ENTRUB
  2437	002362'	135405	000013		LDB	T3,LDBECT(U)	;GET BACK CHR
  2438	002363'	660400	000100		TRO	T3,100
  2439	002364'	260040	002427'	RMTRUB:	PUSHJ	P,ENTRUB
  2440	002365'	201300	000001		MOVEI	T1,1
  2441	002366'	137300	000074'		DPB	T1,LOPRUB	;SET SEND-RUBOUT-CHARACTERS
  2442	002367'	137305	000002		DPB	T1,LDBOPB(U)	;AND NEED-OUTPUT
  2443	002370'	263040	000000		POPJ	P,
  2444
  2445	002371'	205440	020000	RMTVT:	MOVSI	T4,L2LNTB
  2446	002372'	616445	000027		TDNN	T4,LDBBYT(U)		; NO VT ECHO??
  2447	002373'	603240	000007		TLNE	U,LDLLCP!LDLPTP!LDLFRM	; DONE BY TERMINAL?
  2448	002374'	263040	000000		POPJ	P,			; THEN NO FILLERS
  2449	002375'	200440	005537'		MOVE	T4,VTFLP
  2450	002376'	324740	002444'		PJRST	RUBSTR			;GO
  2451
  2452	002377'	205440	020000	RMTFF:	MOVSI	T4,L2LNTB
  2453	002400'	616445	000027		TDNN	T4,LDBBYT(U)		; NO FF ECHO??
  2454	002401'	603240	000007		TLNE	U,LDLLCP!LDLPTP!LDLFRM	; DONE BY TERMINAL?
  2455	002402'	263040	000000		 POPJ	P,			; THEN NO FILLERS
  2456	002403'	200440	005534'		MOVE	T4,FFFLP
  2457	002404'	324740	002444'		PJRST	RUBSTR
  2458
  2459	002405'	205440	020000	RMTTAB:	MOVSI	T4,L2LNTB	;SEE IF WE SHOULD JUST IGNORE
  2460	002406'	612445	000027		TDNE	T4,LDBBYT(U)
  2461	002407'	603240	020000		TLNE	U,LDLCOM
  2462	002410'	334000	000000		 SKIPA			;TABS AS USUAL IN COMMAND MODE
  2463	002411'	263040	000000		  POPJ	P,		;YES, DO NOTHING
  2464	002412'	135440	000175'		LDB	T4,LDPPOS
  2465	002413'	603240	000016		TLNE	U,LDLLCP!LDLTAB!LDLPTP
  2466	002414'	254000	002420'		 JRST	RMTTB1		;MUST ADJUST POSITION BUT NO SPACES
  2467	002415'	405440	000007		ANDI	T4,7
  2468	002416'	200451	005571'		MOVE	T4,TABPTR(T4)
  2469	002417'	324740	002444'		PJRST	RUBSTR		;OUT OF SPACES ADJUSTS POS
  2470
  2471	002420'	200300	000011	RMTTB1:	MOVE	T1,T4		;SAVE SIZE
  2472	002421'	660440	000007		TRO	T4,7
  2473	002422'	271440	000001		ADDI	T4,1
  2474	002423'	606440	000400		TRNN	T4,400
  2475	002424'	137440	000175'		 DPB	T4,LDPPOS	;PUT BACK IF NOT OUT OF RANGE
  2476	002425'	263040	000000		POPJ	P,		;FINISHED
  2477
  2478	002426'	324740	005466'	RMTBSP:	PJRST	SPOBSP	;UPDATE CHAR COLUMN COUNTER
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 48
SCNSER.MAC	25-JAN-91 22:40		SOME ROUTINES TO HANDLE PUTTING THINGS IN THE RUBOUT STRING

  2479				SUBTTL	SOME ROUTINES TO HANDLE PUTTING THINGS IN THE RUBOUT STRING
  2480
  2481	002427'	336000	000000*	ENTRUB:	SKIPN	TTFREE##	;GIVE UP IF NO FREE BUFFERLETS
  2482	002430'	263040	000000		 POPJ	P,
  2483	002431'	336345	000023		SKIPN	T2,LDBRBI(U)
  2484	002432'	254000	002437'		 JRST	STRUB		;MUST SET THINGS UP
  2485	002433'	260040	006177'	STRUB1:	PUSHJ	P,TTPUTC
  2486	002434'	202345	000023		MOVEM	T2,LDBRBI(U)
  2487	002435'	350005	000025		AOS	LDBRBC(U)
  2488	002436'	263040	000000		POPJ	P,
  2489
  2490	002437'	260040	006243'	STRUB:	PUSHJ	P,GETCHK
  2491	002440'	202345	000023		MOVEM	T2,LDBRBI(U)
  2492	002441'	202345	000024		MOVEM	T2,LDBRBO(U)
  2493	002442'	402005	000025		SETZM	LDBRBC(U)
  2494	002443'	254000	002433'		JRST	STRUB1
  2495
  2496				;PUT IN A WHOLE STRING, BYTE POINTER IN T4
  2497
  2498	002444'	134400	000011	RUBSTR:	ILDB	T3,T4
  2499					JUMPE	T3, [		;IF WE'RE DONE WITH THE STRING,
  2500						MOVEI	T1,1
  2501						DPB	T1,LOPRUB	;SET SEND-RUBOUT-CHARACTERS
  2502						DPB	T1,LDBOPB(U)	;AND NEED-OUTPUT
  2503						POPJ	P,
  2504	002445'	322400	017315'		]
  2505	002446'	260040	002427'		PUSHJ	P,ENTRUB
  2506	002447'	254000	002444'		JRST	RUBSTR
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 49
SCNSER.MAC	25-JAN-91 22:40		BREAK2 CHR, RMT ECHO, BREAK MODE

  2507				SUBTTL	BREAK2 CHR, RMT ECHO, BREAK MODE
  2508
  2509	002450'	260040	001651'	IACT12:	PUSHJ P,RCVCHR
  2510	002451'	263040	000000		 POPJ P,
  2511	002452'	205300	000001		MOVSI T1,1
  2512	002453'	272305	000007		ADDM T1,LDBBKI(U)	;COUNT BREAK2
  2513	002454'	350005	000016		AOS LDBBK2(U)
  2514	002455'	254000	002243'		JRST IAC11A
  2515
  2516				;NORMAL CHARACTER, COMMAND MODE, REMOTE ECHO
  2517
  2518	002456'	260040	001651'	IACT13:	PUSHJ P,RCVCHR
  2519	002457'	263040	000000		 POPJ P,
  2520	002460'	254000	002474'		JRST IAC16B
  2521
  2522				;BREAK CHR, COMMAND MODE, REMOTE ECHO
  2523
  2524	002461'	260040	001651'	IACT14:	PUSHJ P,RCVCHR
  2525	002462'	263040	000000		 POPJ P,
  2526	002463'	350005	000015		AOS LDBBKC(U)
  2527	002464'	202345	000006		MOVEM T2,LDBBKP(U)
  2528	002465'	402005	000007		SETZM LDBBKI(U)	;RESET ^U POINTER
  2529	002466'	254000	002475'		JRST IAC16C
  2530
  2531				;BREAK2 CHR, COMMAND MODE, REMOTE ECHO, NOT BREAK2 MODE
  2532
  2533	002467'	260040	001651'	IACT15:	PUSHJ P,RCVCHR
  2534	002470'	263040	000000		 POPJ P,
  2535	002471'	205300	000001		MOVSI T1,1
  2536	002472'	272305	000007		ADDM T1,LDBBKI(U)
  2537	002473'	350005	000016		AOS LDBBK2(U)
  2538	002474'	301440	000110	IAC16B:	CAIL T4,TIWKC
  2539	002475'	260040	014035'	IAC16C:	 PUSHJ P,CMDWAK
  2540	002476'	254000	002247'		JRST IAC11D
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 50
SCNSER.MAC	25-JAN-91 22:40		BREAK2 CHR, COMMAND MODE, DEF ECHO, NOT BREAK2 MODE

  2541				SUBTTL	BREAK2 CHR, COMMAND MODE, DEF ECHO, NOT BREAK2 MODE
  2542
  2543	002477'	260040	001651'	IACT17:	PUSHJ P,RCVCHR
  2544	002500'	263040	000000		 POPJ P,
  2545	002501'	205300	000001		MOVSI T1,1
  2546	002502'	272305	000007		ADDM T1,LDBBKI(U)
  2547	002503'	272305	000016		ADDM T1,LDBBK2(U)	;COUNT BREAK2
  2548	002504'	254000	002133'		JRST DEFNBK
  2549
  2550				;BREAK2 CHR, COMMAND MODE, DEF ECHO, BREAK2 MODE
  2551
  2552
  2553				;NORMAL CHR, COMMAND MODE, DEF ECHO
  2554
  2555	002505'	260040	001651'	IACT21:	PUSHJ P,RCVCHR
  2556	002506'	263040	000000		 POPJ P,
  2557	002507'	254000	002133'		JRST DEFNBK
  2558
  2559				;BREAK CHR, COMMAND MODE, DEF ECHO
  2560
  2561	002510'	260040	001651'	IACT22:	PUSHJ P,RCVCHR
  2562	002511'	263040	000000		 POPJ P,
  2563	002512'	205300	000001		MOVSI T1,1
  2564	002513'	272305	000015		ADDM T1,LDBBKC(U)
  2565	002514'	402005	000007		SETZM LDBBKI(U)
  2566	002515'	202345	000006		MOVEM T2,LDBBKP(U)
  2567	002516'	254000	002133'		JRST DEFNBK
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 51
SCNSER.MAC	25-JAN-91 22:40		SPECIAL ACTION CHRACTER, ALMOST ANY MODE

  2568				SUBTTL	SPECIAL ACTION CHRACTER, ALMOST ANY MODE
  2569
  2570	002517'	135300	000165'	IACT0:	LDB T1,LDPMOD
  2571	002520'	135340	000310'		LDB T2,CHPSPI	;GET SPECIAL ACTION CODE
  2572	002521'	256026	002522'		XCT @INPACT(T1)
  2573
  2574	002522'	256007	002526'	INPACT:	XCT INPA10(T2)
  2575	002523'	256007	002547'		XCT INPA94(T2)
  2576	002524'	256007	002547'		XCT INPA94(T2)
  2577	002525'	256007	002526'		XCT INPA10(T2)
  2578
  2579	002526'	263040	000000	INPA10:	POPJ P,		;NULL, IGNORE
  2580	002527'	254000	003100'		JRST INPESC	;ESCAPE (^C)
  2581	002530'	254000	002614'		JRST INPRET	;RETURN
  2582	002531'	254000	002632'		JRST INPGOB	;OUTPUT SUPPRESS (^O)
  2583	002532'	254000	002570'		JRST INPBRK	;PUT IN AS A BREAK CHR (^Q)
  2584	002533'	254000	002646'		JRST INPDLN	;DELETE LINE (^U)
  2585	002534'	254000	002572'		JRST INPTAB	;TAB (DECIDE IF BREAK OR BREAK2)
  2586	002535'	254000	002570'		JRST INPBRK	;ALTMODE
  2587	002536'	254000	002570'		JRST INPBRK	;JUST A BREAK CHR ^^
  2588	002537'	254000	002570'		JRST INPBRK	;^_
  2589	002540'	254000	002721'		JRST INPRUB	;RUBOUT
  2590	002541'	254000	002570'		JRST INPBRK	;^A
  2591	002542'	254000	002570'		JRST INPBRK	;POSSIBLE ALTMODE
  2592	002543'	254000	002625'		JRST INPBK2	;_
  2593	002544'	254000	002570'		JRST INPBRK	;^\
  2594	002545'	254000	002577'		JRST INPBSP	;BACKSPACE
  2595	002546'	254000	003073'		JRST INPSTA	;^T
  2596
  2597	002547'	263040	000000	INPA94:	POPJ P,		;NULL, IGNORE
  2598	002550'	254000	002570'		JRST INPBRK	;^C
  2599	002551'	254000	002614'		JRST INPRET	;RETURN
  2600	002552'	254000	002570'		JRST INPBRK	;^O, BREAK CHR
  2601	002553'	254000	002646'		JRST INPDLN	;DELETE LINE (^Q)
  2602	002554'	254000	002570'		JRST INPBRK	;^U
  2603	002555'	254000	002572'		JRST INPTAB	;TAB
  2604	002556'	254000	003100'		JRST INPESC	;ALTMODE (ESCAPE CHR)
  2605	002557'	254000	002623'		JRST INPCLD	;CONVERT TO ^D (^^)
  2606	002560'	254000	003100'		JRST INPESC	;^_
  2607	002561'	263040	000000		POPJ P,		;RUBOUT, IGNORE
  2608	002562'	254000	002723'		JRST INPRB1	;^A, DELETE CHR
  2609	002563'	254000	002627'		JRST INPAL1	;POSSIBLE ALTMODE
  2610	002564'	254000	002625'		JRST INPBK2	;_
  2611	002565'	254000	002632'		JRST INPGOB	;^\
  2612	002566'	254000	002601'		JRST INPBS1	;BACKSPACE
  2613	002567'	254000	002570'		JRST INPBRK	;^T
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 52
SCNSER.MAC	25-JAN-91 22:40		JUST SET AS A BREAK CHARACTER (MODE 2) AND GO

  2614				SUBTTL	JUST SET AS A BREAK CHARACTER (MODE 2) AND GO
  2615
  2616	002570'	201340	000002	INPBRK:	MOVEI T2,2
  2617	002571'	254000	001613'		JRST MOVCH1	;P2 (LINE MODE) STILL SETUP
  2618
  2619				;DECIDE IF TAB IS A BREAK OR BREAK2 CHARACTER
  2620
  2621	002572'	201340	000003	INPTAB:	MOVEI T2,3	;NORMALLY BREAK2
  2622	002573'	205300	100000		MOVSI T1,L2LTBK
  2623	002574'	612305	000027		TDNE T1,LDBBYT(U)
  2624	002575'	201340	000002		MOVEI T2,2	;BIT IS ON, AS A BREAK CHARACTER
  2625	002576'	254000	001613'		JRST MOVCH1
  2626
  2627				;DECIDE IF BACKSPACE IS A BREAK OR BREAK2 CHARACTER
  2628
  2629	002577'	201340	002721'	INPBSP:	MOVEI T2,INPRUB
  2630	002600'	334000	000000		SKIPA
  2631	002601'	201340	002723'	INPBS1:	MOVEI T2,INPRB1
  2632	002602'	200305	000032		MOVE T1,LDBDCX(U)
  2633	002603'	603300	100000		TLNE T1,LXLBSD	;DELETE ON BACKSPACE?
  2634	002604'	254007	000000		  JRST	(T2)	; YES
  2635	002605'	201340	000002		MOVEI T2,2	;NORMALLY BREAK
  2636	002606'	205300	040000		MOVSI T1,L2LBBP
  2637	002607'	612305	000027		TDNE T1,LDBBYT(U)
  2638	002610'	201340	000003		MOVEI T2,3	;BIT IS ON, AS A BREAK2 CHARACTER
  2639	002611'	254000	001613'		JRST MOVCH1
  2640
  2641				;CONVERT ^A INTO _ FOR TYMEX2 MDDE
  2642
  2643	002612'	201400	000137	INPTCA:	MOVEI T3,"_"
  2644	002613'	254000	002625'		JRST INPBK2
  2645
  2646				;RETURN HANDLER
  2647
  2648	002614'	201340	000001	INPRET:	MOVEI T2,1	;GET SET TO TREAT AS TYPE 1(NORMAL) CHR
  2649	002615'	603240	000002		TLNE U,LDLPTP	;IF IN PAPER TAPE MODE
  2650	002616'	254000	001613'		JRST MOVCH1	;JUST PUT IN THE CHR
  2651	002617'	260040	001613'		PUSHJ P,MOVCH1	;ELSE PUT IT IN
  2652	002620'	255000	000000		 JFCL		;IGNORE SKIP-NON SKIP
  2653	002621'	201400	000012		MOVEI T3,12
  2654	002622'	254000	001606'		JRST MOVCHR	;AND THEN PUT IN A LINE FEED
  2655
  2656				;HANDLE ^^ IN 940 MODE (CONVERT TO ^D)
  2657
  2658	002623'	201400	000004	INPCLD:	MOVEI T3,4
  2659	002624'	254000	001610'		JRST MOVCH2
  2660
  2661	002625'	201340	000003	INPBK2:	MOVEI T2,3
  2662	002626'	254000	001613'		JRST MOVCH1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 53
SCNSER.MAC	25-JAN-91 22:40		POSSIBLE ALTMODE (175-176) IN 940 MODE

  2663				SUBTTL	POSSIBLE ALTMODE (175-176) IN 940 MODE
  2664
  2665	002627'	607240	000020	INPAL1:	TLNN U,LDLLCT
  2666	002630'	254000	002570'		JRST INPBRK	;IN LOWER CASE MODE, JUST CALL BREAK
  2667	002631'	254000	003100'		JRST INPESC
  2668
  2669				;^O IN PDP-10 MDDE
  2670
  2671	002632'	205300	000400	INPGOB:	MOVSI T1,LDLOSU
  2672	002633'	432305	000031		XORM T1,LDBDCH(U)	;CHANGE FLAG
  2673	002634'	260040	006305'		PUSHJ P,TSETBO		;CLEAR OUTPUT BUFFER, set flag to send TYPGOB
  2674	002635'	135440	000165'		LDB T4,LDPMOD
  2675	002636'	200471	002661'		MOVE T4,@IGOBEC(T4)
  2676	002637'	603240	000004	INPOTP:	TLNE U,LDLLCP
  2677	002640'	263040	000000		POPJ P,			;BUT NEVER ANYTHING TO 2741
  2678	002641'	205300	004000		MOVSI T1,L2LDEL
  2679	002642'	616305	000027		TDNN T1,LDBBYT(U)	;ALREADY IN \'S
  2680	002643'	133000	000011		IBP T4			;NO, SKIP \ IN OUTPUT STRING
  2681	002644'	412305	000027		ANDCAM T1,LDBBYT(U)	;NOT THERE NOW IN ANY CASE
  2682	002645'	324740	002444'		PJRST RUBSTR
  2683
  2684				;^U IN PDP-10 OR ^Q IN 940
  2685
  2686	002646'	260040	006025'	INPDLN:	PUSHJ P,FULLCQ		;COMMAND OR FULL CHARACTER SET?
  2687	002647'	254000	002570'		 JRST INPBRK		;YES, BREAK CHARACTER
  2688	002650'	260040	002665'		PUSHJ P,RIDLIN		;THIS DOES ALL THE WORK
  2689	002651'	263040	000000		 POPJ P,		;NOTHING TO ECHO
  2690	002652'	135300	000165'		LDB T1,LDPMOD		;GET MODE WE ARE IN
  2691	002653'	200466	002655'		MOVE T4,@IDLNEC(T1)	;AND GET APPROPRIATE ECHO STRING
  2692	002654'	324740	002637'		PJRST INPOTP
  2693
  2694	002655'	000000	005522'	IDLNEC:	CUPTR
  2695	002656'	000000	005525'		UPARPT
  2696	002657'	000000	005525'		UPARPT
  2697	002660'	000000	005522'		CUPTR
  2698
  2699	002661'	000000	005527'	IGOBEC:	COPTR
  2700	002662'	000000	005532'		FLLBSC
  2701	002663'	000000	005532'		FLLBSC
  2702	002664'	000000	005527'		COPTR
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 54
SCNSER.MAC	25-JAN-91 22:40		GET RID OF A LINE OF TEXT. ADJUST ALL POINTERS

  2703				SUBTTL	GET RID OF A LINE OF TEXT. ADJUST ALL POINTERS
  2704
  2705	002665'	336305	000006	RIDLIN:	SKIPN T1,LDBBKP(U)	;IS THERE A ^U POINTER
  2706	002666'	324740	002715'		PJRST RIDLN3		;NO, DELETE ALL FROM BUFFER
  2707	002667'	202305	000010		MOVEM T1,LDBTIP(U)
  2708	002670'	550345	000007		HRRZ T2,LDBBKI(U)	;NUMBER OF CHRS SINCE ^U POINTER
  2709	002671'	213000	000007		MOVNS T2
  2710	002672'	270345	000014		ADD T2,LDBECC(U)
  2711	002673'	325340	002700'		JUMPGE T2,RIDLN1	;NONE ECHOED
  2712	002674'	272345	000012		ADDM T2,LDBTIC(U)	;REMOVE SOME FROM INPUT
  2713	002675'	201340	000000		MOVEI T2,0
  2714	002676'	202305	000013		MOVEM T1,LDBECT(U)	;RESET ECHO POINTER
  2715	002677'	350001	000000		AOS (P)			;SKIP RETURN FOR ECHO ^U
  2716	002700'	202345	000014	RIDLN1:	MOVEM T2,LDBECC(U)
  2717	002701'	554345	000007		HLRZ T2,LDBBKI(U)	;GET NUMBER OF BREAK2 CHRS
  2718	002702'	402005	000007		SETZM LDBBKI(U)		;AND GET RID OF OLD COUNTS
  2719	002703'	213000	000007		MOVNS T2
  2720	002704'	517000	000007		HRLZS T2
  2721	002705'	270345	000016		ADD T2,LDBBK2(U)	;FIX NUMBER NOT ECHOED
  2722	002706'	325340	002713'		JUMPGE T2,RIDLN2	;ALL IN NOT ECHOED
  2723	002707'	567000	000007		HLROS T2
  2724	002710'	270345	000016		ADD T2,LDBBK2(U)	;FIX NUMBER ECHOED
  2725	002711'	552345	000016		HRRZM T2,LDBBK2(U)
  2726	002712'	263040	000000		POPJ P,
  2727
  2728	002713'	202345	000016	RIDLN2:	MOVEM T2,LDBBK2(U)
  2729	002714'	263040	000000		POPJ P,
  2730
  2731	002715'	332005	000014	RIDLN3:	SKIPE LDBECC(U)		;ALSO ECHO IF NOT CHRS AT ALL
  2732	002716'	332005	000012		SKIPE LDBTIC(U)		;ANY CHARACTERS ECHOED?
  2733	002717'	350001	000000		AOS (P)			;SET SKIP RETURN
  2734	002720'	324740	006257'		PJRST TSETBI
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 55
SCNSER.MAC	25-JAN-91 22:40		RUBOUT FROM PDP-10 MODE. 940 ^A JUST DOES NOT CHECK XON

  2735				SUBTTL	RUBOUT FROM PDP-10 MODE. 940 ^A JUST DOES NOT CHECK XON
  2736
  2737	002721'	603240	000002	INPRUB:	TLNE U,LDLPTP
  2738	002722'	263040	000000		POPJ P,			;IGNORE RUBOUTS IN XON MODE
  2739	002723'	260040	006025'	INPRB1:	PUSHJ P,FULLCQ
  2740	002724'	254000	002570'		 JRST INPBRK		;JUST CALL IT A BREAK CHR
  2741	002725'	260040	002776'		PUSHJ P,INPRBC		;COMMON RUBOUT ROUTINE
  2742	002726'	254000	003071'		 JRST INPRB2	;NO CHRS, GIVE RETURN
  2743	002727'	263040	000000		 POPJ P,		;NOT ECHOED
  2744	002730'	201400	000134		MOVEI T3,"\"
  2745	002731'	200445	000027		MOVE	T4, LDBBYT(U)
  2746	002732'	607440	001000		TLNN	T4, L2LBSP	;BACKSPACE FOR CHAR DELETE?
  2747	002733'	254000	002751'		JRST	INPRB7		;NO
  2748	002734'	200300	017020'		MOVE	T1,INPCH
  2749	002735'	302300	000010		CAIE	T1, 10		;IS IT BACKSPACE?
  2750	002736'	306300	000210		CAIN	T1, 210
  2751	002737'	254000	002760'		JRST	INPRB9		;YES
  2752	002740'	200445	000032		MOVE	T4, LDBDCX(U)
  2753	002741'	607440	040000		TLNN	T4, LXLERA	;<BS><SP><BS> OR JUST <BS>?
  2754	002742'	254000	002747'		JRST	INPRB6
  2755	002743'	201400	000010		MOVEI	T3, 10		;<BS>
  2756	002744'	260040	002427'		PUSHJ	P, ENTRUB
  2757	002745'	201400	000040		MOVEI	T3, 40		;<SP>
  2758	002746'	260040	002427'		PUSHJ	P, ENTRUB
  2759	002747'	201400	000010	INPRB6:	MOVEI	T3, 10		;<BS>
  2760	002750'	254000	002763'		JRST	INPRB8
  2761	002751'	667440	004000	INPRB7:	TLON T4,L2LDEL
  2762	002752'	260040	002427'		PUSHJ P,ENTRUB		;NO, ENTER
  2763	002753'	202445	000027		MOVEM T4,LDBBYT(U)	;AND MAKE SURE WE REMEMBER IT
  2764	002754'	200400	017020'		MOVE T3,INPCH
  2765	002755'	405400	000177		ANDI	T3, 177		;STRIP OFF PARITY BIT
  2766	002756'	302400	000010		CAIE	T3, 10		;IS IT BACKSPACE?
  2767	002757'	254000	002763'		JRST	INPRB8		;NO
  2768	002760'	201400	000040	INPRB9:	MOVEI	T3,40		;YES, SUBSTITUTE <SP> FOR <BS>
  2769	002761'	135300	000021'		LDB	T1, LDPECH
  2770	002762'	332000	000006		SKIPE	T1		;PRINT NOTHING IF NO REM BS ECHO
  2771	002763'	260040	002427'	INPRB8:	PUSHJ P,ENTRUB
  2772	002764'	201300	000001		MOVEI	T1,1
  2773	002765'	137300	000074'		DPB	T1,LOPRUB	;SET SEND-RUBOUT-CHARACTERS
  2774	002766'	137305	000002		DPB	T1,LDBOPB(U)	;AND NEED-OUTPUT
  2775	002767'	263040	000000		POPJ	P,
  2776
  2777				;HERE FROM _ IN TYMEX2 MODE
  2778
  2779	002770'	260040	006025'	INPRT2:	PUSHJ P,FULLCQ
  2780	002771'	254000	002625'		 JRST INPBK2	;JUST TREAT AS A CHR
  2781	002772'	260040	002776'		PUSHJ P,INPRBC
  2782	002773'	263040	000000		 POPJ P,
  2783	002774'	263040	000000		 POPJ P,
  2784	002775'	263040	000000		POPJ P,		;NEVER ANY ECHO
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 56
SCNSER.MAC	25-JAN-91 22:40		RUBOUT FROM PDP-10 MODE. 940 ^A JUST DOES NOT CHECK XON

  2785	002776'	550305	000007	INPRBC:	HRRZ T1,LDBBKI(U)
  2786	002777'	322300	001753*		JUMPE T1,CPOPJ		;JUST GIVE RETURN
  2787	003000'	350001	000000		AOS (P)
  2788	003001'	135405	000010		LDB T3,LDBTIP(U)	;GET LAST CHARACTER INPUT
  2789	003002'	202400	017020'		MOVEM T3,INPCH	;AND SAVE
  2790	003003'	370005	000007		SOS LDBBKI(U)
  2791	003004'	370345	000010		SOS T2,LDBTIP(U)	;NOW REALLY BACK UP
  2792					REPEAT 2,<IBP T2>	;NOW GET READY TO ADVANCE ON PREV.
  2793	003005'	133000	000007
  2794	003006'	133000	000007
  2795	003007'	260040	006152'		PUSHJ P,TTGETC
  2796	003010'	255000	000000		 JFCL			;DO NOT CARE IF PASS OVER LINK
  2797	003011'	202345	000010		MOVEM T2,LDBTIP(U)	;THAT WAS JUST IN CASE WE BACKED OVER LINK
  2798	003012'	371005	000014		SOSL LDBECC(U)
  2799					JRST [MOVSI T4,-1	;WAITING TO BE ECHOED, FORGET IT
  2800	003013'	254000	017321'			JRST INPRB4]
  2801	003014'	402005	000014		SETZM LDBECC(U)
  2802	003015'	370005	000012		SOS LDBTIC(U)
  2803	003016'	202345	000013		MOVEM T2,LDBECT(U)	;RESET ECHO POINTER TO INPUT
  2804	003017'	607240	020000		TLNN U,LDLCOM	;IF AT COMMAND IGNORE ECHO
  2805	003020'	607240	000100		TLNN U,LDLNEC	;IF NOT ECHOING, NO ECHO
  2806	003021'	603240	000004		TLNE U,LDLLCP	;BUT NEVER ECHO LOCAL COPY
  2807	003022'	254000	003024'		JRST INPRB3		;DUMP CHR
  2808	003023'	350001	000000		AOS (P)
  2809	003024'	211440	000001	INPRB3:	MOVNI T4,1		;T4 WILL HAVE THING TO ADD TO BK2
  2810	003025'	200400	017020'	INPRB4:	MOVE T3,INPCH
  2811	003026'	620400	000200		TRZ T3,200
  2812	003027'	602400	000400		TRNE T3,400
  2813	003030'	263040	000000		POPJ P,		;IMAGE MODE CHRS NEVER COUNT
  2814	003031'	200710	000312'		MOVE P3,CHRTAB(T3)
  2815	003032'	135300	000302'		LDB T1,CHPINP
  2816	003033'	256006	003037'		XCT INPRTB(T1)		;WANT ONLY BREAK2 CHRS
  2817	003034'	205300	777777	INPRB5:	MOVSI T1,-1		;WILL HAV SOS'ED CORRECT HALF OF LDBBK2
  2818	003035'	272305	000007		ADDM T1,LDBBKI(U)
  2819	003036'	263040	000000		POPJ P,
  2820
  2821	003037'	254000	003043'	INPRTB:	JRST INPRAC	;MUST WORRY ABOUT TAB
  2822	003040'	263040	000000		POPJ P,		;NORMAL CHR
  2823	003041'	263040	000000		POPJ P,		;BREAK CHR
  2824	003042'	272445	000016		ADDM T4,LDBBK2(U) ;BREAK 2
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 57
SCNSER.MAC	25-JAN-91 22:40		RUBOUT FROM PDP-10 MODE. 940 ^A JUST DOES NOT CHECK XON

  2825	003043'	135300	000310'	INPRAC:	LDB T1,CHPSPI
  2826	003044'	256006	003051'		XCT INPRTA(T1)
  2827	003045'	612305	000027		TDNE T1,LDBBYT(U)	;HERE ONLY FOR TAB WITH T1=L2LTBK
  2828	003046'	263040	000000		POPJ P,			;TREAT AS BREAK
  2829	003047'	272445	000016	INPRA1:	ADDM T4,LDBBK2(U)
  2830	003050'	254000	003034'		JRST INPRB5
  2831
  2832	003051'			INPRTA:	REPEAT 6,<POPJ P,>
  2833	003051'	263040	000000
  2834	003052'	263040	000000
  2835	003053'	263040	000000
  2836	003054'	263040	000000
  2837	003055'	263040	000000
  2838	003056'	263040	000000
  2839	003057'	205300	100000		MOVSI T1,L2LTBK
  2840					REPEAT 6,<POPJ P,>
  2841	003060'	263040	000000
  2842	003061'	263040	000000
  2843	003062'	263040	000000
  2844	003063'	263040	000000
  2845	003064'	263040	000000
  2846	003065'	263040	000000
  2847	003066'	201300	000000		MOVEI T1,0	;_ ALWAYS BREAK2
  2848	003067'	263040	000000		POPJ P,		;^\
  2849					JRST	[MOVSI T1,L2LBBP
  2850						 TDNN T1,LDBBYT(U)	;TEST BACKSPACE BREAK FLAG
  2851						 POPJ P,		;TREAT AS BREAK
  2852	003070'	254000	017323'			 JRST INPRA1]		;TREAT AS BREAK2
  2853
  2854	003071'	200440	005532'	INPRB2:	MOVE T4,FLLBSC
  2855	003072'	254000	002637'		JRST INPOTP
  2856
  2857				;;
  2858				;; Here on ^T in PDP-10 mode, to see if it should be interpreted as
  2859				;; a .USESTAT command.
  2860				;;
  2861	003073'	205300	002000	INPSTA:	MOVSI	T1,LXLRTC
  2862	003074'	616305	000032		TDNN	T1,LDBDCX(U)	;Special ^T mode set?
  2863	003075'	254000	002570'		  JRST	INPBRK		;No, just treat as break
  2864	003076'	201300	000000*		MOVEI	T1,CMFSTA##	;Forced command code for .USESTAT
  2865	003077'	324740	014046'		PJRST	TTFORC
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 58
SCNSER.MAC	25-JAN-91 22:40		ESCAPE CHARACTER 940 IS ^_ OR POSSIBLY ALTMODE, PDP-10 IS ^C

  2866				SUBTTL	ESCAPE CHARACTER 940 IS ^_ OR POSSIBLY ALTMODE, PDP-10 IS ^C
  2867
  2868	003100'	260040	016033'	INPESC:	PUSHJ P,ESCTRP		;CHECK ESCAPE TRAP
  2869								;DOES DOUBLE RETURN
  2870								;(OUT OF INPESC) IF TRAP TAKEN
  2871	003101'	332005	000007		SKIPE LDBBKI(U)
  2872	003102'	260040	002665'		PUSHJ P,RIDLIN		;REMOVE LINE IF ANY
  2873	003103'	255000	000000		 JFCL			;NEVER ECHO ANYTHING
  2874	003104'	205300	200000		MOVSI T1,L2LCCS
  2875	003105'	616305	000027		TDNN T1,LDBBYT(U)	;SECOND?
  2876	003106'	254000	003127'		JRST INPES1		;NO, JUST STORE IT
  2877	003107'	260040	006032'		PUSHJ P,CNCCHK		;SEE IF CMD LEVEL, SLAVED, ETC.
  2878	003110'	254000	003125'		 JRST INPES0		;JUST STORE IT
  2879	003111'	260040	006257'		PUSHJ P,TSETBI		;CLEAR INPUT
  2880	003112'	260040	006305'		PUSHJ P,TSETBO		;AND OUTPUT BUFFERS (send TYPGOB)
  2881	003113'	205300	000400		MOVSI T1,LDLOSU	;SUPRESS OUTPUT (UNTIL WE HAVE HALTED)
  2882	003114'	436305	000031		IORM T1,LDBDCH(U)
  2883	003115'	500245	000031		HLL U,LDBDCH(U)	;MAKE SURE LINE KNOWS ABOUT IT
  2884	003116'	135300	000165'		LDB T1,LDPMOD
  2885	003117'	200466	003121'		MOVE T4,@INPEST(T1)	;GET CORRECT THING TO PRINT
  2886	003120'	324740	002637'		PJRST INPOTP
  2887
  2888	003121'	000000	005516'	INPEST:	CCPTR
  2889	003122'	000000	005532'		FLLBSC
  2890	003123'	000000	005532'		FLLBSC
  2891	003124'	000000	005516'		CCPTR
  2892
  2893	003125'	603240	020000	INPES0:	TLNE U,LDLCOM	;IF COMMAND MODE
  2894	003126'	260040	006305'		PUSHJ P,TSETBO	;CLEAR OUTPUT BUFFER
  2895	003127'	260040	002570'	INPES1:	PUSHJ P,INPBRK	;PUT IT IN AS A BREAK CHR
  2896	003130'	334000	000000		 SKIPA
  2897	003131'	350001	000000		AOS (P)		;TRANSFER SKIP RETURN TO US
  2898	003132'	205300	200000		MOVSI T1,L2LCCS
  2899	003133'	436305	000027		IORM T1,LDBBYT(U)	;SET FLAG
  2900	003134'	263040	000000		POPJ P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 59
SCNSER.MAC	25-JAN-91 22:40		MODE CONVERSION TABLE

  2901				SUBTTL MODE CONVERSION TABLE
  2902
  2903					DEFINE LMOD (ECH,INP)
  2904					<BYTE (29)0(3)ECH(4)INP>
  2905
  2906	003135'	000000	000051	MDFLMD:	LMOD 2,11
  2907	003136'	000000	000044		LMOD 2,4
  2908	003137'	000000	000043		LMOD 2,3
  2909	003140'	000000	000041		LMOD 2,1
  2910	003141'	000000	000070		LMOD 3,10
  2911	003142'	000000	000065		LMOD 3,5
  2912	003143'	000000	000063		LMOD 3,3
  2913	003144'	000000	000061		LMOD 3,1
  2914	003145'	000000	000026		LMOD 1,6
  2915	003146'	000000	000024		LMOD 1,4
  2916	003147'	000000	000022		LMOD 1,2
  2917	003150'	000000	000021		LMOD 1,1
  2918	003151'	000000	000027		LMOD 1,7
  2919	003152'	000000	000025		LMOD 1,5
  2920	003153'	000000	000022		LMOD 1,2
  2921	003154'	000000	000021		LMOD 1,1
  2922	003155'	000000	000012		LMOD 0,12
  2923	003156'	000000	000013		LMOD 0,13
  2924	003157'	000000	000012		LMOD 0,12
  2925	003160'	000000	000013		LMOD 0,13
  2926	003161'	000000	000012		LMOD 0,12
  2927	003162'	000000	000013		LMOD 0,13
  2928	003163'	000000	000012		LMOD 0,12
  2929	003164'	000000	000013		LMOD 0,13
  2930	003165'	000000	000012		LMOD 0,12
  2931	003166'	000000	000013		LMOD 0,13
  2932	003167'	000000	000012		LMOD 0,12
  2933	003170'	000000	000013		LMOD 0,13
  2934	003171'	000000	000012		LMOD 0,12
  2935	003172'	000000	000013		LMOD 0,13
  2936	003173'	000000	000012		LMOD 0,12
  2937	003174'	000000	000013		LMOD 0,13
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 60
SCNSER.MAC	25-JAN-91 22:40		OUTPUT DISPATCHER

  2938				SUBTTL OUTPUT DISPATCHER
  2939
  2940				;HERE AT CH7 TO SCAN LINTAB FOR PORTS NEEDING OUTPUT, SCAN
  2941				;LDBOUT FOR THOSE PORTS, AND DISPATCH TO THE APPROPRIATE
  2942				;OUTPUT ROUTINES
  2943
  2944	003175'	260040	004140'	SCNOUT:	PUSHJ	P,SETOUT	;PREPARE FOR TYMNET OUTPUT, skip if room
  2945	003176'	333000	017044'		  SKIPLE MULCNT+1	;ORING is full, how about PTYs
  2946	003177'	254000	003201'		 JRST	.+2		;Room in either ORING or PTY count
  2947	003200'	254000	003360'		JRST	FINOUT		;  DO NOTHING THIS CYCLE
  2948
  2949				    ;FIND THE NEXT PORT (IN A ROUND-ROBIN FASHION) THAT WANTS
  2950				    ;TO DO OUTPUT
  2951
  2952	003201'	331300	017021'		SKIPL	T1,LINPTR	;IF NO ROUND-ROBIN PTR EXISTS,
  2953	003202'	205300	000000*		 MOVSI	T1,NMXFLG	;  SET TO START AT PORT 0
  2954	003203'	202300	017021'	SCOLP1:	MOVEM	T1,LINPTR
  2955	003204'	336246	000000*		SKIPN	U,LINFLG(T1)	;IF NO NEED-OUTPUT BITS IN THIS WORD,
  2956	003205'	254000	003355'		 JRST	NOLIN2		;  GO ON TO THE NEXT ONE
  2957	003206'	200446	000000*		MOVE	T4,BITNTB(T1)	;T4/ PORT# CORRESPONDING TO BIT 0
  2958	003207'	243240	003211'	SCOLP:	JFFO	U,.+2		;T1/ BIT# OF FIRST. IF NONE,
  2959	003210'	254000	003355'		 JRST	NOLIN2		;  GO ON TO THE NEXT WORD
  2960	003211'	242246	000001		LSH	U,1(T1)		;GET RID OF THE BIT WE JUST FOUND
  2961	003212'	202240	017032'		MOVEM	U,LINFSV	;SAVE THE REST OF THE WORD
  2962	003213'	270300	000011		ADD	T1,T4		;T1/ PORT# FOR THE BIT WE JUST FOUND
  2963	003214'	202300	017031'		MOVEM	T1,LINPNM	;SAVE THAT TOO
  2964	003215'	200246	001002*		MOVE	U,LINTAB(T1)	;U/ LDB ADDR
  2965	003216'	500245	000031		HLL	U,LDBDCH(U)	;U/ DCH BITS,,LDB ADDR
  2966	003217'	305300	000674*		CAIGE	T1,RPORTN	;Is it one of the real ports?
  2967	003220'	254000	003253'		 JRST	SCORTY		;Yes
  2968					PFALL	SCOPTY		;No
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 61
SCNSER.MAC	25-JAN-91 22:40		OUTPUT DISPATCHER

  2969				   ;PREPARE TO DO OUTPUT ON A PSEUDO-PORT
  2970
  2971				;P035/C06 17-Nov-87 - Complain if LDLPTY is wrong and fix it.
  2972				;This bug is triggered by an incoming zap during login and prevented the
  2973				;outgoing zap from reaching the base, causing "slot out of ports".
  2974
  2975	003221'	667240	040000	SCOPTY:	TLON	U,LDLPTY	;P(SEUDO)TY OR R(EAL)TY?
  2976	003222'	256000	017327'		 STOPCD (.+1,INFO,TTYPTY,PRTUT1,<PTY bit wrong for TTY>)
  2977				 ;;SCOPTY+1
  2978	003223'	502245	000031		HLLM	U,LDBDCH(U)	;Reset it if LDLPTY was wrong
  2979	003224'	200300	017017'		MOVE	T1,TTFREN
  2980	003225'	303300	000003		CAILE	T1,TIRSVD	;IF NO SYSTEM BUFFERLETS
  2981	003226'	337000	017044'		SKIPG	MULCNT+1	;OR PTY "FLOW" QUOTA EXCEEDED,
  2982	003227'	254000	003352'		 JRST	NOLIN		;  MAYBE THE NEXT PORT'S A REAL TTY
  2983	003230'	260040	003442'		PUSHJ	P,SETPTL	;T1/ MAX CHARS TO XFER
  2984	003231'	201500	000001		MOVEI	W,1		;W = 1 = PTY
  2985	003232'	254000	003262'		JRST	SCOTTY
  2986
  2987				;Typeout routine for STOPCD(TTYPTY)
  2988	003233'	261040	000006	PRTUT1:	PUSH	P,T1		;Routine to output the contents of U and T1
  2989	003234'	261040	000005		PUSH	P,U
  2990	003235'	260040	001054*		PUSHJ	P,INLMES
  2991	003236'	413236	471530		 ASCIZ /Bits,,Line = /
	003237'	262315	167312
	003240'	201724	000000
  2992	003241'	262040	000006		POP	P,T1		;Contents of U
  2993	003242'	260040	000606*		PUSHJ	P,HWDPNT
  2994	003243'	260040	003235*		PUSHJ	P,INLMES
  2995	003244'	201010	367734		 ASCIZ /  Contents of T1 = /
	003245'	723135	672346
	003246'	203374	620250
	003247'	305007	520000
  2996	003250'	262040	000006		POP	P,T1		;Get saved value
  2997	003251'	260040	003242*		PUSHJ	P,HWDPNT	;Print as halfwords
  2998	003252'	324740	001071*		PJRST	CRLF##
  2999
  3000				    ;PREPARE TO DO OUTPUT ON A REAL PORT
  3001
  3002	003253'	623240	040000	SCORTY:	TLZE	U,LDLPTY	;P(SEUDO)TY OR R(EAL)TY?
  3003	003254'	256000	003222'		 STOPCD (,XCT,TTYPTY)
  3004				 ;;SCORTY+1
  3005	003255'	502245	000031		HLLM	U,LDBDCH(U)	;Reset it if LDLPTY was wrong
  3006	003256'	337000	017043'		SKIPG	MULCNT+0	;IF NO ROOM FOR REAL TTY OUTPUT,
  3007	003257'	254000	003352'		 JRST	NOLIN		;  MAYBE THE NEXT PORT'S A PTY
  3008	003260'	201300	000036		MOVEI	T1,%CHRMX	;T1/ MAX CHRS TO XMIT (EBUS02.J01 uses ^D30)
  3009	003261'	400500	000000		SETZ	W,		;W = 0 = REAL TTY
  3010					PFALL	SCOTTY
  3011
  3012				    ;LOOK FOR THE HIGHEST-PRIORITY OUTPUT REQUEST ON THE LINE
  3013
  3014	003262'	202300	017023'	SCOTTY:	MOVEM	T1,CHQTA
  3015	003263'	202300	017022'		MOVEM	T1,CHCNT
  3016	003264'	200305	000003		MOVE	T1,LDBOUT(U)	;T1/ OUTPUT BITS
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 61-2
SCNSER.MAC	25-JAN-91 22:40		OUTPUT DISPATCHER

  3017	003265'	243300	003267'		JFFO	T1,GOLIN
  3018	003266'	254000	003312'		 JRST	MORLN2		;NOTHING (THAT'S FUNNY...)
  3019	003267'	325240	003302'	GOLIN:	JUMPGE	U,GOLIN1	;IF PORT'S BACKPRESSURED
  3020	003270'	307340	000006		CAIG	T2,BPOKBN	; AND OUTPUT TYPE IS HIGH ENOUGH PRI
  3021	003271'	254000	003302'		 JRST	GOLIN1		; THEN OUTPUT IS OK
  3022	003272'	303340	000026		CAILE   T2,LAPBIT       ;BEYOND LAST LEGAL PRIORITY BIT?
  3023	003273'	254000	003312'		 JRST   MORLN2          ;YES.  ASSUME NO OUTPUT
  3024	003274'	135300	000102'		LDB	T1,LOPECO
  3025	003275'	326300	003301'		JUMPN	T1,GOLIN2	;ATTEMPT ECHO EVEN IF BACKPRESSURE ON
  3026	003276'	400300	000000	Golin3:	SETZ	T1,		;PORT IS BACKPRESSURED
  3027	003277'	137305	000002		DPB	T1,LDBOPB(U)	;  CLEAR NEED-OUTPUT
  3028	003300'	254000	003327'		JRST	FULLIN		;  AND SAY WE'RE THROUGH
  3029
  3030	003301'	201340	000024	GOLIN2:	MOVEI	T2,NUMECO	;ECHO BIT NUMBER
  3031	003302'	202340	017033'	GOLIN1:	MOVEM	T2,SVOJFF	;SAVE THE BIT NUMBER
  3032	003303'	322527	003364'		JUMPE	W,@OUTTRN(T2)	;REAL TTY DISPATCH
  3033	003304'	254027	003413'		JRST	@PTYTRN(T2)	;PSEUDO-TTY DISPATCH
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 62
SCNSER.MAC	25-JAN-91 22:40		OUTPUT DISPATCHER

  3034				    ;OUTPUT SUCCESSFUL, ROOM FOR MORE
  3035
  3036	003305'	210340	017033'	MORLIN:	MOVN	T2, SVOJFF	;T2/ -(BIT# WE DISPATCHED FOR)
  3037	003306'	205300	400000		MOVSI	T1, (1B0)
  3038	003307'	242307	000000		LSH	T1, (T2)	;T1/ BIT WE DISPATCHED FOR
  3039	003310'	413305	000003		ANDCAB	T1, LDBOUT(U)	;CLEAR IT AND PICK UP THE REST
  3040	003311'	243300	003267'		JFFO	T1, GOLIN	;IF THERE'S MORE TO DO, DO IT
  3041
  3042				    ;FINISHED WITH THE LAST OUTPUT REQUEST FOR THIS PORT
  3043
  3044	003312'	137305	000002	MORLN2:	DPB	T1, LDBOPB(U)	;CLEAR NEED-OUTPUT BIT
  3045	003313'	260040	006126'		PUSHJ	P, XMTWAK	;WAKE UP THE JOB FOR GOOD MEASURE
  3046	003314'	254000	003327'		JRST	FULLIN
  3047
  3048				    ;OUTPUT SUCCESSFUL, NO ROOM FOR MORE
  3049
  3050	003315'	210340	017033'	FINLIN:	MOVN	T2, SVOJFF
  3051	003316'	205300	400000		MOVSI	T1, (1B0)
  3052	003317'	242307	000000		LSH	T1, (T2)
  3053	003320'	413305	000003		ANDCAB	T1, LDBOUT(U)
  3054	003321'	322300	003312'		JUMPE	T1, MORLN2
  3055	003322'	254000	003327'		JRST	FULLIN
  3056
  3057				    ;OUTPUT NOT DONE BECAUSE WE'RE WAITING FOR SOMETHING
  3058				    ;(E.G., CAN'T OUTPUT ECHO CHARACTERS IF THE PORT'S NOT
  3059				    ;IN INPUT WAIT). CODE FOR "SOMETHING"S MUST TURN
  3060				    ;THE NEED-OUTPUT BIT BACK ON
  3061
  3062	003323'	201300	000000	WATLIN:	MOVEI	T1, 0
  3063	003324'	137305	000002		DPB	T1, LDBOPB(U)
  3064	003325'	260040	006126'		PUSHJ	P, XMTWAK
  3065	003326'	254000	003327'		JRST	FULLIN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 63
SCNSER.MAC	25-JAN-91 22:40		OUTPUT DISPATCHER

  3066				    ;OUTPUT NOT DONE AND/OR FINISHED WITH THIS PORT
  3067
  3068	003327'	550205	000000	FULLIN:	HRRZ	F, LDBDDB(U)
  3069	003330'	322200	003336'		JUMPE	F, FULLN2
  3070	003331'	135300	001567*		LDB	T1, PJOBN
  3071	003332'	200440	017023'		MOVE	T4, CHQTA
  3072	003333'	274440	017022'		SUB	T4, CHCNT
  3073	003334'	272446	000000*		ADDM	T4, JBTCOT(T1)
  3074	003335'	272440	003334*		ADDM	T4, JBTCOT	;System-wide # of characters output
  3075	003336'	326500	003343'	FULLN2:	JUMPN	W, FULLN3
  3076
  3077				    ;DONE WITH A REAL TTY
  3078
  3079	003337'	260040	004113'		PUSHJ	P, CLSCHR	;FINISH CHARACTER-OUTPUT MESSAGE
  3080	003340'	333000	017044'		  SKIPLE MULCNT+1	;No room in ORING.  Any PTY room?
  3081	003341'	254000	003352'		 JRST	NOLIN		;Room in ORING or room for PTY I/O
  3082	003342'	254000	003360'		JRST	FINOUT		;  QUIT
  3083
  3084				    ;DONE WITH A PTY
  3085
  3086	003343'	302500	000001	FULLN3:	CAIE	W, 1
  3087	003344'	256000	000000'		 STOPCD
  3088	003345'	260040	003476'		PUSHJ	P, CLSPTL	;FINISH CHARACTER OUTPUT
  3089	003346'	337000	017043'		SKIPG	MULCNT+0	;IF THERE'S ROOM FOR REAL PORTS
  3090	003347'	333000	017044'		SKIPLE	MULCNT+1	;OR PTYS,
  3091	003350'	254000	003352'		 JRST	NOLIN		;  GO ON
  3092	003351'	254000	003360'		JRST	FINOUT		;ELSE QUIT
  3093
  3094				    ;GO ON TO THE NEXT PORT
  3095
  3096	003352'	350440	017031'	NOLIN:	AOS	T4, LINPNM
  3097	003353'	200240	017032'		MOVE	U, LINFSV
  3098	003354'	326240	003207'		JUMPN	U, SCOLP	;TRY TO FIND ANOTHER IN GROUP
  3099	003355'	200300	017021'	NOLIN2:	MOVE	T1, LINPTR
  3100	003356'	253300	003203'		AOBJN	T1, SCOLP1	;TRY ANOTHER GROUP
  3101	003357'	402000	017021'		SETZM	LINPTR		;(START FROM BEGINNING NEXT TIME)
  3102	003360'	357000	017016'	FINOUT:	AOSG	FSCN	;(IF IT WAS 0 (NOW 1), THERE WAS NO I/O)
  3103	003361'	254000	000741'		 JRST	SCNIN	;IF I/O DONE THIS CYCLE, GO CHECK INPUT AGAIN
  3104	003362'	402000	017016'		SETZM	FSCN	;OTHERWISE, CLEAR FSCN
  3105	003363'	263040	000000		POPJ	P,	;AND RETURN (FROM SCNINT) TO THE TICK LOGIC
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 64
SCNSER.MAC	25-JAN-91 22:40		OUTPUT DISPATCH TABLES

  3106				SUBTTL	OUTPUT DISPATCH TABLES
  3107
  3108				DEFINE ZZZ(NAME), <GO'NAME>
  3109	003364'	000000	004216'	OUTTRN:	OUTBIT
  3110	003365'	000000	004610'
  3111	003366'	000000	004252'
  3112	003367'	000000	004526'
  3113	003370'	000000	004616'
  3114	003371'	000000	004323'
  3115	003372'	000000	004307'
  3116	003373'	000000	004536'
  3117	003374'	000000	004250'
  3118	003375'	000000	004260'
  3119	003376'	000000	004254'
  3120	003377'	000000	004223'
  3121	003400'	000000	004275'
  3122	003401'	000000	005330'
  3123	003402'	000000	004620'
  3124	003403'	000000	004642'
  3125	003404'	000000	004537'
  3126	003405'	000000	004672'
  3127	003406'	000000	004265'
  3128	003407'	000000	004345'
  3129	003410'	000000	004726'
  3130	003411'	000000	004702'
  3131	003412'	000000	004704'
  3132
  3133				DEFINE ZZZ(NAME), <PG'NAME>
  3134	003413'	000000	004215'	PTYTRN:	OUTBIT
  3135	003414'	000000	004051'
  3136	003415'	000000	003576'
  3137	003416'	000000	003666'
  3138	003417'	000000	003650'
  3139	003420'	000000	003606'
  3140	003421'	000000	003614'
  3141	003422'	000000	004012'
  3142	003423'	000000	003565'
  3143	003424'	000000	003566'
  3144	003425'	000000	003566'
  3145	003426'	000000	003567'
  3146	003427'	000000	004100'
  3147	003430'	000000	005330'
  3148	003431'	000000	004620'
  3149	003432'	000000	004642'
  3150	003433'	000000	003736'
  3151	003434'	000000	003620'
  3152	003435'	000000	003566'
  3153	003436'	000000	004055'
  3154	003437'	000000	004726'
  3155	003440'	000000	003565'
  3156	003441'	000000	003600'
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 65
SCNSER.MAC	25-JAN-91 22:40		PTY "OUTPUT" ROUTINES

  3157				SUBTTL PTY "OUTPUT" ROUTINES
  3158
  3159			000170	PTBSIZ==^D120
  3160
  3161				;SETPTL - CALLED WITH U/ PTY LDB TO SET UP FOR OUTPUT THENCE
  3162				;	IF THE OTHER END IS IN BLOCK INPUT WAIT, IT SETS
  3163				;	CHRWRP+1 TO POINT TO THE NEXT FREE BYTE IN THE
  3164				;	BLOCK INPUT BUFFER
  3165				;	OTHERWISE, IT SETS CHRWRP+1 TO POINT TO THE
  3166				;	PTY BUFFER
  3167				;	SETS T1/ MAX # CHARS TO MOVE
  3168
  3169	003442'	402000	017201'	SETPTL:	SETZM	PBDISC		;CHARIO DISCOUNT FOR BLOCK OUTPUT
  3170	003443'	261040	000005		PUSH	P, U
  3171	003444'	260040	007744'		PUSHJ	P, PTYBUD
  3172	003445'	201300	010000		MOVEI	T1, LDRBIP
  3173	003446'	612305	000031		TDNE	T1, LDBDCH(U)	;IF BLOCK INPUT IS IN PROGRESS,
  3174	003447'	254000	003464'		 JRST	SETPTB		;  DO THINGS DIFFERENTLY
  3175
  3176				    ;HERE WHEN OTHER END IS NOT IN BLOCK INPUT WAIT
  3177
  3178	003450'	402000	017202'		SETZM	DIDPBI
  3179	003451'	200300	017333'		MOVE	T1, [POINT 8, PTYBUF]
  3180	003452'	202300	017042'		MOVEM	T1, CHRWRP+1
  3181	003453'	200300	017117'		MOVE	T1, TIWRNN	;T1/ # CHARS ALLOWED BEFORE BACKPRESSURE
  3182	003454'	274305	000012		SUB	T1, LDBTIC(U)
  3183	003455'	274305	000014		SUB	T1, LDBECC(U)	;T1/ # MORE CHARS THAT WILL FIT
  3184	003456'	335000	000006		SKIPGE	T1		;IF WE'LL BE BACKPRESSURED,
  3185	003457'	201300	000036		 MOVEI	T1,%CHRMX	;  T1/ NORMAL (REAL TTY) LIMIT
  3186	003460'	303300	000170		CAILE	T1, PTBSIZ
  3187	003461'	201300	000170		MOVEI	T1, PTBSIZ	;MUSTN'T BE .gt. THAN THE PTY BUFFER SIZE
  3188	003462'	262040	000005		POP	P, U
  3189	003463'	263040	000000		POPJ	P,
  3190
  3191				    ;HERE WHEN THE OTHER END IS IN BLOCK INPUT WAIT
  3192
  3193	003464'	476000	017202'	SETPTB:	SETOM	DIDPBI
  3194	003465'	550305	000005		HRRZ	T1, LDBBIO(U)	;T1/ BLOCK INPUT BUFFER ADDR
  3195	003466'	332000	000006		SKIPE	T1		;IF NONE,
  3196	003467'	331006	000005		SKIPL	BIOCHR(T1)	;OR IF NO INPUT PENDING,
  3197	003470'	256000	000000'		 STOPCD 		;  DIE
  3198	003471'	200346	000002		MOVE	T2, BIOPBP(T1)	;T2/ BLOCK IDPB POINTER
  3199	003472'	202340	017042'		MOVEM	T2, CHRWRP+1
  3200	003473'	200306	000003		MOVE	T1, BIOPBC(T1)	;T1/ # BYTES LEFT THERE
  3201	003474'	262040	000005		POP	P, U
  3202	003475'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 66
SCNSER.MAC	25-JAN-91 22:40		CLSPTL - CALLED WITH U/ PTY LDB TO FINISH UP OUTPUT THITHER

  3203				SUBTTL	CLSPTL - CALLED WITH U/ PTY LDB TO FINISH UP OUTPUT THITHER
  3204				;	IF OTHER END WAS DOING BLOCK INPUT, THE CHARACTERS ARE
  3205				;	ALREADY MOVED - WE JUST NEED TO UPDATE THE BUFFER
  3206				;	POINTER&COUNT AND SEE IF WE'VE FILLED IT YET
  3207				;	OTHERWISE WE NEED TO MOVE THE CHARACTERS TO THE
  3208				;	OTHER END
  3209
  3210	003476'	200300	017201'	CLSPTL:	MOVE	T1, PBDISC
  3211	003477'	272300	017022'		ADDM	T1, CHCNT	;ADJUST CHARIO COUNT FOR BLOCK OUTPUT
  3212	003500'	332000	017202'		SKIPE	DIDPBI		;IF OTHER END WAS DOING BLOCK INPUT,
  3213	003501'	254000	003530'		JRST	CLSPTB		;  HANDLE THINGS DIFFERENTLY
  3214
  3215	003502'	200300	017042'		MOVE	T1, CHRWRP+1	;T1/ BYTE POINTER
  3216	003503'	316300	017333'		CAMN	T1, [POINT 8, PTYBUF]
  3217	003504'	263040	000000		POPJ	P,		;(NOTHING TO OUTPUT)
  3218
  3219	003505'	261040	000005		PUSH	P, U
  3220	003506'	261040	017334'		PUSH	P, [0]
  3221	003507'	261040	000006		PUSH	P, T1
  3222	003510'	261040	017333'		PUSH	P, [POINT 8, PTYBUF]
  3223
  3224				    ;-2(P) = 0 IF REM. ECHO, -1 IF DEFERRED
  3225				    ;-1(P) IS ORIGINAL ENDING BYTE POINTER
  3226				    ;  (P) IS SOURCE BYTE POINTER
  3227
  3228	003511'	260040	007744'		PUSHJ	P, PTYBUD	;U/ BUDDY'S LDB
  3229	003512'	101401	000000	CLSLP1:	UUILDB	T3, (P)		;T3/ CHAR
  3230	003513'	260040	001606'		PUSHJ	P, MOVCHR	;DEPOSIT IT
  3231	003514'	254000	003516'		  JRST	.+2
  3232	003515'	476001	777776		SETOM	-2(P)		;(ENTERED DEFERRED ECHO MODE)
  3233	003516'	200301	000000		MOVE	T1, (P)
  3234	003517'	312301	777777		CAME	T1, -1(P)
  3235	003520'	254000	003512'		JRST	CLSLP1
  3236
  3237	003521'	336301	777776		SKIPN	T1, -2(P)	;IF IT ENTERED DEFERRED ECHO MODE,
  3238	003522'	254000	003525'		JRST	CLSLP2
  3239	003523'	137300	000102'		DPB	T1, LOPECO	;  SET NEED-ECHO
  3240	003524'	137305	000002		DPB	T1, LDBOPB(U)	;  AND NEED-OUTPUT
  3241	003525'	274040	017335'	CLSLP2:	SUB	P, [3,,3]	;DISCARD THE THREE LOCALS
  3242	003526'	262040	000005		POP	P, U		;RESTORE U
  3243	003527'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 67
SCNSER.MAC	25-JAN-91 22:40		CLSPTL - CALLED WITH U/ PTY LDB TO FINISH UP OUTPUT THITHER

  3244				    ;HERE WHEN THE OTHER END WAS DOING BLOCK INPUT
  3245
  3246	003530'	261040	000005	CLSPTB:	PUSH	P, U
  3247	003531'	260040	007744'		PUSHJ	P, PTYBUD
  3248	003532'	201300	010000		MOVEI	T1, LDRBIP
  3249	003533'	616305	000031		TDNN	T1, LDBDCH(U)	;IF BLKI NO LONGER IN PROGRESS,
  3250	003534'	254000	003552'		 JRST	UPOPJ		;  NOTHING TO DO
  3251	003535'	550305	000005		HRRZ	T1, LDBBIO(U)	;T1/ BLOCK INPUT BUFFER ADDRESS
  3252	003536'	336000	000006		SKIPN	T1
  3253	003537'	256000	000000'		 STOPCD
  3254	003540'	200400	017042'		MOVE	T3, CHRWRP+1
  3255	003541'	202406	000002		MOVEM	T3, BIOPBP(T1)	;UPDATE BYTE POINTER
  3256	003542'	200400	017022'		MOVE	T3, CHCNT
  3257	003543'	274400	017023'		SUB	T3, CHQTA	;T3/ - # OF CHARACTERS MOVED
  3258	003544'	273406	000003		ADDB	T3, BIOPBC(T1)	;UPDATE BYTES-LEFT COUNT
  3259	003545'	322400	003554'		JUMPE	T3, CLSPBF	;(BUFFER FILLED)
  3260
  3261				    ;HERE WHEN WE HAVEN'T FINISHED FILLING THE BUFFER YET
  3262
  3263	003546'	337000	000010		SKIPG	T3
  3264	003547'	256000	000000'		 STOPCD 		;(WENT TOO FAR)
  3265	003550'	201300	000017		MOVEI	T1, %PBTIM
  3266	003551'	137300	000174'		DPB	T1, LDPTIM	;RESET BLOCK-INPUT TIMER
  3267	003552'	262040	000005	UPOPJ:	POP	P,U
  3268	003553'	263040	000000		POPJ	P,
  3269
  3270				    ;HERE WHEN WE'VE JUST FILLED A BLOCK INPUT BUFFER
  3271
  3272	003554'	550446	000005	CLSPBF:	HRRZ	T4, BIOCHR(T1)	;T4/ (PRESUMABLY) # CHARS MOVED
  3273	003555'	260040	001314'		PUSHJ	P, FRCIBF	;SIMULATE BUFFER-FULL MESSAGE
  3274	003556'	400300	000000		SETZ	T1,
  3275	003557'	137300	000174'		DPB	T1, LDPTIM	;CLEAR BLOCK-INPUT TIMER
  3276	003560'	201300	010000		MOVEI	T1, LDRBIP
  3277	003561'	412305	000031		ANDCAM	T1, LDBDCH(U)	;CLEAR IN-PROGRESS FLAG
  3278	003562'	262040	000005		POP	P, U
  3279	003563'	260040	001200'		PUSHJ	P, FRCNOO	;BACKPRESSURE OURSELVES
  3280	003564'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 68
SCNSER.MAC	25-JAN-91 22:40		CLSPTL - CALLED WITH U/ PTY LDB TO FINISH UP OUTPUT THITHER

  3281				    ;IMPOSSIBLE OUTPUT BITS
  3282
  3283	003565'			PGSRD:	;RED BALL
  3284	003565'			PGSGR:	;GREEN BALL
  3285	003565'	256000	000000'		 STOPCD
  3286
  3287				    ;IGNORED OUTPUT BITS
  3288
  3289	003566'			PGSEC:	;SET ECHO MODE (SHOULD ALWAYS BE OFF)
  3290	003566'			PGSTP:	;TERMINAL CHARACTERISTICS PROBE
  3291	003566'			PGHNG:	;HANG UP DATA SET
  3292	003566'	254000	003305'		JRST	MORLIN
  3293
  3294				    ;NOT IMPLEMENTED YET - IGNORE
  3295
  3296	003567'			PGSTC:	;SET TERMINAL CHARACTERISTICS
  3297	003567'	254000	003305'		JRST	MORLIN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 69
SCNSER.MAC	25-JAN-91 22:40		MSGSIM - SIMULATE INPUT-MESSAGE ARRIVAL

  3298				SUBTTL	MSGSIM - SIMULATE INPUT-MESSAGE ARRIVAL
  3299				;	CALLED WITH T1/ ADDR OF A FRC--- ROUTINE
  3300				;	CALLS <T1> WITH U/ THE CURRENT PTY'S "BUDDY"
  3301
  3302	003570'	261040	000005	MSGSIM:	PUSH	P, U		;SAVE U
  3303	003571'	260040	007744'		PUSHJ	P, PTYBUD	;U/ "BUDDY" LDB
  3304	003572'	500245	000031		HLL	U, LDBDCH(U)
  3305	003573'	260046	000000		PUSHJ	P, (T1)		;SIMULATE A <T1>-ARRIVAL
  3306	003574'	262040	000005		POP	P, U
  3307	003575'	254000	003305'		JRST	MORLIN
  3308
  3309				;CHARACTER GOBBLER
  3310
  3311	003576'	201300	001166'	PGCGB:	MOVEI	T1, FRCCGB
  3312	003577'	324740	003570'		PJRST	MSGSIM
  3313
  3314
  3315				;ORANGE BALL
  3316
  3317	003600'	205340	004000	PGSOG:	MOVSI	T2, L2LDEL
  3318	003601'	616345	000027		TDNN	T2, LDBBYT(U)	;IF WE'RE IN \...
  3319	003602'	260040	004712'		 PUSHJ	P, WTCHK	;OR WE'RE IN INPUT WAIT,
  3320	003603'	254000	003323'		  JRST	WATLIN		;  WAIT
  3321	003604'	201300	001256'		MOVEI	T1, FRCORG
  3322	003605'	324740	003570'		PJRST	MSGSIM
  3323
  3324				;BACKPRESSURE ON
  3325
  3326	003606'	201300	200000	PGBPN:	MOVEI	T1, LDRXOS
  3327	003607'	612305	000031		TDNE	T1, LDBDCH(U)	;IF WE'VE ALREADY SENT AN XOFF,
  3328	003610'	254000	003305'		 JRST	MORLIN		;  DON'T SEND ANOTHER
  3329	003611'	436305	000031		IORM	T1, LDBDCH(U)
  3330	003612'	201300	001200'		MOVEI	T1, FRCNOO
  3331	003613'	324740	003570'		PJRST	MSGSIM
  3332
  3333				;BACKPRESSURE OFF
  3334
  3335	003614'	201300	200000	PGBPF:	MOVEI	T1, LDRXOS
  3336	003615'	412305	000031		ANDCAM	T1, LDBDCH(U)	;CLEAR BACKPRESSURE-SEND FLAG
  3337	003616'	201300	001207'		MOVEI	T1, FRCDOO
  3338	003617'	324740	003570'		PJRST	MSGSIM
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 70
SCNSER.MAC	25-JAN-91 22:40		YELLOW BALL

  3339				SUBTTL	YELLOW BALL
  3340
  3341	003620'	261040	000005	PGSYL:	PUSH	P, U
  3342	003621'	260040	007744'		PUSHJ	P, PTYBUD
  3343	003622'	500245	000031		HLL	U, LDBDCH(U)
  3344	003623'	201300	010000		MOVEI	T1, LDRBIP
  3345	003624'	616305	000031		TDNN	T1, LDBDCH(U)	;IS OTHER END DOING BLOCK INPUT?
  3346	003625'	254000	003641'		 JRST	PGSYLN		;(NO)
  3347
  3348				    ;HERE WHEN THE OTHER END'S DOING BLOCK INPUT
  3349
  3350	003626'	412305	000031		ANDCAM	T1, LDBDCH(U)	;CLEAR IN-PROGRESS FLAG
  3351	003627'	550305	000005		HRRZ	T1, LDBBIO(U)
  3352	003630'	332000	000006		SKIPE	T1
  3353	003631'	331346	000005		SKIPL	T2, BIOCHR(T1)
  3354	003632'	256000	000000'		 STOPCD
  3355	003633'	550440	000007		HRRZ	T4, T2		;T4/ # CHARS TO TRANSFER
  3356	003634'	274446	000003		SUB	T4, BIOPBC(T1)	;T4/ # CHARS TRANSFERRED
  3357	003635'	260040	001334'		PUSHJ	P, FRCEOT	;FAKE A BLKI-EOT
  3358	003636'	262040	000005		POP	P, U
  3359	003637'	260040	001200'		PUSHJ	P, FRCNOO	;BACKPRESSURE OURSELVES
  3360	003640'	254000	003323'		JRST	WATLIN		;(SEND YLB WHEN BKP RELIEVED)
  3361
  3362				    ;HERE IN THE NORMAL CASE
  3363
  3364	003641'	205300	000400	PGSYLN:	MOVSI	T1, L2LOWT
  3365	003642'	436305	000027		IORM	T1, LDBBYT(U)	;SAY WE'RE WAITING
  3366	003643'	205300	002000		MOVSI	T1, L2LOWS
  3367	003644'	412305	000027		ANDCAM	T1, LDBBYT(U)	;AND THAT WE HAVEN'T SEEN ONE
  3368	003645'	260040	001266'		PUSHJ	P, FRCYEL
  3369	003646'	262040	000005		POP	P, U
  3370	003647'	254000	003305'		JRST	MORLIN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 71
SCNSER.MAC	25-JAN-91 22:40		WHEN THE PTY OUTPUT CODE FILLS UP A BLOCK INPUT BUFFER, IT

  3371				SUBTTL	WHEN THE PTY OUTPUT CODE FILLS UP A BLOCK INPUT BUFFER, IT
  3372				;FORCES BACKPRESSURE ON THE LINE DOING THE OUTPUT - THE
  3373				;REQUEST-BLOCK-INPUT AND REQUEST-BLOCK-INPUT-TERMINATION
  3374				;OUTPUT ROUTINES CLEAR THE BACKPRESSURE
  3375
  3376				;TERMINATE BLOCK INPUT
  3377
  3378	003650'	201300	010000	PGTRI:	MOVEI	T1, LDRBIP
  3379	003651'	616305	000031		TDNN	T1, LDBDCH(U)	;IF BLOCK INPUT'S IN PROGRESS,
  3380	003652'	254000	003663'		 JRST	PGTRI1
  3381	003653'	412305	000031		ANDCAM	T1, LDBDCH(U)	;  CLEAR IN-PROGRESS FLAG
  3382	003654'	550305	000005		HRRZ	T1, LDBBIO(U)	;  T1/ BLOCK INPUT BUFFER ADDR
  3383	003655'	332000	000006		SKIPE	T1
  3384	003656'	331346	017101'		SKIPL	T2, BIOCNT(T1)
  3385	003657'	256000	003674'		 STOPCD (,XCT,TTYNPB)
  3386					;No PTY Buffer for block IO  ;;PGTRI+7
  3387	003660'	550440	000007		HRRZ	T4, T2		;  T4/ # OF CHARS TO TRANSFER
  3388	003661'	274446	000003		SUB	T4, BIOPBC(T1)	;  T4/ # OF CHARS TRANFERRED
  3389	003662'	254000	003664'		JRST	.+2		;OTHERWISE
  3390	003663'	400440	000000	PGTRI1:	SETZ	T4,		;  T4/ 0 CHARS
  3391	003664'	260040	001405'		PUSHJ	P, FRCIHR	;FAKE A TERMINATED-BY-REQUEST
  3392	003665'	254000	003702'		JRST	PGBIN1		;CLEAR BACKPRESSURE ON THE OTHER END
  3393
  3394				;REQUEST BLOCK INPUT
  3395
  3396	003666'	201300	010000	PGBIN:	MOVEI	T1, LDRBIP
  3397	003667'	436305	000031		IORM	T1, LDBDCH(U)	;MARK INPUT IN PROGRESS
  3398	003670'	201300	000017		MOVEI	T1, %PBTIM
  3399	003671'	137300	000174'		DPB	T1, LDPTIM	;SET BLOCK-INPUT TIMEOUT
  3400	003672'	550305	000005		HRRZ	T1, LDBBIO(U)	;T1/ INPUT BUFFER ADDRESS
  3401	003673'	336000	000006		SKIPN	T1
  3402	003674'	256000	017336'	TTYNPB:: STOPCD (.,JOB,TTYNPB,,<No PTY Buffer for block IO>)
  3403				 ;;PGBIN+6
  3404	003675'	550346	000005		HRRZ	T2, BIOCHR(T1)	;T2/ # CHARS TO TRANSFER
  3405	003676'	202346	000003		MOVEM	T2, BIOPBC(T1)	;STORE PTY COUNT
  3406	003677'	200340	017341'		MOVE	T2, [POINT 8,BIODAT]
  3407	003700'	270340	000006		ADD	T2, T1
  3408	003701'	202346	000002		MOVEM	T2, BIOPBP(T1)	;STORE PTY BYTE POINTER
  3409
  3410				    ;HERE FROM ABOVE AND FROM PGTRI TO CLEAR BACKPRESSURE
  3411
  3412	003702'	261040	000005	PGBIN1:	PUSH	P, U
  3413	003703'	260040	007744'		PUSHJ	P, PTYBUD
  3414	003704'	500245	000031		HLL	U, LDBDCH(U)
  3415	003705'	260040	001207'		PUSHJ	P, FRCDOO	;CLEAR BACKPRESSURE ON OTHER END
  3416	003706'	262040	000005		POP	P, U
  3417	003707'	254000	003305'		JRST	MORLIN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 72
SCNSER.MAC	25-JAN-91 22:40		PBTIMO - CALLED BY SCNSEC WHEN A PORT DOING BLOCK INPUT

  3418				SUBTTL	PBTIMO - CALLED BY SCNSEC WHEN A PORT DOING BLOCK INPUT
  3419				;	   TIMES OUT.
  3420				;	   SAVES P1-P4.
  3421				;	   ASSUMES THAT FRCITM PRESERVES U AND F.
  3422
  3423	003710'	261040	000014	PBTIMO:	PUSH	P, P1
  3424	003711'	261040	000015		PUSH	P, P2
  3425	003712'	261040	000016		PUSH	P, P3
  3426	003713'	261040	000017		PUSH	P, P4
  3427
  3428	003714'	550305	000005		HRRZ	T1, LDBBIO(U)
  3429	003715'	332000	000006		SKIPE	T1
  3430	003716'	331446	000005		SKIPL	T4, BIOCHR(T1)
  3431	003717'	256000	000000'		 STOPCD 		;NO BUFFER OR NO INPUT PENDING
  3432	003720'	201340	010000		MOVEI	T2, LDRBIP
  3433	003721'	412345	000031		ANDCAM	T2, LDBDCH(U)	;CLEAR IN-PROGRESS FLAG
  3434	003722'	550440	000011		HRRZ	T4, T4		;T4/ # BYTES REQUESTED
  3435	003723'	274446	000003		SUB	T4, BIOPBC(T1)	;T4/ # BYTES TRANSFERRED
  3436	003724'	260040	001352'		PUSHJ	P, FRCITM	;FAKE A TIMEOUT MESSAGE
  3437	003725'	261040	000005		PUSH	P, U
  3438	003726'	260040	007744'		PUSHJ	P, PTYBUD
  3439	003727'	260040	001200'		PUSHJ	P, FRCNOO	;BACKPRESSURE OTHER END
  3440	003730'	262040	000005		POP	P, U
  3441
  3442	003731'	262040	000017		POP	P, P4
  3443	003732'	262040	000016		POP	P, P3
  3444	003733'	262040	000015		POP	P, P2
  3445	003734'	262040	000014		POP	P, P1
  3446	003735'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 73
SCNSER.MAC	25-JAN-91 22:40		BLOCK OUTPUT

  3447				SUBTTL	BLOCK OUTPUT
  3448
  3449	003736'	336000	017202'	PGBOT:	SKIPN	DIDPBI		;IF THE OTHER END WAS DOING BLOCK INPUT,
  3450	003737'	254000	003777'		 JRST	PGBOTC
  3451	003740'	200300	017022'		MOVE	T1, CHCNT
  3452	003741'	312300	017023'		CAME	T1, CHQTA	;AND IT HASN'T GOTTEN ANY CHARS YET,
  3453	003742'	254000	003777'		 JRST	PGBOTC
  3454	003743'	261040	000005		PUSH	P, U
  3455	003744'	260040	007744'		PUSHJ	P, PTYBUD
  3456	003745'	201300	010000		MOVEI	T1, LDRBIP
  3457	003746'	612305	000031		TDNE	T1, LDBDCH(U)	;AND IT'S STILL IN BLOCK INPUT WAIT,
  3458	003747'	254000	003752'		 JRST	PGBOT1
  3459	003750'	262040	000005		POP	P, U
  3460	003751'	254000	003777'		JRST	PGBOTC
  3461
  3462	003752'	550305	000005	PGBOT1:	HRRZ	T1, LDBBIO(U)	;  T1/ ITS BLOCK INPUT BUFFER
  3463	003753'	336000	000006		SKIPN	T1
  3464	003754'	256000	000000'		 STOPCD
  3465	003755'	550341	000000		HRRZ	T2, (P)		;  T2/ OUR LDB ADDR
  3466	003756'	554407	000005		HLRZ	T3, LDBBIO(T2)	;  T3/ OUR BLOCK OUTPUT BUFFER
  3467	003757'	336000	000010		SKIPN	T3
  3468	003760'	256000	000000'		 STOPCD
  3469	003761'	542405	000005		HRRM	T3, LDBBIO(U)	;  OUR OUTPUT = ITS INPUT
  3470	003762'	506307	000005		HRLM	T1, LDBBIO(T2)	;  ITS INPUT = OUR OUTPUT
  3471	003763'	200446	000004		MOVE	T4, BIOREQ(T1)
  3472	003764'	250450	000004		EXCH	T4, BIOREQ(T3)
  3473	003765'	202446	000004		MOVEM	T4, BIOREQ(T1)	;  BUT KEEP THE OLD BIOREQ'S
  3474	003766'	331306	000005		SKIPL	T1, BIOCHR(T1)	;  T1/ -1,,# CHARS "TRANSMITTED"
  3475	003767'	256000	000000'		 STOPCD
  3476	003770'	202310	000005		MOVEM	T1, BIOCHR(T3)	;  INPUT SIDE WANTS THE -1 FLAG
  3477	003771'	553006	000005		HRRZS	BIOCHR(T1)	;  OUTPUT SIDE DOESN'T
  3478	003772'	552300	017201'		HRRZM	T1, PBDISC	;  ALREADY CHARGED (JBTBIO), SO DISCOUNT
  3479	003773'	262040	000005		POP	P, U
  3480	003774'	402000	017022'		SETZM	CHCNT		;  WE'VE FILLED ITS BUFFER
  3481	003775'	260040	001424'		PUSHJ	P, FRCOHR	;  WE'VE DONE OUR BLOCK OUTPUT
  3482	003776'	254000	003315'		JRST	FINLIN		;  NO MORE THIS CYCLE
  3483
  3484				    ;HERE WHEN THE OTHER END'S NOT COOPERATING BY DOING BLOCK INPUT
  3485
  3486	003777'	554305	000005	PGBOTC:	HLRZ	T1, LDBBIO(U)	;T1/ BLOCK OUTPUT BUFFER
  3487	004000'	336000	000006		SKIPN	T1
  3488	004001'	256000	000000'		 STOPCD
  3489	004002'	550346	000005		HRRZ	T2, BIOCHR(T1)	;T2/ TOTAL CHARS TO TRANSFER
  3490	004003'	202346	000003		MOVEM	T2, BIOPBC(T1)	;STORE IT
  3491	004004'	200400	017341'		MOVE	T3, [POINT 8,BIODAT]
  3492	004005'	270400	000006		ADD	T3, T1		;T3/ BYTE POINTER
  3493	004006'	202406	000002		MOVEM	T3, BIOPBP(T1)	;STORE IT
  3494	004007'	201300	000001		MOVEI	T1, 1
  3495	004010'	137300	000065'		DPB	T1, LOPBOP	;SET BLOCK-OUTPUT-IN-PROGRESS
  3496	004011'	254000	003305'		JRST	MORLIN		;(DISPATCH WILL GO DO IT)
  3497				;BLOCK OUTPUT IN PROGRESS
  3498
  3499	004012'	554305	000005	PGBOP:	HLRZ	T1, LDBBIO(U)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 73-2
SCNSER.MAC	25-JAN-91 22:40		BLOCK OUTPUT

  3500	004013'	336000	000006		SKIPN	T1
  3501	004014'	256000	000000'		 STOPCD
  3502	004015'	200346	000003		MOVE	T2, BIOPBC(T1)	;T2/ COUNT
  3503	004016'	200406	000002		MOVE	T3, BIOPBP(T1)	;T3/ POINTER
  3504	004017'	200440	017044'		MOVE	T4, MULCNT+1
  3505	004020'	313440	017022'		CAMLE	T4, CHCNT
  3506	004021'	200440	017022'		MOVE	T4, CHCNT	;T4/ MIN(MULCNT+1,CHCNT)
  3507	004022'	261040	000011		PUSH	P, T4		;SAVE IT
  3508	004023'	313340	000011		CAMLE	T2, T4
  3509	004024'	200340	000011		MOVE 	T2, T4		;T4/ MIN(# TO XFER,# THAT'LL FIT)
  3510	004025'	261040	000007		PUSH	P, T2		;SAVE IT
  3511
  3512	004026'	322340	004032'		JUMPE	T2, PGBOP2
  3513	004027'	101440	000010	PGBOP1:	UUILDB	T4, T3
  3514	004030'	102440	017042'		UUIDPB	T4, CHRWRP+1
  3515	004031'	367340	004027'		SOJG	T2, PGBOP1
  3516
  3517	004032'	262040	000007	PGBOP2:	POP	P, T2
  3518	004033'	272340	017201'		ADDM	T2, PBDISC	;(TO BE DISCOUNTED FROM CHARIO CHARGE)
  3519	004034'	210440	000007		MOVN	T4, T2
  3520	004035'	272440	017044'		ADDM	T4, MULCNT+1	;DECREMENT MULCNT
  3521	004036'	272440	017022'		ADDM	T4, CHCNT	;AND CHCNT
  3522	004037'	272441	000000		ADDM	T4, (P)		;AND SAVED # THAT'LL FIT
  3523	004040'	273446	000003		ADDB	T4, BIOPBC(T1)	;AND BLOCK-BUFFER COUNT
  3524	004041'	327440	004046'		JUMPG	T4, PGBOP3	;IF WE'RE DONE
  3525	004042'	260040	001424'		PUSHJ	P, FRCOHR	;  FAKE AN OUTPUT-TERMINATED
  3526	004043'	262040	000006		POP	P, T1
  3527	004044'	323300	003315'		JUMPLE	T1, FINLIN
  3528	004045'	254000	003305'		JRST	MORLIN
  3529								;OTHERWISE,
  3530	004046'	202406	000002	PGBOP3:	MOVEM	T3, BIOPBP(T1)	;  UPDATE CHARACTER POINTER
  3531	004047'	262040	000006		POP	P, T1
  3532	004050'	254000	003327'		JRST	FULLIN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 74
SCNSER.MAC	25-JAN-91 22:40		TERMINATE BLOCK OUTPUT

  3533				SUBTTL	TERMINATE BLOCK OUTPUT
  3534
  3535	004051'	400300	000000	PGTRO:	SETZ	T1,
  3536	004052'	137300	000065'		DPB	T1, LOPBOP	;CLEAR BLKO-IN-PROGRESS
  3537	004053'	260040	001424'		PUSHJ	P, FRCOHR	;FAKE AN OUTPUT-TERMINATED
  3538	004054'	254000	003305'		JRST	MORLIN
  3539
  3540
  3541				SUBTTL	CIRCUIT ZAPPER
  3542
  3543	004055'	205300	000400	PGZAP:	MOVSI	T1,L2LOWT	;ZAP PTY
  3544	004056'	616305	000027		TDNN	T1,LDBBYT(U)	;IF WAITING FOR ORANGE BALL,
  3545	004057'	332005	000005		SKIPE	LDBBIO(U)	;OR IF BLOCK I/O NEEDS CLEANING-UP,
  3546	004060'	254000	003323'		 JRST	WATLIN		;  WAIT
  3547	004061'	403305	000026		SETZB	T1,LDBLOG(U)	;MARK THIS PORT GONE
  3548	004062'	137300	000160'		DPB	T1,LDPHST	;Clear origination host
  3549	004063'	402005	000030		SETZM	LDBMOD(U)
  3550	004064'	260040	006305'		PUSHJ	P,TSETBO
  3551	004065'	260040	006257'		PUSHJ	P,TSETBI
  3552	004066'	400300	000000		SETZ	T1,
  3553	004067'	137305	000002		DPB	T1,LDBOPB(U)	;CLEAR NEED-OUTPUT
  3554	004070'	261040	000005		PUSH	P,U
  3555	004071'	260040	007744'		PUSHJ	P,PTYBUD	;U/ "BUDDY" LDB
  3556	004072'	336005	000026		SKIPN	LDBLOG(U)	;IF IT'S ALREADY GONE,
  3557	004073'	254000	004076'		 JRST	PGZAP1		;  THERE'S NOTHING MORE TO DO
  3558	004074'	500245	000031		HLL	U,LDBDCH(U)
  3559	004075'	260040	001522'		PUSHJ	P,FRCZAP	;FAKE A ZAPPER THERE
  3560	004076'	262040	000005	PGZAP1:	POP	P,U
  3561	004077'	254000	003315'		JRST	FINLIN
  3562
  3563				;BELL (SHOULDN'T REALLY HAPPEN) - SIMULATE BLACK BALLS
  3564
  3565	004100'	350000	017135'	PGSBL:	AOS	PTYLOS		;COUNT CHARACTER LOST BY US
  3566	004101'	201300	000001		MOVEI	T1, 1
  3567	004102'	260040	001442'		PUSHJ	P, FRCLOS	;"INPUT LOST" TO BELL SENDER
  3568	004103'	261040	000005		PUSH	P, U
  3569	004104'	260040	007744'		PUSHJ	P, PTYBUD
  3570	004105'	201300	000000		MOVEI	T1, 0
  3571	004106'	260040	001442'		PUSHJ	P, FRCLOS	;"OUTPUT LOST" TO OTHER END
  3572	004107'	262040	000005		POP	P, U
  3573	004110'	550205	000000		HRRZ	F,LDBDDB(U)	;Point to TTY DDB (for stopcode processor)
  3574	004111'	256000	017342'		 STOPCD	(.+1,INFO,PTYSBL,,<PTY saw a Black Ball>)
  3575				  ;;PGSBL+10
  3576	004112'	254000	003305'		JRST	MORLIN		;(Fixed in P035/C07 - was a POPJ)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 75
SCNSER.MAC	25-JAN-91 22:40		TYMNET OUTPUT ROUTINES

  3577				SUBTTL TYMNET OUTPUT ROUTINES
  3578
  3579				;THIS ROUTINE IS CALLED TO FINISH UP OUTPUT. IT NONSKIP-RETURNS
  3580				;IF THERE IS NO BUFFER SPACE NOW.
  3581
  3582	004113'	335300	017045'	CLSCHR:	SKIPGE	T1,MXMCNT
  3583	004114'	254000	004140'		 JRST	SETOUT		;WE REALLY DON'T THINK ANY CHRS THERE
  3584	004115'	274300	017043'		SUB	T1,MULCNT+0	;COMPUTE NUMBER OUTPUT
  3585	004116'	322300	000000*		JUMPE	T1,CPOPJ1	;NONE SO MUST STILL BE SPACE
  3586	004117'	337000	017043'		SKIPG	MULCNT+0	;DID WE RUN OUT OF ROOM IN RING
  3587	004120'	370000	017022'		 SOS	CHCNT+0		;YES, ACTUALLY 1 MORE CHR OUT
  3588	004121'	476000	017016'		SETOM	FSCN		;FLAG AS SOME OUTPUT
  3589	004122'	660300	000200		TRO	T1,200		;SET BIT TO FLAG AS DATA TYPE
  3590	004123'	137300	000274'		DPB	T1,OUPTYP	;SET IN TYPE FIELD
  3591	004124'	135400	000157'		LDB	T3,LDPLNO
  3592	004125'	137400	000275'		DPB	T3,OUPLIN	;AND THE PORT NUMBER
  3593	004126'	261040	000016		PUSH	P,P3		; SAVE P3, THEN SETUP AS USUAL
  3594	004127'	200717	000703*		MOVE	P3,ORING(P4)	;  ORING(P4) contains data
  3595	004130'	260040	016501'		PUSHJ	P,ORPLOG	; Log the transmission
  3596	004131'	262040	000016		POP	P,P3		; Restore saved P3 (someone want it)
  3597	004132'	275300	000173		SUBI	T1,200-5	;COMPUT NUMBER OF WORDS USED
  3598	004133'	242300	777776		LSH	T1,-2
  3599	004134'	270740	000006		ADD	P4,T1
  3600	004135'	405740	000000*	ADVPTR:	ANDI	P4,MSKORG
  3601	004136'	202740	001036*		MOVEM	P4,ORPPDP	;SET FOR 620 TO FIND
  3602	004137'	402000	000640*		SETZM	ORPTIM##	;Reset ORING timer
  3603					PFALL	SETOUT		;AND FIND OUT ABOUT MORE SPACE
  3604
  3605
  3606				;THIS ROUTINE IS CALLED TO SET THINGS UP FOR CHARACTER
  3607				;OUTPUT. NON-SKIP RETURN MEANS NO ROOM IN OUTPUT BUFFER
  3608
  3609	004140'	476000	017045'	SETOUT:	SETOM	MXMCNT		;FLAG THAT NO ROOM THERE
  3610	004141'	476000	017043'		SETOM	MULCNT+0	;Flag that we've been here (no room?)
  3611	004142'	200740	000657*		MOVE	P4,ORP620
  3612	004143'	274740	004136*		SUB	P4,ORPPDP	;SIZE OF SPACE IN OUTPUT RING
  3613					SOJL	P4,[MOVEI P4,MSKORG+1
  3614						SKIPN	ORP620	  ;IF 620 AT 0 CAN NOT
  3615						 MOVEI	P4,MSKORG ;USE LAST WORD
  3616						SUB	P4,ORPPDP ;FIND SPACE TO END OF BUFFER
  3617						JUMPN	P4,.+2	  ;SOME REALLY THERE
  3618	004144'	361740	017345'			POPJ	P,]	  ;NOT REALLY ANY THERE
  3619	004145'	322740	002777*		JUMPE	P4,CPOPJ	;REALLY NO ROOM
  3620	004146'	242740	000002		LSH	P4,2		;CONVERT TO NUMBER OF CHARACTERS
  3621	004147'	275740	000002		SUBI	P4,2		;TAKES TWO FOR COUNT AND PORT
  3622	004150'	303740	000177		CAILE	P4,177		;COUNT MUST FIT IN BYTE SIZE-1
  3623	004151'	201740	000177		 MOVEI	P4,177
  3624	004152'	202740	017043'		MOVEM	P4,MULCNT+0	;SAVE COUNT
  3625	004153'	202740	017045'		MOVEM	P4,MXMCNT	;AND ORIGINAL (SO KNOW HOW MANY SENT)
  3626	004154'	200740	004143*		MOVE	P4,ORPPDP
  3627	004155'	201317	004127*		MOVEI	T1,ORING(P4)
  3628	004156'	505300	221000		HRLI	T1,(POINT 8,0,BYP2);SET TO PUT FIRST IN 3RD BYTE
  3629	004157'	202300	017041'		MOVEM	T1,CHRWRP+0	;SET BYTE POINTER
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 75-2
SCNSER.MAC	25-JAN-91 22:40		TYMNET OUTPUT ROUTINES

  3630	004160'	254000	004116*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 76
SCNSER.MAC	25-JAN-91 22:40		TYMNET OUTPUT ROUTINES

  3631				COMMENT !
  3632				TO OUTPUT A CHARACTER INTO THE RING (OR TO A PTY), USE THE CODE:
  3633					UUIDPB T3,CHRWRP(W)	;CHR. IN T3
  3634					SOSLE MULCNT(W)		;SEE IF OUT OF ROOM
  3635					SOSG CHCNT		;OR TIME TO STOP AND CHECK INPUT RING
  3636					 HERE IF WE SHOULD STOP
  3637					 HERE IF WE SHOULD NOT STOP
  3638				!
  3639
  3640				;OUTPUT A FULL WORD FOR SPECIAL TYPES
  3641
  3642	004161'	322500	004163'	WRDOUT:	JUMPE	W, .+2		;IF IT'S A PTY,
  3643	004162'	256000	000000'		 STOPCD 		;  THERE SHOULD BE ONLY CHAR. OUTPUT
  3644	004163'	202717	004155*		MOVEM	P3,ORING(P4)	;PUT THE WORD IN THE OUTPUT BUFFER
  3645	004164'	260040	016501'		PUSHJ	P,ORPLOG	;Put message into ORING log
  3646	004165'	476000	017016'		SETOM	FSCN
  3647	004166'	211700	000004		MOVNI	P3,4
  3648	004167'	272700	017043'		ADDM	P3,MULCNT+0	;UPDATE REAMAINING COUNTS
  3649	004170'	273700	017045'		ADDB	P3,MXMCNT	;IN CASE WE GO TO CHR OUTPUT
  3650	004171'	321700	017353'		JUMPL	P3,[AOJA P4,ADVPTR]	;WILL GET TO SETOUT, NONSKIP RETURN
  3651	004172'	350000	017041'		AOS	CHRWRP+0
  3652	004173'	271740	000001		ADDI	P4,1		;JUST ADVANCE OUTPUT POINTER
  3653	004174'	405740	004135*		ANDI	P4,MSKORG
  3654	004175'	202740	004154*		MOVEM	P4,ORPPDP	;SET FOR 620 TO FIND
  3655	004176'	254000	004160*		JRST	CPOPJ1
  3656
  3657				;OUTPUT 2 WORDS FOR SPECIAL TYPES.
  3658
  3659	004177'	322500	004201'	WRDOT2:	JUMPE	W,.+2		;IF IT'S A PTY,
  3660	004200'	256000	000000'		 STOPCD 		;  THERE SHOULD BE ONLY CHARACTER OUTPUT
  3661	004201'	202717	004163*		MOVEM	P3,ORING(P4)	;PUT 2ND WORD IN THE OUTPUT BUFFER.
  3662				;** No LOG HERE **;
  3663				;**;	PUSHJ	P,ORPLOG	;Put message into ORING log
  3664	004202'	476000	017016'		SETOM	FSCN		;FLAG THAT THERE'S SOMETHING TO DO.
  3665	004203'	211700	000010		MOVNI	P3,8		;2 WDS (8 CHARS) TO OUTPUT.
  3666	004204'	272700	017043'		ADDM	P3,MULCNT+0	;UPDATE REMAINING COUNTS
  3667	004205'	273700	017045'		ADDB	P3,MXMCNT	;IN CASE WE GO TO CHR OUTPUT
  3668	004206'	321700	017353'		JUMPL	P3,[AOJA P4,ADVPTR]	;WILL GET TO SETOUT.
  3669	004207'	350000	017041'		AOS	CHRWRP+0	;INCREMENT CHAR BYTE POINTER.
  3670	004210'	350000	017041'		AOS	CHRWRP+0	;INCREMENT IT AGAIN (PAST 2 WORDS).
  3671	004211'	271740	000001		ADDI	P4,1		;INCREMENT ORING OFFSET
  3672	004212'	405740	004174*		ANDI	P4,MSKORG
  3673	004213'	202740	004175*		MOVEM	P4,ORPPDP	;AND INFORM THE BASE.
  3674	004214'	254000	004176*		JRST	CPOPJ1		;SKIP RETURN.
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 77
SCNSER.MAC	25-JAN-91 22:40		NON-CHARACTER OUTPUT MESSAGE HANDLERS

  3675				SUBTTL NON-CHARACTER OUTPUT MESSAGE HANDLERS
  3676
  3677				;DON'T SEND ANY MESSAGES FROM THIS LINE
  3678
  3679	004215'	256000	000000'	PGHSH:	 STOPCD			;HSH NOT USED ON PTYs
  3680	004216'	135300	000101'	GOHSH:	LDB	T1,LOPZAP	;SEE IF ZAP SET
  3681	004217'	336000	000006		SKIPN	T1
  3682					 JRST	[AOS BADGUY	;COUNT BADGUYS THAT TRY TO SEND MESSAGES
  3683	004220'	254000	017354'			JRST WATLIN]	; FROM THIS PORT
  3684	004221'	260040	004421'		PUSHJ	P,CLRTTY	;DO FALSE ZAP STUFF
  3685	004222'	254000	003315'		JRST	FINLIN
  3686
  3687				;SEND TERMINAL CHARACTERISTIC(S)
  3688
  3689	004223'	260040	004113'	GOSTC:	PUSHJ	P,CLSCHR
  3690	004224'	254000	003327'		  JRST	FULLIN		;NO ROOM
  3691	004225'	200405	000050	GOSTC1:	MOVE	T3,LDBTMT(U)	;T3/TRANSMIT BITS
  3692	004226'	243400	004230'		JFFO	T3,.+2		;T4/T.C # TO SEND THIS TIME
  3693	004227'	254000	003305'		JRST	MORLIN		;NONE OR NO MORE
  3694	004230'	205700	017000		MOVSI	P3,TYPI TYPTCS	;MESSAGE TYPE
  3695	004231'	137440	000277'		DPB	T4,WRPCHR	;CHARACTERISTIC NUMBER
  3696	004232'	135311	000031'		LDB	T1,TABTMS(T4)
  3697	004233'	137300	000300'		DPB	T1,WRPCH2	;CHARACTERISTIC VALUE
  3698	004234'	205300	400000		MOVSI	T1,(1B0)
  3699	004235'	213000	000011		MOVNS	T4
  3700	004236'	242311	000000		LSH	T1,(T4)
  3701	004237'	412305	000050		ANDCAM	T1,LDBTMT(U)	;CLEAR THE TRANSMIT BIT
  3702	004240'	135400	000157'		LDB	T3,LDPLNO
  3703	004241'	137400	000276'		DPB	T3,WRPLIN	;SET PORT NUMBER IN OUTPUT WORD
  3704	004242'	260040	004161'		PUSHJ	P,WRDOUT	;SEND IT. IF THERE'S ROOM FOR MORE,
  3705	004243'	254000	004245'		  JRST	.+2
  3706	004244'	254000	004225'		JRST	GOSTC1		;  GO SEE IF THERE'S MORE TO SEND.
  3707	004245'	332005	000050		SKIPE	LDBTMT(U)	;(NO ROOM) IF THERE WERE MORE TO DO,
  3708	004246'	254000	003327'		  JRST	FULLIN		;  SAY WE'RE NOT DONE
  3709	004247'	254000	003315'		JRST	FINLIN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 78
SCNSER.MAC	25-JAN-91 22:40		SEND A RED BALL

  3710				SUBTTL	SEND A RED BALL
  3711
  3712	004250'	205700	007400	GOSRD:	MOVSI	P3,TYPI TYPRED
  3713	004251'	254000	004266'		JRST	FMTB
  3714
  3715				;SEND A CHARACTER GOBBLER
  3716
  3717	004252'	205700	005000	GOCGB:	MOVSI	P3,TYPI TYPGOB
  3718	004253'	254000	004266'		JRST	FMTB
  3719
  3720				;SEND A TERMINAL CHARACTERISTICS PROBE
  3721
  3722	004254'	205700	017400	GOSTP:	MOVSI	P3,TYPI TYPTCP	;PROBE
  3723	004255'	201400	000077		MOVEI	T3,TMCALL	;FOR ALL
  3724	004256'	137400	000277'		DPB	T3,WRPCHR
  3725	004257'	254000	004266'		JRST	FMTB
  3726
  3727				;SET ECHO MODE
  3728
  3729	004260'	205700	016000	GOSEC:	MOVSI	P3,TYPI TYPECN	;ECHO ON
  3730	004261'	200305	000031		MOVE	T1,LDBDCH(U)	;GET BOTH HALVES OF DCH
  3731	004262'	612300	017356'		TDNE	T1,[LDLNEC,,LDRDEM];DO WE WANT IT OFF INSTEAD?
  3732	004263'	205700	016400		MOVSI 	P3,TYPI TYPECF	;(YES)
  3733	004264'	254000	004266'		JRST	FMTB
  3734
  3735				;SEND SOFT ZAP (HANG UP PHONE, KEEP CIRCUIT)
  3736
  3737	004265'	205700	011000	GOHNG:	MOVSI	P3,TYPI TYPHNG
  3738					PFALL	FMTB
  3739
  3740				;FMTB -- CALLED WITH P3/ BYTE (8) TYPE, 0, XXX, XXX
  3741				;	 CLOSES CHARACTER MODE, RETURNING TO FULLIN IF NO ROOM,
  3742				;	 DEPOSITS PORT# INTO SECOND BYTE, TRANSMITS THE
  3743				;	 1-WORD MESSAGE, AND RETURNS TO THE OUTPUT DISPATCH
  3744				;FMTB1 -- ASSUMES CALLER HAS ALREADY DONE A CLSCHR
  3745
  3746	004266'	260040	004113'	FMTB:	PUSHJ	P,CLSCHR	;LEAVE CHARACTER MODE. IF NO MORE ROOM,
  3747	004267'	254000	003327'		  JRST	FULLIN		;  RETURN TO OUTPUT DISPATCH
  3748	004270'	135400	000157'	FMTB1:	LDB	T3,LDPLNO	;T3/ PORT #
  3749	004271'	137400	000276'		DPB	T3,WRPLIN	;DEPOSIT IT
  3750	004272'	260040	004161'		PUSHJ	P,WRDOUT	;SEND IT. ROOM FOR MORE?
  3751	004273'	254000	003315'		  JRST	FINLIN		;NO
  3752	004274'	254000	003305'		JRST	MORLIN		;YES
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 79
SCNSER.MAC	25-JAN-91 22:40		SEND BELL

  3753				SUBTTL	SEND BELL
  3754
  3755	004275'	200345	000031	GOSBL:	MOVE	T2,LDBDCH(U)
  3756	004276'	607240	002000		TLNN	U,LDLIMI	;IF IN IMAGE STATE,
  3757	004277'	602340	100000		TRNE	T2,LDRNXO	;OR USER SAYS NO XOFF/XON,
  3758	004300'	254000	003305'		JRST	MORLIN		;  AVOID SENDING BELLS
  3759	004301'	201400	000007		MOVEI	T3,7		;T3/ ASCII BELL
  3760					PFALL	COMXON
  3761
  3762				;COMXON - CALLED WITH T3/ A CHARACTER AND THE PORT OPEN FOR
  3763				;	   CHARACTER OUTPUT. DEPOSIT THE CHARACTER IN THE BUFFER
  3764				;	   RING AND RETURN TO THE OUTPUT DISPATCH
  3765
  3766	004302'	102412	017041'	COMXON:	UUIDPB	T3,CHRWRP(W)	;DEPOSIT THE CHARACTER
  3767	004303'	373012	017043'		SOSLE	MULCNT(W)
  3768	004304'	377000	017022'		SOSG	CHCNT
  3769	004305'	254000	003315'		 JRST	FINLIN		;NO ROOM FOR MORE
  3770	004306'	254000	003305'		JRST	MORLIN		;ROOM FOR MORE
  3771
  3772				;BACKPRESSURE OFF
  3773
  3774	004307'	201340	200000	GOBPF:	MOVEI	T2,LDRXOS
  3775	004310'	612345	000031		TDNE	T2,LDBDCH(U)	;IF WE SENT AN XOFF,
  3776	004311'	254000	004320'		  JRST	GOXON		;  GO SEND AN XON
  3777	004312'	260040	004113'		PUSHJ	P,CLSCHR
  3778	004313'	254000	003327'		  JRST	FULLIN		;NO ROOM FOR MESSAGE
  3779	004314'	201340	400000		MOVEI	T2,LDRBPS
  3780	004315'	412345	000031		ANDCAM	T2,LDBDCH(U)	;TURN OFF BACKPRESSURE-SENT FLAG
  3781	004316'	205700	004400		MOVSI	P3,TYPI TYPOUP	;P3/ MESSAGE TYPE
  3782	004317'	254000	004270'		JRST	FMTB1
  3783
  3784				    ;HERE TO SEND AN XON
  3785
  3786	004320'	412345	000031	GOXON:	ANDCAM	T2,LDBDCH(U)	;CLEAR BACKPRESSURE-SENT FLAG
  3787	004321'	201400	000021		MOVEI	T3,21		;T3/ ASCII XON
  3788	004322'	254000	004302'		JRST	COMXON		;GO SEND IT
  3789
  3790				;BACKPRESSURE ON
  3791
  3792	004323'	135300	000156'	GOBPN:	LDB	T1,TRMBYP	;T1/ TERMINAL ID #
  3793	004324'	322300	004327'		JUMPE	T1,GOBPN1	;IF AUX CIRCUIT (0), BACKPRESSURE
  3794	004325'	607240	002000		TLNN	U,LDLIMI	;OTHERWISE, IF NOT IMAGE STATE,
  3795	004326'	254000	004335'		  JRST	GOXOFF		;  SEND AN XOFF
  3796	004327'	260040	004113'	GOBPN1:	PUSHJ	P,CLSCHR
  3797	004330'	254000	003327'		  JRST	FULLIN		;NO ROOM FOR MESSAGE
  3798	004331'	201340	400000		MOVEI	T2,LDRBPS
  3799	004332'	436345	000031		IORM	T2,LDBDCH(U)	;SET BACKPRESSURE-SENT FLAG
  3800	004333'	205700	004000		MOVSI	P3,TYPI TYPNOP	;P3/ MESSAGE TYPE
  3801	004334'	254000	004270'		JRST	FMTB1
  3802
  3803				   ;HERE TO SEND AN XOFF
  3804
  3805	004335'	201300	100000	GOXOFF:	MOVEI	T1,LDRNXO
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 79-2
SCNSER.MAC	25-JAN-91 22:40		SEND BELL

  3806	004336'	201400	200000		MOVEI	T3,LDRXOS
  3807	004337'	616405	000031		TDNN	T3,LDBDCH(U)	;IF WE'VE ALREADY SENT ONE XOFF
  3808	004340'	612305	000031		TDNE	T1,LDBDCH(U)	;OR IF WE MUSTN'T SEND ANY,
  3809	004341'	254000	003305'		  JRST	MORLIN		;  JUST SAY WE'VE DONE IT
  3810	004342'	436405	000031		IORM	T3,LDBDCH(U)	;SET XOFF-SENT FLAG
  3811	004343'	201400	000023		MOVEI	T3,23		;T3/ ASCII XOFF
  3812	004344'	254000	004302'		JRST	COMXON		;GO SEND IT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 80
SCNSER.MAC	25-JAN-91 22:40		SEND CIRCUIT ZAPPER

  3813				SUBTTL	SEND CIRCUIT ZAPPER
  3814
  3815	004345'	205300	000400	GOZAP:	MOVSI	T1,L2LOWT
  3816	004346'	616305	000027		TDNN	T1,LDBBYT(U)	;IF SOMEONE'S WAITING FOR ORANGE BALL
  3817	004347'	332005	000005		SKIPE	LDBBIO(U)	;OR IF BLOCK I/O NEEDS CLEANING-UP,
  3818	004350'	254000	003323'		 JRST	WATLIN		;  WAIT
  3819	004351'	260040	004113'		PUSHJ	P,CLSCHR	;LEAVE CHAR MODE. SKIP IF ROOM.
  3820	004352'	254000	003327'		  JRST	FULLIN		;  MUST WAIT OR NO ROOM
  3821	004353'	550300	000005		HRRZ	T1,U
  3822	004354'	312300	017027'		CAME	T1,OPRLDB	;Check if zapping OPR terminal
  3823	004355'	254000	004366'		 JRST	NOTOPR
  3824	004356'	402000	017027'		SETZM	OPRLDB
  3825	004357'	402000	000000*		SETZM	DEVOPR
  3826	004360'	260040	014737'		PUSHJ	P,OPRFRE	;No more OPR
  3827	004361'	201300	400000		MOVEI	T1,STSHUT	;400000
  3828	004362'	612300	002040*		TDNE	T1,STATES	;IS SYSTEM SHUT?
  3829	004363'	254000	004366'		 JRST	NOTOPR		;YES
  3830	004364'	201300	000132		MOVEI	T1,^D90
  3831	004365'	202300	017035'		MOVEM	T1,OPRTIM	;NO, SET TIMER FOR UNHAPPY MSG
  3832	004366'	607240	040040	NOTOPR:	TLNN	U,LDLAUX!LDLPTY	;THIS ONE WAS NOT COUNTED ANYWAY
  3833	004367'	331005	000026		SKIPL	LDBLOG(U)
  3834	004370'	254000	004376'		 JRST	NOTLIN		;NOT REALLY IN
  3835	004371'	201300	200000		MOVEI	T1,STSUPR	;200000
  3836	004372'	377000	017034'		SOSG	INTERM
  3837	004373'	332000	017113'		SKIPE	DWNFLG
  3838	004374'	334000	000000		 SKIPA			;DO NOT RESET IF COMING DOWN
  3839	004375'	412300	004362*		ANDCAM T1,STATES	;CAN'T BE SUPER SHUT WITH EVERYONE GONE
  3840	004376'			NOTLIN:
  3841					;Here to put ZAP message in the ORING
  3842
  3843	004376'	403305	000026		SETZB	T1,LDBLOG(U)	;CLEAR LOGGED IN INFO
  3844	004377'	137300	000160'		DPB	T1,LDPHST	;Clear origination host
  3845	004400'	402005	000030		SETZM	LDBMOD(U)	;RESET MODE TO LOGIN MODE
  3846	004401'	260040	006305'		PUSHJ	P,TSETBO	;Flush output buffer (free TTY chunks)
  3847	004402'	260040	006257'		PUSHJ	P,TSETBI	;ALSO CLEAR INPUT BUFFER
  3848	004403'	200305	000001		MOVE	T1,LDBLIN(U)
  3849	004404'	623300	400000		TLZE	T1,LNLZIN
  3850	004405'	350000	017146'		 AOS	NZAPOT		;AN IN-ZAP WAS RESPONDED TO
  3851	004406'	202305	000001		MOVEM	T1,LDBLIN(U)
  3852	004407'	403305	000003		SETZB	T1,LDBOUT(U)	;Cancel LOPCGB that was set by TSETBO
  3853	004410'	137305	000002		DPB	T1,LDBOPB(U)	;NOTHING MORE TO DO ON OUTPUT
  3854	004411'	205700	005400		MOVSI	P3,TYPI TYPZAP
  3855	004412'	135340	000157'		LDB	T2,LDPLNO
  3856	004413'	137340	000276'		DPB	T2,WRPLIN	;Port # in 2nd byte
  3857	004414'	301340	003217*		CAIL	T2,RPORTN##	;(if RPORTN=200, then only 0-177 are legal)
  3858	004415'	256000	000000'		 STOPCD 		;CRASH- ZAPPING BEYOND HIGHEST REAL PORT
  3859	004416'	260040	004161'		PUSHJ	P,WRDOUT	;Store in ORING
  3860	004417'	255000	000000		  JFCL			;Don't care if ORING is now full
  3861	004420'	254000	003315'		JRST	FINLIN		;NOBODY LEFT TO TALK TO
  3862
  3863	004421'	550300	000005	CLRTTY:	HRRZ	T1,U		;FALSE ZAP STUFF FOR REAL TTYs
  3864	004422'	312300	017027'		CAME	T1,OPRLDB
  3865	004423'	254000	004434'		 JRST	NTTOPR
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 80-2
SCNSER.MAC	25-JAN-91 22:40		SEND CIRCUIT ZAPPER

  3866	004424'	402000	017027'		SETZM	OPRLDB		;OPR terminal has been zapped
  3867	004425'	402000	004357*		SETZM	DEVOPR
  3868	004426'	260040	014737'		PUSHJ	P,OPRFRE
  3869	004427'	201300	400000		MOVEI	T1,STSHUT	;400000
  3870	004430'	612300	004375*		TDNE	T1,STATES	;IS SYSTEM SHUT?
  3871	004431'	254000	004434'		 JRST	NTTOPR		;YES
  3872	004432'	201300	000132		MOVEI	T1,^D90
  3873	004433'	202300	017035'		MOVEM	T1,OPRTIM	;NO, SET TIMER FOR UNHAPPY MSG
  3874	004434'	607240	000040	NTTOPR:	TLNN	U,LDLAUX	;THIS ONE WAS NOT COUNTED ANYWAY
  3875	004435'	331005	000026		SKIPL	LDBLOG(U)
  3876	004436'	254000	004444'		 JRST	CLRPTY		;NOT REALLY IN
  3877	004437'	201300	200000		MOVEI	T1,STSUPR	;200000
  3878	004440'	377000	017034'		SOSG	INTERM
  3879	004441'	332000	017113'		SKIPE	DWNFLG
  3880	004442'	334000	000000		 SKIPA			;DO NOT RESET IF COMING DOWN
  3881	004443'	412300	004430*		  ANDCAM T1,STATES	;CAN'T BE SUPER SHUT WITH EVERYONE GONE
  3882	004444'			CLRPTY:				;FALSE ZAP ENTRY FOR PTYs
  3883	004444'	403305	000026		SETZB	T1,LDBLOG(U)	;CLEAR LOGGED IN INFO
  3884	004445'	137300	000160'		DPB	T1,LDPHST	;Clear origination host number
  3885	004446'	402005	000030		SETZM	LDBMOD(U)	;RESET MODE TO LOGIN MODE
  3886	004447'	260040	006305'		PUSHJ	P,TSETBO
  3887	004450'	260040	006257'		PUSHJ	P,TSETBI	;ALSO CLEAR INPUT
  3888	004451'	200305	000001		MOVE	T1,LDBLIN(U)
  3889	004452'	623300	400000		TLZE	T1,LNLZIN
  3890	004453'	350000	017146'		 AOS	NZAPOT		;AN IN-ZAP WAS RESPONDED TO
  3891	004454'	202305	000001		MOVEM	T1,LDBLIN(U)
  3892	004455'	403305	000003		SETZB	T1,LDBOUT(U)	;CLEAR 'SEND SPECIAL MESSAGE' FLAGS
  3893	004456'	137305	000002		DPB	T1,LDBOPB(U)	;NOTHING MORE TO DO ON OUTPUT
  3894	004457'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 81
SCNSER.MAC	25-JAN-91 22:40		HERE ON A DETECTED ZAPPER ANOMALY TO STORE STUFF ABOUT THE PORT

  3895				SUBTTL	HERE ON A DETECTED ZAPPER ANOMALY TO STORE STUFF ABOUT THE PORT
  3896
  3897	004460'	000000	000000	ZBGBUG:	0	;ADDRESS OF THE COUNT INCREMENTED
  3898	004461'	000000	000000	ZBGPC:	0	;Where problem was detected
  3899	004462'	000000	000000	ZBGLIN:	0	;LDBLIN OF THE OFFENDING PORT
  3900	004463'	000000	000000	ZBGDCH:	0	;LDBDCH
  3901	004464'	000000	000000	ZBGDDB:	0	;LDBDDB
  3902	004465'	000000	000000	ZBGOUT:	0	;LDBOUT
  3903	004466'	000000	000000	ZBGBIT:	0	;OUTPUT BIT
  3904	004467'	000000	000000	ZBGBYT:	0	;LDBBYT
  3905	004470'	000000	000000	ZBGMOD:	0	;LDBMOD
  3906	004471'	000000	000000	ZBGDCX:	0	;LDBDCX
  3907	004472'	000000	000000	ZBGLOG:	0	;LDBLOG
  3908	004473'	000000	000000		0
  3909	004474'	000000	000000		0
  3910	004475'	000000	000000		0
  3911	004476'	000000	000000		0
  3912
  3913	004477'	256000	017357'	ZAPBUG:	 STOPCD (.+1,INFO,ZAPBUG,,<Port not Zapped - *BUG*>)
  3914	004500'	261040	000007	ZAPBG0:	PUSH	P,T2
  3915	004501'	551340	004457'		HRRZI	T2,ZBGBUG-1	;(PDL POINTER)
  3916	004502'	261340	000006		PUSH	T2,T1		;STORE THE COUNTER'S ADDRESS
  3917	004503'	350006	000000		AOS	(T1)		;INCREMENT THE COUNTER
  3918	004504'	261341	777777		PUSH	T2,-1(P)	;RETURN PC
  3919	004505'	261345	000001		PUSH	T2,LDBLIN(U)
  3920	004506'	261345	000031		PUSH	T2,LDBDCH(U)
  3921	004507'	261345	000000		PUSH	T2,LDBDDB(U)
  3922	004510'	261345	000003		PUSH	T2,LDBOUT(U)
  3923	004511'	135305	000002		LDB	T1,LDBOPB(U)
  3924	004512'	261340	000006		PUSH	T2,T1
  3925	004513'	261345	000027		PUSH	T2,LDBBYT(U)
  3926	004514'	261345	000030		PUSH	T2,LDBMOD(U)
  3927	004515'	261345	000026		PUSH	T2,LDBLOG(U)
  3928	004516'	255000	000000	ZAPBG1:	JFCL
  3929	004517'	255000	000000		JFCL
  3930	004520'	255000	000000		JFCL
  3931	004521'	255000	000000		JFCL
  3932	004522'	255000	000000		JFCL
  3933	004523'	255000	000000		JFCL
  3934	004524'	262040	000007		POP	P,T2
  3935	004525'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 82
SCNSER.MAC	25-JAN-91 22:40		BLOCK I/O MESSAGE ROUTINES

  3936				SUBTTL BLOCK I/O MESSAGE ROUTINES
  3937
  3938				;BLOCK INPUT
  3939
  3940	004526'	260040	004555'	GOBIN:	PUSHJ	P, GOBIO1	;INITIAL SETUP
  3941	004527'	254000	003327'		  JRST	FULLIN		;NO ROOM
  3942	004530'	550405	000005		HRRZ	T3, LDBBIO(U)	;T3/ INPUT BUFFER ADDR
  3943				IFCPU (KL),<
  3944					MOVE	T1, BIOCSH(T3)	;T1/ SWEEP NUMBER
  3945					CAME	T1, CSUCNT##	;UNLOAD ALREADY DONE?
  3946					JRST	[
  3947						AOS CSHSAV##	;PAT OURSELVES ON THE BACK
  3948						JRST GOBIN1
  3949					]
  3950					CSHUNL			;UNLOAD THE CACHE
  3951					CAMN	T1, CSUCNT##
  3952					 JRST	.-1		;WAIT 'TIL IT'S DONE
  3953				GOBIN1:>;END IFCPU (KL)
  3954	004531'	260040	000000*	IFCPU (KS),<CSHIVL>		;INVALIDATE 2020 CACHE
  3955	004532'	205700	023000		MOVSI	P3, TYPI TYPBIN	;P3/ MESSAGE TYPE
  3956	004533'	260040	004565'		PUSHJ	P, GOBIO2	;OUTPUT THE MESSAGE
  3957	004534'	254000	003315'		  JRST	FINLIN		;(NO ROOM FOR MORE)
  3958	004535'	254000	003305'		JRST	MORLIN		;(ROOM FOR MORE)
  3959
  3960				;BLOCK OUTPUT
  3961
  3962	004536'	256000	000000'	GOBOP:	 STOPCD		;(PTYS ONLY)
  3963	004537'	260040	004555'	GOBOT:	PUSHJ	P, GOBIO1	;INITIAL SETUP
  3964	004540'	254000	003327'		  JRST	FULLIN		;NO ROOM
  3965				;"/Patch to check for prior circuit zap on BIO port before output/
  3966	004541'	554405	000005		HLRZ	T3, LDBBIO(U)	;T3/ OUTPUT BUFFER ADDR
  3967	004542'	326400	004547'		JUMPN	T3,GOBOT3	;Must be nonzero
  3968	004543'	205400	400000		MOVSI	T3,LNLZIN	;Has a zapper been seen in the IRING?
  3969	004544'	616405	000001		TDNN	T3,LDBLIN(U)	; ...
  3970	004545'	256000	017362'		 STOPCD (.+1,INFO,BIOZAD,,<Block I/O with Zero Address>);GOBOT+3
  3971	004546'	254000	003315'		JRST	FINLIN		;Say "no room", so zapper can be processed
  3972	004547'			GOBOT3:
  3973				IFCPU (KL),<
  3974					MOVE	T1, BIOCSH(T3)	;T1/ SWEEP NUMBER
  3975					CAME	T1, CSVCNT##	;IF A SWEEP'S ALREADY BEEN DONE,
  3976					 JRST	[
  3977						AOS CSHSAV##	;PAT OURSELVES ON THE BACK
  3978						JRST GOBOT1
  3979					]
  3980					CSHVAL			;START VALIDATE
  3981					CAMN	T1, CSVCNT##
  3982					JRST	.-1		;AND WAIT 'TIL IT'S DONE
  3983				GOBOT1:>;END IFCPU (KL)
  3984	004547'	205300	400000		MOVSI	T1, LDLNOP
  3985	004550'	436305	000031		IORM	T1, LDBDCH(U)	;PREVENT FUTURE OUTPUT UNTIL
  3986								;BLOCK OUTPUT IS COMPLETE
  3987	004551'	205700	022000		MOVSI	P3, TYPI TYPBKO	;P3/ MESSAGE TYPE
  3988	004552'	260040	004565'		PUSHJ	P, GOBIO2	;OUTPUT THE MESSAGE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 82-2
SCNSER.MAC	25-JAN-91 22:40		BLOCK I/O MESSAGE ROUTINES

  3989	004553'	254000	003315'		  JRST	FINLIN		;(NO ROOM FOR MORE)
  3990	004554'	254000	003315'		JRST	FINLIN		;(ROOM FOR MORE BUT CLAIM THERE ISN'T)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 83
SCNSER.MAC	25-JAN-91 22:40		GOBIO1 - CLOSE CHARACTER OUTPUT, THEN SKIP IF THERE ARE

  3991				SUBTTL	GOBIO1 - CLOSE CHARACTER OUTPUT, THEN SKIP IF THERE ARE
  3992				;	   AT LEAST 2 FREE WORDS IN THE OUTPUT RING
  3993
  3994	004555'	260040	004113'	GOBIO1:	PUSHJ	P,CLSCHR	;CLOSE CHARACTER MODE
  3995	004556'	263040	000000		  POPJ	P,		;NO ROOM
  3996	004557'	200300	004213*		MOVE	T1,ORPPDP
  3997	004560'	271300	000002		ADDI	T1,2
  3998	004561'	405300	004212*		ANDI	T1,MSKORG	;T1/ (PDP PTR + 2) MOD RING SIZE
  3999	004562'	312300	004142*		CAME	T1,ORP620
  4000	004563'	350001	000000		AOS	(P)		;ENOUGH ROOM
  4001	004564'	263040	000000		POPJ	P,
  4002
  4003				;GOBIO2 - CALLED WITH T3/ BUFFER ADDR
  4004				;		       P3/ BYTE (8) TYPE, 0, 0, 0
  4005				;	   DEPOSIT THE PORT# AND BUFFER ADDRESS APPROPRIATELY,
  4006				;	   OUTPUT THE BLOCK INPUT/OUTPUT MESSAGE,
  4007				;	   SKIP-RETURN IF THERE'S ROOM FOR MORE
  4008
  4009	004565'	135300	000157'	GOBIO2:	LDB	T1,LDPLNO	;T1/ PORT#
  4010	004566'	137300	000276'		DPB	T1,WRPLIN	;DEPOSIT IT
  4011	004567'	550310	000005		HRRZ	T1,BIOCHR(T3)	;T1/ CHARACTER COUNT
  4012	004570'	137300	017365'		DPB	T1,[POINT ^D16, P3, BYP4]
  4013	004571'	202717	004201*		MOVEM	P3,ORING(P4)
  4014	004572'	260040	016501'		PUSHJ	P,ORPLOG	;Put message into ORING log
  4015	004573'	271740	000001		ADDI	P4,1
  4016	004574'	405740	004561*		ANDI	P4,MSKORG
  4017	004575'	400700	000000		SETZ	P3,
  4018				IFKMC<
  4019					EXTERNAL UBANXT,UBAEND	;OUR UBA SPACE IS BETWEEN THESE TWO
  4020			013622		UBABIO==<763000!<<UBANXT+1>&776>>;START UBA's BLOCK I/O PAGING RAM
  4021	004576'	201310	000000		MOVEI	T1,(T3)		;T1/ BUFFER ADDRESS
  4022	004577'	260040	012525'		PUSHJ	P,SCANBB	;FIND UBA PAGE MATCHING T1
  4023	004600'	256000	000000'			 STOPCD		;THERE HAS TO BE ONE AT THIS POINT
  4024	004601'	271340	000000*		ADDI	T2,UBABIO&77	;UBAPAG# + Low 6 BITS OF UBA ADDRESS
  4025	004602'	137340	017366'		DPB	T2,[POINT 11,T1,26]	;PAGE # OVERLAYS HIGH 11 BITS
  4026	004603'	271300	000006		ADDI	T1,BIODAT		;Offset to first Char address
  4027	004604'	137300	017367'		DPB	T1,[POINT 8,P3,BYP3]	;LOW 8 BITS TO 3RD BYTE POS.
  4028	004605'	242300	777770		LSH	T1,-8			;SHIFT TO HIGH 10 BITS
  4029	004606'	137300	017370'		DPB	T1,[POINT 10,P3,BYP2]	;THE REST IN BYTES 1 & 2
  4030					>;END IFKMC
  4031				IFNKMC<
  4032					MOVEI	T1,BIODAT(T3)	;T1/ FIRST-CHARACTER ADDR
  4033				IFNCPU (KI),<
  4034					MAP	T1,(T1)	;GET PHYSICAL ADDRESS
  4035					DPB	T1,[POINT 18,P3,23] ;PUT IT IN
  4036				>;END IFNCPU (KI)
  4037				>;END IFNKMC
  4038				IFCPU (KI),<
  4039					DPB	T1,[POINT 9,P3,23] ;PUT IN LOW 9 BITS, MAP SMASHES THEM
  4040					MAP	T1,(T1)		;GET PAGE NUMBER
  4041					DPB	T1,[POINT 9,P3,14] ;PUT IN HIGH 9 BITS.
  4042				>;END IFCPU (KI)
  4043	004607'	324740	004177'		PJRST	WRDOT2
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 83-2
SCNSER.MAC	25-JAN-91 22:40		GOBIO1 - CLOSE CHARACTER OUTPUT, THEN SKIP IF THERE ARE

  4044
  4045				;TERMINATE BLOCK OUTPUT
  4046
  4047	004610'	260040	004113'	GOTRO:	PUSHJ	P,CLSCHR	;LEAVE CHARACTER MODE. IF NO ROOM,
  4048	004611'	254000	003327'		JRST	FULLIN		;  RETURN TO OUTPUT DISPATCH
  4049	004612'	205300	400000		MOVSI	T1,LDLNOP
  4050	004613'	436305	000031		IORM	T1,LDBDCH(U)	;SET BACKPRESSURE
  4051	004614'	205700	026000		MOVSI	P3,TYPI TYPORQ	;SEND OUTPUT TERMINATION REQUEST
  4052	004615'	254000	004270'		JRST	FMTB1
  4053
  4054				;TERMINATE BLOCK INPUT
  4055
  4056	004616'	205700	025000	GOTRI:	MOVSI	P3,TYPI TYPIRQ	;SET UP BLOCK TERMINATION REQ
  4057	004617'	254000	004266'		JRST	FMTB
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 84
SCNSER.MAC	25-JAN-91 22:40		RUBOUT STRING/OUTPUT CHARACTER HANDLERS

  4058				SUBTTL RUBOUT STRING/OUTPUT CHARACTER HANDLERS
  4059
  4060				;SEND RUBOUT CHARACTERS
  4061
  4062	004620'			PGRUB:
  4063	004620'	336005	000025	GORUB:	SKIPN	LDBRBC(U)
  4064	004621'	254000	003305'		 JRST	MORLIN		;NO RUBOUT CHARACTERS
  4065	004622'	634600	000014		TDZA	P1,P1		;P1 := -1 IF PRCOUT RUNS OUT OF ROOM
  4066	004623'	254000	003327'		 JRST	FULLIN		;OUT OF ROOM
  4067	004624'	200345	000024	CNTRUB:	MOVE	T2,LDBRBO(U)
  4068	004625'	260040	006152'		PUSHJ	P,TTGETC	;GET A CHAR. IF DONE WITH THE CHUNK,
  4069	004626'	260040	006233'		  PUSHJ	P,FRECHK	;  FREE IT
  4070	004627'	202345	000024		MOVEM	T2,LDBRBO(U)
  4071	004630'	260040	005340'		PUSHJ	P,PRCOUT	;PRINT THE CHARACTER
  4072					  JRST	[		;NO ROOM
  4073						ADDM	T3,LDBRBO(U)
  4074						JRST	FULLIN
  4075	004631'	254000	017371'		  ]
  4076	004632'	373005	000025		SOSLE	LDBRBC(U)	;IF THERE'RE MORE CHARACTERS,
  4077	004633'	254014	004624'		 JRST	CNTRUB(P1)	;  KEEP GOING IF THERE'S ROOM
  4078
  4079				    ;HERE WHEN THERE'RE NO MORE RUBOUT CHARACTERS
  4080
  4081	004634'	402005	000023		SETZM	LDBRBI(U)
  4082	004635'	332345	000024		SKIPE	T2,LDBRBO(U)	;Pointer to last chunk used in rubout string
  4083	004636'	260040	006052'		 PUSHJ	P,FREUP
  4084	004637'	402005	000024		SETZM	LDBRBO(U)	;CLEAN UP THE BUFFERLETS
  4085	004640'	321600	003315'		JUMPL	P1,FINLIN	;NO ROOM
  4086	004641'	254000	003305'		JRST	MORLIN		;MORE ROOM
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 85
SCNSER.MAC	25-JAN-91 22:40		SEND OUTPUT CHARACTERS

  4087				SUBTTL	SEND OUTPUT CHARACTERS
  4088
  4089	004642'			PGOUT:
  4090	004642'	336005	000021	GOOUT:	SKIPN	LDBTOC(U)
  4091	004643'	254000	003305'		 JRST	MORLIN
  4092	004644'	634600	000014		TDZA	P1,P1		;P1 := -1 IF PRCOUT RUNS OUT OF ROOM
  4093	004645'	254000	004665'		 JRST	CLNOC
  4094	004646'	200345	000020	CNTOUT:	MOVE	T2,LDBTOT(U)
  4095	004647'	260040	006152'		PUSHJ	P,TTGETC	;GET A CHAR. IF DONE WITH BUFFERLET,
  4096	004650'	260040	006233'		  PUSHJ	P,FRECHK	;  FREE IT
  4097	004651'	202345	000020		MOVEM	T2,LDBTOT(U)
  4098	004652'	260040	005340'		PUSHJ	P,PRCOUT	;PRINT THE CHARACTER
  4099					 JRST	[		;OUT OF ROOM
  4100						ADDM T3,LDBTOT(U)
  4101						JRST CLNOCP
  4102	004653'	254000	017373'		 ]
  4103	004654'	373345	000021		SOSLE	T2,LDBTOC(U)	;IF THERE'RE MORE CHARACTERS,
  4104	004655'	254014	004646'		 JRST	CNTOUT(P1)	;  CONTINUE IF THERE'S ROOM
  4105
  4106				    ;HERE WHEN THERE'RE NO MORE OUTPUT CHARACTERS
  4107
  4108	004656'	260040	006126'		PUSHJ	P,XMTWAK	;WAKE THE JOB UP
  4109	004657'	550340	000005		HRRZ	T2,U
  4110	004660'	316340	017027'		CAMN	T2,OPRLDB	;IS THIS OPR?
  4111	004661'	260040	014737'		 PUSHJ	P,OPRFRE	;RESTART WAITERS FOR SETUUO
  4112	004662'	321600	003315'		JUMPL	P1,FINLIN	;NO MORE ROOM
  4113	004663'	254000	003305'		JRST	MORLIN		;MORE ROOM
  4114
  4115				    ;HERE WHEN CHARACTER OUTPUT RUNS OUT OF ROOM TO DECIDE
  4116				    ;WHETHER TO WAKE THE JOB UP NOW
  4117
  4118	004664'	200345	000021	CLNOCP:	MOVE	T2,LDBTOC(U)
  4119	004665'	335005	000032	CLNOC:	SKIPGE	LDBDCX(U)	;IF IT'S A FAST LINE,
  4120	004666'	311340	017127'		CAML	T2,OWK120	;AND UNDER THE FAST MINIMUM,
  4121	004667'	315340	017125'		CAMGE	T2,OWK30	;OR IF IT'S UNDER THE SLOW MINIMUM,
  4122	004670'	260040	006126'		 PUSHJ	P,XMTWAK	;  WAKE THE JOB UP
  4123	004671'	254000	003327'		JRST	FULLIN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 86
SCNSER.MAC	25-JAN-91 22:40		ECHO LOGIC

  4124				SUBTTL ECHO LOGIC
  4125
  4126				;YELLOW BALL
  4127
  4128	004672'	260040	004113'	GOSYL:	PUSHJ	P,CLSCHR	;LEAVE CHARACTER MODE
  4129	004673'	254000	003327'		  JRST	FULLIN		;NO ROOM
  4130	004674'	205300	000400		MOVSI	T1,L2LOWT
  4131	004675'	436305	000027		IORM	T1,LDBBYT(U)	;SAY WE'RE WAITING
  4132	004676'	205300	002000		MOVSI	T1,L2LOWS
  4133	004677'	412305	000027		ANDCAM	T1,LDBBYT(U)	;AND THAT WE HAVEN'T SEEN ONE
  4134	004700'	205700	010000		MOVSI	P3,TYPI TYPYEL
  4135	004701'	254000	004270'		JRST	FMTB1
  4136
  4137				;GREEN (GOSGR) AND ORANGE (GOSOG) BALLS
  4138
  4139	004702'	205700	007000	GOSGR:	MOVSI	P3,TYPI TYPGRN
  4140	004703'	334000	000000		SKIPA
  4141	004704'	205700	010400	GOSOG:	MOVSI	P3,TYPI TYPORG
  4142	004705'	205340	004000		MOVSI	T2,L2LDEL
  4143	004706'	616345	000027		TDNN	T2,LDBBYT(U)	;IF WE'RE IN \...
  4144	004707'	260040	004712'		 PUSHJ	P,WTCHK		;OR IF WE'RE NOT IN INPUT WAIT,
  4145	004710'	254000	003323'		  JRST	WATLIN		;  WAIT
  4146	004711'	254000	004266'		JRST	FMTB		;GO SEND IT
  4147
  4148				;WTCHK - SKIP IF TTY IN INPUT WAIT
  4149
  4150	004712'	603240	020000	WTCHK:	TLNE	U,LDLCOM
  4151	004713'	254000	000000*		 JRST	CMDCKW##	;SPECIAL CHECK IF AT COMMAND LEVEL
  4152				;	HRRZ	T1,LDBBIO(U)
  4153				;	JUMPN	T1,CPOPJ
  4154	004714'	205200	010000		MOVSI	F,L2LLDF
  4155	004715'	612205	000027		TDNE	F,LDBBYT(U)	;IF LEAVE DEF ECHO BIT ON
  4156	004716'	254000	004214*		 JRST	CPOPJ1		;ALWAYS GET OUT
  4157	004717'	550205	000000		HRRZ	F,LDBDDB(U)
  4158	004720'	322200	004716*		JUMPE	F,CPOPJ1	;NO JOB, TAKE A CHANCE
  4159	004721'	200004	000002		MOVE	S,DEVIOS(F)
  4160	004722'	602000	010000		TRNE	S,IOACT
  4161	004723'	603000	400000		TLNE	S,TTYOUW
  4162	004724'	263040	000000		 POPJ	P,		;NOT IN WAIT OR IN OUTPUT WAIT
  4163	004725'	254000	004720*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 87
SCNSER.MAC	25-JAN-91 22:40		ECHO CHARACTER OUTPUT

  4164				SUBTTL	ECHO CHARACTER OUTPUT
  4165
  4166	004726'			PGECO:
  4167	004726'	336005	000014	GOECO:	SKIPN	LDBECC(U)
  4168	004727'	254000	003305'		 JRST	MORLIN		;NO CHARACTERS
  4169	004730'	260040	004712'		PUSHJ	P,WTCHK		;IF WE AREN'T IN INPUT WAIT,
  4170					  JRST	[JUMPL	U,GOLIN3	;Don't wake if backpressured
  4171	004731'	254000	017375'			 JRST WATLIN]		;  WAIT UNTIL WE ARE
  4172	004732'	634600	000014		TDZA	P1,P1		;THIS USED THE SAME TRICK AS OUTPUT
  4173	004733'	254000	003327'		 JRST	FULLIN		;WILL GET HERE WHEN OUT OF ROOM
  4174	004734'	200345	000013	CNTECO:	MOVE	T2,LDBECT(U)
  4175	004735'	260040	006152'		PUSHJ	P,TTGETC
  4176	004736'	255000	000000		 JFCL			;DON'T CARE ABOUT BOUNDARIES
  4177	004737'	202345	000013		MOVEM	T2,LDBECT(U)
  4178	004740'	602400	000400		TRNE	T3,400
  4179					 JRST	[MOVEI T1,5	;SET MODE 5 FOR IMAGE CHR
  4180	004741'	254000	017377'			JRST ECHRPT]
  4181	004742'	602400	000200		TRNE	T3,200
  4182	004743'	334710	000112'		 SKIPA	P3,CHRTAB-200(T3)
  4183	004744'	200710	000312'		MOVE	P3,CHRTAB(T3)
  4184	004745'	135300	000306'		LDB	T1,CHPECH	;GET ECHO TYPE
  4185	004746'	135340	000201'	ECHRPT:	LDB	T2,LDPMEC	;AND LINE MODE
  4186	004747'	256006	004760'		XCT	ECHTAB(T1)	;USUALLY LOADS T1 WITH ADDRESS
  4187	004750'	254006	000000		JRST	(T1)		;GO THERE
  4188
  4189				;HERE WHEN THERE'S NOT ENOUGH OUTPUT RING SPACE: BACK UP
  4190				;THE ECHO POINTER AND REPORT NON-COMPLETION TO THE DISPATCHER
  4191
  4192	004751'	272405	000013	ECHBAK:	ADDM	T3,LDBECT(U)	;BACK UP POINTER
  4193	004752'	254000	003327'		JRST	FULLIN
  4194
  4195				;HERE TO SEE IF THERE ARE MORE CHARACTERS TO BE ECHOED
  4196
  4197	004753'	373005	000014	ECHLST:	SOSLE	LDBECC(U)	;IF THERE ARE MORE TO ECHO,
  4198	004754'	254014	004734'		 JRST	CNTECO(P1)	;  CONTINUE
  4199	004755'	321600	003315'		JUMPL	P1,FINLIN	;OTHERWISE, IF THERE'S OUTPUT RING SPACE,
  4200	004756'	260040	014015'		PUSHJ	P,BPXOFF	;  CLEAR BACKPRESSURE (WHY NOW?)
  4201	004757'	254000	003305'		JRST	MORLIN		;  AND RETURN TO OUTPUT DISPATCH
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 88
SCNSER.MAC	25-JAN-91 22:40		ECHO DISPATCH TABLES

  4202				SUBTTL	ECHO DISPATCH TABLES
  4203
  4204	004760'	254000	005125'	ECHTAB:	JRST ECHSPA		; 0 - SPECIAL ACTION
  4205	004761'	554307	004770'		HLRZ T1,ECHT12(T2)	; 1 - NONBREAK: PRINT & COUNT
  4206	004762'	550307	004770'		HRRZ T1,ECHT12(T2)	; 2 - BREAK: NO PRINT, NO COUNT
  4207	004763'	554307	004774'		HLRZ T1,ECHT34(T2)	; 3 - BREAK: PRINT, NO COUNT
  4208	004764'	550307	004774'		HRRZ T1,ECHT34(T2)	; 4 - BREAK2: PRINT & COUNT
  4209	004765'	554307	005000'		HLRZ T1,ECHT56(T2)	; 5 - IMAGE MODE CHARACTER
  4210	004766'	550307	005000'		HRRZ T1,ECHT56(T2)	; 6 - BREAK: PRINT & COUNT
  4211	004767'	550307	005004'		HRRZ T1,ECHT7(T2)	; 7 - BREAK2: NO PRINT, NO COUNT
  4212
  4213	004770'	005010'	005022'	ECHT12:	EACT1,,EACT2	; 0 - COMMAND MODE
  4214	004771'	005052'	005100'		EACT6,,EACT12	; 1 - BREAK-ON-ALL
  4215	004772'	005040'	005100'		EACT10,,EACT12	; 2 - BREAK NORMALLY
  4216	004773'	005040'	005100'		EACT10,,EACT12	; 3 - BREAK-ON-PUNCTUATION
  4217
  4218	004774'	005026'	005030'	ECHT34:	EACT3,,EACT4
  4219	004775'	005103'	005107'		EACT13,,EACT14
  4220	004776'	005103'	005116'		EACT13,,EACT15
  4221	004777'	005103'	005107'		EACT13,,EACT14
  4222
  4223	005000'	005035'	005020'	ECHT56:	EACT5,,EACT16
  4224	005001'	005070'	005074'		EACT7,,EACT17
  4225	005002'	005060'	005074'		EACT11,,EACT17
  4226	005003'	005060'	005074'		EACT11,,EACT17
  4227
  4228	005004'	000000	005032'	ECHT7:	EAC4A
  4229	005005'	000000	005113'		EAC14A
  4230	005006'	000000	005122'		EAC15A
  4231	005007'	000000	005113'		EAC14A
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 89
SCNSER.MAC	25-JAN-91 22:40		COMMAND MODE

  4232				SUBTTL	COMMAND MODE
  4233
  4234				;NONBREAK: PRINT & COUNT
  4235
  4236	005010'	260040	005306'	EACT1:	PUSHJ P,EPCOUT	;DO THE NORMAL OUTPUT THING
  4237	005011'	254000	004751'		 JRST ECHBAK	;MUST BACK UP
  4238	005012'	350445	000012	EACT1B:	AOS T4,LDBTIC(U)
  4239	005013'	305440	000110		CAIGE T4,TIWKC	;ENOUGH TO WAKE UP
  4240	005014'	254000	004753'		 JRST ECHLST	;NO, CHECK MORE CHRS
  4241	005015'	260040	014035'	EACT1A:	PUSHJ P,CMDWAK	;WAKE COMMAND
  4242	005016'	370005	000014		SOS LDBECC(U)	;DECREASE COUNT
  4243	005017'	254000	003323'		JRST WATLIN	;NO MORE ECHO UNTIL WE'RE IN WAIT AGAIN
  4244
  4245				;BREAK: PRINT & COUNT
  4246
  4247	005020'	260040	005306'	EACT16:	PUSHJ P,EPCOUT
  4248	005021'	254000	004751'		 JRST ECHBAK
  4249
  4250				;BREAK: NO PRINT, NO COUNT
  4251
  4252	005022'	561300	000001	EACT2:	HRROI T1,1	;-1 FOR LEFT HALF 1 FOR RIGHT HALF
  4253	005023'	272305	000015		ADDM T1,LDBBKC(U)
  4254	005024'	350005	000012		AOS LDBTIC(U)
  4255	005025'	254000	005015'		JRST EACT1A	;GO WAKE UP
  4256
  4257				;BREAK: PRINT, NO COUNT
  4258
  4259	005026'	260040	005315'	EACT3:	PUSHJ	P,E1IDPB	;OUTPUT IF NOT BACKPRESSURED
  4260	005027'	254000	005022'		JRST EACT2
  4261
  4262				;(EACT4)  BREAK2: PRINT & COUNT
  4263				;(EACT4A) BREAK2: NO PRINT, NO COUNT
  4264
  4265	005030'	260040	005306'	EACT4:	PUSHJ P,EPCOUT
  4266	005031'	254000	004751'		 JRST ECHBAK
  4267	005032'	561300	000001	EAC4A:	HRROI T1,1
  4268	005033'	272305	000016		ADDM T1,LDBBK2(U)
  4269	005034'	254000	005012'		JRST EACT1B
  4270
  4271				;IMAGE
  4272
  4273	005035'	260040	005322'	EACT5:	PUSHJ	P,E2IDPB	;OUTPUT IF NOT BACKPRESSURED
  4274	005036'	211600	000001		MOVNI P1,1	;OUT OF ROOM
  4275	005037'	254000	005012'		JRST EACT1B
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 90
SCNSER.MAC	25-JAN-91 22:40		NONBREAK: PRINT & COUNT; NORMAL OR BREAK2 MODE

  4276				SUBTTL	NONBREAK: PRINT & COUNT; NORMAL OR BREAK2 MODE
  4277
  4278	005040'	603240	000100	EACT10:	TLNE U,LDLNEC		;WORRY ABOUT ECHO
  4279	005041'	254000	005044'		 JRST EAC10A		;NO ECHO
  4280	005042'	260040	005306'		PUSHJ P,EPCOUT
  4281	005043'	254000	004751'		  JRST ECHBAK
  4282	005044'	350445	000012	EAC10A:	AOS T4,LDBTIC(U)
  4283	005045'	307440	000110		CAIG T4,TIWKC
  4284	005046'	254000	004753'		 JRST ECHLST	;DO NOT WAKE UP
  4285	005047'	260040	005774'	EAC10B:	PUSHJ P,USRWAK
  4286	005050'	370005	000014		SOS LDBECC(U)
  4287	005051'	254000	003323'		JRST WATLIN	;NO MORE ECHO UNTIL WE'RE IN WAIT AGAIN
  4288
  4289				;NONBREAK: PRINT & COUNT; BREAK-ON-ALL MODE
  4290
  4291	005052'	603240	000100	EACT6:	TLNE U,LDLNEC
  4292	005053'	254000	005056'		JRST EACT6A
  4293	005054'	260040	005306'		PUSHJ P,EPCOUT
  4294	005055'	254000	004751'		 JRST ECHBAK
  4295	005056'	350005	000012	EACT6A:	AOS LDBTIC(U)
  4296	005057'	254000	005047'		JRST EAC10B
  4297
  4298				;IMAGE; NORMAL OR BREAK2 MODE
  4299
  4300	005060'	603240	000100	EACT11:	TLNE U,LDLNEC
  4301	005061'	254000	005064'		JRST EAC11A
  4302	005062'	260040	005322'		PUSHJ	P,E2IDPB	;OUTPUT IF NOT BACKPRESSURED
  4303	005063'	211600	000001		MOVNI P1,1
  4304	005064'	135300	000203'	EAC11A:	LDB T1,LDPIMB
  4305	005065'	312300	000010		CAME T1,T3
  4306	005066'	254000	005044'		JRST EAC10A	;WAK IF COUNT BIG ENOUGH
  4307	005067'	254000	005056'		JRST EACT6A	;SPECIAL BREAK, WAKE
  4308
  4309				;IMAGE; BREAK-ON-ALL MODE
  4310
  4311	005070'	603240	000100	EACT7:	TLNE U,LDLNEC
  4312	005071'	254000	005056'		JRST EACT6A
  4313	005072'	260040	005315'		PUSHJ	P,E1IDPB	;OUTPUT IF NOT BACKPRESSURED
  4314	005073'	254000	005056'		JRST EACT6A
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 91
SCNSER.MAC	25-JAN-91 22:40		BREAK: PRINT & COUNT; NOT COMMAND MODE

  4315				SUBTTL	BREAK: PRINT & COUNT; NOT COMMAND MODE
  4316
  4317	005074'	603240	000100	EACT17:	TLNE U,LDLNEC
  4318	005075'	254000	005100'		JRST EACT12	;DO NOT ECHO
  4319	005076'	260040	005306'		PUSHJ P,EPCOUT
  4320	005077'	254000	004751'		 JRST ECHBAK
  4321
  4322				;BREAK: NO PRINT, NO COUNT; NOT COMMAND MODE
  4323
  4324	005100'	561300	000001	EACT12:	HRROI T1,1
  4325	005101'	272305	000015		ADDM T1,LDBBKC(U)
  4326	005102'	254000	005056'		JRST EACT6A
  4327
  4328				;BREAK: PRINT, NO COUNT; NOT COMMAND MODE
  4329
  4330	005103'	603240	000100	EACT13:	TLNE U,LDLNEC
  4331	005104'	254000	005100'		JRST EACT12
  4332	005105'	260040	005315'		PUSHJ	P,E1IDPB	;OUTPUT IF NOT BACKPRESSURED
  4333	005106'	254000	005100'		JRST EACT12
  4334
  4335				;(EACT14)  BREAK2: PRINT & COUNT; BREAK-ON-ALL OR BREAK2 MODE
  4336				;(EACT14A) BREAK2: NO PRINT, NO COUNT; BREAK-ON-ALL OR BREAK2 MODE
  4337
  4338	005107'	603240	000100	EACT14:	TLNE U,LDLNEC
  4339	005110'	254000	005113'		JRST EAC14A
  4340	005111'	260040	005306'		PUSHJ P,EPCOUT
  4341	005112'	254000	004751'		 JRST ECHBAK
  4342	005113'	561300	000001	EAC14A:	HRROI T1,1
  4343	005114'	272305	000016		ADDM T1,LDBBK2(U)
  4344	005115'	254000	005056'		JRST EACT6A
  4345
  4346				;(EACT15)  BREAK2: PRINT & COUNT; NORMAL MODE
  4347				;(EACT15A) BREAK2: NO PRINT, NO COUNT; NORMAL MODE
  4348
  4349	005116'	603240	000100	EACT15:	TLNE U,LDLNEC
  4350	005117'	254000	005122'		JRST EAC15A
  4351	005120'	260040	005306'		PUSHJ P,EPCOUT
  4352	005121'	254000	004751'		JRST ECHBAK
  4353	005122'	561300	000001	EAC15A:	HRROI T1,1
  4354	005123'	272305	000016		ADDM T1,LDBBK2(U)
  4355	005124'	254000	005044'		JRST EAC10A
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 92
SCNSER.MAC	25-JAN-91 22:40		SPECIAL ACTION

  4356				SUBTTL	SPECIAL ACTION
  4357
  4358	005125'	135300	000165'	ECHSPA:	LDB T1,LDPMOD
  4359	005126'	135340	000311'		LDB T2,CHPSPE
  4360	005127'	256026	005130'		XCT @ECHSPT(T1)
  4361
  4362	005130'	256007	005134'	ECHSPT:	XCT SPEPDP(T2)
  4363	005131'	256007	005146'		XCT SPE940(T2)
  4364	005132'	256007	005146'		XCT SPE940(T2)
  4365	005133'	256007	005134'		XCT SPEPDP(T2)
  4366
  4367	005134'	254000	005245'	SPEPDP:	JRST SPEUXC	;ECHO ^X RETURN (^C)
  4368	005135'	254000	005160'		JRST SPECR	;RETURN
  4369	005136'	254000	005236'		JRST SPEUX	;ECHO ^X (^U)
  4370	005137'	254000	005204'		JRST SPETAB	;TAB
  4371	005140'	254000	005175'		JRST SPEALT	;33
  4372	005141'	254000	005217'		JRST SPEVM	;V. TAB
  4373	005142'	254000	005217'		JRST SPEVM	;FF
  4374	005143'	254000	005245'		JRST SPEUXC	;ECHO ^X RETURN (^Z)
  4375	005144'	254000	005173'		JRST SPEALP	;175-176
  4376	005145'	254000	005223'		JRST SPEBS	;BACKSPACE
  4377
  4378	005146'	254000	005162'	SPE940:	JRST SPEBRK	;TYPE 2
  4379	005147'	254000	005160'		JRST SPECR	;RETURN
  4380	005150'	254000	005162'		JRST SPEBRK
  4381	005151'	254000	005204'		JRST SPETAB	;TAB
  4382	005152'	254000	005162'		JRST SPEBRK	;33
  4383	005153'	254000	005217'		JRST SPEVM	;V. TAB
  4384	005154'	254000	005217'		JRST SPEVM	;FF
  4385	005155'	254000	005162'		JRST SPEBRK	;TYPE 2
  4386	005156'	254000	005170'		JRST SPEAP1	;175-176
  4387	005157'	254000	005223'		JRST SPEBS	;BACKSPACE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 93
SCNSER.MAC	25-JAN-91 22:40		TREAT AS NONBREAK: PRINT & COUNT

  4388				SUBTTL	TREAT AS NONBREAK: PRINT & COUNT
  4389
  4390	005160'	201300	000001	SPECR:	MOVEI T1,1
  4391	005161'	254000	004746'		JRST ECHRPT	;JUST TURN INTO TYPE 1
  4392
  4393				;TREAT AS BREAK: NO PRINT, NO COUNT
  4394
  4395	005162'	201300	000002	SPEBRK:	MOVEI T1,2
  4396	005163'	254000	004746'		JRST ECHRPT	;TYPE 2
  4397
  4398				;TREAT AS BREAK: PRINT, NO COUNT
  4399
  4400	005164'	201300	000003	SPEBK3:	MOVEI T1,3
  4401	005165'	254000	004746'		JRST ECHRPT	;TYPE 3
  4402
  4403				;TREAT AS BREAK: PRINT & COUNT
  4404
  4405	005166'	201300	000006	SPEBK6:	MOVEI T1,6
  4406	005167'	254000	004746'		JRST ECHRPT	;TYPE 6
  4407
  4408				;RIGHT BRACE OR TILDE IN 940 MODE
  4409
  4410	005170'	607240	000020	SPEAP1:	TLNN U,LDLLCT	;175-176
  4411	005171'	254000	005166'		JRST SPEBK6	;TTY LC, BREAK: PRINT & COUNT
  4412	005172'	254000	005162'		JRST SPEBRK	;TTY NO LC, BREAK: NO PRINT, NO COUNT
  4413
  4414				;RIGHT BRACE OR TILDE IN PDP10 MODE
  4415
  4416	005173'	607240	000020	SPEALP:	TLNN U,LDLLCT
  4417	005174'	254000	005166'		 JRST SPEBK6	;TTY LC, BREAK: PRINT & COUNT
  4418					PFALL SPEALT	;TTY NO LC, EQUIVALENT TO ESC
  4419
  4420				;ESCAPE IN PDP10 MODE
  4421
  4422	005175'	205400	020000	SPEALT:	MOVSI T3,LXLDLR
  4423	005176'	612405	000032		TDNE T3,LDBDCX(U) ;IF USER SUPPRESSING $ ECHO
  4424	005177'	603240	020000		TLNE U,LDLCOM	;OR WE'RE AT COMMAND LEVEL
  4425	005200'	334000	000000		SKIPA		;ECHO A $
  4426	005201'	254000	005162'		JRST SPEBRK
  4427	005202'	201400	000044		MOVEI T3,"$"
  4428	005203'	254000	005166'		JRST SPEBK6	;YES, SAY IT WAS A $
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 94
SCNSER.MAC	25-JAN-91 22:40		HORIZONTAL TAB

  4429				SUBTTL	HORIZONTAL TAB
  4430
  4431	005204'	200305	000027	SPETAB:	MOVE	T1, LDBBYT(U)
  4432	005205'	603300	020000		TLNE	T1, L2LNTB	; NO ECHO?
  4433	005206'	254000	005213'		JRST	SPETB1
  4434	005207'	603300	100000		TLNE	T1, L2LTBK	; BREAK ?
  4435	005210'	254000	005166'		JRST	SPEBK6		; BREAK & ECHO
  4436	005211'	201300	000004		MOVEI	T1, 4
  4437	005212'	254000	004746'		JRST	ECHRPT		; BREAK2 & ECHO
  4438
  4439	005213'	603300	100000	SPETB1:	TLNE	T1, L2LTBK	; BREAK ?
  4440	005214'	254000	005162'		JRST	SPEBRK		; BREAK & NO ECHO
  4441	005215'	201300	000007		MOVEI	T1, 7
  4442	005216'	254000	004746'		JRST	ECHRPT		; BREAK2 & NO ECHO
  4443
  4444				;VERTICAL TAB OR FORMFEED
  4445
  4446	005217'	205300	020000	SPEVM:	MOVSI	T1, L2LNTB
  4447	005220'	616305	000027		TDNN	T1, LDBBYT(U)	; ECHO?
  4448	005221'	254000	005166'		JRST	SPEBK6		; YES
  4449	005222'	254000	005162'		JRST	SPEBRK		; NO
  4450
  4451				;BACKSPACE
  4452
  4453	005223'	200305	000027	SPEBS:	MOVE	T1,LDBBYT(U)
  4454	005224'	135340	000021'		LDB	T2,LDPECH	;REMOTE BS ECHO SET
  4455	005225'	322340	005232'		JUMPE	T2,SPEBS1	;NO, DON'T ECHO
  4456	005226'	607300	040000		TLNN	T1,L2LBBP	;BREAK
  4457	005227'	254000	005166'		JRST	SPEBK6		;BREAK & ECHO
  4458	005230'	201300	000004		MOVEI	T1,4
  4459	005231'	254000	004746'		JRST	ECHRPT		;BREAK2 & ECHO
  4460
  4461	005232'	607300	040000	SPEBS1:	TLNN	T1,L2LBBP	;BREAK
  4462	005233'	254000	005162'		JRST	SPEBRK		;BREAK & NO ECHO
  4463	005234'	201300	000007		MOVEI	T1,7
  4464	005235'	254000	004746'		JRST	ECHRPT		;BREAK2 & NO ECHO
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 95
SCNSER.MAC	25-JAN-91 22:40		ECHO <CONTROL CHAR> AS ^<CONTROL CHAR + 100>

  4465				SUBTTL	ECHO <CONTROL CHAR> AS ^<CONTROL CHAR + 100>
  4466
  4467	005236'	607240	020000	SPEUX:	TLNN U,LDLCOM
  4468	005237'	607240	000100		TLNN U,LDLNEC	;ALWAYS DO IT IN COMMAND MODE
  4469	005240'	334000	000000		SKIPA
  4470	005241'	254000	005162'		JRST SPEBRK	;OTHERWISE NOT IF NO ECHO
  4471	005242'	260040	005264'		PUSHJ P,SPEUCM	;COMMON ^X ECHO CODE
  4472	005243'	254000	004751'		 JRST ECHBAK
  4473	005244'	254000	005162'		JRST SPEBRK
  4474
  4475				;ECHO <CONTROL CHAR> AS ^<CONTROL CHAR + 100><CR><LF>
  4476
  4477	005245'	607240	020000	SPEUXC:	TLNN U,LDLCOM	;SAME AS SPEUX BUT ADD RETURN
  4478	005246'	607240	000100		TLNN U,LDLNEC
  4479	005247'	334000	000000		SKIPA
  4480	005250'	254000	005162'		JRST SPEBRK
  4481	005251'	260040	005264'		PUSHJ P,SPEUCM	;ECHO THE ^X
  4482	005252'	254000	004751'		 JRST ECHBAK	;DID NOT MAKE IT
  4483	005253'	200440	005521'		MOVE T4,CRPTR	;GET READY FOR THE RETURN LF
  4484	005254'	321600	005262'		JUMPL P1,SPEUX1	;OUT OF ROOM, MUST USE RUBOUT STRING
  4485	005255'	201400	000000		MOVEI T3,0
  4486	005256'	137400	000175'		DPB T3,LDPPOS	;RESET POSITION
  4487	005257'	260040	005477'		PUSHJ P,SPOFIL
  4488	005260'	254000	005162'		 JRST SPEBRK	;HAVE PUT OUT THE CRLF (OR TO FILLER)
  4489	005261'	254000	005162'		JRST SPEBRK	;SAME
  4490
  4491	005262'	260040	002444'	SPEUX1:	PUSHJ P,RUBSTR
  4492	005263'	254000	005162'		JRST SPEBRK
  4493
  4494				;COMMON CODE FOR SPEUX AND SPEUXC
  4495
  4496	005264'	321240	005307'	SPEUCM:	JUMPL	U,EPCOU1	;CAN'T OUTPUT NOW
  4497	005265'	135440	000175'		LDB T4,LDPPOS
  4498	005266'	271440	000002		ADDI T4,2	;MAKE SURE BOTH FIT ON SAME LINE
  4499	005267'	201400	000136		MOVEI T3,"^"	;THE ^
  4500	005270'	260040	005351'		PUSHJ P,PRCCR	;THIS WILL PUT IN A CRLF IF NEEDED
  4501	005271'	263040	000000		 POPJ P,	;^ NOT SENT, OUT OF ROOM, BACK UP
  4502	005272'	306440	000001		CAIN T4,1	;^ SEND, T4 IS LDPPOS, IF 1 CRLF SENT
  4503					AOJA T4,[DPB T4,LDPPOS	;MUST SET TO 2
  4504	005273'	344440	017401'			JRST .+1]
  4505	005274'	135405	000013		LDB T3,LDBECT(U)	;GET BACK CHARACTER
  4506	005275'	660400	000100		TRO T3,100
  4507	005276'	321600	005302'		JUMPL P1,SPEUC1	;ALREADY OUT OF ROOM, INTO RUBOUT STRING
  4508	005277'	260040	005322'		PUSHJ	P,E2IDPB	;OUTPUT IF NOT BACKPRESSURED
  4509	005300'	211600	000001		MOVNI P1,1
  4510	005301'	254000	004725*		JRST CPOPJ1	;FINISHED
  4511
  4512	005302'	260040	002427'	SPEUC1:	PUSHJ P,ENTRUB
  4513	005303'	201300	000001		MOVEI T1,1
  4514	005304'	137300	000074'		DPB T1,LOPRUB	;SET TO SEND RUBOUT STRING
  4515	005305'	254000	005301*		JRST CPOPJ1	;P1 IS NEG SO WILL FINISH
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 96
SCNSER.MAC	25-JAN-91 22:40		DON'T ECHO IF PORT BACKPRESSURED

  4516				SUBTTL	DON'T ECHO IF PORT BACKPRESSURED
  4517
  4518	005306'	325240	005340'	EPCOUT:	JUMPGE	U,PRCOUT	;DO OUTPUT IF NOT BACKPRESSURED
  4519	005307'	262040	000006	EPCOU1:	POP	P,T1		;FLUSH RETURN ADDR
  4520	005310'	400300	000000		SETZ	T1,
  4521	005311'	137305	000002		DPB	T1,LDBOPB(U)	;TURN OFF NEED OUTPUT
  4522	005312'	205400	110000		MOVSI	T3,110000
  4523	005313'	272405	000013		ADDM	T3,LDBECT(U)	;BACK UP BYTE POINTER
  4524	005314'	254000	003327'		JRST	FULLIN		;GO ON TO NEXT LINE
  4525
  4526	005315'	321240	005307'	E1IDPB:	JUMPL	U,EPCOU1	;CAN'T ECHO NOW
  4527	005316'	102412	017041'		UUIDPB	T3,CHRWRP(W)
  4528	005317'	373012	017043'		SOSLE	MULCNT(W)
  4529	005320'	370000	017022'		SOS	CHCNT
  4530	005321'	263040	000000		POPJ	P,
  4531
  4532	005322'	321240	005307'	E2IDPB:	JUMPL	U,EPCOU1	;CAN'T ECHO NOW
  4533	005323'	102412	017041'		UUIDPB	T3,CHRWRP(W)
  4534	005324'	373012	017043'		SOSLE	MULCNT(W)
  4535	005325'	377000	017022'		SOSG	CHCNT
  4536	005326'	263040	000000		POPJ	P,
  4537	005327'	254000	005305*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 97
SCNSER.MAC	25-JAN-91 22:40		OUTPUT FILLER LOGIC

  4538				SUBTTL OUTPUT FILLER LOGIC
  4539
  4540				;SEND FILLER CHARACTERS
  4541
  4542	005330'			PGFIL:
  4543	005330'	134405	000022	GOFIL:	ILDB	T3, LDBFLP(U)	;T3/ NEXT CHAR, OR 0 IF LDBFLP=0
  4544					JUMPE	T3, [		;IF NO (MORE) CHARACTERS,
  4545						SETZM	LDBFLP(U)	;CLEAR THE POINTER
  4546						JRST	MORLIN
  4547	005331'	322400	017403'		]
  4548	005332'	620400	000200		TRZ	T3, 200		;WHAT IS THIS FOR???
  4549	005333'	102412	017041'		UUIDPB	T3, CHRWRP(W)	;DEPOSIT THE CHARACTER
  4550	005334'	373012	017043'		SOSLE	MULCNT(W)
  4551	005335'	377000	017022'		SOSG	CHCNT
  4552	005336'	254000	003327'		JRST	FULLIN		;NO MORE ROOM
  4553	005337'	254000	005330'		JRST	GOFIL		;BACK FOR MORE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 98
SCNSER.MAC	25-JAN-91 22:40		PRCOUT - CALLED WITH T3/ THE CHARACTER TO PRINT,

  4554				SUBTTL	PRCOUT - CALLED WITH T3/ THE CHARACTER TO PRINT,
  4555				;	   PRINTS THE CHARACTER (MAPPING UPPER CASE TO LOWER
  4556				;	   CASE IF SO ENABLED), INSERTS FREE CRLFS AND
  4557				;	   HT/VT/FF PADDING/SIMULATION CHARACTERS IF NECESSARY.
  4558				;	   IF IT CAN'T PRINT THE CHARACTER, IT NONSKIP-RETURNS
  4559				;	   WITH T3/ 110000,,0 (WITH WHICH THE CALLER CAN BACK UP
  4560				;	   A BYTE POINTER). OTHERWISE, IT SKIP-RETURNS. IT MAY
  4561				;	   SET THE NEED-FILLER BIT, AND IT WILL SET P1 = -1 IF
  4562				;	   THERE'S NO CHARACTER SPACE LEFT.
  4563
  4564	005340'	606400	000400	PRCOUT:	TRNN	T3, 400		;IF IT'S AN IMAGE CHARACTER
  4565	005341'	603240	200000		TLNE	U, LDLSOX	;OR SUPPRESSING OUTPUT TRANSLATION,
  4566	005342'	254000	005400'		JRST	PRCOT3		;  JUST SEND IT
  4567	005343'	602400	000200		TRNE	T3, 200
  4568	005344'	334710	000112'		SKIPA	P3, CHRTAB-200(T3)
  4569	005345'	200710	000312'		MOVE	P3, CHRTAB(T3)	;P3/ CHARACTER-TYPE BITS
  4570	005346'	135300	000303'		LDB	T1, CHPOUT	;T1/ CHARACTER PRINT MODE
  4571					XCT	[
  4572						JRST PROACT	;0 SPECIAL ACTION
  4573						LDB T4, LDPPOS	;1 PRINT AND COUNT 1 CHARACTER-WIDTH
  4574						JRST PRCOT3	;2 PRINT BUT DON'T COUNT
  4575						JRST PROUCC	;3 UPPER CASE ACTION
  4576	005347'	256006	017405'		](T1)
  4577
  4578				    ;HERE ON 1-CHARACTER-WIDE CHARACTERS
  4579
  4580	005350'	340440	000000	PRCOCW:	AOJ	T4,		;T4/ POSITION ON LINE
  4581
  4582				    ;HERE WITH T4/ POSITION, FROM ABOVE AND FROM ECHO CODE,
  4583				    ;TO PRINT A FREE CR IF ONE IS NEEDED, THEN THE CHAR IN T3
  4584
  4585	005351'	135300	000170'	PRCCR:	LDB	T1,LDPWID	;T1/ LINE WIDTH
  4586	005352'	313440	000006		CAMLE	T4,T1		;IF THE LINE ISN'T FULL
  4587	005353'	603240	200200		TLNE	U,LDLNFC!LDLSOX	;OR THE USER DOESN'T WANT FREE CRLFS
  4588	005354'	254000	005376'		 JRST	PRCOT1		;  JUST PRINT THE CHARACTER
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 99
SCNSER.MAC	25-JAN-91 22:40		PRCOUT - CALLED WITH T3/ THE CHARACTER TO PRINT,

  4589				    ;HERE TO PRINT A CRLF
  4590
  4591	005355'	200440	005521'		MOVE	T4, CRPTR
  4592	005356'	134340	000011	PRCFIL:	ILDB	T2, T4		;T2/ NEXT CHARACTER
  4593					JUMPE	T2, [		;IF WE'RE DONE,
  4594						MOVEI	T4, 1		;LINE POSITION WILL BE 1
  4595						JRST	PRCOT2		;GO PRINT THE CHARACTER
  4596	005357'	322340	017411'		]
  4597	005360'	102352	017041'		UUIDPB	T2, CHRWRP(W)	;DEPOSIT THE CHARACTER
  4598	005361'	373012	017043'		SOSLE	MULCNT(W)
  4599	005362'	377000	017022'		SOSG	CHCNT
  4600	005363'	254000	005365'		JRST	.+2		;(NO MORE ROOM)
  4601	005364'	254000	005356'		JRST	PRCFIL		;BACK FOR MORE
  4602	005365'	200400	000011		MOVE	T3, T4
  4603	005366'	134400	000010		ILDB	T3, T3		;T3/ THE NEXT CHAR
  4604	005367'	322400	005373'		JUMPE	T3, PRCFL1	;IF IT WASN'T THE TERMINATING NUL,
  4605	005370'	202445	000022		MOVEM	T4, LDBFLP(U)	;  SET THE REST AS FILLER
  4606	005371'	201440	000001		MOVEI	T4, 1
  4607	005372'	137440	000073'		DPB	T4, LOPFIL	;  SET THE NEED-FILLER BIT
  4608	005373'	205400	110000	PRCFL1:	MOVSI	T3, 110000	;(MAGIC SO CALLER CAN BACKUP BYTE PTR)
  4609	005374'	137400	000175'		DPB	T3, LDPPOS	;LINE POSITION := 0
  4610	005375'	263040	000000		POPJ	P,
  4611
  4612	005376'	307440	000377	PRCOT1:	CAIG	T4, 377
  4613	005377'	137440	000175'	PRCOT2:	DPB	T4, LDPPOS
  4614	005400'	102412	017041'	PRCOT3:	UUIDPB	T3, CHRWRP(W)
  4615	005401'	373012	017043'		SOSLE	MULCNT(W)
  4616	005402'	377000	017022'		SOSG	CHCNT
  4617	005403'	474600	000000		SETO	P1,
  4618	005404'	254000	005327*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 100
SCNSER.MAC	25-JAN-91 22:40		HERE ON SPECIAL-ACTION CHARACTERS

  4619				SUBTTL	HERE ON SPECIAL-ACTION CHARACTERS
  4620
  4621	005405'	135340	000304'	PROACT:	LDB T2,CHPSPO
  4622	005406'	256007	005407'		XCT SPOTBL(T2)	;DO CORRECT OUTPUT THING FOR CHR
  4623
  4624	005407'	254000	005414'	SPOTBL:	JRST SPOCR	;RETURN
  4625	005410'	254000	005416'		JRST SPOTAB	;TAB
  4626	005411'	254000	005455'		JRST SPOVT	;VERTICAL TAB
  4627	005412'	254000	005446'		JRST SPOFF	;FORM FEED
  4628	005413'	254000	005464'		JRST SPOBS2	;BACKSPACE
  4629
  4630				;CARRIAGE RETURN
  4631
  4632	005414'	201440	000000	SPOCR:	MOVEI T4,0
  4633	005415'	254000	005377'		JRST PRCOT2	;OUTPUT BUT SET POS TO 0
  4634
  4635				;HORIZONTAL TAB
  4636
  4637	005416'	135300	000175'	SPOTAB:	LDB T1,LDPPOS	;GET CURRENT POSITION
  4638	005417'	660300	000007		TRO T1,7
  4639	005420'	271300	000001		ADDI T1,1	;WHERE IT WILL BE
  4640	005421'	135440	000170'		LDB T4,LDPWID
  4641	005422'	607240	000200		TLNN U,LDLNFC
  4642	005423'	315300	000011		CAMGE T1,T4	;WILL WE OVERFLOW?
  4643	005424'	254000	005431'		 JRST SPOTB0	;NO OR NO CR WANTED
  4644	005425'	201300	000000		MOVEI T1,0
  4645	005426'	137300	000175'		DPB T1,LDPPOS	;SET TO 0 POSITION
  4646	005427'	200440	005521'		MOVE T4,CRPTR
  4647	005430'	254000	005477'		JRST SPOFIL
  4648
  4649	005431'	135440	000175'	SPOTB0:	LDB T4,LDPPOS	;NO CR, GET CURRENT POSITION
  4650	005432'	606300	000400		TRNN T1,400
  4651	005433'	137300	000175'		DPB T1,LDPPOS	;SAVE NEW
  4652	005434'	603240	000010		TLNE U,LDLTAB
  4653	005435'	254000	005441'		JRST SPOTB1	;TTY DOES TABS, JUST FILL
  4654	005436'	405440	000007		ANDI T4,7
  4655	005437'	200451	005571'		MOVE T4,TABPTR(T4)	;GET CORRECT NUMBER
  4656	005440'	254000	005477'		JRST SPOFIL	;AND SEND
  4657
  4658	005441'	135300	000166'	SPOTB1:	LDB T1,LDPFC2
  4659	005442'	606440	000004		TRNN T4,4
  4660	005443'	334446	005554'		SKIPA T4,TBFL2(T1)	;USE LONG FILL
  4661	005444'	200446	005550'		MOVE T4,TBFL(T1)	;OR SHORT FILL
  4662	005445'	254000	005501'		JRST SPOFL1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 101
SCNSER.MAC	25-JAN-91 22:40		FORM FEED

  4663				SUBTTL	FORM FEED
  4664
  4665	005446'	603240	000001	SPOFF:	TLNE U,LDLFRM	;IF TTY DOESN'T DO FORMS,
  4666	005447'	254000	005452'		JRST SPOFF1
  4667	005450'	200440	005534'		MOVE T4,FFFLP
  4668	005451'	254000	005477'		JRST SPOFIL	;  SEND LINEFEEDS
  4669	005452'	135300	000172'	SPOFF1:	LDB T1,LDPFC1	;IF IT DOES,
  4670	005453'	200446	005540'		MOVE T4,FLLFFS(T1)
  4671	005454'	254000	005501'		JRST SPOFL1	;  SEND PAD CHARACTERS
  4672
  4673				;VERTICAL TAB
  4674
  4675	005455'	603240	000001	SPOVT:	TLNE U,LDLFRM	;IF TTY DOESN'T DO VERTICAL TABS,
  4676	005456'	254000	005461'		JRST SPOVT1
  4677	005457'	200440	005537'		MOVE T4,VTFLP
  4678	005460'	254000	005477'		JRST SPOFIL	;  SEND LINEFEEDS
  4679	005461'	135300	000172'	SPOVT1:	LDB T1,LDPFC1	;IF IT DOES,
  4680	005462'	200446	005544'		MOVE T4,FLLVTS(T1)
  4681	005463'	254000	005501'		JRST SPOFL1	;  SEND PAD CHARACTERS
  4682
  4683				;BACKSPACE
  4684
  4685	005464'	260040	005466'	SPOBS2:	PUSHJ	P, SPOBSP	;UPDATE CHAR COLUMN COUNTER
  4686	005465'	254000	005400'		JRST	PRCOT3
  4687
  4688	005466'	205300	001000	SPOBSP:	MOVSI	T1, L2LBSP	;IF NEITHER BS FOR CHAR DELETE
  4689	005467'	612305	000027		TDNE	T1, LDBBYT(U)
  4690	005470'	254000	005473'		JRST	SPOBS1
  4691	005471'	135300	000021'		LDB	T1, LDPECH	;NOR REMOTE BS ECHO
  4692	005472'	322300	004145*		JUMPE	T1, CPOPJ	;THEN DON'T COUNT IT
  4693	005473'	135300	000175'	SPOBS1:	LDB	T1, LDPPOS
  4694	005474'	371000	000006		SOSL	T1
  4695	005475'	137300	000175'		DPB	T1, LDPPOS	;IF POS-1 .ge. 0, POS:=POS-1
  4696	005476'	263040	000000		POPJ	P,
  4697
  4698				;SPOFIL -- CALLED WITH T4/ FILL POINTER. OUTPUT THE FILL CHARACTERS.
  4699				;	   IF THERE'S NOT ENOUGH OUTPUT RING SPACE, SET UP LDPFLP
  4700				;	   TO POINT TO WHAT'S LEFT, SET P1 = -1, AND LET GOFIL
  4701				;	   DO THE REST. SKIP-RETURNS ALWAYS.
  4702				;SPOFL1 -- OUTPUT THE CHAR IN T3, THEN THE T4 STRING
  4703
  4704	005477'	134400	000011	SPOFIL:	ILDB	T3, T4		;T3/ NEXT CHAR
  4705	005500'	322400	005404*		JUMPE	T3, CPOPJ1	;DONE
  4706	005501'	102412	017041'	SPOFL1:	UUIDPB	T3, CHRWRP(W)	;DEPOSIT IT
  4707	005502'	373012	017043'		SOSLE	MULCNT(W)
  4708	005503'	377000	017022'		SOSG	CHCNT
  4709	005504'	254000	005506'		JRST	.+2		;(NO ROOM)
  4710	005505'	254000	005477'		JRST	SPOFIL		;BACK FOR MORE
  4711	005506'	474600	000000		SETO	P1,		;SET NO-MORE-ROOM FLAG
  4712	005507'	200400	000011		MOVE	T3, T4
  4713	005510'	134400	000010		ILDB	T3, T3		;T3/ NEXT CHAR
  4714	005511'	322400	005500*		JUMPE	T3, CPOPJ1	;IF IT WASN'T THE TERMINATING NUL,
  4715	005512'	202445	000022		MOVEM	T4, LDBFLP(U)	;  SET THE REST AS FILLER
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 101-2
SCNSER.MAC	25-JAN-91 22:40		FORM FEED

  4716	005513'	201400	000001		MOVEI	T3, 1
  4717	005514'	137400	000073'		DPB	T3, LOPFIL	;  AND SET NEED-FILLER
  4718	005515'	254000	005511*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 102
SCNSER.MAC	25-JAN-91 22:40		FILLER	POINTERS AND VARIOUS ECHO POINTERS

  4719				SUBTTL	FILLER	POINTERS AND VARIOUS ECHO POINTERS
  4720
  4721	005516'	440700	005517'	CCPTR:	POINT 7,CCASC
  4722	005517'			CCASC:	ASCIZ /\^C
  4723	005517'	562750	306424	/
	005520'	000000	000000
  4724
  4725	005521'	170700	005517'	CRPTR:	POINT 7,CCASC,20	;JUST THE RETURN FROM ABOVE
  4726
  4727	005522'	440700	005523'	CUPTR:	POINT 7,CUASC
  4728	005523'			CUASC:	ASCIZ /\^U
  4729	005523'	562752	506424	/
	005524'	000000	000000
  4730
  4731	005525'	440700	005526'	UPARPT:	POINT 7,UPASC
  4732	005526'			UPASC:	ASCIZ /\^
  4733	005526'	562741	505000	/
  4734
  4735	005527'	440700	005530'	COPTR:	POINT 7,COASC
  4736	005530'			COASC:	ASCIZ /\^O
  4737	005530'	562751	706424	/
	005531'	000000	000000
  4738
  4739	005532'	440700	005533'	FLLBSC:	POINT 7,BSLASC
  4740	005533'			BSLASC:	ASCIZ /\
  4741	005533'	560321	200000	/
  4742
  4743	005534'	440700	005535'	FFFLP:	POINT 7,FFLP0		;FILLER FOR SIMULATING FORM FEED
  4744	005535'	050241	205024	FFLP0:	BYTE (7) 12,12,12,12,12,12,12,12,0
	005536'	050241	200000
  4745
  4746	005537'	100700	005535'	VTFLP:	POINT 7,FFLP0,27	;FILLER FOR SIMULATING VERTICAL TAB
  4747
  4748					DEFINE FILLP(N)
  4749				<IF1,<IFG N-FLMX,<FLMX==N>
  4750					0>
  4751				IF2,< XXXQ==<FLMX-N>/5
  4752				XXXR==FLMX-N-<XXXQ*5>
  4753				
  4754				IFE XXXR,<POINT 7,FILERS+XXXQ>
  4755				IFN XXXR,<POINT 7,FILERS+XXXQ,<7*XXXR>-1>>>
  4756
  4757				;THE ABOVE MACRO DEFINES POINTERS INTO A LIST OF FILLERS (377)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 103
SCNSER.MAC	25-JAN-91 22:40		FILLER	POINTERS AND VARIOUS ECHO POINTERS

  4758				IF1,<FLMX==0>
  4759
  4760	005540'	000000	000000	FLLFFS:	0
  4761	005541'	170700	005565'		FILLP ^D12
  4762	005542'	440700	005565'		FILLP ^D15
  4763	005543'	440700	005560'		FILLP ^D40
  4764
  4765	005544'	000000	000000	FLLVTS:	0
  4766	005545'	100700	005566'		FILLP 6
  4767	005546'	440700	005567'		FILLP 5
  4768	005547'	440700	005564'		FILLP ^D20
  4769
  4770	005550'	000000	000000	TBFL:	0
  4771	005551'	100700	005567'		FILLP 1
  4772	005552'	260700	005567'		FILLP 3
  4773	005553'	260700	005567'		FILLP 3
  4774
  4775	005554'	000000	000000	TBFL2:	0
  4776	005555'	170700	005567'		FILLP 2
  4777	005556'	440700	005567'		FILLP 5
  4778	005557'	440700	005567'		FILLP 5
  4779
  4780				;NOW GENERATE FILLERS
  4781
  4782					DEFINE GENFL(X)
  4783				<XXQ==X/5
  4784					REPEAT XXQ,<BYTE (7) 177,177,177,177,177>
  4785				XXQ==X-<XXQ*5>
  4786				IFE XXQ,<0>
  4787				IFE XXQ-1,<BYTE (7) 177>
  4788				IFE XXQ-2,<BYTE (7) 177,177>
  4789				IFE XXQ-3,<BYTE (7) 177,177,177>
  4790				IFE XXQ-4,<BYTE (7) 177,177,177,177>
  4791				>
  4792
  4793	005560'	777777	777776	FILERS:	GENFL (FLMX)
  4794	005561'	777777	777776
  4795	005562'	777777	777776
  4796	005563'	777777	777776
  4797	005564'	777777	777776
  4798	005565'	777777	777776
  4799	005566'	777777	777776
  4800	005567'	777777	777776
  4801	005570'	000000	000000
  4802
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 104
SCNSER.MAC	25-JAN-91 22:40		FILLER	POINTERS AND VARIOUS ECHO POINTERS

  4803	005571'	440700	005601'	TABPTR:	POINT 7,SSPT
  4804	005572'	350700	005601'		POINT 7,SSPT,6		;FILLERS TO SIMULATE TABS WITH SPACES
  4805	005573'	260700	005601'		POINT 7,SSPT,13
  4806	005574'	170700	005601'		POINT 7,SSPT,20
  4807	005575'	100700	005601'		POINT 7,SSPT,27
  4808	005576'	440700	005602'		POINT 7,SSPT+1
  4809	005577'	350700	005602'		POINT 7,SSPT+1,6
  4810	005600'	260700	005602'		POINT 7,SSPT+1,13
  4811
  4812	005601'	201004	020100	SSPT:	BYTE (7) 40,40,40,40,40,40,40,40,0
	005602'	201004	000000
  4813
  4814				;HERE IF CHARACTER IS UPPER CASE
  4815
  4816	005603'	554305	000032	PROUCC:	HLRZ	T1,LDBDCX(U)	;GET LEFT HALF OF DEV CHR EXT WORD
  4817	005604'	602300	010000		TRNE	T1,LXLLCO	;SKIP IF U TO L CASE CONV NOT DESIRED
  4818	005605'	271400	000040		ADDI	T3,40		;CONVERT CHAR TO LOWER CASE
  4819	005606'	135440	000175'		LDB	T4,LDPPOS
  4820	005607'	254000	005350'		JRST	PRCOCW		;PRINT AND COUNT 1 CHARACTER-WIDTH
  4821
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 105
SCNSER.MAC	25-JAN-91 22:40		ONCE A SECOND LOGIC

  4822				SUBTTL ONCE A SECOND LOGIC
  4823
  4824				;THIS ROUTINE IS CALLED EVERY SECOND TO WORRY ABOUT IMAGE MODE
  4825				;TIME OUTS AND TO MAKE SURE THAT SOMEONE WHO IS JUST WAITING
  4826				;FOR SOME SPACE TO FILL HIS OUTPUT BUFFER GETS RESTARTED
  4827
  4828	005610'	205400	000004	SCNSEC::MOVSI	T3,(BV.DBG)	;Get base version and debugging flag
  4829	005611'	616400	000714*		TDNN	T3,BASVER	;Is base being debugged?
  4830	005612'	332000	000000*		SKIPE	CTYDO##		; or running in CONSOLE mode?
  4831	005613'	254000	005650'		 JRST	SCNSC0		;Yes, ignore timeouts
  4832	005614'	200300	000636*		MOVE	T1,KEYTIM##	;Ticks since key was updated
  4833	005615'	200340	000747*		MOVE	T2,IRPTIM##	;Ticks since last input
  4834	005616'	311300	000007		CAML	T1,T2		;Get smaller in T1
  4835	005617'	200300	000007		 MOVE	T1,T2
  4836	005620'	230300	001473*		IDIV	T1,JFYSEC##	;Seconds since last input
  4837			777777	IFCPU(KS),<ND BASTIM,777777>	;Wait a long time on the 2020
  4838			777777		   ND BASTIM,^D90	;1.5 minutes on KI, KL, F3
  4839	005621'	331000	005615*		SKIPL	IRPTIM##	;Only output this message once
  4840	005622'	305300	777777		CAIGE	T1,BASTIM	;Has it been too long?
  4841	005623'	254000	005650'		 JRST	SCNSC0		;No message
  4842	005624'	256000	017413'		 STOPCD (.+1,EVENT,NOBASE,PRTBTM,<No response from BASE>)
  4843	005625'	476000	000713*		SETOM	BASDWN##	;Set flag to mark base down
  4844	005626'	263040	000000		POPJ	P,		;Do something about it next tic
  4845
  4846	005627'	260040	003243*	PRTBTM:	PUSHJ	P,INLMES##	;Called from STOPCD(NOBASE)
  4847	005630'	473364	071312		 ASCIZ /No response from base.  Please reload it.  PDP-10 is still up.
	005631'	717415	767346
	005632'	625014	671336
	005633'	665014	260746
	005634'	625344	020240
	005635'	663134	171712
	005636'	203454	566336
	005637'	607104	064750
	005640'	271004	050210
	005641'	501326	130100
	005642'	647464	071750
	005643'	647315	420352
  4848	005644'	701341	505000	/
  4849	005645'	205300	400000		MOVSI	T1,(1B0)	;Set flag saying NOBASE message output done
  4850	005646'	436300	005621*		IORM	T1,IRPTIM##
  4851	005647'	263040	000000		POPJ	P,
  4852
  4853	005650'			SCNSC0:
  4854	005650'	332000	000562*	IFKMC<	SKIPE	CRSHWD##	;If location 30 is nonzero,
  4855	005651'	260040	006701'		 PUSHJ	P,HNGALL	; hang all jobs before halting 2020
  4856	005652'	201740	000000*		MOVEI	P4,MXLIN##	;FOR EACH LINE
  4857	005653'	350000	016674'		AOS	DRMTIM		;INC MESSAGE TIMER
  4858	005654'	375000	016665'		SOSGE	TIMMIN		;KMC MINUTE COUNTER
  4859					 JRST 	[MOVEI T1,^D60
  4860						MOVEM T1,TIMMIN	;SET FOR ONE MINUTE
  4861						PUSHJ P,SCNMIN	;CALLED EVERY MINUTE
  4862	005655'	254000	017417'			JRST	.+1]
  4863	005656'	375000	016666'		SOSGE	TIMDRD		;COUNTER FOR SERVICING DOWN DRs
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 105-2
SCNSER.MAC	25-JAN-91 22:40		ONCE A SECOND LOGIC

  4864					 JRST 	[MOVEI T1,^D60
  4865						MOVEM T1,TIMDRD	;SET FOR ONE MINUTE
  4866						PUSHJ P,SCNDRD	;TIMING VARIES BUT IS USUALLY 60
  4867	005657'	254000	017423'			JRST	.+1]
  4868				>;END IFKMC
  4869	005660'	200300	017150'		MOVE	T1,PTYFLO
  4870	005661'	202300	017044'		MOVEM	T1,MULCNT+1	;LET PTYS OUTPUT SOME MORE
  4871	005662'	333000	017035'		SKIPLE	OPRTIM
  4872	005663'	373000	017035'		SOSLE	OPRTIM		;IF OPER TIMEOUT HAS GONE OFF,
  4873	005664'	254000	005667'		 JRST	SCNSC1
  4874	005665'	201300	000020		MOVEI	T1,ALROPR
  4875	005666'	436300	000000*		IORM	T1,ALR620	;  SET THE ALARM CELL
  4876	005667'	371000	017046'	SCNSC1:	SOSL	TIMOW		;IF ORANGE-BALL-WAIT HAS GONE OFF,
  4877	005670'	254000	005673'		 JRST	SCNSC2
  4878	005671'	201300	000024		MOVEI	T1,OWTIM
  4879	005672'	202300	017046'		MOVEM	T1,TIMOW	;  RESET IT
  4880	005673'	201740	005652*	SCNSC2:	MOVEI	P4,MXLIN##	;(LOOP THROUGH ALL PORTS)
  4881
  4882	005674'	200257	003215*	SECLOP:	MOVE	U,LINTAB(P4)
  4883	005675'	500245	000031		HLL	U,LDBDCH(U)	;U/ DCH BITS,,LDB ADDR
  4884	005676'	550205	000000		HRRZ	F,LDBDDB(U)	;F/ DDB ADDR
  4885	005677'	200305	000030		MOVE	T1,LDBMOD(U)
  4886	005700'	603300	001000		TLNE	T1,LMLBIO	;IF PORT'S IN BLOCK MODE,
  4887					 JRST	[
  4888						PUSHJ	P,BIOCHG	;CHARGE FOR ELAPSED TIME
  4889						MOVEI	T1,LDRBIP	;CHECK TIMEOUT IF PTY BLKI
  4890						JRST	SECLP1
  4891	005701'	254000	017427'		]
  4892	005702'	205300	002000		MOVSI	T1,LDLIMI	;ELSE CHECK TIMEOUT IF IN IMAGE STATE
  4893	005703'	616305	000031	SECLP1:	TDNN	T1,LDBDCH(U)	;IF WE DON'T CARE ABOUT TIMEOUTS,
  4894	005704'	254000	005742'		 JRST	SECLP2		;  SKIP THIS STUFF
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 106
SCNSER.MAC	25-JAN-91 22:40		ONCE A SECOND LOGIC

  4895				    ;CODE TO CHECK THE PER-PORT TIMEOUT FIELD
  4896
  4897	005705'	135400	000174'		LDB	T3,LDPTIM	;T3/ SECONDS REMAINING, OR 0
  4898	005706'	371000	000010		SOSL	T3		;IF IT WASN'T 0,
  4899	005707'	137400	000174'		DPB	T3,LDPTIM	;  DECREMENT IT
  4900	005710'	326400	005742'		JUMPN	T3,SECLP2	;IF IT JUST RAN OUT,
  4901	005711'	201300	010000		MOVEI	T1,LDRBIP
  4902	005712'	616305	000031		TDNN	T1,LDBDCH(U)	;  IF PTY BLOCK INPUT IS IN PROGRESS,
  4903	005713'	254000	005716'		 JRST	SECTM1
  4904	005714'	260040	003710'		PUSHJ	P,PBTIMO	;    TIME IT OUT
  4905	005715'	254000	005742'		JRST	SECLP2
  4906
  4907	005716'	322200	005736'	SECTM1:	JUMPE	F,SECTM3	;  IF NO DDB, FORCE OUT OF IMAGE STATE
  4908	005717'	135300	000203'		LDB	T1,LDPIMB	;  T1/ 0, OR IMAGE BREAK CHAR
  4909	005720'	326300	005724'		JUMPN	T1,SECTM2	;  IF THERE'S NO BREAK CHAR,
  4910	005721'	260040	006432'		PUSHJ	P,IMGCHG	;    CHARGE FOR A WAKEUP
  4911	005722'	260040	016021'		PUSHJ	P,LINTRP	;    SIGNAL A BREAK
  4912	005723'	260040	005774'		PUSHJ	P,USRWAK	;    WAKE THE JOB
  4913	005724'	603240	000040	SECTM2:	TLNE	U,LDLAUX	;  IF IT'S NOT AN AUX CIRCUIT,
  4914	005725'	254000	005742'		 JRST	SECLP2
  4915	005726'	336005	000012		SKIPN	LDBTIC(U)
  4916	005727'	332005	000014		SKIPE	LDBECC(U)	;    IF THERE'RE NO CHARACTERS,
  4917	005730'	254000	005742'		 JRST	SECLP2
  4918	005731'	205000	000040		MOVSI	S,IOEND
  4919	005732'	437004	000002		IORB	S,DEVIOS(F)	;      SET EOF
  4920	005733'	602000	000010		TRNE	S,10
  4921	005734'	602000	000007		TRNE	S,7
  4922	005735'	254000	005742'		 JRST	SECLP2		;      IF IMAGE MODE,
  4923	005736'	205300	002000	SECTM3:	MOVSI	T1,LDLIMI
  4924	005737'	412305	000031		ANDCAM	T1,LDBDCH(U)	;        FORCE OUT OF IMAGE STATE
  4925	005740'	260040	014016'		PUSHJ	P,BPOFF		;        CLEAR BACKPRESSURE
  4926	005741'	260040	007603'		PUSHJ	P,SETLMD	;        FIX LINE MODE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 107
SCNSER.MAC	25-JAN-91 22:40		ONCE A SECOND LOGIC

  4927				    ;THE REST OF THE PER-PORT ONCE-A-SECOND CODE
  4928
  4929	005742'	205300	000400	SECLP2:	MOVSI	T1,L2LOWT
  4930	005743'	336000	017046'		SKIPN	TIMOW		;IF ORANGE-BALL-WAIT TIMER'S GONE OFF
  4931	005744'	616305	000027		TDNN	T1,LDBBYT(U)	;AND PORT'S WAITING FOR ORANGE BALL,
  4932	005745'	254000	005752'		 JRST	SECLP3
  4933	005746'	205300	002000		MOVSI	T1,L2LOWS
  4934	005747'	616305	000027		TDNN	T1,LDBBYT(U)	;  IF WE HAVEN'T BEEN HERE BEFORE,
  4935					 JRST	[
  4936						IORM	T1,LDBBYT(U)	;SET THE ONCE-BEFORE FLAG
  4937						JRST	SECLP3
  4938	005750'	254000	017432'		]
  4939	005751'	260040	001260'		PUSHJ	P,OBFND		;  IF WE HAVE, FAKE AN ORANGE BALL
  4940
  4941				;P035/C06 17-Nov-87 - Watch for lost zappers.
  4942			400000		..==LNLZIN		;CREF this reference to sign bit
  4943	005752'	335005	000001	SECLP3:	SKIPGE	LDBLIN(U)	;Is there an in-zap seen?
  4944					 JRST	[MOVEI  T1,1	    ;Yes
  4945						 LDB    T2,LDBOPB(U);See if it is scheduled to go out
  4946						 DPB    T1,LOPZAP   ;Make sure the "send zap" bit is on
  4947						 DPB    T1,LDBOPB(U); and "need output" is on
  4948						 MOVSI  T1,L2LOWT   ; and orange-ball wait
  4949						 ANDCAM T1,LDBBYT(U); is off
  4950						 SKIPN  T2          ;If it wasn't scheduled,
  4951						  AOS    NZAPRS	   ;Count number of zaps resent
  4952	005753'	254000	017434'			 JRST  .+1]
  4953	005754'	322200	005765'		JUMPE	F,SECLP4	;IF THERE'S A DDB
  4954	005755'	205000	200000		MOVSI	S,TWTSPC
  4955	005756'	616004	000002		TDNN	S,DEVIOS(F)	;AND IT'S WAITING FOR BUFFERLETS
  4956	005757'	254000	005765'		 JRST	SECLP4
  4957	005760'	200300	017017'		MOVE	T1,TTFREN
  4958	005761'	307300	000003		CAIG	T1,TIRSVD	;AND THERE'RE ENOUGH NOW,
  4959	005762'	254000	005765'		 JRST	SECLP4
  4960	005763'	412004	000002		ANDCAM	S,DEVIOS(F)	;  CLEAR BUFFERLET-WAIT BIT
  4961	005764'	260040	006126'		PUSHJ	P,XMTWAK	;  AND AWAKEN JOB
  4962	005765'	367740	005674'	SECLP4:	SOJG	P4,SECLOP	;(CONTINUE WITH NEXT PORT)
  4963	005766'	263040	000000		POPJ	P,
  4964
  4965
  4966	005767'	322200	005472*	BIOCHG:	JUMPE	F,CPOPJ		;CHECK FOR DETACHED JOB.
  4967	005770'	135300	003331*		LDB	T1,PJOBN	;PICK UP HIS JOB NUMBER.
  4968	005771'	350006	000000*		AOS	JBTBET(T1)	;INCREMENT HIS ELAPSED BIO TIME.
  4969	005772'	350000	005771*		AOS	JBTBET		;INCR TOTAL ELAPSED BIO TIME.
  4970	005773'	263040	000000		POPJ	P,		;AND RETURN.
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 108
SCNSER.MAC	25-JAN-91 22:40		MISC STUFF FOR INPUT AND OUTPUT

  4971				SUBTTL MISC STUFF FOR INPUT AND OUTPUT
  4972				;SUBROUTINE TO WAKE UP JOB IF IT IS IN TTY INPUT WAIT. CALL WITH
  4973				;U SET UP. IT WILL SET F AND S AS NEEDED.
  4974
  4975	005774'	550305	000005	USRWAK:	HRRZ	T1,LDBBIO(U)	; DOING BLOCK INPUT ?
  4976	005775'	322300	006000'		JUMPE	T1,USRWK1	; NO
  4977	005776'	335006	000005		SKIPGE	BIOCHR(T1)	; YES. REQUEST IN PROGRESS ?
  4978	005777'	263040	000000		 POPJ	P,		; YES. LEAVE IT ALONE.
  4979	006000'			BIOWAK:
  4980				IFCPU (KL),<
  4981					TLNE	S,IO		;IF BLOCK INPUT,
  4982					 JRST	USRWK1		;(OUTPUT, FORGET IT)
  4983					HRRZ	T1,LDBBIO(U)	;THEN MUST MAKE SURE EDGES OF DATA NOT IN CACHE
  4984					JUMPE	T1,USRWK1
  4985					ADDI	T1,BIODAT	;GET ADDRESS OF 1ST DATA WORD
  4986					CSHREF			;TAKE THAT 4 WD CHUNK OUT OF THE CACHE
  4987					HRRZ	T1,LDBBIO(U)	;GET ADDRESS AGAIN
  4988					ADDI	T1,BIOCOR*4-1	;ADDRESS OF LAST WORD
  4989					CSHREF			;THAT TAKES CARE OF ADJACENT REFS DURING I/O
  4990				>;END IFCPU (KL)
  4991	006000'	205300	010000	USRWK1:	MOVSI	T1,L2LLDF
  4992	006001'	412305	000027		ANDCAM	T1,LDBBYT(U)	;TURN OFF WHEN USER IS AWAKENED
  4993	006002'	550205	000000		HRRZ	F,LDBDDB(U)	;GET ADDRESS OF ATTACHED F
  4994	006003'	322200	006021'		JUMPE	F,RCVWK1	;IF NONE,SKIP THIS CODE
  4995	006004'	200004	000002		MOVE	S,DEVIOS(F)	;GET STATUS OF TTY FROM F
  4996	006005'	602000	010000		TRNE	S,IOACT		;SINCE IOW MAY NOT BE SET YET
  4997	006006'	603000	400000		TLNE	S,TTYOUW	;YES. FOR INPUT WAIT?
  4998	006007'	254000	006021'		 JRST	RCVWK1		;NO. DONT WAKE JOB.
  4999	006010'	607000	000001	TIWAKE:	TLNN	S,IOW		;IS IOW REALLY SET
  5000	006011'	254000	006022'		 JRST	TIWAKN		;NO
  5001	006012'	200000	017445'		MOVE	S,[XWD IOW,IOACT];YES. CLEAR WAIT BITS
  5002	006013'	413004	000002		ANDCAB	S,DEVIOS(F)	;IN F FOR THIS JOB
  5003	006014'	261040	000006		PUSH	P,T1		;SAVE VOLATILE AC'S
  5004	006015'	261040	000007		PUSH	P,T2		; ..
  5005	006016'	260040	000000*		PUSHJ	P,STTIOD	;SET JOB TO TS STATE
  5006	006017'	262040	000007		POP	P,T2		;RESTORE AC'S
  5007	006020'	262040	000006		POP	P,T1		; ..
  5008	006021'	263040	000000	RCVWK1:	POPJ	P,0		;RETURN FROM RCVWAK
  5009
  5010	006022'	201000	010000	TIWAKN:	MOVEI	S,IOACT
  5011	006023'	413004	000002		ANDCAB	S,DEVIOS(F)	;JUST RESET IOACT
  5012	006024'	263040	000000		POPJ	P,
  5013
  5014	006025'	200305	000031	FULLCQ:	MOVE	T1,LDBDCH(U)
  5015	006026'	607300	020000		TLNN	T1,LDLCOM	;IF NOT CMND MODE
  5016	006027'	616300	017446'		TDNN	T1,[LDLBKA,,LDRFCS];AND HE WANTS TO SEE EDIT CHARS,
  5017	006030'	350001	000000		 AOS	(P)
  5018	006031'	263040	000000		POPJ	P,		;  NONSKIP-RETURN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 109
SCNSER.MAC	25-JAN-91 22:40		SUBROUTINE TO SEE IF A CONTROL C SHOULD BE ACTED ON OR STORED.

  5019				SUBTTL	SUBROUTINE TO SEE IF A CONTROL C SHOULD BE ACTED ON OR STORED.
  5020				;NON-SKIP MEANS STORE IT.
  5021				;SKIP MEANS DO IT.
  5022
  5023	006032'	603240	020000	CNCCHK:	TLNE	U,LDLCOM	;SHOULD ^C BE RETURNED?
  5024	006033'	263040	000000		 POPJ	P,0		;YES.
  5025	006034'	261040	000006		PUSH	P,T1		;MAYBE NOT. SAVE TAC.
  5026	006035'	550205	000000		HRRZ	F,LDBDDB(U)	;GET U'S JOB
  5027	006036'	322200	006046'		JUMPE	F,CNCCK1	;IF NO F ATTACHED, ASSUME SHOULD DO ^C
  5028	006037'	205300	020000		MOVSI	T1,TTYATC
  5029	006040'	616304	000004		TDNN	T1,DEVMOD(F)
  5030	006041'	254000	000000*		 JRST	TPOPJ		;THIS IS A SLAVED TTY
  5031	006042'	135300	005770*		LDB	T1,PJOBN	; ..
  5032	006043'	200306	001162*		MOVE	T1,JBTSTS(T1)	;GET JOB STATUS WORD
  5033	006044'	612300	017447'		TDNE	T1,[XWD JACCT,JACCT2] ;IS ^C LEGAL?
  5034	006045'	254000	006041*		 JRST	TPOPJ		;NO. GIVE IT TO CUSP
  5035	006046'	260040	014250'	CNCCK1:	PUSHJ	P,CNCMOD	;FORCE LINE TO BE AT COMMAND LEVEL
  5036	006047'	201300	000000*		MOVEI	T1,CMFCHT##
  5037	006050'	260040	014046'		PUSHJ	P,TTFORC	;FORCE HALT COMMAND
  5038	006051'	254000	000000*		JRST	TPOPJ1		;RESTORE T1, SKIP RETURN
  5039
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 110
SCNSER.MAC	25-JAN-91 22:40		THIS ROUTINE TRACES BACKWARDS DOWN A LINKED LIST TO THE START

  5040				SUBTTL	THIS ROUTINE TRACES BACKWARDS DOWN A LINKED LIST TO THE START
  5041				;AND THEN ADDS THE WHOLE LIST TO THE FREE LIST.
  5042				;Called from GORUB/PGRUB after outputing rubout characters.
  5043				;Called from TSETBI/TSETBO to clear input/output buffers.
  5044				;Uses T1 and T2 only.
  5045
  5046	006052'	260040	006102'	FREUP:	PUSHJ	P,CHECKU	;Check on address in U
  5047	006053'	405340	777774		ANDI	T2,777774	;GET BASE ADDRESS
  5048	006054'	311340	017212'	FREST:	CAML	T2,RCC.LO	;Check if this is a reasonable pointer
  5049	006055'	313340	017213'		CAMLE	T2,RCC.HI	; to the TTY chunks
  5050	006056'	256000	017450'		 STOPCD (RCC.T3,INFO,RCCDBG,RCC.T1,<Range Checked Chunk, continuing>)
  5051	006057'	554307	000000		HLRZ	T1,(T2)		;LOOK FOR BACK LINKS
  5052	006060'	322300	006063'		JUMPE	T1,STLST	;FOUND START
  5053	006061'	200340	000006		MOVE	T2,T1		;TRY SOME MORE
  5054	006062'	254000	006054'		JRST	FREST
  5055
  5056				;JMS 7-May-86 - X95(KS) has a nasty habit of looping here.  Added TTYFLM.
  5057
  5058	006063'	332300	002427*	STLST:	SKIPE	T1,TTFREE##	;Pointer to current free list (0 is OK)
  5059	006064'	311300	017212'		 CAML	T1,RCC.LO	;Check if this is a reasonable pointer
  5060	006065'	313300	017213'		CAMLE	T1,RCC.HI	; to the TTY chunks
  5061	006066'	403300	006063*		 SETZB	T1,TTFREE##	;Was bad, start with a new free list
  5062	006067'	250307	000000		EXCH	T1,(T2)		;Make current chunk point to the old free list
  5063	006070'	552340	006066*		HRRZM	T2,TTFREE##	;Put current chunk at start of free list
  5064	006071'	350000	017017'		AOS	TTFREN		;Mark one more free
  5065	006072'	602300	777777		TRNE	T1,777777	;If there is a next pointer,
  5066	006073'	554346	000000		 HLRZ	T2,(T1)		; get its back pointer
  5067	006074'	621340	777777		TLZ	T2,777777	;Clear LH for compare
  5068	006075'	312340	006070*		CAME	T2,TTFREE##	;Does next point back to current?
  5069	006076'	256000	017454'		 STOPCD (RCC.T3,INFO,TTYFLM,RCC.T1,<TTY Free List Messed Up>)
  5070				 ;;STLST+7
  5071	006077'	550340	000006		HRRZ	T2,T1		;Did current chunk have a next one?
  5072	006100'	326340	006063'		JUMPN	T2,STLST	;Yes, continue until all are freed up
  5073	006101'	263040	000000		POPJ	P,		;All done
  5074
  5075				;Check on U.  Uses T1.
  5076	006102'	550300	000005	CHECKU:	HRRZ	T1,U		;Make sure U is pointing to a legal LDB
  5077	006103'	306300	000105'		CAIN	T1,CTYLDB
  5078	006104'	263040	000000		 POPJ	P,		;CTYLDB is outside the range of LDB.LO-LDB.HI
  5079	006105'	311300	017214'		CAML	T1,LDB.LO
  5080	006106'	313300	017215'		CAMLE	T1,LDB.HI
  5081	006107'	256000	017460'		 STOPCD (RCC.T3,DEBUG,RCCBAD,RCC.T1,<Range Checked Chunk, bad U>)
  5082	006110'	263040	000000		POPJ	P,
  5083
  5084				;Resume address from RCC stopcodes - Set T1,T2,T3 to reasonable values
  5085	006111'	403300	000007	RCC.T3:	SETZB	T1,T2
  5086	006112'	201400	000003		MOVEI	T3,'C'-'@'	;Return Control-C
  5087	006113'	263040	000000		POPJ	P,
  5088
  5089				;Output contents of T1,T2, and U on STOPCD(TTYFLM) and STOPCD(RCCDGB)
  5090	006114'	550205	000000	RCC.T1:	HRRZ	F,LDBDDB(U)
  5091	006115'	260040	000000*		PUSHJ	P,PRTDDB##	;Output TTY name
  5092	006116'	265300	000000*		JSP	T1,BGCTYP##	;Output contents of T1, T2, and U
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 110-2
SCNSER.MAC	25-JAN-91 22:40		THIS ROUTINE TRACES BACKWARDS DOWN A LINKED LIST TO THE START

  5093	006117'	642100	000000		  EXP	'T1    ',T1,'T2    ',T2,'LDB   ',U,0
	006120'	000000	000006
	006121'	642200	000000
	006122'	000000	000007
	006123'	544442	000000
	006124'	000000	000005
	006125'	000000	000000
  5094
  5095
  5096	006126'	550205	000000	XMTWAK:	HRRZ	F,LDBDDB(U)
  5097	006127'	322200	005767*		JUMPE	F,CPOPJ		;NO JOB HOOKED TO IT
  5098	006130'	205000	000400		MOVSI	S,L2LOWT	;IF WAITING FOR ORANGE BALL
  5099	006131'	612005	000027		TDNE	S,LDBBYT(U)
  5100	006132'	263040	000000		 POPJ	P,		;DON'T WAKE UP OUTPUT
  5101	006133'	200004	000002		MOVE	S,DEVIOS(F)
  5102	006134'	607000	040000		TLNN	S,TINFIO
  5103	006135'	254000	006146'		 JRST	XMTWK1
  5104	006136'	135300	000231'		LDB	T1,DDPTTS	;NOW TRAP ON READY FOR MORE OUTPUT
  5105	006137'	261040	000002		PUSH	P,J
  5106	006140'	260040	001741*		PUSHJ	P,TAKTRJ
  5107	006141'	205000	040000		MOVSI	S,TINFIO
  5108	006142'	413004	000002		ANDCAB	S,DEVIOS(F)
  5109	006143'	201100	000400		MOVEI	J,LXRIOS
  5110	006144'	436105	000032		IORM	J,LDBDCX(U)
  5111	006145'	262040	000002		POP	P,J
  5112	006146'	602000	010000	XMTWK1:	TRNE	S,IOACT		;SINCE IOW MAY NOT BE SET YET
  5113	006147'	607000	400000		TLNN	S,TTYOUW
  5114	006150'	263040	000000		 POPJ	P,		;NOT WAITING SO DONE
  5115	006151'	324740	006010'		PJRST	TIWAKE		;WAKE HIM UP
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 111
SCNSER.MAC	25-JAN-91 22:40		CHUNK HANDLERS

  5116				SUBTTL CHUNK HANDLERS
  5117
  5118				;SUBROUTINE TO READ A CHARACTER FROM A TELETYPE BUFFER
  5119				;CALL WITH T2 CONTAINING A BYTE POINTER TO THE LIST
  5120				;THIS ROUTINE WILL IBP T2 WHICH MAY POINT IT INTO A LINK WORD
  5121				;ALSO WE MAY BE CALLED WITH THE POINTER DECREMENTED SO THAT
  5122				;IBP WILL POINT TO THE CURRENT CHUNKS LINK WORD
  5123				;THIS ROUTINE WILL CORRECTLY FOLLOW THE LINKS. THE ROUTINE
  5124				;WILL NORMALLY SKIP RETURN. THE NON-SKIP RETURN IS TAKEN IF
  5125				;IT WAS NECESSARY TO FOLLOW A LINK. IN THIS CASE, T1
  5126				;CONTAINS THE BASE ADDRESS OF THE NEW CHUNK.
  5127				;ON RETURN, T2 CONAINS THE BYTE POINTER TO THE CHARACTER
  5128				;JUST OBTAINED, AND T3 THE CHARACTER
  5129
  5130	006152'	260040	006102'	TTGETC:	PUSHJ	P,CHECKU	;Make sure U is pointing to a legal LDB
  5131	006153'	134400	000007		ILDB	T3,T2		;IF WE GET INTO A LINK WORD, T3 WILL NOT
  5132								;BE WHAT WE WANT BUT NOTHING WILL HAVE
  5133								;BEEN CLOBBERED
  5134	006154'	602340	000003		TRNE	T2,3		;ALL LINK WORDS ARE IN WORDS AT AN ADDRESS
  5135								;WHICH IS A MULTIPLE OF 4
  5136	006155'	254000	005515*		 JRST	CPOPJ1		;ALL OK, JUST RETURN
  5137	006156'	550307	777774		HRRZ	T1,-4(T2)	;THIS WILL BE THE FORWARD LINK TO NEXT CHUNK
  5138	006157'	607340	770000		TLNN	T2,770000	;IF WE ARE AT THE RIGHT END OF THE WORD
  5139								;WE MUST HAVE BACKED UP
  5140	006160'	554307	000000		 HLRZ	T1,(T2)		;SO GET BACK LINK (T2 POINTS TO FIRST WORD OF CHUNK)
  5141	006161'	322300	006173'		JUMPE	T1,TTGC1	;NO LINK THERE
  5142	006162'	311300	017212'		CAML	T1,RCC.LO	;Check if this is a reasonable pointer
  5143	006163'	313300	017213'		CAMLE	T1,RCC.HI	; to the TTY chunks
  5144	006164'	256000	006056'		 STOPCD (,XCT,RCCDBG)
  5145					;Forward/back pointer is bad
  5146	006165'	540340	000006		HRR	T2,T1		;NOW POINT TO CORRECT WORD
  5147	006166'	603340	770000		TLNE	T2,770000
  5148	006167'	354000	000007		 AOSA	T2		;IF FORWARD, POINT TO FIRST CHR
  5149	006170'	271340	000003		ADDI	T2,TTCHKS-1	;IF BACKWARD, TO LAST
  5150	006171'	135400	000007		LDB	T3,T2		;NOW GET THE CHARACTER
  5151	006172'	263040	000000		POPJ	P,		;AND RETURN SAYING PASSED A LINK
  5152
  5153				;Stop at TTYNNC may be related to ZAP (or nonzap) at LDEC
  5154
  5155	006173'	603340	770000	TTGC1:	TLNE	T2,770000	;IS THIS A BACKUP
  5156	006174'	256000	017464'		 STOPCD (TSETBI,INFO,TTYNNC,,<TTY - No Next Chunk>)
  5157				 ;;TTGC1+1
  5158	006175'	201400	000000		MOVEI	T3,0		;GIVE BACK 0
  5159	006176'	254000	006155*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 112
SCNSER.MAC	25-JAN-91 22:40		SUBROUTINE TO PLACE A CHARACTER IN A BUFFER.

  5160				SUBTTL	SUBROUTINE TO PLACE A CHARACTER IN A BUFFER.
  5161				;CHARACTER IS IN T3. T2 CONTAINS A BYTE POINTER TO LAST
  5162				;CHARACTER PLACED IN BUFFER. WE WANT TO DO AN IDPB T3,T2 BUT
  5163				;MUST WATCH FOR LINKS. WILL FOLLOW A FORWARD LIST IF IT
  5164				;EXISTS OR GET A NEW CHUNK IF NECESSARY
  5165
  5166	006177'	133000	000007	TTPUTC:	IBP	T2		;MUST NOT IDPB SINCE MIGHT CLOBBER SOMETHING
  5167	006200'	602340	000003		TRNE	T2,3		;ARE WE IN A LINK?
  5168	006201'	254000	006231'		 JRST	TTPC1		;NO, ALL OK
  5169	006202'	550307	777774		HRRZ	T1,-4(T2)	;GET LINK
  5170	006203'	607340	770000		TLNN	T2,770000
  5171	006204'	256000	000000'		 STOPCD			;SOMEONE CALLED US AFTER BACKING UP
  5172	006205'	326300	006230'		JUMPN	T1,TTPC2	;HAVE A FORWARD LINK ALREADY
  5173	006206'	200300	006075*		MOVE	T1,TTFREE##	;GET A NEW CHUNK
  5174	006207'	311300	017212'		CAML	T1,RCC.LO	;Check if this is a reasonable pointer
  5175	006210'	313300	017213'		CAMLE	T1,RCC.HI	; to the TTY chunks
  5176	006211'	256000	017467'		 STOPCD (.,STOP,RCCSTP,RCC.T1,<Range Checked Chunk - TTFREE is bad, stop>)
  5177	006212'	261040	000014		PUSH	P,P1		;GET A REGISTER TO WORK WITH
  5178	006213'	550606	000000		HRRZ	P1,(T1)		;Current points to new first free chunk
  5179	006214'	332000	000014		SKIPE	P1		;Zero if T1 points to very last chunk on system
  5180	006215'	311600	017212'		 CAML	P1,RCC.LO	;Check if this is a reasonable pointer
  5181	006216'	313600	017213'		CAMLE	P1,RCC.HI	; to the TTY chunks
  5182	006217'	256000	006211'		 STOPCD (,XCT,RCCSTP)
  5183					;Die - TTFREE is bad
  5184	006220'	202600	006206*		MOVEM	P1,TTFREE##	;UPDATE FREE POINTER
  5185	006221'	332000	000014		SKIPE	P1
  5186	006222'	553014	000000		 HRRZS	(P1)		;MAKE SURE NO BACK LINE IF A CHUNK LEFT
  5187	006223'	370000	017017'		SOS	TTFREN		;COUNT CHUNK TAKEN
  5188	006224'	515607	777774		HRLZI	P1,-4(T2)	;GET A BACK LINK
  5189	006225'	202606	000000		MOVEM	P1,(T1)		;TO PUT IN NEW CHUNK
  5190	006226'	542307	777774		HRRM	T1,-4(T2)	;AND PUT IN FORWARD LINK
  5191	006227'	262040	000014		POP	P,P1
  5192	006230'	541346	000001	TTPC2:	HRRI	T2,1(T1)	;NOW RESET BYTE POINTER
  5193	006231'	137400	000007	TTPC1:	DPB	T3,T2		;STORE AWAY CHARACTER
  5194	006232'	263040	000000		POPJ	P,		;ALL DONE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 113
SCNSER.MAC	25-JAN-91 22:40		ROUTINE TO FREE UP A CHUNK OF THE CHARACTER LIST BY LINKING IT

  5195				SUBTTL	ROUTINE TO FREE UP A CHUNK OF THE CHARACTER LIST BY LINKING IT
  5196				;ONTO THE FRONT OF THE FREE-LIST. ASSUMES THAT TTGETC HAS JUST BEEN
  5197				;CALLED SO T1 CONTAINS THE ADDRESS OF THE CHUNK AFTER THE ONE
  5198				;TO RETURN TO THE FREE LIST.
  5199				;T1 has already been verified to be between RCC.LO and RCC.HI by TTGETC
  5200
  5201	006233'	261040	000007	FRECHK:	PUSH	P,T2
  5202	006234'	554346	000000		HLRZ	T2,(T1)		;RETRIEVE THE LINK TO THE ONE TO PUT BACK
  5203	006235'	553006	000000		HRRZS	(T1)		;NO BACK LINK IN THIS CHUNK NOW
  5204	006236'	250340	006220*		EXCH	T2,TTFREE##	;PUT OLD ON FREE LIST
  5205	006237'	552360	006236*		HRRZM	T2,@TTFREE##	;RELINK REST OF FREE LIST AFTER THIS ONE
  5206	006240'	350000	017017'		AOS	TTFREN
  5207	006241'	262040	000007		POP	P,T2
  5208	006242'	263040	000000		POPJ	P,
  5209
  5210				;ROUTINE TO GET A FREE CHUNK FROM THE FREELIST. SETS UP
  5211				;A BYTE POINTER IN T2. CLOBBERS T1
  5212
  5213	006243'	200340	006237*	GETCHK:	MOVE	T2,TTFREE##	;This should have been checked for 0 earlier
  5214	006244'	311340	017212'		CAML	T2,RCC.LO	;Check if this is a reasonable pointer
  5215	006245'	313340	017213'		CAMLE	T2,RCC.HI	; to the TTY chunks
  5216	006246'	256000	006211'		 STOPCD (,XCT,RCCSTP)
  5217					;Die - TTFREE is bad (or all chunks in use)
  5218	006247'	550307	000000		HRRZ	T1,(T2)		;THE NEXT ELEMENT
  5219	006250'	202300	006243*		MOVEM	T1,TTFREE##	;RESET FREE LIST
  5220				;P035/D08 when getting first chunk on list, make sure second chunk does
  5221				; not have a back pointer to the first chunk.  /JMS 12-Jul-88
  5222	006251'	332000	000006		SKIPE	T1		;As long as free list is not empty,
  5223	006252'	553006	000000		 HRRZS	(T1)		; make sure it doesn't point to this one
  5224	006253'	402007	000000		SETZM	(T2)		;NO LINKS IN THIS NEW ONE
  5225	006254'	505340	001100		HRLI	T2,(POINT 9,0,35) ;POINT SO THAT IBP POINT TO 1ST CHR
  5226	006255'	370000	017017'		SOS	TTFREN		;ONE LESS
  5227	006256'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 114
SCNSER.MAC	25-JAN-91 22:40		TSETBI - CLEAR INPUT BUFFER

  5228				SUBTTL	TSETBI - CLEAR INPUT BUFFER
  5229
  5230	006257'			TSETBI::	;P035/D08 - commented out code to special case zapped lines
  5231				;*;	MOVSI	T1,LLLZAP
  5232				;*;	TDNE	T1,LDBLOG(U)	;DO NOT ZAP IF TRYING TO GET RID OF HIM
  5233				;*;	 POPJ	P,
  5234	006257'	332345	000010		SKIPE	T2,LDBTIP(U)	;CLEAR THIS LIST
  5235	006260'	260040	006052'		 PUSHJ	P,FREUP		;BUT ONLY IF ONE IS THERE
  5236	006261'	332345	000023		SKIPE	T2,LDBRBI(U)	;AND THIS ONE TOO
  5237	006262'	260040	006052'		 PUSHJ	P,FREUP
  5238	006263'	402005	000010		SETZM	LDBTIP(U)
  5239	006264'	402005	000011		SETZM	LDBTIT(U)
  5240	006265'	402005	000012		SETZM	LDBTIC(U)
  5241	006266'	402005	000015		SETZM	LDBBKC(U)
  5242	006267'	402005	000016		SETZM	LDBBK2(U)
  5243	006270'	402005	000007		SETZM	LDBBKI(U)
  5244	006271'	402005	000006		SETZM	LDBBKP(U)
  5245	006272'	402005	000013		SETZM	LDBECT(U)
  5246	006273'	402005	000014		SETZM	LDBECC(U)
  5247	006274'	402005	000025		SETZM	LDBRBC(U)
  5248	006275'	402005	000024		SETZM	LDBRBO(U)
  5249	006276'	402005	000023		SETZM	LDBRBI(U)
  5250	006277'	205340	100000		MOVSI	T2,LDLECS
  5251	006300'	412345	000031		ANDCAM	T2,LDBDCH(U)	;MUST CLEAR COMMAND SYNC BIT
  5252	006301'	500245	000031		HLL	U,LDBDCH(U)	;LET PEOPLE KNOW ABOUT IT
  5253	006302'	205340	204000		MOVSI	T2,L2LDEL!L2LCCS
  5254	006303'	412345	000027		ANDCAM	T2,LDBBYT(U)
  5255	006304'	324740	014015'		PJRST	BPXOFF		;GET OUT OF BACKPRESSURE OR XOFF
  5256
  5257				;TSETBO - CLEAR OUTPUT BUFFER
  5258				;Uses T1 and T2 only
  5259
  5260	006305'	332345	000017	TSETBO:	SKIPE	T2,LDBTOP(U)
  5261	006306'	260040	006052'		 PUSHJ	P,FREUP
  5262	006307'	402005	000017	TSTBO1:	SETZM	LDBTOP(U)	;OUTPUT PUTTER
  5263	006310'	402005	000021		SETZM	LDBTOC(U)	;OUTPUT COUNT
  5264	006311'	402005	000020		SETZM	LDBTOT(U)	;OUTPUT TAKER
  5265	006312'	402005	000022		SETZM	LDBFLP(U)	;AND FILLERS CURRENTLY GOING
  5266	006313'	550300	000005		HRRZ	T1,U
  5267	006314'	316300	017027'		CAMN	T1,OPRLDB	;IS THIS OPR
  5268	006315'	260040	014737'		 PUSHJ	P,OPRFRE	;YES, MAY NEED TO RESTART JOBS
  5269	006316'	201340	000001		MOVEI	T2,1
  5270	006317'	205300	000400		MOVSI	T1,L2LOWT
  5271	006320'	616305	000027		TDNN	T1,LDBBYT(U)	;IF WE'RE WAITING FOR AN ORANGE BALL,
  5272	006321'	254000	006324'		 JRST	TSTBO2
  5273	006322'	412305	000027		ANDCAM	T1,LDBBYT(U)	;  STOP WAITING
  5274	006323'	137340	000077'		DPB	T2,LOPSYL	;  SEND YELLOW BALL
  5275	006324'	137340	000060'	TSTBO2:	DPB	T2,LOPCGB	;SEND GOBBLER
  5276	006325'	205300	400000		MOVSI	T1,LDLNOP	;SEND EVEN IF SAYS SHOULD NOT
  5277	006326'	412305	000031		ANDCAM	T1,LDBDCH(U)
  5278	006327'	137345	000002		DPB	T2,LDBOPB(U)
  5279	006330'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 115
SCNSER.MAC	25-JAN-91 22:40		BUFFERED I/O UUO-LEVEL ROUTINES

  5280				SUBTTL BUFFERED I/O UUO-LEVEL ROUTINES
  5281
  5282				;DISPATCH TABLE FOR MUUO'S AND INITIALIZATION
  5283
  5284	000000			SCNDSP:	PHASE 0
  5285	006331'	000000	000012	DDXZ:	DSPSIZ
  5286	006332'	263040	000000	DDINT:	POPJ P,
  5287	006333'	001000	001000	DBYT:	1000,,1000
  5288	006334'	201300	000016	DVSIZ:	MOVEI T1,SCNDDS
  5289	006335'	254000	016354'	DINI:	JRST TTYINI
  5290	006336'	254000	006176*	DHNG:	JRST CPOPJ1
  5291	006337'	263040	000000	DRL:	POPJ P,
  5292	006340'	254000	000000*	DCL:	JRST OUT
  5293	006341'	254000	006445'	DOU:	JRST TTYOUT
  5294	006342'	254000	006344'	DIN:	JRST TTYIN
  5295	006343'	254000	011243'	DZAP:	JRST AUXZAP
  5296			000012		DSPSIZ==.-1
  5297	006344'				DEPHASE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 116
SCNSER.MAC	25-JAN-91 22:40		INPUT UUO PROCESSOR - CALLED FROM UUOCON ON INPUT M, F SET UP

  5298				SUBTTL	INPUT UUO PROCESSOR - CALLED FROM UUOCON ON INPUT M, F SET UP
  5299
  5300	006344'	260040	013477'	TTYIN:	PUSHJ	P,CKATTI	;MAKE SURE ATTACHED. SET S.
  5301	006345'	254000	000000*		  JRST	ABTUUO		;WAITING FOR AN INTERRUPT. ABORT
  5302					JUMPE	U,[MOVSI S,IOEND
  5303	006346'	322240	017473'			JRST TTYINX]	;ZAPPED AUX CIRCUIT GIVE EOF
  5304	006347'	260040	000000*		NOCHARGE
  5305	006350'	260040	007556'		PUSHJ	P,FIXIMI	;SET IMAGE STATE FROM DATA MODE
  5306	006351'	260040	013621'		PUSHJ	P,TWAITL	;BECOME ATTACHED, WAIT FOR U
  5307								; OR FULL BUFFER CONDITION
  5308	006352'	607240	002000		TLNN	U,LDLIMI	;IMAGE HAS ALREADY CHARGED
  5309	006353'	260040	006411'		PUSHJ	P,SETBRK	;CHARGE FOR A BREAK CHR
  5310	006354'	550304	000007	TTYIN5:	HRRZ	T1,DEVIAD(F)		;PREPARE AND ADDR CHECK THE
  5311	006355'	260040	000000*		PUSHJ	P,BUFCLR		; USER'S BUFFER
  5312	006356'	254000	000000*		  JRST	ADRERR			;OUT OF BOUNDS. STOP JOB.
  5313	006357'	550604	000007		HRRZ	P1,DEVIAD(F)		;PREPARE BYTE POINTER TO STORE
  5314									; THE CHARACTERS IN HIS BUFFER
  5315	006360'	256040	017476'		XCTFU <LDB P2,[POINT 17,(P1),17]>	;BUFFER SIZE IN WORDS
  5316	006361'	275640	000001		SUBI	P2,1			;MINUS LINK
  5317	006362'	550244	000013		HRRZ	U,DDBLDB(F)		;RESTORE U, CLOBBERED IN UUOCON
  5318	006363'	500245	000031		HLL	U,LDBDCH(U)	;ALSO GET BITS
  5319	006364'	550304	000006		HRRZ	T1,DEVBUF(F)	;BUFFER POINTER FOR SIZE
  5320	006365'	260040	006437'		PUSHJ	P,TTYSZS		;SET SIZES
  5321									;FALL INTO MAIN PART OF ROUTINE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 117
SCNSER.MAC	25-JAN-91 22:40		INPUT UUO PROCESSOR - CALLED FROM UUOCON ON INPUT M, F SET UP

  5322
  5323	006366'	260040	013135'	TTYIN1:	PUSHJ	P,TYI			;GET A CHARACTER
  5324	006367'	254000	006374'		  JRST	TTYIN3			; END OF BUFFER.
  5325	006370'	405400	000377		ANDI	T3,377
  5326	006371'	256040	017477'		XCTFU <IDPB T3,P1>			;AND STORE IN USER AREA
  5327	006372'	302340	000002		CAIE	T2,%CHBRK		;A BREAK?
  5328	006373'	367640	006366'		SOJG	P2,TTYIN1			;NO. LOOP FOR MORE, IF ROOM.
  5329	006374'	200644	000007	TTYIN3:	MOVE	P2,DEVIAD(F)		;COMPUTE WORD COUNT FOR UUOCON
  5330	006375'	275615	000001		SUBI	P1,1(P2)			; TO PUT IN BUFFER HEADER.
  5331	006376'	256200	017500'		XCTFU <HRRM P1,1(P2)>			;STORE WITH THE DATA IN RING
  5332	006377'	260040	000000*		PUSHJ	P,ADVBFF			;ON TO NEXT BUFFER
  5333	006400'	334000	000000		  SKIPA				;NO MORE THERE.
  5334	006401'	254000	006405'		JRST	TTYIN6			;MORE TO GO. USE IF IMAGE.
  5335	006402'	205000	000004	TTYIN8:	MOVSI	S,IOFST			;SET VIRGIN BUFFER BIT
  5336	006403'	437004	000002	TTYINX:	IORB	S,DEVIOS(F)		;IN DEV S WORD IN F
  5337	006404'	324740	007152'		PJRST	NOCTRO			;CLEAR CONTROL O. END OF Muuo
  5338
  5339	006405'	602000	000010	TTYIN6:	TRNE	S,I			;IMAGE MODE?
  5340	006406'	337005	000012		SKIPG	LDBTIC(U)		;AND MORE CHARACTERS TO READ?
  5341	006407'	254000	006402'		 JRST	TTYIN8			;NO. QUIT.
  5342	006410'	254000	006354'		JRST	TTYIN5			;YES. GO PASS SOME MORE
  5343
  5344	006411'	603240	002000	SETBRK:	TLNE	U,LDLIMI
  5345	006412'	263040	000000		 POPJ	P,			;IMAGE IS ALREADY CHARGED FOR
  5346	006413'	135100	006042*		LDB	J,PJOBN
  5347	006414'	260040	000000*		PUSHJ	P,GTCGSZ	;GET THE JOB'S CHARGING SIZE.
  5348	006415'	272302	000000*		ADDM	T1,JBTBCS(J)	;ONE BREAK CHR
  5349	006416'	272300	006415*		ADDM	T1,JBTBCS
  5350	006417'	263040	000000		POPJ	P,
  5351
  5352	006420'	135300	000203'	IMGCNT:	LDB	T1,LDPIMB	;GET IMAGE BREAK CHR
  5353	006421'	316300	000010		CAMN	T1,T3	;IS IT THIS ONE?
  5354	006422'	254000	006431'		 JRST	IMGCH1	;YES, GO CHARGE
  5355	006423'	135300	000177'		LDB	T1,LDPCHG
  5356	006424'	271300	000001		ADDI	T1,1
  5357	006425'	301300	000110		CAIL	T1,TIWKC	;ENOUGH GONE BY TO CHARGE?
  5358	006426'	254000	006432'		 JRST	IMGCHG	;YES
  5359	006427'	137300	000177'		DPB	T1,LDPCHG	;NO, JUST RECORD
  5360	006430'	263040	000000		POPJ	P,
  5361
  5362	006431'	201440	000110	IMGCH1:	MOVEI	T4,TIWKC	;SO CALLER WILL THINK MANY CHRS
  5363	006432'	201300	000000	IMGCHG:	MOVEI	T1,0
  5364	006433'	137300	000177'		DPB	T1,LDPCHG	;SET CHARGE COUNTER TO 0
  5365	006434'	550205	000000		HRRZ	F,LDBDDB(U)
  5366	006435'	322200	006127*		JUMPE	F,CPOPJ	;NO LINE
  5367	006436'	254000	006411'		JRST	SETBRK	;GO CHARGE FOR 1 BCS
  5368
  5369	006437'	256040	017502'	TTYSZS:	XCTBU <LDB T2,[POINT 6,1(T1),11]>	;GET POINTER SIZE
  5370	006440'	137340	017503'		DPB	T2,[POINT 6,P1,11]	;SET IN P1 POINTER
  5371	006441'	201300	000044		MOVEI	T1,^D36
  5372	006442'	230300	000007		IDIV	T1,T2		;NUMBER OF CHRS/WORD
  5373	006443'	220640	000006		IMUL	P2,T1		;NUMBER OF CHRS IN BUFFER
  5374	006444'	344600	006435*		AOJA	P1,CPOPJ	;ADD 1 TO POINT TO FIRST DATA WORD
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 118
SCNSER.MAC	25-JAN-91 22:40		OUTPUT UUO

  5375				SUBTTL	OUTPUT UUO
  5376				;CALLED ON OUTPUT OR OUTPUT CLOSE, FROM UUOCON, WITH F SET UP.
  5377
  5378	006445'	260040	013532'	TTYOUT:	PUSHJ	P,CKATTO	;FIRST, MAKE SURE THERE'S A LINE
  5379	006446'	254000	006345*		  JRST	ABTUUO		;WAITING FOR AN INTERRUPT
  5380	006447'	322240	006527'		JUMPE	U,TTYOUS	;ZAPPED AUX CIRCUIT
  5381	006450'	260040	013432'		PUSHJ	P,CHKROM	;MAKE SURE ROOM FOR THIS CHR
  5382	006451'	254000	006445'		  JRST	TTYOUT		;NO ROOM.
  5383	006452'	260040	006347*		NOCHARGE
  5384	006453'	260040	007567'		PUSHJ	P,CLRIMI	;CLEAR IMAGE INPUT STATE
  5385	006454'	205000	000002		MOVSI	S,IOBEG		;IS THIS THE FIRST BUFFER AFTER INIT?
  5386	006455'	205300	000400		MOVSI	T1,LDLOSU	;IF SO, WILL KILL ^O ACTION
  5387	006456'	616004	000002		TDNN	S,DEVIOS(F)	;CHECK F
  5388	006457'	254000	006462'		 JRST	TTOUT1		;NO.
  5389	006460'	412004	000002		ANDCAM	S,DEVIOS(F)	;YES. CLEAR BEG BIT,
  5390	006461'	412305	000031		ANDCAM	T1,LDBDCH(U)	; AND CONTROL O BIT
  5391	006462'	612305	000031	TTOUT1:	TDNE	T1,LDBDCH(U)	;IS CONTROL O ON NOW?
  5392	006463'	254000	006510'		 JRST	TTOUT5		;YES. SKIP THIS WHOLE BUFFER.
  5393	006464'	205000	000024		MOVSI	S,IO+IOFST	;MARK OUTPUT, AND FIRST OF BUFFER
  5394	006465'	437004	000002		IORB	S,DEVIOS(F)	;IN DEVICE DATA BLOCK
  5395	006466'	550604	000010		HRRZ	P1,DEVOAD(F)	;CHECK ADDRESSES OF OUTPUT BLOCK
  5396	006467'	256200	017504'		XCTFU <HRRZ P2,1(P1)>	;GET WORD COUNT
  5397	006470'	554304	000006		HLRZ	T1,DEVBUF(F)	;GET POINTER TO BUFFER HEADER
  5398	006471'	260040	006437'		PUSHJ	P,TTYSZS
  5399	006472'	602640	000777	TTOUT2:	TRNE	P2,777		;TIME TO LET SOMEONE ELSE RUN?
  5400	006473'	254000	006500'		 JRST	TTOUT3		;NO
  5401	006474'	260040	000000*		PUSHJ	P,WSCHED	;YES -- RESCHEDULE
  5402	006475'	550244	000013		HRRZ	U,DDBLDB(F)	;STILL ATTACHED?
  5403	006476'	326240	006500'		JUMPN	U,TTOUT3	;YES -- GO AHEAD
  5404	006477'	260040	013422'		PUSHJ	P,CKATTF	;NO -- WAIT FOR REATTACH
  5405	006500'	256040	017505'	TTOUT3:	XCTFU <ILDB T3,P1>	;GET A USER'S CHARACTER
  5406	006501'	602000	000010		TRNE	S,I		;SEE IF IMAGE MODE
  5407	006502'	664400	000400		 TROA	T3,400		;YES. SET BIT FOR SUPPRESSING FILLERS
  5408	006503'	620400	000400		  TRZ	T3,400		;ELSE CLEAR IN CASE EXTENDED
  5409	006504'	322400	006507'		JUMPE	T3,TTOUT4	;DON'T OUTPUT NULLS
  5410	006505'	260040	013343'		PUSHJ	P,TYO		;OUTPUT THIS CHARACTER (WAIT IF NEEDED)
  5411	006506'	254000	006520'		  JRST	XPNOUT		;TYO WANTS AN INTERRUPT (SEE TYO)
  5412	006507'	367640	006472'	TTOUT4:	SOJG	P2,TTOUT2		;COUNT USER'S ITEMS.
  5413	006510'	260040	000000*	TTOUT5:	PUSHJ	P,ADVBFE		;ADVANCE HIS BUFFERS
  5414	006511'	255000	000000		  JFCL			;JUST SINGLE BUFFER FOR NOW
  5415	006512'	201000	010000		MOVEI	S,IOACT		;CLEAR ACTIVE BIT.
  5416	006513'	413004	000002		ANDCAB	S,DEVIOS(F)	;IN DEVICE DATA BLOCK FOR THE JOB
  5417	006514'	201300	000001		MOVEI	T1,1
  5418	006515'	137300	000075'		DPB	T1,LOPOUT
  5419	006516'	137305	000002		DPB	T1,LDBOPB(U)
  5420	006517'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 119
SCNSER.MAC	25-JAN-91 22:40		TYO GAVE ERROR RETURN - NO MORE ROOM IN TTY CHUNCKS

  5421				SUBTTL	TYO GAVE ERROR RETURN - NO MORE ROOM IN TTY CHUNCKS
  5422	006520'	260040	013422'	XPNOUT:	PUSHJ	P,CKATTF		;HE MUST BE ATTCHED
  5423	006521'	205300	400000		MOVSI	T1,L2LOEX
  5424	006522'	436305	000027		IORM	T1,LDBBYT(U)	;SET FOR EXPANDED OUTPUT
  5425	006523'	200305	000021		MOVE	T1,LDBTOC(U)
  5426	006524'	311300	017130'		CAML	T1,TOEMAX		;ALREADY TOO MANY FOR EXPANDED?
  5427	006525'	350001	000000		AOS	(P)			;YES SKIP RETURN (TO TYO)
  5428								;WILL GET US INTO OUTPUT WAIT
  5429	006526'	263040	000000		POPJ	P,			;NON-SKIP RETURN (TO TYO) GO NOW
  5430
  5431	006527'	260040	006510*	TTYOUS:	PUSHJ	P,ADVBFE	;SKIP THIS BUFFER
  5432	006530'	255000	000000		  JFCL
  5433	006531'	201000	010000		MOVEI	S,IOACT
  5434	006532'	413004	000002		ANDCAB	S,DEVIOS(F)	;JUST TO MAKE SURE
  5435	006533'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 120
SCNSER.MAC	25-JAN-91 22:40		DDT MODE CALLI'S

  5436				SUBTTL DDT MODE CALLI'S
  5437
  5438				;INPUT TO DDT	- CALL AC,[SIXBIT /DDTIN/]  WHERE AC/ ADDR
  5439				;ADDR GETS UP TO 21 WORDS OF ASCIZ, BREAKING ON ANY CHARACTER
  5440
  5441	006534'	260040	014557'	DDTIN::	PUSHJ	P,TTYFNU		;SET U AND F FOR THIS TTY
  5442	006535'	260040	013477'		PUSHJ	P,CKATTI		;CHECK FOR ATTACHED
  5443	006536'	254000	006446*		  JRST	ABTUUO			;INTERRUPT, GET OUT OF UUO
  5444	006537'	260040	006452*		NOCHARGE
  5445	006540'	256200	017506'		XCTFU <HRRZ P2,(M)>
  5446	006541'	505640	440700		HRLI	P2,440700		;SEVEN BIT BYTES, RELOCATED.
  5447	006542'	201600	000124		MOVEI	P1,<21*5>-1		;NUMBER OF BYTES ALLOWED
  5448	006543'	260040	013664'		PUSHJ	P,TWAITC		;GET AT LEAST ONE CHARACTER
  5449	006544'	260040	006411'		PUSHJ	P,SETBRK		;ONE BREAK CHR
  5450	006545'	337005	000012	DDTINL:	SKIPG	LDBTIC(U)		;ANY MORE TO COME?
  5451	006546'	254000	006554'		 JRST	DDTINX			;NO.
  5452	006547'	260040	013135'		PUSHJ	P,TYI			;YES. GO GET ONE
  5453	006550'	254000	006554'		  JRST	DDTINX			;WASNT ANY. I'M CONFUSED.
  5454	006551'	602400	000177		TRNE	T3,177			;NULL?
  5455	006552'	256040	017507'		XCTFU <IDPB T3,P2>		;NO. STORE IN USER AREA
  5456	006553'	367600	006545'		SOJG	P1,DDTINL		;IF MORE SPACE, GET ANOTHER CHARACTER
  5457	006554'	201400	000000	DDTINX:	MOVEI	T3,0			;FLAG END OF STRING
  5458	006555'	256040	017507'		XCTFU <IDPB T3,P2>		; IN USER AREA
  5459	006556'	324740	007152'		PJRST	NOCTRO			;AND RETURN TO USER, CLEARING ^O FLAG
  5460
  5461				;DDTOUT - CALL AC,[SIXBIT /DDTOUT/], AC/ ADDR, ADDR/ ASCIZ /XXX/
  5462
  5463	006557'	704553	000000	DDTOUT::UMOVE	M,(M)	;GET ADDRESS
  5464	006560'	201500	000003		MOVEI	W,3
  5465	006561'	254000	007023'		JRST	TTYUUO	;HANDLE LIKE OUTSTR
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 121
SCNSER.MAC	25-JAN-91 22:40		HANG UUO

  5466				SUBTTL HANG UUO
  5467
  5468				COMMENT @
  5469
  5470				HANG UUO - HANG A PORT, A JOB, OR ALL JOBS
  5471
  5472					T1/	BITS,,PORT OR JOB #
  5473
  5474					<BITS>  = 1B13 SAME AS 1B16 EXCEPT DON'T DETACH CMD PORT (LET
  5475						       LOGOUT DO IT)
  5476						  1B14 TO HANG A PORT OSTENSIBLY NOT TIED TO
  5477						       A CIRCUIT
  5478						  1B15 TO HANG ALL JOBS THEN GO TO BOOTS LOADED
  5479						  1B16 TO FORCE A LOGOUT EVEN FOR JOBS WITH
  5480						       DETACH OR TIMEOUT SET
  5481						  1B17 IF SPECIFYING A JOB RATHER THAN A PORT
  5482				@
  5483
  5484	006562'	607300	000004	HNGUUO::TLNN	T1,(1B15)	;IF HANGING THE SYSTEM
  5485	006563'	607300	000001		TLNN	T1,(1B17)	;OR SPECIFYING A PORT,
  5486	006564'	254000	006577'		 JRST	HNGUUL		;  NEED LICENSE
  5487
  5488				    ;HANGING A SPECIFIC FRAME - CHECK ACCESS RIGHTS
  5489
  5490	006565'	540600	000002		HRR	P1,J		;SAVE CALLER JOB#
  5491	006566'	500600	000006		HLL	P1,T1		;SAVE <BITS>
  5492	006567'	550740	000006		HRRZ	P4,T1		;P4/ FRAME DESC
  5493	006570'	551700	000054		HRRZI	P3,.ARHNG	;P3/ HANG-FRAME ACCESS
  5494	006571'	260040	000000*		PUSHJ	P,FDRUPX##	;J/ TARGET JOB#
  5495	006572'	263040	000000		  POPJ	P,		;(NO JOB OR INSUFFICIENT ACCESS)
  5496	006573'	500300	000014		HLL	T1,P1		;T1/ <BITS>,,
  5497	006574'	540300	000002		HRR	T1,J		;T1/ <BITS>,,TARGET JOB#
  5498	006575'	550100	000014		HRRZ	J,P1		;J/ CALLER JOB#
  5499	006576'	254000	006602'		JRST	HNGMON
  5500
  5501				    ;HANGING A PORT OR HANGING SYSTEM - NEED WC LICENSE
  5502
  5503	006577'	205340	400000	HNGUUL:	MOVSI	T2,LICWCR
  5504	006600'	616342	000000*		TDNN	T2,JBTLIC(J)
  5505	006601'	263040	000000		 POPJ	P,
  5506
  5507				    ;HERE WHEN ACCESS IS OK, TO DO THE ACTUAL STUFF
  5508
  5509	006602'	550340	000006	HNGMON::HRRZ	T2,T1		;GET JOB OR PORT NUMBER
  5510	006603'	603300	000004		TLNE	T1,(1B15)
  5511	006604'	254000	006701'		 JRST	HNGALL		;HANG ALL JOBS
  5512	006605'	603300	000001		TLNE	T1,(1B17)
  5513	006606'	254000	006671'		 JRST	HNGJOB		;HANG A JOB
  5514	006607'	301340	004414*		CAIL	T2,RPORTN##
  5515	006610'	263040	000000		 POPJ	P,		;BAD PORT
  5516	006611'	540247	005674*		HRR	U,LINTAB(T2)
  5517
  5518	006612'	336005	000026		SKIPN	LDBLOG(U)	;THERE?
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 121-2
SCNSER.MAC	25-JAN-91 22:40		HANG UUO

  5519	006613'	643300	000010		 TLCE	T1,(1B14)	;SKIP IF DESIRE TO HANG ACTIVE PORTS
  5520	006614'	603300	000010		TLNE	T1,(1B14)	;SKIP IF WANT TO HANG INACTIVE PORTS
  5521	006615'	263040	000000		 POPJ	P,		;ERROR RETURN
  5522	006616'	350001	000000		AOS	(P)		;SET TO SKIP RETURN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 122
SCNSER.MAC	25-JAN-91 22:40		HANG UUO

  5523				    ;HERE FROM ABOVE AND FROM ZAPCIR UUO
  5524				    ;U/ ---,,LDB ADDR
  5525				    ;T1/1B16 if ignoring continue-on-disconnect
  5526
  5527	006617'	261040	000006	HNGPRT:	PUSH	P,T1		;Save the "kill flag"
  5528	006620'	205340	001000		MOVSI	T2,LMLBIO
  5529	006621'	612345	000030		TDNE	T2,LDBMOD(U)
  5530	006622'	260040	012071'		 PUSHJ	P,BIOREL	;RESET BIO ON THIS PORT
  5531	006623'	262040	000006		POP	P,T1		;Restore "kill flag"
  5532
  5533				;HERE WITH U/ LDB ADDR TO HANG THAT PORT
  5534
  5535	006624'	500245	000031		HLL	U,LDBDCH(U)
  5536	006625'	205340	200000		MOVSI	T2,LLLZAP
  5537	006626'	436345	000026		IORM	T2,LDBLOG(U)	;MARK PORT INTERNALLY "ZAPPED"
  5538	006627'	603240	000040		TLNE	U,LDLAUX	;IS IT AN AUX CIRCUIT?
  5539	006630'	254000	011220'		 JRST	HNGAUX		;YES, SO IT'S NOT A COMMAND PORT
  5540	006631'	550205	000000		HRRZ	F,LDBDDB(U)	;F/ DDB ADDR
  5541	006632'	322200	015372'		JUMPE	F,TTYZAP	;Detached, just zap the port
  5542	006633'	205340	020000		MOVSI	T2,TTYATC
  5543	006634'	616344	000004		TDNN	T2,DEVMOD(F)	;IS IT A COMMAND PORT?
  5544	006635'	254000	011220'		 JRST	HNGAUX		;NO
  5545	006636'	135100	006413*		LDB	J,PJOBN		;Get number of controlling job/frame
  5546	006637'	500100	000006		HLL	J,T1		;Set up J for general hang code
  5547					PFALL	HNGTTY
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 123
SCNSER.MAC	25-JAN-91 22:40		Here from above or by PUSHJ.  At entry, F=DDB address, U=LDB

  5548				SUBTTL	 Here from above or by PUSHJ.  At entry, F=DDB address, U=LDB
  5549				; address (if any), J=job/frame # in RH, LH has bit 16 set if
  5550				; continue-on-disconnect is to be ignored.
  5551
  5552	006640'	603100	000020	HNGTTY:	TLNE	J,(1B13)	;WANT TO DETACH?
  5553	006641'	254000	006651'		 JRST	HNGTT1		;NO, LET LOGOUT HANDLE IT
  5554	006642'	513004	000013		HLLZS	DDBLDB(F)	;Clear DDB-to-LDB pointer
  5555	006643'	553004	000000		HRRZS	DEVNAM(F)	;Clear "TTY" from device name
  5556	006644'	322240	006651'		JUMPE	U,HNGTT1	;Skip port code if no port
  5557	006645'	513005	000000		HLLZS	LDBDDB(U)	;Clear LDB-to-DDB pointer
  5558	006646'	260040	015372'		PUSHJ	P,TTYZAP	;ZAP the port
  5559	006647'	135300	000206'		LDB	T1,LDPCOM	;Command mode from LDB
  5560	006650'	137300	000246'		DPB	T1,DDPCOM	;Copy into DDB
  5561
  5562				; Here job/frame is detached and TTY is gone
  5563
  5564	006651'	623100	000022	HNGTT1:	TLZE	J,(1B13!1B16)	;"Really kill"?
  5565	006652'	254000	006664'		 JRST	HNGTT2		;Yes, kill him good
  5566	006653'	135300	000000*		LDB	T1,PVYHNG##	;HANG/ZAP action field
  5567	006654'	302300	000002		CAIE	T1,.PVHCN	;Continue-on-disconnect?
  5568	006655'	254000	006665'		 JRST	HNGTT3		;No, go kill it dead
  5569
  5570				; Here for continue-on-disconnect
  5571
  5572	006656'	135300	000234'		LDB	T1,DDPTZP
  5573	006657'	260040	001173*		PUSHJ	P,TAKTRP	;Cause "TTY ZAP" interrupt (if enabled)
  5574	006660'	200004	000002		MOVE	S,DEVIOS(F)
  5575	006661'	603000	020000		TLNE	S,TIOUSE	;If the DDB is in use,
  5576	006662'	260040	006010'		 PUSHJ	P,TIWAKE	; wake the job
  5577	006663'	263040	000000		POPJ	P,
  5578
  5579				; Here to kill job dead
  5580
  5581	006664'	260040	000000*	HNGTT2:	PUSHJ	P,TTKJOB##	;"Really kill" (no questions)
  5582
  5583				; Here to stop on disconnect or logout on disconnect
  5584
  5585	006665'	205300	040000	HNGTT3:	MOVSI	T1,DCLCOM
  5586	006666'	436304	000012		IORM	T1,DDBDCH(F)	;In command mode at detach time
  5587	006667'	260040	000000*		PUSHJ	P,COMKJB##	;The MAGIC INVOCATION which kills jobs
  5588	006670'	263040	000000		POPJ	P,		;Less magical, returns to caller
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 124
SCNSER.MAC	25-JAN-91 22:40		HERE TO HANG A JOB

  5589				SUBTTL	HERE TO HANG A JOB
  5590				;T1/ BITS,,JOB#  T2/ 0,,JOB#
  5591
  5592	006671'	301340	000000*	HNGJOB:	CAIL	T2,JOBN
  5593	006672'	263040	000000		 POPJ	P,		;BAD JOB NUMBER
  5594	006673'	550207	000000*		HRRZ	F,TTYTAB(T2)
  5595	006674'	322200	006444*		JUMPE	F,CPOPJ		;NO JOB THERE
  5596	006675'	550244	000013		HRRZ	U,DDBLDB(F)
  5597	006676'	200100	000006		MOVE	J,T1		;Copy BITS,,JOB#
  5598	006677'	260040	006640'		PUSHJ	P,HNGTTY	;Force hang for this job/frame
  5599	006700'	254000	006336*		JRST	CPOPJ1
  5600
  5601				;HERE TO HANG EVERYONE AND BRING DOWN THE SYSTEM
  5602
  5603	006701'	402000	005650*	HNGALL::SETZM	CRSHWD##	; THIS KEEPS US FROM NESTING
  5604	006702'	476000	017113'		SETOM	DWNFLG
  5605	006703'	201300	600000		MOVEI	T1,600000
  5606	006704'	436300	004443*		IORM	T1,STATES	;SET SUPER SHUT
  5607	006705'	260040	015156'		PUSHJ	P,SETSHT	;LET SUPERVISOR KNOW
  5608	006706'	200300	000000*		MOVE	T1,HIGHJB
  5609	006707'	261040	000006		PUSH	P,T1
  5610	006710'	505300	000003	HNGAL1:	HRLI	T1,(1B16!1B17)	;HANG JOB AND FORCE LOGOUT
  5611	006711'	550340	000006		HRRZ	T2,T1		;Copy job #
  5612	006712'	260040	006671'		PUSHJ	P,HNGJOB
  5613	006713'	255000	000000		  JFCL
  5614	006714'	373301	000000		SOSLE	T1,(P)
  5615	006715'	254000	006710'		JRST	HNGAL1
  5616	006716'	254000	006051*		JRST	TPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 125
SCNSER.MAC	25-JAN-91 22:40		RESET UUO

  5617				SUBTTL RESET UUO
  5618
  5619	006717'	550202	006673*	TTYRES::HRRZ	F,TTYTAB(J)	;CALLED AT RESET TIME
  5620	006720'	322200	006674*		JUMPE	F,CPOPJ		;NO DDB
  5621	006721'	200000	017510'		MOVE	S,[XWD TWTSPC!IOSBKA,BK2IOS!DLRSUP!NOECHO!FCS!17]
  5622	006722'	413004	000002		ANDCAB	S,DEVIOS(F)	;RESET TTY TO NORMAL STATE
  5623	006723'	550244	000013		HRRZ	U,DDBLDB(F)
  5624	006724'	322240	006737'		JUMPE	U,TTYRS1	;NO LINE
  5625	006725'	200305	000030		MOVE	T1,LDBMOD(U)	;CHECK FOR BLOCK I/O MODE SET
  5626	006726'	603300	001000		TLNE	T1,LMLBIO	;FOR THE PORT AND RELEASE
  5627	006727'	260040	012071'		 PUSHJ	P,BIOREL	;BUFFERS AND RESET, IF SO.
  5628	006730'	205300	020000		MOVSI	T1,L2LNTB
  5629	006731'	412305	000027		ANDCAM	T1,LDBBYT(U)	;RESET THE NO TAB FUNCTION
  5630	006732'	551300	100000		HRRZI	T1,L2LTBK
  5631	006733'	260040	007607'		PUSHJ	P,SETTBK	;NOW MAKE SURE TABS ARE BREAK2
  5632	006734'	551300	040000		HRRZI	T1,L2LBBP
  5633	006735'	260040	007607'		PUSHJ	P,SETTBK	;MAKE SURE THAT BACKSPACES ARE BREAK
  5634	006736'	260040	013554'		PUSHJ	P,UUOLDB	;MAKE LINE AGREE WITH S
  5635	006737'	260040	016112'	TTYRS1:	PUSHJ	P,NXTTTY	;GET NEXT DDB
  5636	006740'	263040	000000		  POPJ	P,		;NONE
  5637	006741'	205340	010000		MOVSI	T2,DVNZP
  5638	006742'	612344	000004		TDNE	T2,DEVMOD(F)	;SHOULD WE ZAP ON RESET?
  5639	006743'	254000	006737'		 JRST	TTYRS1		;NO
  5640	006744'	201340	400000		MOVEI	T2,ASSCON
  5641	006745'	260040	000000*		PUSHJ	P,RELEA6	;YES
  5642	006746'	254000	006737'		JRST	TTYRS1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 126
SCNSER.MAC	25-JAN-91 22:40		.STTLK SETUUO FUNCTION

  5643				SUBTTL .STTLK SETUUO FUNCTION
  5644
  5645				COMMENT @
  5646
  5647				CALLED BY SETUUO TO DO THE .STTLK FUNCTION (TALK COMMAND CLONE):
  5648
  5649					MOVE	J,[TALKER JOB #]
  5650					MOVE	T1,[TALKEE JOB #] (0 for OPR+CTY, 400000 for CTY only)
  5651					MOVE	T2,[ILDB POINTER TO MESSAGE IN USER SPACE]
  5652					MOVE	T4,[BYTE COUNT, 0 IF MESSAGE IS ASCIZ]
  5653					PUSHJ	P, STTLK
  5654					  ERROR RETURN	;T1/ ERROR CODE (SEE DEFINITIONS BELOW)
  5655					NORMAL RETURN
  5656
  5657				ADVANCES T2 AS IT GOES, SO T2 IS CORRECTLY UPDATED IF THE MESSAGE
  5658				CAN ONLY BE PARTIALLY OUTPUT.  T4 updated if it started nonzero.
  5659
  5660				DESTROYS T1 T3.
  5661
  5662				@
  5663
  5664			000000	TKROM%==:0	;NO ROOM FOR MORE OUTPUT CHARACTERS
  5665			000001	TKEXS%==:1	;JOB DOESN'T EXIST
  5666			000002	TKATT%==:2	;JOB NOT ATTACHED
  5667			000003	TKBSY%==:3	;JOB BUSY (NO OPER LICENSE & NOT AT CMND LEVEL)
  5668
  5669				PRINTF(<[STTLK to job -1 does not SEND ALL]>)
  5670
  5671	006747'	602300	377777	STTLK::	TRNE	T1,377777	;Zero or 400000?
  5672	006750'	254000	006757'		 JRST	STTLK0		;No, T1 has job number
  5673	006751'	306300	400000		CAIN	T1,400000	;Is 1B18 and nothing else set?
  5674	006752'	644300	400001		 TRCA	T1,400001	;Yes, change T1 to 1 and output to CTY only
  5675	006753'	201300	000002		  MOVEI	T1,2		;No, change T1 to 2 for both OPR and CTY
  5676	006754'	260040	014334'		PUSHJ	P,OPROUT	;Set up to go to right LDB
  5677	006755'	201400	000105'		MOVEI	T3,CTYLDB	;Fake it
  5678	006756'	254000	007002'		JRST	STTLK1
  5679
  5680	006757'	205400	040000	STTLK0:	MOVSI	T3,JNA
  5681				;*;	JUMPL	T1,#SEND#ALL#	;***    NOT IMPLEMENTED   ****
  5682	006760'	305300	006671*		CAIGE	T1,JOBN		;IF BAD JOB #
  5683	006761'	616406	006043*		TDNN	T3,JBTSTS(T1)	;OR JOB NOT ASSIGNED,
  5684					 JRST	[MOVEI	T1,TKEXS%
  5685	006762'	254000	017511'			 POPJ	P,]	;Error return - non existant job
  5686	006763'	550406	006717*		HRRZ	T3,TTYTAB(T1)	;T3/ TALKEE DDB
  5687	006764'	336000	000010		SKIPN	T3
  5688	006765'	256000	000000'		 STOPCD
  5689	006766'	550410	000013		HRRZ	T3,DDBLDB(T3)	;T3/ TALKEE LDB
  5690					JUMPE	T3,[		;IF JOB NOT ATTACHED,
  5691						MOVEI	T1,TKATT%
  5692						POPJ	P,	;  ERROR-RETURN
  5693	006767'	322400	017513'		]
  5694
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 126-2
SCNSER.MAC	25-JAN-91 22:40		.STTLK SETUUO FUNCTION

  5695	006770'	306400	017027'		CAIN	T3,OPRLDB	;No license required to send to OPR or CTY
  5696	006771'	254000	007002'		 JRST	STTLK1
  5697	006772'	500442	006600*		HLL	T4,JBTLIC(J)	;Get caller's license
  5698	006773'	603440	100000		TLNE	T4,LICOPR	;OPER can talk to anyone
  5699	006774'	254000	007002'		 JRST	STTLK1
  5700	006775'	500450	000031		HLL	T4,LDBDCH(T3)	;Get talkee's status
  5701	006776'	603440	020000		TLNE	T4,LDLCOM	;Receive messages if port is at command level
  5702	006777'	254000	007002'		 JRST	STTLK1
  5703	007000'	201300	000003		MOVEI	T1,TKBSY%	;Port is busy
  5704	007001'	263040	000000		POPJ	P,		;Error return
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 127
SCNSER.MAC	25-JAN-91 22:40		.STTLK SETUUO FUNCTION

  5705				    ;HERE WITH T2/ ILDB POINTER, T3/ TALKEE LDB TO SEND A MESSAGE
  5706
  5707	007002'	621440	777777	STTLK1:	TLZ	T4,-1		;Keep only byte count
  5708	007003'	261040	000005		PUSH	P,U		;SAVE U
  5709	007004'	550240	000010		HRRZ	U,T3
  5710	007005'	621340	000037		TLZ	T2,37		;CLEAR INDEX AND INDIRECT FIELDS
  5711	007006'	261040	000007		PUSH	P,T2		;AND SAVE BYTE POINTER
  5712
  5713	007007'	260040	013463'	STTLK2:	PUSHJ	P,IFROOM	;Check for room in destination output buffer
  5714					 JRST	[
  5715						MOVEI	T1,TKROM%
  5716						POP	P,T2
  5717						POP	P,U
  5718						POPJ	P,	;  RESTORE T2 AND U AND ERROR-RETURN
  5719	007010'	254000	017515'		]
  5720	007011'	256040	017521'		XCTFU	<ILDB T3,(P)>	;GET NEXT BYTE OF MESSAGE
  5721	007012'	336000	000011		SKIPN	T4		;If count started at 0, then
  5722	007013'	322400	007020'		 JUMPE	T3,STTLK3	; end at null in ASCIZ
  5723	007014'	260040	014067'		PUSHJ	P,COMTYO	;PRINT THE CHARACTER
  5724	007015'	332000	000011		SKIPE	T4		;If byte count supplied,
  5725	007016'	362440	007020'		 SOJE	T4,STTLK3	; count it down
  5726	007017'	254000	007007'		JRST	STTLK2
  5727
  5728	007020'	262040	000007	STTLK3:	POP	P,T2
  5729	007021'	262040	000005		POP	P,U
  5730	007022'	254000	006700*		JRST	CPOPJ1		;RESTORE T2 AND U AND SUCCESS-RETURN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 128
SCNSER.MAC	25-JAN-91 22:40		TTCALL UUO

  5731				SUBTTL TTCALL UUO
  5732				;TTCALL AC,E - VALUE OF AC DETERMINES ACTION OF UUO (051)
  5733
  5734				;W has a number from 0 to 17 if called from TTCALL uuo,
  5735				;negative numbers in W if fake call from UUOCON.
  5736
  5737	007023'	260040	014557'	TTYUUO::PUSHJ	P,TTYFNU	;SET F AND U
  5738	007024'	350012	010167'		AOS	TTCCNT(W)	;Count each TTCALL by function
  5739	007025'	200412	007066'		MOVE	T3,TTUUOT(W)	;GET DIPACTH ADRS AND BITS
  5740	007026'	607400	200000		TLNN	T3,TUUATO	;DOES UUO NEED ATTACH FOR OUTPUT?
  5741	007027'	254000	007036'		 JRST	TTYUU1
  5742	007030'	260040	013532'		PUSHJ	P,CKATTO	;YES, CHECK IF ATTACHED FOR OUTPUT
  5743	007031'	254000	006536*		  JRST	ABTUUO		;ABORT THE UUO FOR INTERRUPT
  5744	007032'	326240	007036'		JUMPN	U,TTYUU1
  5745	007033'	260040	013540'		PUSHJ	P,CKATO2	;FORCE ATTACH EVEN IF "SPECIAL"
  5746	007034'	254000	007031*		  JRST	ABTUUO
  5747	007035'	322240	007033'		JUMPE	U,.-2		;JUST TO MAKE SURE
  5748	007036'	607400	400000	TTYUU1:	TLNN	T3, TUUATI	;ATTACH FOR INPUT ?
  5749	007037'	254000	007042'		 JRST	TTYUU2
  5750	007040'	260040	013477'		PUSHJ	P,CKATTI	;YES, CHECK IF ATTACHED
  5751	007041'	254000	007034*		  JRST	ABTUUO		;ABORT FOR INTERRUPT
  5752	007042'	603400	140000	TTYUU2:	TLNE  T3,TUUATR!TUUAIR	;RETURN IF DETACHED ?
  5753	007043'	322240	006720*		JUMPE	U,CPOPJ		;YES
  5754	007044'	607400	600000		TLNN	T3,TUUATO!TUUATI;IF DOING INPUT OR OUTPUT
  5755	007045'	260040	013554'		 PUSHJ	P,UUOLDB	;MUST GET THROUGH UUOLDB
  5756	007046'	607400	020000		TLNN	T3,TUUROM	;NEED ROOM FOR OUTPUT?
  5757	007047'	254000	007052'		 JRST	TTYUU3
  5758	007050'	260040	013432'		PUSHJ	P,CHKROM	;SEE IF WILL GO INTO IOW FOR INTERRUPT
  5759	007051'	254000	007023'		 JRST	TTYUUO
  5760	007052'	603400	040000	TTYUU3:	TLNE	T3,TUUAIR	;MUST IT BE AT USER LEVEL TOO?
  5761	007053'	607240	020000		TLNN	U,LDLCOM
  5762	007054'	334000	000000		 SKIPA			;NEED NOT BE OR IS
  5763	007055'	263040	000000		  POPJ	P,
  5764	007056'	603400	010000		TLNE	T3,TUUEAT	;EAT RESCAN BUFFER?
  5765	007057'	260040	013264'		 PUSHJ	P,TYIEAT	;MUST EAT COMMAND BEFORE INPUT
  5766				IFE OPCRET,<	; KLUDGE TIL OPERATIONS CAN WRITE 10 CODE
  5767					TLNE	T3,TUUFXI
  5768					 PUSHJ	P,FIXIMI	;SET IMAGE STATE FROM DATA MODE
  5769				>;OPCRET=1 IF PROGRAMS THINK TTCALLS IGNORE IMAGE
  5770	007060'	254010	000000		JRST	(T3)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 129
SCNSER.MAC	25-JAN-91 22:40		BITS FOR THE TTY UUOS

  5771				SUBTTL	BITS FOR THE TTY UUOS
  5772
  5773			400000	TUUATI==400000	;NEED TO BE ATTACHED - INPUT
  5774			200000	TUUATO==200000	;NEED TO BE ATTACHED - OUTPUT
  5775			100000	TUUATR==100000	;RETURN IF NOT ATTACHED
  5776			040000	TUUAIR==040000	;RETURN IF NOT AT USER LEVEL
  5777			020000	TUUROM==020000	;CHECK FOR ROOM FOR AT LEAST 1 CHR BEFORE OUTPUT
  5778			010000	TUUEAT==010000	;EAT COMMAND
  5779			004000	TUUFXI==004000	;SET IMAGE STATE FROM DATA MODE
  5780			002000	TUUIMI==002000	;TURN ON IMAGE STATE (REGARDLESS OF DATA MODE)
  5781
  5782				;THERE ARE SOME NEGATIVE DISPATCHES FAKED BY UUOCON
  5783
  5784	007061'	040000	007477'	TTUNEG:	XWD TUUAIR,LEVDEF		;-5 LEAVE DEFERED ECHO MODE
  5785	007062'	054000	007461'		XWD TUUAIR!TUUEAT!TUUFXI,RDNXT	;-4 READ NEXT CHR AND SKIP
  5786	007063'	000000	007043*		XWD 0,CPOPJ			;   NO LONGER IMPLEMENTED
  5787	007064'	000000	007506'		XWD 0,GETMC			;-2 GET LINE CHRS
  5788	007065'	414000	013664'		XWD TUUATI!TUUEAT!TUUFXI,TWAITC	;-1 WAIT FOR CHR
  5789	007066'	414000	007412'	TTUUOT:	XWD TUUATI!TUUEAT!TUUFXI,INCHRW	;00 INPUT CHR AND WAIT
  5790	007067'	220000	007107'		XWD TUUATO!TUUROM,ONEOUT	;01 OUTPUT 1 CHR
  5791	007070'	054000	007345'		XWD TUUAIR!TUUEAT!TUUFXI,INCHRS	;02 INPUT CHR AND SKIP
  5792	007071'	220000	007134'		XWD TUUATO!TUUROM,OUTSTR	;03 OUTPUT STRING
  5793	007072'	414000	007367'		XWD TUUATI!TUUEAT!TUUFXI,INCHWL	;04 INPUT CHR AND WAIT LINE MODE
  5794	007073'	054000	007356'		XWD TUUAIR!TUUEAT!TUUFXI,INCHSL	;05 INPUT CHR AND SKIP LINE MODE
  5795	007074'	000000	007261'		XWD 0,GETLIN			;06 GET LINE CHRS.
  5796	007075'	200000	007331'		XWD TUUATO,SETLIN		;07 SET LINE CHRS.
  5797	007076'	100000	007144'		XWD TUUATR,TRESCU		;10 INHIBIT COMMAND LINE EATING
  5798	007077'	100000	006257'		XWD TUUATR,TSETBI		;11 CLEAR INPUT BUFFER
  5799	007100'	100000	006305'		XWD TUUATR,TSETBO		;12 CLEAR OUTPUT BUFFER
  5800	007101'	054000	007147'		XWD TUUAIR!TUUEAT!TUUFXI,SKPINC	;13 SKIP IF CHR TO BE INPUT
  5801	007102'	054000	007157'		XWD TUUAIR!TUUEAT!TUUFXI,SKPINL	;14 SKIP IF LINE TO BE INPUT
  5802	007103'	220000	007126'		XWD TUUATO!TUUROM,IONEOU	;15 IMAGE ONE-CHAR OUTPUT
  5803	007104'	220000	007106'		XWD TUUATO!TUUROM,OUTCHI	;16 OUTPUT CHR IMMEDIATE
  5804	007105'	220000	007171'		XWD TUUATO!TUUROM,OUTPTR	;17 OUTPUT FROM POINTER
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 130
SCNSER.MAC	25-JAN-91 22:40		SUBROUTINES FOR TTCALL

  5805				SUBTTL	SUBROUTINES FOR TTCALL
  5806
  5807				;ONEOUT OUTPUTS ONE CHARACTER FROM C(E)
  5808
  5809	007106'	334400	000013	OUTCHI:	SKIPA T3,M	;GET THE CHARACTER FROM ADDRESS FILED
  5810	007107'	704413	000000	ONEOUT:	UMOVE T3,(M)	;GET CHR FROM ADDRESS
  5811	007110'	260040	006537*		NOCHARGE
  5812	007111'	260040	007567'		PUSHJ P,CLRIMI			;CLEAR IMAGE INPUT STATE
  5813	007112'	606000	000010		TRNN S,10		;IF MODES 10,13,14
  5814	007113'	606000	000002		TRNN S,2		;OR 0,1
  5815	007114'	624400	000600		TRZA T3,600		;SAME AS ANDI 177 SINCE TTGETC GETS 9 BIT BYTE
  5816	007115'	405400	000377		ANDI T3,377		;8 BITS IN MODE 2
  5817	007116'	322400	007063*		JUMPE T3,CPOPJ			;IF NOT NULL,
  5818	007117'	260040	013343'	ONEOU2:	PUSHJ P,TYO
  5819	007120'	254000	006520'		 JRST XPNOUT		;SET BIGGER OUTPUT AND GO TO TYO
  5820	007121'	201300	000001	ONEOU3:	MOVEI T1,1
  5821	007122'	137300	000075'		DPB T1,LOPOUT
  5822	007123'	137305	000002		DPB T1,LDBOPB(U)
  5823	007124'	263040	000000		POPJ P,
  5824
  5825				;IONEOU OUTPUTS ONE CHARACTER FROM LOW 8 BITS OF C(E)
  5826	007125'	334400	000013	ACOTCI:	SKIPA T3,M	;GET CHR IMMEDIATE (AUXCAL)
  5827	007126'	704413	000000	IONEOU:	UMOVE T3,(M)	;GET CHR
  5828	007127'	260040	007110*		NOCHARGE
  5829	007130'	260040	007567'		PUSHJ P,CLRIMI			;NOT IN INPUT WAIT ANY MORE
  5830	007131'	322200	007107'		JUMPE F,ONEOUT		;IF NO F, SEND 7 BITS
  5831	007132'	660400	000400		TRO T3,400			;FLAG AS IMAGE CHARACTER (NO FILLER)
  5832	007133'	324740	007117'		PJRST ONEOU2		;OUTPUT CHARACTER
  5833
  5834				;OUTSTR OUTPUTS A STRING OF ASCIZ CHARACTERS
  5835
  5836
  5837	007134'	260040	007567'	OUTSTR:	PUSHJ P,CLRIMI			;CLEAR IMAGE INPUT STATE
  5838	007135'	260040	007127*		NOCHARGE
  5839	007136'	505540	440700		HRLI M,(POINT 7,0)			;POINT TO USER AREA
  5840	007137'	256040	017522'	OUTST1:	XCTFU <ILDB T3,M>	;GET CHR
  5841	007140'	322400	007121'		JUMPE T3,ONEOU3			;NULL MARKS END OF STRING, START PTY
  5842	007141'	260040	013343'		PUSHJ P,TYO			;TYPE OUT CHARACTER WITH PARITY
  5843	007142'	254000	006520'		 JRST XPNOUT		;TRY BIGGER OUTPUT BUFFER
  5844	007143'	254000	007137'		JRST OUTST1			;AND GO BACK FOR MORE.
  5845
  5846				;TRESCU IS FOR COMPIL TO READ COMMAND WHICH STARTED IT
  5847
  5848	007144'	205300	100000	TRESCU:	MOVSI T1,LDLECS		;CLEAR BIT IN LINE DATA BLOCK WHICH
  5849	007145'	412305	000031		ANDCAM T1,LDBDCH(U)		; WOULD CAUSE COMMAND TO BE SKIPPED
  5850	007146'	263040	000000		POPJ P,0			;AND RETURN TO USER
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 131
SCNSER.MAC	25-JAN-91 22:40		SKPINC - SKIP IF INCHRW WOULDN'T WAIT (TOO LONG)

  5851				SUBTTL	SKPINC - SKIP IF INCHRW WOULDN'T WAIT (TOO LONG)
  5852
  5853	007147'	337005	000014	SKPINC:	SKIPG	LDBECC(U)	;If anything to be echoed
  5854	007150'	333005	000012		SKIPLE	LDBTIC(U)	;Or characters have been input
  5855	007151'	350001	000000		 AOS	(P)		;Skip return
  5856	007152'			TTYSET::		;OLD CLOCK1 FUNCTION
  5857	007152'	205300	010000	NOCTRO:	MOVSI	T1,L2LLDF
  5858	007153'	412305	000027		ANDCAM	T1,LDBBYT(U)	;TURN OFF LEVDEF FLAG TOO
  5859	007154'	205300	000400		MOVSI	T1,LDLOSU	;TURN OFF CONTROL O BIT
  5860	007155'	412305	000031		ANDCAM	T1,LDBDCH(U)
  5861	007156'	263040	000000		POPJ	P,
  5862
  5863				;SKPINL - SKIP IF INCHWL WOULDN'T WAIT
  5864
  5865	007157'	200305	000012	SKPINL:	MOVE	T1,LDBTIC(U)	;T1/ # READABLE CHARACTERS
  5866	007160'	603240	002000		TLNE	U,LDLIMI	;IF IMAGE MODE
  5867	007161'	337000	000006		 SKIPG	T1		;AND THERE'RE ANY,
  5868	007162'	301300	000110		CAIL	T1,TIWKC	;OR OF THERE'S A LINEFULL,
  5869	007163'	254000	007167'		 JRST	SKPIN1		;  SKIP
  5870	007164'	603240	004000		TLNE	U,LDLBK2	;IF BREAK-ON-PUNCTUATION
  5871	007165'	337005	000016		 SKIPG	LDBBK2(U)	;AND THERE'RE PUNCTUATION CHARS,
  5872	007166'	333005	000015		SKIPLE	LDBBKC(U)	;OR IF THERE'RE BREAK CHARACTERS,
  5873	007167'	350001	000000	SKPIN1:	 AOS (P)		;  SKIP
  5874	007170'	324740	007152'		PJRST	NOCTRO
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 132
SCNSER.MAC	25-JAN-91 22:40		OUTPTR - OUTPUT FROM BYTE POINTER

  5875				SUBTTL	OUTPTR - OUTPUT FROM BYTE POINTER
  5876
  5877	007171'	260040	007567'	OUTPTR:	PUSHJ P,CLRIMI
  5878	007172'	260040	007135*		NOCHARGE
  5879	007173'	256200	017523'		XCTFU <MOVE W,(M)>	;GET BYTE POINTER
  5880	007174'	621500	000037		TLZ W,37		;GET RID OF INDEX AND INDIRECT
  5881	007175'	256040	017524'	OUTPT1:	XCTFU <ILDB T3,W>	;GET NEXT CHARACTER
  5882	007176'	322400	007121'		JUMPE T3,ONEOU3		;DONE - SET OUTPUT BITS&RETURN
  5883	007177'	260040	013343'		PUSHJ P,TYO
  5884	007200'	334000	000000		 SKIPA			;TYO WANTS TO TAKE INTERRUPT
  5885	007201'	254000	007175'		JRST OUTPT1		;TYO DONE, NEXT CHR
  5886	007202'	135400	017525'		LDB T3,[POINT 6,W,11]	;GET SIZE FIELD
  5887	007203'	241400	777772		ROT T3,-6		;MOVE TO POSITION FILED
  5888	007204'	272400	000012		ADDM T3,W		;BACK UP POINTER 1 POSITION
  5889	007205'	256200	017526'		XCTTU <MOVEM W,(M)>	;PUT IT BACK
  5890	007206'	201300	000001		MOVEI T1,1
  5891	007207'	137300	000075'		DPB T1,LOPOUT
  5892	007210'	137305	000002		DPB T1,LDBOPB(U)
  5893	007211'	254000	007041*		JRST ABTUUO		;AND DUMP THIS UUO
  5894
  5895				;OUTPTC - OUTPUT FROM BYTE POINTER + COUNT
  5896
  5897	007212'	260040	007567'	OUTPTC:	PUSHJ	P, CLRIMI
  5898	007213'	260040	007172*		NOCHARGE
  5899	007214'	256200	017527'		XCTFU	<HRRZ P1, 0(M)>	;P1/ COUNT
  5900	007215'	322600	007116*		JUMPE	P1, CPOPJ	;IF 0, DONE
  5901	007216'	256200	017530'		XCTFU	<MOVE W, 1(M)>	;W/ BYTE POINTER
  5902	007217'	621500	000037		TLZ	W, 37		;W/ BYTE POINTER - INDEX&INDIRECT BITS
  5903	007220'	256040	017524'	OUTPC1:	XCTFU	<ILDB T3, W>	;T3/ NEXT CHARACTER
  5904	007221'	260040	013343'		PUSHJ	P, TYO		;OUTPUT IT
  5905	007222'	254000	007225'		  JRST	OUTPC2		;(TYO WANTS AN INTERRUPT)
  5906	007223'	367600	007220'		SOJG	P1, OUTPC1	;IF MORE CHARACTERS, CONTINUE
  5907	007224'	324740	007232'		PJRST	OUTPCF		;FINISH UP
  5908
  5909	007225'	135400	017525'	OUTPC2:	LDB	T3, [POINT 6,W,11]
  5910	007226'	241400	777772		ROT	T3, -6		;POSITION FIELD := SIZE FIELD
  5911	007227'	272400	000012		ADDM	T3, W		;DECREMENT BYTE POINTER BY 1 BYTE
  5912	007230'	260040	007232'		PUSHJ	P, OUTPCF	;FINISH UP
  5913	007231'	254000	007211*		JRST	ABTUUO		;AND DUMP THIS UUO
  5914
  5915					;OUTPCF ALSO USED BY OUTSNW...BELOW
  5916	007232'	256200	017531'	OUTPCF:	XCTBU	<HRRM P1, 0(M)>	;STORE THE UPDATED COUNT
  5917	007233'	256200	017532'		XCTTU	<MOVEM W, 1(M)>	;AND BYTE POINTER
  5918	007234'	201300	000001		MOVEI	T1, 1
  5919	007235'	137300	000075'		DPB	T1, LOPOUT
  5920	007236'	137305	000002		DPB	T1, LDBOPB(U)
  5921	007237'	263040	000000		POPJ	P,
  5922
  5923				;OUTSNW - OUTPUT STRING, NEVER WAIT
  5924
  5925	007240'	260040	007567'	OUTSNW:	PUSHJ	P,CLRIMI
  5926	007241'	260040	007213*		NOCHARGE
  5927	007242'	554305	000005		HLRZ	T1,LDBBIO(U)	;BLOCK OUTPUT IN PROGRESS?
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 132-2
SCNSER.MAC	25-JAN-91 22:40		OUTPTR - OUTPUT FROM BYTE POINTER

  5928	007243'	326300	007215*		JUMPN	T1,CPOPJ	;IF SO, CAN'T DO ANYTHING
  5929	007244'	256200	017527'		XCTFU	<HRRZ P1,(M)>	;P1/ COUNT
  5930	007245'	322600	007022*		JUMPE	P1,CPOPJ1	;NOTHING TO DO
  5931	007246'	256200	017530'		XCTFU	<MOVE W,1(M)>	;W/ BYTE POINTER
  5932	007247'	621500	000037		TLZ	W,37		;W/ BYTE POINTER - INDEX & IND BITS
  5933	007250'	260040	013463'	OUTSN1:	PUSHJ	P,IFROOM	;IS THERE ROOM FOR A CHARACTER?
  5934	007251'	254000	007257'		 JRST	OUTSN2		;NO ROOM - SET FIO GO AWAY
  5935	007252'	256040	017524'		XCTFU	<ILDB T3,W>	;YES ROOM - GET CHARACTER
  5936	007253'	260040	013365'		PUSHJ	P,CMDTYO	;AND OUTPUT IT
  5937	007254'	367600	007250'		SOJG	P1,OUTSN1	;DO IT AGAIN, IF MORE
  5938	007255'	350001	000000		AOS	(P)		;RAN OUT - SKIP RETURN
  5939	007256'	254000	007232'		JRST	OUTPCF		;GO AWAY
  5940	007257'	260040	016307'	OUTSN2:	PUSHJ	P,SETFIO	;SO HE'LL GET ROOM AVAILABLE TRAP
  5941	007260'	254000	007232'		JRST	OUTPCF		;NO ROOM - GO AWAY
  5942
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 133
SCNSER.MAC	25-JAN-91 22:40		GETLCH - READ LINE CHARACTERISTICS

  5943				SUBTTL	GETLCH - READ LINE CHARACTERISTICS
  5944
  5945	007261'	256200	017533'	GETLIN:	XCTFU <MOVE T1,(M)>
  5946	007262'	260040	007425'		PUSHJ P,CHKLN2	;SEE IF THIS USER CAN HAVE THIS INFO
  5947	007263'	254000	007320'		 JRST GETLNZ	;NO
  5948	007264'	135300	000157'		LDB T1,LDPLNO		;GET NUMBER
  5949	007265'	500305	000031		HLL	T1,LDBDCH(U)	; GET BITS FROM LH WHICH ARE SAME
  5950	007266'	621300	276000		TLZ	T1,-1-GTLMSK	; CLEAR ALL BITS IN LH WHICH ARN'T
  5951	007267'	135400	000014'		LDB T3,LDPHDX	;GET HALF DUPLEX BIT FROM CHRS READ
  5952	007270'	332000	000010		SKIPE T3	;SEE IF ON
  5953	007271'	661300	010000		TLO T1,GTLHDX
  5954	007272'	200405	000032		MOVE	T3, LDBDCX(U)
  5955	007273'	622400	400000		TRZE	T3, LXRESC	;READ AND CLEAR "ESCAPE SEEN"
  5956	007274'	661300	004000		TLO	T1, GTLESC	;RETURN ITS OLD VALUE
  5957	007275'	622400	200000		TRZE	T3, LXROBS	;READ AND CLEAR "ORANGE BALL SEEN"
  5958	007276'	661300	020000		TLO	T1, GTLOBS	;RETURN ITS OLD VALUE
  5959	007277'	202405	000032		MOVEM	T3, LDBDCX(U)
  5960	007300'	205400	200000		MOVSI	T3, LMLPSP
  5961	007301'	612405	000030		TDNE	T3, LDBMOD(U)	;CHECK FOR UNREAD PORT-STATUS MSG
  5962	007302'	661300	040000		TLO	T1, GTLPSP	;AND SET IF THERE IS ONE
  5963	007303'	135400	000010'		LDB T3,LDPCRD	;GET RETURN DELAY BIT
  5964	007304'	332000	000010		SKIPE T3
  5965	007305'	661300	002000		TLO T1,GTLCRD
  5966	007306'	500245	000031		HLL U,LDBDCH(U)	;THE OTHERS FROM NORMAL BITS
  5967	007307'	200405	000015		MOVE T3,LDBBKC(U)	;GET BREAK COUNTER
  5968	007310'	603240	004000		TLNE U,LDLBK2	;IF IN BREAK 2 MODE
  5969	007311'	270405	000016		ADD T3,LDBBK2(U)	;ADD IN THESE
  5970	007312'	602400	777777		TRNE T3,-1
  5971	007313'	665300	000100		TLOA T1,GTLLRD		;SET LINE READY BIT
  5972	007314'	621300	000100		TLZ T1,GTLLRD		;OR TURN IT OFF
  5973	007315'	641300	000020		TLC T1,GTLLCT		;SENSE OF THIS BIT IS WRONG
  5974	007316'	256200	017534'		XCTTU <MOVEM T1,(M)>
  5975	007317'	263040	000000		POPJ P,
  5976
  5977	007320'	256200	017535'	GETLNZ:	XCTBU <SETZM (M)>
  5978	007321'	263040	000000		POPJ P,
  5979
  5980				; THE FOLLOWING BITS ARE IN THE SAME PLACE IN LDBDCH AS IN GETLCH...
  5981			501777	GTLMSK==LDLNOP!LDLDEF!LDLECS!LDLOSU!LDLNFC!LDLNEC!LDLAUX!LDLLCT!LDLTAB!LDLLCP!LDLPTP!LDLFRM
  5982
  5983			100000	GTLECS==100000	;EAT COMMAND SYNCH (CMD AVAIL FOR RESCAN)
  5984			040000	GTLPSP==40000	;PORT STATUS PENDING (UNREAD, see comment at ACPSM)
  5985			020000	GTLOBS==20000	;ORANGE BALL SEEN
  5986			010000	GTLHDX==10000	;HALF DUPLEX
  5987			004000	GTLESC==4000	;ESCAPE SEEN
  5988			002000	GTLCRD==2000	;CARRIAGE-RETURN(NOT LF) PADDING
  5989			001000	GTLDEF==1000	;DEFERRED ECHO MODE
  5990			000200	GTLNFC==200	;NO FREE CRLF (ON LONG LINES)
  5991			000100	GTLLRD==100	;LINE (BREAK) IN BUFFER
  5992			000020	GTLLCT==20	;NO CASE MAPPING
  5993			000010	GTLTAB==10	;HARDWARE HT
  5994			000002	GTLPTP==2	;PAPER TAPE MODE
  5995			000001	GTLFRM==1	;HARDWARE FF/VT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 134
SCNSER.MAC	25-JAN-91 22:40		SETLCH - SET LINE CHARACTERISTICS

  5996				SUBTTL	SETLCH - SET LINE CHARACTERISTICS
  5997
  5998	007322'	010000	000004	SLCTAB:	GTLHDX,,TCNHDX
  5999	007323'	002000	000000		GTLCRD,,TCNCRD
  6000	007324'	000200	000027		GTLNFC,,TCNNFC
  6001	007325'	000020	000026		GTLLCT,,TCNLCT
  6002	007326'	000010	000024		GTLTAB,,TCNTAB
  6003	007327'	000002	000030		GTLPTP,,TCNPTP
  6004	007330'	000001	000025		GTLFRM,,TCNFRM
  6005			000007	SLCTBN==.-SLCTAB
  6006
  6007	007331'	256200	017536'	SETLIN:	XCTFU	<HLRZ P1,(M)>	;P1/ 0,,USER BITS
  6008	007332'	640600	000020		TRC	P1, GTLLCT	;INVERT SENSE OF CASE-MAP BIT
  6009	007333'	200640	017537'		MOVE	P2, [-SLCTBN,,SLCTAB]
  6010	007334'	500415	000000	SETLN1:	HLL	T3, (P2)	;T3/ THE BIT
  6011	007335'	607414	000000		TLNN	T3, (P1)	;SET IT OR CLEAR IT?
  6012	007336'	634340	000007		TDZA	T2, T2		;(CLEAR)
  6013	007337'	201340	000001		MOVEI	T2, 1		;(SET)
  6014	007340'	550315	000000		HRRZ	T1, (P2)	;T1/ THE TC#
  6015	007341'	260040	010356'		PUSHJ	P, SETTCN
  6016	007342'	256000	000000'		 STOPCD 		;WHAT ERROR?
  6017	007343'	253640	007334'		AOBJN	P2, SETLN1
  6018	007344'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 135
SCNSER.MAC	25-JAN-91 22:40		CHARACTER INPUT TTCALLS

  6019				SUBTTL	CHARACTER INPUT TTCALLS
  6020
  6021	007345'	260040	007241*	INCHRS:	NOCHARGE
  6022	007346'	260040	007147'		PUSHJ P,SKPINC			;CAN I GET A CHARACTER (CLEAR ^O)
  6023	007347'	254000	007152'	ICS1:	  JRST NOCTRO			;NO. GIVE NON-SKIP RETURN
  6024	007350'	260040	013662'		PUSHJ P,TWAITS
  6025	007351'	263040	000000		  POPJ	P,			;DETACHED
  6026	007352'	260040	013135'		PUSHJ P,TYI			;GET A CHARACTER
  6027	007353'	254000	007347'		  JRST ICS1			;NONE THERE. SKPINC LIED?
  6028	007354'	350001	000000		AOS 0(P)			;GIVE SKIP RETURN
  6029	007355'	254000	007400'		JRST ICW1A			;AND RETURN THE CHARACTER
  6030	007356'	260040	007345*	INCHSL:	NOCHARGE
  6031	007357'	260040	007157'		PUSHJ P,SKPINL			;IS THERE A LINE AVAILABLE?
  6032	007360'	263040	000000		  POPJ P,0			;NO. NON-SKIP RETURN TO USER
  6033	007361'	260040	013621'		PUSHJ P,TWAITL
  6034	007362'	260040	013135'		PUSHJ P,TYI		;GET THE CRH.
  6035	007363'	254000	007347'		 JRST ICS1		;REALLY NONE THERE
  6036	007364'	350001	000000		AOS (P)			;SET FOR SKIP RETURN
  6037	007365'	254000	007377'		JRST ICW1B		;GO (REMEMBER TO CHARGE
  6038
  6039	007366'	350001	000000	I1CHWL:	AOS (P)		;FROM AUXCAL
  6040	007367'	260040	007356*	INCHWL:	NOCHARGE
  6041	007370'	603240	002000	INWL1:	TLNE U,LDLIMI	;CHECK IMAGE MODE
  6042	007371'	607000	000040		TLNN S,IOEND
  6043	007372'	334000	000000		SKIPA
  6044	007373'	254000	007407'		JRST ICH0		;SEND A 0 CHRACTER
  6045	007374'	260040	013621'		PUSHJ P,TWAITL			;WAIT FOR A LINE TO APPEAR
  6046	007375'	260040	013135'		PUSHJ P,TYI			;GO GET A CHARACTER
  6047	007376'	254000	007370'		  JRST INWL1			;IMPOSSIBLE. NO CHARACTERS.
  6048	007377'	306340	000002	ICW1B:	CAIN T2,%CHBRK		;A BREAK?
  6049	007400'	260040	006411'	ICW1A:	PUSHJ P,SETBRK		;YES, CHARGE
  6050	007401'	606000	000010	ICW1:	TRNN S,10		;IF MODES 10,13,14
  6051	007402'	606000	000002		TRNN S,2		;OR 0,1
  6052	007403'	624400	000600		TRZA T3,600		;SAME AS ANDI 177 SINCE TTGETC GETS 9 BIT BYTE
  6053	007404'	405400	000377		ANDI T3,377		;8 BITS IN MODE 2
  6054	007405'	256200	017540'		XCTTU <MOVEM T3,(M)>			;GIVE HIM THE CHARACTER
  6055	007406'	254000	007152'		JRST NOCTRO			;AND NON-SKIP RETURN
  6056
  6057	007407'	201400	000000	ICH0:	MOVEI T3,0
  6058	007410'	254000	007401'		JRST ICW1
  6059
  6060	007411'	350001	000000	I1CHRW:	AOS (P)		;FROM AUXCAL
  6061	007412'	260040	007367*	INCHRW:	NOCHARGE
  6062	007413'	260040	013664'	INRW1:	PUSHJ P,TWAITC			;WAIT FOR A CHARACTER TO APPEAR
  6063	007414'	260040	013135'		PUSHJ P,TYI			;GO GET THE CHARACTER
  6064	007415'	254000	007413'		  JRST INRW1			;IMPOSSIBLE. NONE THERE
  6065	007416'	254000	007400'		JRST ICW1A			;GIVE HIM T3 AND RETURN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 136
SCNSER.MAC	25-JAN-91 22:40		CHARACTER INPUT TTCALLS

  6066				;Get LDBLOG for GETTAB uuo
  6067	007417'	260040	007426'	GETLOG::PUSHJ	P,CHKLIN	;GETTAB to return LDBLOG.  Check if OK
  6068	007420'	263040	000000		  POPJ	P,		;Error, can not have info
  6069	007421'	334305	000026		SKIPA	T1,LDBLOG(U)
  6070	007422'	201300	000000	RETZRO:	MOVEI	T1,0		;NO LINE THERE, RETURN 0
  6071	007423'	705313	000000	STOTC1:	UMOVEM	T1,(M)		;RETURN ARGUMENT TO USER'S AREA.
  6072	007424'	254000	007245*		JRST	CPOPJ1		;AND SKIP RETURN.
  6073
  6074	007425'	334240	000006	CHKLN2:	SKIPA	U,T1		;Line # in RH
  6075	007426'	574240	000006	CHKLIN:	HLRE	U,T1		;Line # in LH
  6076	007427'	321240	007433'		JUMPL	U,CKLN1		;-1 for own line
  6077	007430'	303240	005673*		CAILE	U,MXLIN##
  6078	007431'	263040	000000		 POPJ	P,		;Illegal line number
  6079	007432'	334245	006611*		SKIPA	U,LINTAB(U)	;Get addr of LDB
  6080	007433'	260040	014557'	CKLN1:	 PUSHJ	P,TTYFNU	;Find LDB for job
  6081	007434'	322240	007243*		JUMPE	U,CPOPJ		;NO LINE NUMBER THERE
  6082	007435'	550205	000000		HRRZ	F,LDBDDB(U)	;GET THE DDB
  6083	007436'	322200	007434*		JUMPE	F,CPOPJ		;IF NONE, NO ONE CONNECTED
  6084	007437'	135100	006636*		LDB	J,PJOBN		;GET THE JOB NUMBER
  6085	007440'	254000	000000*		JRST	CHKSEG		;AND GO CHECK
  6086
  6087	007441'	260040	007426'	LINJOB::PUSHJ	P,CHKLIN	;Return job which owns a specific line
  6088	007442'	263040	000000		  POPJ	P,
  6089	007443'	550205	000000		HRRZ	F,LDBDDB(U)
  6090	007444'	322200	007422'		JUMPE	F,RETZRO
  6091	007445'	135300	007437*		LDB	T1,PJOBN	;GET THE JOB NUMBER
  6092	007446'	254000	007423'		JRST	STOTC1
  6093
  6094	007447'	260040	007426'	GETLPS::PUSHJ	P,CHKLIN	;Return horizontal position of line
  6095	007450'	263040	000000		  POPJ	P,
  6096	007451'	135300	000175'		LDB	T1,LDPPOS
  6097	007452'	254000	007423'		JRST	STOTC1
  6098
  6099	007453'	260040	007426'	GETMOD::PUSHJ	P,CHKLIN	;Return status (DEVIOS)
  6100	007454'	263040	000000		  POPJ	P,
  6101	007455'	550205	000000		HRRZ	F,LDBDDB(U)
  6102	007456'	322200	007422'		JUMPE	F,RETZRO
  6103	007457'	200304	000002		MOVE	T1,DEVIOS(F)
  6104	007460'	254000	007423'		JRST STOTC1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 137
SCNSER.MAC	25-JAN-91 22:40		CHARACTER INPUT TTCALLS

  6105	007461'	260040	007412*	RDNXT:	NOCHARGE
  6106	007462'	337005	000014		SKIPG LDBECC(U)	;MAKE SURE A CHR IS THERE
  6107	007463'	333005	000012		SKIPLE LDBTIC(U)
  6108	007464'	354001	000000		AOSA (P)
  6109	007465'	263040	000000		POPJ P,			;NO, RETURN
  6110	007466'	200345	000011		MOVE T2,LDBTIT(U)
  6111	007467'	260040	006152'		PUSHJ P,TTGETC
  6112	007470'	255000	000000		 JFCL
  6113	007471'	606000	000010		TRNN S,10		;IF MODES 10,13,14
  6114	007472'	606000	000002		TRNN S,2		;OR 0,1
  6115	007473'	624400	000600		TRZA T3,600		;SAME AS ANDI 177 SINCE TTGETC GETS 9 BIT BYTE
  6116	007474'	405400	000377		ANDI T3,377		;8 BITS IN MODE 2
  6117	007475'	256200	017540'		XCTTU <MOVEM T3,(M)>	;GIVE IT TO HIM
  6118	007476'	263040	000000		POPJ P,
  6119
  6120	007477'	205300	010000	LEVDEF:	MOVSI T1,L2LLDF
  6121	007500'	436305	000027		IORM T1,LDBBYT(U)
  6122	007501'	260040	013771'		PUSHJ P,BPLVD	;TURN OFF BACKPRESSURE IF APPROPRIATE
  6123	007502'	201300	000001		MOVEI T1,1
  6124	007503'	137300	000102'		DPB T1,LOPECO
  6125	007504'	137305	000002		DPB T1,LDBOPB(U)
  6126	007505'	263040	000000		POPJ P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 138
SCNSER.MAC	25-JAN-91 22:40		READ TERMINAL CHARACTERISTICS

  6127				SUBTTL	READ TERMINAL CHARACTERISTICS
  6128
  6129	007506'	704313	000000	GETMC:	UMOVE T1,(M)	;GET THE LINE HE WANTS THESE FOR
  6130	007507'	260040	007425'		PUSHJ P,CHKLN2
  6131	007510'	254000	007320'		 JRST GETLNZ	;CAN NOT HAVE THEM
  6132	007511'	402000	000006		SETZM	T1	;MAKE UNFILLED FIELDS 0 (ARE THERE ANY?)
  6133	007512'	135400	000172'		LDB T3,LDPFC1	;FILLER CLASS 1
  6134	007513'	137400	007542'		DPB T3,GEPMC1
  6135	007514'	135400	000166'		LDB T3,LDPFC2	;FILLER CLASS 2
  6136	007515'	137400	007543'		DPB T3,GEPMC2
  6137	007516'	135400	000170'		LDB T3,LDPWID	;WIDTH
  6138	007517'	137400	007544'		DPB T3,GEPMC3
  6139	007520'	135400	007545'		LDB T3,GEPMC4	;NO XON, NO TAB, TAB AS BREAK BITS
  6140	007521'	137400	007546'		DPB T3,GEPMC5
  6141	007522'	135400	000011'		LDB T3,LDPIR
  6142	007523'	137400	007547'		DPB T3,GEPMC6
  6143	007524'	135400	000012'		LDB T3,LDPOR
  6144	007525'	137400	007550'		DPB T3,GEPMC7
  6145	007526'	135400	000013'		LDB T3,LDPPAR
  6146	007527'	137400	007551'		DPB T3,GEPMC8
  6147	007530'	135400	000015'		LDB T3,LDPPA
  6148	007531'	137400	007552'		DPB T3,GEPMC9
  6149	007532'	135400	000014'		LDB T3,LDPHDX
  6150	007533'	137400	007553'		DPB T3,GEPM10
  6151	007534'	135400	000016'		LDB T3,LDPPB
  6152	007535'	137400	007554'		DPB T3,GEPM11
  6153	007536'	135400	000017'		LDB T3,LDPPC
  6154	007537'	137400	007555'		DPB T3,GEPM12
  6155	007540'	705313	000000		UMOVEM T1,(M)
  6156	007541'	263040	000000		POPJ P,
  6157
  6158	007542'	230200	000006	GEPMC1:	POINT 2,T1,16	;FILLER CLASS 1
  6159	007543'	250200	000006	GEPMC2:	POINT 2,T1,14	;FILLER CLASS 2
  6160	007544'	271000	000006	GEPMC3:	POINT 8,T1,12	;WIDTH
  6161	007545'	370305	000027	GEPMC4:	POINT 3,LDBBYT(U),4	;GET NO XON, NO TAB, TAB AS BRK
  6162	007546'	370300	000006	GEPMC5:	POINT 3,T1,4	;LOCATION OF ABOVE IN GETTMC WORD
  6163	007547'	200300	000006	GEPMC6:	POINT 3,T1,19	;IR
  6164	007550'	150300	000006	GEPMC7:	POINT 3,T1,22	;OR
  6165	007551'	140100	000006	GEPMC8:	POINT 1,T1,23	;PAR
  6166	007552'	110300	000006	GEPMC9:	POINT 3,T1,26	;PA
  6167	007553'	100100	000006	GEPM10:	POINT 1,T1,27	;HDX
  6168	007554'	050300	000006	GEPM11:	POINT 3,T1,30	;PB
  6169	007555'	000500	000006	GEPM12:	POINT 5,T1,35	;0 BIT + PC
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 139
SCNSER.MAC	25-JAN-91 22:40		FIXIMI CALLED ON INPUT UUOS OTHER THAN AUXCALS 0,1,2 TO SET

  6170				SUBTTL	FIXIMI CALLED ON INPUT UUOS OTHER THAN AUXCALS 0,1,2 TO SET
  6171				;IMAGE STATE FROM DATA MODE
  6172
  6173	007556'	200305	000031	FIXIMI:	MOVE	T1,LDBDCH(U)
  6174	007557'	607300	000040		TLNN	T1,LDLAUX	;AUX CIRCUIT?
  6175	007560'	602000	000010		TRNE	S,I		;OR DATA MODE = I, IB, B?
  6176	007561'	665300	002000		 TLOA	T1,LDLIMI	;YES: SET IMAGE STATE
  6177	007562'	621300	002000		TLZ	T1,LDLIMI	;NO: CLEAR IMAGE STATE
  6178	007563'	316305	000031		CAMN	T1,LDBDCH(U)	;DID IT CHANGE?
  6179	007564'	263040	000000		 POPJ	P,		;NO
  6180	007565'	202305	000031		MOVEM	T1,LDBDCH(U)	;YES
  6181	007566'	324740	007603'		PJRST	SETLMD
  6182
  6183				;CLRIMI CALLED ON OUTPUT UUOS TO CLEAR IMAGE STATE IF DATA
  6184				;MODE IS NOT IMAGE AND TO TURN OFF BACKPRESSURE (IN GENERAL,
  6185				;TO NOTE THAT THE LINE IS NO LONGER SIMPLY IN INPUT WAIT)
  6186
  6187	007567'	550205	000000	CLRIMI:	HRRZ	F,LDBDDB(U)		;GET ATTACHED JOB, IF ANY
  6188	007570'	322200	007574'		JUMPE	F,CLRIM1		;IF NONE, SKIP PART OF THIS
  6189	007571'	200004	000002		MOVE	S,DEVIOS(F)		;JOB'S IO STATUS FOR TTY
  6190	007572'	602000	000010		TRNE	S,I			;IS IT STILL IN IMAGE MODE?
  6191	007573'	263040	000000		 POPJ	P,0			;YES. FORGET IT.
  6192	007574'	205300	002000	CLRIM1:	MOVSI	T1,LDLIMI		;NO. CLEAR IMAGE BIT AND TIME
  6193	007575'	607240	000040		TLNN	U,LDLAUX		;AUX ALWAYS IN IMAGE MODE
  6194	007576'	616305	000031		TDNN	T1,LDBDCH(U)		;IS IT ON?
  6195	007577'	263040	000000		 POPJ	P,			;NO
  6196	007600'	412305	000031		ANDCAM	T1,LDBDCH(U)		; ..
  6197	007601'	260040	014027'		PUSHJ	P,BPTEST		;WANT TO TURN OFF BACKPRESSURE?
  6198	007602'	260040	014016'		  PUSHJ	P,BPOFF			;YES, NOW TURN OFF BACKPRESSURE
  6199					PFALL	SETLMD
  6200
  6201	007603'	135300	000207'	SETLMD:	LDB	T1,LDPMDF		;GET LINE MODE FLAGS
  6202	007604'	200306	003135'		MOVE	T1,MDFLMD(T1)		;DO TRANSLATION INTO MODE
  6203	007605'	137300	000200'		DPB	T1,LDPLMD		;AND SET INPUT AND ECHO MODES
  6204	007606'	263040	000000		POPJ	P,0			; AND RETURN
  6205	
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 140
SCNSER.MAC	25-JAN-91 22:40		SETTBK - SET TABS AS BREAK

  6206				SUBTTL	SETTBK - SET TABS AS BREAK
  6207				;SETTBK - CALLED WITH
  6208				;	T1/ L2LTBK,,L2LTBK	SET TAB-AS-BREAK
  6209				;	T1/	 0,,L2LTBK	SET TAB-AS-PUNCTUATION
  6210				;	T1/ L2LBBP,,L2LBBP	SET BS-AS-PUNCTUATION
  6211				;	T1/	 0,,L2LBBP	SET BS-AS-BREAK
  6212				;BREAKS T1-T4
  6213
  6214	007607'	200340	000006	SETTBK:	MOVE	T2, T1
  6215	007610'	430305	000027		XOR	T1, LDBBYT(U)
  6216	007611'	607307	000000		TLNN	T1, 0(T2)	;IF THE BIT DIDN'T CHANGE,
  6217	007612'	263040	000000		POPJ	P,		;  JUST RETURN
  6218	007613'	514300	000007		HRLZ	T1, T2
  6219	007614'	432305	000027		XORM	T1, LDBBYT(U)	;INVERT THE LDB BIT
  6220	007615'	201300	000011		MOVEI	T1, 11		;(ASSUME IT'S TAB-AS-BREAK)
  6221	007616'	606340	040000		TRNN	T2, L2LBBP	;IF IT'S BS-AS-PUNCTUATION,
  6222	007617'	254000	007622'		JRST	SETTB1
  6223	007620'	201300	000010		MOVEI	T1, 10		;  CHAR := 10
  6224	007621'	641340	040000		TLC	T2, L2LBBP	;  INVERT SENSE (TO BS-AS-BREAK)
  6225	007622'	603340	777777	SETTB1:	TLNE	T2, -1		;WHICH WAY?
  6226	007623'	324740	007632'		PJRST	PNTOBK		;(PUNCTUATION = BREAK)
  6227	007624'	324740	007625'		PJRST	BKTOPN		;(BREAK = PUNCTUATION)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 141
SCNSER.MAC	25-JAN-91 22:40		BKTOPN - CALLED WITH U/ LDB ADDR, T1/ <CHAR>

  6228				SUBTTL	BKTOPN - CALLED WITH U/ LDB ADDR, T1/ <CHAR>
  6229				;	   MAKE <CHAR> GO FROM A BREAK TO A PUNCTUATION CHARACTER
  6230				;	   BY ADJUSTING COUNTS
  6231				;	   DESTROYS T1 T2 T3 T4
  6232
  6233	007625'	260040	007643'	BKTOPN:	PUSHJ	P, CHRCNT	;T1/ #UNECHOED,,#ECHOED
  6234	007626'	272305	000016		ADDM	T1, LDBBK2(U)	;ADD TO PUNCTUATION COUNT
  6235	007627'	213000	000006		MOVNS	T1
  6236	007630'	272305	000015		ADDM	T1, LDBBKC(U)	;SUBTRACT FROM BREAK COUNT
  6237	007631'	263040	000000		POPJ	P,
  6238
  6239				;PNTOBK - CALLED WITH U/ LDB ADDR, T1/ <CHAR>
  6240				;	   MAKE <CHAR> GO FROM A PUNCTUATION TO A BREAK CHARACTER
  6241				;	   BY ADJUSTING COUNTS, LINE DELETE POINTER
  6242				;	   DESTROYS T1 T2 T3 T4
  6243
  6244	007632'	260040	007643'	PNTOBK:	PUSHJ	P, CHRCNT	;P2/ #UNECHOED,,#ECHOED
  6245	007633'	272305	000015		ADDM	T1, LDBBKC(U)	;ADD TO BREAK COUNT
  6246	007634'	213000	000006		MOVNS	T1
  6247	007635'	272305	000016		ADDM	T1, LDBBK2(U)	;SUBTRACT FROM PUNCTUATION COUNT
  6248	007636'	322300	007642'		JUMPE	T1, PNTOB1	;IF THERE ARE ANY NEW BREAK CHARACTERS,
  6249	007637'	200345	000010		MOVE	T2, LDBTIP(U)
  6250	007640'	202345	000006		MOVEM	T2, LDBBKP(U)	;  SET LINE-DELETE POINTER TO NOW
  6251	007641'	402005	000007		SETZM	LDBBKI(U)	;  (NO DELETABLE CHARACTERS)
  6252	007642'	263040	000000	PNTOB1:	POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 142
SCNSER.MAC	25-JAN-91 22:40		CHRCNT - CALLED WITH U/ LDB ADDR, T1/ CHAR

  6253				SUBTTL	CHRCNT - CALLED WITH U/ LDB ADDR, T1/ CHAR
  6254				;	   RETURNS T1/ #UNECHOED,,#ECHOED <CHAR>S IN THE INPUT BUFFER
  6255				;	   DESTROYS T1 T2 T3 T4
  6256
  6257	007643'	261040	000014	CHRCNT:	PUSH	P, P1
  6258	007644'	261040	000015		PUSH	P, P2
  6259	007645'	200600	000006		MOVE	P1, T1		;P1/ CHAR
  6260	007646'	400640	000000		SETZ	P2,		;P2/ COUNT
  6261	007647'	200345	000013		MOVE	T2, LDBECT(U)	;T2/ ECHO-TAKER BYTE POINTER
  6262	007650'	332445	000014		SKIPE	T4, LDBECC(U)	;T4/ #UNECHOED,UNREAD CHARACTERS
  6263	007651'	260040	007662'		PUSHJ	P, CNTCHR	;IF ANY, COUNT #<CHAR>S
  6264	007652'	517000	000015		HRLZS	P2		;P2/ UNECHOED,,ECHOED
  6265	007653'	200345	000011		MOVE	T2, LDBTIT(U)	;T2/ CHAR-TAKER BYTE POINTER
  6266	007654'	332445	000012		SKIPE	T4, LDBTIC(U)	;T4/ #ECHOED,UNREAD CHARACTERS
  6267	007655'	260040	007662'		PUSHJ	P, CNTCHR	;IF ANY, COUNT #<CHAR>S
  6268	007656'	200300	000015		MOVE	T1, P2		;T1/ COUNT
  6269	007657'	262040	000015		POP	P, P2
  6270	007660'	262040	000014		POP	P, P1
  6271	007661'	263040	000000		POPJ	P,
  6272
  6273				    ;T2/ BUFFERLET BYTE POINTER, T4/ COUNT
  6274				    ;P1/ <CHAR> TO LOOK FOR, P2/ COUNT TO INCREMENT
  6275
  6276	007662'	260040	006152'	CNTCHR:	PUSHJ	P, TTGETC	;T3/ NEXT CHAR
  6277	007663'	255000	000000		  JFCL			;(EH?)
  6278	007664'	405400	000177		ANDI	T3, 177		;T3/ ASCII PART OF THE CHAR
  6279	007665'	316400	000014		CAMN	T3, P1		;IF IT'S THE <CHAR>,
  6280	007666'	350000	000015		AOS	P2		;  COUNT IT
  6281	007667'	367440	007662'		SOJG	T4, CNTCHR
  6282	007670'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 143
SCNSER.MAC	25-JAN-91 22:40		SETPTP - SETS PAPER-TAPE-MODE BIT (SIMILAR CODE IN SETLIN)

  6283				SUBTTL	SETPTP - SETS PAPER-TAPE-MODE BIT (SIMILAR CODE IN SETLIN)
  6284				;	   T1/ 0 TO CLEAR PTP, LDLPTP,,0 TO SET PTP MODE
  6285				;	   (DESTROYS T1)
  6286
  6287	007671'	430305	000031	SETPTP:	XOR	T1, LDBDCH(U)
  6288	007672'	607300	000002		TLNN	T1, LDLPTP	;IF IT'S NOT CHANGING,
  6289	007673'	263040	000000		POPJ	P,		;  JUST RETURN
  6290	007674'	433305	000031		XORB	T1, LDBDCH(U)	;SET DCH BIT
  6291	007675'	603300	000002		TLNE	T1, LDLPTP	;IN PTP MODE?
  6292	007676'	634300	000006		TDZA	T1, T1		;YES: ECHO CR AS CR
  6293	007677'	201300	000001		MOVEI	T1, 1		;NO: ECHO CR AS CRLF
  6294	007700'	137300	000034'		DPB	T1, LDSECR
  6295	007701'	200300	017541'		MOVE	T1, [LTSECR]
  6296	007702'	436305	000050		IORM	T1, LDBTMT(U)
  6297	007703'	201300	000001		MOVEI	T1, 1
  6298	007704'	137300	000071'		DPB	T1, LOPSTC	;SET SEND-CHARACTERISTICS
  6299	007705'	137305	000002		DPB	T1, LDBOPB(U)	;SET WANT-OUTPUT
  6300	007706'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 144
SCNSER.MAC	25-JAN-91 22:40		PSEUDO-TTYS

  6301				SUBTTL PSEUDO-TTYS
  6302
  6303				;CREPTY UUO - CREATE A PTY
  6304				;
  6305				;	CREPTY	AC,
  6306				;	  ERROR RETURN	;AC/ ERROR CODE
  6307				;	NORMAL RETURN	;AC/ PORT1#,,PORT2#
  6308
  6309			000001	CPNPT%==1	;OUT OF PTYS (OR THERE NEVER WERE ANY)
  6310			000002	CPNRM%==2	;NO ROOM FOR PTYS (OUT OF DDBS)
  6311
  6312	007707'	260040	007731'	CREPTY::PUSHJ	P, GETPP	;GET A PORT# PAIR. T1/ EVEN SIDE #
  6313					  JRST	[MOVEI	T1,CPNPT%
  6314	007710'	254000	017542'			 JRST	CPERR	]
  6315	007711'	202300	000014		MOVEM	T1, P1
  6316	007712'	260040	007750'		PUSHJ	P, PTYLDB	;SET UP ITS LDB. U/ LDB ADDR
  6317	007713'	506240	000015		HRLM	U, P2		;P2/ EVEN-SIDE LDB,,---
  6318	007714'	260040	010004'		PUSHJ	P, PTYDDB	;SET UP ITS DDB. F/ DDB ADDR
  6319					  JRST	[MOVEI	T1, CPNRM%
  6320	007715'	254000	017544'			 JRST	CPERR	]
  6321	007716'	542200	000015		HRRM	F, P2		;P2/ EVEN-SIDE LDB,,DDB
  6322	007717'	201314	000001		MOVEI	T1, 1(P1)	;T1/ ODD-SIDE PORT#
  6323	007720'	260040	007750'		PUSHJ	P, PTYLDB	;SET UP ITS LDB. U/ LDB ADDR
  6324	007721'	260040	010004'		PUSHJ	P, PTYDDB	;SET UP ITS DDB. F/ DDB ADDR
  6325					  JRST	[HRRZ	F, P2
  6326						 PUSHJ	P, TTYKDB	;FREE EVEN DDB
  6327						 HLRZ	U, P2
  6328						 HLLZS	LDBDDB(U)	;DETACH EVEN LDB
  6329						 SETZM	LDBLOG(U)	;FREE EVEN LDB (leave LDPHST)
  6330						 MOVEI	T1,CPNRM%
  6331	007722'	254000	017546'			 JRST	CPERR	]
  6332	007723'	507000	000014		HRLS	P1		;P1/ EVEN PORT#,,EVEN PORT#
  6333	007724'	660600	000001		TRO	P1, 1		;P1/ EVEN PORT#,,ODD PORT#
  6334	007725'	705613	000000		UMOVEM	P1, (M)		;GIVE USER THE PORT #S
  6335	007726'	254000	007424*		JRST	CPOPJ1		;SUCCESS!
  6336
  6337	007727'	705313	000000	CPERR:	UMOVEM	T1, (M)		;GIVE USER THE ERROR CODE
  6338	007730'	263040	000000		POPJ	P,		;FAILURE!
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 145
SCNSER.MAC	25-JAN-91 22:40		GETPP - GET AN EVEN/ODD PTY PORT # PAIR

  6339				SUBTTL	GETPP - GET AN EVEN/ODD PTY PORT # PAIR
  6340				;	  NONSKIP-RETURN IF NONE
  6341				;	  SKIP-RETURN WITH T1/ THE EVEN # ON SUCCESS
  6342				;DESTROYS T2 U
  6343
  6344	007731'	334300	017555'	GETPP:	SKIPA	T1,[<<PORTN##-PPORTN##+1>&<-1-1>>]
  6345	007732'	271300	000002	GETPP1:	ADDI	T1,2		;GO ON TO THE NEXT PAIR
  6346	007733'	303300	777776*		CAILE	T1,PORTN##-2	;IF WE'RE PAST THE TOP PAIR,
  6347	007734'	263040	000000		 POPJ	P,		;  FAIL
  6348	007735'	550346	007432*		HRRZ	T2,LINTAB(T1)	;T2/ EVEN-SIDE LDB ADDR
  6349	007736'	332007	000026		SKIPE	LDBLOG(T2)	;IF IT'S LOGGED-IN,
  6350	007737'	254000	007732'		 JRST	GETPP1		;  TRY THE NEXT PAIR
  6351	007740'	550346	000001*		HRRZ	T2,LINTAB+1(T1)	;T2/ ODD-SIDE LDB ADDR
  6352	007741'	332007	000026		SKIPE	LDBLOG(T2)	;IF IT'S LOGGED-IN,
  6353	007742'	254000	007732'		 JRST	GETPP1		;  TRY THE NEXT PAIR
  6354	007743'	254000	007726*		JRST	CPOPJ1		;SUCCESS!
  6355
  6356				;PTYBUD - GET PTY BUDDY
  6357				;	CALLED WITH U/ PTY LDB
  6358				;	RETURNS U/ PTY LDB OF ITS OTHER END
  6359
  6360	007744'	135240	000157'	PTYBUD:	LDB	U,LDPLNO
  6361	007745'	640240	000001		TRC	U,1
  6362	007746'	550245	007735*		HRRZ	U,LINTAB(U)	;U/ "BUDDY" LDB ADDR
  6363	007747'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 146
SCNSER.MAC	25-JAN-91 22:40		PTYLDB - SET UP A PTY LDB

  6364				SUBTTL	PTYLDB - SET UP A PTY LDB
  6365				;	   CALLED WITH T1/ PTY PORT #
  6366				;	   RETURN WITH U/ THE LDB
  6367
  6368	007750'	550246	007746*	PTYLDB:	HRRZ	U,LINTAB(T1)	;U/ LDB ADDR
  6369	007751'	336000	000005		SKIPN	U
  6370	007752'	256000	000000'		 STOPCD
  6371	007753'	135340	000157'		LDB	T2,LDPLNO	;T2/ LDB'S IDEA OF ITS PORT #
  6372	007754'	312300	000007		CAME	T1,T2
  6373	007755'	256000	000000'		 STOPCD
  6374
  6375				    ;NOW THAT WE'VE GOT THE LDB, INITIALIZE IT
  6376				    ;THIS CODE SHOULD REMAIN ALMOST IDENTICAL WITH
  6377				    ;THE CODE AT AUXINP FOR NEW AUX CIRCUITS
  6378
  6379	007756'	205300	400000		MOVSI	T1,(1B0)	;"Logged-in" bit (term id of 0)
  6380	007757'	135340	000157'		LDB	T2,LDPLNO	;This line's number
  6381	007760'	640340	000001		TRC	T2,1		;Circuit came from its buddy
  6382	007761'	137340	017556'		DPB	T2,[POINT 8,T1,35] ;Origination line number
  6383	007762'	202305	000026		MOVEM	T1,LDBLOG(U)	;Node number gets set by LOGLDB routine
  6384	007763'	200300	000701*		MOVE	T1,SYSNUM##	;System number is
  6385	007764'	137300	000160'		DPB	T1,LDPHST	; origination host number for PTY
  6386	007765'	402005	000003		SETZM	LDBOUT(U)
  6387	007766'	402005	000027		SETZM	LDBBYT(U)
  6388	007767'	402005	000030		SETZM	LDBMOD(U)
  6389	007770'	201300	000120		MOVEI	T1,^D80		;"SET TTY WIDTH 80"
  6390	007771'	137300	000170'		DPB	T1,LDPWID
  6391	007772'	402005	000050		SETZM	LDBTMT(U)
  6392			000000		ZZN==0
  6393					REPEAT TMCSIZ, <SETZM LDBTMR+ZZN(U)
  6394					ZZN==ZZN+1>
  6395	007773'	402005	000044
  6396	007774'	402005	000045
  6397	007775'	205300	041000		MOVSI	T1,LDLDEF!LDLPTY
  6398	007776'	202305	000031		MOVEM	T1,LDBDCH(U)	;DIFFERENT FROM AUX CIRCUITS!
  6399	007777'	205300	400000		MOVSI	T1,LXL120
  6400	010000'	202305	000032		MOVEM	T1,LDBDCX(U)	;BUFFER AS A FAST LINE
  6401	010001'	402005	000004		SETZM	LDBTCB(U)	;NO CHANGED TERMINAL CHARACTERISTICS
  6402	010002'	260040	007603'		PUSHJ	P,SETLMD	;SET THE LINE MODE
  6403	010003'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 147
SCNSER.MAC	25-JAN-91 22:40		PTYDDB - ALLOCATE, LINK IN, ATTACH, INITIALIZE A PTY DDB

  6404				SUBTTL	PTYDDB - ALLOCATE, LINK IN, ATTACH, INITIALIZE A PTY DDB
  6405				;	   CALLED WITH U/ LDB ADDRESS, J/ ATTACHEE JOB #
  6406				;	   NONSKIP-RETURNS IF THERE ARE NO FREE DDBS
  6407				;	   SKIP-RETURNS WITH F/ DDB ADDR ON SUCCESS
  6408
  6409	010004'	550302	006763*	PTYDDB:	HRRZ	T1, TTYTAB(J)	;T1/ CMND PORT DDB
  6410	010005'	336000	000006		SKIPN	T1
  6411	010006'	256000	000000'		 STOPCD 		;(THERE MUST BE ONE)
  6412	010007'	260040	015720'		PUSHJ	P, DDBSR1	;F/ NEW DDB, LINKED AFTER CMND PORT
  6413	010010'	263040	000000		  POPJ	P,		;FAIL-RETURN
  6414
  6415	010011'	137100	007445*		DPB	J, PJOBN	;SET JOB # OF OWNER
  6416	010012'	260040	015764'		PUSHJ	P, SCNNAM	;SET PHYSICAL NAME
  6417	010013'	201300	400000		MOVEI	T1, ASSCON
  6418	010014'	436304	000004		IORM	T1, DEVMOD(F)	;MARK IT ASSIGNED-BY-CONSOLE
  6419	010015'	201300	020000		MOVEI	T1, TTYATC
  6420	010016'	412304	000004		ANDCAM	T1, DEVMOD(F)	;AND NOT THE COMMAND PORT
  6421
  6422	010017'	350001	000000		AOS	(P)		;SET TO SKIP-RETURN
  6423	010020'	324740	015666'		PJRST	COMATT		;AND ATTACH IT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 148
SCNSER.MAC	25-JAN-91 22:40		AUXCAL UUO

  6424				SUBTTL AUXCAL UUO
  6425
  6426				;AUXCAL UUO
  6427
  6428	010021'	256200	017557'	AUXTUU::XCTFU	<HLRE F,(W)>	;F/ PORT DESCRIPTOR
  6429	010022'	200100	000000*		MOVE	J,JOB		;J/ JOB #
  6430	010023'	260040	016312'		PUSHJ	P,FNDPRT	;F := DDB ADDR.
  6431	010024'	263040	000000		  POPJ	P,		;(NO PORT OR NOT THIS JOB'S PORT)
  6432	010025'	550244	000013		HRRZ	U,DDBLDB(F)	;U/ LDB ADDR
  6433	010026'	322240	007436*		JUMPE	U,CPOPJ		;IF DETACHED, JUST RETURN
  6434	010027'	256200	017560'		XCTFU	<HRRZ T1,(W)>	;T1/ FUNCTION CODE
  6435	010030'	301300	000104		CAIL	T1,AXCLEN	;IF IT'S OUT OF RANGE,
  6436	010031'	263040	000000		 POPJ	P,		;  JUST RETURN
  6437	010032'	350006	010207'		AOS	AXCCNT(T1)	;Count AUXCALs by function
  6438	010033'	200406	010056'		MOVE	T3,AXCTAB(T1)
  6439	010034'	200004	000002		MOVE	S,DEVIOS(F)	;S/ FILE STATUS BITS
  6440	010035'	260040	013554'		PUSHJ	P,UUOLDB	;SET UP LDB
  6441	010036'	607400	020000		TLNN	T3,TUUROM
  6442	010037'	254000	010042'		 JRST	AUXTU0
  6443	010040'	260040	013432'		PUSHJ	P,CHKROM
  6444	010041'	254000	010021'		JRST	AUXTUU
  6445	010042'	603400	040000	AUXTU0:	TLNE	T3,TUUAIR
  6446	010043'	607240	020000		TLNN	U,LDLCOM	;INPUT NOT ALLOWED IF AT COMMAND LEVEL
  6447	010044'	334000	000000		 SKIPA
  6448	010045'	263040	000000		  POPJ	P,
  6449	010046'	603400	010000		TLNE	T3,TUUEAT
  6450	010047'	260040	013264'		 PUSHJ	P,TYIEAT
  6451				IFE OPCRET,<	; KLUDGE TIL OPERATIONS CAN WRITE 10 CODE
  6452					TLNE	T3,TUUFXI
  6453					PUSHJ	P,FIXIMI	;SET IMAGE STATE FROM DATA MODE
  6454				>;OPCRET=1 IF PROGRAMS THINK TTCALLS IGNORE IMAGE
  6455
  6456	010050'	607400	002000		TLNN	T3,TUUIMI
  6457	010051'	254000	010055'		 JRST	AUXTU1
  6458	010052'	205300	002000		MOVSI	T1,LDLIMI
  6459	010053'	436305	000031		IORM	T1,LDBDCH(U)	;SET IMAGE STATE ALWAYS
  6460	010054'	260040	007603'		PUSHJ	P,SETLMD
  6461	010055'	254010	000000	AUXTU1:	JRST	(T3)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 149
SCNSER.MAC	25-JAN-91 22:40		AUXCAL dispatch table

  6462				SUBTTL	AUXCAL dispatch table
  6463
  6464	010056'	052000	010755'	AXCTAB:	TUUAIR!TUUEAT!TUUIMI,,ACINWC	;0 INPUT CHRS AND WAIT
  6465	010057'	052000	010765'		TUUAIR!TUUEAT!TUUIMI,,ACINSC	;1 INPUT CHRS AND SKIP
  6466	010060'	052000	010777'		TUUAIR!TUUEAT!TUUIMI,,ACINWB	;2 INPUT CHRS ELSE AWAIT BREAK
  6467	010061'	020000	007126'			      TUUROM,,IONEOU	;3 OUTPUT CHARACTER
  6468	010062'	020000	007125'			      TUUROM,,ACOTCI	;4 OUTPUT CHARACTER IMMEDIATE
  6469	010063'	020000	007171'			      TUUROM,,OUTPTR	;5 OUTPUT FROM POINTER
  6470	010064'	000000	006257'				      TSETBI	;6 CLEAR INPUT BUFFER
  6471	010065'	000000	006305'				      TSETBO	;7 CLEAR OUTPUT BUFFER
  6472	010066'	054000	007147'		TUUAIR!TUUEAT!TUUFXI,,SKPINC	;10 SKIP IF CHRS PRESENT
  6473	010067'	004000	007477'			      TUUFXI,,LEVDEF	;11 LEAVE DEFERRED ECHO MODE
  6474	010070'	000000	010723'				      ACSYL	;12 SEND YELLOW BALL
  6475	010071'	000000	010747'				      ACBRKC	;13 SET BREAK CHARACTER
  6476	010072'	000000	010711'			      TCNCRD,,ACTMC	;14 CR DELAY (NOT LF)
  6477	010073'	000001	010711'			       TCNIR,,ACTMC	;15 INPUT RATE
  6478	010074'	000002	010711'			       TCNOR,,ACTMC	;16 OUTPUT RATE
  6479	010075'	000003	010711'			      TCNPAR,,ACTMC	;17 PARITY
  6480	010076'	000004	010711'			      TCNHDX,,ACTMC	;20 HALF DUPLEX
  6481	010077'	000005	010711'			       TCNPA,,ACTMC	;21 PARAMETER A
  6482	010100'	000006	010711'			       TCNPB,,ACTMC	;22 PARAMTER B
  6483	010101'	000007	010711'			       TCNPC,,ACTMC	;23 PARAMETER C
  6484	010102'	000014	010711'			      TCNNXO,,ACTMC	;24 SET NO XON-XOFF
  6485	010103'	000000	010643'				      ACNTB	;25 SET NO SPECIAL TAB HANDLING
  6486	010104'	000000	010651'				      ACTBK	;26 SET TABS AS BREAKS
  6487	010105'	000015	010711'			      TCNWID,,ACTMC	;27 SET WIDTH
  6488	010106'	000016	010711'			      TCNFC1,,ACTMC	;30 SET FILLER CLASS 1
  6489	010107'	000017	010711'			      TCNFC2,,ACTMC	;31 SET FILLER CLASS 2
  6490	010110'	000000	000000*				      SETIO2	;32 SET FILE STATUS, DON'T FIXIMI
  6491	010111'	000000	011004'				      FRCINP	;33 FORCE INPUT
  6492	010112'	000000	012017'				      BLKIO	;34 ENABLE BLOCK INPUT/OUTPUT
  6493	010113'	050000	012107'		       TUUAIR!TUUEAT,,BLKINP	;35 INPUT A BLOCK
  6494	010114'	050000	012123'		       TUUAIR!TUUEAT,,BLKINS	;36 INPUT BLOCK &SKIP IF DATA
  6495	010115'	000000	012242'				      BLKOUT	;37 OUTPUT A BLOCK
  6496	010116'	000000	013071'				      BLKXIN	;40 REQUEST BLOCK INPUT TERMINATION
  6497	010117'	000000	013117'				      BLKXOT	;41 REQUEST BLOCK OUTPUT TERMINATION.
  6498	010120'	000000	012044'				      BLKXIO	;42 TERMINATE BLOCK I/O MODE
  6499	010121'	000000	011147'				      MAKDET	;43 TURN COMMAND PORT TO "AUX"PORT
  6500	010122'	014000	007411'		       TUUEAT!TUUFXI,,I1CHRW	;44 INPUT CHRS AND WAIT
  6501	010123'	054000	007345'		TUUAIR!TUUEAT!TUUFXI,,INCHRS	;45 INPUT CHRS AND SKIP
  6502	010124'	014000	007366'		       TUUEAT!TUUFXI,,I1CHWL	;46 INPUT CHRS AND WAIT LINE
  6503	010125'	054000	007356'		TUUAIR!TUUEAT!TUUFXI,,INCHSL	;47 INPUT CHRS AND SKIP LINE
  6504	010126'	054000	007157'		TUUAIR!TUUEAT!TUUFXI,,SKPINL	;50 SKIP IF LINE PRESENT
  6505	010127'	020000	007106'			      TUUROM,,OUTCHI	;51 OUTPUT CHR IMMEDIATE (NOT IMAGE
  6506	010130'	020000	007134'			      TUUROM,,OUTSTR	;52 OUTPUT STRING
  6507	010131'	000010	010711'			      TCNXON,,ACTMC	;53 SET XON-XOFF PARAMETER
  6508	010132'	000011	010711'			      TCNECH,,ACTMC	;54 SET ECHO CONTROL H PARAMETER
  6509	010133'	000012	010711'			      TCNRXE,,ACTMC	;55 SET REVERSE XON-XOFF PARAMTER
  6510	010134'	000013	010711'			       TCNPD,,ACTMC	;56 SET PARM D (was TCNTYP/TCNKAT)
  6511	010135'	000020	010711'			      TCNBSP,,ACTMC	;57 SEND BACKSPACE FOR RUBOUT SEQ
  6512	010136'	000000	010737'				      ACHNG	;60 SEND HANGUP
  6513	010137'	000000	010742'				      ACPSM	;61 READ PORT STATUS MESSAGE
  6514	010140'	000021	010711'			      TCNERA,,ACTMC	;62 ERASE FOR CHAR DELETE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 149-2
SCNSER.MAC	25-JAN-91 22:40		AUXCAL dispatch table

  6515	010141'	000022	010711'			      TCNDEF,,ACTMC	;63 DEFERRED-ECHO MODE
  6516	010142'	000000	010717'				      ACSFS	;64 SET FILE STATUS, THEN FIXIMI
  6517	010143'	000023	010711'			      TCNLCO,,ACTMC	;65 SET/CLEAR LOWER CASE ONLY OUTPUT FLAG
  6518	010144'	000000	010661'				      ACBBP	;66 SET BACKSPACE AS BREAK2
  6519	010145'	020000	007212'			      TUUROM,,OUTPTC	;67 OUTPUT FROM POINTER+COUNT
  6520	010146'	000000	010726'				      ACSOB	;70 SEND ORANGE BALL
  6521	010147'	000000	010671'				      ACSOX	;71 SET/CLEAR SUPPRESS-OUTPUT-TRANSLATION
  6522	010150'	000000	011036'				      FRCRSC	;72 FORCE A RESCAN LINE (COUNT/POINTER
  6523	010151'	000000	010322'				      ACTCN	;73 SET TERMINAL CHARACTERISTIC BY NUMBER
  6524	010152'	000000	010331'				      ACTCP	;74 READ CHANGED TC #,,VAL FOR A PTY
  6525	010153'	000000	010704'				      ACNZP	;75 NO-ZAP-ON-RESET BIT
  6526	010154'	000000	007240'				      OUTSNW	;76 OUTPUT STRING, NEVER WAIT
  6527	010155'	000031	010711'			      TCNBSD,,ACTMC	;77 BACKSPACE == RUBOUT/^A
  6528	010156'	000032	010711'			      TCNCLA,,ACTMC	;100 Set/Read Terminal Class
  6529	010157'	000033	010711'			      TCNRTC,,ACTMC	;101 Set/Read LXLRTC (Special ^T Mode)
  6530	010160'	000034	010711'			      TCNKAT,,ACTMC	;102 Set/Read Katakana bit
  6531	010161'	000035	010711'			      TCNTYP,,ACTMC	;103 Set/Read Terminal Type
  6532			000104	AXCLEN==.-AXCTAB
  6533
  6534			000005	  TTNEGL==TTUUOT-TTUNEG		;Number of negative TTCALLS
  6535	010162'			TTCNEG:	BLOCK	TTNEGL+20	;Negative TTCALLs and positive TTCALLs
  6536			010167'	TTCCNT=:TTCNEG+TTNEGL		;Define address for TTCALL 0 count
  6537	010207'			AXCCNT::BLOCK	AXCLEN		;Count of AUXCALs by function
  6538	010313'	777775	000000		SYDVF	(<<TTCNEG,TTNEGL>,<TTCCNT,20>,<AXCCNT,AXCLEN>>)
  6539	010314'	646443	564547
  6540	010315'	000005	010162'
  6541	010316'	646443	435664
  6542	010317'	000020	010167'
  6543	010320'	417043	435664
  6544	010321'	000104	010207'
  6545					;3 items for SYSDVF
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 150
SCNSER.MAC	25-JAN-91 22:40		READ/SET TERMINAL CHARACTERISTICS BY NUMBER

  6546				SUBTTL	READ/SET TERMINAL CHARACTERISTICS BY NUMBER
  6547
  6548	010322'	256200	017561'	ACTCN:	XCTFU	<HLRZ T1,(M)>	;T1/ CHAR #
  6549	010323'	256200	017562'		XCTFU	<HRRE T2,(M)>	;T2/ NEW VALUE OR -1 TO READ
  6550	010324'	260040	010356'		PUSHJ	P,SETTCN	;TRY TO DO IT
  6551	010325'	263040	000000		  POPJ	P,		;(BAD TC# OR BAD NEW VALUE)
  6552	010326'	256200	017563'		XCTBU	<HRRM T3,(M)>	;GIVE USER THE OLD VALUE
  6553	010327'	350001	000000		AOS	(P)
  6554	010330'	263040	000000		POPJ	P,
  6555
  6556				;READ CHANGED TERMINAL CHARACTERISTIC FROM PTY
  6557
  6558	010331'	500245	000031	ACTCP:	HLL	U,LDBDCH(U)
  6559	010332'	607240	040000		TLNN	U,LDLPTY	;IF IT'S NOT A PTY,
  6560	010333'	263040	000000		 POPJ	P,		;  ERROR-RETURN
  6561	010334'	261040	000005		PUSH	P,U
  6562	010335'	260040	007744'		PUSHJ	P,PTYBUD
  6563	010336'	200305	000004		MOVE	T1,LDBTCB(U)	;T1/ CHANGED-TC BITS
  6564	010337'	243300	010342'		JFFO	T1,ACTCP1	;IF NONE,
  6565	010340'	256200	017564'		XCTTU	<SETOM (M)>	;  GIVE CALLER A -1 WORD
  6566	010341'	254000	010354'		JRST	ACTCP2
  6567	010342'	210300	000007	ACTCP1:	MOVN	T1,T2
  6568	010343'	205440	400000		MOVSI	T4,(1B0)
  6569	010344'	242446	000000		LSH	T4,(T1)
  6570	010345'	412445	000004		ANDCAM	T4,LDBTCB(U)	;CLEAR THE "UNREAD" BIT
  6571	010346'	200300	000007		MOVE	T1,T2		;T1/ TC#
  6572	010347'	256200	017565'		XCTBU	<HRLM T1,(M)>	;GIVE CALLER THE TC#
  6573	010350'	474340	000000		SETO	T2,		;-1 = READ TC
  6574	010351'	260040	010356'		PUSHJ	P,SETTCN
  6575	010352'	256000	000000'		 STOPCD
  6576	010353'	256200	017563'		XCTBU	<HRRM T3,(M)>	;GIVE CALLER THE TC VALUE
  6577	010354'	262040	000005	ACTCP2:	POP	P,U
  6578	010355'	254000	007743*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 151
SCNSER.MAC	25-JAN-91 22:40		SETTCN - READ/SET TERMINAL CHARACTERISTICS BY NUMBER

  6579				SUBTTL	SETTCN - READ/SET TERMINAL CHARACTERISTICS BY NUMBER
  6580				;	   CALLED WITH T1/ CHARACTERISTIC # (TCNxxx)
  6581				;		       T2/ NEW VALUE (-1 TO JUST READ)
  6582				;		       U/ LDB ADDR
  6583				;	   NONSKIP-RETURNS IF TC# OR NEW VALUE IS OUT OF BOUNDS
  6584				;	   SKIP-RETURNS WITH T3/ OLD VALUE OTHERWISE
  6585				;
  6586				;SETTC1 - ASSUMES TC# IS IN BOUNDS
  6587
  6588	010356'	305300	000036	SETTCN:	CAIGE	T1,TCNN		;IF TCNxxx OUT OF BOUNDS
  6589	010357'	313346	010456'	SETTC1:	CAMLE	T2,TCVMAX(T1)	;OR NEW VALUE TOO BIG,
  6590	010360'	263040	000000		 POPJ	P,		;  ERROR-RETURN
  6591	010361'	550406	010420'		HRRZ	T3,TCNDSP(T1)	;TYPE, one of TYMTC, BYTTC, or ACxxxC
  6592	010362'	261040	000006		PUSH	P,T1
  6593	010363'	506341	000000		HRLM	T2,(P)		;(P)/ (NEW VALUE OR -1),,TC#
  6594	010364'	260050	000000		PUSHJ	P,(T3)		;DISPATCH
  6595	010365'	254000	006045*		  JRST	TPOPJ		;  ERROR-RETURN
  6596	010366'	205300	040000		MOVSI	T1,LDLPTY
  6597	010367'	331001	000000		SKIPL	(P)		;IF WE WERE JUST READING
  6598	010370'	616305	000031		TDNN	T1,LDBDCH(U)	;OR IT'S NOT A PTY,
  6599	010371'	254000	006716*		 JRST	TPOPJ1		;  JUST SKIP-RETURN
  6600	010372'	550301	000000		HRRZ	T1,(P)
  6601	010373'	210300	000006		MOVN	T1,T1		;T1/ - TC#
  6602	010374'	205340	400000		MOVSI	T2,(1B0)
  6603	010375'	242346	000000		LSH	T2,(T1)		;T2/ LDBTCB BIT FOR THE TC
  6604	010376'	436345	000004		IORM	T2,LDBTCB(U)	;SET IT
  6605	010377'	202401	000000		MOVEM	T3,(P)
  6606	010400'	261040	000005		PUSH	P,U
  6607	010401'	261040	000004		PUSH	P,F
  6608	010402'	261040	000002		PUSH	P,J
  6609	010403'	260040	007744'		PUSHJ	P,PTYBUD	;U/ BUDDY LDB ADDR
  6610	010404'	201300	000200		MOVEI	T1,LXRTCC
  6611	010405'	436305	000032		IORM	T1,LDBDCX(U)	;NOTE THAT A TC WAS CHANGED
  6612	010406'	550205	000000		HRRZ	F,LDBDDB(U)
  6613	010407'	322200	010413'		JUMPE	F,SETTC2	;IF THE OTHER END IS ATTACHED
  6614	010410'	135300	000240'		LDB	T1,DDPTTC
  6615	010411'	322300	010413'		JUMPE	T1,SETTC2	;AND TRAPPING TC CHANGES
  6616	010412'	260040	006140*		PUSHJ	P,TAKTRJ	;  SIGNAL THE CHANGE
  6617	010413'	262040	000002	SETTC2:	POP	P,J
  6618	010414'	262040	000004		POP	P,F
  6619	010415'	262040	000005		POP	P,U
  6620	010416'	262040	000010		POP	P,T3
  6621	010417'	254000	010355*		JRST	CPOPJ1
  6622
  6623				;If TYPE=BYTTC, then ARG = name of byte pointer (LDPxxx)
  6624				;If TYPE=TYMTC, then ARG = name of host-to-base # (TMCxxx)
  6625
  6626				DEFINE Z(NAME,MAXVAL,TYPE,ARG) = <ARG,,TYPE>
  6627	010420'	000004	010521'	TCNDSP:	TCHARS
  6628	010421'	000005	010521'
  6629	010422'	000006	010521'
  6630	010423'	000007	010521'
  6631	010424'	000010	010521'
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 151-2
SCNSER.MAC	25-JAN-91 22:40		SETTCN - READ/SET TERMINAL CHARACTERISTICS BY NUMBER

  6632	010425'	000011	010521'
  6633	010426'	000012	010521'
  6634	010427'	000013	010521'
  6635	010430'	000014	010521'
  6636	010431'	000015	010521'
  6637	010432'	000016	010521'
  6638	010433'	000017	010521'
  6639	010434'	000215'	010514'
  6640	010435'	000000	010555'
  6641	010436'	000172'	010514'
  6642	010437'	000166'	010514'
  6643	010440'	000000	010564'
  6644	010441'	000000	010574'
  6645	010442'	000000	010601'
  6646	010443'	000221'	010514'
  6647	010444'	000212'	010514'
  6648	010445'	000214'	010514'
  6649	010446'	000211'	010514'
  6650	010447'	000210'	010514'
  6651	010450'	000000	010617'
  6652	010451'	000217'	010514'
  6653	010452'	000000	010637'
  6654	010453'	000222'	010514'
  6655	010454'	000020	010521'
  6656	010455'	000000	010631'
  6657
  6658				DEFINE Z(NAME,MAXVAL,TYPE,ARG) = <MAXVAL>
  6659	010456'	000000	000001	TCVMAX:	TCHARS
  6660	010457'	000000	000017
  6661	010460'	000000	000017
  6662	010461'	000000	000001
  6663	010462'	000000	000001
  6664	010463'	000000	000007
  6665	010464'	000000	000007
  6666	010465'	000000	000017
  6667	010466'	000000	000001
  6668	010467'	000000	000001
  6669	010470'	000000	000001
  6670	010471'	000000	000017
  6671	010472'	000000	000001
  6672	010473'	000000	000377
  6673	010474'	000000	000003
  6674	010475'	000000	000003
  6675	010476'	000000	000001
  6676	010477'	000000	000001
  6677	010500'	000000	000001
  6678	010501'	000000	000001
  6679	010502'	000000	000001
  6680	010503'	000000	000001
  6681	010504'	000000	000001
  6682	010505'	000000	000001
  6683	010506'	000000	000001
  6684	010507'	000000	000001
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 151-3
SCNSER.MAC	25-JAN-91 22:40		SETTCN - READ/SET TERMINAL CHARACTERISTICS BY NUMBER

  6685	010510'	377777	777777
  6686	010511'	000000	000001
  6687	010512'	000000	000001
  6688	010513'	377777	777777
  6689
  6690				;BYTTC - update byte in LDB, for things the TYMSAT does not do for us
  6691
  6692	010514'	554306	010420'	BYTTC:	HLRZ	T1,TCNDSP(T1)	;T1/ BYTE POINTER ADDR
  6693	010515'	135406	000000		LDB	T3,(T1)		;Get old value from LDB
  6694	010516'	331000	000007		SKIPL	T2		;If not -1, then
  6695	010517'	137346	000000		 DPB	T2,(T1)		; set new value in the LDB
  6696	010520'	254000	010417*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 152
SCNSER.MAC	25-JAN-91 22:40		SETTCN ROUTINES

  6697				SUBTTL	SETTCN ROUTINES
  6698
  6699				;TYMTC - READ/SET TYMNET TERMINAL CHARACTERISTICS
  6700				;	 CALLED WITH T1/ CHARACTERISTIC # (TCNxxx)
  6701				;		      T2/ -1 (TO JUST READ) OR NEW VALUE
  6702				;	  SKIP-RETURNS WITH T3/ THE OLD VALUE
  6703				;TYMTC1 - CALLED WITH T1/ TYMNET'S TC# (TMCxxx)
  6704
  6705	010521'	554306	010420'	TYMTC:	HLRZ	T1,TCNDSP(T1)	;USER TC# = TYMNET TC#
  6706	010522'	303300	000024	TYMTC1:	CAILE	T1,MAXTMC	;IF OUT-OF-RANGE,
  6707	010523'	256000	000000'		 STOPCD 		;  CRASH
  6708	010524'	135406	000004'		LDB	T3,TABTMR(T1)	;T3/ old received value
  6709	010525'	321340	010520*		JUMPL	T2,CPOPJ1	;IF JUST LOOKING, SUCCESS-RETURN
  6710	010526'	137346	000031'		DPB	T2,TABTMS(T1)	;Store new value to be sent to the TYMSAT
  6711				;Japanese customers use the command "TTY TYPE 1" and expect it to do both
  6712				;"SET TTY D 15" and "SET TTY KATAKANA".  MAGNUM expects Katakana terminals
  6713				;to have parameter D set to octal 17, ASCII terminals have D set to 0.
  6714				;NOTE: The old BASEs translated TYMNET terminal characteristic #15 (PARM-D)
  6715				;from to host to TYMNET terminal characteristic #16 (KATAKANA) before
  6716				;passing the command to the TYMSAT.  As an interim measure, set both when
  6717				;either is changed.
  6718	010527'	302300	000017		CAIE	T1,TMCPD	;"SET TTY D 1"?
  6719	010530'	306300	000020		CAIN	T1,TMCKAT	; or "SET TTY KATAKANA"?
  6720	010531'	334000	000000		 SKIPA			;Yes, set both
  6721	010532'	254000	010544'		  JRST	TYMTC2		;No
  6722				PRINTF	(<[EBUS02.J01 translates PARM-D(15.) to KATAKANA(16.) for ISIS]>)
  6723	010533'	137340	000051'		DPB	T2,TABTMS+TMCKAT;Set KATAKANA bit if parm D is odd
  6724	010534'	137340	000024'		DPB	T2,TABTMR+TMCKAT;EBUS02.J01 does not return KATAKANA bit to us
  6725	010535'	137340	000050'		DPB	T2,TABTMS+TMCPD	;Set parm D if KATAKANA bit is set
  6726	010536'	606340	000001		TRNN	T2,1		;Simulate TYMNET-I's one-bit field
  6727	010537'	634340	000007		TDZA	T2,T2		; Even = 0
  6728	010540'	201340	000017		 MOVEI	T2,17		; Odd = 17
  6729	010541'	137340	000023'		DPB	T2,TABTMR+TMCPD	;Store this value to be overwritten if the node
  6730								; does understand "parameter D"
  6731	010542'	200340	017566'		MOVE	T2,[1B<TMCPD>!1B<TMCKAT>]
  6732	010543'	436345	000050		IORM	T2,LDBTMT(U)	;Mark them both as being changed
  6733
  6734	010544'	213000	000006	TYMTC2:	MOVNS	T1		;Negative of TYMNET's TC
  6735	010545'	205340	400000		MOVSI	T2,(1B0)
  6736	010546'	242346	000000		LSH	T2,(T1)		;Position to bit (B0 thru B20)
  6737	010547'	436345	000050		IORM	T2,LDBTMT(U)	;SET TRANSMIT BIT
  6738	010550'	201300	000001		MOVEI	T1,1
  6739	010551'	137300	000071'		DPB	T1,LOPSTC	;SET SEND-CHARACTERISTICS
  6740	010552'	350001	000000		AOS	(P)		;skip return
  6741	010553'	137305	000002	SETOPB:	DPB	T1,LDBOPB(U)	;SET NEED-OUTPUT
  6742	010554'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 153
SCNSER.MAC	25-JAN-91 22:40		SETTCN ROUTINES

  6743				SUBTTL	SETTCN ROUTINES
  6744
  6745				;WIDTH
  6746
  6747	010555'	135400	000170'	ACWIDC:	LDB	T3,LDPWID
  6748	010556'	321340	010525*		JUMPL	T2,CPOPJ1
  6749	010557'	301340	000024		CAIL	T2,^D20		;IF IT'S TOO SMALL
  6750	010560'	303340	000307		CAILE	T2,^D199	;OR TOO LARGE,
  6751	010561'	263040	000000		 POPJ	P,		;  ERROR-RETURN
  6752	010562'	137340	000170'		DPB	T2,LDPWID	;ELSE SET IT
  6753	010563'	254000	010556*		JRST	CPOPJ1
  6754
  6755				;BACKSPACE FOR DELETE
  6756
  6757	010564'	135400	000220'	ACBSPC:	LDB	T3,LDPERA
  6758	010565'	626400	000001		TRZN	T3,1		;IF ERASE IS SET, SAY BS ISN'T
  6759	010566'	135400	000164'		 LDB	T3,LDPBSP
  6760	010567'	321340	010563*		JUMPL	T2,CPOPJ1
  6761	010570'	137340	000164'		DPB	T2,LDPBSP
  6762	010571'	400340	000000		SETZ	T2,
  6763	010572'	137340	000220'		DPB	T2,LDPERA	;ALWAYS CLEAR ERASE
  6764	010573'	254000	010567*		JRST	CPOPJ1
  6765
  6766				;ERASE FOR DELETE
  6767
  6768	010574'	135400	000220'	ACERAC:	LDB	T3,LDPERA
  6769	010575'	321340	010573*		JUMPL	T2,CPOPJ1
  6770	010576'	137340	000220'		DPB	T2,LDPERA
  6771	010577'	137340	000164'		DPB	T2,LDPBSP	;EITHER SET BOTH OR CLEAR BOTH
  6772	010600'	254000	010575*		JRST	CPOPJ1
  6773
  6774				;DEFERRED ECHO
  6775
  6776	010601'	135400	000216'	ACDEFC:	LDB	T3,LDPDEM
  6777	010602'	321340	010600*		JUMPL	T2,CPOPJ1
  6778	010603'	200305	000031		MOVE	T1,LDBDCH(U)
  6779	010604'	602340	000001		TRNE	T2,1
  6780	010605'	664300	040000		 TROA	T1,LDRDEM
  6781	010606'	620300	040000		  TRZ	T1,LDRDEM
  6782	010607'	250305	000031		EXCH	T1,LDBDCH(U)
  6783	010610'	312305	000031		CAME	T1,LDBDCH(U)	;IF THE BIT CHANGED
  6784	010611'	603300	000100		TLNE	T1,LDLNEC	;AND NO ECHO NOT SET,
  6785	010612'	254000	010602*		 JRST	CPOPJ1
  6786	010613'	201300	000001		MOVEI	T1,1
  6787	010614'	137300	000067'		DPB	T1,LOPSEC	;  SET SEND-ECHO
  6788	010615'	137305	000002		DPB	T1,LDBOPB(U)	;  AND NEED-OUTPUT
  6789	010616'	254000	010612*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 154
SCNSER.MAC	25-JAN-91 22:40		SETTCN ROUTINES

  6790				SUBTTL	SETTCN ROUTINES
  6791
  6792				;PAPER TAPE MODE
  6793
  6794	010617'	135400	000213'	ACPTPC:	LDB	T3,LDPPTP
  6795	010620'	321340	010616*		JUMPL	T2,CPOPJ1
  6796	010621'	137340	000213'		DPB	T2,LDPPTP	;SET PAPER-TAPE BIT TO USER VALUE
  6797	010622'	261040	000010		PUSH	P,T3
  6798	010623'	640340	000001		TRC	T2,1
  6799	010624'	201300	000003		MOVEI	T1,TMCECR
  6800	010625'	260040	010522'		PUSHJ	P,TYMTC1	;AND CR-AS-CRLF TO ITS COMPLEMENT
  6801	010626'	256000	000000'		 STOPCD
  6802	010627'	262040	000010		POP	P,T3
  6803	010630'	254000	010620*		JRST	CPOPJ1
  6804
  6805				;[JMS] Terminal Type - Must be a valid type
  6806
  6807	010631'	135400	000224'	ACTTYP:	LDB	T3,LDPTYP	;T3 := old value
  6808	010632'	316340	017567'		CAMN	T2,[-1]		;Setting or reading?
  6809	010633'	254000	010630*		 JRST	CPOPJ1		;Just reading
  6810	010634'	137340	000223'		DPB	T2,LDPCLA	;Set TTY CLASS to this value
  6811				;Need to verify that this type is valid (such as VT100, HP2621, TYM444, etc)
  6812	010635'	137340	000224'		DPB	T2,LDPTYP	;Valid type, set it
  6813				PRINTF (<[Need to set WIDTH, ERASE, etc at ACTTYP]>)
  6814	010636'	254000	010633*		JRST	CPOPJ1
  6815
  6816				;[dws] Terminal Class - can be any SIXBIT value
  6817
  6818	010637'	135400	000223'	ACTCLA:	LDB	T3,LDPCLA	; T3 := old value
  6819	010640'	312340	017567'		CAME	T2,[-1]		; Don't store if only reading
  6820	010641'	137340	000223'		 DPB	T2,LDPCLA	;  new valued := T2
  6821	010642'	254000	010636*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 155
SCNSER.MAC	25-JAN-91 22:40		NO SPECIAL TAB HANDLING

  6822				SUBTTL	NO SPECIAL TAB HANDLING
  6823
  6824	010643'	135340	000163'	ACNTB:	LDB	T2, LDPNTB
  6825	010644'	256200	017570'		XCTBU	<EXCH T2,(M)>
  6826	010645'	321340	010026*		JUMPL	T2, CPOPJ
  6827	010646'	137340	000243'		DPB	T2, DDPNTB
  6828	010647'	137340	000163'		DPB	T2, LDPNTB
  6829	010650'	263040	000000		POPJ	P,
  6830
  6831				;TABS AS BREAKS
  6832
  6833	010651'	135340	000161'	ACTBK:	LDB	T2, LDPTBK
  6834	010652'	256200	017570'		XCTBU	<EXCH T2,(M)>
  6835	010653'	321340	010645*		JUMPL	T2, CPOPJ
  6836	010654'	137340	000242'		DPB	T2, DDPTBK
  6837	010655'	201300	100000		MOVEI	T1, L2LTBK
  6838	010656'	602340	000001		TRNE	T2, 1		;CHECK LOW ORDER BIT
  6839	010657'	505300	100000		HRLI	T1, L2LTBK
  6840	010660'	324740	007607'		PJRST	SETTBK		;GO SET IT
  6841
  6842				;BACKSPACE AS PUNCTUATION
  6843
  6844	010661'	135340	000162'	ACBBP:	LDB	T2, LDPBBP
  6845	010662'	256200	017570'		XCTBU	<EXCH T2,(M)>
  6846	010663'	321340	010653*		JUMPL	T2, CPOPJ
  6847	010664'	137340	000241'		DPB	T2, DDPBBP
  6848	010665'	201300	040000		MOVEI	T1, L2LBBP
  6849	010666'	602340	000001		TRNE	T2, 1		;CHECK LOW ORDER BIT
  6850	010667'	505300	040000		HRLI	T1, L2LBBP
  6851	010670'	324740	007607'		PJRST	SETTBK		;GO SET IT
  6852
  6853				;SUPPRESS-OUTPUT-TRANSLATION (FOR PTYS ONLY)
  6854
  6855	010671'	500245	000031	ACSOX:	HLL	U, LDBDCH(U)
  6856	010672'	607240	040000		TLNN	U, LDLPTY	;IF IT'S NOT A PTY,
  6857	010673'	263040	000000		POPJ	P,		;  JUST RETURN
  6858	010674'	261040	000005		PUSH	P, U
  6859	010675'	260040	007744'		PUSHJ	P, PTYBUD	;U/ "BUDDY" LDB ADDR
  6860	010676'	135300	000205'		LDB	T1, LDPSOX	;T1/ CURRENT SOX VALUE
  6861	010677'	256200	017571'		XCTBU	<EXCH T1,(M)>	;SWAP WITH ARGUMENT
  6862	010700'	321300	010702'		JUMPL	T1, .+2		;IF USER SUPPLIED A NEW VALUE,
  6863	010701'	137300	000205'		DPB	T1, LDPSOX	;  SET IT
  6864	010702'	262040	000005		POP	P, U
  6865	010703'	263040	000000		POPJ	P,
  6866
  6867				;READ/SET DVNZP BIT
  6868
  6869	010704'	135300	000247'	ACNZP:	LDB	T1, DDPNZP	;T1/ CURRENT VALUE
  6870	010705'	256200	017571'		XCTBU	<EXCH T1, (M)>	;SWAP WITH USER'S
  6871	010706'	321300	010663*		JUMPL	T1, CPOPJ	;(JUST READING)
  6872	010707'	137300	000247'		DPB	T1, DDPNZP	;SET IT
  6873	010710'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 156
SCNSER.MAC	25-JAN-91 22:40		OLD AUXCAL TERMINAL-CHARACTERISTICS DISPATCH

  6874				SUBTTL	OLD AUXCAL TERMINAL-CHARACTERISTICS DISPATCH
  6875
  6876	010711'	554300	000010	ACTMC:	HLRZ	T1,T3		;T1/ CHARACTERISTIC #  (TCNxxx)
  6877	010712'	256200	017572'		XCTFU	<MOVE T2,(M)>	;T2/ USER'S ARGUMENT
  6878	010713'	260040	010357'		PUSHJ	P,SETTC1	;T3 := OLD VALUE
  6879	010714'	255000	000000		  JFCL			;(NEW VALUE WAS BAD)
  6880	010715'	256200	017540'		XCTTU	<MOVEM T3,(M)>	;STORE IT
  6881	010716'	263040	000000		POPJ	P,
  6882
  6883				;SET FILE STATUS BITS, THEN FIX IMAGE STATE
  6884
  6885	010717'	260040	010110*	ACSFS:	PUSHJ	P,SETIO2
  6886	010720'	540244	000013		HRR	U,DDBLDB(F)
  6887	010721'	200004	000002		MOVE	S,DEVIOS(F)
  6888	010722'	324740	007556'		PJRST	FIXIMI
  6889
  6890				;SEND YELLOW BALL
  6891
  6892	010723'	201300	000001	ACSYL:	MOVEI T1,1
  6893	010724'	137300	000077'		DPB T1,LOPSYL		;SET SEND-YELLOW
  6894	010725'	324740	010553'		PJRST SETOPB
  6895
  6896				;SEND ORANGE BALL
  6897
  6898	010726'	200305	000032	ACSOB:	MOVE	T1, LDBDCX(U)
  6899	010727'	627300	004000		TLZN	T1, LXLOOK	;IF IT'S OK TO SEND 1,
  6900	010730'	263040	000000		  POPJ	P,
  6901	010731'	202305	000032		MOVEM	T1, LDBDCX(U)	;  (NOT 2, JUST 1)
  6902	010732'	205300	010000		MOVSI	T1, L2LLDF
  6903	010733'	436305	000027		IORM	T1, LDBBYT(U)	;  FAKE INPUT WAIT SO BALL'LL GO
  6904	010734'	201300	000001		MOVEI	T1, 1
  6905	010735'	137300	000104'		DPB	T1, LOPSOG	;  SET SEND-ORANGE
  6906	010736'	324740	010553'		PJRST	SETOPB
  6907
  6908				;SEND HANGUP (SOFT ZAPPER)
  6909
  6910	010737'	201300	000001	ACHNG:	MOVEI	T1, 1
  6911	010740'	137300	000100'		DPB	T1, LOPHNG	;SET SEND-HANG
  6912	010741'	324740	010553'		PJRST	SETOPB
  6913
  6914				;Read last PORT STATUS message (AUXCAL function .AXPSM=61)
  6915				;From the YAMM dated July 1980: "The port status returned is 4 bits for
  6916				;which there is no documentation.  This operation was implemented for the
  6917				;initial TYMNET-I Dial-Out facility."  The current code in the base,
  6918				;EBUS02.J01, does not have any code for passing this message to the PDP-10.
  6919
  6920	010742'	135300	000176'	ACPSM:	LDB	T1, LDPPSM	; GET LAST PORT STATUS MSG
  6921	010743'	705313	000000		UMOVEM	T1, (M)		; GIVE IT TO HIM
  6922	010744'	205300	200000		MOVSI	T1, LMLPSP
  6923	010745'	412305	000030		ANDCAM	T1, LDBMOD(U)	; AND NOTE IT'S BEEN READ
  6924	010746'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 157
SCNSER.MAC	25-JAN-91 22:40		SET IMAGE BREAK CHARACTER

  6925				SUBTTL	SET IMAGE BREAK CHARACTER
  6926
  6927	010747'	704313	000000	ACBRKC:	UMOVE	T1, (M)
  6928	010750'	606300	000400		TRNN	T1, 400		;IF IMAGE BIT NOT ON,
  6929	010751'	400300	000000		SETZ	T1,		;  CLEAR THE CHARACTER
  6930	010752'	137300	000203'		DPB	T1, LDPIMB
  6931	010753'	137300	000244'		DPB	T1, DDPIMB
  6932	010754'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 158
SCNSER.MAC	25-JAN-91 22:40		IMAGE-STATE INPUT AUXCALS

  6933				SUBTTL	IMAGE-STATE INPUT AUXCALS
  6934
  6935	010755'	260040	007461*	ACINWC:	NOCHARGE
  6936	010756'	260040	013664'	ACIN1:	PUSHJ P,TWAITC	;THIS WILL SET MODE TO IMAGE
  6937	010757'	260040	013135'		PUSHJ P,TYI
  6938	010760'	254000	010756'		 JRST ACIN1	;TRY AGAIN
  6939	010761'	405400	000377	ACIN2:	ANDI T3,377
  6940	010762'	705413	000000		UMOVEM T3,(M)
  6941	010763'	350001	000000		AOS (P)		;SKIP RETURN (AS OPPOSED TO NO PORT)
  6942	010764'	254000	007152'		JRST NOCTRO
  6943
  6944	010765'	260040	010755*	ACINSC:	NOCHARGE
  6945	010766'	337005	000014		SKIPG LDBECC(U)	;ANY CHRS?
  6946	010767'	333005	000012		SKIPLE LDBTIC(U)
  6947	010770'	334000	000000		SKIPA		;YES
  6948	010771'	254000	007603'		JRST SETLMD	;NO, SET TO IMAGE ANYWAY
  6949	010772'	260040	013662'		PUSHJ P,TWAITS
  6950	010773'	263040	000000		  POPJ	P,	;DETACHED
  6951	010774'	260040	013135'		PUSHJ P,TYI
  6952	010775'	254000	007152'		 JRST NOCTRO	;NONE THERE
  6953	010776'	254000	010761'		JRST ACIN2	;GIVE IT TO HIM
  6954
  6955	010777'	260040	010765*	ACINWB:	NOCHARGE
  6956	011000'	260040	013621'		PUSHJ P,TWAITL	;WAIT FOR IMAGE-MODE BREAK CHARACTER OR TIMEOUT
  6957	011001'	260040	013135'		PUSHJ P,TYI
  6958	011002'	263040	000000		 POPJ P,	;PROBABLY END OF FILE SET
  6959	011003'	254000	010761'		JRST ACIN2	;GIVE HIM CHR
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 159
SCNSER.MAC	25-JAN-91 22:40		AUXCAL -- .AXSI=33 - Simulate input

  6960				SUBTTL	AUXCAL -- .AXSI=33 - Simulate input
  6961
  6962	011004'	704553	000000	FRCINP:	UMOVE	M,(M)		;GET BYTE POINTER
  6963	011005'	621540	000037		TLZ	M,37		;GET RID OF INDEX AND INDIRECT
  6964	011006'	200300	000013		MOVE	T1,M		;Check the string before forcing input
  6965	011007'	201340	000000		MOVEI	T2,0
  6966	011010'	256040	017573'	FRCLP0:	XCTFU <ILDB T3,T1>	;Get char
  6967	011011'	405400	000377		ANDI	T3,377		;Watch out for strange byte sizes
  6968	011012'	332000	000010		SKIPE	T3
  6969	011013'	344340	011010'		 AOJA	T2,FRCLP0	;Loop until null
  6970	011014'	270345	000012		ADD	T2,LDBTIC(U)	;Add to count of chars already input
  6971	011015'	270345	000014		ADD	T2,LDBECC(U)	; and chars not yet echoed
  6972	011016'	311340	017120'		CAML	T2,TIHLTN	;If it would exceed the limit
  6973	011017'	263040	000000		 POPJ	P,		; then do nothing and give error return
  6974
  6975	011020'	256040	017522'	FRCLP1:	XCTFU <ILDB T3,M>
  6976	011021'	405400	000377		ANDI	T3,377		; USE ONLY THE RIGHT 8 BITS
  6977	011022'	322400	010642*		JUMPE	T3,CPOPJ1	;FINISHED
  6978	011023'	260040	001606'		PUSHJ	P,MOVCHR	;PUT CHR IN INPUT BUFFER
  6979	011024'	254000	011020'		  JRST	FRCLP1		;NO ECHO REQUIRED
  6980	011025'	201300	000001		MOVEI	T1,1		;LAST CHAR SWITCHED TO DEFERED ECHO
  6981	011026'	137300	000102'		DPB	T1,LOPECO	;SET NEED-ECHO
  6982	011027'	137305	000002		DPB	T1,LDBOPB(U)	;AND NEED-OUTPUT
  6983	011030'	256040	017522'	FRCLP2:	XCTFU <ILDB T3,M>	;LOOP HERE FOR DEFERED ECHO MODE
  6984	011031'	405400	000377		ANDI	T3,377		; USE ONLY THE RIGHT 8 BITS
  6985	011032'	322400	011022*		JUMPE	T3,CPOPJ1	;FINISHED
  6986	011033'	260040	001606'		PUSHJ	P,MOVCHR	;PUT CHAR IN OTHER INPUT BUFFER
  6987	011034'	255000	000000		  JFCL			;SHOULD ALWAYS SKIP NOW
  6988	011035'	254000	011030'		JRST	FRCLP2		;LOOP IN EITHER CASE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 160
SCNSER.MAC	25-JAN-91 22:40		FORCE A RESCAN LINE

  6989				SUBTTL	FORCE A RESCAN LINE
  6990
  6991			000000	%FROK==0	;NO ERROR
  6992			000001	%FRAUX==1	;PORT IS AN AUX CIRCUIT
  6993			000002	%FRBIG==2	;COMMAND STRING IS TOO BIG
  6994			000003	%FRCMD==3	;PORT IS IN COMMAND STATE
  6995			000004	%FRBRK==4	;BREAK BEFORE END OF COMMAND STRING (BYTE PTR UPDATED)
  6996			000005	%FRNBK==5	;NO BREAK ENCOUNTERED IN STRING
  6997			000006	%FRFUL==6	;RESCAN COMMAND ALREADY PRESENT
  6998
  6999	011036'	500245	000031	FRCRSC:	HLL	U, LDBDCH(U)
  7000	011037'	603240	000040		TLNE	U, LDLAUX	;IF PORT IS AN AUX CIRCUIT,
  7001					 JRST	[
  7002						MOVEI	P1, %FRAUX
  7003						JRST	FRCRSX	;  ERROR-RETURN
  7004	011040'	254000	017574'		]
  7005	011041'	603240	020000		TLNE	U, LDLCOM	;IF PORT IS IN COMMAND STATE,
  7006					 JRST	[
  7007						MOVEI	P1, %FRCMD
  7008						JRST	FRCRSX	;  ERROR-RETURN
  7009	011042'	254000	017576'		]
  7010	011043'	256200	017600'		XCTFU	<MOVE P1, 0(M)>	;P1/ COUNT
  7011	011044'	301600	000110		CAIL	P1, TIWKC	;IF IT'S TOO BIG,
  7012					 JRST	[
  7013						MOVEI	P1, %FRBIG
  7014						JRST	FRCRSX	;  ERROR-RETURN
  7015	011045'	254000	017601'		]
  7016	011046'	200300	000014	FRCRS1:	MOVE	T1, P1
  7017	011047'	271300	000013		ADDI	T1, <<<TTCHKS-1>*4>-1>
  7018	011050'	231300	000014		IDIVI	T1, <<TTCHKS-1>*4>	;T1/ # CHUNKS NEEDED
  7019	011051'	200340	017017'		MOVE	T2, TTFREN
  7020	011052'	275340	000003		SUBI	T2, TIRSVD	;T2/ # CHUNKS AVAILABLE
  7021	011053'	317300	000007		CAMG	T1, T2		;IF THERE AREN'T ENOUGH,
  7022	011054'	254000	011066'		 JRST	FRCRS2
  7023	011055'	205000	200000		MOVSI	S, TWTSPC
  7024	011056'	437004	000002		IORB	S, DEVIOS(F)	;  NOTE THAT WE NEED MORE ROOM
  7025	011057'	135300	000230'		LDB	T1, DDPTTI	;  T1/ IOW-INTERRUPT ASSIGNMENT
  7026	011060'	260040	000000*		PUSHJ	P, TSTKTJ	;  IF HE TRAPPED IT,
  7027					JRST	[
  7028						PUSHJ	P, SETFIO	;SET TO GIVE I/O DONE TRAP
  7029						PJRST	ABTUUO		;AND GET OUT
  7030	011061'	254000	017603'		]
  7031	011062'	261040	000014		PUSH	P, P1
  7032	011063'	260040	013736'		PUSHJ	P, TOWAT1	;  GO INTO OUTPUT WAIT
  7033	011064'	262040	000014		POP	P, P1
  7034	011065'	254000	011046'		JRST	FRCRS1		;  THEN TRY AGAIN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 161
SCNSER.MAC	25-JAN-91 22:40		FORCE A RESCAN LINE

  7035	011066'	260040	006257'	FRCRS2:	PUSHJ	P, TSETBI	;CLEAR THE INPUT BUFFER (!)
  7036	011067'	500245	000031		HLL	U, LDBDCH(U)
  7037	011070'	332000	017203'		SKIPE	FRSFLG
  7038	011071'	256000	000000'		 STOPCD
  7039	011072'	476000	017203'		SETOM	FRSFLG		;SET FLAG FOR CMDPGAK
  7040	011073'	661240	020000		TLO	U, LDLCOM	;SET COMMAND STATE
  7041	011074'	402000	017204'		SETZM	FRSDEF
  7042	011075'	623240	001000		TLZE	U, LDLDEF	;CLEAR DEFERRED-ECHO
  7043	011076'	476000	017204'		SETOM	FRSDEF		;(REMEMBER PGHAT IT PGAS)
  7044	011077'	502245	000031		HLLM	U, LDBDCH(U)
  7045	011100'	260040	007603'		PUSHJ	P, SETLMD	;FIX LINE-MODE FIELD
  7046
  7047				    ;HERE TO ACTUALLY FORCE THE INPUT
  7048				    ;P1/ COUNT
  7049
  7050	011101'	256200	017605'		XCTFU	<MOVE PG, 1(M)>	;PG/ BYTE POINTER
  7051	011102'	621140	000037		TLZ	PG, 37		;CLEAR INDEX AND INDIRECT BITS
  7052	011103'	261040	000014		PUSH	P, P1		;0(P)/ COUNT
  7053
  7054	011104'	375001	000000	FRCRS3:	SOSGE	0(P)		;DONE?
  7055	011105'	254000	011121'		JRST	FRCRS4		;(YES)
  7056	011106'	256040	017606'		XCTFU	<ILDB T3, PG>	;T3/ NEXT CHARACTER
  7057	011107'	405400	000377		ANDI	T3, 377		;(ONLY 8 BITS)
  7058	011110'	260040	001606'		PUSHJ	P, MOVCHR	;DEPOSIT IT
  7059	011111'	254000	011112'		JRST	.+1		;(REMOTE-ECHO RETURN)
  7060	011112'	332000	017203'		SKIPE	FRSFLG		;IF CMDPGAK NOT CALLED YET,
  7061	011113'	254000	011104'		JRST	FRCRS3		;  TRY THE NEXT CHARACTER
  7062
  7063				    ;HERE WHEN A "COMMAND LINE" HAS BEEN FORCED
  7064
  7065	011114'	262040	000006		POP	P, T1		;T1/ COUNT LEFT
  7066	011115'	322300	011125'		JUMPE	T1, FRCRS5	;IF THERE'RE CHARS AFTER THE BREAK,
  7067	011116'	256200	017607'		XCTTU	<MOVEM PG, 1(M)>;  STORE BACK THE MODIFIED BYTE POINTER
  7068	011117'	201600	000004		MOVEI	P1, %FRBRK	;  ERROR-RETURN
  7069	011120'	254000	011126'		JRST	FRCRS6
  7070
  7071				    ;HERE WHEN WE RAN OUT OF CHARACTERS BEFORE A "COMMAND LINE"
  7072				    ;WAS FINISHED
  7073
  7074	011121'	262040	000006	FRCRS4:	POP	P, T1
  7075	011122'	402000	017203'		SETZM	FRSFLG		;CLEAR FLAG
  7076	011123'	201600	000005		MOVEI	P1, %FRNBK	;ERROR-RETURN
  7077	011124'	254000	011126'		JRST	FRCRS6
  7078
  7079				    ;HERE WHEN THINGS WERE JUST RIGHT
  7080
  7081	011125'	201600	000000	FRCRS5:	MOVEI	P1, %FROK
  7082					PFALL	FRCRS6
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 162
SCNSER.MAC	25-JAN-91 22:40		FORCE A RESCAN LINE

  7083				    ;CLEAN THINGS UP
  7084
  7085	011126'	336000	017204'	FRCRS6:	SKIPN	FRSDEF		;IF PORT WAS IN DEFERRED ECHO MODE,
  7086	011127'	254000	011132'		JRST	FRCRS7
  7087	011130'	205300	001000		MOVSI	T1, LDLDEF
  7088	011131'	436305	000031		IORM	T1, LDBDCH(U)	;  SET DEFERRED-ECHO AGAIN
  7089	011132'	205300	020000	FRCRS7:	MOVSI	T1, LDLCOM
  7090	011133'	412305	000031		ANDCAM	T1, LDBDCH(U)	;CLEAR COMMAND MODE
  7091	011134'	205300	100000		MOVSI	T1, LDLECS
  7092	011135'	436305	000031		IORM	T1, LDBDCH(U)	;SET EAT-COMMAND-SYNC
  7093	011136'	260040	007603'		PUSHJ	P, SETLMD	;FIX LINE-MODE FIELD
  7094
  7095	011137'	336000	000014	FRCRSX:	SKIPN	P1		;IF NO ERROR OCCURRED,
  7096	011140'	354001	000000		AOSA	(P)		;  PREPARE FOR SKIP-RETURN, ELSE
  7097	011141'	256200	017610'		XCTTU	<MOVEM P1, (W)>	;  USER AC := RETURN CODE
  7098	011142'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 163
SCNSER.MAC	25-JAN-91 22:40		AUXILIARY CIRCUITS

  7099				SUBTTL AUXILIARY CIRCUITS
  7100
  7101				;ONLY ONE AUXILIARY CIRCUIT IS IN THE PROCESS OF BEING BUILT
  7102				;AT ANY ONE TIME. JOBS WANTING TO BUILD AN AUX.
  7103				;CIRCUIT ARE QUEUED ON THE AX QUE. ONCE A CIRCUIT IS READY TO
  7104				;BE BUILT, THE COMMUNICATION WITH THE SUPERVISOR IS
  7105				;CONTROLED BY A STATE CELL (AUXSTA). THE FOLLOWING ARE THE STATES
  7106
  7107			000000	.ASIDL==0	;NOT BUILDING A CIRCUIT
  7108			000001	.ASRQ1==1	;READY TO SEND SUPERVISOR REQUEST
  7109			000002	.ASWR1==2	;WAITING FOR SUPERVISOR RESOPNSE
  7110			000003	.ASRQ2==3	;READY TO RE-SEND SUPERVISOR REQUEST
  7111						;(BECAUSE OF ERROR ON FIRST TRY - PROBABLY
  7112						;COMMUNICATION IS OUT OF SYNC)
  7113			000004	.ASWR2==4	;WAITING FOR SUPERVISOR RESPONSE TO RE-SEND
  7114			000005	.ASLOG==5	;SENDING LOGIN STRING TO SUPERVISOR
  7115			000006	.ASWPT==6	;WAITING FOR A PORT AND A SUPERVISOR RESPONSE
  7116			000007	.ASWTP==7	;RECEIVED AN AUX CIRCUIT (MSG TYPE 7) FOR A PORT PENDING A
  7117						; ZAPPER, SO NOW WAITING FOR SUPERVISOR RESPONSE SO WE CAN
  7118						; RE-SEND A SUPERVISOR REQUEST WITHOUT GETTING OUT OF SYNC
  7119						;( ** NOT SUPPOSED TO HAPPEN ** SEE TTYZNE & ZAPBUG ** )
  7120
  7121				;ERROR NUMBERS FROM THE PDP-10
  7122
  7123			000001	CX2AX%==1	;TOO MANY AUX CIRCUITS FOR THIS JOB AND NO AC LICENSE
  7124			000002	CXLOG%==2	;USER NAMES DO NOT MATCH AND NO AC LICENSE
  7125			000003	CXDCB%==3	;NO DDB'S AVAILABLE
  7126			000004	CXNRR%==4	;NO RESPONSE TO FIRST REQUEST
  7127			000005	CXNRL%==5	;NO RESPONSE AFTER STRING SENT
  7128			000006	CXNCH%==6	;NO PORT RECEIVED
  7129			000007	CXERR%==7	;ERROR FROM FIRST RESPONSE
  7130
  7131				;SPECIAL ROUTINE WHEN COMMING OUT OF IO WAIT FINDS
  7132				;AN AUX CIRCUIT ZAPPED
  7133
  7134	011143'	201300	600000	AUXRID:	MOVEI	T1,ASSCON!ASSPRG
  7135	011144'	616304	000004		TDNN	T1,DEVMOD(F)		;STILL ASSIGNED?
  7136	011145'	260040	015254'		 PUSHJ	P,TTYKDB		;NO, REMOVE DDB
  7137	011146'	254000	007231*		JRST	ABTUUO			;IN ANY CASE, ABORT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 164
SCNSER.MAC	25-JAN-91 22:40		TURN THE COMMAND PORT INTO SOMETHING LIKE AN "AUX" PORT

  7138				SUBTTL	TURN THE COMMAND PORT INTO SOMETHING LIKE AN "AUX" PORT
  7139
  7140	011147'	205300	020000	MAKDET:	MOVSI	T1,TTYATC	;MUST BE COMMAND PORT
  7141	011150'	616304	000004		TDNN	T1,DEVMOD(F)
  7142	011151'	263040	000000		 POPJ	P,
  7143	011152'	322240	010706*		JUMPE	U,CPOPJ		;DO NOT ALLOW IF NOT COMMAND OR DET
  7144	011153'	205300	200000		MOVSI	T1,LLLZAP
  7145	011154'	612305	000026		TDNE	T1,LDBLOG(U)
  7146	011155'	263040	000000		 POPJ	P,		;OR IF WAITING TO LOG OUT
  7147	011156'	205300	000400		MOVSI	T1,LICAC
  7148	011157'	612302	006772*		TDNE	T1,JBTLIC(J)
  7149	011160'	254000	011170'		 JRST	MAKDLC		;MUST HAVE LIC OR ONLY ONE OTHER PORT
  7150	011161'	260040	016110'		PUSHJ	P,FRSTTY
  7151	011162'	254000	011170'		  JRST	MAKDLC
  7152	011163'	260040	016112'		PUSHJ	P,NXTTTY
  7153	011164'	254000	011170'		  JRST	MAKDLC
  7154	011165'	260040	016112'		PUSHJ	P,NXTTTY
  7155	011166'	254000	011170'		  JRST	MAKDLC
  7156	011167'	263040	000000		POPJ	P,		;ERROR, ALREADY HAVE TWO PORTS
  7157	011170'	550202	010004*	MAKDLC:	HRRZ	F,TTYTAB(J)
  7158	011171'	554304	000013		HLRZ	T1,DDBBLK(F)
  7159	011172'	260040	015720'		PUSHJ	P,DDBSR1	;GET ONE AND LINK IT IN
  7160	011173'	263040	000000		  POPJ	P,		;CAN NOT
  7161	011174'	550342	011170*		HRRZ	T2,TTYTAB(J)
  7162	011175'	542202	011174*		HRRM	F,TTYTAB(J)	;MAKE A NEW COMMAND PORT
  7163	011176'	205300	010000		MOVSI	T1,DVNZP
  7164	011177'	436307	000004		IORM	T1,DEVMOD(T2)	;DO NOT ALLOW TTY TO BE ZAPPED
  7165	011200'	205300	020000		MOVSI	T1,TTYATC
  7166	011201'	412307	000004		ANDCAM	T1,DEVMOD(T2)	;NO LONGER THE COMMAND PORT
  7167	011202'	541300	400000		HRRI	T1,ASSCON
  7168	011203'	436304	000004		IORM	T1,DEVMOD(F)	;MARK AS ASSIGNED BY CONSOLE (FOR RESET)
  7169	011204'	137100	010011*		DPB	J,PJOBN
  7170	011205'	260040	015764'		PUSHJ	P,SCNNAM	;THAT SHOULD BE ENOUGH
  7171	011206'	553004	000000		  HRRZS	DEVNAM(F)	;SO LOOKS DETACHED
  7172	011207'	550200	000007		HRRZ	F,T2
  7173	011210'	200004	000002		MOVE	S,DEVIOS(F)
  7174	011211'	550244	000013		HRRZ	U,DDBLDB(F)
  7175	011212'	205340	020000		MOVSI	T2,LDLCOM
  7176	011213'	412345	000031		ANDCAM	T2,LDBDCH(U)
  7177	011214'	350001	000000		AOS	(P)
  7178	011215'	135300	000157'		LDB	T1,LDPLNO
  7179	011216'	705313	000000		UMOVEM	T1,(M)
  7180	011217'	324740	013554'		PJRST	UUOLDB
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 165
SCNSER.MAC	25-JAN-91 22:40		HERE FROM HANG UUO WHEN HANGING AN AUX CIRCUIT

  7181				SUBTTL	HERE FROM HANG UUO WHEN HANGING AN AUX CIRCUIT
  7182
  7183	011220'	550205	000000	HNGAUX:	HRRZ	F,LDBDDB(U)
  7184	011221'	322200	011226'		JUMPE	F,HNGAXD	;IF IT'S ATTACHED,
  7185	011222'	135300	000234'	HNGAX1:	LDB	T1,DDPTZP
  7186	011223'	260040	010412*		PUSHJ	P,TAKTRJ	;  INTERRUPT ITS OWNER
  7187	011224'	201340	400000		MOVEI	T2,ASSCON
  7188	011225'	324740	006745*		PJRST	RELEA6		;  AND CLEAR ASSIGNED-BY-CONSOLE
  7189
  7190				    ;HERE WHEN PORT IS ALREADY DETACHED
  7191
  7192	011226'	260040	015372'	HNGAXD:	PUSHJ	P,TTYZAP	;SET TO SEND A ZAPPER BACK
  7193	011227'	553000	000005		HRRZS	U		;CLEAR LDBDCH BITS
  7194	011230'	312240	017050'		CAME	U,AUXRCP	;IF IT'S THE RECEIVED AUX PORT,
  7195	011231'	254000	011234'		 JRST	HNGAX4
  7196	011232'	476000	017050'		SETOM	AUXRCP		;  SAY WE HAVEN'T RECEIVED ONE
  7197	011233'	350000	017072'		AOS	ZRPCNT		;  AND NOTE THAT WE DID SO
  7198	011234'	263040	000000	HNGAX4:	POPJ	P,
  7199
  7200				;HERE WHEN A ZAPPER IS RECEIVED ON AN AUX PORT
  7201
  7202	011235'	550205	000000	ZAPAUX:	HRRZ	F,LDBDDB(U)	;F/ DDB ADDR
  7203	011236'	322200	011226'		JUMPE	F,HNGAXD	;IF DETACHED, JUST CHECK "RECEIVED" PORT
  7204	011237'	260040	015372'		PUSHJ	P,TTYZAP	;SET TO SEND ZAPPER
  7205	011240'	513004	000013		HLLZS	DDBLDB(F)	;DETACH IT
  7206	011241'	513005	000000		HLLZS	LDBDDB(U)
  7207	011242'	254000	011222'		JRST	HNGAX1		;INTERRUPT JOB, CLEAR ASSCON
  7208
  7209				;HERE FROM RELEA6 WHEN BOTH ASSCON AND ASSPRG GO OFF
  7210
  7211	011243'	550244	000013	AUXZAP:	HRRZ	U,DDBLDB(F)
  7212	011244'	322240	011254'		JUMPE	U,AXZP1		;IF DDB HAS A PORT ATTACHED,
  7213	011245'	260040	015372'		PUSHJ	P,TTYZAP	;  SET TO SEND ZAPPER
  7214	011246'	513004	000013		HLLZS	DDBLDB(F)
  7215	011247'	513005	000000		HLLZS	LDBDDB(U)	;  DETACH IT
  7216	011250'	402005	000034		SETZM	LDBSTR(U)	;  CLEAR PREVIOUS CIRCUIT NAME
  7217	011251'	551305	000035		HRRZI	T1,LDBSTR+1(U)	;  GET ADDRESS
  7218	011252'	505306	777777		HRLI	T1,-1(T1)	;    STR,,STR+1
  7219	011253'	251305	000043		BLT	T1,LDBSTR+AUXSTL-1(U)
  7220	011254'	553004	000000	AXZP1:	HRRZS	DEVNAM(F)	;MARK NAME AS DETACHED
  7221	011255'	205300	020000		MOVSI	T1,TIOUSE
  7222	011256'	616304	000002		TDNN	T1,DEVIOS(F)	;IF NO UUO IS IN PROGRESS,
  7223	011257'	324740	015254'		 PJRST	TTYKDB		;  KILL THE DDB
  7224	011260'	200004	000002		MOVE	S,DEVIOS(F)	;OTHERWISE,
  7225	011261'	324740	006010'		PJRST	TIWAKE		;  JUST WAKE THE JOB
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 166
SCNSER.MAC	25-JAN-91 22:40		ON RECEIPT OF A TAKEOVER MESSAGE, RESET AND TRY AGAIN

  7226				SUBTTL	ON RECEIPT OF A TAKEOVER MESSAGE, RESET AND TRY AGAIN
  7227
  7228	011262'	200300	001476*	RCVNSP:	MOVE	T1,DATE##	;Remember the date/time of when
  7229	011263'	202300	001477*		MOVEM	T1,SUPTIM##	; the new Supervisor took over
  7230	011264'	336000	017051'		SKIPN	AUXSTA
  7231	011265'	344740	001011'		 AOJA	P4,SCNIN1	;IN IDLE STATE, JUST IGNORE
  7232	011266'	331240	017050'		SKIPL	U,AUXRCP	;PORT RECEIVED?
  7233	011267'	260040	015372'		 PUSHJ	P,TTYZAP	;YES, ZAP IT
  7234	011270'	201300	000001		MOVEI	T1,.ASRQ1
  7235	011271'	202300	017051'		MOVEM	T1,AUXSTA
  7236	011272'	344740	001011'		AOJA	P4,SCNIN1	;READY TO SEND FIRST REQUEST
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 167
SCNSER.MAC	25-JAN-91 22:40		SUPERVISOR RESPONSE RECIVED

  7237				SUBTTL	SUPERVISOR RESPONSE RECIVED
  7238
  7239	011273'	200300	017051'	RCVSUR:	MOVE	T1,AUXSTA
  7240	011274'	256006	011275'		XCT	ARSTAB(T1)
  7241
  7242	011275'	344740	001011'	ARSTAB:	AOJA	P4,SCNIN1	;.ASIDL IGNORE
  7243	011276'	344740	001011'		AOJA	P4,SCNIN1	;.ASRQ1 IGNORE
  7244	011277'	254000	011305'		JRST	RCVS2		;.ASWR1 RESPONSE TO 1ST REQUEST
  7245	011300'	344740	001011'		AOJA	P4,SCNIN1	;.ASRQ2 IGNORE
  7246	011301'	254000	011314'		JRST	RCVS4		;.ASWR2 RESPONSE TO 2ND REQUEST
  7247	011302'	344740	001011'		AOJA	P4,SCNIN1	;.ASLOG IGNORE
  7248	011303'	254000	011321'		JRST	RCVS6		;.ASWPT RESPONSE TO LOGIN
  7249	011304'	254000	011325'		JRST	RCVSP		;.ASWTP RESPONSE TO LOGIN (BAD RCVAUX)
  7250
  7251				    ;SUPERVISOR RESPONSE TO FIRST REQUEST
  7252
  7253	011305'	135300	000270'	RCVS2:	LDB	T1,INPCHR	;GET ERROR CODE
  7254					JUMPN	T1,[AOS AUXSTA	;ON ERROR, STATE:=.AXRQ2 (RETRY)
  7255	011306'	326300	017611'			AOJA P4,SCNIN1]
  7256	011307'	200300	017613'	RCVS2A:	MOVE	T1,[POINT 7,AUXSTR]
  7257	011310'	202300	017063'		MOVEM	T1,AUXSTP
  7258	011311'	201300	000005		MOVEI	T1,.ASLOG
  7259	011312'	202300	017051'		MOVEM	T1,AUXSTA	;SUCCESSFUL RESPONSE: SEND LOGIN STRING
  7260	011313'	344740	001011'		AOJA	P4,SCNIN1
  7261
  7262				  ;SUPERVISOR RESPONSE TO RE-REQUEST
  7263
  7264	011314'	135300	000270'	RCVS4:	LDB	T1,INPCHR	;LIKE 1ST REQUEST BUT ERROR IS FATAL
  7265	011315'	322300	011307'		JUMPE	T1,RCVS2A	;NO ERROR
  7266	011316'	505300	000007		HRLI	T1,CXERR%	;SET ERROR TYPE
  7267	011317'	260040	011332'		PUSHJ	P,ERRXIT	;AND CLEAN UP
  7268	011320'	344740	001011'		AOJA	P4,SCNIN1
  7269
  7270				    ;SUPERVISOR RESPONSE TO LOGIN STRING
  7271
  7272	011321'	135300	000270'	RCVS6:	LDB	T1,INPCHR
  7273					JUMPN	T1,[PUSHJ P,ERRXIT	;ERROR, TELL USER
  7274	011322'	326300	017614'			AOJA P4,SCNIN1]	;AND CLEAN UP
  7275	011323'	260040	011335'		PUSHJ	P,AUXWAK	;WAKE UP THE USER
  7276	011324'	344740	001011'		AOJA	P4,SCNIN1
  7277
  7278	011325'	135300	000270'	RCVSP:	LDB	T1,INPCHR
  7279					JUMPN	T1,[PUSHJ P,ERRXIT	;ERROR, TELL USER
  7280	011326'	326300	017614'			AOJA P4,SCNIN1]	;AND CLEAN UP
  7281	011327'	201300	000001		MOVEI	T1,.ASRQ1	;SHOULDN'T GIVE ERROR TO USER,
  7282	011330'	202300	017051'		MOVEM	T1,AUXSTA	;SO SETUP FOR RETRY
  7283	011331'	344740	001011'		AOJA	P4,SCNIN1
  7284
  7285	011332'	202300	017064'	ERRXIT:	MOVEM	T1,AUXERR	;SAVE ERROR
  7286	011333'	331240	017050'		SKIPL	U,AUXRCP	;IS THERE A PORT
  7287	011334'	260040	015372'		 PUSHJ	P,TTYZAP	;YES, ZAP IT
  7288	011335'	402000	017051'	AUXWAK:	SETZM	AUXSTA		;STATE:=.ASIDL (IDLE)
  7289	011336'	200100	017065'		MOVE	J,AUXJOB	;JOB WAITING
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 167-2
SCNSER.MAC	25-JAN-91 22:40		SUPERVISOR RESPONSE RECIVED

  7290	011337'	201300	000000*		MOVEI	T1,RNQ
  7291	011340'	137300	000000*		DPB	T1,PJBSTS##
  7292	011341'	324740	000000*		PJRST	SETRUN		;RESTART HIM FOM MLOWQ
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 168
SCNSER.MAC	25-JAN-91 22:40		MESSAGE 7 - AN AUX CIRCUIT HAS BEEN BUILT TO <U> FOR

  7293				SUBTTL	 MESSAGE 7 - AN AUX CIRCUIT HAS BEEN BUILT TO <U> FOR
  7294				;	       THE JOB WHOSE COMMAND PORT IS <INPCHR>
  7295
  7296	011342'	200305	000001	RCVAUX:	MOVE	T1,LDBLIN(U)
  7297	011343'	603300	400000		TLNE	T1,LNLZIN		;IF THERE'S AN UNECHOED ZAPPER,
  7298					 JRST	[MOVEI	T1,NZAPAX
  7299						 PUSHJ	P,ZAPBUG	;NOTE IT
  7300	011344'	254000	017616'			 JRST	.+1]
  7301	011345'	332005	000026		SKIPE	LDBLOG(U)		; LOGGING OR LOGGED IN?
  7302									;  TREAT AS CIRCUIT ZAPPER
  7303					  JRST	[PUSHJ	P,ZAPLOG	; NOTE THE ZAP (increment P4)
  7304						 MOVE	T1,AUXSTA	; Make sure that we were
  7305						 CAIE	T1,.ASWPT	;  expecting a type 7 msg.
  7306						  SOJA	P4,AUXWST	; No? decrement & handle error
  7307						 AOS	AUXSTA		; Yes, State:= .ASWTP, keep waiting!
  7308	011346'	254000	017621'			 JRST	SCNIN1]		; Return to loop
  7309
  7310	011347'	200300	017051'		MOVE	T1,AUXSTA		; T1/ STATE
  7311	011350'	306300	000006		CAIN	T1,.ASWPT		; IF WE'RE NOT EXPECTING A TYPE 7,
  7312	011351'	254000	011360'		 JRST	AUXINP
  7313					PFALL	AUXWST			;   NOTE THE ERROR
  7314
  7315	011352'			AUXWST:	; MESSAGE RECEIVED IN WRONG STATE
  7316	011352'	350000	017066'		AOS	AUXWSC			; NOTE THE FACT
  7317	011353'	254000	011356'		JRST	AUXZPT			; TREAT MSG AS A ZAPPER
  7318
  7319	011354'			AUXWPN:	; MESSAGE RECEIVED BUT WITH THE WRONG PORT NUMBER
  7320	011354'	350000	017067'		AOS	AUXWPC			; NOTE THE FACT
  7321	011355'	202300	017070'		MOVEM	T1,AUXWPT		; SAVE THE (BAD) PORT'S LDB ADDR
  7322					PFALL	AUXZPT			; TREAT MSG AS A ZAPPER
  7323
  7324	011356'	260040	015372'	AUXZPT:	PUSHJ	P,TTYZAP		; ARRANGE TO SEND ZAPPER
  7325	011357'	344740	001011'		AOJA	P4,SCNIN1
  7326
  7327	011360'	135300	000270'	AUXINP:	LDB	T1,INPCHR		; T1/ CREATING JOB'S PORT #
  7328	011361'	550340	017074'		HRRZ	T2,AUXPRT
  7329	011362'	312300	000007		CAME	T1,T2			; IS IT CORRECT?
  7330	011363'	254000	011354'		 JRST	AUXWPN			; NO
  7331	011364'	552240	017050'		HRRZM	U,AUXRCP		; SAVE THE LINE POINTER
  7332	011365'	205300	400000		MOVSI	T1,(1B0)
  7333	011366'	202305	000026		MOVEM	T1,LDBLOG(U)		; SET LOGGED-IN BIT
  7334
  7335					; INITIALIZE THE LINE
  7336	011367'	402005	000003		SETZM	LDBOUT(U)
  7337	011370'	402005	000027		SETZM	LDBBYT(U)
  7338	011371'	402005	000030		SETZM	LDBMOD(U)
  7339	011372'	402005	000050		SETZM	LDBTMT(U)
  7340			000000		ZZN==0
  7341				REPEAT TMCSIZ,<
  7342					SETZM LDBTMR+ZZN(U)
  7343					ZZN==ZZN+1
  7344				> ; End REPEAT TMCSIZ
  7345	011373'	402005	000044
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 168-2
SCNSER.MAC	25-JAN-91 22:40		MESSAGE 7 - AN AUX CIRCUIT HAS BEEN BUILT TO <U> FOR

  7346	011374'	402005	000045
  7347	011375'	205300	003340		MOVSI	T1,LDLDEF!LDLIMI!LDLAUX!LDLNEC!LDLNFC
  7348	011376'	202305	000031		MOVEM	T1,LDBDCH(U)
  7349	011377'	205300	400000		MOVSI	T1,LXL120
  7350	011400'	202305	000032		MOVEM	T1,LDBDCX(U)
  7351	011401'	505300	017052'		HRLI	T1,AUXSTR		; Copy string sent to
  7352	011402'	541305	000034		HRRI	T1,LDBSTR(U)		;  supervisor for tracking
  7353	011403'	251305	000043		BLT	T1,LDBSTR+AUXSTL-1(U)
  7354
  7355	011404'	260040	007603'		PUSHJ	P,SETLMD		; SET THE INPUT MODE
  7356	011405'	344740	001011'		AOJA	P4,SCNIN1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 169
SCNSER.MAC	25-JAN-91 22:40		CALLED ONCE A TICK FROM SCNINT TO PROCESS AUX CIRCUIT BUILDS

  7357				SUBTTL	CALLED ONCE A TICK FROM SCNINT TO PROCESS AUX CIRCUIT BUILDS
  7358
  7359	011406'	200300	017051'	SNDAUX:	MOVE	T1,AUXSTA	;SEE WHAT WE SHOULD DO
  7360	011407'	256006	011412'		XCT	AXSNTB(T1)
  7361	011410'	254000	011474'		 JRST	AUXTOV		;TIME OUT
  7362	011411'	254000	011032*		JRST	CPOPJ1		;JUST RETURN
  7363
  7364	011412'	254000	011411*	AXSNTB:	JRST	CPOPJ1		;.ASIDL  DO NOTHING
  7365	011413'	254000	011424'		JRST	SNDSRQ		;.ASRQ1  SEND 1ST REQUEST
  7366	011414'	377000	017075'		SOSG	AUXTIM		;.ASWR1  TIME THE RESPONSE
  7367	011415'	254000	011424'		JRST	SNDSRQ		;.ASRQ2  SEND 2ND REQUEST
  7368	011416'	377000	017075'		SOSG	AUXTIM		;.ASWR2  TIME THE RESPONSE
  7369	011417'	254000	011437'		JRST	AUXCHR		;.ASLOG  SEND LOGIN STRING
  7370	011420'	377000	017075'		SOSG	AUXTIM		;.ASWPT  TIME THE RESPONSE
  7371	011421'	377000	017075'		SOSG	AUXTIM		;.ASWTP  TIME THE RESPONSE
  7372
  7373	011422'	000000	021450	AUXTMR:	^D150*^D60		;REQUEST RESPONSE TIMEOUT
  7374	011423'	000000	021450	AUXTMP:	^D150*^D60		;PORT RESPONSE TIMEOUT
  7375
  7376				    ;HERE TO SEND A SUPERVISOR REQUEST
  7377
  7378	011424'	260040	004113'	SNDSRQ:	PUSHJ	P,CLSCHR
  7379	011425'	263040	000000		  POPJ	P,		;NOT REALLY ANY ROOM
  7380	011426'	205700	013000		MOVSI	P3,TYPI TYPSUP	;SEND REQUEST
  7381	011427'	200300	017074'		MOVE	T1,AUXPRT	;GET THE PORT NUMBER
  7382	011430'	137300	000276'		DPB	T1,WRPLIN
  7383	011431'	554300	017074'		HLRZ	T1,AUXPRT	;Get NETID number
  7384	011432'	137300	000301'		DPB	T1,WRP3N4	;Store 16 bits
  7385	011433'	200300	011422'		MOVE	T1,AUXTMR	;SET TIMER
  7386	011434'	202300	017075'		MOVEM	T1,AUXTIM
  7387	011435'	350000	017051'		AOS	AUXSTA		;ADVANCE STATE (.ASRQX = .ASWTX)
  7388	011436'	254000	004161'		JRST	WRDOUT		;AND SEND REQUEST
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 170
SCNSER.MAC	25-JAN-91 22:40		HERE TO SEND CHARACTERS FROM THE LOGIN STRING

  7389				SUBTTL	HERE TO SEND CHARACTERS FROM THE LOGIN STRING
  7390
  7391	011437'	260040	004113'	AUXCHR:	PUSHJ	P,CLSCHR
  7392	011440'	263040	000000		  POPJ	P,		;NO ROOM
  7393	011441'	205700	014000		MOVSI	P3,TYPI TYPAXC
  7394	011442'	200300	017074'		MOVE	T1,AUXPRT
  7395	011443'	137300	000276'		DPB	T1,WRPLIN	;SET UP TO SEND
  7396	011444'	200340	017045'	AXCLP1:	MOVE	T2,MXMCNT	;SPACE LEFT
  7397	011445'	271340	000002		ADDI	T2,2
  7398	011446'	242340	777776		LSH	T2,-2
  7399	011447'	134300	017063'	AUXCLP:	ILDB	T1,AUXSTP
  7400	011450'	322300	011467'		JUMPE	T1,AXCDON	;FINISHED
  7401	011451'	137300	000277'		DPB	T1,WRPCHR
  7402	011452'	202717	004571*		MOVEM	P3,ORING(P4)	;PUT IN RING
  7403	011453'	260040	016501'		PUSHJ	P,ORPLOG	;Put message into ORING log
  7404	011454'	363340	011456'		SOJLE	T2,AXCLP2	;RAN OUT OF ROOM
  7405	011455'	344740	011447'		 AOJA	P4,AUXCLP	;ADVANCE POINTER AND CONTINUE
  7406
  7407	011456'	271740	000001	AXCLP2:	ADDI	P4,1		;ADVANCE POINTER
  7408	011457'	405740	004574*		ANDI	P4,MSKORG
  7409	011460'	200300	017063'		MOVE	T1,AUXSTP
  7410	011461'	134300	000006		ILDB	T1,T1		;GET NEXT CHARACTER
  7411	011462'	322300	011467'		JUMPE	T1,AXCDON	;HAVE REALLY SENT THEM ALL
  7412	011463'	202740	004557*		MOVEM	P4,ORPPDP	;SAVE POINTER FOR 620
  7413	011464'	260040	004140'		PUSHJ P,SETOUT
  7414	011465'	263040	000000		  POPJ	P,		;OUT OF ROOM
  7415	011466'	254000	011444'		JRST	AXCLP1		;MORE ROOM, SEND MORE
  7416
  7417	011467'	202740	011463*	AXCDON:	MOVEM	P4,ORPPDP
  7418	011470'	200300	011423'		MOVE	T1,AUXTMP
  7419	011471'	202300	017075'		MOVEM	T1,AUXTIM	;SET TIMER
  7420	011472'	350000	017051'		AOS	AUXSTA		;STATE:=.ASWPT (WAIT FOR PORT RESPONSE)
  7421	011473'	324740	004140'		PJRST	SETOUT		;RESET ROOM COUNTERS AND EXIT
  7422
  7423				;HERE ON ANY TIMEOUT
  7424
  7425	011474'	350001	000000	AUXTOV:	AOS	(P)		;SET FOR SKIP RETURN
  7426	011475'	200300	017051'		MOVE	T1,AUXSTA
  7427	011476'	256006	011477'		XCT	AXTOTB(T1)	;RESPOND ACCORDING TO WHAT GOT TIMED-OUT
  7428
  7429	011477'	256000	000000'	AXTOTB:	 STOPCD			;.ASIDL  CAN'T TIME OUT
  7430	011500'	256000	000000'		 STOPCD			;.ASRQ1  CAN'T TIME OUT
  7431	011501'	254000	011507'		JRST	AXNRR		;.ASWT1  1ST REQUEST TIMED OUT
  7432	011502'	256000	000000'		 STOPCD			;.ASRQ2  CAN'T TIME OUT
  7433	011503'	254000	011507'		JRST	AXNRR		;.ASWT2  2ND RESPONSE TIMED OUT
  7434	011504'	256000	000000'		 STOPCD			;.ASLOG  CAN'T TIME OUT
  7435	011505'	254000	011511'		JRST	AXNRL		;.ASWPT  PORT RESPONSE TIMED OUT
  7436	011506'	254000	011511'		JRST	AXNRL		;.ASWTP  PORT RESPONSE TIMED OUT (BAD RCVAUX)
  7437
  7438	011507'	205300	000004	AXNRR:	MOVSI	T1,CXNRR%	;SET ERROR CODE
  7439	011510'	324740	011332'		PJRST	ERRXIT
  7440
  7441	011511'	205300	000005	AXNRL:	MOVSI	T1,CXNRL%
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 170-2
SCNSER.MAC	25-JAN-91 22:40		HERE TO SEND CHARACTERS FROM THE LOGIN STRING

  7442	011512'	324740	011332'		PJRST	ERRXIT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 171
SCNSER.MAC	25-JAN-91 22:40		CODE TO HANDLE THE CREAT AUX CIR UUO

  7443				SUBTTL	CODE TO HANDLE THE CREAT AUX CIR UUO
  7444				;Call:	MOVEI	AC,[ASCIZ/USERNAME:HOST/]
  7445				;	HRLI	AC,FLAGS	;Bits 1-2 are DR # on KS, Bit 17 is NOZAP,
  7446				;				;Bits 1-16 are for NETID (new in P035/D07)
  7447				;	CREAUX	AC,		;CALLI AC,-144
  7448				;	  error return
  7449
  7450				IFCPU(<KI,KL>),<CXDTP==0>	;Use port 0 for detached jobs
  7451			000001	IFCPU(<KS,F3>),<CXDTP==1>	;Always user port 001 (or 101 or 201 or 301)
  7452
  7453	011513'	352000	000000*	CREAUX::AOSE	AXREQ
  7454	011514'	260040	000000*		 PUSHJ	P,AXWAIT	;WAIT FOR RESOURCE
  7455	011515'	402000	000000*		SETZM	AXSWT
  7456	011516'	201340	011707'		MOVEI	T2,AXGIV
  7457	011517'	202342	000000*		MOVEM	T2,JBTABT(J)	;SET ERROR LOCATION
  7458	011520'	402000	017064'		SETZM	AUXERR		;NO ERROR YET
  7459	011521'	476000	017050'		SETOM	AUXRCP		;AND NO PORT
  7460	011522'	550202	011175*		HRRZ	F,TTYTAB(J)
  7461	011523'	322200	011531'		JUMPE	F,AUXDET	;IF NO JOB (!)
  7462	011524'	550244	000013		HRRZ	U,DDBLDB(F)
  7463	011525'	322240	011531'		JUMPE	U,AUXDET	;OR NOT ATTACHED
  7464	011526'	205340	040000		MOVSI	T2,LDLPTY
  7465	011527'	612345	000031		TDNE	T2,LDBDCH(U)	;OR CONTROLLED BY A PTY,
  7466	011530'	254000	011531'		 JRST	AUXDET
  7467				IFNKMC<
  7468					LDB	U,LDPLNO	; Use CMD port as index!!
  7469					SKIPA			;  ** not done if KMC **
  7470				> ; End IFNKMC
  7471	011531'	201240	000001	AUXDET:	MOVEI	U,CXDTP		;  FAKE A PORT NUMBER
  7472	011532'	202240	017074'		MOVEM	U,AUXPRT	;Send to SUP on this port number
  7473	011533'	202100	017065'		MOVEM	J,AUXJOB	;SET JOB NUMBER
  7474	011534'	200600	000006		MOVE	P1,T1		;SAVE ARGUMENT
  7475	011535'	505300	440700		HRLI	T1,(POINT 7,0)	;GET POINTER TO THE STRING
  7476	011536'	200740	017613'		MOVE	P4,[POINT 7,AUXSTR]	;SET TO SAVE IT
  7477	011537'	201700	000035		MOVEI	P3,AUXSTM	;MAX WE CAN HAVE
  7478	011540'	200440	017627'		MOVE	T4,[POINT 6,AUXUNM]	;SET TO ACCUMULATE A USER NAME
  7479	011541'	201640	000014		MOVEI	P2,^D12		;MAX CHRS IN USER NAME
  7480	011542'	402000	017076'		SETZM	AUXUNM
  7481	011543'	402000	017077'		SETZM	AUXUNM+1
  7482	011544'	402000	017052'		SETZM	AUXSTR		;Clear out accumulated string
  7483	011545'	200340	017630'		MOVE	T2,[AUXSTR,,AUXSTR+1]
  7484	011546'	251340	017061'		BLT	T2,AUXSTR+AUXSTL-1
  7485
  7486	011547'	256040	017631'	AUXSLP:	XCTFU	<ILDB	T2,T1>	;GET 7-BIT CHAR FROM USER
  7487	011550'	322340	011564'		JUMPE	T2,AXSFN1	;END OF STRING
  7488	011551'	136340	000017		IDPB	T2,P4		;PUT IT AWAY
  7489	011552'	302340	000015		CAIE	T2,15
  7490	011553'	306340	000073		CAIN	T2,";"		;TERMINATE ON RETURN OR ;
  7491	011554'	254000	011566'		 JRST	AXSFIN
  7492	011555'	306340	000072		CAIN	T2,":"		;TERMINATE USER NAME ON :
  7493	011556'	400640	000000		 SETZ	P2,0		;BY ZAPPING COUNT
  7494	011557'	275340	000040		SUBI	T2,40		;CONVERT TO SIXBIT
  7495	011560'	321340	011563'		JUMPL	T2,AUXNSB	;Don't put control chars in username
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 171-2
SCNSER.MAC	25-JAN-91 22:40		CODE TO HANDLE THE CREAT AUX CIR UUO

  7496	011561'	361640	011563'		SOJL	P2,AUXNSB	;ALREADY TOO MANY CHRS IN USER NAME
  7497	011562'	136340	000011		IDPB	T2,T4		;AND SAVE IT
  7498	011563'	367700	011547'	AUXNSB:	SOJG	P3,AUXSLP	;SEE IF ROOM FOR MORE
  7499
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 172
SCNSER.MAC	25-JAN-91 22:40		CODE TO HANDLE THE CREAT AUX CIR UUO

  7500	011564'	201340	000015	AXSFN1:	MOVEI	T2,15
  7501	011565'	136340	000017		IDPB	T2,P4		;TOO MANY, FINISH WITH RETURN
  7502	011566'	201340	000000	AXSFIN:	MOVEI	T2,0
  7503	011567'	136340	000017		IDPB	T2,P4		;TERMINATE STRING WITH 0
  7504	011570'	552740	017062'		HRRZM   P4,AUXEND	;SAVE POINTER TO LAST WORD OF LOGIN STRING
  7505	011571'	550400	000017		HRRZ    T3,P4           ;ZERO OUT LAST WORD OF LOGIN
  7506	011572'	136340	000017		IDPB    T2,P4           ; STRING TO RIGHT OF NULL
  7507	011573'	306417	000000		CAIN    T3,(P4)         ; SO THAT CREAUX STREAM
  7508	011574'	254000	011572'		 JRST	.-2             ; RECORDS LOOK GOOD
  7509	011575'	205340	000400		MOVSI	T2,LICAC
  7510	011576'	612342	011157*		TDNE	T2,JBTLIC(J)	;SEE IF HE HAS LICENSE
  7511	011577'	254000	011615'		 JRST	AUXGAN		;YES, NOW CHECK LIST
  7512	011600'	200340	017076'		MOVE	T2,AUXUNM
  7513	011601'	200400	017077'		MOVE	T3,AUXUNM+1
  7514	011602'	316342	000000*		CAMN	T2,JBTUNM(J)	;CHECK USER NAME MATCH
  7515	011603'	312402	000000*		CAME	T3,JBTUN1(J)
  7516					 JRST	[MOVSI T2,CXLOG%
  7517	011604'	254000	017632'			JRST AXERGV]	;ERROR
  7518	011605'	260040	016110'		PUSHJ	P,FRSTTY	;NOW SEE HOW MANY CIRCUITS
  7519	011606'	254000	011630'		  JRST	AUXLIC
  7520	011607'	260040	016112'		PUSHJ	P,NXTTTY
  7521	011610'	254000	011630'		  JRST	AUXLIC		;NONE
  7522	011611'	260040	016112'		PUSHJ	P,NXTTTY
  7523	011612'	254000	011630'		  JRST	AUXLIC		;ONE
  7524	011613'	205340	000001		MOVSI	T2,CX2AX%
  7525	011614'	254000	011677'		JRST	AXERGV		;ERROR, already have 2 circuits in use
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 173
SCNSER.MAC	25-JAN-91 22:40		CODE TO HANDLE THE CREAT AUX CIR UUO

  7526	011615'	554442	000000*	AUXGAN:	HLRZ	T4,JBTAUN##(J)	; Check gan
  7527	011616'	306440	000003		CAIN	T4,3		;  for lower class
  7528	011617'	254000	011630'		 JRST	AUXLIC		; Yes, it works here
  7529	011620'	120340	017076'		DMOVE	T2,AUXUNM	; Otherwize check list
  7530	011621'	505440	777706		HRLI	T4,-AUXNTL	; * Length is 2x # of entries
  7531	011622'	541440	016513'		HRRI	T4,AUXNTB
  7532	011623'	316351	016513'	AUXGA1:	CAMN	T2,AUXNTB(T4)	; Check user name match
  7533	011624'	316411	016514'		 CAMN	T3,AUXNTB+1(T4)
  7534					  JRST	[MOVSI T2,CXLOG%
  7535	011625'	254000	017632'			JRST AXERGV]	; Give error as if no AC to say
  7536	011626'	253440	011627'		AOBJN	T4,.+1		;  that AC doesn't work on this
  7537	011627'	253440	011623'		AOBJN	T4,AUXGA1	; Check ALL names
  7538								; No match, allow AC license
  7539
  7540	011630'			AUXLIC:
  7541				IFKMC<
  7542	011630'	135400	017634'		LDB	T3,[POINT 2,P1,2]	;GET TYMBASE NUMBER
  7543	011631'	260040	000000*		PUSHJ	P,KMCGUP	;T1/ TYMBASE "UP" BITS
  7544	011632'	205340	000010		MOVSI	T2,^D8		;TYMBASE DOWN MESSAGE
  7545	011633'	256010	011636'		XCT	TSTDRU(T3)	;SKIP IF IT'S UP
  7546	011634'	254000	011677'		  JRST	AXERGV		;ELSE RETURN TYMBASE DOWN MESSAGE
  7547	011635'	254000	011642'		JRST	AUXDRU
  7548
  7549	011636'	626300	000001	TSTDRU:	TRZN	T1,DR1BIT
  7550	011637'	626300	000002		TRZN	T1,DR2BIT
  7551	011640'	626300	000020		TRZN	T1,DR3BIT
  7552	011641'	626300	000200		TRZN	T1,DR4BIT
  7553
  7554	011642'	242400	000006	AUXDRU:	LSH	T3,6		;Request circuit on DR# * 64.
  7555	011643'	436400	017074'		IORM	T3,AUXPRT
  7556				> ; END IFKMC
  7557				IFNKMC<	LDB	T1,[POINT 16,P1,16]	;All but 1B0 and 1B17
  7558					HRLM	T1,AUXPRT	;Store NETID number
  7559					JUMPE	T1,AUXDRU	;OK if asking for default
  7560					MOVSI	T2,^D8		;TYMBASE DOWN = illegal NETID
  7561					MOVSI	T1,LICWCR	;Must have WRITE CORE to build an
  7562					TDNN	T1,JBTLIC(J)	; aux circuit to other net
  7563					 JRST	AXERGV		;(error code 8 means problems with LH of AC)
  7564				AUXDRU: > ;END IFNKMC
  7565	011644'	201300	000000*		MOVEI	T1,MLOWQ
  7566	011645'	137300	011340*		DPB	T1,PJBSTS##
  7567	011646'	350000	017051'		AOS	AUXSTA		;SET STATE TO 1
  7568	011647'	260040	006474*		PUSHJ	P,WSCHED	;AND RESCHEDULE
  7569	011650'	332340	017064'		SKIPE	T2,AUXERR	;ANY ERRORS
  7570	011651'	254000	011677'		 JRST	AXERGV
  7571	011652'	335000	017050'		SKIPGE	AUXRCP	;PORT THERE?
  7572					 JRST	[
  7573						AOS	NRPCNT	;BUMP COUNT
  7574						MOVSI	T2, CXNCH%
  7575						JRST	AXERGV	;ERROR-RETURN
  7576	011653'	254000	017635'		]
  7577	011654'	550302	011522*		HRRZ	T1,TTYTAB(J)	;WHERE TO LINK. REALLY SHOULD BE A DDB
  7578	011655'	332000	000006		SKIPE	T1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 173-2
SCNSER.MAC	25-JAN-91 22:40		CODE TO HANDLE THE CREAT AUX CIR UUO

  7579	011656'	260040	015720'		 PUSHJ	P,DDBSR1
  7580					  JRST	[MOVSI T2,CXDCB%	;NO DDB SPACE
  7581	011657'	254000	017640'			JRST AXERGV]
  7582	011660'	137100	011204*		DPB	J,PJOBN
  7583	011661'	201300	400000		MOVEI	T1,ASSCON
  7584	011662'	603600	000001		TLNE	P1,(1B17)
  7585	011663'	661300	010000		 TLO	T1,DVNZP	;SET NO ZAP BIT
  7586	011664'	436304	000004		IORM	T1,DEVMOD(F)
  7587	011665'	200240	017050'		MOVE	U,AUXRCP
  7588	011666'	135300	000157'		LDB	T1,LDPLNO	;GET LINE NUMBER
  7589	011667'	705312	000000		UMOVEM	T1,(W)
  7590	011670'	542244	000013		HRRM	U,DDBLDB(F)
  7591	011671'	542205	000000		HRRM	F,LDBDDB(U)
  7592	011672'	260040	015764'		PUSHJ	P,SCNNAM
  7593	011673'	201300	000022		MOVEI	T1,22		;WRITE CREAUX
  7594	011674'	260040	000000*		PUSHJ	P,ACTWRT##	; STREAM RECORD
  7595	011675'	350001	000000		AOS	(P)
  7596	011676'	254000	011711'		JRST	AUXGV1		;FINISHED
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 174
SCNSER.MAC	25-JAN-91 22:40		CODE TO HANDLE THE CREAT AUX CIR UUO

  7597	011677'	705352	000000	AXERGV:	UMOVEM	T2,(W)
  7598	011700'	254000	011707'	AXELOG:	JRST	AXGIV		;JFCL IF WANT ACT REC FOR ERRS
  7599	011701'	202340	017064'		MOVEM	T2,AUXERR	;SAVE ERR TYPE FOR ACTSER
  7600	011702'	201300	000022		MOVEI	T1,22		;CREAUX REC TYPE
  7601	011703'	557000	000007		HLRZS	T2		;WRITE REC ONLY
  7602	011704'	332000	000007		SKIPE	T2		; FOR EXTRA
  7603	011705'	306340	000006		CAIN	T2,CXNCH%	; HOST ERRORS
  7604	011706'	260040	011674*		 PUSHJ	P,ACTWRT##
  7605	011707'	331240	017050'	AXGIV:	SKIPL	U,AUXRCP
  7606	011710'	260040	015372'		 PUSHJ	P,TTYZAP
  7607	011711'	402002	011517*	AUXGV1:	SETZM	JBTABT(J)
  7608	011712'	402000	017051'		SETZM	AUXSTA
  7609	011713'	371000	011513*		SOSL	AXREQ
  7610	011714'	476000	000000*		 SETOM	AXAVAL
  7611	011715'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 175
SCNSER.MAC	25-JAN-91 22:40		READ INFO ON PORTS IN USE

  7612				SUBTTL	READ INFO ON PORTS IN USE
  7613
  7614	011716'	201340	000000	AUXRED::MOVEI	T2,0		;NUMBER OF PORTS SO FAR
  7615					JUMPGE	T1,[XCTTU <SETOM (W)>
  7616	011717'	325300	017643'			POPJ P,]	;FLAG ERROR
  7617	011720'	253300	011721'		AOBJN	T1,.+1
  7618	011721'	260040	016110'		PUSHJ	P,FRSTTY	;THIS WILL GET COMMAND PORT
  7619	011722'	254000	011737'		  JRST	AUXRN1		;OH WELL
  7620	011723'	205440	000010		MOVSI	T4,DVTTY	;TO TEST FOR TTY
  7621	011724'	260040	016112'	AUXRL1:	PUSHJ	P,NXTTTY	;NEXT IN CHAIN
  7622	011725'	254000	011737'		   JRST	AUXRN1		;FINISHED
  7623	011726'	616444	000004		TDNN	T4,DEVMOD(F)
  7624	011727'	254000	011724'		 JRST	AUXRL1		;IGNORE ALL BUT TTYS
  7625	011730'	550244	000013		HRRZ	U,DDBLDB(F)	;GET LINE
  7626	011731'	322240	011724'		JUMPE	U,AUXRL1	;IGNORE IF NO LINE
  7627	011732'	325300	011736'		JUMPGE	T1,AUXRL2	;NO ROOM TO PUT IT
  7628	011733'	135400	000157'		LDB	T3,LDPLNO
  7629	011734'	705406	777777		UMOVEM	T3,-1(T1)
  7630	011735'	253300	011736'		AOBJN	T1,.+1
  7631	011736'	344340	011724'	AUXRL2:	AOJA	T2,AUXRL1	;COUNT 1
  7632	011737'	256200	017645'	AUXRN1:	XCTTU	<SETOM -1(T1)>	;FLAG END OF LIST
  7633	011740'	705352	000000		UMOVEM	T2,(W)
  7634	011741'	254000	011412*		JRST	CPOPJ1		;FINISHED
  7635
  7636				;ZAP AUX CIRCUITS
  7637
  7638	011742'	321300	011752'	ZAPCIR::JUMPL	T1,ZAPALL	;ALL OF THEM
  7639	011743'	200200	000006		MOVE	F,T1
  7640	011744'	260040	016312'		PUSHJ	P,FNDPRT	;FIND THE PORT
  7641	011745'	263040	000000		  POPJ	P,		;NOT THERE
  7642	011746'	550244	000013		HRRZ	U,DDBLDB(F)
  7643	011747'	322240	011152*		JUMPE	U,CPOPJ		;NO LINE, IGNORE
  7644	011750'	400300	000000		SETZ	T1,		;Don't cause any confusion
  7645	011751'	254000	006617'		JRST	HNGPRT		;GO HANG HIM
  7646
  7647	011752'	260040	016110'	ZAPALL:	PUSHJ	P,FRSTTY
  7648	011753'	263040	000000		  POPJ	P,		;NOT COMMAND
  7649	011754'	260040	016112'	ZAPAL1:	PUSHJ	P,NXTTTY
  7650	011755'	263040	000000		  POPJ	P,		;DONE
  7651	011756'	205300	000010		MOVSI	T1,DVTTY
  7652	011757'	616304	000004		TDNN	T1,DEVMOD(F)
  7653	011760'	254000	011754'		 JRST	ZAPAL1		;NOT A TTY
  7654	011761'	550244	000013		HRRZ	U,DDBLDB(F)
  7655	011762'	322240	011754'		JUMPE	U,ZAPAL1
  7656	011763'	400300	000000		SETZ	T1,
  7657	011764'	260040	006617'		PUSHJ	P,HNGPRT
  7658	011765'	254000	011754'		JRST	ZAPAL1		;ON TO NEXT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 176
SCNSER.MAC	25-JAN-91 22:40		POLL PORTS UUO

  7659				SUBTTL  POLL PORTS UUO
  7660
  7661				; POLPRT - POLL PORTS FOR INTERRUPT-CAUSING EVENTS
  7662				;
  7663				;	MOVE	AC, [BITS,,ADDR]
  7664				;	POLPRT	AC,
  7665				;	  ERROR RETURN (TABLE TOO SMALL)
  7666				;	NORMAL RETURN
  7667				;
  7668				;	(AC/ # OF PORTS RETURNED ON EITHER RETURN)
  7669				;
  7670				; ADDR:	WORD COUNT (# WORDS, INCLUDING THIS ONE)
  7671				;	BITS,,PORT (SET BY UUO)
  7672				;	...
  7673				;
  7674				; WHERE <BITS> IS A MASK FOR THE EVENT BITS IN RH(LDBDCX)
  7675
  7676	011766'	256200	017646'	POLPRT::XCTFU	<MOVN T2, (T1)>
  7677	011767'	207000	000007		MOVSS	T2
  7678	011770'	540340	000006		HRR	T2, T1		; T2/ AOBJN POINTER
  7679	011771'	400440	000000		SETZ	T4,		; T4/ COUNT OF PORTS RETURNED
  7680	011772'	260040	016110'		PUSHJ	P, FRSTTY
  7681	011773'	254000	012014'		  JRST POLPT4
  7682
  7683					; GOT A PORT
  7684	011774'	200404	000004	POLPT1:	MOVE	T3, DEVMOD(F)
  7685	011775'	603400	000010		TLNE	T3, DVTTY
  7686	011776'	336244	000013		SKIPN	U, DDBLDB(F)
  7687	011777'	254000	012011'		JRST	POLPT3		; NOT TTY OR NO LDB
  7688
  7689					; CHECK THE EVENTS FOR THIS PORT
  7690	012000'	554400	000006		HLRZ	T3, T1		; T3/ 0,,MASK BITS
  7691	012001'	404405	000032		AND	T3, LDBDCX(U)	; T3/ 0,,MASKED EVENTS
  7692	012002'	412405	000032		ANDCAM	T3, LDBDCX(U)	; TURN OFF WHAT WE'VE READ
  7693	012003'	322400	012011'		JUMPE	T3, POLPT3	; NOTHING HAPPENED: TRY NEXT PT
  7694	012004'	252340	012015'		AOBJP	T2, POLPT5	; NO ROOM: ERROR-RETURN
  7695	012005'	350000	000011		AOS	T4		; T4/ COUNT OF PORTS RETURNED
  7696	012006'	256200	017647'		XCTBU	<HRLM T3, (T2)>	; STORE THE EVENT BITS
  7697	012007'	135400	000157'		LDB	T3, LDPLNO
  7698	012010'	256200	017650'		XCTBU	<HRRM T3, (T2)>	; AND THE PORT NUMBER
  7699
  7700					; GET ANOTHER PORT
  7701	012011'	260040	016112'	POLPT3:	PUSHJ	P, NXTTTY
  7702	012012'	254000	012014'		  JRST POLPT4
  7703	012013'	254000	011774'		JRST	POLPT1
  7704	012014'	350001	000000	POLPT4:	AOS	(P)		; NORMAL RETURN: PORTS EXHAUSTED
  7705	012015'	705452	000000	POLPT5:	UMOVEM	T4, (W)		; AC := COUNT OF PORTS RETURNED
  7706	012016'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 177
SCNSER.MAC	25-JAN-91 22:40		BLOCK INPUT/OUTPUT (BIO) ROUTINES

  7707				SUBTTL BLOCK INPUT/OUTPUT (BIO) ROUTINES
  7708
  7709				;THE FORMAT OF A BLOCK I/O BUFFER IS:
  7710
  7711			000000	BIOLNK==0	;PTR TO LINKED LIST OF BIO BUFFERS.
  7712			000001	BIOCSH==1	;CACHE SWEEP NUMBER AT TIME REQUEST WAS QUEUED.
  7713			000002	BIOPBP==2	;PTY BLOCK I/O: ILDB/IDPB POINTER FOR NEXT BYTE
  7714			000003	BIOPBC==3	;PTY BLOCK I/O: # BYTES LEFT TO TRANSFER
  7715			000004	BIOREQ==4	;CHAR COUNT OF LAST INPUT REQUEST BY THIS PORT.
  7716			000005	BIOCHR==5	;COUNT OF CHARACTERS TO TRANSFER. (IN OR OUT).
  7717			000006	BIODAT==6	;BEGINNING OF USER DATA.
  7718
  7719				;HERE FROM ENABLE BLOCK I/O AUXCAL
  7720
  7721	012017'	205300	001000	BLKIO:	MOVSI	T1,LMLBIO
  7722	012020'	612305	000030		TDNE	T1,LDBMOD(U)	;IF ALREADY IN BLOCK MODE,
  7723	012021'	263040	000000		 POPJ	P,		;  ERROR-RETURN
  7724	012022'	336405	000005		SKIPN	T3,LDBBIO(U)	;DOES THE BIO PORT HAVE ANY
  7725	012023'	254000	012036'		 JRST	BLKIO2		;ACTIVE BUFFERS?
  7726	012024'	554300	000010		HLRZ	T1,T3		;YES.  OUTPUT ACTIVE?
  7727	012025'	322300	012031'		JUMPE	T1,BLKIO1	;NO - GO CHECK FOR INPUT.
  7728	012026'	260040	013053'		PUSHJ	P,OQUEUE	;YES. QUEUE JOB UNTIL DONE.
  7729	012027'	263040	000000		  POPJ	P,		;LINE IS GONE.  HE LOSES.
  7730	012030'	254000	012017'		JRST BLKIO
  7731
  7732	012031'	550300	000010	BLKIO1:	HRRZ	T1,T3		;INPUT BUFFER ACTIVE?
  7733	012032'	332000	000006		SKIPE	T1		;
  7734	012033'	260040	013044'		 PUSHJ	P,IQUEUE	;YES. WAIT FOR CH7 TO RELEASE IT
  7735	012034'	263040	000000		  POPJ P,		;NO.  DON'T WORRY ABOUT IT.
  7736	012035'	254000	012017'		JRST BLKIO
  7737
  7738				;HERE IF NO ACTIVE BUFFERS
  7739	012036'	260040	012314'	BLKIO2:	PUSHJ	P,INCBC		;SET UP FOR 1 MORE JOB. IF CAN'T,
  7740	012037'	263040	000000		  POPJ	P,		;  NONSKIP-RETURN
  7741	012040'	205300	001000		MOVSI	T1,LMLBIO	;SET FLAG IN THE LDB INDICATING
  7742	012041'	436305	000030		IORM	T1,LDBMOD(U)	;PORT IS IN BIO MODE.
  7743	012042'	350001	000000		AOS	(P)		;MADE IT!  SKIP RETURN TO USER
  7744	012043'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 178
SCNSER.MAC	25-JAN-91 22:40		BLKXIO - HERE FROM THE LEAVE BLOCK MODE AUXCAL

  7745				SUBTTL	BLKXIO - HERE FROM THE LEAVE BLOCK MODE AUXCAL
  7746
  7747	012044'	200305	000030	BLKXIO:	MOVE	T1,LDBMOD(U)
  7748	012045'	607300	001000		TLNN	T1,LMLBIO	;IF PORT'S NOT IN BLOCK MODE,
  7749	012046'	263040	000000		 POPJ	P,		;  JUST RETURN
  7750	012047'	336405	000005		SKIPN	T3,LDBBIO(U)	;IF THERE'S NOTHING IN PROGRESS,
  7751	012050'	254000	012104'		 JRST	BIORES		;  GET OUT NOW
  7752	012051'	554300	000010		HLRZ	T1,T3
  7753	012052'	322300	012056'		JUMPE	T1,BLKX1	;IF THERE'S OUTPUT IN PROGRESS,
  7754	012053'	260040	013053'		PUSHJ	P,OQUEUE	;  WAIT FOR IT. IF ZAPPED,
  7755	012054'	263040	000000		  POPJ	P,		;    JUST RETURN
  7756	012055'	254000	012044'		JRST	BLKXIO
  7757
  7758				    ;HERE FROM BLKXIO AND BIOREL - TERMINATE/DISCARD CURRENT BLK INPUT
  7759
  7760	012056'	550300	000010	BLKX1:	HRRZ	T1,T3
  7761	012057'	322300	012064'		JUMPE	T1,BLKX2	;IF THERE'S INPUT IN PROGRESS,
  7762	012060'	260040	013071'		PUSHJ	P,BLKXIN	;  REQUEST INPUT TERMINATION
  7763	012061'	550305	000005		HRRZ	T1,LDBBIO(U)
  7764	012062'	331006	000005		SKIPL	BIOCHR(T1)	;  IF THE BASE IS DONE WITH THE BUFFER,
  7765	012063'	260040	012366'		 PUSHJ	P,RELBI		;    THROW IT AWAY NOW
  7766	012064'	336005	000005	BLKX2:	SKIPN	LDBBIO(U)	;IF NO BUFFERS,
  7767	012065'	324740	012104'		 PJRST	BIORES		;  GET OUT NOW
  7768	012066'	205300	001000		MOVSI	T1,LMLBIO
  7769	012067'	412305	000030		ANDCAM	T1,LDBMOD(U)	;ELSE, CLEAR THE BLOCK MODE BIT
  7770	012070'	263040	000000		POPJ	P,		;  CH7 WILL DO THE REST
  7771
  7772				;BIOREL - HERE FROM RESET UUO FOR EACH PORT IN BLOCK MODE
  7773				;	   TERMINATE BLOCK INPUT AND OUTPUT
  7774
  7775	012071'	336405	000005	BIOREL:	SKIPN	T3,LDBBIO(U)	;IF NO ACTIVE I OR O,
  7776	012072'	324740	012104'		 PJRST	BIORES		;  GET OUT NOW
  7777	012073'	554300	000010		HLRZ	T1,T3
  7778	012074'	322300	012056'		JUMPE	T1,BLKX1	;IF OUTPUT ACTIVE,
  7779	012075'	260040	013117'		PUSHJ	P,BLKXOT	;  REQUEST OUTPUT TERMINATION
  7780	012076'	254000	012056'		JRST	BLKX1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 179
SCNSER.MAC	25-JAN-91 22:40		BIOZAP - CALLED WHEN A CIRCUIT IN BLOCK MODE IS ZAPPED

  7781				SUBTTL	BIOZAP - CALLED WHEN A CIRCUIT IN BLOCK MODE IS ZAPPED
  7782
  7783	012077'	205300	400000	BIOZAP:	MOVSI	T1,LMLTBI
  7784	012100'	412305	000030		ANDCAM	T1,LDBMOD(U)	;CLEAR "TERMINATE PENDING" FLAG
  7785	012101'	137300	000065'		DPB	T1,LOPBOP	;Clear PTY "Block-output-in-progress"
  7786	012102'	260040	012366'		PUSHJ	P,RELBI		;MUST BE DONE WITH INPUT
  7787	012103'	260040	012372'		PUSHJ	P,RELBO		;MUST BE DONE WITH OUTPUT
  7788					PFALL	BIORES		;MUST BE DONE WITH BLOCK I/O
  7789
  7790				;BIORES - CLEAR BLKIO BIT AND FLAG NEGOTIATOR THAT WE'RE DONE
  7791
  7792	012104'	205300	001000	BIORES:	MOVSI	T1,LMLBIO	;TAKE PORT OUT OF BLKIO MODE
  7793	012105'	412305	000030		ANDCAM	T1,LDBMOD(U)	;
  7794	012106'	324740	012326'		PJRST	DECBC		;ONE FEWER PORT DOING BLOCK I/O
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 180
SCNSER.MAC	25-JAN-91 22:40		BLKINP - BLOCK INPUT-AND-WAIT AUXCAL

  7795				SUBTTL	 BLKINP - BLOCK INPUT-AND-WAIT AUXCAL
  7796
  7797	012107'	260040	012140'	BLKINP:	PUSHJ	P,BIOCHK	; EVERYTHING OK?
  7798	012110'	263040	000000		  POPJ	P,		; NO
  7799	012111'	550305	000005		HRRZ	T1,LDBBIO(U)	; T1/ INPUT BUFFER ADDRESS
  7800					JUMPE	T1,[		; NO INPUT BUFFER
  7801						TLNE	S,IOEND		; IOEND SET?
  7802						 JRST	BLKEOF		; RETURN EOF
  7803						MOVE	T2,LDBMOD(U)
  7804						TLNE	T2,LMLTBI	; TERMINATE PENDING?
  7805						 JRST	BLKIP1		; WAIT FOR IT
  7806						PUSHJ	P,REQBUF	; GET BUF & REQ. INPUT
  7807						  POPJ	P,		; FAILED (PORT ZAPPED)
  7808						JRST	BLKIP1		; MADE REQ.: NOW WAIT
  7809	012112'	322300	017651'		]
  7810	012113'	200346	000005		MOVE	T2,BIOCHR(T1)	; T2/ IN-PROGRESS FLAG,,COUNT
  7811	012114'	321340	012120'		JUMPL	T2,BLKIP1	; IN-PROGRESS: WAIT FOR IT
  7812	012115'	260040	012150'		PUSHJ	P,GOTBUF	; COMPLETE: TRANSFER DATA
  7813	012116'	255000	000000		  JFCL			; COUNT=0
  7814	012117'	254000	011741*		JRST	CPOPJ1		; OR COUNT .gt. 0: SKIP-RETURN
  7815
  7816				    ; HERE TO WAIT FOR "BLOCK INPUT TERMINATED" MESSAGE
  7817				    ; OF SOME SORT
  7818
  7819	012120'	260040	013044'	BLKIP1:	PUSHJ	P,IQUEUE
  7820	012121'	263040	000000		  POPJ	P,		; PORT GONE
  7821	012122'	254000	012107'		JRST	BLKINP		; RETRY
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 181
SCNSER.MAC	25-JAN-91 22:40		BLKINS - BLOCK INPUT-AND-SKIP AUXCAL

  7822				SUBTTL	 BLKINS - BLOCK INPUT-AND-SKIP AUXCAL
  7823
  7824	012123'	260040	012140'	BLKINS:	PUSHJ	P,BIOCHK	; EVERYTHING OK?
  7825	012124'	263040	000000		  POPJ	P,		; NO
  7826	012125'	550305	000005		HRRZ	T1,LDBBIO(U)	; T1/ INPUT BUFFER ADDRESS
  7827					JUMPE	T1,[		; NO INPUT BUFFER
  7828						TLNE	S,IOEND		; IOEND SET?
  7829						 JRST	BLKEOF		; RETURN EOF
  7830						MOVE	T2,LDBMOD(U)
  7831						TLNE	T2,LMLTBI	; TERMINATE PENDING?
  7832						 POPJ	P,		; NONSKIP-RETURN
  7833						PUSHJ	P,REQBUF	; GET BUF & REQ. INPUT
  7834						  POPJ	P,		; FAILED (PORT ZAPPED)
  7835						POPJ	P,		; MADE REQ.: NOW RETURN
  7836	012126'	322300	017661'		]
  7837	012127'	200346	000005		MOVE	T2,BIOCHR(T1)	; T2/ IN-PROGRESS FLAG,,COUNT
  7838	012130'	321340	011747*		JUMPL	T2,CPOPJ	; IN-PROGRESS: NONSKIP-RETURN
  7839	012131'	260040	012150'		PUSHJ	P,GOTBUF	; INPUT COMPLETE: TRANSFER DATA
  7840	012132'	263040	000000		  POPJ	P,		; COUNT=0: NONSKIP-RETURN
  7841	012133'	254000	012117*		JRST	CPOPJ1		; COUNT.gt.0: SKIP-RETURN
  7842
  7843				; BLKEOF - COMMON CODE TO SET IO.END
  7844				;	    FOR BLOCK INPUT AUXCALS
  7845
  7846	012134'	430000	017671'	BLKEOF:	XOR	S,[IOEND,,IODEND]
  7847	012135'	202004	000002		MOVEM	S,DEVIOS(F)	; SET IO.EOF, CLEAR IOEND
  7848	012136'	350001	000000		AOS	(P)
  7849	012137'	324740	012366'		PJRST	RELBI		; DONE WITH INPUT BUFFER
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 182
SCNSER.MAC	25-JAN-91 22:40		BIOCHK - COMMON SETUP CODE FOR BLOCK INPUT AUXCALS

  7850				SUBTTL	 BIOCHK - COMMON SETUP CODE FOR BLOCK INPUT AUXCALS
  7851
  7852	012140'	200305	000030	BIOCHK:	MOVE	T1,LDBMOD(U)
  7853	012141'	607300	001000		TLNN	T1,LMLBIO	; BLOCK I/O ENABLED?
  7854	012142'	263040	000000		 POPJ	P,		; NO -- FAIL
  7855	012143'	602000	020000		TRNE	S,IODEND	; IO.EOF SET?
  7856	012144'	263040	000000		 POPJ	P,		; YES -- FAIL
  7857	012145'	260040	014015'		PUSHJ	P,BPXOFF	; IS THIS NECESSARY?
  7858	012146'	260040	010777*		NOCHARGE		; TURN OFF THE CLOCK
  7859	012147'	254000	012133*		JRST	CPOPJ1		; SUCCEED
  7860
  7861				; GOTBUF - COMMON BUFFER-TRANSFER CODE FOR BLOCK INPUT AUXCALS
  7862				;	    ENTER WITH T1/ INPUT BUFFER ADDRESS
  7863				;		       T2/ CHARACTER COUNT
  7864
  7865	012150'			GOTBUF:
  7866	012150'	261040	000014		PUSH	P,P1		;Needed in one irritating place
  7867	012151'	261040	000007		PUSH	P,T2		; SAVE CHARACTER COUNT
  7868	012152'	272342	000000*		ADDM	T2,JBTBIO(J)	; CHARGE JOB FOR CHARACTERS
  7869	012153'	272340	012152*		ADDM	T2,JBTBIO	; RECORD TOTAL CHARACTERS
  7870	012154'	271340	000003		ADDI	T2,3
  7871	012155'	242340	777776		LSH	T2,-2		; T2/ # OF WORDS
  7872	012156'	505406	000005		HRLI	T3,BIOCHR(T1)	; T3/ START OF MON DATA,,
  7873	012157'	540400	000013		HRR	T3,M		; T3/ ",,START OF USER BUFFER
  7874				IFNKMC<
  7875					ADDI	T2,(T3)		; T2/ STOP LOCATION
  7876					XCTTU <BLT T3,(T2)>	; TRANSFER THE COUNT&DATA
  7877				>;END IFNKMC
  7878				IFKMC<
  7879					;T2/# OF WORDS
  7880					;T3/MONITOR BUFFER,,USER BUFFER
  7881	012160'	261040	000006		PUSH	P,T1		;SAVE T1
  7882	012161'	261040	000011		PUSH	P,T4		;TO HOLD DESTINATION BYTEPOINTER
  7883	012162'	242340	000001		LSH	T2,1		;T2/# OF HALF WORDS
  7884	012163'	550440	000010		HRRZ	T4,T3		;T4/0,,USER BUFFER
  7885	012164'	554400	000010		HLRZ	T3,T3		;T3/0,,MONITOR BUFFER
  7886	012165'	200310	000000		MOVE	T1,(T3)		;GET FIRST WORD FOR USER BUFFER
  7887	012166'	256200	017672'		XCT 4,[MOVEM T1,(T4)]	;PUT IT IN USER BUF
  7888	012167'	271440	000001		ADDI	T4,1
  7889	012170'	271400	000001		ADDI	T3,1
  7890	012171'	505400	442200		HRLI	T3,(POINT 18,0)	;PACK HALFWORD BYTES INTO
  7891	012172'	505440	442000		HRLI	T4,(POINT 16,0)	;	FULLWORD BYTES
  7892	012173'	134300	000010	GBXLUP:	ILDB	T1,T3		;GET MONITOR HALF WORD
  7893	012174'	256040	017673'		XCT	1,[IDPB T1,T4]	;PUT TWO BYTES IN USER BUF
  7894	012175'	367340	012173'		SOJG	T2,GBXLUP
  7895	012176'	262040	000011		POP	P,T4		;RESTORE THEM REGISTERS
  7896	012177'	262040	000006		POP	P,T1		;RESTORE T1
  7897				>;END IFKMC
  7898	012200'	200345	000030		MOVE	T2,LDBMOD(U)
  7899	012201'	607340	400000		TLNN	T2,LMLTBI	; TERMINATE-INPUT PENDING?
  7900	012202'	603000	000040		TLNE	S,IOEND		; IOEND SET?
  7901					 JRST	[
  7902						PUSHJ	P,RELBI		; DONE WITH INPUT BUFFER
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 182-2
SCNSER.MAC	25-JAN-91 22:40		BIOCHK - COMMON SETUP CODE FOR BLOCK INPUT AUXCALS

  7903						JRST	GOTBF1		; GO FINISH UP
  7904	012203'	254000	017674'		]
  7905	012204'	260040	012400'		PUSHJ	P,KEPBI		; IF SOMEONE ELSE WANTS A BUFFER,
  7906	012205'	334000	000000		  SKIPA			;By all means let 'em have it
  7907	012206'	254000	012214'		 JRST	GOTBF0		;No competition
  7908	012207'	200606	000004		MOVE	P1,BIOREQ(T1)	;Save count in a safe place (!)
  7909	012210'	260040	012366'		PUSHJ	P,RELBI		;Give up the buffer/port
  7910	012211'	260040	012356'		PUSHJ	P,GETBI		;Get a new one
  7911	012212'	254000	012216'		  JRST	GOTBF1		;Not needed...
  7912	012213'	202606	000004		MOVEM	P1,BIOREQ(T1)	;Set count in new buffer
  7913	012214'			GOTBF0:
  7914	012214'	200346	000004		MOVE	T2,BIOREQ(T1)	; T2/ OLD REQUEST COUNT
  7915	012215'	260040	012232'		PUSHJ	P,BLKIRQ	; REQUEST INPUT
  7916	012216'	262040	000006	GOTBF1:	POP	P,T1		; T1/ COUNT BLT'ED
  7917	012217'	262040	000014		POP	P,P1		;Remember him?
  7918	012220'	326300	012147*		JUMPN	T1,CPOPJ1	; SKIP IF .GT. 0
  7919	012221'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 183
SCNSER.MAC	25-JAN-91 22:40		REQBUF - ALLOCATE A BUFFER FOR BLOCK INPUT

  7920				SUBTTL	 REQBUF - ALLOCATE A BUFFER FOR BLOCK INPUT
  7921				;	    STORE ITS ADDRESS IN RH(LDBBIO(U))
  7922				;	    SAVE THE USER'S BYTE COUNT IN BIOREQ(RH(LDBBIO(U)))
  7923				;	    AND SEND AN INPUT REQUEST
  7924				;	    SKIP-RETURN NORMALLY
  7925				;	    NONSKIP-RETURN IF ZAPPED WHILE IN "EXTRA" WAIT
  7926
  7927	012222'	260040	012356'	REQBUF:	PUSHJ	P,GETBI		; SET UP FOR BLOCK INPUT
  7928	012223'	263040	000000		  POPJ	P,		; FAILED (ZAPPED)
  7929
  7930					; SUCCEEDED: T1/ INPUT BUFFER ADDRESS
  7931
  7932	012224'	256200	017676'		XCTFU <HRRZ T2, (M)>	; T2/ USER'S BYTE COUNT
  7933	012225'	303340	000620		CAILE	T2, ^D400
  7934	012226'	201340	000620		MOVEI	T2, ^D400	; T2/ USER'S COUNT .MIN. 400
  7935	012227'	202346	000004		MOVEM	T2, BIOREQ(T1)	; SAVE FOR READAHEAD CODE
  7936	012230'	350001	000000		AOS	(P)		; PREPARE FOR SKIP-RETURN
  7937	012231'	324740	012232'		PJRST	BLKIRQ		; REQUEST INPUT
  7938
  7939				; BLKIRQ - REQUEST BLOCK INPUT
  7940				;	    ENTER WITH T1/ BUFFER ADDRESS
  7941				;		       T2/ CHARACTER COUNT
  7942
  7943	012232'			BLKIRQ:
  7944				IFCPU (KL),<
  7945					MOVE	T3,CSUCNT##	;WHEN I/O STARTS, SWEEP NUMBER
  7946								;MUST BE DIFFERENT THAN THIS.
  7947					MOVEM	T3,BIOCSH(T1)>
  7948	012232'	200405	000030		MOVE	T3,LDBMOD(U)
  7949	012233'	603400	400000		TLNE	T3,LMLTBI	; TERMINATE PENDING?
  7950	012234'	256000	000000'		 STOPCD			; IMPOSSIBLE!
  7951	012235'	562346	000005		HRROM	T2,BIOCHR(T1)	; IN-PROG := -1, COUNT := T2.RH
  7952	012236'	201300	000001		MOVEI	T1,1
  7953	012237'	137300	000061'		DPB	T1,LOPBIN	;SET BLOCK INPUT
  7954	012240'	137305	000002		DPB	T1,LDBOPB(U)	;AND NEED-OUTPUT
  7955	012241'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 184
SCNSER.MAC	25-JAN-91 22:40		BLKOUT - HERE FROM BLOCK OUTPUT AUXCAL.  SKIPS ON SUCCESS.

  7956				SUBTTL	BLKOUT - HERE FROM BLOCK OUTPUT AUXCAL.  SKIPS ON SUCCESS.
  7957
  7958	012242'	200305	000030	BLKOUT:	MOVE T1,LDBMOD(U)	;TEST TO SEE IF BLOCK I/O
  7959	012243'	607300	001000		TLNN T1,LMLBIO		;MODE HAS BEEN SET.
  7960	012244'	263040	000000		 POPJ P,		;ERROR RETURN IF NOT.
  7961	012245'	260040	012146*		NOCHARGE		;TURN OFF THE CLOCK.
  7962	012246'	554305	000005		HLRZ T1,LDBBIO(U)	;IS THERE A BLOCK OUTPUT
  7963	012247'	322300	012253'		JUMPE T1,BLKOT1		; ALREADY IN PROGRESS?
  7964	012250'	260040	013053'		PUSHJ P,OQUEUE		;I/O WAIT OR INTERRUPT
  7965	012251'	263040	000000		 POPJ P,		;NO.  ERROR RETURN TO THE USER.
  7966	012252'	254000	012242'		JRST BLKOUT		;MAKE SURE BUFFER WAS RELEASED.
  7967	012253'	260040	012362'	BLKOT1:	PUSHJ	P, GETBO	;SET UP FOR BLOCK OUTPUT
  7968	012254'	263040	000000		  POPJ	P,		;  ZAPPED
  7969	012255'	256200	017676'		XCTBU <HRRZ T2,(M)>	;GET USER'S WORD COUNT
  7970	012256'	307340	000620		CAIG	T2,^D400	;IF < 0 OR > 400
  7971	012257'	336000	000007		SKIPN	T2		;OR = 0
  7972	012260'	324740	012372'		 PJRST	RELBO		;  GET OUT AND ERROR-RETURN
  7973	012261'	303340	000120		CAILE T2,^D80		;MIN. NO. OF CHARS FOR CHARGING
  7974	012262'	334400	000007		 SKIPA T3,T2		;PURPOSES IS EIGHTY.
  7975	012263'	201400	000120		MOVEI T3,^D80
  7976	012264'	272402	012153*		ADDM T3,JBTBIO(J)	;ADD TO BIO CHRS XFER'D FOR JOB.
  7977	012265'	272400	012264*		ADDM T3,JBTBIO		;ADD TO TOTAL BIO CHARS XFERRED.
  7978	012266'	271340	000003		ADDI T2,3
  7979	012267'	242340	777776		LSH T2,-2
  7980	012270'	256200	017677'		XCTBU <MOVSI T3,(M)>	;GET ADDRESS OF USER BUFFER
  7981	012271'	541406	000005		HRRI T3,BIOCHR(T1)	;PREPARE FOR BLT TO MONITOR
  7982				IFNKMC<
  7983					ADDI T2,BIOCHR(T1)	;ADD IN BASE LOC FOR XFER
  7984					XCTFU <BLT T3,(T2)>	;BUFFER.
  7985				IFCPU (KL),<
  7986					MOVE	T2,CSVCNT##	;MUST DO ONE VALIDATE BEFORE CAN START
  7987					MOVEM	T2,BIOCSH(T1)>	;I/O.
  7988				>;END IFNKMC
  7989				IFKMC<
  7990					;T2/# OF WORDS
  7991					;T3/USER BUFFER,,MONITOR BUFFER
  7992	012272'	261040	000011		PUSH	P,T4		;TO HOLD DESTINATION BYTEPOINTER
  7993	012273'	242340	000001		LSH	T2,1		;T2/# OF HALF WORDS
  7994	012274'	550440	000010		HRRZ	T4,T3		;T4/0,,MONITOR BUFFER
  7995	012275'	554400	000010		HLRZ	T3,T3		;T3/0,,USER BUFFER
  7996	012276'	256200	017700'		XCT	4,[MOVE T1,(T3)]	;GET FIRST WORD OF USER BUFFER
  7997	012277'	202311	000000		MOVEM	T1,(T4)		;PUT IT IN MON BUF
  7998	012300'	271440	000001		ADDI T4,1
  7999	012301'	271400	000001		ADDI T3,1
  8000	012302'	505400	442000		HRLI	T3,(POINT 16,0)	;UNPACK FULLWORD BYTES INTO
  8001	012303'	505440	442200		HRLI	T4,(POINT 18,0)	;		HALFWORD BYTES
  8002	012304'	256040	017701'	XCTLUP:	XCT 1,[ILDB T1,T3]	;GET TW0 USER BYTES
  8003	012305'	136300	000011		IDPB	T1,T4
  8004	012306'	367340	012304'		SOJG	T2,XCTLUP
  8005	012307'	262040	000011		POP	P,T4		;RESTORE THEM REGISTERS
  8006				>;END IFKMC
  8007	012310'	201300	000001		MOVEI T1,1
  8008	012311'	137300	000076'		DPB T1,LOPBOT		;SET BLOCK OUTPUT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 184-2
SCNSER.MAC	25-JAN-91 22:40		BLKOUT - HERE FROM BLOCK OUTPUT AUXCAL.  SKIPS ON SUCCESS.

  8009	012312'	137305	000002		DPB T1,LDBOPB(U)	;AND NEED-OUTPUT
  8010	012313'	254000	012220*		JRST CPOPJ1		;AND SUCCESS-RETURN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 185
SCNSER.MAC	25-JAN-91 22:40		BLKOUT - HERE FROM BLOCK OUTPUT AUXCAL.  SKIPS ON SUCCESS.

  8011				COMMENT %
  8012
  8013				There are (presently) three block i/o mechanisms, one for
  8014				620 bases, one for PTYs, and one, as yet uncoded, for Nexilis
  8015				bases. For the sake of everyone's sanity, there must be a
  8016				level in the block i/o code at which the distinction between
  8017				these three becomes invisible.
  8018
  8019				In particular, the UUOs should use only the following routines,
  8020				which will acquire and release the appropriate resources
  8021				regardless of the mechanism being used:
  8022
  8023					GETBI	sets up a port to do block input
  8024					RELBI	called when a port's done with block input
  8025					KEPBI	skips if it's ok for this port to keep
  8026						its block-input resources; if it nonskips,
  8027						caller should do a RELBI/GETBI sequence
  8028					GETBO	sets up a port for block output
  8029					RELBO	called when a port's done with block output
  8030					INCBC	enables the block i/o mechanism for 1 more
  8031						job (1 more PDP10 port), and skip-returns
  8032						if 1 more is ok
  8033					DECBC	called when a port is disabled for block i/o
  8034
  8035				%
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 186
SCNSER.MAC	25-JAN-91 22:40		INCBC - CALLED WHEN 1 MORE PORT IS TO BE ENABLED FOR BLOCK I/O

  8036				SUBTTL	INCBC - CALLED WHEN 1 MORE PORT IS TO BE ENABLED FOR BLOCK I/O
  8037				;	  SKIP-RETURNS IF 1 MORE IS OK
  8038				;	  CALLED WITH U/ LDB ADDR, J/ JOB #
  8039
  8040	012314'	500245	000031	INCBC:	HLL	U, LDBDCH(U)
  8041	012315'	603240	040000		TLNE	U, LDLPTY	;IF IT'S A PTY,
  8042	012316'	254000	012324'		JRST	INCPBC		;  THINGS ARE SIMPLER
  8043
  8044				    ;HERE FOR REAL TTYS
  8045
  8046	012317'	260040	012245*		NOCHARGE		;TURN OFF THE CLOCK.
  8047				IFCPU (<KI,KL>), <
  8048					AOSE	AXREQ		;INC REQUEST COUNT FOR AUX QUEUE
  8049					 PUSHJ	P,AXWAIT	;QUEUE JOB IF REQ IN PROGRESS
  8050					AOS	BIOCNT+0	;INCREMENT COUNT OF BIO JOBS
  8051					HRROS	BIOCNT+0	;FLAG FOR CH7 TO SEND REQUEST.
  8052					MOVEM	J,BIOJOB	;BIOJOB_JOB NO W REQ IN PROGRESS
  8053					MOVEI	T1,MLOWQ	;PLACE THIS JOB IN THE ML QUEUE
  8054					DPB	T1,PJBSTS##	;AND WAIT UNTIL AN ANSWER IS
  8055					PUSHJ	P,WSCHED	;RECEIVED FROM THE BASE.
  8056					SKIPLE	BIOPRT		;IF THERE'S AT LEAST ONE SLOT,
  8057					 AOS	(P)		;  SET TO SKIP-RETURN
  8058					SOSL	AXREQ
  8059					 SETOM	AXAVAL
  8060					POPJ	P,
  8061				> ;END IFCPU (<KI,KL>)
  8062				IFNCPU (<KI,KL>), <
  8063	012320'	350000	017101'		AOS	BIOCNT		;ONE MORE BIO JOB
  8064	012321'	371000	000000*		SOSL	BPREQ		;AND ONE MORE BUFFER
  8065	012322'	476000	000000*		 SETOM	BPAVAL		;ACTIVATE JOB WAITING FOR A BUFFER
  8066	012323'	254000	012313*		JRST	CPOPJ1
  8067				> ;END IFNCPU (<KI,KL>)
  8068
  8069				    ;HERE FOR PTYS
  8070
  8071	012324'	350000	017102'	INCPBC:	AOS	BIOCNT+1	;1 MORE BLOCK-MODE PTY
  8072	012325'	254000	012323*		JRST	CPOPJ1		;SKIP-RETURN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 187
SCNSER.MAC	25-JAN-91 22:40		DECBC - CALLED WHEN A PORT HAS BEEN DISABLED FOR BLOCK I/O

  8073				SUBTTL	DECBC - CALLED WHEN A PORT HAS BEEN DISABLED FOR BLOCK I/O
  8074				;	  AND ALL BLOCK I/O ACTIVITY FOR IT HAS STOPPED
  8075				;	  CALLED WITH U/ LDB ADDR
  8076
  8077	012326'	500245	000031	DECBC:	HLL	U,LDBDCH(U)
  8078	012327'	603240	040000		TLNE	U,LDLPTY	;IF IT'S A PTY,
  8079	012330'	254000	012340'		 JRST	DECPBC		;  THINGS ARE A BIT EASIER
  8080
  8081				    ;HERE FOR A REAL TTY
  8082
  8083	012331'	570300	017101'		HRRE	T1,BIOCNT+0	;T1/ REAL TTY BLOCK I/O USER COUNT
  8084	012332'	365300	012334'		SOJGE	T1,.+2
  8085	012333'	256000	017702'		 STOPCD (CPOPJ,INFO,TTYBCN,,<Block I/O count negative>);;DECBC+5
  8086				IFCPU (<KI,KL>), <
  8087					HRROM	T1,BIOCNT+0	;BIOCNT+0/ "CHANGED",,NEW COUNT
  8088				> ;END IFCPU (<KI,KL>)
  8089				IFNCPU (<KI,KL>), <
  8090	012334'	202300	017101'		MOVEM	T1,BIOCNT+0	;ONE LESS BIO JOB
  8091	012335'	350000	012321*		AOS	BPREQ		;ONE LESS BUFFER
  8092				> ;END IFNCPU (<KI,KL>)
  8093	012336'	270300	017102'		ADD	T1,BIOCNT+1	;T1/ TOTAL BLOCK USER COUNT
  8094	012337'	254000	012344'		JRST	DECBC1
  8095
  8096				    ;HERE FOR A PTY
  8097
  8098	012340'	375300	017102'	DECPBC:	SOSGE	T1,BIOCNT+1	;T1/ PTY BLOCK USER COUNT
  8099	012341'	256000	012333'		 STOPCD (,XCT,TTYBCN)
  8100	012342'	570340	017101'		HRRE	T2,BIOCNT+0
  8101	012343'	270300	000007		ADD	T1,T2		;T1/ TOTAL BLOCK USER COUNT
  8102					PFALL	DECBC1
  8103
  8104				    ;HERE FOR EITHER - FREE UP UNNECESSARY BUFFERS
  8105
  8106	012344'	240300	000001	DECBC1:	ASH	T1,1		;T1/ MAX # OF BUFFERS NEEDED (2*PORTS)
  8107	012345'	274300	017104'		SUB	T1,BIOBUF	;T1/ -# OF UNNEEDED BUFFERS IN POOL
  8108	012346'	261040	000006		PUSH	P,T1
  8109	012347'	353001	000000	DECBC2:	AOSLE	(P)
  8110	012350'	254000	012354'		JRST	DECBC3
  8111	012351'	260040	012461'		PUSHJ	P,GETBBP	;GET A BUFFER FROM THE BLOCK I/O POOL
  8112	012352'	260040	012475'		PUSHJ	P,RELBBF	;RELEASE IT TO FREECORE
  8113	012353'	254000	012347'		JRST	DECBC2
  8114	012354'	262040	000006	DECBC3:	POP	P,T1
  8115	012355'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 188
SCNSER.MAC	25-JAN-91 22:40		GETBI - SET UP A PORT FOR BLOCK INPUT

  8116				SUBTTL	GETBI - SET UP A PORT FOR BLOCK INPUT
  8117				;	  NONSKIP IF LEFT BLOCK MODE
  8118				;	  ELSE SKIP WITH T1 AND LDBBIO(U).RH SET TO BUFFER
  8119
  8120	012356'	260040	012414'	GETBI:	PUSHJ	P,GETBIO
  8121	012357'	263040	000000		  POPJ	P,
  8122	012360'	542305	000005		HRRM	T1,LDBBIO(U)
  8123	012361'	254000	012325*		JRST	CPOPJ1
  8124
  8125				;GETBO - SET UP A PORT FOR BLOCK OUTPUT
  8126
  8127	012362'	260040	012414'	GETBO:	PUSHJ	P,GETBIO
  8128	012363'	263040	000000		  POPJ	P,
  8129	012364'	506305	000005		HRLM	T1,LDBBIO(U)
  8130	012365'	254000	012361*		JRST	CPOPJ1
  8131
  8132				;RELBI - CALLED WHEN A PORT'S DONE WITH BLOCK INPUT
  8133				;	  RETURNS T1/ LDBBIO(U)
  8134
  8135	012366'	550305	000005	RELBI:	HRRZ	T1,LDBBIO(U)
  8136	012367'	322300	012376'		JUMPE	T1,RELB0
  8137	012370'	513005	000005		HLLZS	LDBBIO(U)
  8138	012371'	324740	012431'		PJRST	RELBIO
  8139
  8140				;RELBO - CALLED WHEN A PORT'S DONE WITH BLOCK OUTPUT
  8141				;	  RETURNS T1/ LDBBIO(U)
  8142
  8143	012372'	554305	000005	RELBO:	HLRZ	T1,LDBBIO(U)
  8144	012373'	322300	012376'		JUMPE	T1,RELB0
  8145	012374'	553005	000005		HRRZS	LDBBIO(U)
  8146	012375'	324740	012431'		PJRST	RELBIO
  8147
  8148	012376'	200305	000005	RELB0:	MOVE	T1,LDBBIO(U)
  8149	012377'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 189
SCNSER.MAC	25-JAN-91 22:40		KEPBI - SKIP-RETURNS IF IT'S OK FOR THIS PORT (U/ LDB ADDRESS)

  8150				SUBTTL	KEPBI - SKIP-RETURNS IF IT'S OK FOR THIS PORT (U/ LDB ADDRESS)
  8151				;	  TO KEEP ITS BLOCK INPUT RESOURCES, NONSKIPS IF
  8152				;	  SOMEBODY ELSE WANTS THEM
  8153
  8154	012400'	261040	000006	KEPBI:	PUSH	P,T1
  8155	012401'	205300	040000		MOVSI	T1,LDLPTY
  8156	012402'	612305	000031		TDNE	T1,LDBDCH(U)	;IF IT'S NOT A PTY
  8157	012403'	254000	012407'		 JRST	KEPBI1
  8158	012404'	200305	000005		MOVE	T1,LDBBIO(U)
  8159	012405'	333000	012335*		SKIPLE	BPREQ		;AND SOMEONE'S WAITING FOR PORTS
  8160	012406'	603300	777777		 TLNE	T1,777777	;AND WE CAN FREE ONE,
  8161	012407'	333000	000000*	KEPBI1:	SKIPLE	FCREQ		;OR IF SOMEONE'S WAITING FOR FREECORE,
  8162	012410'	254000	012412'		 JRST	.+2		;  DON'T SKIP
  8163	012411'	350001	777777		AOS	-1(P)
  8164	012412'	262040	000006		POP	P,T1
  8165	012413'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 190
SCNSER.MAC	25-JAN-91 22:40		GETBIO - GET A BLOCK I/O BUFFER FOR LINE

  8166				SUBTTL	GETBIO - GET A BLOCK I/O BUFFER FOR LINE
  8167				;	   NONSKIP-RETURN IF PORT LEFT BIO MODE WHILE WAITING
  8168				;	   SKIP-RETURN WITH T1/ THE BUFFER ADDRESS OTHERWISE
  8169
  8170	012414'	205300	400000	GETBIO:	MOVSI	T1,LNLZIN	;Was a zapper seen on this line?
  8171	012415'	612305	000001		TDNE	T1,LDBLIN(U)	; ...
  8172	012416'	263040	000000		 POPJ	P,		;Pretend there are no more buffers for now
  8173	012417'	205300	040000		MOVSI	T1,LDLPTY
  8174	012420'	616305	000031		TDNN	T1,LDBDCH(U)	;IF IT'S NOT A PTY
  8175	012421'	332005	000005		SKIPE	LDBBIO(U)	;AND THERE'S NO BLOCK I/O IN PROGRESS,
  8176	012422'	254000	012425'		 JRST	GTBIO1
  8177	012423'	353000	012405*		AOSLE	BPREQ
  8178	012424'	260040	000000*		PUSHJ	P,BPWAIT	;  GET A BASE PORT
  8179	012425'	260040	012443'	GTBIO1:	PUSHJ	P,GETBB		;T1/ BUFFER ADDRESS
  8180				IFCPU (KL),<;P035/D05 - make sure page containing buffer is uncached.
  8181					PUSH	P,T1		;Save pointer
  8182					HRLI	T1,BIOCOR	;Size of buffer in LH
  8183					PUSHJ	P,CSHCLR##	;Clear cache bit in EPT
  8184					POP	P,T1
  8185				>
  8186	012426'	200345	000030		MOVE	T2,LDBMOD(U)
  8187	012427'	603340	001000		TLNE	T2,LMLBIO	;IF PORT'S STILL IN BLOCK MODE,
  8188	012430'	254000	012365*		 JRST	CPOPJ1		;  SKIP-RETURN
  8189					PFALL	RELBIO
  8190
  8191				;RELBIO - RELEASE A BLOCK I/O BUFFER FOR U
  8192				;	   CALLED WITH T1/ THE BUFFER ADDRESS
  8193				;	   FREES THE PORT IF NO BUFFERS REMAIN
  8194				;	   RETURNS T1/ LDBBIO(U)
  8195
  8196	012431'	260040	012473'	RELBIO:	PUSHJ	P,RELBB		;FREE THE BUFFER
  8197	012432'	205300	040000		MOVSI	T1,LDLPTY
  8198	012433'	612305	000031		TDNE	T1,LDBDCH(U)	;IF IT'S NOT A PTY
  8199	012434'	254000	012441'		 JRST	RLBIO1
  8200	012435'	336305	000005		SKIPN	T1,LDBBIO(U)	;AND NO BLOCK I OR O IN PROGRESS,
  8201	012436'	371000	012423*		SOSL	BPREQ		;  FREE THE BASE PORT
  8202	012437'	476000	012322*		 SETOM	BPAVAL
  8203	012440'	263040	000000		POPJ	P,
  8204
  8205	012441'	200305	000005	RLBIO1:	MOVE	T1, LDBBIO(U)	;T1/ LDBBIO
  8206	012442'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 191
SCNSER.MAC	25-JAN-91 22:40		GETBB - GET A BLOCK I/O BUFFER AND RETURN ITS ADDRESS IN T1

  8207				SUBTTL	GETBB - GET A BLOCK I/O BUFFER AND RETURN ITS ADDRESS IN T1
  8208				;GETBBP - GET ONE FROM THE POOL (NOT FREECORE) OR CRASH
  8209
  8210	012443'	332000	017105'	GETBB:	SKIPE	BBFREE		;IF NO FREE BLOCK BUFFERS,
  8211	012444'	254000	012463'		 JRST	GETBB1
  8212	012445'	201340	000000*		MOVEI	T2,BIOCOR
  8213	012446'	335000	012407*		SKIPGE	FCREQ		;  GET ANOTHER. IF OTHER JOBS IN FC WAIT
  8214	012447'	260040	000000*		 PUSHJ	P,GET4WD	;  OR NO FREE CORE,
  8215					  JRST	[
  8216						AOS  FCREQ
  8217						PUSHJ P,FCWAIT
  8218						SOS  FCREQ
  8219						JRST GETBB	;    WAIT, THEN TRY AGAIN
  8220	012450'	254000	017705'		]
  8221				IFKMC<
  8222	012451'	261040	000006		PUSH	P,T1		;SAVE UNMAPPED T1
  8223	012452'	260040	012525'		PUSHJ	P,SCANBB	;RETURNS T2 WITH UBA PAGE # OF T1
  8224					  JRST [CAILE T2,UBAEND-<UBABIO&777> ;GUESS WE DIDN'T MATCH. ANY ROOM LEFT?
  8225						 STOPCD 	;GIVE UP IF NO ROOM.
  8226						HRLI T2,3	;T2/3,,AVAILABLE PAGE #
  8227						LSH T1,-9	;T1/HIGH 11 BITS OF MAPPED ADDRESS
  8228						TRO T1,1B21	;SET VALID BIT
  8229						WRIO T1,UBABIO(T2)
  8230						MOVEM T1,BBPAGE(T2)
  8231						ADDI T1,1	;ALSO INIT NEXT PAGE
  8232						WRIO T1,UBABIO+1(T2)
  8233						MOVEM T1,BBPAGE+1(T2)
  8234						HRRZ T2,T2	;T2/0,,PAGE #
  8235						AOS  BBCRE	;;;COUNT BIO BUFFERS CREATED
  8236	012453'	254000	017711'			JRST .+1]	;CONTINUE
  8237	012454'	242340	777777		LSH	T2,-1		;T2/PAGE PAIR #
  8238	012455'	350007	016605'		AOS	BBCNTS(T2)	;BUMP THE USE COUNT
  8239	012456'	262040	000006		POP	P,T1		;RESTORE UNMAPPED T1
  8240				>;END IFKMC
  8241	012457'	350000	017104'		AOS	BIOBUF		;  1 MORE BUFFER IN POOL
  8242	012460'	263040	000000		POPJ	P,		;  RETURN THE BUFFER
  8243
  8244				    ;HERE IF THERE ARE FREE BUFFERS IN THE BLOCK I/O POOL
  8245
  8246	012461'	336000	017105'	GETBBP:	SKIPN	BBFREE
  8247	012462'	256000	017726'	TTYNFB:: STOPCD (.,STOP,TTYNFB,,<No Free Buffrers>)
  8248				     ;;GETBBP+1
  8249	012463'	370000	017105'	GETBB1:	SOS	BBFREE
  8250	012464'	350000	017110'		AOS	BBPOOL		;COUNT USE OF FREE BIO BUFFERS
  8251	012465'	550300	017100'		HRRZ	T1,BUFLST
  8252	012466'	336000	000006		SKIPN	T1
  8253	012467'	256000	012462'		 STOPCD (,XCT,TTYNFB)
  8254				   ;No Free Buffers        ;;GETBB1+5
  8255	012470'	550346	000000		HRRZ	T2,(T1)
  8256	012471'	542340	017100'		HRRM	T2,BUFLST	;MAKE NEXT-LINK THE NEW HEADER
  8257	012472'	263040	000000		POPJ	P,
  8258
  8259				;RELBB - RELEASE THE BLOCK I/O BUFFER POINTED TO BY T1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 191-2
SCNSER.MAC	25-JAN-91 22:40		GETBB - GET A BLOCK I/O BUFFER AND RETURN ITS ADDRESS IN T1

  8260				;RELBBF - ALWAYS RETURN IT TO FREECORE
  8261
  8262	012473'	335000	012446*	RELBB:	SKIPGE	FCREQ		;IF OTHER JOBS ARE WAITING FOR FREECORE,
  8263	012474'	254000	012503'		 JRST	RELBB1
  8264	012475'	336340	000006	RELBBF:	SKIPN	T2,T1
  8265	012476'	256000	000000'		 STOPCD
  8266	012477'	370000	017104'		SOS	BIOBUF
  8267	012500'	201300	012445*		MOVEI	T1, BIOCOR
  8268	012501'	260040	012512'	IFKMC<	PUSHJ P,RELKMC>		;RELEASE UBA SLOT
  8269	012502'	324740	000000*		PJRST	GIV4WD		;  JUST RELEASE THE BUFFER
  8270
  8271				    ;HERE TO ADD THE BUFFER TO THE BLOCK I/O POOL
  8272
  8273	012503'	336000	000006	RELBB1:	SKIPN	T1
  8274	012504'	256000	000000'		 STOPCD
  8275	012505'	550340	017100'		HRRZ	T2,BUFLST	;T2/ HEAD OF FREE CHAIN
  8276	012506'	202346	000000		MOVEM	T2,(T1)
  8277	012507'	202300	017100'		MOVEM	T1,BUFLST	;MAKE T1 THE NEW HEAD
  8278	012510'	350000	017105'		AOS	BBFREE
  8279	012511'	263040	000000		POPJ	P,
  8280
  8281				IFKMC<
  8282	012512'	261040	000006	RELKMC:	PUSH	P,T1		;SAVE T1
  8283	012513'	261040	000007		PUSH	P,T2		;SAVE UNMAPPED T2
  8284	012514'	200300	000007		MOVE	T1,T2		;T1/BUFFER ADDRESS
  8285	012515'	260040	012525'		PUSHJ	P,SCANBB	;RETURNS T2 WITH UBA PAGE # OF T1
  8286	012516'	256000	000000'		  STOPCD		;NO MATCH IS BAD NEWS!
  8287	012517'	242340	777777		LSH	T2,-1		;T2/PAGE PAIR NUMBER
  8288	012520'	376007	016605'		SOSN	BBCNTS(T2)	;DEC PAGE PAIR USE COUNT
  8289					 JRST  [LSH T2,1	;;IF COUNT WENT TO 0 RESTORE T2 &
  8290						SETZ T1,	;;INVALIDATE THE PAGE PAIR
  8291						HRLI T2,3	;;UBA #3,,EVEN PAGE #
  8292						WRIO T1,UBABIO(T2)
  8293						WRIO T1,UBABIO+1(T2)
  8294						HRROS BBPAGE(T2)	;;;;DEBUG
  8295						HRROS BBPAGE+1(T2)	;;;;DEBUG CODE
  8296						AOS BBREL		;;;;INFO
  8297	012521'	254000	017731'			JRST .+1]
  8298	012522'	262040	000007		POP	P,T2		;RESTORE UNMAPPED T2
  8299	012523'	262040	000006		POP	P,T1		;RESTORE T1
  8300	012524'	263040	000000		POPJ	P,		;RETURN
  8301
  8302
  8303				;RETURNS T1 MAPPED
  8304				;SKIP RETURNS WHEN T2/0,,MATCHED UBA PAGE
  8305				;NON-SKIP RETURNS WITH T2/0,,-1 OR T2/0,,AVAILABLE UBA PAGE #
  8306	012525'	257306	000000	SCANBB:	MAP	T1,(T1)
  8307	012526'	261040	000006		PUSH	P,T1		;SAVE MAPPED T1 FOR RETURN
  8308	012527'	261040	000010		PUSH	P,T3
  8309	012530'	261040	000011		PUSH	P,T4
  8310	012531'	404300	017742'		AND	T1,[3777B26]	;MASK OUT ALL BUT HIGH 11 BITS
  8311	012532'	661300	001000		TLO	T1,(1B8)	;SET VALID BIT
  8312	012533'	201440	777777		MOVEI	T4,-1		;T4/0,,-1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 191-3
SCNSER.MAC	25-JAN-91 22:40		GETBB - GET A BLOCK I/O BUFFER AND RETURN ITS ADDRESS IN T1

  8313	012534'	515340	000003		HRLZI	T2,3		;T2/3,,0
  8314	012535'	712407	000000*	SBBLUP:	RDIO	T3,UBABIO(T2)	;T3/EVEN PAGE # CONTENTS
  8315	012536'	404400	017743'		AND T3,[<1B8!3777B26>]	;MASK OUT ALL BUT VALID BIT & HIGH 11
  8316	012537'	316300	000010		CAMN	T1,T3		;DOES IT MATCH?
  8317					 JRST  [POP P,T4	;IF IT DOES THEN SKIP RETURN
  8318						POP P,T3
  8319						POP P,T1	;RESTORE MAPPED T1
  8320						HRRZ T2,T2	;T2/0,,MATCHED PAGE #
  8321						JRST CPOPJ1	;DO SKIP RETURN
  8322	012540'	254000	017744'			]
  8323	012541'	627400	001000		TLZN	T3,(1B8)	;IS THE VALID BIT ON?
  8324	012542'	201447	000000		 MOVEI	T4,(T2)		;T4/0,,LATEST AVAILABLE PAGE #
  8325	012543'	271340	000002		ADDI	T2,2		;T2/3,,NEXT PAGE PAIR
  8326	012544'	315340	017751'		CAMGE	T2,[3,,UBAEND-<UBABIO&777>]	;ARE WE STILL LESS THAN 30?
  8327	012545'	254000	012535'		 JRST	SBBLUP		;IF SO GO BACK TO SBB LOOP
  8328	012546'	200340	000011		MOVE	T2,T4		;T2/0,,-1 OR 0,,AVAILABLE SLOT NUMBER
  8329	012547'	262040	000011		POP	P,T4
  8330	012550'	262040	000010		POP	P,T3
  8331	012551'	262040	000006		POP	P,T1		;RESTORE MAPPED T1
  8332	012552'	263040	000000		POPJ	P,		;NON-SKIP RETURN
  8333
  8334
  8335				;MISC KMC RELATED ROUTINES
  8336
  8337
  8338	012553'	260040	012726'	SCNMIN: PUSHJ	P,MDRUP		;T1/ FLAG DRs WE THINK ARE UP
  8339	012554'	202300	016671'		MOVEM	T1,DRMBRK	;FLAG TO SEND DR PILLS
  8340	012555'	263040	000000		POPJ	P,
  8341
  8342	012556'			SCNDRD:			;WILL SKIP A MINUTE WHEN KMCRES IS CALLED
  8343	012556'	332300	016675'		SKIPE	T1,DRDOW
  8344	012557'	254000	012566'		 JRST	SCNMI2		;SET DRMHSI ON 2ND MINUTE
  8345	012560'	260040	000000*		PUSHJ	P,KMCRST##	;T1/ DOWN DR BITS
  8346	012561'	260040	012727'		PUSHJ	P,DRFLAG	;T1/ 3-BIT DR NUMBERS NEEDING TYPHSI MSG
  8347	012562'	202300	016675'		MOVEM	T1,DRDOW	;START DELAY FOR 41 TO NODE(S)
  8348	012563'	201300	000074		MOVEI	T1,^D60
  8349	012564'	202300	016666'		MOVEM	T1,TIMDRD
  8350	012565'	263040	000000		POPJ	P,
  8351	012566'	202300	016667'	SCNMI2:	MOVEM	T1,DRMHSI	;SET DRMHSI FLAG WITH DOWN DR NUMBERS
  8352	012567'	402000	016675'		SETZM	DRDOW		;CLEAR DRDOW
  8353	012570'	263040	000000		POPJ	P,		;ACTUAL MESSAGES GET SENT FROM SNDHSI
  8354
  8355	012571'	336300	016667'	SNDHSI:	SKIPN	T1,DRMHSI	;T1/DOWN DR NUMBERS
  8356	012572'	254000	012577'		 JRST	MDRSHT		;CHECK NEXT MULTI DR MESSAGE
  8357	012573'	402000	016667'		SETZM	DRMHSI
  8358	012574'	205700	020400		MOVSI	P3,TYPI TYPHSI
  8359	012575'	260040	012653'		PUSHJ	P,MDRMSG	;SEND TO ALL DR NUMs IN T1
  8360					JUMPN	T1,[		;IF NO ROOM IN THE RING TO FINISH THEN
  8361						MOVEM T1,DRMHSI ; SET DRMHSI TO DO THE REST NEXT TIME
  8362	012576'	326300	017752'			POPJ	P,]   	; AND NON-SKIP RETURN
  8363	012577'	336300	016670'	MDRSHT:	SKIPN	T1,DRMSHT	;T1/DRs THAT NEED A SHUT MESSAGE
  8364	012600'	254000	012605'		  JRST	MDRBRK		;CHECK NEXT MULTI DR MESSAGE
  8365	012601'	402000	016670'		SETZM	DRMSHT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 191-4
SCNSER.MAC	25-JAN-91 22:40		GETBB - GET A BLOCK I/O BUFFER AND RETURN ITS ADDRESS IN T1

  8366	012602'	205700	001000		MOVSI	P3,TYPI TYPSHT
  8367	012603'	260040	012653'		PUSHJ	P,MDRMSG
  8368					JUMPN	T1,[		;IF WE COULDN'T FINISH THEN
  8369						MOVEM T1,DRMSHT	; SET DRMSHT TO DO THE REST NEXT TIME
  8370	012604'	326300	017754'			POPJ P,]	; AND NON-SKIP RETURN
  8371	012605'	336300	016671'	MDRBRK:	SKIPN	T1,DRMBRK	;T1/DRs THAT NEED A 57 PILL
  8372	012606'	254000	012613'		  JRST	MDRCLP		;CHECK NEXT MULTI DR MESSAGE
  8373	012607'	402000	016671'		SETZM	DRMBRK
  8374	012610'	205700	027400		MOVSI	P3,TYPI TYPBRK	;WE USE A 51 "BRK" MSG FOR THE PILL
  8375	012611'	260040	012653'		PUSHJ	P,MDRMSG
  8376					JUMPN	T1,[		;IF WE COULDN'T FINISH THEN
  8377						MOVEM T1,DRMBRK	; SET DRMBRK TO DO THE REST NEXT TIME
  8378	012612'	326300	017756'			POPJ P,]	; AND NON-SKIP RETURN
  8379	012613'	336300	016673'	MDRCLP:	SKIPN	T1,DRMCLP	;T1/DRs THAT NEED A CLOCK REQ MSG
  8380	012614'	254000	012621'		  JRST	MDRANS		;CHECK NEXT MULTI DR MESSAGE
  8381	012615'	402000	016673'		SETZM	DRMCLP
  8382	012616'	205700	021000		MOVSI	P3,TYPI TYPCLP
  8383	012617'	260040	012653'		PUSHJ	P,MDRMSG
  8384					JUMPN	T1,[		;IF WE COULDN'T FINISH THEN
  8385						MOVEM T1,DRMCLP	; SET DRMCLP TO DO THE REST NEXT TIME
  8386	012620'	326300	017760'			POPJ P,]	; AND NON-SKIP RETURN
  8387	012621'	336300	016672'	MDRANS:	SKIPN	T1,DRMANS	;T1/DRs TO SEND AN ANSWERED MSG TO
  8388	012622'	254000	012627'		  JRST	MDRNXT		;CHECK NEXT MULTI DR MESSAGE
  8389	012623'	402000	016672'		SETZM	DRMANS
  8390	012624'	205700	000400		MOVSI	P3,TYPI TYPANS
  8391	012625'	260040	012653'		PUSHJ	P,MDRMSG
  8392					JUMPN	T1,[		;IF WE COULDN'T FINISH THEN
  8393						MOVEM T1,DRMANS	; SET UP FOR NEXT TIME
  8394	012626'	326300	017762'			POPJ P,]	; AND NON-SKIP RETURN
  8395	012627'			MDRNXT:	
  8396	012627'	200300	016674'		MOVE	T1,DRMTIM	;;;;;;;START KMC DEBUG CODE
  8397	012630'	275300	000001		SUBI	T1,1
  8398	012631'	322300	012430*		JUMPE	T1,CPOPJ1	;IGNORE FOR THE FIRST SECOND
  8399	012632'	260040	000000*		PUSHJ	P,KMCGAV##
  8400	012633'	200340	000006		MOVE	T2,T1
  8401	012634'	405340	000377		ANDI	T2,377
  8402	012635'	242340	000010		LSH	T2,8
  8403	012636'	260040	000000*		PUSHJ	P,KMCGAC##
  8404	012637'	405300	000377		ANDI	T1,377
  8405	012640'	434300	000007		IOR	T1,T2
  8406	012641'	316300	016702'		CAMN	T1,KMCLAS	;SAME AS LAST TIME?
  8407	012642'	254000	012631*		 JRST	CPOPJ1		;YES, BYE...
  8408	012643'	202300	016702'		MOVEM	T1,KMCLAS
  8409	012644'	504300	016674'		HRL	T1,DRMTIM
  8410	012645'	200340	016703'		MOVE	T2,KMCPDP
  8411	012646'	202307	016704'		MOVEM	T1,KMCFLG(T2)
  8412	012647'	271340	000001		ADDI	T2,1
  8413	012650'	405340	000077		ANDI	T2,77
  8414	012651'	202340	016703'		MOVEM	T2,KMCPDP	;;;;;;;;END KMC DEBUG CODE
  8415	012652'	254000	012642*		JRST	CPOPJ1	;END OF MDR CHAIN FOR NOW. SKIP RET
  8416
  8417	012653'			MDRMSG:	;MSG TO ALL UP DRs	;P3/ MOVSI P3,TYPI TYPmsg
  8418					;T1/ 3-BIT UP DR NUMBERS;RET:T1/0 or DRs NOT SENT TO
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 191-5
SCNSER.MAC	25-JAN-91 22:40		GETBB - GET A BLOCK I/O BUFFER AND RETURN ITS ADDRESS IN T1

  8419				;;;;;;;	MOVE	T2,SYSNUM##	;PUT THE SYSNUM IN THE MESSAGES JUST
  8420	012653'	200340	016674'		MOVE	T2,DRMTIM	;USE UP TIME FOR NOW
  8421				;;;;;;;	ANDI	T2,377		;INCASE THE NODE WANTS IT IN THE FUTURE
  8422	012654'	405340	001777		ANDI	T2,1777		;SHOW 10 BITS FOR NOW
  8423	012655'	242340	000010		LSH	T2,8		; OFCOURSE WE CAN ONLY SEND 8 BITS OF IT
  8424	012656'	420700	017764'		ANDCM	P3,[377,,-1]	;LEAVE ONLY MESSAGE TYPE IN BITS 2-9
  8425	012657'	434340	000016		IOR	T2,P3		;T2 HOLDS THE MESSAGE
  8426	012660'	336700	000006	MDRLUP:	SKIPN	P3,T1
  8427	012661'	254000	012130*		 JRST	CPOPJ		;RETURN WHEN T1=0
  8428	012662'	405700	000003		ANDI	P3,3		;ISOLATE A DR NUMBER
  8429	012663'	322700	012721'		JUMPE	P3,MDRL1	;IF IT'S 0 GO TRY THE NEXT ONE
  8430	012664'	275700	000001		SUBI	P3,1		;1-4 GOES TO 0-3
  8431	012665'	303700	000000*		CAILE	P3,MAXDR	;P3 MUST BE .LE. PORTS/LINES PER DR
  8432	012666'	254000	012721'		 JRST	MDRL1
  8433	012667'	242700	000006		LSH	P3,6		;MAKE IT A PORT NUMBER
  8434	012670'	435700	000000		IORI	P3,LPERDR&77	;P3/(DRNUM*100) ! LINES PER DR
  8435	012671'	303700	000000*		CAILE	P3,<MAXDR*100>!<RPORTN##-<MAXDR*LPERDR>>
  8436					 JRST	[ANDCMI P3,77
  8437						IORI	P3,RPORTN##-<MAXDR*LPERDR>
  8438	012672'	254000	017765'			JRST	.+1]
  8439	012673'	421700	000003		ANDCMI	P3,3		;MUST BE A MULTIPLE OF 4
  8440	012674'	504700	000016		HRL	P3,P3		;P3/MAX PORT NUM,,MAX PORT NUM
  8441	012675'	421700	000077		ANDCMI	P3,77		;P3/MAX PORT NUM,,DR NUM
  8442	012676'	554400	000007		HLRZ	T3,T2		;TEST FOR TYPHSI
  8443	012677'	302400	020400		CAIE	T3,TYPI TYPHSI	;TYPHSI USES MAX PORT,,DRNUM
  8444	012700'	514700	000016		 HRLZ	P3,P3		;TYPE A MESSAGES DON'T USE MAX PORT
  8445	012701'	434700	000007		IOR	P3,T2		;OR IN THE MESSAGE AND SYS NUMBER
  8446	012702'	261040	000006		PUSH	P,T1
  8447	012703'	261040	000007		PUSH	P,T2
  8448	012704'	260040	004113'		PUSHJ	P,CLSCHR	;MAKE SURE THE RING IS READY
  8449	012705'	254000	012723'		  JRST MDRRET		;IF NOT DO A NON-SKIP RETURN
  8450	012706'	260040	004161'		PUSHJ	P,WRDOUT	;PUT THE MESSAGE IN THE RING
  8451	012707'	254000	012723'		  JRST MDRRET		;THIS SHOULDN'T HAPPEN!
  8452	012710'	262040	000007		POP	P,T2
  8453	012711'	262040	000006		POP	P,T1
  8454	012712'	554400	000007		HLRZ	T3,T2		;TEST FOR TYPHSI
  8455	012713'	302400	020400		CAIE	T3,TYPI TYPHSI
  8456	012714'	254000	012721'		 JRST	MDRL1		;IF NOT HSI THEN SKIP TO MDRL1
  8457	012715'	200400	000006		MOVE	T3,T1
  8458	012716'	405400	000003		ANDI	T3,3
  8459	012717'	275400	000001		SUBI	T3,1
  8460	012720'	476010	016676'		SETOM	SENT41(T3)	;FLAG THAT WE SENT A 41 TO THAT DR
  8461	012721'	242300	777775	MDRL1:	LSH	T1,-3		;THROW OUT 3-BIT DR NUM JUST PROCESSED
  8462	012722'	254000	012660'		JRST	MDRLUP		;GO DO THE NEXT ONE
  8463	012723'	262040	000007	MDRRET:	POP	P,T2
  8464	012724'	262040	000006		POP	P,T1
  8465	012725'	254000	012661*		JRST	CPOPJ
  8466
  8467			000001	DR1BIT==1B35
  8468			000002	DR2BIT==1B34
  8469			000020	DR3BIT==1B31
  8470			000200	DR4BIT==1B28
  8471
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 191-6
SCNSER.MAC	25-JAN-91 22:40		GETBB - GET A BLOCK I/O BUFFER AND RETURN ITS ADDRESS IN T1

  8472	012726'	260040	011631*	MDRUP:	PUSHJ	P,KMCGUP##
  8473	012727'	514300	000006	DRFLAG: HRLZ	T1,T1		;MOVE FLAGS TO LEFT HALF
  8474	012730'	623300	000001		TLZE	T1,DR1BIT	;TEST AND CLEAR THE FIRST FLAG
  8475	012731'	435300	000001		 IORI	T1,0001		;IF A DRs FLAG IS SET PUT ONE PLUS IT'S
  8476	012732'	623300	000002		TLZE	T1,DR2BIT	;    NUMBER IN A 3-BIT OCTAL DIGIT SLOT
  8477	012733'	435300	000020		 IORI	T1,0020
  8478	012734'	623300	000020		TLZE	T1,DR3BIT
  8479	012735'	435300	000300		 IORI	T1,0300
  8480	012736'	623300	000200		TLZE	T1,DR4BIT
  8481	012737'	435300	004000		 IORI	T1,4000
  8482	012740'	550300	000006		HRRZ	T1,T1		;T1/ 0,,3-BIT DR NUMBERS FLAGGED
  8483	012741'	263040	000000		POPJ	P,		;RETURN
  8484				>;END IFKMC
  8485
  8486				;BASVER definitions: BYTE(8)TYPE,FLAGS,VERSION,RELEASE
  8487		000004	000000		BV.DBG==<BYTE(8)0,001,0,0>	;Debugging if lsb of 2nd byte set
  8488		001000	000000		BV.HDN==<BYTE(8)0,200,0,0>	;EBUS says host was down (we went away)
  8489	012742'	200317	001561*	RCVRAK:	MOVE	T1,IRING(P4)	;TYPRAK=4 - Reset Acknowlege
  8490	012743'	202300	005611*		MOVEM	T1,BASVER##	;Store BYTE(8)CODE,DEBUG,VERSION,RELEASE
  8491	012744'	256000	017770'	BASEOK:: STOPCD (.+1,EVENT,BASEOK,PRTBVR,<Base is up>)
  8492	012745'	344740	001011'		AOJA	P4,SCNIN1
  8493
  8494				IFCPU (<KI,KL>),<
  8495				PRTBVR:	PUSHJ	P,INLMES##	;Called from STOPCD(BASEOK)
  8496					 ASCIZ /Code in base is version /
  8497					LDB	T1,[POINT 8,BASVER,23]
  8498					PUSHJ	P,PRTDEC##
  8499					PUSHJ	P,PRPER##	;Period
  8500					LDB	T1,[POINT 8,BASVER,31]
  8501					PUSHJ	P,PRT2##	;2 decimal digits
  8502				;	PUSHJ	P,INLMES##
  8503				;	 ASCIZ / - debug flag is /
  8504				;	MOVEI	T1,[ASCIZ /OFF/]
  8505				;	MOVSI	T2,(BV.DBG)
  8506				;	TDNE	T2,BASVER	;Is it set?
  8507				;	 MOVEI	T1,[ASCIZ /ON/]	;Yes
  8508				;	PUSHJ	P,CONMES##	;STOPCD processor will provide CRLF
  8509					POPJ	P,
  8510				>
  8511			000000	IFNCPU(<KI,KL>),<PRTBVR==CPOPJ##> ;PDP-11 bases do not report version #
  8512
  8513				IFNKMC<				;TYPRES=3 - Reset interface
  8514				RCVRES:	SETOM	BASDWN##	;Set flag to call DETALL and send TYPRAK
  8515					MOVE	T1,IRING(P4)	;Get the message
  8516					EXCH	T1,BASVER##	;Store BYTE(8)CODE,DEBUG,VERSION,RELEASE
  8517					CAME	T1,BASVER##	;Don't mumble about 2 in a row
  8518					 STOPCD	(,XCT,BASEOK)	;Print "base is up" message
  8519					PUSHJ	P,DETALL	;Detach all ports
  8520					LDB	T1,[POINT 16,BASVER,31];Get 3rd and 4th bytes
  8521					CAILE	T1,<02_^D8>+00	;Is it version 02.00 ?
  8522					 AOJA	P4,SCNIN1	;No, done
  8523					SETZM	IRPPDP		;Yes, EBUS has set IRP620 to zero
  8524					SETZM	ORPPDP		; and ORP620 to zero
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 191-7
SCNSER.MAC	25-JAN-91 22:40		GETBB - GET A BLOCK I/O BUFFER AND RETURN ITS ADDRESS IN T1

  8525					POPJ	P,		;Return from SCNTIC - no more to do
  8526				>  ;End IFNKMC
  8527
  8528				IFKMC<		;Here when KMC detects problem with a DR11C
  8529	012746'	402000	012743*	RCVRES:	SETZM	BASVER##	;Store BYTE(8)0,0,0,0 instead of EBUS version
  8530	012747'	201300	000074		MOVEI	T1,^D60
  8531	012750'	202300	016666'		MOVEM	T1,TIMDRD	;RESET KMC CHECKUP TIMER
  8532	012751'	200300	016674'		MOVE	T1,DRMTIM ;;;;;;;TEMP STUFF UP TIME IN IRING 3 MSG
  8533	012752'	137300	000273'		DPB	T1,INPDL2 ;;;;;;;  "    "    "   "   "   "   "  "
  8534	012753'	135240	000267'		LDB	U,INPLIN
  8535	012754'	405240	000300		ANDI	U,300		;U/FIRST PORT NUMBER OF FAILING DR
  8536	012755'	301240	006607*		CAIL	U,RPORTN##	;THIS TEST WORKS ONLY WHEN LPERDR=^D64
  8537	012756'	344740	001011'		 AOJA	P4,SCNIN1	;IGNORE BAD PORT NUMBERS
  8538	012757'	200300	000005		MOVE	T1,U		;(if RPORTN=200, then only 0-177 are legal)
  8539	012760'	242300	777772		LSH	T1,-6		;T1/DR NUMBER
  8540	012761'	402006	016676'		SETZM	SENT41(T1)	;RESET "WAITING FOR RESPONSE TO 41"
  8541	012762'	260040	000000*		PUSHJ	P,KMCCAC##	;CLEAR DR'S ACTIVE BIT & UP BIT
  8542	012763'	260040	012776'	DRZAP:	PUSHJ	P,DETONE	;Detach one port on this particular DR11
  8543	012764'	271240	000001		ADDI	U,1
  8544	012765'	200300	000005		MOVE	T1,U
  8545				IFN LPERDR-^D64,<?Logic at DRZAP needs to be modified>
  8546	012766'	405300	000077		ANDI	T1,LPERDR-1	;ONE OF 77, 37, or 17
  8547	012767'	305240	012755*		CAIGE	U,RPORTN##	;THIS TEST ONLY WORKS FOR LPERDR=64.
  8548	012770'	326300	012763'		 JUMPN	T1,DRZAP	;GO DO THE NEXT PORT
  8549	012771'	344740	001011'		AOJA	P4,SCNIN1	;EXIT
  8550				>;END IFKMC
  8551
  8552				;DETALL - Mark all lines as being detached
  8553
  8554	012772'	201240	777777*	DETALL:	MOVEI	U,RPORTN##-1	;Do all real ports (not PTY ports)
  8555	012773'	260040	012776'		PUSHJ	P,DETONE	;Detach one
  8556	012774'	365240	012773'		SOJGE	U,.-1		;Loop for all
  8557	012775'	324740	015156'		PJRST	SETSHT		;Set UPSHUT to the right value
  8558
  8559				;DETONE - Mark one line as being detached, port number in U preserved
  8560
  8561	012776'	261040	000005	DETONE:	PUSH	P,U		;SAVE U
  8562	012777'	200245	007750*		MOVE	U,LINTAB(U)	;U/ PORT LDB
  8563	013000'	500245	000031		HLL	U,LDBDCH(U)	;U/DEVICE CHARARTERISTICS,,PORT LDB
  8564	013001'	331005	000026		SKIPL	LDBLOG(U)	;SKIP IF PORT NOT LOGGED IN
  8565	013002'	254000	013005'		 JRST	DETON1
  8566	013003'	260040	001522'		PUSHJ	P,FRCZAP	;ZAP THE PORT
  8567	013004'	260040	004421'		PUSHJ	P,CLRTTY	;CANCEL THE "SEND ZAPPER" FLAG
  8568	013005'	262040	000005	DETON1:	POP	P,U		;RESTORE PORT NUMBER
  8569	013006'	263040	000000		POPJ	P,
  8570
  8571	013007'			RCVANS:				;CALLED WHEN KMC/DR RESPONDS TO A 41 WE SENT IT
  8572				IFNKMC<	MOVE	T1,IRING(P4)	;Get the message
  8573					EXCH	T1,BASVER##	;Store BYTE(8)CODE,DEBUG,VERSION,RELEASE
  8574					CAME	T1,BASVER##	;Don't mumble about 2 in a row
  8575					 STOPCD	(,XCT,BASEOK)	;Print "base is up" message
  8576					AOJA	P4,SCNIN1>	;IGNORE ANS MESSAGE ON KI/KL/F3
  8577	013007'	200300	016674'	IFKMC<	MOVE	T1,DRMTIM ;;;;;;;TEMP PUT TIME IN IRING 1 MSG
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 191-8
SCNSER.MAC	25-JAN-91 22:40		GETBB - GET A BLOCK I/O BUFFER AND RETURN ITS ADDRESS IN T1

  8578	013010'	137300	000273'		DPB	T1,INPDL2 ;;;;;;;  "   "    "   "   "   "  "
  8579	013011'	135300	000267'		LDB	T1,INPLIN	;T1/ PORT LDB
  8580	013012'	242300	777772		LSH	T1,-6		;T1/DR NUMBER
  8581	013013'	336006	016676'		SKIPN	SENT41(T1)	;DON'T SET ANSWERED BIT UNLESS WE SENT 41
  8582	013014'	344740	001011'		 AOJA	P4,SCNIN1
  8583	013015'	402006	016676'		SETZM	SENT41(T1)	;RESET "WAITING FOR RESPONSE TO 41"
  8584	013016'	261040	000006		PUSH	P,T1
  8585	013017'	260040	000000*		PUSHJ	P,KMCSUP##	;SET DR'S ANSWERED BIT
  8586	013020'	262040	000006		POP	P,T1
  8587	013021'	405300	000003		ANDI	T1,3
  8588	013022'	271300	000001		ADDI	T1,1
  8589	013023'	200340	016673'		MOVE	T2,DRMCLP
  8590	013024'	242340	000003		LSH	T2,3
  8591	013025'	434340	000006		IOR	T2,T1
  8592	013026'	202340	016673'		MOVEM	T2,DRMCLP
  8593	013027'	201340	400000		MOVEI	T2,STSHUT	;400000
  8594	013030'	612340	006704*		TDNE	T2,STATES	;ARE WE SHUT?
  8595	013031'	254000	013037'		 JRST	KMCSHT		;YES, GO SET UP DRMSHT
  8596	013032'	200340	016672'		MOVE	T2,DRMANS	;NO, SET UP DRMANS INSTEAD
  8597	013033'	242340	000003		LSH	T2,3
  8598	013034'	434340	000006		IOR	T2,T1
  8599	013035'	202340	016672'		MOVEM	T2,DRMANS
  8600	013036'	344740	001011'		AOJA	P4,SCNIN1	;EXIT
  8601	013037'	200340	016670'	KMCSHT:	MOVE	T2,DRMSHT
  8602	013040'	242340	000003		LSH	T2,3
  8603	013041'	434340	000006		IOR	T2,T1
  8604	013042'	202340	016670'		MOVEM	T2,DRMSHT
  8605	013043'	344740	001011'		AOJA	P4,SCNIN1
  8606				>;END IFKMC
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 192
SCNSER.MAC	25-JAN-91 22:40		IQUEUE - TAKES AN INPUT WAIT TRAP IF SET, OTHERWISE PLACES

  8607				SUBTTL	IQUEUE - TAKES AN INPUT WAIT TRAP IF SET, OTHERWISE PLACES
  8608				; THE JOB IN TTY INPUT WAIT.
  8609
  8610	013044'	135300	000230'	IQUEUE:	LDB T1,DDPTTI		;CHECK FOR TRAP WANTED.
  8611	013045'	260040	011060*		PUSHJ	P, TSTKTJ	;IF INPUT WAIT INTERRUPT WANTED
  8612	013046'	254000	011146*		 JRST ABTUUO		;YES, ABORT.
  8613	013047'	335002	000000*		SKIPGE	JBTAWQ(J)	;IF INTERRUPT PENDING
  8614	013050'	254000	013046*		 JRST ABTUUO		; ABORT
  8615	013051'	260040	013720'		PUSHJ P,TIWAIT		;NO.  QUEUE JOB FOR TIO WAIT.
  8616	013052'	324740	013061'		PJRST BIOATT
  8617
  8618				;OQUEUE - TAKES AN OUTPUT WAIT TRAP IF SET, OTHERWISE PLACES
  8619				; THE JOB IN TTY OUTPUT WAIT.
  8620
  8621	013053'	135300	000230'	OQUEUE:	LDB T1,DDPTTI		;CHECK FOR TRAP WANTED.
  8622	013054'	260040	013045*		PUSHJ P,TSTKTJ		;SEE IF INTERRUPT ON IOW
  8623	013055'	260040	016307'		 PUSHJ P,SETFIO		;NEEDS WAKUP LATER
  8624	013056'	335002	013047*		SKIPGE JBTAWQ(J)	;CHECK FOR TRAPS WAITING
  8625	013057'	254000	013050*		 JRST ABTUUO		;AND ABORT IF ANY.
  8626	013060'	260040	013736'		PUSHJ P,TOWAT1		;NO.  QUEUE JOB FOR TIO WAIT.
  8627
  8628				;HERE TO CHECK IF LINE FOR THIS PORT IS STILL ATTACHED.
  8629
  8630	013061'	332002	013056*	BIOATT:	SKIPE JBTAWQ(J)
  8631	013062'	254000	013057*		JRST ABTUUO
  8632	013063'	550244	000013		HRRZ U,DDBLDB(F)	;IS LINE STILL ATTACHED?
  8633	013064'	326240	012652*		JUMPN U,CPOPJ1		;YES.  HE WINS.
  8634	013065'	205300	020000		MOVSI T1,TTYATC		;IS THIS THE CONTROLLING TTY
  8635	013066'	616304	000004		TDNN T1,DEVMOD(F)	;OR AN AUXILIARY CIRCUIT?
  8636	013067'	254000	011143'		 JRST AUXRID		;AN AUXCIR ... HE LOSES.
  8637	013070'	263040	000000		POPJ P,			;CONTROLLING TTY: HE STILL LOSES
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 193
SCNSER.MAC	25-JAN-91 22:40		BLKXIN - TERMINATE BLOCK INPUT AUXCAL

  8638				SUBTTL	 BLKXIN - TERMINATE BLOCK INPUT AUXCAL
  8639
  8640	013071'	200305	000030	BLKXIN:	MOVE	T1,LDBMOD(U)
  8641	013072'	607300	001000		TLNN	T1,LMLBIO	; BLOCK I/O ENABLED?
  8642	013073'	263040	000000		 POPJ	P,
  8643	013074'	550305	000005		HRRZ	T1,LDBBIO(U)	; T1/ INPUT BUFFER ADDRESS
  8644	013075'	322300	013104'		JUMPE	T1,BLKXI1	; NO BUFFER
  8645	013076'	260040	013107'		PUSHJ	P,BLKTRQ	; REQUEST INPUT TERMINATION
  8646	013077'	550305	000005		HRRZ	T1,LDBBIO(U)
  8647	013100'	335006	000005		SKIPGE	BIOCHR(T1)	; CHECK IN-PROGRESS FLAG
  8648	013101'	263040	000000		 POPJ	P,		; IN-PROGRESS: DO NOTHING NOW
  8649	013102'	205000	000040		MOVSI	S,IOEND		; COMPLETE: SET IOEND
  8650	013103'	334000	000000		SKIPA
  8651	013104'	201000	020000	BLKXI1:	MOVEI	S,IODEND	; NO BUFFER: SET IO.EOF
  8652	013105'	437004	000002		IORB	S,DEVIOS(F)
  8653	013106'	263040	000000		POPJ	P,
  8654
  8655				; BLKTRQ - ROUTINE TO REQUEST BLOCK INPUT TERMINATION
  8656
  8657	013107'	205300	400000	BLKTRQ:	MOVSI	T1,LMLTBI
  8658	013110'	612305	000030		TDNE	T1,LDBMOD(U)	; TERMINATION PENDING?
  8659	013111'	263040	000000		 POPJ	P,		; YES: DO NOTHING
  8660	013112'	436305	000030		IORM	T1,LDBMOD(U)	; NO: SET THE FLAG
  8661	013113'	201300	000001		MOVEI	T1,1
  8662	013114'	137300	000062'		DPB	T1,LOPTRI	;    SET TERMINATE-INPUT
  8663	013115'	137305	000002		DPB	T1,LDBOPB(U)	;    AND NEED-OUTPUT
  8664	013116'	263040	000000		POPJ	P,
  8665
  8666				;BLKXOT - HERE TO TERMINATE BLOCK OUTPUT FOR A PORT IN BIO MODE
  8667
  8668	013117'	200305	000030	BLKXOT:	MOVE	T1,LDBMOD(U)
  8669	013120'	607300	001000		TLNN	T1,LMLBIO	;IF BLKIO NOT ENABLED,
  8670	013121'	263040	000000		 POPJ	P,		;  JUST RETURN
  8671	013122'	510305	000005		HLLZ	T1,LDBBIO(U)
  8672	013123'	322300	012725*		JUMPE	T1,CPOPJ	;IF NO BLK OUTPUT IN PROGRESS, RETURN
  8673	013124'	205300	400000		MOVSI	T1,LDLNOP
  8674	013125'	412305	000031		ANDCAM	T1,LDBDCH(U)	;IGNORE BACKPRESSURE
  8675	013126'	135300	000076'		LDB	T1,LOPBOT
  8676	013127'	361300	013132'		SOJL	T1,BLKXT1	;IF WE'RE ABOUT TO REQUEST BLK OUTPUT,
  8677	013130'	137300	000076'		DPB	T1,LOPBOT	;  FORGET IT (T1/ 0)
  8678	013131'	324740	001424'		PJRST	FRCOHR		;  BUT SIMULATE THE OUTPUT-COMPLETE
  8679								;ELSE
  8680	013132'	137300	000057'	BLKXT1:	DPB	T1,LOPTRO	;  SET TO SEND BLKO-TERMINATE (T1/ -1)
  8681	013133'	137305	000002		DPB	T1,LDBOPB(U)	;  AND NEED-OUTPUT
  8682	013134'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 194
SCNSER.MAC	25-JAN-91 22:40		INPUT AND OUTPUT SUBROUTINES

  8683				SUBTTL INPUT AND OUTPUT SUBROUTINES
  8684
  8685	013135'	260040	013264'	TYI:	PUSHJ	P,TYIEAT	;GET RID OF COMMAND LINE (CAN'T RESCAN ANYMORE)
  8686	013136'	375005	000012		SOSGE LDBTIC(U)	;ANY INPUT CHRS LEFT?
  8687					JRST	[SETZM LDBTIC(U)
  8688	013137'	254000	017774'			POPJ P,]	;NO, NON-SKIP RETURN
  8689	013140'	260040	014003'		PUSHJ P,BPFTYI		;RESET BACKPREASURE
  8690	013141'	200345	000011		MOVE T2,LDBTIT(U)
  8691	013142'	260040	006152'		PUSHJ P,TTGETC
  8692	013143'	260040	006233'		 PUSHJ P,FRECHK
  8693	013144'	202345	000011		MOVEM T2,LDBTIT(U)
  8694	013145'	336305	000006		SKIPN T1,LDBBKP(U)	;ANYTHING IN ^U POINTER
  8695	013146'	370005	000007		SOS LDBBKI(U)		;YES, 1 FEWER CHRS
  8696	013147'	316300	000007		CAMN T1,T2		;IS THIS THE POINTER NOW
  8697	013150'	402005	000006		SETZM LDBBKP(U)		;YES, NOTHING THERE NOW
  8698	013151'	602400	000400		TRNE T3,400
  8699	013152'	254000	013064*		JRST CPOPJ1		;IMAGE CHR
  8700	013153'	606400	000200		TRNN T3,200
  8701	013154'	334710	000312'		SKIPA P3,CHRTAB(T3)
  8702	013155'	200710	000112'		MOVE P3,CHRTAB-200(T3)	;GET INFORMATION BITS
  8703	013156'	135340	000305'		LDB T2,CHPRED	;GET READ CODE
  8704	013157'	256007	013162'	TYIRPT:	XCT TYIATB(T2)		;AND DO IT
  8705	013160'	275400	000040		SUBI T3,40		;HERE IN LOWER CASE, CONVERT TO UPPER
  8706	013161'	254000	013152*		JRST CPOPJ1		;DONE
  8707
  8708	000000			TYIATB:	PHASE 0
  8709	013162'	254000	013177'		JRST SPRTYI	;SPECIAL ACTION NEEDED
  8710	013163'	254000	013161*		JRST CPOPJ1	;NORMAL CHR
  8711	013164'	374005	000015	%CHBRK:! SOSA LDBBKC(U)	;BREAK, FLAGGED SO CALLERS KNOW
  8712	013165'	254000	013167'		JRST TYIC	;BREAK2
  8713	013166'	603240	000020		TLNE U,LDLLCT	;LOWER CASE, SHOULD WE CONVERT?
  8714	013167'				DEPHASE
  8715
  8716	013167'	603240	004000	TYIC:	TLNE U,LDLBK2	;IN BREAK2 MODE?
  8717	013170'	200340	000002		MOVE T2,%CHBRK	;YES, FLAG AS BREAK FOR CALLERS
  8718	013171'	350001	000000		AOS (P)
  8719	013172'	370005	000016	TYID:	SOS LDBBK2(U)
  8720	013173'	326300	013123*		JUMPN T1,CPOPJ	;DON'T WORRY IF NO ^U POINTER
  8721	013174'	205300	777777		MOVSI T1,-1
  8722	013175'	272305	000007		ADDM T1,LDBBKI(U)
  8723	013176'	263040	000000		POPJ P,
  8724
  8725	013177'	135340	000307'	SPRTYI:	LDB T2,CHPSPR	;GET ACTION CODE
  8726	013200'	135700	000165'		LDB P3,LDPMOD	;AND LINE MODE
  8727	013201'	256036	013202'		XCT @SPRTTB(P3)
  8728
  8729	013202'	256007	013206'	SPRTTB:	XCT TYIPDP(T2)
  8730	013203'	256007	013215'		XCT TYI940(T2)
  8731	013204'	256007	013215'		XCT TYI940(T2)
  8732	013205'	256007	013206'		XCT TYIPDP(T2)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 195
SCNSER.MAC	25-JAN-91 22:40		INPUT AND OUTPUT SUBROUTINES

  8733	013206'	254000	013252'	TYIPDP:	JRST TYICC	;^C
  8734	013207'	254000	013237'		JRST TYIALT	;33
  8735	013210'	254000	013227'		JRST TYIBRK	;^_
  8736	013211'	254000	013243'		JRST TYICZ	;^Z
  8737	013212'	254000	013235'		JRST TYIPAL	;175-176
  8738	013213'	254000	013224'		JRST TYITAB	;TAB
  8739	013214'	254000	013231'		JRST TYIBSP	;BACKSPACE
  8740
  8741	013215'	254000	013227'	TYI940:	JRST TYIBRK	;^C
  8742	013216'	254000	013252'		JRST TYICC	;33 POSSIBLE ESCAPE
  8743	013217'	254000	013252'		JRST TYICC	;^_
  8744	013220'	254000	013227'		JRST TYIBRK	;^Z
  8745	013221'	254000	013250'		JRST TYICCP	;175-176
  8746	013222'	254000	013224'		JRST TYITAB	;TAB
  8747	013223'	254000	013231'		JRST TYIBSP	;BACKSPACE
  8748
  8749	013224'	205340	100000	TYITAB:	MOVSI T2,L2LTBK
  8750	013225'	616345	000027		TDNN T2,LDBBYT(U)	;TREAT TAB AS BREAK?
  8751	013226'	254000	013167'		JRST TYIC	;NO AS BREAK2
  8752	013227'	201340	000002	TYIBRK:	MOVEI T2,%CHBRK	;YES, TREAT AS BREAK
  8753	013230'	254000	013157'		JRST TYIRPT
  8754
  8755	013231'	205340	040000	TYIBSP:	MOVSI T2,L2LBBP
  8756	013232'	612345	000027		TDNE T2,LDBBYT(U)	;TREAT BSP AS BREAK
  8757	013233'	254000	013167'		JRST TYIC	;NO, AS BREAK2
  8758	013234'	254000	013227'		JRST TYIBRK	;YES
  8759
  8760	013235'	607240	000020	TYIPAL:	TLNN U,LDLLCT	;IN TTY LC
  8761	013236'	254000	013227'		JRST TYIBRK	;YES, JUST A BREAK CHARACTER
  8762	013237'	201340	020000	TYIALT:	MOVEI T2,LDRFCS	;ALTMODE. IN FULL CHR SET MODE?
  8763	013240'	616345	000031		TDNN T2,LDBDCH(U)
  8764	013241'	201400	000033		MOVEI T3,STDALT	;NO, STANDARD
  8765	013242'	254000	013227'		JRST TYIBRK
  8766
  8767	013243'	550205	000000	TYICZ:	HRRZ F,LDBDDB(U)
  8768	013244'	322200	013227'		JUMPE F,TYIBRK	;NO DDB, JUST BREAK CHR
  8769	013245'	205440	000040		MOVSI T4,IOEND
  8770	013246'	436444	000002		IORM T4,DEVIOS(F)	;SET END OF FILE
  8771	013247'	254000	013227'		JRST TYIBRK
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 196
SCNSER.MAC	25-JAN-91 22:40		INPUT AND OUTPUT SUBROUTINES

  8772	013250'	607240	000020	TYICCP:	TLNN U,LDLLCT	;IN TTY LC
  8773	013251'	254000	013227'		JRST TYIBRK	;YES, TRAT AS BREAK
  8774	013252'	370005	000015	TYICC:	SOS LDBBKC(U)
  8775	013253'	200100	010022*		MOVE J,JOB	;ALSO FALL HERE FROM ABOVE
  8776	013254'	260040	016050'		PUSHJ P,ESCTR1	;TRY TRAPPING
  8777	013255'	260040	006032'		PUSHJ P,CNCCHK	;CHECK SPECAIL CONDITIONS
  8778					JRST [
  8779						LDB	P3, LDPMOD	; GET MONITOR MODE
  8780						MOVEI	T3, 3		; ^C FOR 10'S
  8781						CAIE	P3, 1		; GE MODE?
  8782						CAIN	P3, 2		; TYMEX MODE?
  8783						MOVEI	T3, 33		; ESC FOR 940'S
  8784						AOS	LDBBKC(U)	; SOS'D IN TYIBRK
  8785						JRST	TYIBRK		; PASS TO PROGRAM
  8786	013256'	254000	017776'		]
  8787	013257'	260040	013720'		PUSHJ P,TIWAIT	;HALT COMMAND ALREADY SET
  8788	013260'	260040	013477'		PUSHJ	P, CKATTI	;MAKE SURE IT'S STILL ATTACHED
  8789	013261'	254000	013062*		JRST	ABTUUO		;(S)HE WANTS AN INTERRUPT
  8790	013262'	326240	013135'		JUMPN	U, TYI		;TRY AGAIN (FOR CONTINUE)
  8791	013263'	256000	000000'		 STOPCD 		;HORRORS! NOT A COMMAND PORT!
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 197
SCNSER.MAC	25-JAN-91 22:40		GET RID OF COMMAND LINE

  8792				SUBTTL	GET RID OF COMMAND LINE
  8793
  8794	013264'	607240	100000	TYIEAT:	TLNN U,LDLECS	;ALREADY DONE THIS?
  8795	013265'	263040	000000		 POPJ P,		;YES
  8796	013266'	261040	000010		PUSH P,T3
  8797	013267'	261040	000016		PUSH P,P3	;ALSO SAVE THIS (TTYSTR AND FRIENDS)
  8798	013270'	375005	000012	TYIL:	SOSGE LDBTIC(U)
  8799					JRST [SETZM LDBTIC(U)
  8800	013271'	254000	020005'			JRST TYIET2]
  8801	013272'	200345	000011		MOVE T2,LDBTIT(U)
  8802	013273'	260040	006152'		PUSHJ P,TTGETC
  8803	013274'	260040	006233'		 PUSHJ P,FRECHK
  8804	013275'	202345	000011		MOVEM T2,LDBTIT(U)
  8805	013276'	336305	000006		SKIPN T1,LDBBKP(U)
  8806	013277'	370005	000007		SOS LDBBKI(U)	;SAME AS IN TYI
  8807	013300'	316300	000007		CAMN T1,T2
  8808	013301'	402005	000006		SETZM LDBBKP(U)
  8809	013302'	602400	000400		TRNE T3,400
  8810	013303'	254000	013270'		JRST TYIL	;IMAGE, TRY NEXT
  8811	013304'	606400	000200		TRNN T3,200
  8812	013305'	334710	000312'		SKIPA P3,CHRTAB(T3)
  8813	013306'	200710	000112'		MOVE P3,CHRTAB-200(T3)
  8814	013307'	135340	000305'		LDB T2,CHPRED
  8815	013310'	256007	013312'		XCT EATTAB(T2)
  8816	013311'	254000	013270'		JRST TYIL	;TRY NEXT
  8817
  8818	013312'	254000	013317'	EATTAB:	JRST SPREAT	;SPECIAL ACTION
  8819	013313'	254000	013270'		JRST TYIL	;NOMAL CHR
  8820	013314'	254000	013334'		JRST TYIET3	;BREAK CHR, FINISHED
  8821	013315'	260040	013172'		PUSHJ P,TYID	;BREAK2
  8822	013316'	254000	013270'		JRST TYIL	;LOWER CASE, JUST LIKE NORMAL
  8823
  8824	013317'	135340	000307'	SPREAT:	LDB T2,CHPSPR
  8825	013320'	256007	013325'		XCT SPRETB(T2)	;SAME IN ALL MODES
  8826					XCT -5+[TDNE T3,LDBBYT(U)	;FROM TAB
  8827	013321'	256007	020002'		        TDNN T3,LDBBYT(U)](T2)	;FROM BACKSPACE
  8828	013322'	254000	013334'		JRST TYIET3	;TREAT AS BREAK
  8829	013323'	260040	013172'		PUSHJ P,TYID	;TREAT AS BREAK2
  8830	013324'	254000	013270'		JRST TYIL
  8831
  8832	013325'	254000	013334'	SPRETB:	JRST TYIET3	;^C
  8833	013326'	254000	013334'		JRST TYIET3	;33
  8834	013327'	254000	013334'		JRST TYIET3	;^_
  8835	013330'	254000	013334'		JRST TYIET3	;^Z
  8836	013331'	254000	013334'		JRST TYIET3	;175-176
  8837	013332'	205400	100000		MOVSI T3,L2LTBK	;TAB, CHECK BREAK OR BREAK2
  8838	013333'	205400	040000		MOVSI T3,L2LBBP	;BACKSPACE, CHECK BREAK OR BREAK2
  8839
  8840	013334'	370005	000015	TYIET3:	SOS LDBBKC(U)	;A BREAK CHR FINISHED
  8841	013335'	205300	100000	TYIET2:	MOVSI T1,LDLECS	;FINISHED BECAUSE OUT OF CHRS
  8842	013336'	412305	000031		ANDCAM T1,LDBDCH(U)	;TURN OFF FLAG IN ANY CASE
  8843	013337'	262040	000016		POP P,P3
  8844	013340'	262040	000010		POP P,T3
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 197-2
SCNSER.MAC	25-JAN-91 22:40		GET RID OF COMMAND LINE

  8845	013341'	500245	000031		HLL U,LDBDCH(U)
  8846	013342'	263040	000000		POPJ P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 198
SCNSER.MAC	25-JAN-91 22:40		TYO, CMDTYO - Put characters in TTY output buffer

  8847				SUBTTL	TYO, CMDTYO - Put characters in TTY output buffer
  8848				COMMENT %
  8849				@@SUBROUTINE TYO, CMDTYO
  8850				@@PURPOSE TYO -- CHECK FOR SPACE, PLACE CHAR IN OUTPUT BUFFER
  8851					  CMDTYO -- ASSUME SPACE, PLACE CHAR IN OUTPUT BUFFER
  8852				@@ENTRY	T3/ CHAR, F/ DDB ADDR, U/ (NONZERO) LDB ADDR
  8853				@@ACCUM	T1-T2 DESTROYED
  8854				@@EXIT	ON A SKIP-RETURN, THE CHARACTER HAS BEEN DEPOSITED.
  8855				THE NONSKIP-RETURN IS NOT ACTUALLY A RETURN BUT RATHER A
  8856				PUSHJ TO ITS CALLER. IT IS TAKEN WHEN THERE IS NO ROOM FOR
  8857				THE CHARACTER AND THE JOB WANTS A TRAP. THE CALLER HAS
  8858				THREE CHOICES:
  8859					1) ABORT THE UUO, GIVING THE JOB ITS TRAP
  8860					2) MAKING ROOM FOR THE CHARACTER, THEN POPJ-ING,
  8861					   CAUSING TYO TO RETRY THE DEPOSIT
  8862					3) AOS (P) / POPJ -ING, CAUSING TYO TO GO INTO
  8863					   OUTPUT WAIT
  8864				%
  8865
  8866	013343'	200300	017017'	TYO:	MOVE	T1,TTFREN	;T1/ # FREE CHUNKS
  8867	013344'	301300	000003		CAIL	T1,TIRSVD	;IF #FREE .lt. #SAVED,
  8868	013345'	254000	013351'		 JRST	TYO1
  8869	013346'	205300	200000		MOVSI	T1,TWTSPC
  8870	013347'	436304	000002		IORM	T1,DEVIOS(F)	;  MARK NO-CHUNKS WAIT
  8871	013350'	254000	013410'		JRST	TYOW2		;  AND GO WAIT
  8872
  8873	013351'	200305	000021	TYO1:	MOVE	T1,LDBTOC(U)	;T1/ # CHARS LEFT TO OUTPUT
  8874	013352'	335005	000032		SKIPGE	LDBDCX(U)	;IF IT'S FAST
  8875	013353'	311300	017126'		CAML	T1,OMX120	;AND UNDER THE FAST MAXIMUM,
  8876	013354'	315300	017124'		CAMGE	T1,OMX30	;OR IF IT'S UNDER THE SLOW MAXIMUM,
  8877	013355'	254000	013361'		 JRST	TYO2		;  CONTINUE OUTPUT.
  8878	013356'	335005	000027		SKIPGE	LDBBYT(U)	;IF IT'S NOT EXTENDED-MODE
  8879	013357'	311300	017130'		CAML	T1,TOEMAX	;OR IT'S OVER THAT LIMIT,
  8880	013360'	254000	013377'		 JRST	TYOW		;  GO TRAP OR WAIT
  8881	013361'	350001	000000	TYO2:	AOS	(P)		;PREPARE FOR SKIP-RETURN
  8882	013362'	500245	000031		HLL	U,LDBDCH(U)
  8883	013363'	603240	000400		TLNE	U,LDLOSU	;IF SUPPRESSING OUTPUT,
  8884	013364'	263040	000000		 POPJ	P,		;  JUST (SKIP-)RETURN
  8885
  8886				;CMDTYO - put character in output chunk.  Caller must check for room
  8887
  8888	013365'	332345	000017	CMDTYO:	SKIPE	T2,LDBTOP(U)	;IF NO CHUNK ALLOCATED,
  8889	013366'	254000	013373'		 JRST	TYO3
  8890	013367'	260040	006243'		PUSHJ	P,GETCHK	;  T2/ CHUNK BYTE POINTER
  8891	013370'	202345	000017		MOVEM	T2,LDBTOP(U)	;  SET OUTPUT PUTTER
  8892	013371'	202345	000020		MOVEM	T2,LDBTOT(U)	;  SET OUTPUT TAKER
  8893	013372'	402005	000021		SETZM	LDBTOC(U)	;  SET OUTPUT COUNT
  8894	013373'	260040	006177'	TYO3:	PUSHJ	P,TTPUTC	;STORE CHAR.; T2 := NEW PUTTER
  8895	013374'	202345	000017		MOVEM	T2,LDBTOP(U)	;STORE NEW PUTTER
  8896	013375'	350005	000021		AOS	LDBTOC(U)	;UPDATE COUNT
  8897	013376'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 199
SCNSER.MAC	25-JAN-91 22:40		TYO, CMDTYO - Put characters in TTY output buffer

  8898	013377'	135300	000230'	TYOW:	LDB	T1,DDPTTI	;T1/ IOW TRAP CHANNEL
  8899	013400'	260040	013054*		PUSHJ	P,TSTKTJ	;SETUP TRAP IF ENABLED. IF IT WAS,
  8900	013401'	260040	016307'		  PUSHJ	P,SETFIO	;  MARK DDB FOR OUTPUT-DONE TRAP
  8901	013402'	135300	011660*		LDB	T1,PJOBN
  8902	013403'	331002	013061*		SKIPL	JBTAWQ(J)	;IF AWAITING A TRAP,
  8903	013404'	254000	013407'		 JRST	TYOW1
  8904	013405'	260061	000000		PUSHJ	P,@(P)		;  RETURN TO CALLER AS COROUTINE
  8905	013406'	254000	013343'		JRST	TYO		;  (NONSKIP FROM RECALLED CALLER)
  8906
  8907	013407'	322240	013413'	TYOW1:	JUMPE	U,TYOW3		;IF ATTACHED,
  8908	013410'	201300	000001	TYOW2:	MOVEI	T1,1
  8909	013411'	137300	000075'		DPB	T1,LOPOUT	;  SET CHARACTER-OUTPUT
  8910	013412'	137305	000002		DPB	T1,LDBOPB(U)	;  AND NEED-OUTPUT
  8911	013413'	260040	013736'	TYOW3:	PUSHJ	P,TOWAT1	;GO INTO OUTPUT WAIT
  8912	013414'	550244	000013	TYOW4:	HRRZ	U,DDBLDB(F)
  8913	013415'	326240	013343'		JUMPN	U,TYO		;IF STILL ATTACHED, TRY AGAIN
  8914	013416'	205300	020000		MOVSI	T1,TTYATC
  8915	013417'	616304	000004		TDNN	T1,DEVMOD(F)	;IF IT'S NOT THE COMMAND PORT,
  8916	013420'	324740	011143'		PJRST	AUXRID		;  DISCARD DDB AND ABORT UUO
  8917	013421'	254000	013377'		JRST	TYOW		;OTHERWISE, WAIT FOR ATTACH
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 200
SCNSER.MAC	25-JAN-91 22:40		MAKE SURE TTY IS ATTACHED, NO CHANCE FOR INTERRUPT

  8918				SUBTTL	MAKE SURE TTY IS ATTACHED, NO CHANCE FOR INTERRUPT
  8919
  8920	013422'	200004	000002	CKATTF:	MOVE	S,DEVIOS(F)
  8921	013423'	550244	000013		HRRZ	U,DDBLDB(F)
  8922	013424'	326240	013554'		JUMPN	U,UUOLDB
  8923	013425'	205300	020000		MOVSI	T1,TTYATC
  8924	013426'	616304	000004		TDNN	T1,DEVMOD(F)
  8925	013427'	254000	011143'		 JRST	AUXRID		;CAN GET RID OF DDB FOR AUX CIRCUIT
  8926	013430'	260040	014613'		PUSHJ	P,TOWATA
  8927	013431'	254000	013422'		JRST	CKATTF		;TRY AGAIN
  8928
  8929				;CHECK TO SEE THAT THERE IS ROOM FOR AT LEAST ONE CHARACTER TO BE OUTPUT
  8930
  8931	013432'	554305	000005	CHKROM:	HLRZ	T1,LDBBIO(U)	;BLOCK OUTPUT NOW IN PROGRESS?
  8932	013433'	326300	013444'		JUMPN	T1,CHKRM1	;YES. QUEUE JOB FOR OUTPUT WAIT.
  8933	013434'	200300	017017'		MOVE	T1,TTFREN
  8934	013435'	305300	000003		CAIGE	T1,TIRSVD	;IS THERE BUFFER SPACE?
  8935	013436'	254000	013455'		 JRST	CHKRM3
  8936	013437'	200305	000021		MOVE	T1,LDBTOC(U)	;NUMBER NOW IN OUTPUT BUFFER
  8937	013440'	335005	000032		SKIPGE	LDBDCX(U)	;IF IT'S FAST
  8938	013441'	311300	017126'		CAML	T1,OMX120	;AND UNDER THE FAST MAXIMUM,
  8939	013442'	315300	017124'		 CAMGE	T1,OMX30	;OR IF IT'S UNDER THE SLOW MAXIMUM,
  8940	013443'	254000	013163*		  JRST	CPOPJ1		;  SAY THERE'S ROOM
  8941	013444'	135100	013402*	CHKRM1:	LDB	J,PJOBN
  8942	013445'	335002	013403*		SKIPGE	JBTAWQ(J)	;ABORT UUO IF TRAP IS PENDING
  8943	013446'	254000	013261*		 JRST	ABTUUO
  8944	013447'	135300	000230'		LDB	T1,DDPTTI
  8945	013450'	260040	000000*		PUSHJ	P,TSTKTP	;SEE IF WE CAN TAKE AN INTERRUPT
  8946	013451'	334000	000000		  SKIPA			;YES, MUST MAKE SURE WE SET OUTPUT ROOM FLAG
  8947	013452'	254000	013736'		JRST	TOWAT1		;QUEUE JOB FOR OUTPUT WAIT.
  8948
  8949	013453'	260040	016307'	CHKRM2:	PUSHJ	P,SETFIO
  8950	013454'	254000	013446*		JRST	ABTUUO		;NOW GET OUT OF UUO
  8951
  8952				;HERE WHEN THERE'RE NO BUFFERLETS AVAILABLE FOR THE OUTPUT
  8953
  8954	013455'	135300	000230'	CHKRM3:	LDB	T1,DDPTTI
  8955	013456'	260040	013400*		PUSHJ	P,TSTKTJ	;DOES HE GET AN I/O WAIT TRAP?
  8956	013457'	254000	013453'		  JRST	CHKRM2		;YES: DO IT
  8957	013460'	205300	200000		MOVSI	T1,TWTSPC
  8958	013461'	436304	000002		IORM	T1,DEVIOS(F)	;NO: MARK REASON FOR WAIT
  8959	013462'	324740	013736'		PJRST	TOWAT1		;    AND DO IT
  8960
  8961
  8962				; CALL TO SEE IF ROOM FOR A CHARACTER
  8963				; U/LDB
  8964				; PUSHJ P,IFROOM
  8965				;  <NO ROOM>
  8966				; <ROOM>
  8967
  8968	013463'	200300	017017'	IFROOM:	MOVE	T1,TTFREN	;Number of buffer chunks
  8969	013464'	305300	000003		CAIGE	T1,TIRSVD	;Is there buffer space?
  8970	013465'	263040	000000		 POPJ	P,		;No, last 3 chunks reserved for emergencies
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 200-2
SCNSER.MAC	25-JAN-91 22:40		MAKE SURE TTY IS ATTACHED, NO CHANCE FOR INTERRUPT

  8971	013466'	550300	000005		HRRZ	T1,U		;Get LDB address
  8972	013467'	306300	000105'		CAIN	T1,CTYLDB	;Sending to the CTY?
  8973					 JRST	[MOVE	T1,TTFREN
  8974						 CAIL	T1,TIRSVD+5
  8975						  AOS	(P)	;CTY can use all but the last 10 chunks
  8976	013470'	254000	020011'			 POPJ	P,]	
  8977	013471'	200305	000021		MOVE	T1,LDBTOC(U)	;Number of characters currently in buffer
  8978	013472'	335005	000032		SKIPGE	LDBDCX(U)	;If it's fast
  8979	013473'	311300	017126'		CAML	T1,OMX120	; and under the fast maximum,
  8980	013474'	315300	017124'		 CAMGE	T1,OMX30	; or if it's under the slow maximum,
  8981	013475'	350001	000000		  AOS	(P)		;  say there's room
  8982	013476'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 201
SCNSER.MAC	25-JAN-91 22:40		SUBROUTINES TO SET UP LINE AND MAKE SURE ATTACHED.

  8983				SUBTTL	SUBROUTINES TO SET UP LINE AND MAKE SURE ATTACHED.
  8984				;CALL WITH F SET UP, FROM M LEVEL ONLY.
  8985				;RETURN WHEN ATTACHED AND AT USER LEVEL, WITH U SET UP.
  8986
  8987				;ONE ROUTINE FOR INPUT, ONE FOR OUTPUT.
  8988
  8989	013477'	200004	000002	CKATTI:	MOVE	S,DEVIOS(F)	;SET UP STATUS WORD
  8990	013500'	550244	000013		HRRZ	U,DDBLDB(F)	;GET LINE BLOCK ADDR
  8991	013501'	326240	013505'		JUMPN	U,CKATI2	;IF THERE, GO ON
  8992	013502'	205300	020000		MOVSI	T1,TTYATC
  8993	013503'	616304	000004		TDNN	T1,DEVMOD(F)
  8994	013504'	254000	013443*		 JRST	CPOPJ1		;AUX CIRCUIT, SPECIAL
  8995	013505'	135300	013444*	CKATI2:	LDB	T1,PJOBN	;NOW CHECK IF JOB WAITING FOR
  8996	013506'	335006	013445*		SKIPGE	JBTAWQ(T1)	;AN INTERRUPT
  8997	013507'	263040	000000		 POPJ	P,		;YES
  8998	013510'	326240	013524'		JUMPN	U,CKATI1
  8999	013511'	332000	017205'	CKATIW:	SKIPE	SKPFLG		;DON'T WAIT FOR ATTACH IF INC AND SKP AUXCAL
  9000	013512'	263040	000000		 POPJ	P,
  9001	013513'	135300	000230'		LDB	T1,DDPTTI
  9002	013514'	260040	013456*		PUSHJ	P,TSTKTJ	;IS THIS AN IOW INTERRUPT
  9003	013515'	263040	000000		 POPJ P,		;YES
  9004	013516'	205000	400020		MOVSI	S,IO+TTYOUW	;MUST WAIT FOR ATTACH
  9005	013517'	412004	000002		ANDCAM	S,DEVIOS(F)	;CLEAR DIRECTION BIT
  9006	013520'	201000	010000		MOVEI	S,IOACT		;AND SET WAIT BIT FOR INPUT
  9007	013521'	437004	000002		IORB	S,DEVIOS(F)	; ..
  9008	013522'	260040	013740'		PUSHJ	P,WSYNCS	;WAIT FOR ATTACH
  9009	013523'	254000	013477'		JRST	CKATTI		;GET U SET UP AND RETURN.
  9010
  9011	013524'	500245	000031	CKATI1:	HLL	U,LDBDCH(U)		;GET DEVICE BITS
  9012	013525'	603240	020000		TLNE	U,LDLCOM		;AT COMMAND LEVEL?
  9013	013526'	254000	013511'		 JRST	CKATIW			;YES. CAN'T1 DO INPUT.
  9014	013527'	260040	013264'		PUSHJ	P,TYIEAT		;NO. SKIP ANY COMMANDS
  9015	013530'	350001	000000		AOS	(P)
  9016	013531'	324740	013554'		PJRST	UUOLDB			;AND GO ADJUST LINE BITS.
  9017
  9018	013532'	200004	000002	CKATTO:	MOVE	S,DEVIOS(F)		;SET UP STATUS WORD
  9019	013533'	550244	000013		HRRZ	U,DDBLDB(F)		;GET LINE ADDR IF ANY
  9020	013534'	326240	013540'		JUMPN	U,CKATO2		;IF HAVE ONE, SEE IF TOP LEVEL
  9021	013535'	205300	020000		MOVSI	T1,TTYATC
  9022	013536'	616304	000004		TDNN	T1,DEVMOD(F)
  9023	013537'	254000	013504*		 JRST	CPOPJ1
  9024	013540'	135300	013505*	CKATO2:	LDB	T1,PJOBN
  9025	013541'	335006	013506*		SKIPGE	JBTAWQ(T1)
  9026	013542'	263040	000000		 POPJ	P,			;WAITING FOR INTERRUPT
  9027	013543'	326240	013551'		JUMPN	U,CKATO1
  9028	013544'	135300	000230'		LDB	T1,DDPTTI
  9029	013545'	260040	013514*		PUSHJ	P,TSTKTJ
  9030	013546'	324740	016307'		  PJRST	SETFIO			; INTERRUPT ON IOW
  9031	013547'	260040	014613'		PUSHJ	P,TOWATA		;WAIT FOR OUTPUT DONE. (WHICH
  9032									; IS FORCED ON ATTACH)
  9033	013550'	254000	013532'		JRST	CKATTO			;AND SET UP U, TO RETURN.
  9034	013551'	350001	000000	CKATO1:	AOS	(P)
  9035	013552'	205300	400000		MOVSI	T1,L2LOEX
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 201-2
SCNSER.MAC	25-JAN-91 22:40		SUBROUTINES TO SET UP LINE AND MAKE SURE ATTACHED.

  9036	013553'	412305	000027		ANDCAM	T1,LDBBYT(U)		;TURN OFF EXTENDED OUTPUT
  9037					PFALL	UUOLDB			;FALL INTO UUOLDB
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 202
SCNSER.MAC	25-JAN-91 22:40		UUOLDB - MAKE LDB (ADDR IN U) AGREE WITH FILE STATUS BITS (IN S)

  9038				SUBTTL	UUOLDB - MAKE LDB (ADDR IN U) AGREE WITH FILE STATUS BITS (IN S)
  9039
  9040	013554'	322240	013173*	UUOLDB:	JUMPE	U,CPOPJ		;JUST IN CASE
  9041	013555'	500245	000031		HLL	U,LDBDCH(U)	;MAKE SURE LEFT HALF SET
  9042	013556'	603240	000040		TLNE	U,LDLAUX
  9043	013557'	263040	000000		 POPJ	P,		;DO NOTHING FOR AN AUX CIRCUIT
  9044
  9045				    ;SET MONITOR MODE BITS
  9046
  9047	013560'	261040	000002		PUSH	P,J
  9048	013561'	135100	013540*		LDB	J,PJOBN
  9049	013562'	135440	000000*		LDB	T4,PVYMOD
  9050	013563'	137440	000165'		DPB	T4,LDPMOD
  9051	013564'	262040	000002		POP	P,J		;SET MODE
  9052
  9053				    ;SET LDBDCX BITS
  9054
  9055	013565'	200305	000032		MOVE	T1,LDBDCX(U)
  9056	013566'	602000	000400		TRNE	S,DLRSUP
  9057	013567'	665300	020000		TLOA	T1,LXLDLR	;SUPPRESS-$
  9058	013570'	621300	020000		 TLZ	T1,LXLDLR	;DON'T SUPPRESS $
  9059	013571'	202305	000032		MOVEM	T1,LDBDCX(U)
  9060
  9061				    ;GET LDB BITS FROM FILE STATUS BITS
  9062
  9063	013572'	400300	000000		SETZ	T1,
  9064	013573'	602000	000100		TRNE	S,FCS
  9065	013574'	660300	020000		 TRO	T1,LDRFCS
  9066	013575'	602000	000200		TRNE	S,NOECHO
  9067	013576'	661300	000100		 TLO	T1,LDLNEC
  9068	013577'	603000	100000		TLNE	S,IOSBKA
  9069	013600'	661300	010000		 TLO	T1,LDLBKA
  9070	013601'	602000	001000		TRNE	S,BK2IOS
  9071	013602'	661300	004000		 TLO	T1,LDLBK2
  9072
  9073				    ;SET THE LDBDCH BITS
  9074
  9075	013603'	200440	000006		MOVE	T4,T1
  9076	013604'	430445	000031		XOR	T4,LDBDCH(U)	;T4/ THE BITS THAT CHANGED
  9077	013605'	436305	000031		IORM	T1,LDBDCH(U)
  9078	013606'	650300	020015'		TDC	T1,[LDLNEC!LDLBKA!LDLBK2,,LDRFCS]
  9079	013607'	413305	000031		ANDCAB	T1,LDBDCH(U)
  9080	013610'	500240	000006		HLL	U,T1		;UPDATE LH(U)
  9081
  9082				    ;FINISH UP
  9083
  9084	013611'	200004	000002		MOVE	S,DEVIOS(F)	;UPDATE S
  9085	013612'	603440	000100		TLNE	T4,LDLNEC	;IF WE'RE CHANGING ECHO MODE
  9086	013613'	602300	040000		TRNE	T1,LDRDEM	;AND LDRDEM NOT SET,
  9087	013614'	324740	007603'		 PJRST	SETLMD
  9088	013615'	201300	000001		MOVEI	T1,1		;  SET TO CHANGE ECHO MODE
  9089	013616'	137300	000067'		DPB	T1,LOPSEC
  9090	013617'	137305	000002		DPB	T1,LDBOPB(U)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 202-2
SCNSER.MAC	25-JAN-91 22:40		UUOLDB - MAKE LDB (ADDR IN U) AGREE WITH FILE STATUS BITS (IN S)

  9091	013620'	324740	007603'		PJRST	SETLMD		;AND GO SET LINE MODE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 203
SCNSER.MAC	25-JAN-91 22:40		UUOLDB - MAKE LDB (ADDR IN U) AGREE WITH FILE STATUS BITS (IN S)

  9092	013621'	205000	100000	TWAITL:	MOVSI S,IOSBKA
  9093	013622'	413004	000002		ANDCAB S,DEVIOS(F)
  9094	013623'	205300	010000		MOVSI T1,LDLBKA
  9095	013624'	412305	000031		ANDCAM T1,LDBDCH(U)	;SET FOR LINE MODE INPUT
  9096	013625'	260040	007603'		PUSHJ P,SETLMD
  9097	013626'	200305	000012		MOVE T1,LDBTIC(U)
  9098	013627'	500245	000031		HLL U,LDBDCH(U)	;MAKE SURE LINE IS OK
  9099	013630'	200445	000015		MOVE T4,LDBBKC(U)	;GET BREAK COUNT
  9100	013631'	603240	004000		TLNE U,LDLBK2	;IF IN BREAK2 MODE
  9101	013632'	270445	000016		 ADD T4,LDBBK2(U)	;NUMBER IS SUM
  9102	013633'	305300	000110		CAIGE T1,TIWKC
  9103	013634'	602440	777777		TRNE T4,-1		;IF A BREAK OR ENOUGH CHRS
  9104	013635'	263040	000000		 POPJ P,			;GO NOW
  9105	013636'	607240	002000		TLNN U,LDLIMI	;IN IMAGE MODE?
  9106	013637'	254000	013646'		 JRST TWTL1		;NO, MUST WAIT
  9107	013640'	336005	000012		SKIPN LDBTIC(U)	;YES, ANY CHRS?
  9108	013641'	603000	000040		TLNE S,IOEND		;OR END OF FILE SET
  9109	013642'	263040	000000		 POPJ P,			;IF END FLAGGED, THEN DONE
  9110	013643'	332005	000014		SKIPE LDBECC(U)	;ARE THERE ANY CHRS THERE AT ALL?
  9111	013644'	254000	013655'		 JRST TWTL2	;YES, I/O WAIT BUT NO TRAP
  9112	013645'	254000	013652'		JRST TWTL3	;NO, I/O WAIT WITH POSSIBLE TRAP
  9113	013646'	326440	013655'	TWTL1:	JUMPN T4,TWTL2	;IF UNECHOED BREAK CHRS, I/O WAIT NO TRAP
  9114	013647'	270305	000014		ADD T1,LDBECC(U)
  9115	013650'	301300	000110		CAIL T1,TIWKC	;OR POSSIBLEY TOO MANY TOTAL
  9116	013651'	254000	013655'		 JRST TWTL2	;I/O WAIT NO TRAP
  9117	013652'	135300	000230'	TWTL3:	LDB T1,DDPTTI	;CHECK FOR TRAP WANTED
  9118	013653'	260040	013545*		PUSHJ P,TSTKTJ		;SEE IF INTERRUPT ON IOW
  9119	013654'	254000	013454*		 JRST ABTUUO		;YES, ABORT
  9120	013655'	260040	013720'	TWTL2:	PUSHJ P,TIWAIT
  9121	013656'	260040	013477'		PUSHJ P,CKATTI
  9122	013657'	254000	013654*		 JRST ABTUUO
  9123	013660'	326240	013621'		JUMPN U,TWAITL
  9124	013661'	254000	011143'		JRST AUXRID	;ZAPPED AUX CIRCUIT
  9125
  9126	013662'			TWAITS:	;AOS	SKPFLG	;CALLED BY AN INPUT AND SKIP AUXCAL
  9127	013662'	255000	000000		JFCL		;FOR NOW UNTIL CAN FIND OUT WHY SKPFLG STAYS SET
  9128							;WHEN SHOULDN'T
  9129	013663'	350001	000000		AOS	(P)	;SET TO SKIP RETURN
  9130	013664'	205000	100000	TWAITC:	MOVSI S,IOSBKA
  9131	013665'	437004	000002		IORB S,DEVIOS(F)
  9132	013666'	205300	010000		MOVSI T1,LDLBKA
  9133	013667'	436305	000031		IORM T1,LDBDCH(U)
  9134	013670'	260040	007603'		PUSHJ P,SETLMD
  9135	013671'	500245	000031		HLL U,LDBDCH(U)	;MAKE SURE LINE OK FOR CALLERS
  9136	013672'	333005	000012		SKIPLE LDBTIC(U)	;ANY CHARACTERS PRESENT?
  9137	013673'	263040	000000		POPJ P,
  9138	013674'	332005	000014		SKIPE LDBECC(U)
  9139	013675'	254000	013701'		JRST TWTC1	;SOME CHRS SO NO I/O TRAP
  9140	013676'	135300	000230'		LDB T1,DDPTTI
  9141	013677'	260040	013653*		PUSHJ P,TSTKTJ		;CHECK IOW WAIT INTERRUPT
  9142	013700'	254000	013716'		 JRST 	TWABT		;GET OUT
  9143	013701'	260040	013720'	TWTC1:	PUSHJ P,TIWAIT
  9144	013702'	260040	013477'		PUSHJ P,CKATTI
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 203-2
SCNSER.MAC	25-JAN-91 22:40		UUOLDB - MAKE LDB (ADDR IN U) AGREE WITH FILE STATUS BITS (IN S)

  9145	013703'	254000	013716'		 JRST 	TWABT	;WAITING FOR INTERRUPT
  9146	013704'	200300	017205'		MOVE	T1,SKPFLG
  9147	013705'	402000	017205'		SETZM	SKPFLG
  9148	013706'	326240	013714'		JUMPN	U,TWTC2		;JUMP IF LINE ATTACHED
  9149	013707'	205300	020000		MOVSI	T1,TTYATC
  9150	013710'	616304	000004		TDNN	T1,DEVMOD(F)
  9151	013711'	254000	011143'		JRST	AUXRID		;ZAPPED AUX CIRCUIT
  9152	013712'	370001	000000		SOS	(P)		;ZAPPED CMD PORT FROM INC AND SKP AUXCAL
  9153	013713'	263040	000000		POPJ	P,
  9154	013714'	325300	013664'	TWTC2:	JUMPGE	T1,TWAITC	;GET ENOUGH INPUT CHARS?
  9155	013715'	263040	000000		POPJ	P,		;NO
  9156
  9157	013716'	402000	017205'	TWABT:	SETZM	SKPFLG
  9158	013717'	254000	013657*		JRST	ABTUUO
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 204
SCNSER.MAC	25-JAN-91 22:40		UUOLDB - MAKE LDB (ADDR IN U) AGREE WITH FILE STATUS BITS (IN S)

  9159	013720'	205000	400020	TIWAIT:	MOVSI S,IO!TTYOUW
  9160	013721'	412004	000002		ANDCAM S,DEVIOS(F)	;SET DIRECTION
  9161	013722'	201000	010000		MOVEI S,IOACT
  9162	013723'	437004	000002		IORB S,DEVIOS(F)	;SET WAIT BIT
  9163	013724'	201300	000012		MOVEI T1,IMGTIM
  9164	013725'	603240	002000		TLNE U,LDLIMI
  9165	013726'	137300	000174'		DPB T1,LDPTIM		;SET TIMER IF IN IMAGE MODE
  9166	013727'	201300	000001		MOVEI T1,1
  9167	013730'	137300	000102'		DPB T1,LOPECO		;SET ECHO-NEEDED
  9168	013731'	137305	000002		DPB T1,LDBOPB(U)	;AND NEED-OUTPUT
  9169	013732'	254000	013740'		JRST WSYNCS
  9170
  9171				;ROUTINE TO WAIT FOR NEARLY EMPTY OUTPUT BUFFER. CALL ONLY AT UUO LEVEL
  9172	013733'	200305	000021	TOWAIT:	MOVE T1,LDBTOC(U)		;GET COUNT OF TYPE-OUT CHARACTERS WAITING.
  9173	013734'	305300	000010		CAIGE T1,10			;OVER 7?
  9174	013735'	263040	000000		POPJ P,0			;NO. JUST RETURN.
  9175	013736'	200000	020016'	TOWAT1:	MOVE S,[XWD TTYOUW+IO,IOACT]	;FLAG OUTPUT WAIT ACTIVITY
  9176	013737'	436004	000002		IORM S,DEVIOS(F)		;IN THE DEVICE DATA BLOCK
  9177	013740'	205000	020000	WSYNCS:	MOVSI S,TIOUSE
  9178	013741'	437004	000002		IORB S,DEVIOS(F)
  9179	013742'	261040	000014		PUSH P,P1			;HAVE TO SAVE AC'S TO WAIT
  9180	013743'	261040	000015		PUSH P,P2			; BECAUSE WSYNC USES THESE
  9181	013744'	261040	000010		PUSH P,T3
  9182	013745'	261040	000004		PUSH P,F
  9183	013746'	261040	000012		PUSH P,W
  9184	013747'	260040	000627'		PUSHJ P,SCNINT		;GIVE HIM A CHANCE TO ECHO BEFORE PUTTING HIM IN WAIT
  9185	013750'	262040	000012		POP P,W
  9186	013751'	262040	000004		POP P,F
  9187	013752'	262040	000010		POP P,T3
  9188	013753'	200004	000002		MOVE	S,DEVIOS(F)	
  9189	013754'	606000	010000		TRNN	S,IOACT		;DO WE NEED TO GO INTO WAIT?
  9190	013755'	254000	013764'		JRST	WSYNC1		;NO
  9191	013756'	336000	017205'		SKIPN	SKPFLG		;INPUT AND SKIP CALL IN PROGRESS?
  9192	013757'	254000	013763'		JRST	WSYNC2		;NO
  9193	013760'	476000	017205'		SETOM	SKPFLG		;COULDN'T GET ENOUGH INPUT CHARS
  9194	013761'	260040	006022'		PUSHJ	P,TIWAKN	;DON'T BLOCK
  9195	013762'	334000	000000		SKIPA
  9196	013763'	260040	000000*	WSYNC2:	PUSHJ P,WSYNC			;WAIT
  9197	013764'	262040	000015	WSYNC1:	POP P,P2			;RESTORE AC'S
  9198	013765'	262040	000014		POP P,P1			; ..
  9199	013766'	205000	020000		MOVSI S,TIOUSE
  9200	013767'	413004	000002		ANDCAB S,DEVIOS(F)
  9201	013770'	263040	000000		POPJ P,0			;AND RETURN FROM TOWAIT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 205
SCNSER.MAC	25-JAN-91 22:40		BACKPRESSURE ADJUSTERS

  9202				SUBTTL BACKPRESSURE ADJUSTERS
  9203
  9204				;BPLVD - CALLED BY LEVDEF UUO
  9205
  9206	013771'	201300	600000	BPLVD:	MOVEI	T1, LDRXOS!LDRBPS
  9207	013772'	612305	000031		TDNE	T1, LDBDCH(U)	;IF WE'VE SENT BACKPRESSURE OR AN XOFF
  9208	013773'	254000	013776'		 JRST	BPLVD1
  9209	013774'	135300	000063'		LDB	T1, LOPBPN
  9210	013775'	322300	013554*		JUMPE	T1, CPOPJ	;OR WE'RE PLANNING TO,
  9211	013776'	200305	000014	BPLVD1:	MOVE	T1, LDBECC(U)
  9212	013777'	270305	000012		ADD	T1, LDBTIC(U)
  9213	014000'	301300	000110		CAIL	T1, TIWKC	;AND WE DON'T HAVE GOBS OF CHARACTERS,
  9214	014001'	263040	000000		 POPJ	P,
  9215	014002'	254000	014023'		JRST	BPFCOM		;  SET TO CLEAR BACKPRESSURE
  9216
  9217				;BPFTYI - CALLED AT THE START OF TYI
  9218
  9219	014003'	201300	600000	BPFTYI:	MOVEI	T1, LDRXOS!LDRBPS
  9220	014004'	612305	000031		TDNE	T1, LDBDCH(U)	;IF WE'VE SENT BACKPRESSURE OR AN XOFF
  9221	014005'	254000	014010'		 JRST	.+3
  9222	014006'	135300	000063'		LDB	T1, LOPBPN
  9223	014007'	322300	013775*		JUMPE	T1, CPOPJ	;OR WE'RE PLANNING TO,
  9224	014010'	200305	000014		MOVE	T1, LDBECC(U)
  9225	014011'	270305	000012		ADD	T1, LDBTIC(U)
  9226	014012'	301300	000010		CAIL	T1, 10		;AND WE HAVE HARDLY ANY CHARACTERS,
  9227	014013'	263040	000000		 POPJ	P,
  9228	014014'	254000	014023'		JRST	BPFCOM		;  SET TO CLEAR BACKPRESSURE
  9229
  9230				;BPXOFF - CALLED WHEN DONE ECHOING, ON CLRBFI, BEFORE DOING
  9231				;	   BLOCK INPUT, AFTER READING COMMAND LINE
  9232				;BPOFF - CALLED WHEN ENTERING COMMAND LEVEL, WHEN FORCED
  9233				;	  OUT OF IMAGE STATE BY SCNSEC OR CLRIMI
  9234
  9235	014015'	334300	020017'	BPXOFF:	SKIPA	T1, [LDRBPS!LDRXOS]
  9236	014016'	201300	400000	BPOFF:	MOVEI	T1, LDRBPS
  9237	014017'	612305	000031		TDNE	T1, LDBDCH(U)	;IF WE'VE SEND BACKPRESSURE (OR XOFF)
  9238	014020'	254000	014023'		JRST	BPFCOM
  9239	014021'	135300	000063'		LDB	T1, LOPBPN	;OR WE'RE ABOUT TO,
  9240	014022'	322300	014007*		JUMPE	T1, CPOPJ
  9241					PFALL	BPFCOM		;  SET TO CLEAR BACKPRESSURE
  9242
  9243	014023'	201300	000001	BPFCOM:	MOVEI	T1, 1
  9244	014024'	137300	000064'		DPB	T1, LOPBPF	;SET BACKPRESSURE-OFF
  9245	014025'	137305	000002		DPB	T1, LDBOPB(U)	;AND NEED-OUTPUT
  9246	014026'	263040	000000		POPJ	P,
  9247
  9248				;ROUTINE TO CHECK TO SEE IF BACKPRESSURE SHOULD BE TURNED OFF.  SKIP RETURNS
  9249				;IF SHOULD NOT BE TURNED OFF ELSE NON-SKIP RETURNS
  9250				;
  9251	014027'	261040	000006	BPTEST:	PUSH	P,T1
  9252	014030'	200305	000012		MOVE	T1,LDBTIC(U)	;COMPUTE TOTAL NUMBER
  9253	014031'	270305	000014		ADD	T1,LDBECC(U)	; OF CHARACTERS WAITING
  9254	014032'	317300	017117'		CAMG	T1,TIWRNN	;GREATER THAN BACKPRESSURE ON THRESHOLD?
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 205-2
SCNSER.MAC	25-JAN-91 22:40		BACKPRESSURE ADJUSTERS

  9255	014033'	254000	010365*		 JRST	TPOPJ		;NO, TURN OFF BACKPRESSURE
  9256	014034'	254000	010371*		JRST	TPOPJ1		;YES, LEAVE BACKPRESSURE ON
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 206
SCNSER.MAC	25-JAN-91 22:40		COMMAND ROUTINES

  9257				SUBTTL COMMAND ROUTINES
  9258
  9259				;ROUTINE TO MAKE THIS TTY VISIBLE TO COMMAND DECODER, IF AT COM LEVEL
  9260				;CALL WITH U SET UP
  9261
  9262	014035'	336000	017203'	CMDWAK:	SKIPN	FRSFLG		;IF IT'S JUST THE RESCAN-STUFFER,
  9263	014036'	254000	014041'		 JRST	CMDWK1
  9264	014037'	402000	017203'		SETZM	FRSFLG		;  TELL IT WE GOT HERE
  9265	014040'	263040	000000		POPJ	P,
  9266	014041'	607240	020000	CMDWK1:	TLNN	U,LDLCOM	;IS LINE AT COMMAND LEVEL?
  9267	014042'	263040	000000		 POPJ	P,0		;NO. JUST RETURN
  9268	014043'	205300	010000		MOVSI	T1,L2LLDF
  9269	014044'	412305	000027		ANDCAM	T1,LDBBYT(U)	;RESET FLAG, USER AWAKE
  9270	014045'	400300	000000		SETZ	T1,		;Indicate to COMWCM that command comes
  9271								;from terminal
  9272				; Enter here with command index in T1 (or 0 if not forced command)
  9273	014046'	261040	000004	TTFORC:	PUSH	P,F		;Preserve
  9274	014047'	135200	000101'		LDB	F,LOPZAP	;If we're going to ZAP it,
  9275	014050'	326200	014060'		JUMPN	F,FPOPJ		; ignore the command
  9276	014051'	550205	000000		HRRZ	F,LDBDDB(U)	;Set up DDB pointer
  9277	014052'	322200	014060'		JUMPE	F,FPOPJ		;None there, just exit
  9278	014053'	261040	000002		PUSH	P,J
  9279	014054'	135100	013561*		LDB	J,PJOBN		;Find job/frame number
  9280	014055'	332000	000002		SKIPE	J		;None there...
  9281	014056'	260040	000000*		PUSHJ	P,COMWCM##	;Set command request for this job/frame
  9282	014057'	262040	000002		POP	P,J
  9283	014060'	262040	000004	FPOPJ:	POP	P,F
  9284	014061'	263040	000000		POPJ	P,
  9285
  9286				;;
  9287				;; Routine to set up command input pointer to accept command
  9288				;;  input from TTY.  Clobbers T2.
  9289				;;
  9290	014062'	200345	000011	TRESCN::MOVE	T2,LDBTIT(U)	;TTY input buffer pointer
  9291	014063'	202340	017026'		MOVEM	T2,TTCMCA	;Copy into command input pointer
  9292	014064'	201400	000040		MOVEI	T3,40		;Delimiter
  9293	014065'	202400	017025'		MOVEM	T3,TTCMCH
  9294	014066'	263040	000000		POPJ	P,
  9295
  9296				;COMTYO - Output character in T3, preserving T2, uses T1
  9297
  9298	014067'	261040	000007	COMTYO::PUSH	P,T2		;Save T2 as advertised
  9299	014070'	260060	000000*		PUSHJ	P,@.CPTOA##	;Call CCTYO or routine in ONCE
  9300	014071'	254000	000000*		JRST	T2POPJ##	;Restore T2 and return
  9301
  9302				;CCTYO - usual output routine for .CPTOA
  9303
  9304	014072'	550300	000005	CCTYO::	HRRZ	T1,U		;Just the LDB address
  9305	014073'	322300	014022*		JUMPE	T1,CPOPJ	;Ignore if line not set up
  9306	014074'	306300	000105'		CAIN	T1,CTYLDB	;If output is going to the CTY,
  9307	014075'	260040	014456'		 PUSHJ	P,MSGLOG	;Log char in MSGBUF (high phys mem)
  9308	014076'	260040	013463'		PUSHJ	P,IFROOM	;Space in this guy's area?
  9309	014077'	263040	000000		  POPJ	P,		;No, ignore further attempts at output
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 206-2
SCNSER.MAC	25-JAN-91 22:40		COMMAND ROUTINES

  9310	014100'	260040	013365'		PUSHJ	P,CMDTYO	;Put character in output chunks
  9311	014101'	324740	007121'		PJRST	ONEOU3		;And start output
  9312
  9313
  9314	014102'	332340	017026'	CCTYI::	SKIPE T2,TTCMCA		;REAL INPUT ROUTINE FOR COMMAND
  9315	014103'	316345	000010		CAMN T2,LDBTIP(U)	;NOTHING OR AT END OF BUFFER
  9316	014104'	254000	014111'		 JRST CCTYI1		;GO FAKE A BREAK
  9317	014105'	260040	006152'		PUSHJ P,TTGETC
  9318	014106'	255000	000000		  JFCL
  9319	014107'	202340	017026'		MOVEM T2,TTCMCA
  9320	014110'	263040	000000		POPJ P,
  9321
  9322	014111'	201400	000012	CCTYI1:	MOVEI T3,12
  9323	014112'	263040	000000		POPJ P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 207
SCNSER.MAC	25-JAN-91 22:40		COMMAND INPUT ROUTINE

  9324				SUBTTL	COMMAND INPUT ROUTINE
  9325
  9326	014113'	260040	014116'	COMTYI::PUSHJ P,COMTYT	;FETCH A CHARACTER
  9327	014114'	275400	000040		 SUBI T3,40	;UPSHIFT LOWER CASE
  9328	014115'	263040	000000		POPJ P,
  9329
  9330	014116'	200400	017025'	COMTYT::MOVE T3,TTCMCH
  9331	014117'	302400	000003		CAIE T3,3
  9332	014120'	306400	000012		CAIN T3,12	;THESE ARE FINISHED FLAGS
  9333	014121'	254000	013537*		 JRST CPOPJ1	;DO NOT TRY TO READ FURTHER
  9334	014122'	261040	000007		PUSH P,T2
  9335	014123'	261040	000016		PUSH P,P3	;SAVE REGISTERS FOR CALLERS
  9336	014124'	500245	000031		HLL U,LDBDCH(U)
  9337	014125'	260060	000000*	COMTI1:	PUSHJ P,@.CPTIA	;GET A CHR
  9338	014126'	405400	000177		ANDI T3,177	;NOT INTERESTED IN EXTRA BITS
  9339	014127'	200710	000312'		MOVE P3,CHRTAB(T3)
  9340	014130'	135300	000305'		LDB T1,CHPRED
  9341	014131'	256006	014140'		XCT COMATB(T1)
  9342	014132'	306400	000015		CAIN T3,15	;RETURN IS SPECAIL
  9343	014133'	254000	014125'		 JRST COMTI1	;GO GET LF AND SAY NOTHING ABOUT RETURN
  9344	014134'	202400	017025'	COMTI2:	MOVEM T3,TTCMCH	;REMEMBER CHR FOR REREAD
  9345	014135'	262040	000016		POP P,P3
  9346	014136'	262040	000007		POP P,T2
  9347	014137'	254000	014121*		JRST CPOPJ1
  9348
  9349	014140'	254000	014145'	COMATB:	JRST SPRCOM	;SPECIAL ACTION
  9350	014141'	255000	000000		JFCL		;NORMAL CHR
  9351	014142'	201400	000012		MOVEI T3,12	;TURN ALL BREAKS TO LINE FEEDS
  9352	014143'	255000	000000		JFCL		;BREAK2
  9353	014144'	370001	777776		SOS -2(P)	;NON-SKIP RETURN ON LOWER CASE CHAR
  9354
  9355	014145'	135300	000307'	SPRCOM:	LDB T1,CHPSPR	;GET CHR TYPE
  9356	014146'	135340	000165'		LDB T2,LDPMOD	;AND LINE MODE
  9357	014147'	256027	014151'		XCT @SPRCTB(T2)
  9358	014150'	254000	014134'		JRST COMTI2	;FINISH UP
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 208
SCNSER.MAC	25-JAN-91 22:40		COMMAND INPUT ROUTINE

  9359	014151'	256006	014155'	SPRCTB:	XCT COMPDP(T1)
  9360	014152'	256006	014164'		XCT COM940(T1)
  9361	014153'	256006	014164'		XCT COM940(T1)
  9362	014154'	256006	014155'		XCT COMPDP(T1)
  9363
  9364	014155'	201400	000003	COMPDP:	MOVEI T3,3	;^C
  9365	014156'	201400	000012		MOVEI T3,12	;33
  9366	014157'	201400	000012		MOVEI T3,12	;^_
  9367	014160'	201400	000012		MOVEI T3,12	;^Z
  9368	014161'	201400	000012		MOVEI T3,12	;175-176
  9369	014162'	254000	014173'		JRST COMTAB	;TAB
  9370	014163'	254000	014177'		JRST COMBSP	;BACKSPACE
  9371
  9372	014164'	201400	000012	COM940:	MOVEI T3,12	;^C
  9373	014165'	201400	000003		MOVEI T3,3	;33
  9374	014166'	201400	000003		MOVEI T3,3	;^_
  9375	014167'	201400	000012		MOVEI T3,12	;^Z
  9376	014170'	254000	014203'		JRST COMPA	;175-176
  9377	014171'	254000	014173'		JRST COMTAB	;TAB
  9378	014172'	254000	014177'		JRST COMBSP	;BACKSPACE
  9379
  9380	014173'	205300	100000	COMTAB:	MOVSI T1,L2LTBK
  9381	014174'	612305	000027		TDNE T1,LDBBYT(U)
  9382	014175'	201400	000012		MOVEI T3,12	;TREAT AS BREAK
  9383	014176'	254000	014134'		JRST COMTI2	;TREAT AS BREAK2
  9384
  9385	014177'	205300	040000	COMBSP:	MOVSI T1,L2LBBP
  9386	014200'	616305	000027		TDNN T1,LDBBYT(U)
  9387	014201'	201400	000012		MOVEI T3,12	;TREAT AS BREAK
  9388	014202'	254000	014134'		JRST COMTI2	;TREAT AS BREAK2
  9389
  9390	014203'	201400	000003	COMPA:	MOVEI T3,3
  9391	014204'	607240	000020		TLNN U,LDLLCT
  9392	014205'	201400	000012		MOVEI T3,12
  9393	014206'	254000	014134'		JRST COMTI2	;EITHER AN ESCAPE OR JUST A BREAK CHR
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 209
SCNSER.MAC	25-JAN-91 22:40		ROUTINE TO SWITCH TTY TO USER PROGRAM LEVEL AND START USER RUNNING

  9394				SUBTTL	ROUTINE TO SWITCH TTY TO USER PROGRAM LEVEL AND START USER RUNNING
  9395
  9396	014207'	634000	000000	TTYUSW::TDZA S,S			;DON'T1 CLEAR WAIT BITS
  9397	014210'	200000	017445'	TTYUSR:: MOVE S,[XWD IOW,IOACT]		;CLEAR WAIT BITS
  9398	014211'	260040	014214'		PUSHJ P,TTYUS0			;PUT TTY IN USER
  9399	014212'	324740	011341*		PJRST SETRUN			;MAKE HIM RUN AND RETURN
  9400
  9401				;CALL TTYUSM TO SIMPLY PUT TERM IN USER MODE
  9402
  9403	014213'	400000	000000	TTYUSM::SETZ S,				;DON'T CLEAR WAIT BITS
  9404	014214'	322240	014073*	TTYUS0:	JUMPE	U,CPOPJ			;Exit if no LDB
  9405	014215'	550205	000000		HRRZ F,LDBDDB(U)		;GET ATTACHED F IF ANY
  9406	014216'	322200	014221'		JUMPE F,TTYUS1			;JUMP IF NOT ATTACHED
  9407	014217'	413004	000002		ANDCAB S,DEVIOS(F)		; ..
  9408	014220'	260040	013554'		PUSHJ P,UUOLDB			;MAKE U AND DEVIOS AGREE
  9409	014221'	205300	020000	TTYUS1:	MOVSI T1,LDLCOM			;PUT TTY IN USER MODE
  9410	014222'	412305	000031		ANDCAM T1,LDBDCH(U)		;MAY BE DETACHED, BUT WILL WAIT
  9411									; AT UUO LEVEL IF NEEDED
  9412	014223'	260040	007603'		PUSHJ P,SETLMD
  9413	014224'	263040	000000		POPJ P,
  9414
  9415				;; Here when terminal-originated command has completed
  9416
  9417	014225'	205300	100000	TTYCMR::MOVSI	T1,LDLECS		;Set EAT-COMMAND-SYNC bit
  9418	014226'	436305	000031		IORM	T1,LDBDCH(U)		; in Line Data Block
  9419	014227'	263040	000000		POPJ	P,
  9420
  9421	014230'	322240	014214*	TTYSTC::JUMPE	U,CPOPJ
  9422	014231'	205300	002000		MOVSI	T1,LDLIMI		;FORCE OUT OF IMAGE MODE
  9423	014232'	260040	014251'		PUSHJ	P,CNCMD1		;WILL ALSO SET COMMAND BIT
  9424
  9425	014233'	322240	014230*	TTYSTR::JUMPE	U,CPOPJ			;Exit if no LDB
  9426	014234'	500245	000031		HLL	U,LDBDCH(U)
  9427	014235'	607240	020000		TLNN	U,LDLCOM		;AT COMMAND LEVEL?
  9428	014236'	324740	007152'		 PJRST	NOCTRO			;NO. JUST CLEAR ^O BIT
  9429	014237'	260040	013264'		PUSHJ	P,TYIEAT		;CLEAR THE COMMAND IN CASE MORE
  9430	014240'	550305	000015		HRRZ	T1,LDBBKC(U)		;NUMBER OF DEF ECHO BREAK CHARS
  9431	014241'	322300	014257'		JUMPE	T1,CKSXON		;NO BREAKS WAITING
  9432	014242'	260040	014035'		PUSHJ	P,CMDWAK		;SET FOR COMMAND
  9433	014243'	324740	007152'		PJRST	NOCTRO			;AND GO CLEAR BIT
  9434
  9435	014244'	505300	000003	MONHNG::HRLI	T1,3
  9436	014245'	260040	006602'		PUSHJ	P,HNGMON
  9437	014246'	255000	000000		  JFCL
  9438	014247'	263040	000000		POPJ	P,
  9439
  9440	014250'			TTYHLT::		;Global entry point to put TTY in cmd mode
  9441	014250'	205300	102000	CNCMOD:	MOVSI T1,LDLIMI!LDLECS
  9442	014251'	412305	000031	CNCMD1:	ANDCAM T1,LDBDCH(U)	;FORCE USER TO COMMAND LEVEL, RESET
  9443	014252'	260040	014027'		PUSHJ	P,BPTEST	;WANT TO TURN OFF BACKPRESSURE?
  9444	014253'	260040	014016'		  PUSHJ P,BPOFF		;YES, MAKE SURE BACKPRESSURE OFF
  9445	014254'	205300	020000		MOVSI T1,LDLCOM
  9446	014255'	436305	000031		IORM T1,LDBDCH(U)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 209-2
SCNSER.MAC	25-JAN-91 22:40		ROUTINE TO SWITCH TTY TO USER PROGRAM LEVEL AND START USER RUNNING

  9447	014256'	324740	007603'		PJRST SETLMD
  9448
  9449	014257'	260040	014027'	CKSXON:	PUSHJ	P,BPTEST	;WANT TO TURN BACKPRESSURE OFF?
  9450	014260'	260040	014015'		  PUSHJ P,BPXOFF	;YES
  9451	014261'	254000	007152'		JRST NOCTRO
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 210
SCNSER.MAC	25-JAN-91 22:40		OPRCTY - Remove chars from CTY's LDB and send to CTY

  9452				SUBTTL	OPRCTY - Remove chars from CTY's LDB and send to CTY
  9453
  9454	014262'	000000	000000	CTYBLF::EXP 0	;0,,-1 to ding next minute, -1,,-1 to ding this tick
  9455	014263'	000000	000000	OPRTIC::EXP 0	;Number of ticks before OPRCTY is allowed to continue
  9456
  9457	014264'	201240	000105'	OPRCTY:	MOVEI	U,CTYLDB	;Called by once-per-tick code
  9458	014265'	335000	014263'		SKIPGE	OPRTIC		;If CTYSIM is not doing anything,
  9459	014266'	476000	014263'		 SETOM	OPRTIC		; make sure this doesn't overflow to positive
  9460	014267'	377000	014263'			SOSG  OPRTIC	;Don't output if CTYSIM output recently
  9461				IFCPU(<KI,F3>),<CONSZ TTY,TT.OB>;Skip if output is done
  9462	014270'	332000	000000*	IFCPU (KS),<	SKIPE CTYOWD##>	;Skip if output is done
  9463				IFCPU(KL),<	SKIPN EPT##+SPCMTD>; "     "         "
  9464	014271'	263040	000000			 POPJ P,	;Output in progress - try again later
  9465				;*;	MOVEI	T3,ALRCTY	;SET ALARM
  9466				;*;	IORM	T3,ALR620	;11 NODES DON'T CARE TO KNOW ABOUT ALRCTY
  9467	014272'	331000	014262'		SKIPL	CTYBLF		;AAA. IF -1 RING BELL THIS TIME
  9468	014273'	254000	014277'		 JRST	OPRCT2
  9469	014274'	553000	014262'		HRRZS	CTYBLF		;RESET TO 0,,-1
  9470	014275'	201400	000007		MOVEI	T3,7
  9471	014276'	324740	014475'		PJRST	CTYCHR		;RING BELL (not sent to CTYBUF nor MSGBUF)
  9472
  9473	014277'	333000	017115'	OPRCT2:	SKIPLE	CTYFLN		;ARE THERE FILLS NEEDED
  9474	014300'	254000	014323'		 JRST	OPRFIL		;YES
  9475	014301'	200345	000020		MOVE	T2,LDBTOT(U)
  9476	014302'	260040	006152'		PUSHJ	P,TTGETC	;Get character from CTY's LDB
  9477	014303'	260040	006233'		  PUSHJ	P,FRECHK
  9478	014304'	202345	000020		MOVEM	T2,LDBTOT(U)
  9479	014305'	260040	014410'		PUSHJ	P,CTYLOG	;Log it in CTYBUF (MSGLOG called already)
  9480	014306'	260040	000000*		PUSHJ	P,PEVEN8	;Generate parity (smashes T1)
  9481	014307'	260040	014475'		PUSHJ	P,CTYCHR	;Send it to the CTY
  9482	014310'	405400	000177		ANDI	T3,177
  9483	014311'	302400	000014		CAIE	T3,14
  9484	014312'	306400	000013		CAIN	T3,13		;HANDLE FF AND VTB
  9485	014313'	254000	014321'		 JRST	CTYFRM
  9486	014314'	306400	000015		CAIN	T3,15
  9487	014315'	336400	017114'		SKIPN	T3,CTYFIL	;CR AND NEED FILLS?
  9488	014316'	254000	014327'		 JRST	CTYNFL		;NO
  9489	014317'	202400	017115'	CTYSFL:	MOVEM	T3,CTYFLN	;YES, SET COUNT (DO NOT DEC CHR CNT)
  9490	014320'	263040	000000		POPJ	P,
  9491
  9492	014321'	201400	000050	CTYFRM:	MOVEI	T3,^D40
  9493	014322'	254000	014317'		JRST	CTYSFL		;SET LARGE NUMBER OF FILLS
  9494
  9495	014323'	201400	000377	OPRFIL:	MOVEI	T3,377		;Filler is RUBOUT with even parity
  9496	014324'	260040	014475'		PUSHJ	P,CTYCHR	;Go to CTY (not CTYLOG, not MSGLOG)
  9497	014325'	373000	017115'		SOSLE	CTYFLN
  9498	014326'	263040	000000		 POPJ	P,		;Come back next tick
  9499	014327'	373005	000021	CTYNFL:	SOSLE	LDBTOC(U)
  9500	014330'	263040	000000		 POPJ	P,		;NOT ALL OUTPUT YET
  9501	014331'	260040	014737'		PUSHJ	P,OPRFRE	;RESTART SETUUO WAITERS
  9502	014332'	260040	006305'		PUSHJ	P,TSETBO	;RESET OUTPUT BUFFER
  9503	014333'	263040	000000		POPJ	P,		;DONE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 211
SCNSER.MAC	25-JAN-91 22:40		CTYTYP, CTYTYO - output character to the CTY (no interrupts)

  9504				SUBTTL	CTYTYP, CTYTYO - output character to the CTY (no interrupts)
  9505
  9506				;OPROUT - co-routine to set output to the CTY or the OPR terminal.
  9507				;Call with T1/0 = No LDB - Use CTYTYO to go directly to the CTY, no interrupts
  9508				;          T1/1 = One LDB - Use CTYLDB to put in the TTY chunks, CTY only
  9509				;          T1/2 = Two LDBs - Use both CTYLDB and OPRLDB, put in chunks
  9510				;Preserves all ACs but T1.  Note that U is not changed.
  9511
  9512	014334'	200306	020020'	OPROUT::MOVE	T1,[EXP OP0TYO,OP1TYO,OP2TYO](T1) ;Get new address
  9513	014335'	250300	014070*		EXCH	T1,.CPTOA##	;Set new typout address for COMTYO
  9514	014336'	250301	000000		EXCH	T1,(P)		;Save old address, get resume PC
  9515	014337'	260046	000000		PUSHJ	P,(T1)		;Call caller as coroutine
  9516	014340'	370001	777777		  SOS	-1(P)		;Propagate non-skip return
  9517	014341'	262040	014335*		POP	P,.CPTOA##	;Restore typeout routine when caller POPJs
  9518	014342'	254000	014137*		JRST	CPOPJ1
  9519
  9520				;Here during INFO or EVENT stopcodes - use normal buffered output to OPR+CTY
  9521
  9522	014343'	506401	000000	OP2TYO:	HRLM	T3,(P)		;Save char
  9523	014344'	261040	000005		PUSH	P,U
  9524	014345'	332240	017027'		SKIPE	U,OPRLDB	;If there is an OPR terminal
  9525	014346'	260040	014072'		 PUSHJ	P,CCTYO		;Output to it
  9526	014347'	262040	000005		POP	P,U
  9527	014350'	554401	000000		HLRZ	T3,(P)		;Do same character to the CTY
  9528					PFALL	OP1TYO
  9529
  9530				;Here to output to the CTY's LDB only (buffer emptied at clock level)
  9531
  9532	014351'	261040	000005	OP1TYO:	PUSH	P,U		;Routine to output to the CTY's LDB
  9533	014352'	201240	000105'		MOVEI	U,CTYLDB	;Point to the CTY
  9534	014353'	260040	014072'		PUSHJ	P,CCTYO		;Put char in CTY's LDB (this calls MSGLOG)
  9535	014354'	254000	003552'		JRST	UPOPJ	 	;Restore U and continue
  9536
  9537				;OP0TYO updates the key, then calls CTYTYO (called from continuable STOPCD).
  9538
  9539	014355'	261040	000006	OP0TYO::PUSH	P,T1		;Routine to output char in T3 to the CTY
  9540	014356'	200300	000512'		MOVE	T1,KEY10	;Magic number for the base
  9541	014357'	331000	000000*		SKIPL	.CPDWD##	;STOPCD in progress?
  9542	014360'	256000	000514'		 XCT	KEYSET		;Yes, update KEY620 if not in CONSOLE mode
  9543	014361'	262040	000006		POP	P,T1
  9544					PFALL	CTYTYO
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 212
SCNSER.MAC	25-JAN-91 22:40		CTYTYP, CTYTYO - output character to the CTY (no interrupts)

  9545				;Output character directly to the CTY.  Called via PUSHJ P,@COMTYO from DIE.
  9546				;CTYTYO outputs to CTY, logs output, generates even parity, and does fillers.
  9547				;  This routine will wait in a loop if output is busy, which may mean a delay
  9548				;  of several milliseconds (more if CTYFIL is nonzero).
  9549				;Call with 7-bit character in T3 (8 data bits if 9th bit it set).
  9550				;Caller is expected to create free CRLF at column 80 (for now).
  9551
  9552	014362'	261040	000006	CTYTYO::PUSH	P,T1		;Called from ONCE, CTYSIM, ERRCON, etc
  9553	014363'	260040	014456'		PUSHJ	P,MSGLOG	;Log it in MSGBUF (high phys mem)
  9554	014364'	260040	014410'		PUSHJ	P,CTYLOG	;Log it in CTYBUF (T3 has 7-bit character)
  9555	014365'	626400	000400		TRZN	T3,400		;If image flag set, char is 8 bits
  9556	014366'	260040	014306*		 PUSHJ	P,PEVEN8	;Generate even parity (smashes T1)
  9557	014367'	260040	014475'		PUSHJ	P,CTYCHR	;Output it to the CTY, loop if busy
  9558				PRINTF(<[CTYTYO should to free CRLF at column 80]>)
  9559	014370'	302400	000015		CAIE	T3,015		;Carriage return?
  9560	014371'	306400	000215		CAIN	T3,215		;(with or without parity)
  9561	014372'	336000	017114'		 SKIPN	CTYFIL		;Yes, have to do fillers?
  9562	014373'	254000	014033*		  JRST	TPOPJ		;No, return
  9563	014374'	261040	000010		PUSH	P,T3		;Save the character
  9564	014375'	200300	017114'		MOVE	T1,CTYFIL	;Number of rubouts to do
  9565	014376'	201400	000377	CTYTY1:	MOVEI	T3,377		;Fill character is rubout
  9566	014377'	260040	014475'		PUSHJ	P,CTYCHR	;CTYCHR loops waiting for output done
  9567	014400'	367300	014376'		SOJG	T1,CTYTY1	;Do multiple fillers
  9568	014401'	262040	000010		POP	P,T3		;Get 8-bit character back
  9569	014402'	254000	014373*		JRST	TPOPJ		;End of CTYTYO
  9570
  9571
  9572				;Output string to CTY.  Called from MONBTS and COMMON when loading BOOTS
  9573				;	MOVEI	T1,[ASCIZ /string/]
  9574				;	PUSHJ	P,CTYTYP
  9575				;	 <only return>
  9576
  9577	014403'	505300	440700	CTYTYP::HRLI	T1,440700	;POINTER FOR ASCIZ
  9578	014404'	134400	000006	CTYTYL:	ILDB	T3,T1		;GET CHARACTER
  9579	014405'	322400	014233*		JUMPE	T3,CPOPJ	;RETURN
  9580	014406'	260040	014362'		PUSHJ	P,CTYTYO
  9581	014407'	254000	014404'		JRST	CTYTYL
  9582
  9583				;Routine to log all CTY output in CTYBUF.  Preserves all ACs
  9584
  9585	014410'	302400	000007	CTYLOG::CAIE	T3,007		;Ignore bells
  9586	014411'	306400	000207		CAIN	T3,207
  9587	014412'	263040	000000		 POPJ	P,
  9588	014413'	261040	000006		PUSH	P,T1
  9589	014414'	133000	000000*		IBP	CTYPTR##	;Increment byte pointer
  9590	014415'	200300	014414*		MOVE	T1,CTYPTR##	;Get it
  9591	014416'	620300	000000*		TRZ	T1,-1-CTYMSK##	;Use only 9 bits of offset within CTYBUF
  9592	014417'	271300	000000*		ADDI	T1,CTYBUF##	;Full address
  9593	014420'	137400	000006		DPB	T3,T1		;Store all CTY output in CTYBUF
  9594	014421'	262040	000006		POP	P,T1
  9595	014422'	263040	000000		POPJ	P,
  9596
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 212-2
SCNSER.MAC	25-JAN-91 22:40		CTYTYP, CTYTYO - output character to the CTY (no interrupts)

  9597			774000		MSGLG.=:%MS0+0	;SIXBIT /MSGLOG/
  9598			774001		MSGLGS=:%MS0+1	;EXP <1777-4>*5 = size of MSGBUF in bytes = 11747
  9599			774002		MSGLGI=:%MS0+2	;EXP 0          = number of bytes put in by MSGLOG
  9600			774003		MSGLGO=:%MS0+3	;EXP 0          = number of bytes removed by SYSDAT
  9601			774004		MSGBUF=:%MS0+4	;ASCII text     = message log buffer
  9602			775777		MSG777=:%MS1+777;ASCIZ /<><>/   = end of buffer marker
  9603
  9604				;Programs need a 2004 word buffer to read MSGLG.+MSGBUF with SYSDVF function 6
  9605	014423'	777776	000000		SYDVF (<<MSGLG.,MSGBUF-MSGLG.>,<MSGBUF,MSG777+1-MSGBUF>>)
  9606	014424'	556347	544716
  9607	014425'	000004	774000
  9608	014426'	556347	426546
  9609	014427'	001774	774004
  9610				;Set up MSGBUF in high memory.  ONCE has made %MS0 and %MS1 addressable
  9611
  9612	014430'	200300	020023'	MSGINI::MOVE	T1,['MSGBUF']	;Name of buffer in SIXBIT
  9613	014431'	201340	011747		MOVEI	T2,<MSG777-MSGBUF>*5 ;Size in bytes (^D5095)
  9614	014432'	200400	020024'		MOVE	T3,[ASCIZ/<><>/];End of buffer marker
  9615	014433'	316300	774000		CAMN	T1,MSGLG.	;Check 1st and 2nd words
  9616	014434'	312340	774001		CAME	T2,MSGLGS	; for valid data from previous load
  9617	014435'	254000	014443'		 JRST	MSGIN1		;Bad
  9618	014436'	312400	775777		CAME	T3,MSG777	;Check last word
  9619	014437'	254000	014443'		 JRST	MSGIN1		;Bad
  9620				IFCPU (<KI,F3>),<		;OK, calculate offset into buffer
  9621					MOVE	T1,MSGLGI	;Count of bytes already logged to buffer
  9622					IDIV	T1,MSGLGS	;Modulo buffer size
  9623					MOVE	T3,[POINT 7,MSGBUF,6
  9624						    POINT 7,MSGBUF,13
  9625						    POINT 7,MSGBUF,20
  9626						    POINT 7,MSGBUF,27
  9627						    POINT 7,MSGBUF,34](T2)
  9628					ADD	T1,T3		;Combine byte pointer with address
  9629				>  ;End KI,F3
  9630	014440'	200300	020025'	IFNCPU(<KI,F3>),<MOVE T1,[POINT 7,MSGBUF,6]> ;Prototype for ADJBP
  9631	014441'	202300	017216'		MOVEM	T1,MSGLGP	;Byte pointer will be incremented before use
  9632	014442'	263040	000000		POPJ	P,		;Buffer has valid data from previous crash
  9633
  9634	014443'	402000	774004	MSGIN1:	SETZM	MSGBUF		;Zero out both pages
  9635	014444'	200440	020026'		MOVE	T4,[MSGBUF,,MSGBUF+1]
  9636	014445'	251440	775777		BLT	T4,MSG777
  9637	014446'	202300	774000		MOVEM	T1,MSGLG.	;Make header valid
  9638	014447'	202340	774001		MOVEM	T2,MSGLGS
  9639	014450'	202400	775777		MOVEM	T3,MSG777	;And end marker
  9640	014451'	476000	774002		SETOM	MSGLGI		;These will be inc'ed to 0 for 1st char
  9641	014452'	476000	774003		SETOM	MSGLGO
  9642	014453'	200300	020025'		MOVE	T1,[POINT 7,MSGBUF,6] ;Prototype for ADJBP
  9643	014454'	202300	017216'		MOVEM	T1,MSGLGP	;Byte pointer will be incremented before use
  9644	014455'	263040	000000		POPJ	P,
  9645
  9646				;Routine to log all CTY output in MSGBUF.  Preserves all ACs
  9647				;Called when characters go into the CTYLDB chunks (INFO and EVENT stopcodes)
  9648				; and when CTYTYO is bypassing the CTYLDB (ONCE dialog, serious stopcodes).
  9649
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 212-3
SCNSER.MAC	25-JAN-91 22:40		CTYTYP, CTYTYO - output character to the CTY (no interrupts)

  9650	014456'	336000	017216'	MSGLOG::SKIPN	MSGLGP		;If byte pointer is not set up yet,
  9651	014457'	263040	000000		 POPJ	P,		; ignore until MSGINI sets it
  9652	014460'	302400	000007		CAIE	T3,007		;Ignore bells
  9653	014461'	306400	000207		CAIN	T3,207
  9654	014462'	263040	000000		 POPJ	P,
  9655	014463'	261040	000006		PUSH	P,T1
  9656	014464'	261040	000007		PUSH	P,T2
  9657	014465'	355300	774002		AOSGE	T1,MSGLGI	;Increment to new byte position
  9658	014466'	403300	774002		 SETZB	T1,MSGLGI	;(should never exceed 35 bits)
  9659				IFCPU(<KL,KS>),<
  9660	014467'	230300	774001		IDIV	T1,MSGLGS	;Modulo MSGBUF size (remainder in T2)
  9661	014470'	133340	017216'		ADJBP	T2,MSGLGP	;Convert to byte pointer
  9662	014471'	137400	000007		DPB	T3,T2		;Store byte in MSGBUF
  9663				>  ;End if KL,KS
  9664				IFCPU(<KI,F3>),<
  9665					IBP	MSGLGP		;Increment byte pointer
  9666					HRRZ	T2,MSGLGP
  9667					CAIL	T2,MSG777	;If EA has hit end of MSGBUF
  9668					 MOVEI	T2,MSGBUF	; wrap to beginning
  9669					HRRM	T2,MSGLGP
  9670					DPB	T3,MSGLGP	;Store byte in MSGBUF
  9671				>  ;End if KI,F3
  9672	014472'	262040	000007		POP	P,T2
  9673	014473'	262040	000006		POP	P,T1
  9674	014474'	263040	000000		POPJ	P,
  9675
  9676				SUBTTL	CTYCHR - Output 8-bit character to the console teletype
  9677				;Caller is responsible for parity generation and free CRLF at column 80.
  9678				;Returns immediately if caller has waited for output-done to be true.
  9679				ENTRY	CTYCHR			;Called from CTYSIM
  9680
  9681				IFCPU (<KI,F3>),< ;Output to KI/F3 console
  9682				CTYCHR:	CONSZ	TTY,TT.OB	;Wait for Output Busy to go off
  9683					 JRST	.-1		;(no timeout for this hardware flag)
  9684					DATAO	TTY,T3		;Send character as it (all 8 bits)
  9685					POPJ	P,		;The DATAO sets TT.OB in hardware
  9686				
  9687				SVPPC::	POPJ	P,	;There is no other processor to do Keep-Alive on KI,F3
  9688				>;END IFCPU (<KI,F3>)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 213
SCNSER.MAC	25-JAN-91 22:40		CTYCHR - Output 8-bit character to the console teletype

  9689				PRINTF([Need to make SVPPC work on KS])
  9690
  9691				IFCPU (KS),<	;Output to the KS console via the 8080
  9692	014475'	506401	000000	CTYCHR:	HRLM	T3,(P)		;Save character in T3
  9693	014476'	205400	000001		MOVSI	T3,1		;Number of times to try
  9694	014477'	332000	014270*		SKIPE	CTYOWD##	;Previous CTY output done?
  9695	014500'	367400	014477'		 SOJG	T3,.-1		;No, wait for it
  9696	014501'	554401	000000		HLRZ	T3,(P)	
  9697	014502'	405400	000377		ANDI	T3,CTYOCH	;Get just the character
  9698	014503'	660400	000400		TRO	T3,CTYOVL	;Add the Output Valid flag
  9699	014504'	202400	014477*		MOVEM	T3,CTYOWD##	;Store in location 33 in low memory
  9700	014505'	700240	000010		RDAPR	T3		;Get program states
  9701	014506'	405400	000007		ANDI	T3,LP.PIA	;Leave only the PIA
  9702	014507'	700210	012000		WRAPR	LP.SSF+LP.I8C(T3);Whap the 8080
  9703	014510'	554401	000000		HLRZ	T3,(P)		;Restore char in T3
  9704	014511'	263040	000000		POPJ	P,
  9705
  9706	014512'	255000	000000	SVPPC::	JFCL			;Determine if Keep-Alive is active
  9707	014513'	261040	000006		PUSH	P,T1		;Save flag on stack
  9708	014514'	255000	000000		JFCL			;Disable Keep-Alive checking
  9709	014515'	260061	777777		PUSHJ	P,@-1(P)	;Return to caller (co-routine)
  9710	014516'	262040	000006		POP	P,T1		;Get flag back
  9711	014517'	255000	000000		JFCL			;Resume Keep-Alive if needed
  9712	014520'	262041	000000		POP	P,(P)		;Clean up stack
  9713	014521'	263040	000000		POPJ	P,		;End of SVPPC
  9714				>  ;End of IFCPU(KS)
  9715
  9716				IFCPU (KL),<	;Output to the KL console via the PDP-11 on the master DTE
  9717				CTYCHR:	HRLM	T3,(P)		;Save character in T3
  9718					MOVSI	T3,1		;Number of times to try
  9719					SKIPN	EPT##+SPCMTD	;Previous CTY output done?
  9720					 SOJG	T3,.-1		;No, wait for it
  9721					HLRZ	T3,(P)	
  9722					ANDI	T3,377		;Just 8 bits of character
  9723					MOVEI	T3,.DTCTO(T3)	;Make DTE command word
  9724					MOVEM	T3,EPT##+SPCCMW	;Store in command word
  9725					SETZM	EPT##+SPCMTD	;Zero to indicate output not done
  9726					CONO	DTE,TO11DB	;Ring doorbell
  9727					HLRZ	T3,(P)		;Restore char in T3
  9728					POPJ	P,		;SPCMTD will be set nonzero when output done
  9729				
  9730				;Routine to save Primary Protocol Condition (See DTESER.703)
  9731				;Called by DIE when processing a STOPCODE.
  9732				
  9733				SVPPC::	JFCL			;Determine if running primary or secondary protocol
  9734					PUSH	P,T1		;Save flag on stack
  9735				;*;	JSR	SPCINI		;Set to secondary protocol
  9736					PUSHJ	P,@-1(P)	;Return to caller (co-routine)
  9737					POP	P,T1		;Get flag back
  9738					JFCL			;Restart primary protocol if needed
  9739					POP	P,(P)		;Clean up stack
  9740					POPJ	P,		;End of SVPPC
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 213-2
SCNSER.MAC	25-JAN-91 22:40		CTYCHR - Output 8-bit character to the console teletype

  9741				SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 214
SCNSER.MAC	25-JAN-91 22:40		CTYCHR - Output 8-bit character to the console teletype

  9742				;KL CTY output, continued
  9743				
  9744				SPHNGI:	0	;INSTRUCTION TO XCT IF DTE HANGS UP
  9745				SPCST1:	0	;FOR SAVING T1
  9746				SPCTRY:	0	;# OF REMAINING TRIES
  9747				SPCTRN==10	;# TO INIT SPCTRY TO
  9748				
  9749				SPCINI::0			;ENTER SECONDARY PROTOCOL
  9750					MOVEM	T1,SPCST1	;SAVE T1
  9751					MOVE	T1,[EPT##+SPCDBG,,EPT##+SPCDBG+1]
  9752					SETZM	EPT##+SPCDBG
  9753					BLT	T1,EPT##+SPCDND	;INIT COMM AREA TO ZEROES
  9754					RDPI	SPCCMD		;SAVE PI STATE
  9755					WRPI	LI.PIF
  9756					MOVE	T1,[JSR DTEHLT]
  9757					MOVEM	T1,EPT##+EPTDT0+DTEDII
  9758					MOVEM	T1,SPHNGI
  9759					MOVE	T1,[EPT##+EPTDT0+DTEEPW,,EPT##+EPTDT0+DTEEPW+1]
  9760					SETZM	EPT##+EPTDT0+DTEEPW
  9761					BLT	T1,EPT##+EPTDT0+DTEDRW
  9762					CONO	DTE,CL11PT	;CLEAR INTERRUPT JUST IN CASE
  9763					MOVE	T1,SPCCMD	;RESTORE PI
  9764					TRNE	T1,LI.PIN
  9765					 WRPI	LI.PIN
  9766					MOVEI	T1,.DTESP
  9767					JSR	SPCCMD
  9768					MOVE	T1,SPCST1
  9769					JRST	@SPCINI
  9770				
  9771				;READ SWITCHES.
  9772				SPCGSW::MOVEI	T1,.DTRSW
  9773					JSR	SPCCMD
  9774					MOVE	T1,EPT##+SPCF11
  9775					POPJ	P,
  9776				
  9777				;SEND SECONDARY PROTOCOL COMMAND
  9778				SPCCMD:	0			;JSR HERE
  9779					SETZM	EPT##+SPCFLG	;CLEAR FLAG FIRST.
  9780					MOVEM	T1,EPT##+SPCCMW	;STUFF COMMAND
  9781					MOVEI	T1,SPCTRN	;GET # OF TIMES TO TRY
  9782					MOVEM	T1,SPCTRY
  9783				SPCCM1:	CONO	DTE,TO11DB	;RING DOORBELL
  9784					MOVEI	T1,40000
  9785					SKIPN	EPT##+SPCFLG
  9786					 SOJG	T1,.-1
  9787					JUMPG	T1,@SPCCMD	;WORKED, RETURN.
  9788					SOSL	SPCTRY
  9789					JRST	SPCCM1
  9790					XCT	SPHNGI
  9791				
  9792				DTEHLT:	0
  9793					 STOPCD		;;DTEHLT+1
  9794				>;END IFCPU (KL)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 215
SCNSER.MAC	25-JAN-91 22:40		SETUUO TO SET INITIA ON LINES MARKED

  9795				SUBTTL	SETUUO TO SET INITIA ON LINES MARKED
  9796
  9797	014522'	000000	000000	NOXEXE::0			;Set nonzero by ONCE to not run XEXEC
  9798
  9799	014523'	205300	000001	INISET::MOVSI	T1,(STAUTO)	;Enter here from UUOCON (DSKCLN does this)
  9800	014524'	616300	013030*		TDNN	T1,STATES	;Check if still in auto-restart mode
  9801	014525'	263040	000000		 POPJ	P,		;Don't do this more than once
  9802	014526'	201240	000105'		MOVEI	U,CTYLDB	;Output to the CTY
  9803	014527'	332000	014522'		SKIPE	NOXEXE		;If set to not run XEXEC,
  9804					 JRST	[MOVEI T1,STSUPR   ;Change super-shut (600000)
  9805						 ANDCAM T1,STATES  ; to shut (400000) so OPER can login
  9806						 SETZM NOXEXE	   ;Allow INITIA to be run later
  9807						 MOVEI T1,[ASCIZ /INITIALIZATION complete
  9808				please log in: /]
  9809	014530'	254000	020040'			 PJRST CONMES##]
  9810					MOVEI	T1,[ASCIZ /SETUUO forcing INITIA on TTY1,TTY2,TTY3,TTY4,TTY5
  9811	014531'	201300	020045'	/]
  9812	014532'	260040	002061*		PUSHJ	P,CONMES##	;TELL OPERATOR WHAT IS HAPPENING
  9813	014533'	205700	000000*		MOVSI	P3,-PORTN##	;CHECK ALL LINES
  9814	014534'	200256	012777*	INISLP:	MOVE	U,LINTAB(P3)
  9815	014535'	336005	000026		SKIPN	LDBLOG(U)	;NOT IF LOGGED IN
  9816	014536'	607240	000000*		TLNN	U,TTVIN2	;OR NOT MARKED
  9817	014537'	254000	014555'		 JRST	INISL2
  9818	014540'	200340	020060'		MOVE	T2,[LLLNLN,,LDLCOM]	;FOR LDBLOG AND LDBDCH
  9819	014541'	512345	000026		HLLZM	T2,LDBLOG(U)	;MARK IN (BUT UNKNOWN TO THE BASE)
  9820	014542'	516345	000031		HRLZM	T2,LDBDCH(U)	;AND COMMAND MODE
  9821	014543'	200300	007763*		MOVE	T1,SYSNUM##	;Our host number
  9822	014544'	137300	000160'		DPB	T1,LDPHST	; for job running INITIA part 2 (XEXEC)
  9823	014545'	402005	000032		SETZM	LDBDCX(U)	;NO EXTENDED BITS ON
  9824	014546'	260040	007603'		PUSHJ	P,SETLMD
  9825	014547'	260040	002047*		PUSHJ	P,FRMASN##	;Assign a frame slot
  9826	014550'	263040	000000		  POPJ	P,		;None there? Quit loop now, why bother?
  9827	014551'	260040	015416'		PUSHJ	P,TTYATI	;Attach TTY DDB to this LDB
  9828	014552'	324740	002062*		  PJRST	FRMKJF##	;No DDB's - free up frame slot,kill TTY
  9829	014553'	201300	000000*		MOVEI	T1,CMFCXI##
  9830	014554'	260040	014046'		PUSHJ	P,TTFORC	;MARK FORCED COMMAND
  9831	014555'	253700	014534'	INISL2:	AOBJN	P3,INISLP
  9832	014556'	254000	014342*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 216
SCNSER.MAC	25-JAN-91 22:40		SOME ROUTINES TO FIND TELETYPES FOR VARIOUS PURPOSES

  9833				SUBTTL	SOME ROUTINES TO FIND TELETYPES FOR VARIOUS PURPOSES
  9834
  9835				;SUBROUTINE TO FIND TTY FOR A JOB IN J (TTYFND) OR FOR
  9836				; CURRENT JOB (TTYFNU)
  9837				;RETURN WITH F AND U SET UP.
  9838				;GOES TO ERROR IF NO TTY F FOR THE JOB.
  9839
  9840	014557'	200100	013253*	TTYFNU::MOVE	J,JOB		;GET CURRENT UUO LEVEL JOB NUMBER
  9841	014560'	260040	014563'	TTYFND::PUSHJ	P,TTYSRC	;FIND THE JOB'S TTY F, ALSO U AND S
  9842	014561'	256000	000000'		 STOPCD 		;JOB ZERO, OR OTHERWISE NO DDB. COMPLAIN.
  9843	014562'	263040	000000		POPJ	P,0		;SUCCESS. RETURN.
  9844
  9845				;ROUTINE TO FIND A TTY F WHICH IS ATTACHED TO, I.E.
  9846				;CONTROLLING, A PARTICULAR JOB NUMBER.
  9847
  9848				;CALLED AT COMMAND LEVEL BY ATTACH COMMAND, AND AT M LEVEL
  9849				;BY REFERENCES TO DEVICE "TTY" OR TTCALLS, ETC.
  9850
  9851				;CALL:	MOVE J,JOB NUMBER DESIRED
  9852				;	PUSHJ P,TTYSRC
  9853				;	  ERROR RETURN.	;NOT FOUND. AC'S U,F,S NOT GUARANTEED
  9854				;	NORMAL RETURN	;U, S AND F SET UP. NOTE THAT THIS DOES
  9855				;			;!NOT! IMPLY THAT ANYONE IS ATTACHED. THAT IS,
  9856				;			; U MAY CONTAIN A ZERO
  9857
  9858
  9859	014563'	322100	014405*	TTYSRC::JUMPE	J,CPOPJ		;NOBODY CONTROLS JOB ZERO. YOU ARE CONFUSED.
  9860	014564'	550202	011654*		HRRZ	F,TTYTAB(J)	;REALLY MUST BE HERE
  9861	014565'	322200	014563*		JUMPE	F,CPOPJ
  9862	014566'	550244	000013		HRRZ	U,DDBLDB(F)
  9863	014567'	200004	000002		MOVE	S,DEVIOS(F)	;SET UP I/O STATUS AND LINE
  9864	014570'	254000	014556*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 217
SCNSER.MAC	25-JAN-91 22:40		SUBROUTINE TTYERP TO FIND TTY DDB FOR A MONITOR ERROR MSG

  9865				SUBTTL	SUBROUTINE TTYERP TO FIND TTY DDB FOR A MONITOR ERROR MSG
  9866				;CALL WITH J SET TO JOB NUMBER. IF JOB IS ZERO OR JOB
  9867				;IS DETACHED USER OPRLDB. IF NOT EVEN THAT IS THERE,
  9868				;GIVE RETURN. NORMAL RETURN IS SKIP.  (called from ERRCON)
  9869
  9870	014571'	260040	014563'	TTYERP::PUSHJ	P,TTYSRC	;FIND DDB OF JOB'S TTY (SET F, U, AND S)
  9871	014572'	254000	014574'		  JRST	GETCTY		;CAN'T FIND IT
  9872	014573'	326240	014570*		JUMPN	U,CPOPJ1	;SKIP RETURN IF ATTACHED
  9873								;Nonskip means should use OPROUT with 2
  9874
  9875				;GETCTY USED BY PICON TO REPORT PARITY ERROR IN USER CORE
  9876				;Output buffer flushed if too many messages queued up.
  9877				;Changes U and F only.
  9878
  9879	014574'	201240	000105'	GETCTY::MOVEI	U,CTYLDB	;GET CTY'S LDB
  9880	014575'	261040	000006		PUSH	P,T1
  9881	014576'	261040	000007		PUSH	P,T2
  9882	014577'	200305	000021		MOVE	T1,LDBTOC(U)	;CHECK CURRENT COUNT
  9883	014600'	303300	000214		CAILE	T1,^D140
  9884	014601'	260040	006305'		 PUSHJ	P,TSETBO	;TOO BIG, CLEAR
  9885	014602'	262040	000007		POP	P,T2
  9886	014603'	262040	000006		POP	P,T1
  9887	014604'	550205	000000		HRRZ	F,LDBDDB(U)
  9888	014605'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 218
SCNSER.MAC	25-JAN-91 22:40		FIND A USER AND WAIT FOR ATTACH OR OUTPUT WAIT TO FINISH

  9889				SUBTTL	FIND A USER AND WAIT FOR ATTACH OR OUTPUT WAIT TO FINISH
  9890
  9891	014606'	260040	014557'	TTYFUW::PUSHJ P,TTYFNU
  9892	014607'	260040	013422'	TTYFW1:	PUSHJ P,CKATTF		;WAIT FOR ATTACH
  9893	014610'	200305	000021		MOVE T1,LDBTOC(U)	;HAVE TO PUT IT IN HERE SO
  9894	014611'	307300	000010		CAIG T1,10		;DOES OT CALL SCNINT
  9895	014612'	263040	000000		POPJ P,
  9896	014613'	200000	020061'	TOWATA:	MOVE S,[XWD TTYOUW+IO+TIOUSE,IOACT]
  9897	014614'	437004	000002		IORB S,DEVIOS(F)
  9898	014615'	261040	000014		PUSH P,P1
  9899	014616'	261040	000015		PUSH P,P2
  9900	014617'	260040	013763*		PUSHJ P,WSYNC
  9901	014620'	262040	000015		POP P,P2
  9902	014621'	262040	000014		POP P,P1
  9903	014622'	205000	020000		MOVSI S,TIOUSE
  9904	014623'	413004	000002		ANDCAB S,DEVIOS(F)
  9905	014624'	263040	000000		POPJ P,
  9906
  9907	014625'	200000	020016'	TTYSOW::MOVE S,[XWD TTYOUW+IO,IOACT]
  9908	014626'	437004	000002		IORB S,DEVIOS(F)
  9909	014627'	263040	000000		POPJ P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 219
SCNSER.MAC	25-JAN-91 22:40		SUBROUTINE TO FIND LDB FOR A PHYSICAL NAME, IF ITS A TTY

  9910				SUBTTL	SUBROUTINE TO FIND LDB FOR A PHYSICAL NAME, IF ITS A TTY
  9911				;AND LOAD F WITH LINKED DATA BLOCK, IF ANY, BUT DONT MAKE ONE IF NONE YET
  9912				;SKIP RETURN IF ITS A TTY
  9913
  9914	014630'	316300	020062'	TTYPHY::CAMN	T1,[SIXBIT /OPR/]	;TALK TO OPERATOR?
  9915	014631'	200300	004425*		 MOVE	T1,DEVOPR		;YES. GET REAL DEVICE NAME
  9916	014632'	510240	000006		HLLZ	U,T1			;GET FIRST THREE CHARACTERS
  9917	014633'	316240	020063'		CAMN	U,[SIXBIT /TTY/]	;ARE THEY TTY?
  9918	014634'	606300	770000		TRNN	T1,770000		;AND ALSO IS FOURTH CHAR NON-BLANK?
  9919	014635'	263040	000000		 POPJ	P,			;NO. NOT A LEGAL NAME.
  9920	014636'	261040	000006		PUSH	P,T1			;YES. MAY BE LEGAL.
  9921	014637'	517001	000000		HRLZS	0(P)			;PUT THE RIGHT THREE CHARS ON STACK
  9922	014640'	261040	020064'		PUSH	P,[POINT 6,-1(P)]	;POINTER TO READ CHARS
  9923	014641'	201240	000000		MOVEI	U,0			;INITIALIZE U TO 0
  9924	014642'	134301	000000	TTYPH4:	ILDB	T1,0(P)			;GET A SIXBIT CHARACTER FROM NAME
  9925	014643'	322300	014654'		JUMPE	T1,TTYPH2		;JUMP IF END OF NAME.
  9926	014644'	640300	000020		TRC	T1,'0'			;CONVERT SIXBIT TO BINARY
  9927	014645'	303300	000007		CAILE	T1,7			;IS IT AN OCTAL DIGIT?
  9928	014646'	254000	014652'		 JRST	TTYPH3			;NO. BAD CHAR IN NAME
  9929	014647'	240240	000003		ASH	U,3			;MULTIPLY BY 8
  9930	014650'	271246	000000		ADDI	U,0(T1)			;ADD IN THIS DIGIT
  9931	014651'	254000	014642'		JRST	TTYPH4			;LOOP FOR MORE DIGITS
  9932
  9933	014652'	262040	000006	TTYPH3:	POP	P,T1			;HERE ON BAD CHAR. CLEAR OUT STACK
  9934	014653'	254000	014402*		JRST	TPOPJ			;AND RETURN TO ERR RET
  9935
  9936	014654'	262040	000006	TTYPH2:	POP	P,T1			;HAVE AN OCTAL NUMBER. DISCARD
  9937	014655'	262040	000006		POP	P,T1			; TWO ITEMS FROM STACK
  9938	014656'	301240	000000*		CAIL	U,PORTN##		;IS IT A LEGAL HARDWARE LINE #
  9939	014657'	263040	000000		 POPJ	P,			;NO. TOO BAD.
  9940	014660'	550245	014534*		HRRZ	U,LINTAB(U)		;GET LINE DATA BLOCK ADDRESS
  9941	014661'	550205	000000		HRRZ	F,LDBDDB(U)		;GET ATTACHED F, IF ANY.
  9942	014662'	254000	014573*		JRST	CPOPJ1			;GOOD RETURN
  9943
  9944				;ROUTINE TO GET A DDB. CALLED IN DEVSRCH ROUTINES
  9945
  9946	014663'	260040	014630'	GETDDB::PUSHJ	P,TTYPHY	;FIND THE TELETYPE BY NUMBER
  9947	014664'	263040	000000		  POPJ	P,		;NOT A REAL TTY
  9948	014665'	322200	014565*		JUMPE	F,CPOPJ		;NOT REALLY THERE YET
  9949	014666'	200304	000000		MOVE	T1,DEVNAM(F)	;IF SOMEONE ELSES WILL BE
  9950	014667'	254000	014662*		JRST	CPOPJ1		;ASSIGNED BY CONSOLE SO CAN'T HAVE IT ANYWAY
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 220
SCNSER.MAC	25-JAN-91 22:40		SUBROUTINE TO PUT PHYSICAL NAME INTO T2 FOR LINE WHOSE LDB IS IN U

  9951				SUBTTL	SUBROUTINE TO PUT PHYSICAL NAME INTO T2 FOR LINE WHOSE LDB IS IN U
  9952				;EVEN THOUGH THERE MAY BE NOTHING IN F OR LDBDDB
  9953
  9954	014670'	135300	000157'	TTYNAM::LDB	T1,LDPLNO		;GET LINE NUMBER
  9955	014671'	261040	020063'		PUSH	P,[SIXBIT /TTY/]	;PUT NAME ON STACK
  9956	014672'	201401	000000		MOVEI	T3,0(P)			;PREPARE ARG FOR SCNNMR
  9957	014673'	505400	220600		HRLI	T3,220600		;POINT 6,0,17
  9958	014674'	260040	014677'		PUSHJ	P,SCNNMR		;AND CALL SAME ROUTINE AS SCNNAM DOES
  9959	014675'	262040	000007		POP	P,T2			;PUT ANSWER IN T2
  9960	014676'	263040	000000		POPJ	P,			;AND RETURN FROM TTYNAM
  9961
  9962				;SUBSIDIARY ROUTINE TO DO RADIX PRINT TO CORE.
  9963
  9964	014677'	231300	000010	SCNNMR:	IDIVI	T1,10			;DEVICE NAMES ARE OCTAL
  9965	014700'	506341	000000		HRLM	T1+1,0(P)		;STORE A DIGIT ON STACK
  9966	014701'	332000	000006		SKIPE	T1			;NEED MORE DIGITS?
  9967	014702'	260040	014677'		 PUSHJ	P,SCNNMR		;YES. GO MAKE THEM.
  9968	014703'	554301	000000		HLRZ	T1,0(P)			;RETRIEVE A DIGIT FROM STACK
  9969	014704'	271300	000020		ADDI	T1,'0'			;CONVERT TO SIXBIT
  9970	014705'	136300	000010		IDPB	T1,T3			;STORE IN OBJECT WORD (DEVNAM)
  9971	014706'	263040	000000		POPJ	P,0			;POP UP TO SCNNMR OR BACK TO SCNNAM
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 221
SCNSER.MAC	25-JAN-91 22:40		SETUUO OUTPUT MESSAGE TO OPR TTY & CTY *BOTH*, IF POSSIBLE.

  9972				SUBTTL	SETUUO OUTPUT MESSAGE TO OPR TTY & CTY *BOTH*, IF POSSIBLE.
  9973				;OTHERWISE JUST TO CTY.
  9974
  9975	014707'	550540	000006	OPRSND::HRRZ	M,T1
  9976	014710'	505540	440700		HRLI	M,(POINT 7,0)
  9977	014711'	336240	017027'	OPRSN2:	SKIPN	U,OPRLDB	;GET OPR
  9978	014712'	201240	000105'		 MOVEI	U,CTYLDB	;NONE, GO TO CTY ONLY
  9979	014713'	200305	000021		MOVE	T1,LDBTOC(U)
  9980	014714'	434300	000126'		IOR	T1,CTYLDB+LDBTOC;WAIT IF EITHER OPR TTY OR CTY
  9981	014715'	326300	014730'		JUMPN	T1,OPRWAT	;IS BUSY (OUTPUT BUFF NOT-EMPTY)
  9982								;UNWAIT WHEN ONE OR THE OTHER
  9983								;BECOMES EMPTY
  9984	014716'	256040	017522'	OPSND1:	XCTFU	<ILDB T3,M>
  9985	014717'	322400	014667*		JUMPE	T3,CPOPJ1	;DONE
  9986	014720'	260040	014072'		PUSHJ	P,CCTYO		;SAME OUTPUT RESTRICTIONS AS COMMAND
  9987	014721'	336000	017027'		SKIPN	OPRLDB		;SKIP IF GOING TO BOTH
  9988	014722'	254000	014716'		 JRST	OPSND1		;JUST TO CTY, ALREADY DONE
  9989	014723'	201240	000105'		MOVEI	U,CTYLDB
  9990	014724'	256040	020065'		XCTFU	<LDB T3,M>	;GET SAME CHAR JUST SENT,
  9991	014725'	260040	014072'		PUSHJ	P,CCTYO		;& PUT IT ON CTY
  9992	014726'	200240	017027'		MOVE	U,OPRLDB	;RESTORE U
  9993	014727'	254000	014716'		JRST	OPSND1
  9994
  9995	014730'	201300	011644*	OPRWAT:	MOVEI	T1,MLOWQ	;WAIT FOR OPR BUFFER TO EMPTY
  9996	014731'	137300	011645*		DPB	T1,PJBSTS##	;SET TO MON WAIT QUE
  9997	014732'	550300	017116'		HRRZ	T1,OPRWJB	;GET WAITING JOB IF ANY
  9998	014733'	202302	000000*		MOVEM	T1,QUEPCB(J)	;PUT ON QUE
  9999	014734'	552100	017116'		HRRZM	J,OPRWJB	;AND SET CURRENT
 10000	014735'	260040	011647*		PUSHJ	P,WSCHED
 10001	014736'	254000	014711'		JRST	OPRSN2		;RESTARTED. ONE OF THEM JUST BECAME
 10002								;FREE. GO CHECK AGAIN MAKE SURE BOTH FREE.
 10003
 10004				;Here when the OPR terminal is free to do more output
 10005				;Uses T1 and T2 only
 10006
 10007	014737'	336340	017116'	OPRFRE::SKIPN	T2,OPRWJB
 10008	014740'	263040	000000		 POPJ	P,		;NONE WAITING
 10009	014741'	402000	017116'		SETZM	OPRWJB		;RESTART ALL WAITERS
 10010	014742'	261040	000002		PUSH	P,J
 10011	014743'	200100	000007	OPRFR1:	MOVE	J,T2
 10012	014744'	201300	011337*		MOVEI	T1,RNQ
 10013	014745'	137300	014731*		DPB	T1,PJBSTS##
 10014	014746'	260040	014212*		PUSHJ	P,SETRUN
 10015	014747'	550342	014733*		HRRZ	T2,QUEPCB(J)
 10016	014750'	402002	014747*		SETZM	QUEPCB(J)	;ZERO OLD ENTRY
 10017	014751'	326340	014743'		JUMPN	T2,OPRFR1	;ANY MORE?
 10018	014752'	262040	000002		POP	P,J
 10019	014753'	263040	000000		POPJ	P,		;DONE
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 222
SCNSER.MAC	25-JAN-91 22:40		SUBROUTINE FOR THE TTY COMMAND

 10020				SUBTTL	SUBROUTINE FOR THE TTY COMMAND
 10021
 10022				;ON ENTRY P1 HAS LDB TO DO THINGS FOR, T2 HAS COMMAND
 10023
 10024	014754'	205300	777743	SCNTCD::MOVSI	T1,-TTCWDN	;GET LENGTH OF COMMAND TABLE
 10025	014755'	312346	014762'		CAME	T2,TTCWDT(T1)
 10026	014756'	253300	014755'		 AOBJN	T1,.-1
 10027	014757'	327300	014717*		JUMPG	T1,CPOPJ1	;NOT FOUND, TAKE ERROR RETURN
 10028	014760'	550346	015017'		HRRZ	T2,TTCWDD(T1)	;GET DISPATCH
 10029	014761'	254007	000000		JRST	(T2)		;AND GO
 10030
 10031
 10032	014762'	565700	000000	TTCWDT:	SIXBIT /NO/
 10033	014763'	644142	000000	TTYTBL::SIXBIT /TAB/
 10034	014764'	465762	550000		SIXBIT /FORM/
 10035	014765'	544300	000000		SIXBIT /LC/
 10036	014766'	465154	540000		SIXBIT /FILL/
 10037	014767'	454350	570000		SIXBIT /ECHO/
 10038	014770'	436254	460000		SIXBIT /CRLF/
 10039	014771'	675144	645000		SIXBIT /WIDTH/
 10040	014772'	705756	000000		SIXBIT /XON/
 10041	014773'	644160	450000		SIXBIT /TAPE/
 10042	014774'	465154	542100		SIXBIT /FILL1/
 10043	014775'	465154	542200		SIXBIT /FILL2/
 10044	014776'	515600	000000		SIXBIT /IN/
 10045	014777'	576564	000000		SIXBIT /OUT/
 10046	015000'	410000	000000		SIXBIT /A/
 10047	015001'	420000	000000		SIXBIT /B/
 10048	015002'	430000	000000		SIXBIT /C/
 10049	015003'	440000	000000		SIXBIT /D/		;Was /TYPE/
 10050	015004'	424143	536360		<SIXBIT /BACKSPACE/>
 10051	015005'	456241	634500		SIXBIT /ERASE/
 10052	015006'	627045	000000		SIXBIT /RXE/
 10053	015007'	444546	000000		SIXBIT /DEF/
 10054	015010'	654357	000000		SIXBIT /UCO/
 10055	015011'	426344	000000		SIXBIT /BSD/
 10056	015012'	624263	000000		SIXBIT /RBS/
 10057	015013'	435441	636300		SIXBIT /CLASS/		; [dws]
 10058	015014'	626443	575560		SIXBIT /RTCOMP/		;[Darren]
 10059	015015'	534164	415341		SIXBIT /KATAKA/		;KATAKANA (JIS-8 ASCII) mode
 10060	015016'	647160	450000		SIXBIT /TYPE/		;Type of terminal
 10061			000035	TTCWDN==.-TTCWDT
 10062			033000	TTYMXL==:<TTCWDN-1-1>_^D9
 10063
 10064	015017'	000000	015054'	TTCWDD:	XWD 0,TTCNO		;LH MAY HAVE A BIT TO SET/RESET
 10065	015020'	000024	015057'		XWD TCNTAB,TTCSET
 10066	015021'	000025	015057'		XWD TCNFRM,TTCSET
 10067	015022'	000026	015056'		XWD TCNLCT,TTCCLR
 10068	015023'	000000	015141'		XWD 0,TTCFIL
 10069	015024'	000004	015056'		XWD TCNHDX,TTCCLR
 10070	015025'	000027	015056'		XWD TCNNFC,TTCCLR
 10071	015026'	000015	015072'		XWD TCNWID,TTCVAL
 10072	015027'	000030	015057'		XWD TCNPTP,TTCSET
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 222-2
SCNSER.MAC	25-JAN-91 22:40		SUBROUTINE FOR THE TTY COMMAND

 10073	015030'	000030	015057'		XWD TCNPTP,TTCSET
 10074	015031'	000016	015072'		XWD TCNFC1,TTCVAL
 10075	015032'	000017	015072'		XWD TCNFC2,TTCVAL
 10076	015033'	000001	015072'		XWD TCNIR,TTCVAL
 10077	015034'	000002	015072'		XWD TCNOR,TTCVAL
 10078	015035'	000005	015072'		XWD TCNPA,TTCVAL
 10079	015036'	000006	015072'		XWD TCNPB,TTCVAL
 10080	015037'	000007	015072'		XWD TCNPC,TTCVAL
 10081	015040'	000013	015072'		XWD TCNPD,TTCVAL	;Parameter D (formerly TCNTYP)
 10082	015041'	000020	015057'		XWD TCNBSP,TTCSET
 10083	015042'	000021	015057'		XWD TCNERA,TTCSET
 10084	015043'	000012	015057'		XWD TCNRXE,TTCSET
 10085	015044'	000022	015057'		XWD TCNDEF,TTCSET
 10086	015045'	000023	015056'		XWD TCNLCO,TTCCLR
 10087	015046'	000031	015057'		XWD TCNBSD,TTCSET
 10088	015047'	000011	015057'		XWD TCNECH,TTCSET
 10089	015050'	000032	015106'		XWD TCNCLA,TTCSIX	;Class
 10090	015051'	000033	015057'		XWD TCNRTC,TTCSET	;RTcompatibility
 10091	015052'	000034	015057'		XWD TCNKAT,TTCSET	;Katakana mode
 10092	015053'	000035	015114'		XWD TCNTYP,TTCTYP	;TYPE is a number or a sixbit value
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 223
SCNSER.MAC	25-JAN-91 22:40		SET TTY routines

 10093				SUBTTL	SET TTY routines
 10094
 10095	015054'	641600	777777	TTCNO:	TLC	P1, -1		;COMPLEMENT YES-NO FLAG
 10096	015055'	263040	000000		POPJ	P,
 10097
 10098				;BIT-VALUED CHARACTERISTICS
 10099
 10100	015056'	641600	777777	TTCCLR:	TLC	P1,-1		;OPPOSITE OF SET
 10101	015057'	554306	015017'	TTCSET:	HLRZ	T1,TTCWDD(T1)	;T1/ TC# FOR SETTCN
 10102	015060'	321600	015065'		JUMPL	P1,TTCDO1	;RESETTING THE BIT
 10103	015061'	201340	000001		MOVEI	T2,1
 10104	015062'	260040	015131'		PUSHJ	P,TTCGO
 10105	015063'	350001	000000		  AOS	(P)
 10106	015064'	263040	000000		POPJ	P,
 10107	015065'	400340	000000	TTCDO1:	SETZ	T2,
 10108	015066'	260040	015131'		PUSHJ	P,TTCGO
 10109	015067'	350001	000000		  AOS (P)
 10110	015070'	553000	000014	TTCFIN:	HRRZS	P1		;Clear "NO" flag
 10111	015071'	263040	000000		POPJ	P,
 10112
 10113				;DECIMAL-VALUED CHARACTERISTICS
 10114
 10115	015072'	261040	000006	TTCVAL:	PUSH	P,T1
 10116	015073'	321600	015100'		JUMPL	P1,TTCVL0	;"NO" = 0
 10117	015074'	260040	000000*		PUSHJ	P,DECIN1##	;T2 := DECIMAL NUMBER
 10118	015075'	254000	014034*		  JRST	TPOPJ1	
 10119	015076'	254000	015075*		  JRST	TPOPJ1		;NO NUMBER OR BAD NUMBER
 10120	015077'	254000	015101'		JRST	TTCVL1
 10121	015100'	400340	000000	TTCVL0:	SETZ	T2,
 10122	015101'	262040	000006	TTCVL1:	POP	P,T1		;T1/ VALUE FROM DISPATCH
 10123	015102'	554306	015017'	TTCVL2:	HLRZ	T1,TTCWDD(T1)	;T1/ TC# FOR SETTCN
 10124	015103'	260040	015131'	TTCVL3:	PUSHJ	P,TTCGO
 10125	015104'	350001	000000		  AOS	(P)
 10126	015105'	263040	000000		POPJ	P,
 10127
 10128				;[dws] Sixbit-valued characteristics
 10129
 10130	015106'	261040	000006	TTCSIX:	PUSH	P,T1		; save T1
 10131	015107'	335000	000014		SKIPGE	P1		; skip if "No" not seen
 10132	015110'	634340	000007		 TDZA	T2,T2		;  "No" = blanks
 10133	015111'	260040	000000*		PUSHJ	P,CTEXT1##	; T2 := sixbit text
 10134	015112'	262040	000006		POP	P,T1		; T1/ value from dispatch
 10135	015113'	254000	015102'		JRST	TTCVL2		; Go set it
 10136
 10137				;Treat SET TTY TYPE specially for Japanese customers
 10138
 10139	015114'	261040	000006	TTCTYP:	PUSH	P,T1		; save T1
 10140	015115'	335000	000014		SKIPGE	P1		; skip if "No" not seen
 10141	015116'	634340	000007		 TDZA	T2,T2		;  "No" = blanks
 10142	015117'	260040	015111*		PUSHJ	P,CTEXT1##	; T2 := sixbit text
 10143	015120'	262040	000006		POP	P,T1		; T1/ value from dispatch
 10144	015121'	312340	020066'		CAME	T2,[SIXBIT /0/]	;Old "TTY TYPE 0" command?
 10145	015122'	316340	020067'		CAMN	T2,[SIXBIT /1/]	;Old "TTY TYPE 1" command?
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 223-2
SCNSER.MAC	25-JAN-91 22:40		SET TTY routines

 10146	015123'	334000	000000		 SKIPA			;Yes
 10147	015124'	254000	015102'		  JRST	TTCVL2		;No, just store value
 10148	015125'	242340	777742		LSH	T2,^D<5-35>	;Yes, right justify number
 10149	015126'	405340	000007		ANDI	T2,7		;Keep as 0 or 1
 10150	015127'	201300	000013		MOVEI	T1,TCNPD	;Act like "SET TTY D 1" command
 10151	015130'	254000	015103'		JRST	TTCVL3		;Go set parameter "D" for KATAKANA
 10152
 10153	015131'	261040	000005	TTCGO:	PUSH	P,U		;T1/ TCNxxx (PDP-10 TC number)
 10154	015132'	540240	000014		HRR	U,P1		;U/ LDB ADDR
 10155	015133'	500245	000031		HLL	U,LDBDCH(U)
 10156	015134'	260040	010357'		PUSHJ	P,SETTC1	;GO SET THE TC
 10157	015135'	254000	015137'		  JRST	.+2
 10158	015136'	350001	777777		AOS	-1(P)		;TRANSFER THE SKIP-RETURN
 10159	015137'	262040	000005		POP	P,U
 10160	015140'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 224
SCNSER.MAC	25-JAN-91 22:40		FOR OLD TIME'S SAKE (SET FC1 AND FC2 FROM THE SAME VALUE)

 10161				SUBTTL	FOR OLD TIME'S SAKE (SET FC1 AND FC2 FROM THE SAME VALUE)
 10162
 10163	015141'	321600	015146'	TTCFIL:	JUMPL	P1,TTCFL0
 10164	015142'	260040	015074*		PUSHJ	P,DECIN1##
 10165	015143'	254000	014757*		  JRST	CPOPJ1
 10166	015144'	254000	015143*		  JRST	CPOPJ1
 10167	015145'	254000	015147'		JRST	TTCFL1
 10168	015146'	400340	000000	TTCFL0:	SETZ	T2,
 10169	015147'	201300	000016	TTCFL1:	MOVEI	T1, TCNFC1
 10170	015150'	260040	015131'		PUSHJ	P, TTCGO
 10171	015151'	254000	015144*		  JRST	CPOPJ1
 10172	015152'	201300	000017		MOVEI	T1, TCNFC2
 10173	015153'	260040	015131'		PUSHJ	P, TTCGO
 10174	015154'	350001	000000		  AOS	(P)
 10175	015155'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 225
SCNSER.MAC	25-JAN-91 22:40		CALLED FROM COMCON TO SET TO SEND SHUT OR ANSWERED MESSAGE

 10176				SUBTTL	CALLED FROM COMCON TO SET TO SEND SHUT OR ANSWERED MESSAGE
 10177
 10178	015156'	205300	001000	SETSHT::MOVSI	T1,TYPI TYPSHT	;SET TO SAY SHUT
 10179	015157'	201340	400000		MOVEI	T2,STSHUT	;400000
 10180	015160'	616340	014524*		TDNN	T2,STATES	;IS THAT THE STATE
 10181	015161'	205300	000400		 MOVSI	T1,TYPI TYPANS	;YES, SO SAY ANSWERED
 10182	015162'	202300	017030'		MOVEM	T1,UPSHUT
 10183	015163'	616340	015160*		TDNN	T2,STATES	;UP OR DOWN?
 10184	015164'	254000	015171'		 JRST	CKOPR		;UP, SEE IF DEVOPR SET
 10185	015165'	402000	017035'		SETZM	OPRTIM		;DOWN, TURN OFF TIMER
 10186	015166'	201340	000020		MOVEI	T2,ALROPR
 10187	015167'	412340	005666*		ANDCAM	T2,ALR620	;AND ALARM
 10188	015170'	263040	000000		POPJ	P,
 10189
 10190	015171'	332000	014631*	CKOPR:	SKIPE	DEVOPR
 10191	015172'	263040	000000		 POPJ	P,		;DEVOPR SET, ALL OK
 10192	015173'	201340	000132		MOVEI	T2,^D90		;SET FOR 90 SEC TILL ALARM
 10193	015174'	202340	017035'		MOVEM	T2,OPRTIM
 10194	015175'	263040	000000		POPJ	P,
 10195
 10196				;CALLED TO SEE IF WAITING FOR LOGOUT SO CAN NOT SET JACCT2
 10197
 10198	015176'	550202	014564*	CKLGO::	HRRZ F,TTYTAB(J)
 10199	015177'	322200	015151*		JUMPE F,CPOPJ1		;NO DDB, SAY OK TO SET
 10200	015200'	550244	000013		HRRZ U,DDBLDB(F)
 10201	015201'	322240	015177*		JUMPE U,CPOPJ1		;NO LINE, CAN NOT BE WAITING
 10202	015202'	205440	200000		MOVSI T4,LLLZAP
 10203	015203'	616445	000026		TDNN T4,LDBLOG(U)	;SEE IF ZAPPER RECEIVED FLAG SET
 10204	015204'	350001	000000		 AOS (P)		;NO, OK
 10205	015205'	263040	000000		POPJ P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 226
SCNSER.MAC	25-JAN-91 22:40		SEND A SAD MESSGE

 10206				SUBTTL	SEND A SAD MESSGE
 10207
 10208	015206'	200300	015167*	SNDSAD:	MOVE	T1,ALR620
 10209	015207'	316300	017047'		CAMN	T1,ALRSNT
 10210	015210'	254000	015201*		  JRST	CPOPJ1		;NOT SENT
 10211	015211'	261040	000006		PUSH	P,T1		;SAVE T1 FROM BEING CLOBBERED.
 10212	015212'	260040	004113'		PUSHJ	P,CLSCHR	;FINISH UP CHARACTER OUTPUT.
 10213	015213'	254000	014653*		 JRST	TPOPJ		;NO MORE ROOM.
 10214	015214'	200340	011467*		MOVE	T2,ORPPDP	;PICK UP THE OUTPUT RING POINTER.
 10215	015215'	271340	000002		ADDI	T2,2		;THIS OPERATION REQUIRES 2 WORDS.
 10216	015216'	405340	011457*		ANDI	T2,MSKORG	;MASK FOR WRAP AROUND.
 10217	015217'	316340	004562*		CAMN	T2,ORP620	;MAKE SURE THERE'S ROOM.
 10218	015220'	254000	015213*		  JRST	TPOPJ		;NO MORE ROOM.  FINISH SCANNING LINE.
 10219	015221'	262040	000006		POP	P,T1		;RESTORE T1
 10220	015222'	202300	017047'		MOVEM	T1,ALRSNT	;SAY WE SENT THAT ONE
 10221	015223'	205700	015400		MOVSI	P3,TYPI TYPSAD
 10222	015224'	135300	020070'		LDB	T1,[POINT 16,ALR620,15]
 10223	015225'	137300	017365'		DPB	T1,[POINT 16,P3,BYP4]
 10224	015226'	202717	011452*		MOVEM	P3,ORING(P4)
 10225	015227'	260040	016501'		PUSHJ	P,ORPLOG	;Put message into ORING log
 10226	015230'	271740	000001		ADDI	P4,1
 10227	015231'	405740	015216*		ANDI	P4,MSKORG	;POINT TO CORRECT LOCATION (POSSIBLE WRAP)
 10228	015232'	135300	020071'		LDB	T1,[POINT 16,ALR620,31]
 10229	015233'	137300	020072'		DPB	T1,[POINT 16,P3,BYP2]
 10230	015234'	260040	004177'		PUSHJ	P,WRDOT2	;WRITE 2ND WORD AND CLEAN UP
 10231	015235'	263040	000000		  POPJ	P,		;NO MORE ROOM.  CALL FINOUT.
 10232	015236'	254000	015210*		JRST	CPOPJ1		;CONTINUE SCAN.
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 227
SCNSER.MAC	25-JAN-91 22:40		ATTACH/DETACH

 10233				SUBTTL ATTACH/DETACH
 10234
 10235				;TTYKIL - ACTUALLY TWO ROUTINES
 10236				;
 10237				;1)	CALLED WITH F/ 0, U/ LDB ADDR TO ZAP LINE WHENEVER A
 10238				;	COMMAND HAS JUST BEEN FORCED ON A NON-JOB (E.G.,
 10239				;	WHEN JOB CAPACITY IS EXCEEDED), AND, BY SOME QUIRK
 10240				;	OF FATE, AFTER EVERY DETACH COMMAND (BECAUSE COMCON
 10241				;	RELOADS F FROM LDBDDB(U) AND INCORRECTLY THINKS
 10242				;	F/ 0 = NO JOB)
 10243				;
 10244				;2)	CALLED WITH F/ DDB ADDR, U/ ANYTHING TO ZAP THE
 10245				;	ATTACHED PORT, IF ANY, AND FREE THE COMMAND PORT DDB
 10246				;	OF A JOB BEING KILLED.
 10247
 10248	015237'	322200	015372'	TTYKIL::JUMPE	F,TTYZAP	;IF THERE'S NO JOB (CASE 1): ZAP IT
 10249
 10250				;(CASE 2) FREE THE DDB, THEN ZAP THE CIRCUIT
 10251
 10252	015240'	402004	000000		SETZM	DEVNAM(F)
 10253	015241'	402004	000005		SETZM	DEVLOG(F)
 10254	015242'	135300	014054*		LDB	T1,PJOBN
 10255	015243'	332000	000006		SKIPE	T1
 10256	015244'	402006	015176*		SETZM	TTYTAB(T1)	;MAKE SURE MARKED AS NO DDB
 10257	015245'	205300	000004		MOVSI	T1,IOFST
 10258	015246'	202304	000002		MOVEM	T1,DEVIOS(F)
 10259	015247'	137300	015242*		DPB	T1,PJOBN	;THIS WILL SET TO JOB 0
 10260	015250'	550244	000013		HRRZ	U,DDBLDB(F)	;CHECK FOR A LINE ATTACHED
 10261	015251'	322240	015254'		JUMPE	U,TTYKDB	;DETACHED ALREADY?
 10262
 10263				    ; U/ 0,,LDB ADDR
 10264				    ;HERE WHEN WE'RE TTYKILLING AN ATTACHED DDB
 10265
 10266	015252'	513005	000000		HLLZS	LDBDDB(U)	;DISCONNECT LINE FROM F
 10267	015253'	260040	015372'		PUSHJ	P,TTYZAP	;ELSE ZAP THE CIRCUIT
 10268					PFALL	TTYKDB
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 228
SCNSER.MAC	25-JAN-91 22:40		TTYKDB - CLEAR LDB PTR AND ASSIGNMENT & USE BITS FOR A TTY DDB

 10269				SUBTTL	TTYKDB - CLEAR LDB PTR AND ASSIGNMENT & USE BITS FOR A TTY DDB
 10270				;	   (ADDR IN F), AND RETURN IT TO THE FREE POOL
 10271
 10272	015254'	322200	014665*	TTYKDB:	JUMPE	F,CPOPJ
 10273	015255'	513004	000013		HLLZS	DDBLDB(F)	;NO F FROM U
 10274	015256'	200300	020073'		MOVE	T1,[XWD TTYATC,ASSCON!ASSPRG]
 10275	015257'	412304	000004		ANDCAM	T1,DEVMOD(F)	;CLEAR OUT ALL USE AND ASSIGN BITS
 10276	015260'	554344	000013		HLRZ	T2,DDBBLK(F)	;GET BACK LINK
 10277	015261'	554304	000003		HLRZ	T1,DEVSER(F)	;AND FORWARD LINK
 10278				;;Start of debug code;;
 10279	015262'	202200	015322'		MOVEM	F,XXCDDB	;Current DDB pointer
 10280	015263'	202300	015325'		MOVEM	T1,XXNDDB	;Next DDB pointer
 10281	015264'	202340	015330'		MOVEM	T2,XXPDDB	;Previous DDB pointer
 10282	015265'	261044	000003		PUSH	P,DEVSER(F)	;Current forward link
 10283	015266'	262040	015323'		POP	P,XXCSER
 10284	015267'	261044	000013		PUSH	P,DDBBLK(F)	;Current backward link
 10285	015270'	262040	015324'		POP	P,XXCBLK
 10286	015271'	261046	000003		PUSH	P,DEVSER(T1)	;Next forward link
 10287	015272'	262040	015326'		POP	P,XXNSER
 10288	015273'	261046	000013		PUSH	P,DDBBLK(T1)	;Next backward link
 10289	015274'	262040	015327'		POP	P,XXNBLK
 10290	015275'	261047	000003		PUSH	P,DEVSER(T2)	;Previous forward link
 10291	015276'	262040	015331'		POP	P,XXPSER
 10292	015277'	261047	000013		PUSH	P,DDBBLK(T2)	;Previous backward link
 10293	015300'	262040	015332'		POP	P,XXPBLK
 10294				;;End of debug code;;
 10295	015301'	506307	000003		HRLM	T1,DEVSER(T2)	;LINK AROUND DDB
 10296	015302'	261040	000010		PUSH	P,T3
 10297	015303'	200406	000004		MOVE	T3,DEVMOD(T1)	;IS NEW DEST. ALSO A TTY?
 10298	015304'	603400	004010		TLNE	T3,DVTTY!DVRMT
 10299	015305'	506346	000013		 HRLM	T2,DDBBLK(T1)	;YES, SET ITS BACK POINTER
 10300	015306'	262040	000010		POP	P,T3
 10301	015307'	200300	017036'		MOVE	T1,FRETTY
 10302	015310'	506304	000003		HRLM	T1,DEVSER(F)	;AND LINK INTO FREE POOL
 10303	015311'	552200	017036'		HRRZM	F,FRETTY
 10304	015312'	550200	000007		HRRZ	F,T2		;POINT TO PRED FOR LINKING
 10305				;Check that the DDB chain ends properly
 10306	015313'	554300	000000*		HLRZ	T1,DEVLST##	;Beginning of DDB chain
 10307	015314'	201340	023420		MOVEI	T2,^D10000	;Paranoid loop counter
 10308	015315'	322300	015254*	TTYKD1:	JUMPE	T1,CPOPJ	;Quit when end of chain is found
 10309	015316'	554306	000003		HLRZ	T1,DEVSER(T1)	;Point to next DDB
 10310	015317'	367340	015315'		SOJG	T2,TTYKD1	;Look for end
 10311	015320'	256000	020074'	DDBCNE:: STOPCD (.,STOP,DDBCNE,,<DDB chain has no end>)
 10312				 ;;TTYKDB+many
 10313	015321'	263040	000000		POPJ	P,
 10314
 10315	015322'	000000	000000	XXCDDB:	0			;Current DDB pointer
 10316	015323'	000000	000000	XXCSER:	0			;DEVSER word with forward pointer
 10317	015324'	000000	000000	XXCBLK:	0			;DDBBLK word with backward pointer
 10318	015325'	000000	000000	XXNDDB:	0
 10319	015326'	000000	000000	XXNSER:	0			;Ditto for next DDB
 10320	015327'	000000	000000	XXNBLK:	0
 10321	015330'	000000	000000	XXPDDB:	0
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 228-2
SCNSER.MAC	25-JAN-91 22:40		TTYKDB - CLEAR LDB PTR AND ASSIGNMENT & USE BITS FOR A TTY DDB

 10322	015331'	000000	000000	XXPSER:	0			;Ditto for previous DDB
 10323	015332'	000000	000000	XXPBLK:	0
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 229
SCNSER.MAC	25-JAN-91 22:40		TDTUUO - HERE FROM ATTACH UUO WHEN DETACHING THE COMMAND PORT

 10324				SUBTTL	TDTUUO - HERE FROM ATTACH UUO WHEN DETACHING THE COMMAND PORT
 10325				;	   (J/ JOB NUMBER)
 10326
 10327	015333'	260040	014563'	TDTUUO::PUSHJ	P,TTYSRC	;FIND F
 10328	015334'	263040	000000		 POPJ	P,		;NONE THERE
 10329	015335'	322240	015315*		JUMPE	U,CPOPJ		;MUST NOT BE WAITING FOR LOGOUT
 10330	015336'	205300	200000		MOVSI	T1,LLLZAP
 10331	015337'	612305	000026		TDNE	T1,LDBLOG(U)
 10332	015340'	263040	000000		 POPJ	P,
 10333					PFALL	TTYDET
 10334
 10335				;TTYDET - DETACH A TTY DDB (ADDR IN F)
 10336
 10337	015341'	550244	000013	TTYDET::HRRZ U,DDBLDB(F)	;GET LDB ADDR
 10338	015342'	513004	000013		HLLZS DDBLDB(F)		;AND CLEAR LINK
 10339	015343'	553004	000000		HRRZS DEVNAM(F)		;SAVE PORT # BUT CLEAR "TTY"
 10340								;SO DEVICE SEARCH DOESN'T FIND IT
 10341	015344'	201300	000001		MOVEI	T1, 1
 10342	015345'	137300	000246'		DPB	T1, DDPCOM	;SHOULD RE-ATTACH IN CMND MODE
 10343	015346'	322240	015335*		JUMPE U,CPOPJ		;NO LINE TO SEND ZAPPER ON
 10344	015347'	513005	000000		HLLZS LDBDDB(U)		;CLEAR LDB TO DDB LINK
 10345	015350'	324740	015372'		PJRST TTYZAP		;  SEND A ZAPPER ON IT
 10346
 10347				;TYCIOS - called by CLOCK1 to clear ALL tty's IOS
 10348
 10349	015351'	260040	016110'	TYCIOS::PUSHJ P,FRSTTY
 10350	015352'	263040	000000		  POPJ P,	
 10351	015353'	254000	015356'		JRST TYIOS2		;include command port
 10352
 10353	015354'	260040	016112'	TYIOS1:	PUSHJ P,NXTTTY	;THIS WILL BE AUX CIR OR RMT
 10354	015355'	263040	000000		  POPJ P,	;FINISHED, NONE THERE
 10355	015356'	205300	004000	TYIOS2:	MOVSI T1,DVRMT
 10356	015357'	612304	000004		TDNE T1,DEVMOD(F)
 10357					JRST	[MOVE S,[IOW,,IOACT]	;RESET BITS FOR RMT
 10358						ANDCAM S,DEVIOS(F)
 10359	015360'	254000	020077'			JRST TYIOS1]	;NEXT
 10360	015361'	200000	020102'		MOVE S,[IOW+TIOUSE,,IOACT]
 10361	015362'	412004	000002		ANDCAM S,DEVIOS(F)	;RESET ALL BITS INCLUDING USE
 10362	015363'	200300	020073'		MOVE T1,[TTYATC,,ASSCON+ASSPRG]
 10363	015364'	616304	000004		TDNN T1,DEVMOD(F)	;ANY REASON TO KEEP IT
 10364	015365'	260040	015254'		PUSHJ P,TTYKDB		;NO, GET RID OF IT
 10365	015366'	254000	015354'		JRST TYIOS1
 10366
 10367				;IFDET - CALLED FROM EXIT UUO: IF DETACHED, SKIP, ELSE DO A
 10368				;	  TTYFUW AND NONSKIP-RETURN
 10369
 10370	015367'	260040	014560'	IFDET::	PUSHJ P,TTYFND
 10371	015370'	322240	015236*		JUMPE U,CPOPJ1	;IS DETACHED
 10372	015371'	254000	014607'		JRST TTYFW1	;FINISH THE TTYFUW
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 230
SCNSER.MAC	25-JAN-91 22:40		TTYZAP - ZAP A CIRCUIT (U/ LDB ADDR).

 10373				SUBTTL	TTYZAP - ZAP A CIRCUIT (U/ LDB ADDR).
 10374
 10375				;Whenever a zapper originates from the PDP-10, then a yellow ball is
 10376				;sent out first to make sure that the zapper does not gobble any of the
 10377				;logout messages.  In this case, a 20-second timer is started and the
 10378				;zapper is not sent until an orange ball is reflected by the TYMSAT.
 10379				;
 10380				;Whenever a zapper originates from TYMNET, the base has already given up
 10381				;on the port and marks is as being "in clean up" until we return the zapper.
 10382				;
 10383				;In either case, the line is marked as "not in use" when we send a zapper.
 10384				;We must respond to incoming zappers, but the base sends no response to
 10385				;an outgoing zapper.
 10386
 10387				;Change in P035/D05 - don't send yellow ball if line is not marked in use,
 10388				;because base will ignore it and we will be waiting 20 seconds for an orange
 10389				;ball that will never come in.  However, if a login just happens to come in
 10390				;while we are waiting, it used to cause TTYZNE and/or a base crash.
 10391				;Also: EBUS version 2.0 did not range-check zappers.  When B39 was configured
 10392				;for 128 ports and its base for 127, the base would crash when a zapper
 10393				;was sent out on TTY177.
 10394
 10395	015372'	201340	000001	TTYZAP:	MOVEI	T2,1
 10396	015373'	200305	000026		MOVE	T1,LDBLOG(U)	;Get TYMNET status of line
 10397	015374'	325300	015377'		JUMPGE	T1,TTYZP1	;No yellow/orange if port not in use
 10398	015375'	607300	100000		TLNN	T1,LLLNLN	;Send yellow ball and wait for orange to be
 10399	015376'	137340	000077'		 DPB	T2,LOPSYL	; reflected (unless zap came from base)
 10400	015377'	137340	000101'	TTYZP1:	DPB	T2,LOPZAP	;Set flag to send zapper
 10401	015400'	137345	000002		DPB	T2,LDBOPB(U)	;Mark line as needing output
 10402	015401'	205300	400000		MOVSI	T1,LDLNOP
 10403	015402'	412305	000031		ANDCAM	T1,LDBDCH(U)	;Ignore backpressure
 10404	015403'	205300	001000		MOVSI	T1,LMLBIO
 10405	015404'	612305	000030		TDNE	T1,LDBMOD(U)	;If it's in block I/O mode,
 10406	015405'	260040	012071'		 PUSHJ	P,BIOREL	; get it out
 10407	015406'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 231
SCNSER.MAC	25-JAN-91 22:40		TTYATT - ATTACH LDB TO JOB

 10408				SUBTTL	TTYATT - ATTACH LDB TO JOB
 10409				;	   U/ LDB  J/ JOB#
 10410				;	   SKIP-RETURNS ON SUCCESS WITH F/ CMND PORT DDB
 10411				;	   NONSKIP-RETURNS ON FAILURE WITH F/ 0
 10412
 10413	015407'	261040	000005	TTYATT::PUSH	P,U
 10414	015410'	201200	000000		MOVEI	F,0		;RET 0 IN CASE DONT FIND TTY DDB
 10415	015411'	260040	014563'		PUSHJ	P,TTYSRC	;FIND THE F FOR THAT JOB
 10416	015412'	254000	015414'		  JRST	LPOPJ		;NONE, SHOULD NOT HAVE GOTTEN HERE
 10417	015413'	322240	015422'		JUMPE	U,TTYAT1	;WAS THERE ANYONE ATTACHED
 10418	015414'	262040	000005	LPOPJ:	POP	P,U		;YES, NOONE CAN DO THIS FOR NOW
 10419	015415'	263040	000000		POPJ	P,
 10420
 10421				COMMENT ! TTYATI - CALLED TO DO INITIAL ATTACH WHEN
 10422					PROCESSING LOGIN.
 10423				EXPECTS:  U/ LDB ON WHICH LOGIN APPEARED
 10424					  J/ JOB SLOT TO WHICH WE WANT TO ATTACH IT
 10425				CLOBBERS: T1 - T4
 10426				RETURNS: CPOPJ IF CANNOT ATTACH. F/0 IF NO TTYDDB'S, F/DDB IF
 10427						BECAUSE ALREADY ATTACHED
 10428					 CPOPJ1 IF SUCCESS, F/DDB
 10429				!
 10430
 10431
 10432	015416'	261040	000005	TTYATI:	PUSH P,U
 10433	015417'	260040	014563'		PUSHJ P,TTYSRC	;CHECK FOR A F FOR THIS JOB
 10434	015420'	260040	015717'		 PUSHJ P,DDBSRC	;NONE, FIND A FREE ONE
 10435	015421'	254000	015414'		  JRST LPOPJ	;NO FREE F OR JOB ALREADY HAS ONE, GIVE ERROR RETURN
 10436	015422'	200241	000000	TTYAT1:	MOVE U,0(P)	;RESTORE LINE USER IS NOW ON
 10437	015423'	261040	000004		PUSH P,F
 10438	015424'	550205	000000		HRRZ F,LDBDDB(U)	;DOES IT HAVE A F?
 10439	015425'	322200	015430'		JUMPE F,TTYAT2	;NO, JUST DO THE ATTACH
 10440	015426'	513004	000013		HLLZS DDBLDB(F)	;GET RID OF LINK TO LINE SO
 10441	015427'	553004	000000		HRRZS DEVNAM(F)	;MAKE SURE LEFT OF NAME ZEROED
 10442	015430'	262040	000004	TTYAT2:	POP P,F		;NOW RESTORE F HE GOES TO
 10443	015431'	262040	000005		POP P,U
 10444	015432'	200300	020103'		MOVE T1,[XWD TTYATC,ASSCON]	;ASSIGN IT
 10445	015433'	436304	000004		IORM T1,DEVMOD(F)
 10446	015434'	137100	015247*		DPB J,PJOBN		;SET JOB ASSIGNED TO
 10447	015435'	200300	000000*		MOVE T1,TIMRST##	;RESET ANY WAITING HANG
 10448	015436'	137100	000000*		DPB J,CLKJOB##		;WHICH MAY EXIST IN CLOCK QUEUE
 10449	015437'	260040	000000*		PUSHJ P,CHGCLK		;FOR PREVIOUS OWNERS OF THIS JOB SLOT
 10450	015440'	552202	015244*		HRRZM F,TTYTAB(J)	;SET TTYTAB UP
 10451	015441'	260040	015764'		PUSHJ P,SCNNAM		;FILL IN NAME OF TTY F
 10452	015442'	260040	015666'		PUSHJ	P, COMATT	;JOIN F AND U
 10453	015443'	254000	015370*		JRST CPOPJ1		;AND TAKE GOOD RETURN
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 232
SCNSER.MAC	25-JAN-91 22:40		HERE FROM THE ATTACH UUO IF IT'S ATTACHING

 10454				SUBTTL	 HERE FROM THE ATTACH UUO IF IT'S ATTACHING
 10455				; T1/ USERMODE,,JOB# WHERE USERMODE IS 1 TO
 10456				; ATTACH THE PORT IN USER MODE AND 0 TO ATTACH
 10457				; IT IN COMMAND MODE
 10458
 10459	015444'	261040	000006	TATUUO::PUSH	P,T1
 10460	015445'	260040	014563'		PUSHJ	P,TTYSRC	;FIND F FOR THIS JOB
 10461	015446'	254000	015220*		  JRST	TPOPJ		;CAN NOT ATTACH, NO F
 10462	015447'	550244	000013		HRRZ	U,DDBLDB(F)
 10463	015450'	322240	015446*		JUMPE	U,TPOPJ		;GIVE UP
 10464	015451'	205300	200000		MOVSI	T1,LLLZAP
 10465	015452'	612305	000026		TDNE	T1,LDBLOG(U)
 10466	015453'	254000	015450*		 JRST	TPOPJ		;DO NOT ALLOW IF WAITING FOR LOGUT
 10467	015454'	550101	000000		HRRZ	J,0(P)		; J/ 0,,TARGET JOB#
 10468	015455'	260040	015407'		PUSHJ	P,TTYATT	;Attach our old line to new job
 10469	015456'	254000	015453*		  JRST	TPOPJ		;CANNOT ATTACH
 10470	015457'	262040	000006		POP	P,T1		;T1/USERMODE,,TARGET JOB#
 10471	015460'	350001	000000		AOS	(P)
 10472	015461'	261040	000006		PUSH	P,T1
 10473	015462'	603300	000004		TLNE	T1,(1B15)	;does user want frame continued?
 10474	015463'	260040	015476'		 PUSHJ	P,RTCONT	;yes - do it
 10475	015464'	262040	000006		POP	P,T1
 10476	015465'	603300	000001		TLNE	T1,(1B17)	;WANTS USER MODE?
 10477	015466'	254000	015472'		 JRST	TATUU1		;YES.
 10478	015467'	260040	000000*		PUSHJ	P,PRPRMT##	;GIVE HIM A PERIOD OR HYPHEN
 10479	015470'	260040	014250'		PUSHJ	P,CNCMOD	;FORCE TO COMMAND LEVEL
 10480	015471'	254000	014230'		JRST	TTYSTC		;AND GO
 10481
 10482	015472'	205300	020000	TATUU1:	MOVSI	T1,LDLCOM
 10483	015473'	412305	000031		ANDCAM	T1,LDBDCH(U)	; PUT INTO USER MODE
 10484	015474'	260040	007603'		PUSHJ	P,SETLMD
 10485	015475'	263040	000000		POPJ	P,		; SKIP-RETURN ((P) AOS'D ABOVE)
 10486
 10487
 10488				; RTCONT - call here to make sure target frame is running.
 10489				; Called in response to user request by ATTACH UUO and RETACH UUO.
 10490				; Expects J/ target JOB #.
 10491				; Clobbers T1 alot.
 10492
 10493	015476'	335302	006761*	RTCONT:	SKIPGE	T1,JBTSTS(J)	;check if its already running
 10494	015477'	263040	000000		 POPJ	P,		;yep! nothing to do
 10495	015500'	603300	020000		TLNE	T1,JERR		;can't continue if JERR set
 10496	015501'	263040	000000		 POPJ	P,
 10497	015502'	324740	014746*		PJRST	SETRUN		;resume execution in target and return
 10498
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 233
SCNSER.MAC	25-JAN-91 22:40		HERE FROM THE ATTACH UUO IF IT'S ATTACHING

 10499				COMMENT @
 10500
 10501				RETACH UUO - MOVE A TTY SOMEWHERE ELSE
 10502
 10503					MOVEI	AC, [
 10504						SOURCE FRAME,,TARGET FRAME
 10505						BITS,,PORT
 10506					]
 10507					RETACH	AC,
 10508					  ERROR RETURN	;AC/ ERROR CODE
 10509					NORMAL RETURN	;AC/ PORT# OF PORT MOVED (FROM RH(DEVNAM))
 10510
 10511					<BITS> = 1B0 TO ATTACH AS AUX/SLAVE PORT RATHER THAN
 10512						     AS CMND PORT (MUST BE SIGN BIT)
 10513					       + 0B2 TO ATTACH ACCORDING TO SAVED CMND MODE STATE
 10514						 1B2 TO ATTACH IN CURRENT COMMAND MODE STATE
 10515						 2B2 TO FORCE COMMAND MODE
 10516						 3B2 TO FORCE USER MODE
 10517					       + 1B3 TO SIGNAL A HANGUP ON THE SOURCE FRAME
 10518
 10519					<ERROR CODE> = (SEE DEFINITIONS BELOW)
 10520				@
 10521
 10522			400000	RT.SLV==400000
 10523			300000	RT.MOD==300000
 10524				  DEFINE RTYMOD(X) = <[POINT 2,X,2]>
 10525			000000	  .RTMSV==0
 10526			000001	  .RTMCU==1
 10527			000002	  .RTMCO==2
 10528			000003	  .RTMUS==3
 10529			040000	RT.SIG==040000
 10530			020000	RT.CON==020000
 10531
 10532			000001	RTSAC%==1	;INSUFFICIENT ACCESS TO SOURCE FRAME
 10533			000002	RTSNX%==2	;SOURCE FRAME DOES NOT EXIST
 10534			000003	RTTAC%==3	;INSUFFICIENT ACCESS TO TARGET FRAME
 10535			000004	RTTNX%==4	;TARGET FRAME DOESN'T EXIST
 10536			000005	RTSNA%==5	;PORT NOT ATTACHED TO SOURCE FRAME
 10537			000006	RTTAT%==6	;PORT ALREADY ATTACHED TO TARGET FRAME
 10538			000007	RTSCP%==7	;FORCED COMMAND PENDING ON PORT
 10539			000010	RTAUX%==10	;ATTACHING AUX CIRCUIT AS CMND PORT
 10540			000011	RTNRM%==11	;NO ROOM FOR NEW DDB
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 234
SCNSER.MAC	25-JAN-91 22:40		RETACH uuo

 10541				SUBTTL	RETACH uuo
 10542
 10543	015503'	256200	020104'	RETACH::XCTFU <MOVE P1,0(T1)>	;P1/ SOURCE,,TARGET
 10544	015504'	256200	020105'		XCTFU <MOVE P2,1(T1)>	;P2/ BITS,,PORT
 10545
 10546				    ;CHECK ACCESS TO SOURCE FRAME
 10547
 10548	015505'	554740	000014		HLRZ	P4, P1		;P4/ SOURCE FRAME DESC
 10549	015506'	551700	000010		HRRZI	P3, .ARDET
 10550	015507'	260040	000000*		PUSHJ	P, FARCHK##	;MAY WE DETACH FROM THE SOURCE?
 10551					  JRST	[
 10552						MOVEI	T1, RTSAC%
 10553						JRST	RTERR
 10554	015510'	254000	020106'		]
 10555	015511'	205300	040000		MOVSI	T1, JNA
 10556	015512'	616302	015476*		TDNN	T1, JBTSTS(J)	;IS THE SOURCE JOB THERE?
 10557					 JRST	[
 10558						MOVEI	T1, RTSNX%
 10559						JRST	RTERR
 10560	015513'	254000	020110'		]
 10561	015514'	506100	000014		HRLM	J, P1
 10562
 10563				    ;CHECK ACCESS TO TARGET FRAME
 10564
 10565	015515'	550740	000014		HRRZ	P4, P1		;P4/ TARGET FRAME DESC
 10566	015516'	551700	000007		HRRZI	P3, .ARATT
 10567	015517'	260040	015507*		PUSHJ	P, FARCHK##	;MAY WE ATTACH TO THE TARGET?
 10568					  JRST	[
 10569						MOVEI	T1, RTTAC%
 10570						JRST	RTERR
 10571	015520'	254000	020112'		]
 10572	015521'	205300	040000		MOVSI	T1, JNA
 10573	015522'	616302	015512*		TDNN	T1, JBTSTS(J)	;IS THE TARGET JOB THERE?
 10574					 JRST	[
 10575						MOVEI	T1, RTTNX%
 10576						JRST	RTERR
 10577	015523'	254000	020114'		]
 10578	015524'	542100	000014		HRRM	J, P1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 235
SCNSER.MAC	25-JAN-91 22:40		RETACH uuo

 10579				    ;SAVE THE CALLER'S JOB #
 10580
 10581	015525'	261040	000002		PUSH	P, J
 10582
 10583				    ;GET THE PORT BEING MOVED
 10584
 10585	015526'	554100	000014		HLRZ	J, P1		;J/ SOURCE FRAME #
 10586	015527'	570200	000015		HRRE	F, P2		;F/ SOURCE PORT DESCRIPTOR
 10587	015530'	260040	016312'		PUSHJ	P, FNDPRT	;SET F/ DDB ADDR. IF NO DDB
 10588	015531'	254000	015534'		  JRST	RETCH1
 10589	015532'	550244	000013		HRRZ	U, DDBLDB(F)
 10590	015533'	326240	015536'		JUMPN	U, RETCH2	;OR IF IT IS DETACHED
 10591	015534'	201300	000005	RETCH1:	MOVEI	T1, RTSNA%
 10592	015535'	254000	015663'		JRST	RTERJ		;  RESTORE J AND ERROR-RETURN
 10593
 10594				    ;J/ SOURCE FRAME#  F/ SOURCE DDB  U/ LDB
 10595
 10596	015536'	335005	000000	RETCH2:	SKIPGE	LDBDDB(U)	;IF LINE HAS PENDING COMMANDS,
 10597					 JRST	[
 10598						MOVEI	T1, RTSCP%
 10599						JRST	RTERJ	;  RESTORE J AND ERROR-RETURN
 10600	015537'	254000	020116'		]
 10601	015540'	135300	000206'		LDB	T1, LDPCOM
 10602	015541'	137300	000246'		DPB	T1, DDPCOM	;SAVE CMND MODE STATE
 10603	015542'	260040	015775'		PUSHJ	P, NAMSCN	;T1 := PORT # FROM RH(DEVNAM)
 10604	015543'	705313	000000		UMOVEM	T1, (M)		;GIVE IT TO CALLER
 10605	015544'	550100	000014		HRRZ	J, P1		;J/ TARGET FRAME #
 10606	015545'	542200	000015		HRRM	F, P2		;P2/ BITS,,SOURCE DDB
 10607	015546'	321640	015610'		JUMPL	P2, RTATS	;Negative TO ATTACH AS AUX/SLAVE PORT
 10608				    ;HERE TO ATTACH AS TARGET'S COMMAND PORT
 10609				    ;J/ TARGET JOB #  U/ LDB ADDR
 10610
 10611	015547'	550100	000014	RTATC:	HRRZ	J, P1		;J/ TARGET FRAME #
 10612	015550'	550202	015440*		HRRZ	F, TTYTAB(J)	;F/ 0,,DDB ADDR
 10613	015551'	336000	000004		SKIPN	F		;IF THERE'S NO DDB,
 10614	015552'	256000	000000'		 STOPCD 		;  CRASH
 10615	015553'	500245	000031		HLL	U, LDBDCH(U)
 10616	015554'	603240	000040		TLNE	U, LDLAUX	;IF IT'S AN AUX CIRCUIT,
 10617					 JRST	[
 10618						MOVEI T1, RTAUX%
 10619						JRST RTERJ	;  RESTORE J AND ERROR-RETURN
 10620	015555'	254000	020120'		]
 10621	015556'	550304	000013		HRRZ	T1, DDBLDB(F)
 10622					JUMPN	T1, [		;IF JOB'S ATTACHED ALREADY,
 10623						MOVEI	T1, RTTAT%
 10624						JRST	RTERJ	;  RESTORE J AND ERROR-RETURN
 10625	015557'	326300	020122'		]
 10626
 10627	015560'	200300	015435*		MOVE	T1,TIMRST##
 10628	015561'	137100	015436*		DPB	J,CLKJOB##
 10629	015562'	260040	015437*		PUSHJ	P,CHGCLK	;RESET TIMEOUT-ON-DISCONNECT TIMER
 10630	015563'	260040	015764'		PUSHJ	P,SCNNAM	;DEVNAM(F) := "TTY" & CVOS(LINE#)
 10631	015564'	260040	000000*		PUSHJ	P,LOGLDB##	;Set LDBLOG from UPTLOG if LDBLOG is zero
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 235-2
SCNSER.MAC	25-JAN-91 22:40		RETACH uuo

 10632	015565'	260040	015666'		PUSHJ	P,COMATT	;JOIN F AND U
 10633
 10634	015566'	603640	020000		TLNE	P2,RT.CON	;User want us to force CONTINUE on target?
 10635	015567'	260040	015476'		 PUSHJ	P,RTCONT	;yes - go do it
 10636
 10637	015570'	135300	020124'		LDB	T1, RTYMOD<P2>	;T1/ LDLCOM "MODE"
 10638					JRST	@[
 10639						RTCSV		;0  .RTCSV  FORCE SAVED MODE
 10640						RTFIN		;1  .RTCCU  RETAIN CURRENT MODE
 10641						RTCCO		;2  .RTCCO  FORCE COMMAND MODE
 10642						RTCUS		;3  .RTCUS  FORCE USER MODE
 10643	015571'	254026	020125'		](T1)
 10644
 10645	015572'	205300	040000	RTCSV:	MOVSI	T1, DCLCOM
 10646	015573'	616304	000012		TDNN	T1, DDBDCH(F)	;CHECK SAVED LDLCOM SETTING
 10647	015574'	254000	015576'		JRST	RTCUS		;WAS 0 -- FORCE USER MODE
 10648	015575'	254000	015602'		JRST	RTCCO		;WAS 1 -- FORCE CMND MODE
 10649
 10650	015576'	205300	020000	RTCUS:	MOVSI	T1, LDLCOM
 10651	015577'	412305	000031		ANDCAM	T1, LDBDCH(U)	;CLEAR COMMAND MODE
 10652	015600'	260040	007603'		PUSHJ	P, SETLMD	;FIX LINE MODE FIELD
 10653	015601'	254000	015641'		JRST	RTFIN
 10654
 10655	015602'	205300	020000	RTCCO:	MOVSI	T1,LDLCOM
 10656	015603'	612305	000031		TDNE	T1,LDBDCH(U)	;IF NOT ALREADY AT CMND MODE,
 10657	015604'	254000	015641'		JRST	RTFIN
 10658	015605'	260040	015467*		PUSHJ	P,PRPRMT##	;  PRINT A PROMPT
 10659	015606'	260040	014250'		PUSHJ	P,CNCMOD	;  FORCE TO CMND MODE
 10660	015607'	254000	015641'		JRST	RTFIN
 10661
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 236
SCNSER.MAC	25-JAN-91 22:40		RETACH uuo

 10662				    ;HERE TO ATTACH AS A SLAVE PORT TO TARGET
 10663				    ;J/ TARGET JOB #  U/ LDB ADDR
 10664
 10665	015610'	135200	000157'	RTATS:	LDB	F, LDPLNO	;F/ PORT #
 10666	015611'	260040	016312'		PUSHJ	P, FNDPRT	;F/ DDB FOR PORT. IF THERE ISN'T ONE,
 10667	015612'	254000	015623'		JRST	RTATS1		;  GO ALLOCATE A DDB
 10668	015613'	550300	000015		HRRZ	T1, P2		;T1/ SOURCE DDB
 10669	015614'	306304	000000		CAIN	T1, (F)		;IF IT'S THE SAME AS THE TARGET,
 10670	015615'	254000	015623'		JRST	RTATS1		;  ALWAYS ALLOCATE A NEW ONE
 10671
 10672				    ;USING EXISTING DDB
 10673
 10674	015616'	550304	000013		HRRZ	T1, DDBLDB(F)
 10675					JUMPN	T1, [		;IF ALREADY ATTACHED,
 10676						MOVEI	T1, RTTAT%
 10677						JRST	RTERJ	;RESTORE J AND ERROR-RETURN
 10678	015617'	326300	020122'		]
 10679	015620'	201300	646471		MOVEI	T1, (SIXBIT/TTY/)
 10680	015621'	506304	000000		HRLM	T1, DEVNAM(F)
 10681	015622'	254000	015634'		JRST	RTATS2
 10682
 10683				    ;ALLOCATING NEW DDB
 10684
 10685	015623'	550302	015550*	RTATS1:	HRRZ	T1, TTYTAB(J)	;T1/ TARGET CMND PORT DDB
 10686	015624'	336000	000006		SKIPN	T1		;IF THERE IS NONE,
 10687	015625'	256000	000000'		 STOPCD 		;  CRASH
 10688	015626'	260040	015720'		PUSHJ	P, DDBSR1	;F/ NEW DDB, LINKED AFTER CMND PORT.
 10689					  JRST	[		;IF THERE'S NO ROOM FOR ONE,
 10690						MOVEI T1, RTNRM%
 10691						JRST RTERJ	;  RESTORE J AND ERROR-RETURN
 10692	015627'	254000	020131'		]
 10693	015630'	137100	015434*		DPB	J, PJOBN	;SET JOB #
 10694	015631'	260040	015764'		PUSHJ	P, SCNNAM	;AND PHYSICAL NAME
 10695	015632'	201300	400000		MOVEI	T1, ASSCON
 10696	015633'	436304	000004		IORM	T1, DEVMOD(F)	;MARK IT ASSIGNED-BY-CONSOLE
 10697
 10698				    ;ATTACH IT
 10699
 10700	015634'	205300	020000	RTATS2:	MOVSI	T1, LDLCOM
 10701	015635'	412305	000031		ANDCAM	T1, LDBDCH(U)	;MAKE SURE IT'S NOT IN COMMAND MODE
 10702	015636'	205300	020000		MOVSI	T1, TTYATC
 10703	015637'	412304	000004		ANDCAM	T1, DEVMOD(F)	;MARK IT AS A NONCOMMAND PORT
 10704	015640'	260040	015666'		PUSHJ	P, COMATT	;JOIN F AND U
 10705					PFALL	RTFIN
 10706				    ;DETACH THE SOURCE END
 10707
 10708	015641'	554100	000014	RTFIN:	HLRZ	J, P1		;J/ SOURCE FRAME #
 10709	015642'	550200	000015		HRRZ	F, P2		;F/ SOURCE DDB
 10710	015643'	513004	000013		HLLZS	DDBLDB(F)	;DETACH SOURCE
 10711	015644'	553004	000000		HRRZS	DEVNAM(F)	;MAKE IT LOOK DETACHED
 10712	015645'	205300	020000		MOVSI	T1, TTYATC
 10713	015646'	616304	000004		TDNN	T1, DEVMOD(F)	;WAS SOURCE A COMMAND OR A SLAVE PORT?
 10714	015647'	254000	015654'		 JRST	RTFIN1		;(AUX/SLAVE)
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 236-2
SCNSER.MAC	25-JAN-91 22:40		RETACH uuo

 10715
 10716				    ;HERE WHEN WE'VE DETACHED SOURCE'S COMMAND PORT
 10717
 10718	015650'	607640	040000		TLNN	P2, RT.SIG	;IF WE'RE SIGNALLING A HANGUP,
 10719	015651'	254000	000000*		 JRST	IPOPJ1
 10720	015652'	260040	006640'		PUSHJ	P, HNGTTY	;  FORCE A DETACHED-JOB HANGUP
 10721								; J has job #
 10722	015653'	254000	015651*		JRST	IPOPJ1
 10723
 10724				    ;HERE WHEN WE'VE DETACHED AN AUX/SLAVE PORT
 10725
 10726	015654'	607640	040000	RTFIN1:	TLNN	P2, RT.SIG	;IF WE'RE SIGNALLING A HANGUP,
 10727	015655'	254000	015660'		 JRST	RTFIN2
 10728	015656'	135300	000234'		LDB	T1, DDPTZP
 10729	015657'	260040	011223*		PUSHJ	P, TAKTRJ	;  CAUSE A ZAPPED INTERRUPT
 10730	015660'	201340	400000	RTFIN2:	MOVEI	T2, ASSCON
 10731	015661'	260040	011225*		PUSHJ	P, RELEA6	;TRY TO FREE THE DDB
 10732	015662'	254000	015653*		JRST	IPOPJ1
 10733	
 10734				    ;ERROR-RETURNS
 10735
 10736	015663'	262040	000002	RTERJ:	POP	P, J		;RESTORE J
 10737	015664'	705313	000000	RTERR:	UMOVEM	T1, (M)		;STORE ERROR CODE
 10738	015665'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 237
SCNSER.MAC	25-JAN-91 22:40		COMATT - PERFORMS THE FUNCTIONS COMMON TO ALL ATTACH FUNCTIONS:

 10739				SUBTTL	COMATT - PERFORMS THE FUNCTIONS COMMON TO ALL ATTACH FUNCTIONS:
 10740				;	     LINKS LDBDDB(U) AND DDBLDB(F)
 10741				;	     SETS NEED-OUTPUT BIT OF LDB SO ATTACHEE WILL BE AWAKENED
 10742				;	     SETS NON-DEVIOS LDB DEVICE CHARACTERISTIC BITS
 10743				;	     CALLS UUOLDB TO SET DEVIOS DEVICE CHARACTERISTIC BITS
 10744				;	   F/ DDB ADDR  U/ LDB ADDR
 10745				;	   DESTROYS T1-T4
 10746
 10747	015666'	602200	777777	COMATT:	TRNE	F, -1
 10748	015667'	606240	777777		TRNN	U, -1
 10749	015670'	256000	000000'		 STOPCD 		;MUST HAVE A DDB AND AN LDB
 10750	015671'	542244	000013		HRRM	U, DDBLDB(F)
 10751	015672'	542205	000000		HRRM	F, LDBDDB(U)	;DO THE ATTACH
 10752	015673'	201300	000001		MOVEI	T1, 1
 10753	015674'	137305	000002		DPB	T1, LDBOPB(U)	;SET NEED-OUTPUT
 10754	015675'	135300	000244'		LDB	T1, DDPIMB
 10755	015676'	137300	000203'		DPB	T1, LDPIMB	;SET IMAGE-MODE BREAK CHARACTER
 10756	015677'	200404	000012		MOVE	T3, DDBDCH(F)
 10757	015700'	200305	000027		MOVE	T1, LDBBYT(U)
 10758	015701'	607400	100000		TLNN	T3, DCLNTB	;NO HT/VT/FF ECHO
 10759	015702'	625300	020000		TLZA	T1, L2LNTB
 10760	015703'	661300	020000		TLO	T1, L2LNTB
 10761	015704'	202305	000027		MOVEM	T1, LDBBYT(U)
 10762	015705'	201300	100000		MOVEI	T1, L2LTBK	;TABS-AS-BREAKS
 10763	015706'	603400	200000		TLNE	T3, DCLTBK
 10764	015707'	505300	100000		HRLI	T1, L2LTBK
 10765	015710'	260040	007607'		PUSHJ	P, SETTBK
 10766	015711'	201300	040000		MOVEI	T1, L2LBBP	;BACKSPACE-AS-NONBREAK
 10767	015712'	603400	400000		TLNE	T3, DCLBBP
 10768	015713'	505300	040000		HRLI	T1, L2LBBP
 10769	015714'	260040	007607'		PUSHJ	P, SETTBK
 10770	015715'	200004	000002		MOVE	S, DEVIOS(F)
 10771	015716'	324740	013554'		PJRST	UUOLDB		;SET DEVIOS-DEPENDENT LDB BITS
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 238
SCNSER.MAC	25-JAN-91 22:40		ROUTINE TO FIND A FREE TTY DEVICE DATA BLOCK

 10772				SUBTTL	ROUTINE TO FIND A FREE TTY DEVICE DATA BLOCK
 10773
 10774				;CALL FROM CLOCK LEVEL TO DO AN ATTACH ON A NEW JOB, OR
 10775				;FROM UUO LEVEL ON AN INIT OF A NEW LINE.
 10776
 10777				;CALL:	NO ARGUMENTS
 10778				;	PUSHJ P,DDBSRC
 10779				;	  ERROR RETURN		;NONE AVAILABLE. F=0. T1 CLOBBERED
 10780				;	OK RETURN		;ADDRESS IN F, TTYUSE SET IN DEVMOD
 10781				;				;RESPECTS J,U,CH.
 10782				;				;IF YOU DECIDE NOT TO USE F, YOU BETTER
 10783				;				;FREE IT UP AGAIN.
 10784
 10785	015717'	200300	017037'	DDBSRC:	MOVE T1,TTYFLK	;WHERE TO LINK IN
 10786	015720'	550200	017036'	DDBSR1:	HRRZ F,FRETTY	;HERE IF TO LINK AT SPECIAL SPOT WITH T1 SET
 10787	015721'	322200	015346*		JUMPE F,CPOPJ		;NO DDB'S AVAILABLE
 10788	015722'	554204	000003		HLRZ F,DEVSER(F)	;GET NEXT FREE
 10789	015723'	250200	017036'		EXCH F,FRETTY		;RESTORE F AND UPDATE FREE LIST
 10790	015724'	261046	000003		PUSH P,DEVSER(T1)
 10791	015725'	506206	000003		HRLM F,DEVSER(T1)	;LINK INTO DDB CHAIN
 10792	015726'	506304	000013		HRLM T1,DDBBLK(F)	;PUT IN THE BACK LINK
 10793	015727'	262040	000006		POP P,T1
 10794	015730'	502304	000003		HLLM T1,DEVSER(F)	;NOW LINK IT IN
 10795	015731'	207000	000006		MOVSS T1
 10796	015732'	261040	000010		PUSH P,T3
 10797	015733'	200406	000004		MOVE T3,DEVMOD(T1)	;IS THE NEXT ONE DOWN
 10798	015734'	603400	000010		TLNE T3,DVTTY		;ALSO A TTY?
 10799	015735'	506206	000013		HRLM F,DDBBLK(T1)	;YES, RESET ITS BACK LINK
 10800	015736'	262040	000010		POP P,T3
 10801	015737'	200300	020073'		MOVE T1,[XWD TTYATC,ASSCON+ASSPRG]
 10802	015740'	412304	000004		ANDCAM T1,DEVMOD(F)	;TURN OFF USE BITS
 10803	015741'	402004	000005		SETZM DEVLOG(F)		;NO LOGICAL NAME
 10804
 10805			000000	ZZ0==0
 10806				REPEAT <TRPLEN+5>/6,<
 10807					SETZM	DDBTRP+ZZ0(F)
 10808				ZZ0==ZZ0+1>
 10809	015742'	402004	000014
 10810	015743'	402004	000015
 10811
 10812	015744'	205300	000004		MOVSI T1,IOFST
 10813	015745'	137300	015630*		DPB T1,PJOBN		;SET JOB TO 0 (GO FOR IT, BILL!)
 10814	015746'	202304	000002		MOVEM T1,DEVIOS(F)
 10815	015747'	402004	000012		SETZM	DDBDCH(F)	;CLEAR NONDEVIOS DEVICE CHARACTERISTICS
 10816	015750'	254000	015443*		JRST CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 239
SCNSER.MAC	25-JAN-91 22:40		TTYNFR - CALLED WITH J/ FRAME # TO ALLOCATE A NEW

 10817				SUBTTL	TTYNFR - CALLED WITH J/ FRAME # TO ALLOCATE A NEW
 10818				;	   (DETACHED) TTY DDB FOR THE FRAME AND STORE A
 10819				;	   POINTER TO IT IN TTYTAB(J)
 10820				;	   (DEVNAM WILL BE 0,,SIXBIT /TTY/)
 10821				;	   NONSKIP-RETURNS IF NO DDB FREECORE, OTHERWISE SKIP-RETURNS
 10822
 10823	015751'	260040	014563'	TTYNFR::PUSHJ	P, TTYSRC	;IF IT ALREADY HAS A COMMAND PORT DDB,
 10824	015752'	260040	015717'		  PUSHJ	P, DDBSRC	;OR THERE'S NO ROOM TO ALLOCATE ONE,
 10825	015753'	263040	000000		    POPJ P,		;  ERROR-RETURN
 10826	015754'	513004	000013		HLLZS	DDBLDB(F)	;MAKE SURE IT KNOWS IT'S DETACHED
 10827	015755'	201300	646471		MOVEI	T1, (SIXBIT /TTY/)
 10828	015756'	202304	000000		MOVEM	T1, DEVNAM(F)	;SET ITS NAME
 10829	015757'	200300	020103'		MOVE	T1, [TTYATC,,ASSCON]
 10830	015760'	436304	000004		IORM	T1, DEVMOD(F)	;MARK IT AS A COMMAND PORT
 10831	015761'	137100	015745*		DPB	J, PJOBN	;SET ITS OWNER
 10832	015762'	552202	015623*		HRRZM	F, TTYTAB(J)
 10833	015763'	254000	015750*		JRST	CPOPJ1
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 240
SCNSER.MAC	25-JAN-91 22:40		SCNNAM - SET DEVNAM(F) TO "TTYNNN" WHERE NNN IS

 10834				SUBTTL	SCNNAM - SET DEVNAM(F) TO "TTYNNN" WHERE NNN IS
 10835				;	   LDPLNO (FETCHED THROUGH U) IN OCTAL
 10836				;	   BREAKS T1 T3
 10837
 10838	015764'	135300	000157'	SCNNAM:	LDB T1,LDPLNO
 10839	015765'	137300	000000*		DPB T1,PUNIT
 10840	015766'	205400	646471		MOVSI T3,(SIXBIT /TTY/)
 10841	015767'	202404	000000		MOVEM T3,DEVNAM(F)
 10842	015770'	200400	020133'		MOVE T3,[POINT 6,DEVNAM(F),17]
 10843	015771'	261040	000007		PUSH P,T2		;SCNNMR CLOBBERS THIS ONE
 10844	015772'	260040	014677'		PUSHJ P,SCNNMR		;RADIX PRINT TO CORE
 10845	015773'	262040	000007		POP P,T2
 10846	015774'	263040	000000		POPJ P,
 10847
 10848				;NAMSCN - CALLED WITH F/ TTY DDB
 10849				;	   RETURNS WITH T1/ PORT# FROM RH(DEVNAM)
 10850
 10851	015775'	261040	000007	NAMSCN:	PUSH	P, T2
 10852	015776'	400300	000000		SETZ	T1,
 10853	015777'	514344	000000		HRLZ	T2, DEVNAM(F)
 10854	016000'	311340	020066'	NAMSC1:	CAML	T2, [200000,,000000]
 10855	016001'	313340	020134'		CAMLE	T2, [272727,,000000]
 10856	016002'	254000	016006'		JRST	NAMSC2
 10857	016003'	242340	000003		LSH	T2, 3
 10858	016004'	246300	000003		LSHC	T1, 3
 10859	016005'	254000	016000'		JRST	NAMSC1
 10860	016006'	262040	000007	NAMSC2:	POP	P, T2
 10861	016007'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 241
SCNSER.MAC	25-JAN-91 22:40		TRAP CODE

 10862				SUBTTL TRAP CODE
 10863
 10864				;CHECK FOR CHARACTER TRAP
 10865
 10866	016010'	603240	020000	CHRTRP:	TLNE U,LDLCOM
 10867	016011'	263040	000000		POPJ P,		;NEVER AT COMMAND MODE
 10868	016012'	201300	010000		MOVEI T1,LXRCHR
 10869	016013'	436305	000032		IORM T1,LDBDCX(U)	;SET BIT FOR POLPRT
 10870	016014'	550205	000000		HRRZ F,LDBDDB(U)
 10871	016015'	322200	015721*		JUMPE F,CPOPJ	;NO TRAP IF NO DDB
 10872	016016'	135300	000226'		LDB T1,DDPTCH
 10873	016017'	201340	000400		MOVEI T2,FLGCHR	;AND SET THE FLAG IN CASE OLD TYPE
 10874	016020'	324740	000000*		PJRST TAKOTJ
 10875
 10876				;NOW FOR A LINE TRAP
 10877
 10878	016021'	550205	000000	LINTRP:	HRRZ F,LDBDDB(U)	;NEVER CALLED AT COMMAND LEVEL
 10879	016022'	322200	016015*		JUMPE F,CPOPJ
 10880	016023'	201300	004000		MOVEI T1,LXRBRK
 10881	016024'	436305	000032		IORM T1,LDBDCX(U)	;SET BIT FOR POLPRT
 10882	016025'	261040	000007		PUSH P,T2	;MUST PRESERVE T2
 10883	016026'	135300	000227'		LDB T1,DDPTLN
 10884	016027'	201340	004000		MOVEI T2,FLGLIN
 10885	016030'	260040	016020*		PUSHJ P,TAKOTJ
 10886	016031'	262040	000007		POP P,T2
 10887	016032'	263040	000000		POPJ P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 242
SCNSER.MAC	25-JAN-91 22:40		CALLED ON AN ESCAPE TO SEE IF WE SHOULD SET TRAP

 10888				SUBTTL	CALLED ON AN ESCAPE TO SEE IF WE SHOULD SET TRAP
 10889
 10890	016033'	603240	020000	ESCTRP:	TLNE U,LDLCOM
 10891	016034'	263040	000000		POPJ P,		;NEVER IN COMMAND MODE
 10892	016035'	201300	400000		MOVEI T1,LXRESC
 10893	016036'	436305	000032		IORM T1,LDBDCX(U)	;SET BIT FOR POLPRT
 10894	016037'	550205	000000		HRRZ F,LDBDDB(U)
 10895	016040'	322200	016022*		JUMPE F,CPOPJ
 10896	016041'	261040	000006		PUSH P,T1		;JUST LIKE CODE ABOVE
 10897	016042'	135300	000225'		LDB T1,DDPTSC
 10898	016043'	205340	000001		MOVSI T2,FLGESC
 10899	016044'	260040	000000*		PUSHJ P,TAKNZJ		;TAKE THIS TRAP IF REALLY ENABLED
 10900	016045'	254000	015456*		 JRST TPOPJ		;NOT ENABLED
 10901	016046'	262040	000006		POP P,T1		;ENABLED
 10902	016047'	254000	016045*		JRST TPOPJ		;RETURN UP A LEVEL TO IGNORE CHR
 10903
 10904				;CALLED FROM TYI WHEN AN ESCAPE IS READ TO CHECK ABOUT TRAPPING
 10905
 10906	016050'	261040	000006	ESCTR1:	PUSH P,T1		;FOUND ESCAPE READING CHRS
 10907	016051'	201300	400000		MOVEI T1,LXRESC
 10908	016052'	436305	000032		IORM T1,LDBDCX(U)	;SET BIT FOR POLPRT
 10909	016053'	135300	000225'		LDB T1,DDPTSC
 10910	016054'	205340	000001		MOVSI T2,FLGESC
 10911	016055'	260040	016044*		PUSHJ P,TAKNZJ		;TRY THE TRAP
 10912	016056'	254000	016047*		 JRST TPOPJ	;NOT ENEABLED
 10913	016057'	254000	013717*		JRST ABTUUO		;ABORT THE UUO. IF ALREADY IN
 10914							;HIGHER TRAP WE WILL JUST DO THE INPUT
 10915							;AGAIN
 10916
 10917				;CALLED WHEN AN ORANGE BALL IS RECEIVED TO CHECK ON TRAPS
 10918
 10919	016060'	201300	200000	OBREC:	MOVEI	T1, LXROBS
 10920	016061'	436305	000032		IORM	T1, LDBDCX(U)	; SET "ORANGE BALL SEEN" BIT
 10921	016062'	550205	000000		HRRZ F,LDBDDB(U)	;GOT AN ORANGE BALL. DDB THERE?
 10922	016063'	322200	016040*		JUMPE F,CPOPJ		;NO
 10923	016064'	135300	000233'		LDB T1,DDPTOB		;GET THE CHANNEL NUMBER
 10924	016065'	254000	016055*		JRST TAKNZJ		;AND SET UP TO TRAP
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 243
SCNSER.MAC	25-JAN-91 22:40		ROUTINE TO TAKE A JOB OUT OF TIOW FOR A TRAP

 10925				SUBTTL	ROUTINE TO TAKE A JOB OUT OF TIOW FOR A TRAP
 10926
 10927	016066'	261040	000004	TTYWAK::PUSH P,F
 10928	016067'	261040	000000		PUSH P,S
 10929	016070'	260040	016110'		PUSHJ P,FRSTTY	;FIND THE FIRST TTY FOR THIS JOB
 10930	016071'	254000	016105'		 JRST TTYWK1	;NONE THERE, MUST NOT RALLY BE IN IOW
 10931	016072'	200004	000002	TTYWK2:	MOVE S,DEVIOS(F)
 10932	016073'	260040	006010'		PUSHJ P,TIWAKE	;WAKE HIM UP IF IN IOW
 10933	016074'	261040	000005		PUSH P,U
 10934	016075'	550244	000013		HRRZ U,DDBLDB(F)
 10935	016076'	322240	016101'		JUMPE U,TTYWK3	;NOT ATTACHED, NOTHING WE CAN DO
 10936	016077'	205000	400000		MOVSI S,L2LOEX	;SET EXTENDED OUTPUT BUFFER ING SO
 10937	016100'	436005	000027		IORM S,LDBBYT(U)	;JOB CAN FINISH UUO
 10938	016101'	262040	000005	TTYWK3:	POP P,U
 10939	016102'	260040	016112'		PUSHJ P,NXTTTY
 10940	016103'	334000	000000		 SKIPA		;NEXT TTY NOT THERE
 10941	016104'	254000	016072'		JRST TTYWK2	;TRY THE NEXT ONE
 10942	016105'	262040	000000	TTYWK1:	POP P,S		;FINISHED
 10943	016106'	262040	000004		POP P,F
 10944	016107'	263040	000000		POPJ P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 244
SCNSER.MAC	25-JAN-91 22:40		ROUTINES TO FIND A JOB'S TTY DDBS

 10945				SUBTTL	ROUTINES TO FIND A JOB'S TTY DDBS
 10946
 10947	016110'	550202	015762*	FRSTTY:	HRRZ F,TTYTAB(J)	;FIRST ONE SHOULD BE THE CONTROLING TTY
 10948	016111'	334000	000000		SKIPA
 10949	016112'	554204	000003	NXTTTY:	HLRZ F,DEVSER(F)	;IF WANT THE NEXT, FOLLOW CHAIN
 10950	016113'	322200	016063*		JUMPE F,CPOPJ		;DONE
 10951	016114'	200004	000004		MOVE S,DEVMOD(F)
 10952	016115'	607000	004010		TLNN S,DVTTY!DVRMT	;IS IT STILL A TTY OR RMT
 10953	016116'	263040	000000		POPJ P,			;NO
 10954	016117'	135000	015761*		LDB S,PJOBN
 10955	016120'	316000	000002		CAMN S,J		;FOR THIS JOB?
 10956	016121'	350001	000000		AOS (P)		;YES, SKIP RETURN
 10957	016122'	263040	000000		POPJ P,			;NO, FOUND THEM ALL
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 245
SCNSER.MAC	25-JAN-91 22:40		ROUTINE TO CLEAR SLEEP CONDITIONS FOR ALL TTYS

 10958				SUBTTL	ROUTINE TO CLEAR SLEEP CONDITIONS FOR ALL TTYS
 10959
 10960	016123'	261040	000004	TTSCLR::PUSH	P,F
 10961	016124'	261040	000000		PUSH	P,S
 10962	016125'	201340	000000		MOVEI	T2,0
 10963	016126'	135000	000000*		LDB	S,JBYWAK##	;GET WAKE CHANNEL
 10964	016127'	306000	000044		CAIN	S,^D36		;HIBER CODE?
 10965	016130'	137340	016126*		 DPB	T2,JBYWAK##	;YES, CLEAR IT
 10966	016131'	135000	000000*		LDB	S,JBYEXC##	;GET EXIT IN CHILD CHANNEL
 10967	016132'	306000	000044		CAIN	S,^D36		;HIBER CODE?
 10968	016133'	137340	016131*		 DPB	T2,JBYEXC##	;YES, CLEAR IT
 10969	016134'	260040	016110'		PUSHJ	P,FRSTTY
 10970	016135'	254000	016105'		  JRST	TTYWK1		;ALL DONE, (NO TTYS)
 10971	016136'	205000	004000	TTSCL2:	MOVSI	S,DVRMT
 10972	016137'	612004	000004		TDNE	S,DEVMOD(F)
 10973	016140'	254000	016164'		 JRST	TTSCL3		;DO NOT CLEAR FOR RMTS
 10974	016141'	135000	000226'		LDB	S,DDPTCH
 10975	016142'	306000	000044		CAIN	S,^D36		;IS THIS A SLEEP CODE?
 10976	016143'	137340	000226'		 DPB	T2,DDPTCH	;YES, CLEAR IT
 10977	016144'	135000	000227'		LDB	S,DDPTLN
 10978	016145'	306000	000044		CAIN	S,^D36
 10979	016146'	137340	000227'		 DPB	T2,DDPTLN	;NOW FOR LINE
 10980	016147'	261040	000005		PUSH	P,U
 10981	016150'	550244	000013		HRRZ	U,DDBLDB(F)	;GET LINK TO LDB
 10982	016151'	322240	016163'		JUMPE	U,TTSCL1	;NONE THERE, FINISHED THIS TTY
 10983	016152'	135000	000233'		LDB	S,DDPTOB	;WAITING FOR ORANGE BALL
 10984	016153'	306000	000044		CAIN	S,^D36
 10985	016154'	137340	000233'		 DPB	T2,DDPTOB	;CCLEAR SLEEP
 10986	016155'	135000	000227'		LDB	S,DDPTLN	;LINE
 10987	016156'	306000	000044		CAIN	S,^D36
 10988	016157'	137340	000227'		 DPB	T2,DDPTLN
 10989	016160'	135000	000226'		LDB	S,DDPTCH	;CHARACTER
 10990	016161'	306000	000044		CAIN	S,^D36
 10991	016162'	137340	000226'		 DPB	T2,DDPTCH
 10992	016163'	262040	000005	TTSCL1:	POP	P,U
 10993	016164'	260040	016112'	TTSCL3:	PUSHJ	P,NXTTTY
 10994	016165'	254000	016105'		  JRST	TTYWK1		;FINISHED, GET F AND S BACK AND GO
 10995	016166'	254000	016136'		JRST	TTSCL2		;MORE TO CLEAR
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 246
SCNSER.MAC	25-JAN-91 22:40		ROUTINE TO CLEAR ALL TRAP CONDITIONS FOR ALL TTYS

 10996				SUBTTL	ROUTINE TO CLEAR ALL TRAP CONDITIONS FOR ALL TTYS
 10997
 10998	016167'	261040	000004	TTTCLR::PUSH P,F
 10999	016170'	261040	000000		PUSH P,S
 11000	016171'	260040	016110'		PUSHJ P,FRSTTY
 11001	016172'	254000	016105'		 JRST TTYWK1	;NO MORE TTYS THERE
 11002	016173'			TTTCL1:
 11003				;*;	MOVSI S,DVRMT
 11004				;*;	TDNE S,DEVMOD(F)
 11005				;*;	 JRST	[PUSHJ P,RMTRSI	;RESET FOR REMOTE
 11006				;*;		JRST TTTCL2]
 11007
 11008			000000	ZZ0==0
 11009				REPEAT <TRPLEN+5>/6,<
 11010					SETZM	DDBTRP+ZZ0(F)
 11011				ZZ0==ZZ0+1>
 11012	016173'	402004	000014
 11013	016174'	402004	000015
 11014
 11015	016175'	260040	016112'	TTTCL2:	PUSHJ P,NXTTTY		;FIND THE NEXT ONE FOR THIS JOB
 11016	016176'	254000	016105'		 JRST TTYWK1		;DONE
 11017	016177'	254000	016173'		JRST TTTCL1		;CLEAR IT ALSO
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 247
SCNSER.MAC	25-JAN-91 22:40		THIS ROUTINE ASSIGNES TRAP CHANNELS TO TTY TRAP CONDS

 11018				SUBTTL	THIS ROUTINE ASSIGNES TRAP CHANNELS TO TTY TRAP CONDS
 11019				;CALLED WITH T3 CHANNEL NUMBER
 11020				;	T2 TRAP NUMBER
 11021				;	F TTY DDB
 11022				;	SKIP RETURN IF TRAP CONDITION NOW SATISFIED
 11023
 11024	016200'	135307	000225'	TINAS1::LDB T1,DDPTAB(T2)	;GET CURRENT
 11025	016201'	303400	000043		CAILE T3,^D35		;REAL INTERRUPT CHANNEL?
 11026	016202'	326300	016113*		 JUMPN T1,CPOPJ		;NO, SLEEP. DON'T CLEAR IF INT. THERE
 11027	016203'	137407	000225'		DPB T3,DDPTAB(T2)	;SET TRAP CONDITION IN DDB
 11028	016204'	322400	016202*		JUMPE T3,CPOPJ		;IF ENABLING, NOT DISABLING,
 11029	016205'	550244	000013		HRRZ U, DDBLDB(F)	;  GET LDB IF THERE IS ONE
 11030	016206'	256007	016210'		XCT INTSET(T2)		;  AND CHECK IF IT'S ALREADY TRUE
 11031	016207'	263040	000000		POPJ P,			;IN CASE WE DO NOT TRANSFER
 11032
 11033				;INTERRUPT TEST TABLE - MUST BE IN THE SAME ORDER AS DDPTAB
 11034
 11035	016210'	263040	000000	INTSET:	POPJ P,		;ESCAPE, WILL GET IT LATER
 11036	016211'	326240	016230'		JUMPN U,CHKCHR	;IF LINE PRESENT, CHECK FOR CHARACTERS
 11037	016212'	326240	016237'		JUMPN U,CKLNTR	;IF LINE PRESENT, CHECK FOR BREAKS
 11038	016213'	263040	000000		POPJ P,		;IOW, NEVER PRESET
 11039	016214'	263040	000000		POPJ P,		;FINISH IO
 11040	016215'	254000	016224'		JRST CHKLOS	;LOST CHARACTERS
 11041	016216'	263040	000000		POPJ P,		;ORANGE BALL, NEVER KNOW
 11042	016217'	263040	000000		POPJ P,		;CIRCUIT ZAPPED
 11043	016220'	326240	016253'		JUMPN U,CHKPSP	;IF LINE PRESENT, CHECK FOR UNREAD PORT-STATUS
 11044	016221'	326240	016270'		JUMPN U,CHKYEL	;YELLOW BALL, PERHAPS ONE IS PENDING
 11045	016222'	263040	000000		POPJ P,		;CHARACTER GOBBLER, NOT BUFFERED
 11046	016223'	326240	016257'		JUMPN U,CHKTCC	;IF LINE PRESENT, CHECK FOR CHANGED TC'S
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 248
SCNSER.MAC	25-JAN-91 22:40		ROUTINES TO CHECK IF TRAP CONDITION ALREADY SATISFIED

 11047				SUBTTL	ROUTINES TO CHECK IF TRAP CONDITION ALREADY SATISFIED
 11048
 11049				; CHECK IF CHARACTERS LOST (BY READING IO.BKT)
 11050
 11051	016224'	200004	000002	CHKLOS:	MOVE S,DEVIOS(F)
 11052	016225'	602000	040000		TRNE S,IOBKTL
 11053	016226'	350001	000000		AOS (P)		;BIT ALREADY SET CAN TRAP NOW
 11054	016227'	263040	000000		POPJ P,
 11055
 11056				; CHECK IF CHARACTERS PRESENT (BY READING LDB COUNTS)
 11057
 11058	016230'	500245	000031	CHKCHR:	HLL U,LDBDCH(U)
 11059	016231'	603240	020000		TLNE U,LDLCOM
 11060	016232'	263040	000000		POPJ P,		;NOT SAT AT INTERRUPT LEVEL
 11061	016233'	337005	000014		SKIPG LDBECC(U)	;CHRS TO BE ECHOED
 11062	016234'	333005	000012		SKIPLE LDBTIC(U)	;OR ALREDY ECHOED
 11063	016235'	350001	000000		AOS (P)		;YES
 11064	016236'	263040	000000		POPJ P,
 11065
 11066				; CHECK IF A BREAK CHARACTER IS PRESENT (BY READING LDB COUNTS)
 11067
 11068	016237'	500245	000031	CKLNTR:	HLL U,LDBDCH(U)
 11069	016240'	603240	020000		TLNE U,LDLCOM
 11070	016241'	263040	000000		 POPJ P,
 11071	016242'	200305	000012		MOVE T1,LDBTIC(U)
 11072	016243'	270305	000014		ADD T1,LDBECC(U)	;ENOUGH?
 11073	016244'	301300	000110		CAIL T1,TIWKC
 11074	016245'	254000	015763*		 JRST CPOPJ1		;YES
 11075	016246'	603240	004000		TLNE U,LDLBK2	;WHICH BREAK SET
 11076	016247'	337005	000016		 SKIPG LDBBK2(U)
 11077	016250'	333005	000015		SKIPLE LDBBKC(U)	;TEST CORRECT ONE(S)
 11078	016251'	350001	000000		 AOS (P)
 11079	016252'	263040	000000		POPJ P,
 11080
 11081				; CHECK IF A PORT STATUS MESSAGE IS WAITING TO BE READ
 11082				;See comment at ACPSM
 11083
 11084	016253'	205300	200000	CHKPSP:	MOVSI	T1, LMLPSP
 11085	016254'	603305	000030		TLNE	T1, LDBMOD(U)	; IS THERE A MESSAGE WAITING?
 11086	016255'	350001	000000		 AOS	(P)		; YES
 11087	016256'	263040	000000		POPJ	P,
 11088
 11089				; CHECK IF ANY TERMINAL CHARACTERISTICS HAVE CHANGED
 11090
 11091	016257'	500245	000031	CHKTCC:	HLL	U, LDBDCH(U)
 11092	016260'	616240	040000		TDNN	U, LDLPTY	;IF IT'S NOT A PTY,
 11093	016261'	263040	000000		 POPJ	P,		;  OF COURSE NOT
 11094	016262'	261040	000005		PUSH	P, U
 11095	016263'	260040	007744'		PUSHJ	P, PTYBUD
 11096	016264'	332005	000004		SKIPE	LDBTCB(U)	;ANY UNREAD CHANGES?
 11097	016265'	350001	777777		AOS	-1(P)		;(YES)
 11098	016266'	262040	000005		POP	P, U
 11099	016267'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 248-2
SCNSER.MAC	25-JAN-91 22:40		ROUTINES TO CHECK IF TRAP CONDITION ALREADY SATISFIED

 11100
 11101
 11102				; Test for Yellow ball interrupt condition satisfied:
 11103				;   Skip return if a Yellow ball has been received and no Orange ball
 11104				;   has yet been sent.  If an Orange ball is waiting to be output, it
 11105				;   must be due to a Yellow ball being received while the interrupt
 11106				;   was not enabled.  If the interrupt was enabled, the user will have
 11107				;   already taken the trap.
 11108
 11109	016270'	135300	000104'	CHKYEL:	LDB	T1,LOPSOG	;is OB waiting to be output?
 11110	016271'	626300	000001		TRZN	T1,1		;if so, recall it...
 11111	016272'	263040	000000		 POPJ	P,
 11112	016273'	137300	000104'		DPB	T1,LOPSOG	;its now the user's responsibility
 11113	016274'	205300	004000		MOVSI	T1,LXLOOK	
 11114	016275'	436305	000032		IORM	T1,LDBDCX(U)	;okay for user to send an orange ball
 11115	016276'	350001	000000		AOS	(P)		
 11116	016277'	263040	000000		POPJ	P,
 11117
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 249
SCNSER.MAC	25-JAN-91 22:40		SEND A YELLOW BALL

 11118				SUBTTL	SEND A YELLOW BALL
 11119
 11120	016300'	550244	000013	TTYYLS::HRRZ	U, DDBLDB(F)
 11121	016301'	322240	016204*		JUMPE	U, CPOPJ
 11122	016302'	261040	000006		PUSH	P, T1		;SAVE T1
 11123	016303'	201300	000001		MOVEI	T1, 1
 11124	016304'	137300	000077'		DPB	T1, LOPSYL	;SET SEND-YELLOW
 11125	016305'	137305	000002		DPB	T1, LDBOPB(U)	;AND NEED-OUTPUT
 11126	016306'	254000	016056*		JRST	TPOPJ		;RESTORE T1 AND RETURN
 11127
 11128	016307'	205000	040000	SETFIO:	MOVSI S,TINFIO
 11129	016310'	437004	000002		IORB S,DEVIOS(F)	;SET A FLAG SO WE KNOW WE TRAPPED
 11130								;INSTEAD OF GOING INTO IOW
 11131	016311'	263040	000000		POPJ P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 250
SCNSER.MAC	25-JAN-91 22:40		FNDPRT - CALLED WITH J/ JOB #, F/ -1 OR PORT #

 11132				SUBTTL	FNDPRT - CALLED WITH J/ JOB #, F/ -1 OR PORT #
 11133				;	   LOOKS FOR A DDB FOR THAT PORT/JOB (-1 IS CMND PORT)
 11134				;	   NONSKIP-RETURNS IF THERE IS NONE
 11135				;	   SKIP-RETURNS WITH F/ DDB ADDR IF THERE IS
 11136
 11137				FNDPRT::JUMPL	F,[HRRZ F,TTYTAB(J)	;COMMAND PORT
 11138	016312'	321200	020135'			   JRST FNDPT1]
 11139	016313'	301200	014656*		CAIL	F,PORTN##
 11140	016314'	263040	000000		 POPJ	P,		;MUST NOT BE THERE
 11141	016315'	200204	014660*		MOVE	F,LINTAB(F)
 11142	016316'	550204	000000		HRRZ	F,LDBDDB(F)
 11143	016317'	322200	016301*	FNDPT1:	JUMPE	F,CPOPJ		;NO DDB ATTACHED
 11144	016320'	261040	000006		PUSH	P,T1
 11145	016321'	135300	016117*		LDB	T1,PJOBN
 11146	016322'	312300	000002		CAME	T1,J		;THIS JOB?
 11147	016323'	254000	016306*		 JRST	TPOPJ		;NO
 11148	016324'	254000	015076*		JRST	TPOPJ1		;YES
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 251
SCNSER.MAC	25-JAN-91 22:40		TINASS UUO - ASSIGN TTY INTERRUPTS

 11149				SUBTTL	TINASS UUO - ASSIGN TTY INTERRUPTS
 11150				;(MOST OF THE WORK IS DONE IN TINAS1)
 11151
 11152	016325'	135400	020137'	TINASS::LDB T3,[POINT 9,T1,17]	;GET THE CHANNEL NUMBER
 11153	016326'	307400	000043		CAIG T3,^D35
 11154	016327'	335002	000000*		SKIPGE JBTPIP(J)	;IF TOO LARGE OR NO INTADR
 11155	016330'	263040	000000		POPJ P,			;TAKE ERROR RETURR
 11156	016331'	550202	016110*		HRRZ F,TTYTAB(J)
 11157	016332'	550204	000013		HRRZ F,DDBLDB(F)
 11158	016333'	322200	016337'		JUMPE F,TINDET		;DETACHED, OK
 11159	016334'	205340	200000		MOVSI T2,LLLZAP
 11160	016335'	612344	000026		TDNE T2,LDBLOG(F)
 11161	016336'	263040	000000		 POPJ P,		;CAN NOT SET IF WAITING FOR LOGUT
 11162	016337'	570200	000006	TINDET:	HRRE F,T1
 11163	016340'	260040	016312'		PUSHJ P,FNDPRT
 11164	016341'	263040	000000		 POPJ P,		;BAD PORT NUMBER
 11165	016342'	135340	020140'		LDB T2,[POINT 9,T1,8]	;GET INTERRUPT NUMBER
 11166	016343'	301340	000014		CAIL T2,TRPLEN		;TOO LARGE?
 11167	016344'	263040	000000		POPJ P,		;YES
 11168	016345'	260040	016200'		PUSHJ P,TINAS1		;GO ASSIGN
 11169	016346'	254000	007423'		 JRST STOTC1		;GOT IT, GIVE BACK OLD
 11170	016347'	261040	000006		PUSH P,T1		;CONDITION SAT, SAVE OLD CHANNEL
 11171	016350'	200300	000010		MOVE T1,T3
 11172	016351'	260040	006657*		PUSHJ P,TAKTRP	;TAKE THE TRAP
 11173	016352'	262040	000006		POP P,T1
 11174	016353'	254000	007423'		JRST STOTC1		;AND RETURN THE ANSWER
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 252
SCNSER.MAC	25-JAN-91 22:40		INITIALIZE

 11175				SUBTTL	INITIALIZE
 11176				;INITIALIZE THE WORLD. THIS ROUTINE DOES NOT MAKE PROPER
 11177				;PROVISION FOR 140 RESTART SINCE THAT ABILITY IS NO LONGER
 11178				;OF ANY IMPORTANCE
 11179
 11180				;Beware, this routine (between TTYINI and TTIEND) is overwritten by
 11181				;hackers to patch running monitors on the assumption that the
 11182				;code is never reentered after system initialization.  Beware
 11183				;if this ever changes!  The CONFIG gettab points to TTYINI as
 11184				;the dynamic patch area.
 11185			016355'	PATCH2=:TTYINI+1	;Make it obvious
 11186
 11187	016354'	402000	017034'	TTYINI::SETZM	INTERM
 11188	016355'	402000	012436*		SETZM	BPREQ		;INITIALLY NO BLOCK PORTS
 11189	016356'	402000	017035'		SETZM	OPRTIM		;START WITH NO ALARM FLAGS SET
 11190	016357'	476000	000632*		SETOM	THSTIM##	;TIMER FLAGS
 11191	016360'	402000	000635*		SETZM	MXTIM##
 11192	016361'	201300	014102'		MOVEI	T1,CCTYI
 11193	016362'	202300	014125*		MOVEM	T1,.CPTIA##	;SET UP COMMAND READ AND WRITE
 11194	016363'	201300	014072'		MOVEI	T1,CCTYO
 11195	016364'	202300	014341*		MOVEM	T1,.CPTOA##
 11196	016365'	550240	016315*		HRRZ	U,LINTAB
 11197	016366'	552240	017214'		HRRZM	U,LDB.LO	;Address of first LDB on systems
 11198	016367'	200600	020141'		MOVE	P1,[POINT 1,LINFLG]	;READY TO SET BYTE PTRS
 11199	016370'	205640	777777*		MOVSI	P2,NMXLIN##-1	;NOW ALL LINES
 11200	016371'	550255	016365*	TTINI2:	HRRZ	U,LINTAB(P2)	;POINT TO LDB
 11201	016372'	205305	000000		MOVSI	T1,LDICLR(U)	;CLEAR IT OUT
 11202	016373'	541305	000001		HRRI	T1,LDICLR+1(U)
 11203	016374'	402005	000000		SETZM	LDICLR(U)
 11204	016375'	251305	000050		BLT	T1,LDICLE(U)
 11205	016376'	137640	000157'		DPB	P2,LDPLNO	;RESTORE LINE NUMBER
 11206	016377'	133000	000014		IBP	P1		;TO POINT TO NEXT BIT
 11207	016400'	202605	000002		MOVEM	P1,LDBOPB(U)
 11208	016401'	402014	000000		SETZM	(P1)		;MAKE SURE FLAG WORD IS 0
 11209	016402'	200415	016371*		MOVE	T3,LINTAB(P2)	;CHECK INITIALIZE BITS
 11210	016403'	336000	000000*		SKIPN	REFLAG		;BUT NOT IF REFRESING
 11211	016404'	607400	000000*		TLNN	T3,TTVINI
 11212	016405'	254000	016435'		 JRST	TTINI3		;NOT RUN INITIA
 11213	016406'	205300	000001		MOVSI	T1,(STAUTO)
 11214	016407'	616300	015163*		TDNN	T1,STATES
 11215	016410'	254000	016435'		 JRST	TTINI3		;DO NOT RUN IF NOT AUTO-RESTART
 11216	016411'	200300	020060'		MOVE	T1,[LLLNLN,,LDLCOM]
 11217	016412'	512305	000026		HLLZM	T1,LDBLOG(U)	;MARK IN (BUT UNKNOWN TO TYMNET)
 11218	016413'	516305	000031		HRLZM	T1,LDBDCH(U)	;SET LOGGED IN AND COMMAND MODE
 11219	016414'	200300	014543*		MOVE	T1,SYSNUM##	;Our host number
 11220	016415'	137300	000160'		DPB	T1,LDPHST	; for job running INITIA (DSKCLN)
 11221	016416'	201300	000001		MOVEI	T1,1
 11222	016417'	137300	000056'		DPB	T1,LOPHSH	;SET HUSH BIT TO SUPRESS OUT MESSAGES
 11223	016420'	402005	000032		SETZM	LDBDCX(U)	;NO EXTENDED BITS ON
 11224	016421'	260040	007603'		PUSHJ	P,SETLMD
 11225	016422'	260040	014547*		PUSHJ	P,FRMASN##	;Assign a Job/frame slot
 11226	016423'	256000	000000'		 STOPCD			;Strictly Fatal
 11227				;;***NOTE*** Can't call TTYATI here since it calls DDBSRC, which
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 252-2
SCNSER.MAC	25-JAN-91 22:40		INITIALIZE

 11228				;;***NOTE*** uses TTYFLK, which points at DEVLST-DEVSER.  This
 11229				;;***NOTE*** in turn means that DEVLST gets smashed when DDB is
 11230				;;***NOTE*** allocated, thus causing TTYINI to get called twice.
 11231				;;***NOTE*** Go please the world.
 11232	016424'	201300	000250'		MOVEI	T1,TTYLST	;Start DDB search from here
 11233	016425'	260040	015720'		PUSHJ	P,DDBSR1	;Get a TTY DDB
 11234	016426'	256000	000000'		 STOPCD 		;No errors allowed here
 11235					PUSHJ	P,[PUSH P,U
 11236	016427'	260040	020142'			   JRST TTYAT1]	;IT'S NOT SUCH A BAD HACK...
 11237	016430'	256000	000000'		 STOPCD 		;Last chance for fatal error...
 11238	016431'	201300	014553*		MOVEI T1,CMFCXI##	;Forced command index for INITIA
 11239				IFKMC<
 11240	016432'	335000	000000*		SKIPGE KMCDO##		;GREATER OR EQUAL 0 NOT KMC MANUAL MODE
 11241	016433'	201300	000000*		 MOVEI T1,CMFCKM##	;DO FORCE KMC LOAD
 11242				>;END IFKMC
 11243	016434'	260040	014046'		PUSHJ P,TTFORC
 11244
 11245	016435'	253640	016371'	TTINI3:	AOBJN	P2,TTINI2
 11246	016436'	552240	017215'		HRRZM	U,LDB.HI	;Address of highest LDB on system
 11247	016437'	402000	015171*		SETZM	DEVOPR		;NO OPER YET
 11248	016440'	402000	017027'		SETZM	OPRLDB		;AND HAS NOLDB
 11249	016441'	550300	000000*		HRRZ	T1,TTCLST##	;SET UP FREE LIST
 11250	016442'	202300	017212'		MOVEM	T1,RCC.LO	;Lowest chunk address
 11251	016443'	201106	000004		MOVEI	J,TTCHKS(T1)	;SET FREE POINTER TO FIRST
 11252	016444'	202100	006250*		MOVEM	J,TTFREE##
 11253	016445'	554400	016441*		HLRZ	T3,TTCLST##	;GET SIZE (number of chunks in list)
 11254	016446'	202400	017017'		MOVEM	T3,TTFREN
 11255	016447'	370000	017017'		SOS	TTFREN		;ONE LESS SINCE NO CHUNK 0
 11256	016450'	221400	000004		IMULI	T3,TTCHKS
 11257	016451'	271406	000000		ADDI	T3,(T1)
 11258	016452'	202400	017213'		MOVEM	T3,RCC.HI	;One greater than highest chunk address
 11259	016453'	402006	000000		SETZM	(T1)		;ZERO OUT FREE LIST
 11260	016454'	201106	000001		MOVEI	J,1(T1)		;Build BLT pointer
 11261	016455'	504100	000006		HRL	J,T1
 11262	016456'	251110	777777		BLT	J,-1(T3)	;ZERO ALL OF IT
 11263	016457'	201406	000010		MOVEI	T3,TT2CHK(T1)	;NOW LINK UP
 11264	016460'	200100	017017'		MOVE	J,TTFREN	;NUMBER TO LINK
 11265	016461'	202406	000004	TTINI4:	MOVEM	T3,TTCHKS(T1)
 11266	016462'	271300	000004		ADDI	T1,TTCHKS	;MOVE FORWARD
 11267	016463'	505406	000000		HRLI	T3,(T1)		;SET BACK LINK
 11268	016464'	541406	000010		HRRI	T3,TT2CHK(T1)	;AND FORWARD
 11269	016465'	367100	016461'		SOJG	J,TTINI4	;STORE IF NOT DONE
 11270	016466'	513006	000000		HLLZS	(T1)		;ZERO FORWARD LINK OF LAST ONE
 11271	016467'	263040	000000		POPJ	P,
 11272
 11273			016467'	TTIEND=:.-1  ;end of area used for dynamic patches, see comment at TTYINI:
 11274
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 253
SCNSER.MAC	25-JAN-91 22:40		INITIALIZE

 11275				IFCPU(F3),<
 11276				;ROUTINE TO RESYNC WITH NEXILIS BASE.
 11277				; CALLED FROM AT SYSTEM STARTUP AND WHEN BASE CRASHES.
 11278				
 11279				INTEGER	MWAIT,MZEROS
 11280				
 11281				OPDEF TNCONO [744000,,0]
 11282				OPDEF TNOUT [745000,,0]
 11283				OPDEF TNIN [746000,,0]
 11284				
 11285					NZEROS==300		;Number of zeroes to send to PDP-11
 11286					NWAIT==^D60*^D24	;Number of clock ticks max per zero
 11287				
 11288				
 11289				FNSYNC:	SKIPE	CTYDO##		;If using CTYSIM instead of TYMNET,
 11290					 JRST	CPOPJ1		; say all done
 11291					SKIPG	MZEROS		;Waiting for acceptance?
 11292					 JRST	FNSYN0		; No, try this again -- reset
 11293					TNIN	T1		;Yes, read something
 11294					TLNE	T1,(1B5)	;Skip if not accepted
 11295					 JRST	FNSYN2		; Got a zero, go decrement counter
 11296					SOSLE	MWAIT		;Are we waiting for acceptance?
 11297					 POPJ	P,		;Yes, so wait another tick
 11298				FNSYN0:	TNCONO	0		;Reset the interface.
 11299								;Turn off input and output to the 11-base
 11300					MOVEI	T1,NZEROS	;Set number of zeroes to TRY to send.
 11301					MOVEM	T1,MZEROS	;Store in counter field
 11302				FNSYN1:	TNOUT	0		;Send a zero
 11303					MOVEI	T1,NWAIT	;Get timeout period in clock tics
 11304					MOVEM	T1,MWAIT	; and store in timeout counter
 11305					POPJ	P,		;Return and wait for another tick
 11306				
 11307				FNSYN2:	SOSLE	MZEROS		;Are we waiting for more zeroes?
 11308					 JRST	FNSYN1		;Yes, send one and read it next tick
 11309					TNCONO	1B34!1B35	;No, all here -- turn on PDP-11 interrupts
 11310					SETZM	BASVER##	;Clear base version number
 11311					JRST	CPOPJ1		; and skip return this time.
 11312				>;END IFCPU(F3)
 11313
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 254
SCNSER.MAC	25-JAN-91 22:40		ROUTINES TO LOG IRING AND ORING ACTIVITY

 11314				SUBTTL	ROUTINES TO LOG IRING AND ORING ACTIVITY
 11315
 11316				;IRPLOG - routine to keep a log of iring messages
 11317				;
 11318				;  Assumes P1 and U may be clobbered since they will be
 11319				;  reused immediately upon return.  If this changes, the
 11320				;  appropriate registers should be saved.
 11321
 11322	016470'	200257	012742*	IRPLOG:	MOVE	U,IRING(P4)		; Get IRING message
 11323	016471'	350600	000000*		AOS	P1,SCNPTR##		; Increment to next position
 11324	016472'	405600	000000*		ANDI	P1,SCNMSK##		; Keep offset
 11325	016473'	326600	016477'		JUMPN	P1,IRPLO1		; Not first - just log it
 11326	016474'	200600	011262*		MOVE	P1,DATE##		; Get current daytime
 11327	016475'	202600	000000*		MOVEM	P1,SCNUDT##		; And remember...
 11328	016476'	400600	000000		SETZ	P1,			; Clear counter
 11329	016477'	202254	000000*	IRPLO1:	MOVEM	U,SCNBUF##(P1)		; Store
 11330	016500'	263040	000000		POPJ	P,			; Return
 11331
 11332				;ORPLOG - routine to keep a log of oring messages
 11333				;
 11334				;  Assumes P3 already setup containing data to store
 11335				;  (If not, ORING(P4) does contain the correct data)
 11336
 11337	016501'	261040	000014	ORPLOG:	PUSH	P,P1			; Save P1
 11338	016502'	350600	016471*		AOS	P1,SCNPTR##		; Increment to next position
 11339	016503'	405600	016472*		ANDI	P1,SCNMSK##		; Keep offset
 11340	016504'	326600	016510'		JUMPN	P1,ORPLO1		; Not first - just log it
 11341	016505'	200600	016474*		MOVE	P1,DATE##		; Get current daytime
 11342	016506'	202600	016475*		MOVEM	P1,SCNUDT##		; And remember...
 11343	016507'	400600	000000		SETZ	P1,			; Clear counter
 11344	016510'	202714	016477*	ORPLO1:	MOVEM	P3,SCNBUF##(P1)		; Log it
 11345	016511'	262040	000014		POP	P,P1			; Restore P1
 11346	016512'	263040	000000		POPJ	P,
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 255
SCNSER.MAC	25-JAN-91 22:40		DATA

 11347				SUBTTL	DATA
 11348
 11349						;123456789012; Each entry must be exactly 12 characters long
 11350	016513'	552323	000000	AUXNTB:	SIXBIT	/M33         /
	016514'	000000	000000
 11351	016515'	556054	000000		SIXBIT	/MPL         /
	016516'	000000	000000
 11352	016517'	636054	000000		SIXBIT	/SPL         /
	016520'	000000	000000
 11353	016521'	576365	000000		SIXBIT	/OSU         /
	016522'	000000	000000
 11354	016523'	676263	000000		SIXBIT	/WRS         /
	016524'	000000	000000
 11355	016525'	434162	540000		SIXBIT	/CARL        /
	016526'	000000	000000
 11356	016527'	525563	000000		SIXBIT	/JMS         /
	016530'	000000	000000
 11357	016531'	576355	415600		SIXBIT	/OSMAN       /
	016532'	000000	000000
 11358	016533'	536265	556660		SIXBIT	/KRUMVP      /
	016534'	000000	000000
 11359	016535'	626651	665145		SIXBIT	/RVIVIER     /
	016536'	620000	000000
 11360	016537'	555757	625156		SIXBIT	/MOORING     /
	016540'	470000	000000
 11361	016541'	545156	532120		SIXBIT	/LINK10      /
	016542'	000000	000000
 11362	016543'	647063	636560		SIXBIT	/TXSSUP      /
	016544'	000000	000000
 11363	016545'				BLOCK	40
 11364			000072	AUXNTL==.-AUXNTB
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 256
SCNSER.MAC	25-JAN-91 22:40		VARIABLES

 11365				SUBTTL	 VARIABLES
 11366
 11367				IFKMC<
 11368	016605'	000000	000000	BBCNTS:	EXP	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0	;16 WORDS
	016606'	000000	000000
	016607'	000000	000000
	016610'	000000	000000
	016611'	000000	000000
	016612'	000000	000000
	016613'	000000	000000
	016614'	000000	000000
	016615'	000000	000000
	016616'	000000	000000
	016617'	000000	000000
	016620'	000000	000000
	016621'	000000	000000
	016622'	000000	000000
	016623'	000000	000000
	016624'	000000	000000
 11369	016625'	000000	000000	BBPAGE:	EXP	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
	016626'	000000	000000
	016627'	000000	000000
	016630'	000000	000000
	016631'	000000	000000
	016632'	000000	000000
	016633'	000000	000000
	016634'	000000	000000
	016635'	000000	000000
	016636'	000000	000000
	016637'	000000	000000
	016640'	000000	000000
	016641'	000000	000000
	016642'	000000	000000
	016643'	000000	000000
	016644'	000000	000000
 11370	016645'	000000	000000	       	EXP	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0	;32 WORDS
	016646'	000000	000000
	016647'	000000	000000
	016650'	000000	000000
	016651'	000000	000000
	016652'	000000	000000
	016653'	000000	000000
	016654'	000000	000000
	016655'	000000	000000
	016656'	000000	000000
	016657'	000000	000000
	016660'	000000	000000
	016661'	000000	000000
	016662'	000000	000000
	016663'	000000	000000
	016664'	000000	000000
 11371	016665'	000000	000074	TIMMIN:	EXP ^D60
 11372	016666'	000000	000074	TIMDRD:	EXP ^D60
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 256-2
SCNSER.MAC	25-JAN-91 22:40		VARIABLES

 11373	016667'	000000	000000	DRMHSI:	0
 11374	016670'	000000	000000	DRMSHT:	0
 11375	016671'	000000	000000	DRMBRK:	0
 11376	016672'	000000	000000	DRMANS:	0
 11377	016673'	000000	000000	DRMCLP:	0
 11378	016674'	000000	000000	DRMTIM::0 ;SECONDS OF UP TIME
 11379	016675'	000000	000000	DRDOW:	0
 11380	016676'	000000	000000	SENT41:	EXP 0,0,0,0	;SET ON SENDING 41, RESET ON RECIEVING 3 OR 1
	016677'	000000	000000
	016700'	000000	000000
	016701'	000000	000000
 11381	016702'	000000	000000	KMCLAS:	0	;LAST KMCGAV,KMCGAC
 11382	016703'	000000	000000	KMCPDP::	0
 11383	016704'			KMCFLG::	REPEAT ^D64,<EXP 0>;KMC ACTIVE FLAG HISTORY
 11384	016704'	000000	000000
 11385	016705'	000000	000000
 11386	016706'	000000	000000
 11387	016707'	000000	000000
 11388	016710'	000000	000000
 11389	016711'	000000	000000
 11390	016712'	000000	000000
 11391	016713'	000000	000000
 11392	016714'	000000	000000
 11393	016715'	000000	000000
 11394	016716'	000000	000000
 11395	016717'	000000	000000
 11396	016720'	000000	000000
 11397	016721'	000000	000000
 11398	016722'	000000	000000
 11399	016723'	000000	000000
 11400	016724'	000000	000000
 11401	016725'	000000	000000
 11402	016726'	000000	000000
 11403	016727'	000000	000000
 11404	016730'	000000	000000
 11405	016731'	000000	000000
 11406	016732'	000000	000000
 11407	016733'	000000	000000
 11408	016734'	000000	000000
 11409	016735'	000000	000000
 11410	016736'	000000	000000
 11411	016737'	000000	000000
 11412	016740'	000000	000000
 11413	016741'	000000	000000
 11414	016742'	000000	000000
 11415	016743'	000000	000000
 11416	016744'	000000	000000
 11417	016745'	000000	000000
 11418	016746'	000000	000000
 11419	016747'	000000	000000
 11420	016750'	000000	000000
 11421	016751'	000000	000000
 11422	016752'	000000	000000
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 256-3
SCNSER.MAC	25-JAN-91 22:40		VARIABLES

 11423	016753'	000000	000000
 11424	016754'	000000	000000
 11425	016755'	000000	000000
 11426	016756'	000000	000000
 11427	016757'	000000	000000
 11428	016760'	000000	000000
 11429	016761'	000000	000000
 11430	016762'	000000	000000
 11431	016763'	000000	000000
 11432	016764'	000000	000000
 11433	016765'	000000	000000
 11434	016766'	000000	000000
 11435	016767'	000000	000000
 11436	016770'	000000	000000
 11437	016771'	000000	000000
 11438	016772'	000000	000000
 11439	016773'	000000	000000
 11440	016774'	000000	000000
 11441	016775'	000000	000000
 11442	016776'	000000	000000
 11443	016777'	000000	000000
 11444	017000'	000000	000000
 11445	017001'	000000	000000
 11446	017002'	000000	000000
 11447	017003'	000000	000000
 11448	017004'	000000	000000	IRPMSG::	0
 11449	017005'	000000	000000	IRPMS2::	0
 11450	017006'	000000	000000	IRPMS3::	0
 11451	017007'	000000	000000	IRPMP1::	0
 11452	017010'	000000	000000	IRPMP2::	0
 11453	017011'	000000	000000	IRPMP3::	0
 11454	017012'	000000	000000	IRPMB1::	0
 11455	017013'	000000	000000	IRPMB2::	0
 11456	017014'	000000	000000	IRPMB3::	0
 11457					>;END IFKMC
 11458	017015'	000000	000000	BADGUY:	0	;COUNTER INCREMENTED IN GOHSH:
 11459	017016'	000000	000000	FSCN:	0
 11460	017017'	000000	000000	TTFREN:	0	;NUMBER OF FREE CHUNKS LEFT
 11461	017020'	000000	000000	INPCH:	0
 11462	017021'	000000	000000	LINPTR:	0	;OUTPUT SCAN POINTER
 11463	017022'	000000	000000	CHCNT:	0	;# REMAINING CHARS TO OUTPUT AT A TIME ON A PORT
 11464	017023'	000000	000000	CHQTA:	0	;VALUE THAT CHCNT WAS SET TO AT START OF CYCLE
 11465	017024'	000000	000000	SVSPC:	0
 11466	017025'	000000	000000	TTCMCH::0	;HERE IS CHARACTER FOR COMMAND DECODER
 11467	017026'	000000	000000	TTCMCA::0	;INPUT POINTER FOR COMMAND BEING DECODED
 11468	017027'	000000	000000	OPRLDB::0	;LDB FOR OPER CONSOLE FOR MSGS ETC
 11469	017030'	000000	000000	UPSHUT:	0	;PLACE FOR UP-SHUT COMMAND TO BE STORED
 11470
 11471	017031'	000000	000000	LINPNM:	0	;SAVE LINE NUMBER FROM JFFO
 11472	017032'	000000	000000	LINFSV:	0	;SAVE FLAG WORD
 11473	017033'	000000	000000	SVOJFF: 0	;SAVE OUTPUT BIT NO FROM LDBOUT
 11474	017034'	000000	000000	INTERM::0	;Count of active terminals
 11475	017035'	000000	000000	OPRTIM::0
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 256-4
SCNSER.MAC	25-JAN-91 22:40		VARIABLES

 11476	017036'	000000	000000	FRETTY::0	;POINTER TO FREE TTY DDBS
 11477	017037'	000000	000000	TTYFLK::0	;POINTER TO WHERE TO LINK IN TTY BLOCKS
 11478	017040'	000000	000000	CHRRDP:	0	;BYTE POINTER TO INPUT RING FOR CHARACTER INPUT
 11479	017041'	000000	000000	CHRWRP:	0	;REAL TTY: BYTE POINTER TO OUTPUT RING
 11480	017042'	000000	000000		0	;PTY: BYTE POINTER TO PTY BUFFER
 11481	017043'	000000	000000	MULCNT:	0	;REAL TTYS: # CHARS MORE WILL FIT IN OUTPUT RECORD
 11482	017044'	000000	000000		0	;PTYS: # CHARS MORE PTY OUTPUT THIS SECOND
 11483	017045'	000000	000000	MXMCNT:	0	;REAL TTYS: ORIGINAL VALUE OF MULCNT
 11484	017046'	000000	000000	TIMOW:	0	;TIMER FOR ORANGE-BALL WAIT ON CIRCUIT ZAPS
 11485	017047'	000000	000000	ALRSNT:	0
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 257
SCNSER.MAC	25-JAN-91 22:40		VARIABLES

 11486	017050'	777777	777777	AUXRCP:: -1	;RECEIVED AUX PORT
 11487	017051'	000000	000000	AUXSTA:	0	;AUX CIRCUIT STATE
 11488	017052'			AUXSTR::BLOCK AUXSTL	;SPACE FOR STRING
 11489	017062'	000000	000000	AUXEND:: 0	;Pointer to last word used in AUXSTR
 11490	017063'	000000	000000	AUXSTP:	0	;STRING POINTER
 11491	017064'	000000	000000	AUXERR:: 0	;ERROR FROM AUX CIRCUIT BUILD
 11492	017065'	000000	000000	AUXJOB:	0	;JOB BUILDING AUX CIRCUIT
 11493	017066'	000000	000000	AUXWSC: 0	;# OF AUX-BUILTS RECEIVED IN WRONG STATE
 11494	017067'	000000	000000	AUXWPC: 0	;# OF AUX-BUILTS RECEIVED GIVING WRONG PORT
 11495	017070'	777777	777777	AUXWPT:	-1	;PORT LDB ADDRESS OF THE LAST ONE
 11496	017071'	000000	000000	NRPCNT: 0	;# TIMES WE GAVE "NO PORT RECEIVED" ERROR
 11497	017072'	000000	000000	ZRPCNT: 0	;# TIMES WE ZAPPED THE RECEIVED PORT
 11498	017073'	000000	000000	BIOJOB:	0	;JOB INITIATING BLOCK I/O FOR PORT.
 11499	017074'	000000	000000	AUXPRT:	0	;PORT BEING BUILT FROM
 11500	017075'	000000	000000	AUXTIM:	0	;AUX CIRCUIT TIMER
 11501	017076'			AUXUNM:	BLOCK 2	;SPACE TO BUILD UP A USER NAME
 11502	017100'	000000	000000	BUFLST:	0	;HEADER FOR LIST OF BLOCK INPUT/OUTPUT BUFFERS
 11503	017101'	000000	000000	BIOCNT:	0	;REAL TTYS: # OF JOBS ENABLED TO DO BLOCK I/O
 11504						;	    LH := -1 AS A FLAG TO BLKNEG CODE
 11505	017102'	000000	000000		0	;PTYS: # OF JOBS ENABLED TO DO PSEUDO-BLOCK I/O
 11506	017103'	000000	000000	BIOPRT: 0	;# OF BLOCK I/O PORTS, I.E., THE LAST RESPONSE
 11507						;FROM THE BASE TO A NEGOTIATE MESSAGE
 11508	017104'	000000	000000	BIOBUF: 0	;# OF MONITOR BLOCK I/O BUFFERS
 11509	017105'	000000	000000	BBFREE:	0	;# OF FREE MONITOR BLOCK I/O BUFFERS
 11510	017106'	000000	000000	BBCRE:	0	;# OF BIO BUFFERS CREATED SINCE MONITOR LOADED (KS ONLY)
 11511	017107'	000000	000000	BBREL:	0	;# OF BIO BUFFERS RELEASED (KS ONLY)
 11512	017110'	000000	000000	BBPOOL:	0	;COUNT OF BIO BUFFER RE-USE SINCE MONITOR LOADED
 11513	017111'	000000	000000	BIOANS: 0	;# OF BLOCK I/O NEGOTIATE MESSAGES SENT BUT NOT
 11514						;YET REPLIED-TO
 11515	017112'	000000	000000	ERRBNG: 0	;# OF UNSOLICITED BLOCK I/O NEGOTIATE MESSAGES
 11516	017113'	000000	000000	DWNFLG::0	;WANT TO TAKE SYSTEM DOWN
 11517	017114'	000000	000000	CTYFIL::0	;NUMBER OF FILLS NEEDED BY CTY
 11518	017115'	000000	000000	CTYFLN:	0	;COUNTER WHEN SENDING FILLS TO CTY
 11519	017116'	000000	000000	OPRWJB:	0	;JOB WAITING FOR SETUUO OPR MSG
 11520	017117'	000000	000120	TIWRNN: TILOW	;SMALL QUOTA FOR UNREAD INPUT CHARACTERS (^D80)
 11521						;(BACKPRESSURE WHEN IT'S EXCEEDED)
 11522	017120'			TIHLTN:		;LARGE QUOTA FOR UNREAD INPUT CHARACTERS
 11523						; MUST BE AT LEAST AS LARGE AS THE MAX NUMBER OF CHARS THE
 11524						; INPUT RING CAN HOLD * 2 + TIWRNN,
 11525						;  OTHERWISE CHARS COULD BE LOST
 11526				  IFDEF  SIZIRG, <<1_SIZIRG>*4*2+TILOW> ;^D1104 for normal sized rings
 11527	017120'	000000	002120	  IFNDEF SIZIRG, <^D512*2+TILOW>
 11528				  ;IFNKMC	<^D500>	;LARGE QUOTA FOR UNREAD INPUT CHARACTERS
 11529				  ;IFKMC	<^D2000>;(LOSE CHARACTERS WHEN IT'S EXCEEDED)
 11530	017121'	000000	000000	TTYRHT: 0	;# TIMES MONITOR OUT OF BUFFERLETS AT RCVCHR
 11531						;+ LOSPDP + LOS620
 11532	017122'	000000	000000	LOSPDP: 0	;# TIMES A PORT EXCEEDED ITS LARGE QUOTA
 11533						;BEFORE WE COULD GET BACKPRESSURE SENT
 11534	017123'	000000	000000	LOS620: 0	;# TIMES A PORT EXCEEDED ITS LARGE QUOTA
 11535						;AFTER WE HAD SENT BACKPRESSURE
 11536	017124'	000000	000170	OMX30:	^D120	;TTY OUTPUT HIGH-WATER MARK FOR SLOW DEVICES
 11537	017125'	000000	000074	OWK30:	^D60	;TTY OUTPUT LOW-WATER MARK FOR SLOW DEVICES
 11538	017126'	000000	000740	OMX120:	^D480	;TTY OUTPUT HIGH-WATER MARK FOR FAST DEVICES
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 257-2
SCNSER.MAC	25-JAN-91 22:40		VARIABLES

 11539	017127'	000000	000360	OWK120:	^D240	;TTY OUTPUT LOW-WATER MARK FOR FAST DEVICES
 11540	017130'	000000	000764	TOEMAX:	^D500	;EXPANDED-MODE TTY OUTPUT LIMIT
 11541	017131'	646471	545763		GTLNK (TTYLOS)
 11542	017132'	000001	000000
 11543	017133'	017134'	017131'
 11544					;.LINK for .GTLNK
 11545	017134'	000000	000000	TTYLOS: 0	;COUNT OF CHARACTERS LOST BY TYMNET
 11546						;(BLACK BALLS - BUFFER ZAPS)
 11547	017135'	000000	000000	PTYLOS:	0	;COUNT OF CHARACTERS LOST BY PTYS
 11548	017136'	000000	000000	LOGZAP:	0	;# OF LOGINS TO LOGGED-IN PORTS
 11549	017137'	777777	777777	ZAPLPT:	-1	;PORT LDB ADDRESS OF LAST LOGZAP OR DFRZAP
 11550	017140'	000000	000000	DFRZAP:	0	;# OF LDECS RECEIVED WHILE STILL ECHOING
 11551	017141'	000000	000000	NZAPIN: 0	;# ZAPPERS IN FROM TYMNET
 11552	017142'	000000	000000	NZAPN2: 0	;# TIMES WE GOT A ZAPPER ON A PORT W/ AN UNECHOED ZAP
 11553	017143'	000000	000000	NZAPLG: 0	;# TIMES WE GOT A LOGIN ON A PORT W/ AN UNECHOED ZAP
 11554	017144'	000000	000000	NZAPAX: 0	;# TIMES WE GOT AN AUX PORT FOR A PORT W/ AN UNECHOED ZAP
 11555	017145'	000000	000000	NZAPRS: 0	;# of times zapper had to be resent (based on LNLZIN)
 11556	017146'	000000	000000	NZAPOT: 0	;# ZAPPERS OUT IN RESPONSE TO ZAPPERS IN
 11557	017147'	000000	000000	TMCOOR: 0	;# OF UNKNOWN TERMINAL CHARACTERISTICS SET BY TYMNET
 11558	017150'	000000	001750	PTYFLO:	^D1000	;CHARS/SEC TOTAL MAXIMUM PTY FLOW
 11559	017151'			PTYBUF:	BLOCK	<PTBSIZ+4>/5
 11560	017201'	000000	000000	PBDISC:	0
 11561	017202'	000000	000000	DIDPBI:	0
 11562	017203'	000000	000000	FRSFLG:	0	;FLAG FOR CMDWAK (SO IT'LL KNOW IT'S NOT A REAL CMND)
 11563	017204'	000000	000000	FRSDEF:	0	;FLAG TO REMEMBER DEFERRED-ECHO STATE
 11564	017205'	000000	000000	SKPFLG:	0	;SET TO INDICATE INPUT AND SKIP AUXCAL IN PROGRESS
 11565	017206'	000000	000000	IRPSTP:	0	;Stopping place for SCNIN
 11566	017207'	000000	000000	BADKEY:	0	;Copy of KEY620 when base wants to crash us
 11567	017210'	000000	000000	IRPOLD:	0	;Old copy of IRP620 when base is declared down
 11568	017211'	000000	000000	ORPOLD:	0	;            ORP620
 11569	017212'	000000	000000	RCC.LO:: 0	;Lowest legal chunk address
 11570	017213'	000000	000000	RCC.HI:: 0	;One greater than highest legal chunk address
 11571	017214'	000000	000000	LDB.LO:	0	;Lowest legal LDB address
 11572	017215'	000000	000000	LDB.HI:	0	;Address of beginning of highest LDB
 11573	017216'	000000	000000	MSGLGP:	0	;Byte pointer into MSGBUF (must be 0 until MSGINI is called)
 11574
 11575	017217'	242000	006701*		$END	(SCN)

 11576	017220'	042000	017217*

 11577	017221'	260040	000000*

 11578	017222'	424163	452024

 11579	017223'	400001	000000

 11580	017224'	000000	000566'

 11581	017225'	260040	000000*

 11582	017226'	424163	450000

 11583	017227'	400005	000000
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 257-3
SCNSER.MAC	25-JAN-91 22:40		VARIABLES


 11584	017230'	000000	000566'

 11585	017231'	242000	000605*

 11586	017232'	042000	017231*

 11587	017233'	265300	014532*

 11588	017234'	476261	505000

 11589	017235'	002000	000400

 11590	017236'	021000	000400

 11591	017237'	260040	017225*

 11592	017240'	646471	425564

 11593	017241'	400005	001014'

 11594	017242'	000000	001033'

 11595	017243'	260040	017237*

 11596	017244'	646471	426056

 11597	017245'	400005	001002'

 11598	017246'	000000	001033'

 11599	017247'	201300	017143'

 11600	017250'	260040	004477'

 11601	017251'	254000	001217'

 11602	017252'	260040	001305'

 11603	017253'	254000	001011'

 11604	017254'	042000	012746*

 11605	017255'	260040	017221*

 11606	017256'	646471	725645

 11607	017257'	400003	000000

 11608	017260'	000000	001033'

 11609	017261'	260040	017243*

SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 257-4
SCNSER.MAC	25-JAN-91 22:40		VARIABLES

 11610	017262'	646471	425660

 11611	017263'	000005	001522'

 11612	017264'	202000	000006

 11613	017265'	201300	017142'

 11614	017266'	260040	004477'

 11615	017267'	254000	001521'

 11616	017270'	403305	000026

 11617	017271'	137300	000160'

 11618	017272'	201300	000001

 11619	017273'	137300	000101'

 11620	017274'	137305	000002

 11621	017275'	205300	400000

 11622	017276'	412305	000031

 11623	017277'	263040	000000

 11624	017300'	340000	000000

 11625	017301'	064254	671302

 11626	017302'	667124	061702

 11627	017303'	703034	364750

 11628	017304'	745014	574306

 11629	017305'	627134	462710

 11630	017306'	064240	000000

 11631	017307'	064256	067744

 11632	017310'	721014	360740

 11633	017311'	607075	172362

 11634	017312'	203137	061712

 11635	017313'	627114	562032

 11636	017314'	050000	000000
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 257-5
SCNSER.MAC	25-JAN-91 22:40		VARIABLES


 11637	017315'	201300	000001

 11638	017316'	137300	000074'

 11639	017317'	137305	000002

 11640	017320'	263040	000000

 11641	017321'	205440	777777

 11642	017322'	254000	003025'

 11643	017323'	205300	040000

 11644	017324'	616305	000027

 11645	017325'	263040	000000

 11646	017326'	254000	003047'

 11647	017327'	260040	017261*

 11648	017330'	646471	606471

 11649	017331'	400005	000000

 11650	017332'	000000	003233'

 11651	017333'	441000	017151'

 11652	017334'	000000	000000

 11653	017335'	000003	000003

 11654	017336'	260040	017255*

 11655	017337'	646471	566042

 11656	017340'	000002	000000

 11657	017341'	441000	000006

 11658	017342'	260040	017327*

 11659	017343'	606471	634254

 11660	017344'	000005	000000

 11661	017345'	201740	000001*

 11662	017346'	336000	015217*

SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 257-6
SCNSER.MAC	25-JAN-91 22:40		VARIABLES

 11663	017347'	201740	015231*

 11664	017350'	274740	015214*

 11665	017351'	326740	004146'

 11666	017352'	263040	000000

 11667	017353'	344740	004135'

 11668	017354'	350000	017015'

 11669	017355'	254000	003323'

 11670	017356'	000100	040000

 11671	017357'	260040	017342*

 11672	017360'	724160	426547

 11673	017361'	000005	000000

 11674	017362'	260040	017357*

 11675	017363'	425157	724144

 11676	017364'	000005	000000

 11677	017365'	002000	000016

 11678	017366'	111300	000006

 11679	017367'	101000	000016

 11680	017370'	221200	000016

 11681	017371'	272405	000024

 11682	017372'	254000	003327'

 11683	017373'	272405	000020

 11684	017374'	254000	004664'

 11685	017375'	321240	003276'

 11686	017376'	254000	003323'

 11687	017377'	201300	000005

 11688	017400'	254000	004746'

 11689	017401'	137440	000175'
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 257-7
SCNSER.MAC	25-JAN-91 22:40		VARIABLES


 11690	017402'	254000	005274'

 11691	017403'	402005	000022

 11692	017404'	254000	003305'

 11693	017405'	254000	005405'

 11694	017406'	135440	000175'

 11695	017407'	254000	005400'

 11696	017410'	254000	005603'

 11697	017411'	201440	000001

 11698	017412'	254000	005377'

 11699	017413'	260040	017362*

 11700	017414'	565742	416345

 11701	017415'	400006	000000

 11702	017416'	000000	005627'

 11703	017417'	201300	000074

 11704	017420'	202300	016665'

 11705	017421'	260040	012553'

 11706	017422'	254000	005656'

 11707	017423'	201300	000074

 11708	017424'	202300	016666'

 11709	017425'	260040	012556'

 11710	017426'	254000	005660'

 11711	017427'	260040	005767'

 11712	017430'	201300	010000

 11713	017431'	254000	005703'

 11714	017432'	436305	000027

 11715	017433'	254000	005752'

SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 257-8
SCNSER.MAC	25-JAN-91 22:40		VARIABLES

 11716	017434'	201300	000001

 11717	017435'	135345	000002

 11718	017436'	137300	000101'

 11719	017437'	137305	000002

 11720	017440'	205300	000400

 11721	017441'	412305	000027

 11722	017442'	336000	000007

 11723	017443'	350000	017145'

 11724	017444'	254000	005754'

 11725	017445'	000001	010000

 11726	017446'	010000	020000

 11727	017447'	000001	100000

 11728	017450'	260040	017413*

 11729	017451'	624343	444247

 11730	017452'	400005	006111'

 11731	017453'	000000	006114'

 11732	017454'	260040	017450*

 11733	017455'	646471	465455

 11734	017456'	400005	006111'

 11735	017457'	000000	006114'

 11736	017460'	260040	017336*

 11737	017461'	624343	424144

 11738	017462'	400003	006111'

 11739	017463'	000000	006114'

 11740	017464'	260040	017454*

 11741	017465'	646471	565643

 11742	017466'	000005	006257'
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 257-9
SCNSER.MAC	25-JAN-91 22:40		VARIABLES


 11743	017467'	260040	017460*

 11744	017470'	624343	636460

 11745	017471'	400001	000000

 11746	017472'	000000	006114'

 11747	017473'	205000	000040

 11748	017474'	254000	006403'

 11749	017475'	222114	000000

 11750	017476'	135640	017475'

 11751	017477'	136400	000014

 11752	017500'	542615	000001

 11753	017501'	300606	000001

 11754	017502'	135340	017501'

 11755	017503'	300600	000014

 11756	017504'	550654	000001

 11757	017505'	134400	000014

 11758	017506'	550653	000000

 11759	017507'	136400	000015

 11760	017510'	300000	001717

 11761	017511'	201300	000001

 11762	017512'	263040	000000

 11763	017513'	201300	000002

 11764	017514'	263040	000000

 11765	017515'	201300	000000

 11766	017516'	262040	000007

 11767	017517'	262040	000005

 11768	017520'	263040	000000

SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 257-10
SCNSER.MAC	25-JAN-91 22:40		VARIABLES

 11769	017521'	134401	000000

 11770	017522'	134400	000013

 11771	017523'	200513	000000

 11772	017524'	134400	000012

 11773	017525'	300600	000012

 11774	017526'	202513	000000

 11775	017527'	550613	000000

 11776	017530'	200513	000001

 11777	017531'	542613	000000

 11778	017532'	202513	000001

 11779	017533'	200313	000000

 11780	017534'	202313	000000

 11781	017535'	402013	000000

 11782	017536'	554613	000000

 11783	017537'	777771	007322'

 11784	017540'	202413	000000

 11785	017541'	040000	000000

 11786	017542'	201300	000001

 11787	017543'	254000	007727'

 11788	017544'	201300	000002

 11789	017545'	254000	007727'

 11790	017546'	550200	000015

 11791	017547'	260040	015254'

 11792	017550'	554240	000015

 11793	017551'	513005	000000

 11794	017552'	402005	000026

 11795	017553'	201300	000002
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 257-11
SCNSER.MAC	25-JAN-91 22:40		VARIABLES


 11796	017554'	254000	007727'

 11797	017555'	000000	000000*

 11798	017556'	001000	000006

 11799	017557'	574212	000000

 11800	017560'	550312	000000

 11801	017561'	554313	000000

 11802	017562'	570353	000000

 11803	017563'	542413	000000

 11804	017564'	476013	000000

 11805	017565'	506313	000000

 11806	017566'	000006	000000

 11807	017567'	777777	777777

 11808	017570'	250353	000000

 11809	017571'	250313	000000

 11810	017572'	200353	000000

 11811	017573'	134400	000006

 11812	017574'	201600	000001

 11813	017575'	254000	011137'

 11814	017576'	201600	000003

 11815	017577'	254000	011137'

 11816	017600'	200613	000000

 11817	017601'	201600	000002

 11818	017602'	254000	011137'

 11819	017603'	260040	016307'

 11820	017604'	324740	016057*

 11821	017605'	200153	000001

SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 257-12
SCNSER.MAC	25-JAN-91 22:40		VARIABLES

 11822	017606'	134400	000003

 11823	017607'	202153	000001

 11824	017610'	202612	000000

 11825	017611'	350000	017051'

 11826	017612'	344740	001011'

 11827	017613'	440700	017052'

 11828	017614'	260040	011332'

 11829	017615'	344740	001011'

 11830	017616'	201300	017144'

 11831	017617'	260040	004477'

 11832	017620'	254000	011345'

 11833	017621'	260040	001305'

 11834	017622'	200300	017051'

 11835	017623'	302300	000006

 11836	017624'	364740	011352'

 11837	017625'	350000	017051'

 11838	017626'	254000	001011'

 11839	017627'	440600	017076'

 11840	017630'	017052'	017053'

 11841	017631'	134340	000006

 11842	017632'	205340	000002

 11843	017633'	254000	011677'

 11844	017634'	410200	000014

 11845	017635'	350000	017071'

 11846	017636'	205340	000006

 11847	017637'	254000	011677'

 11848	017640'	205340	000003
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 257-13
SCNSER.MAC	25-JAN-91 22:40		VARIABLES


 11849	017641'	254000	011677'

 11850	017642'	476012	000000

 11851	017643'	256200	017642'

 11852	017644'	263040	000000

 11853	017645'	476006	777777

 11854	017646'	210346	000000

 11855	017647'	506407	000000

 11856	017650'	542407	000000

 11857	017651'	603000	000040

 11858	017652'	254000	012134'

 11859	017653'	200345	000030

 11860	017654'	603340	400000

 11861	017655'	254000	012120'

 11862	017656'	260040	012222'

 11863	017657'	263040	000000

 11864	017660'	254000	012120'

 11865	017661'	603000	000040

 11866	017662'	254000	012134'

 11867	017663'	200345	000030

 11868	017664'	603340	400000

 11869	017665'	263040	000000

 11870	017666'	260040	012222'

 11871	017667'	263040	000000

 11872	017670'	263040	000000

 11873	017671'	000040	020000

 11874	017672'	202311	000000

SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 257-14
SCNSER.MAC	25-JAN-91 22:40		VARIABLES

 11875	017673'	136300	000011

 11876	017674'	260040	012366'

 11877	017675'	254000	012216'

 11878	017676'	550353	000000

 11879	017677'	205413	000000

 11880	017700'	200310	000000

 11881	017701'	134300	000010

 11882	017702'	260040	017464*

 11883	017703'	646471	424356

 11884	017704'	000005	016317*

 11885	017705'	350000	012473*

 11886	017706'	260040	000000*

 11887	017707'	370000	017705*

 11888	017710'	254000	012443'

 11889	017711'	303340	000000*

 11890	017712'	256000	000000'

 11891	017713'	505340	000003

 11892	017714'	242300	777767

 11893	017715'	660300	040000

 11894	017716'	713307	000000*

 11895	017717'	202307	016625'

 11896	017720'	271300	000001

 11897	017721'	713307	000000*

 11898	017722'	202307	016626'

 11899	017723'	550340	000007

 11900	017724'	350000	017106'

 11901	017725'	254000	012454'
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 257-15
SCNSER.MAC	25-JAN-91 22:40		VARIABLES


 11902	017726'	260040	017467*

 11903	017727'	646471	564642

 11904	017730'	000001	000000

 11905	017731'	242340	000001

 11906	017732'	400300	000000

 11907	017733'	505340	000003

 11908	017734'	713307	000000*

 11909	017735'	713307	000000*

 11910	017736'	563007	016625'

 11911	017737'	563007	016626'

 11912	017740'	350000	017107'

 11913	017741'	254000	012522'

 11914	017742'	000003	777000

 11915	017743'	001003	777000

 11916	017744'	262040	000011

 11917	017745'	262040	000010

 11918	017746'	262040	000006

 11919	017747'	550340	000007

 11920	017750'	254000	016245*

 11921	017751'	000003	000000*

 11922	017752'	202300	016667'

 11923	017753'	263040	000000

 11924	017754'	202300	016670'

 11925	017755'	263040	000000

 11926	017756'	202300	016671'

 11927	017757'	263040	000000

SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 257-16
SCNSER.MAC	25-JAN-91 22:40		VARIABLES

 11928	017760'	202300	016673'

 11929	017761'	263040	000000

 11930	017762'	202300	016672'

 11931	017763'	263040	000000

 11932	017764'	000377	777777

 11933	017765'	421700	000077

 11934	017766'	435700	000000*

 11935	017767'	254000	012673'

 11936	017770'	260040	017702*

 11937	017771'	424163	455753

 11938	017772'	400006	000000

 11939	017773'	000000	017704*

 11940	017774'	402005	000012

 11941	017775'	263040	000000

 11942	017776'	135700	000165'

 11943	017777'	201400	000003

 11944	020000'	302700	000001

 11945	020001'	306700	000002

 11946	020002'	201400	000033

 11947	020003'	350005	000015

 11948	020004'	254000	013227'

 11949	020005'	402005	000012

 11950	020006'	254000	013335'

 11951	020007'	612405	000027

 11952	020010'	616405	000027

 11953	020011'	200300	017017'

 11954	020012'	301300	000010
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 257-17
SCNSER.MAC	25-JAN-91 22:40		VARIABLES


 11955	020013'	350001	000000

 11956	020014'	263040	000000

 11957	020015'	014100	020000

 11958	020016'	400020	010000

 11959	020017'	000000	600000

 11960	020020'	000000	014355'

 11961	020021'	000000	014351'

 11962	020022'	000000	014343'

 11963	020023'	556347	426546

 11964	020024'	361747	437000

 11965	020025'	350700	774004

 11966	020026'	774004	774005

 11967	020027'	446351	152222

 11968	020030'	406311	155202

 11969	020031'	522231	747100

 11970	020032'	617375	570330

 11971	020033'	627514	506424

 11972	020034'	703314	560746

 11973	020035'	625015	467716

 11974	020036'	203235	635100

 11975	020037'	000000	000000

 11976	020040'	201300	200000

 11977	020041'	412300	016407*

 11978	020042'	402000	014522'

 11979	020043'	201300	020027'

 11980	020044'	324740	017233*

SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 257-18
SCNSER.MAC	25-JAN-91 22:40		VARIABLES

 11981	020045'	516132	452652

 11982	020046'	475014	667744

 11983	020047'	617235	663500

 11984	020050'	446351	152222

 11985	020051'	405015	767100

 11986	020052'	522513	130530

 11987	020053'	522513	131130

 11988	020054'	522513	131530

 11989	020055'	522513	132130

 11990	020056'	522513	132432

 11991	020057'	050000	000000

 11992	020060'	100000	020000

 11993	020061'	420020	010000

 11994	020062'	576062	000000

 11995	020063'	646471	000000

 11996	020064'	440601	777777

 11997	020065'	135400	000013

 11998	020066'	200000	000000

 11999	020067'	210000	000000

 12000	020070'	242000	015206*

 12001	020071'	042000	020070*

 12002	020072'	222000	000016

 12003	020073'	020000	600000

 12004	020074'	260040	017726*

 12005	020075'	444442	435645

 12006	020076'	000001	000000

 12007	020077'	200000	017445'
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 257-19
SCNSER.MAC	25-JAN-91 22:40		VARIABLES


 12008	020100'	412004	000002

 12009	020101'	254000	015354'

 12010	020102'	020001	010000

 12011	020103'	020000	400000

 12012	020104'	200606	000000

 12013	020105'	200646	000001

 12014	020106'	201300	000001

 12015	020107'	254000	015664'

 12016	020110'	201300	000002

 12017	020111'	254000	015664'

 12018	020112'	201300	000003

 12019	020113'	254000	015664'

 12020	020114'	201300	000004

 12021	020115'	254000	015664'

 12022	020116'	201300	000007

 12023	020117'	254000	015663'

 12024	020120'	201300	000010

 12025	020121'	254000	015663'

 12026	020122'	201300	000006

 12027	020123'	254000	015663'

 12028	020124'	410200	000015

 12029	020125'	000000	015572'

 12030	020126'	000000	015641'

 12031	020127'	000000	015602'

 12032	020130'	000000	015576'

 12033	020131'	201300	000011

SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 257-20
SCNSER.MAC	25-JAN-91 22:40		VARIABLES

 12034	020132'	254000	015663'

 12035	020133'	220604	000000

 12036	020134'	272727	000000

 12037	020135'	550202	016331*

 12038	020136'	254000	016317'

 12039	020137'	221100	000006

 12040	020140'	331100	000006

 12041	020141'	440100	003204*

 12042	020142'	261040	000005

 12043	020143'	254000	015422'

 12044						;End of SCNSER (SCNLIT: SCNEND:)
 12045
NO ERRORS DETECTED
PROGRAM BREAK IS 020160
13K CORE USED
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 258
SCNSER.MAC	25-JAN-91 22:40		SYMBOL TABLE

A		000000	SIN	AUXINP		011360'		AXWAIT		011514'	EXT	BLKINS		012123'	
ABTUUO		017604'	EXT	AUXJOB		017065'		AXZP1		011254'		BLKIO		012017'	
ACBBP		010661'		AUXLIC		011630'		B		000014	SIN	BLKIO1		012031'	
ACBRKC		010747'		AUXNSB		011563'		BADGUY		017015'		BLKIO2		012036'	
ACBSPC		010564'		AUXNTB		016513'		BADKEY		017207'		BLKIP1		012120'	
ACDEFC		010601'		AUXNTL		000072	SPD	BADPR1		001002'		BLKIRQ		012232'	
ACERAC		010574'		AUXPRT		017074'		BADPRT		001015'		BLKITM		001350'	
ACHNG		010737'		AUXRCP		017050'	INT	BASDWN		005625'	EXT	BLKNEG		001436'	
ACIN1		010756'		AUXRED		011716'	INT	BASE		000560'	INT	BLKOH1		001433'	
ACIN2		010761'		AUXRID		011143'		BASE04		000557'	INT	BLKOHR		001417'	
ACINSC		010765'		AUXRL1		011724'		BASEOK		012744'	INT	BLKOT1		012253'	
ACINWB		010777'		AUXRL2		011736'		BASTIM		777777	SIN	BLKOUT		012242'	
ACINWC		010755'		AUXRN1		011737'		BASVER		017254'	EXT	BLKTRQ		013107'	
ACNTB		010643'		AUXSLP		011547'		BBCNTS		016605'		BLKX1		012056'	
ACNZP		010704'		AUXSTA		017051'		BBCRE		017106'		BLKX2		012064'	
ACOTCI		007125'		AUXSTL		000010	SPD	BBFREE		017105'		BLKXI1		013104'	
ACPSM		010742'		AUXSTM		000035	SIN	BBPAGE		016625'		BLKXIN		013071'	
ACPTPC		010617'		AUXSTP		017063'		BBPOOL		017110'		BLKXIO		012044'	
ACSFS		010717'		AUXSTR		017052'	INT	BBREL		017107'		BLKXOT		013117'	
ACSOB		010726'		AUXTIM		017075'		BGCTYP		006116'	EXT	BLKXT1		013132'	
ACSOX		010671'		AUXTMP		011423'		BIOANS		017111'		BPAVAL		012437'	EXT
ACSYL		010723'		AUXTMR		011422'		BIOATT		013061'		BPFCOM		014023'	
ACTBK		010651'		AUXTOV		011474'		BIOBUF		017104'		BPFTYI		014003'	
ACTCLA		010637'		AUXTU0		010042'		BIOCHG		005767'		BPLVD		013771'	
ACTCN		010322'		AUXTU1		010055'		BIOCHK		012140'		BPLVD1		013776'	
ACTCP		010331'		AUXTUU		010021'	INT	BIOCHR		000005	SPD	BPOFF		014016'	
ACTCP1		010342'		AUXUNM		017076'		BIOCNT		017101'		BPOKBN		000006	SPD
ACTCP2		010354'		AUXWAK		011335'		BIOCOR		012500'	EXT	BPREQ		016355'	EXT
ACTMC		010711'		AUXWPC		017067'		BIOCSH		000001	SPD	BPTEST		014027'	
ACTTYP		010631'		AUXWPN		011354'		BIODAT		000006	SPD	BPWAIT		012424'	EXT
ACTWRT		011706'	EXT	AUXWPT		017070'		BIOJOB		017073'		BPXOFF		014015'	
ACWIDC		010555'		AUXWSC		017066'		BIOLNK		000000	SPD	BSLASC		005533'	
ADJBP	133000	000000		AUXWST		011352'		BIOPBC		000003	SPD	BUFCLR		006355'	EXT
ADRERR		006356'	EXT	AUXZAP		011243'		BIOPBP		000002	SPD	BUFLST		017100'	
ADVBFE		006527'	EXT	AUXZPT		011356'		BIOPRT		017103'		BV.DBG	000004	000000	SPD
ADVBFF		006377'	EXT	AXAVAL		011714'	EXT	BIOREL		012071'		BV.HDN	001000	000000	SPD
ADVPTR		004135'		AXCCNT		010207'	INT	BIOREQ		000004	SPD	BYP1		000011	SPD
AL		000001	SIN	AXCDON		011467'		BIORES		012104'		BYP2		000021	SPD
ALR620		020071'	EXT	AXCLEN		000104	SPD	BIOWAK		006000'		BYP3		000033	SPD
ALROPR		000020	SIN	AXCLP1		011444'		BIOZAD		004545'	INT	BYP4		000043	SPD
ALRSNT		017047'		AXCLP2		011456'		BIOZAP		012077'		BYTTC		010514'	
ARSTAB		011275'		AXCTAB		010056'		BITNTB		003206'	EXT	CCASC		005517'	
ASSCON		400000	SIN	AXELOG		011700'		BK2IOS		001000	SPD	CCPTR		005516'	
ASSPRG		200000	SIN	AXERGV		011677'		BKTOPN		007625'		CCTYI		014102'	INT
AUXCHR		011437'		AXGIV		011707'		BLKEOF		012134'		CCTYI1		014111'	
AUXCLP		011447'		AXNRL		011511'		BLKEOT		001332'		CCTYO		014072'	INT
AUXDET		011531'		AXNRR		011507'		BLKIB1		001317'		CHCNT		017022'	
AUXDRU		011642'		AXREQ		011713'	EXT	BLKIB2		001321'		CHECKU		006102'	
AUXEND		017062'	INT	AXSFIN		011566'		BLKIB3		001326'		CHGCLK		015562'	EXT
AUXERR		017064'	INT	AXSFN1		011564'		BLKIBF		001312'		CHKBAS		000532'	INT
AUXGA1		011623'		AXSNTB		011412'		BLKICK		001374'		CHKCHR		016230'	
AUXGAN		011615'		AXSWT		011515'	EXT	BLKIHR		001403'		CHKLIN		007426'	
AUXGV1		011711'		AXTOTB		011477'		BLKINP		012107'		CHKLN2		007425'	
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 258-2
SCNSER.MAC	25-JAN-91 22:40		SYMBOL TABLE

CHKLOS		016224'		CLSPBF		003554'		CREPTY		007707'	INT	DDINT		000001	SIN
CHKPSP		016253'		CLSPTB		003530'		CRLF		003252'	EXT	DDPBBP		000241'	
CHKRM1		013444'		CLSPTL		003476'		CRPTR		005521'		DDPCOM		000246'	
CHKRM2		013453'		CMDCKW		004713'	EXT	CRSHWD		017220'	EXT	DDPIMB		000244'	
CHKRM3		013455'		CMDTYO		013365'		CSINVL		004531'	EXT	DDPMOD		000245'	
CHKROM		013432'		CMDWAK		014035'		CTEXT1		015117'	EXT	DDPNTB		000243'	
CHKSEG		007440'	EXT	CMDWK1		014041'		CTY		000120	SPD	DDPNZP		000247'	
CHKTCC		016257'		CMFCHT		006047'	EXT	CTYBLF		014262'	INT	DDPTAB		000225'	
CHKYEL		016270'		CMFCKM		016433'	EXT	CTYBUF		014417'	EXT	DDPTBK		000242'	
CHPECH		000306'		CMFCXI		016431'	EXT	CTYCHR		014475'	ENT	DDPTCG		000237'	
CHPINP		000302'		CMFCXN		002053'	EXT	CTYDO		005612'	EXT	DDPTCH		000226'	
CHPOUT		000303'		CMFSTA		003076'	EXT	CTYFIL		017114'	INT	DDPTLC		000232'	
CHPRED		000305'		CNCCHK		006032'		CTYFLN		017115'		DDPTLN		000227'	
CHPSPE		000311'		CNCCK1		006046'		CTYFRM		014321'		DDPTOB		000233'	
CHPSPI		000310'		CNCMD1		014251'		CTYINP		000644'	EXT	DDPTPS		000235'	
CHPSPO		000304'		CNCMOD		014250'		CTYLDB		000105'	INT	DDPTSC		000225'	
CHPSPR		000307'		CNTCHR		007662'		CTYLOG		014410'	INT	DDPTTC		000240'	
CHQTA		017023'		CNTECO		004734'		CTYMSK		000000	EXT	DDPTTI		000230'	
CHRCNT		007643'		CNTOUT		004646'		CTYNFL		014327'		DDPTTS		000231'	
CHRML1		001554'		CNTPRT		001010'		CTYOCH		000377	SPD	DDPTYB		000236'	
CHRML2		001576'		CNTRUB		004624'		CTYOVL		000400	SPD	DDPTZP		000234'	
CHRML3		001601'		COASC		005530'		CTYOWD		014504'	EXT	DDTIN		006534'	INT
CHRMLT		001547'		COM940		014164'		CTYPTR		014415'	EXT	DDTINL		006545'	
CHRRDP		017040'		COMATB		014140'		CTYSFL		014317'		DDTINX		006554'	
CHRTAB		000312'		COMATT		015666'		CTYTY1		014376'		DDTOUT		006557'	INT
CHRTRP		016010'		COMBSP		014177'		CTYTYL		014404'		DDXZ		000000	SIN
CHRWRP		017041'		COMGMS		001475'	EXT	CTYTYO		014362'	INT	DEBUGF		000666'	EXT
CIMTAB		001615'		COMKJB		006667'	EXT	CTYTYP		014403'	INT	DECBC		012326'	
CKATI1		013524'		COMPA		014203'		CUASC		005523'		DECBC1		012344'	
CKATI2		013505'		COMPDP		014155'		CUPTR		005522'		DECBC2		012347'	
CKATIW		013511'		COMTAB		014173'		CX2AX%		000001	SPD	DECBC3		012354'	
CKATO1		013551'		COMTI1		014125'		CXDCB%		000003	SPD	DECIN1		015142'	EXT
CKATO2		013540'		COMTI2		014134'		CXDTP		000001	SPD	DECPBC		012340'	
CKATTF		013422'		COMTYI		014113'	INT	CXERR%		000007	SPD	DEFBRK		002132'	
CKATTI		013477'		COMTYO		014067'	INT	CXLOG%		000002	SPD	DEFCHR		002131'	
CKATTO		013532'		COMTYT		014116'	INT	CXNCH%		000006	SPD	DEFNBK		002133'	
CKLGO		015176'	INT	COMWCM		014056'	EXT	CXNRL%		000005	SPD	DETALL		012772'	
CKLN1		007433'		COMXON		004302'		CXNRR%		000004	SPD	DETON1		013005'	
CKLNTR		016237'		CONFIG		000000	EXT	DATE		016505'	EXT	DETONE		012776'	
CKOPR		015171'		CONMES		020044'	EXT	DBYT		000002	SIN	DEVBUF		000006	SIN
CKSXON		014257'		COPTR		005527'		DCL		000007	SIN	DEVCLS		000011	SIN
CLKJOB		015561'	EXT	CPERR		007727'		DCLBBP		400000	SPD	DEVIAD		000007	SIN
CLKRSP		001464'		CPNPT%		000001	SPD	DCLCOM		040000	SPD	DEVIOS		000002	SIN
CLNOC		004665'		CPNRM%		000002	SPD	DCLNTB		100000	SPD	DEVLOG		000005	SIN
CLNOCP		004664'		CPOPJ		017773'	EXT	DCLTBK		200000	SPD	DEVLST		015313'	EXT
CLRIM1		007574'		CPOPJ1		017750'	EXT	DDBBLK		000013	SIN	DEVMOD		000004	SIN
CLRIMI		007567'		CPUF3		000004	SPD	DDBCNE		015320'	INT	DEVNAM		000000	SIN
CLRMLT		001560'		CPUKI		000001	SPD	DDBDCH		000012	SPD	DEVOAD		000010	SIN
CLRPTY		004444'		CPUKL		000002	SPD	DDBLDB		000013	SIN	DEVOPR		016437'	EXT
CLRTTY		004421'		CPUKS		000003	SPD	DDBSR1		015720'		DEVSER		000003	SIN
CLSCHR		004113'		CPUTYP		000003	SPD	DDBSRC		015717'		DFRZAP		017140'	
CLSLP1		003512'		CPZZ		000000	SPD	DDBTRP		000014	SPD	DHNG		000005	SIN
CLSLP2		003525'		CREAUX		011513'	INT	DDINT		000001	SIN	DIDPBI		017202'	
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 258-3
SCNSER.MAC	25-JAN-91 22:40		SYMBOL TABLE

DIE		020074'	EXT	EACT6		005052'		FRCITM		001352'		GETBO		012362'	
DIN		000011	SIN	EACT6A		005056'		FRCLOS		001442'		GETCHK		006243'	
DINI		000004	SIN	EACT7		005070'		FRCLP0		011010'		GETCTY		014574'	INT
DINITF		000524'	EXT	EATTAB		013312'		FRCLP1		011020'		GETDDB		014663'	INT
DLRSUP		000400	SPD	ECHBAK		004751'		FRCLP2		011030'		GETLIN		007261'	
DOOUT		001206'		ECHLST		004753'		FRCNOO		001200'		GETLNZ		007320'	
DOU		000010	SIN	ECHRPT		004746'		FRCOHR		001424'		GETLOG		007417'	INT
DR1BIT		000001	SPD	ECHSPA		005125'		FRCORG		001256'		GETLPS		007447'	INT
DR2BIT		000002	SPD	ECHSPT		005130'		FRCRS1		011046'		GETMC		007506'	
DR3BIT		000020	SPD	ECHT12		004770'		FRCRS2		011066'		GETMOD		007453'	INT
DR4BIT		000200	SPD	ECHT34		004774'		FRCRS3		011104'		GETPP		007731'	
DRDOW		016675'		ECHT56		005000'		FRCRS4		011121'		GETPP1		007732'	
DRFLAG		012727'		ECHT7		005004'		FRCRS5		011125'		GIV4WD		012502'	EXT
DRL		000006	SIN	ECHTAB		004760'		FRCRS6		011126'		GOBCH1		001171'	
DRMANS		016672'		EDEC		001237'		FRCRS7		011132'		GOBCH2		001174'	
DRMBRK		016671'		ENTRUB		002427'		FRCRSC		011036'		GOBCHR		001157'	
DRMCLP		016673'		EPCOU1		005307'		FRCRSX		011137'		GOBIN		004526'	
DRMHSI		016667'		EPCOUT		005306'		FRCYEL		001266'		GOBIO1		004555'	
DRMSHT		016670'		ERRBNG		017112'		FRCZAP		001522'		GOBIO2		004565'	
DRMTIM		016674'	INT	ERRXIT		011332'		FREBUF		001371'		GOBOP		004536'	
DRZAP		012763'		ESCTR1		016050'		FRECHK		006233'		GOBOT		004537'	
DSPSIZ		000012	SPD	ESCTRP		016033'		FREST		006054'		GOBOT3		004547'	
DVIN		000002	SIN	EXTEND	123000	000000		FRETTY		017036'	INT	GOBPF		004307'	
DVNZP		010000	SIN	F		000004	INT	FREUP		006052'		GOBPN		004323'	
DVOUT		000001	SIN	FARCHK		015517'	EXT	FRMASN		016422'	EXT	GOBPN1		004327'	
DVRMT		004000	SIN	FCREQ		017707'	EXT	FRMKJF		014552'	EXT	GOCGB		004252'	
DVSIZ		000003	SIN	FCS		000100	SPD	FRSDEF		017204'		GOECO		004726'	
DVTTY		000010	SIN	FCWAIT		017706'	EXT	FRSFLG		017203'		GOFIL		005330'	
DWNFLG		017113'	INT	FDRUPX		006571'	EXT	FRSTTY		016110'		GOHNG		004265'	
DZAP		000012	SIN	FFFLP		005534'		FSCN		017016'		GOHSH		004216'	
E1IDPB		005315'		FFLP0		005535'		FULLCQ		006025'		GOLIN		003267'	
E2IDPB		005322'		FILERS		005560'		FULLIN		003327'		GOLIN1		003302'	
EAC10A		005044'		FINLIN		003315'		FULLN2		003336'		GOLIN2		003301'	
EAC10B		005047'		FINOUT		003360'		FULLN3		003343'		GOLIN3		003276'	
EAC11A		005064'		FIXIMI		007556'		GBXLUP		012173'		GOOUT		004642'	
EAC14A		005113'		FLGCHR		000400	SIN	GEPM10		007553'		GORUB		004620'	
EAC15A		005122'		FLGESC		000001	SIN	GEPM11		007554'		GOSBL		004275'	
EAC4A		005032'		FLGLIN		004000	SIN	GEPM12		007555'		GOSEC		004260'	
EACT1		005010'		FLLBSC		005532'		GEPMC1		007542'		GOSGR		004702'	
EACT10		005040'		FLLFFS		005540'		GEPMC2		007543'		GOSOG		004704'	
EACT11		005060'		FLLVTS		005544'		GEPMC3		007544'		GOSRD		004250'	
EACT12		005100'		FLMX		000050	SPD	GEPMC4		007545'		GOSTC		004223'	
EACT13		005103'		FMTB		004266'		GEPMC5		007546'		GOSTC1		004225'	
EACT14		005107'		FMTB1		004270'		GEPMC6		007547'		GOSTP		004254'	
EACT15		005116'		FNDPRT		016312'	INT	GEPMC7		007550'		GOSYL		004672'	
EACT16		005020'		FNDPT1		016317'		GEPMC8		007551'		GOTBF0		012214'	
EACT17		005074'		FPOPJ		014060'		GEPMC9		007552'		GOTBF1		012216'	
EACT1A		005015'		FRCCGB		001166'		GET4WD		012447'	EXT	GOTBUF		012150'	
EACT1B		005012'		FRCDOO		001207'		GETBB		012443'		GOTRI		004616'	
EACT2		005022'		FRCEOT		001334'		GETBB1		012463'		GOTRO		004610'	
EACT3		005026'		FRCIBF		001314'		GETBBP		012461'		GOXOFF		004335'	
EACT4		005030'		FRCIHR		001405'		GETBI		012356'		GOXON		004320'	
EACT5		005035'		FRCINP		011004'		GETBIO		012414'		GOZAP		004345'	
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 258-4
SCNSER.MAC	25-JAN-91 22:40		SYMBOL TABLE

GREEN		001243'		IACT2		002172'		INPDL1		000272'		IRPMB2		017013'	INT
GTBIO1		012425'		IACT21		002505'		INPDL2		000273'		IRPMB3		017014'	INT
GTCGSZ		006414'	EXT	IACT22		002510'		INPDLN		002646'		IRPMP1		017007'	INT
GTLCRD		002000	SPD	IACT2A		002176'		INPES0		003125'		IRPMP2		017010'	INT
GTLDEF		001000	SPD	IACT3		002201'		INPES1		003127'		IRPMP3		017011'	INT
GTLECS		100000	SPD	IACT4		002207'		INPESC		003100'		IRPMS2		017005'	INT
GTLESC		004000	SPD	IACT5		002214'		INPEST		003121'		IRPMS3		017006'	INT
GTLFRM		000001	SPD	IACT5A		002216'		INPGOB		002632'		IRPMSG		017004'	INT
GTLHDX		010000	SPD	IACT6		002221'		INPLIN		000267'		IRPOLD		017210'	
GTLLCT		000020	SPD	IACT7		002225'		INPOTP		002637'		IRPPDP		001051'	EXT
GTLLRD		000100	SPD	IB		000013	SIN	INPRA1		003047'		IRPSTP		017206'	
GTLMSK		501777	SPD	ICH0		007407'		INPRAC		003043'		IRPTIM		005646'	EXT
GTLNFC		000200	SPD	ICS1		007347'		INPRB1		002723'		J		000002	INT
GTLOBS		020000	SPD	ICW1		007401'		INPRB2		003071'		JACCT		000001	SIN
GTLPSP		040000	SPD	ICW1A		007400'		INPRB3		003024'		JACCT2		100000	SIN
GTLPTP		000002	SPD	ICW1B		007377'		INPRB4		003025'		JBTABT		011711'	EXT
GTLTAB		000010	SPD	IDLNEC		002655'		INPRB5		003034'		JBTAUN		011615'	EXT
HIGHJB		006706'	EXT	IFDET		015367'	INT	INPRB6		002747'		JBTAWQ		013541'	EXT
HNGAL1		006710'		IFROOM		013463'		INPRB7		002751'		JBTBCS		006416'	EXT
HNGALL		006701'	INT	IGOBEC		002661'		INPRB8		002763'		JBTBET		005772'	EXT
HNGAUX		011220'		IMGCH1		006431'		INPRB9		002760'		JBTBIO		012265'	EXT
HNGAX1		011222'		IMGCHG		006432'		INPRBC		002776'		JBTCIN		001571'	EXT
HNGAX4		011234'		IMGCNT		006420'		INPRET		002614'		JBTCOT		003335'	EXT
HNGAXD		011226'		IMGDEF		002123'		INPRT2		002770'		JBTLIC		011576'	EXT
HNGJOB		006671'		IMGDIM		000002	SPD	INPRTA		003051'		JBTPIP		016327'	EXT
HNGMON		006602'	INT	IMGIT2		001343'		INPRTB		003037'		JBTPRV		000000	EXT
HNGPRT		006617'		IMGITM		001342'		INPRUB		002721'		JBTSTS		015522'	EXT
HNGTT1		006651'		IMGRM1		002164'		INPSTA		003073'		JBTUN1		011603'	EXT
HNGTT2		006664'		IMGRMA		002136'		INPTAB		002572'		JBTUNM		011602'	EXT
HNGTT3		006665'		IMGRMT		002152'		INPTCA		002612'		JBYEXC		016133'	EXT
HNGTTY		006640'		IMGTIM		000012	SPD	INPTYP		000266'		JBYWAK		016130'	EXT
HNGUUL		006577'		INCBC		012314'		INRW1		007413'		JERR		020000	SIN
HNGUUO		006562'	INT	INCHRS		007345'		INTERM		017034'	INT	JFYMIN		000527'	EXT
HWDPNT		003251'	EXT	INCHRW		007412'		INTSET		016210'		JFYSEC		005620'	EXT
I		000010	SIN	INCHSL		007356'		INWL1		007370'		JLOG		000004	SIN
I1CHRW		007411'		INCHWL		007367'		IO		000020	SIN	JNA		040000	SIN
I1CHWL		007366'		INCPBC		012324'		IOACT		010000	SIN	JOB		014557'	EXT
IAC10A		002236'		INISET		014523'	INT	IOBEG		000002	SIN	JOBN		006760'	EXT
IAC11A		002243'		INISL2		014555'		IOBKTL		040000	SIN	KAF1		000530'	INT
IAC11B		002245'		INISLP		014534'		IODEND		020000	SIN	KEPBI		012400'	
IAC11C		002246'		INLMES		005627'	EXT	IOEND		000040	SIN	KEPBI1		012407'	
IAC11D		002247'		INPA10		002526'		IOFST		000004	SIN	KEY10		000512'	
IAC16B		002474'		INPA94		002547'		IONEOU		007126'		KEY620		000621'	EXT
IAC16C		002475'		INPACT		002522'		IOSBKA		100000	SPD	KEYSET		000514'	INT
IACT0		002517'		INPAL1		002627'		IOW		000001	SIN	KEYTIM		005614'	EXT
IACT1		002167'		INPBK2		002625'		IPOPJ		000000	EXT	KMCCAC		012762'	EXT
IACT10		002233'		INPBRK		002570'		IPOPJ1		015662'	EXT	KMCDO		016432'	EXT
IACT11		002241'		INPBS1		002601'		IQUEUE		013044'		KMCFLG		016704'	INT
IACT12		002450'		INPBSP		002577'		IRING		016470'	EXT	KMCGAC		012636'	EXT
IACT13		002456'		INPCH		017020'		IRP620		000761'	EXT	KMCGAV		012632'	EXT
IACT14		002461'		INPCH2		000271'		IRPLO1		016477'		KMCGUP		012726'	EXT
IACT15		002467'		INPCHR		000270'		IRPLOG		016470'		KMCLAS		016702'	
IACT17		002477'		INPCLD		002623'		IRPMB1		017012'	INT	KMCPDP		016703'	INT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 258-5
SCNSER.MAC	25-JAN-91 22:40		SYMBOL TABLE

KMCRST		012560'	EXT	LDICLR		000000	SPD	LDPNFC		000210'		LEVDEF		007477'	
KMCSHT		013037'		LDLAUX		000040	SPD	LDPNTB		000163'		LICAC		000400	SIN
KMCSUP		013017'	EXT	LDLBK2		004000	SPD	LDPNXO		000215'		LICOPR		100000	SIN
KSNOCH		012317'	EXT	LDLBKA		010000	SPD	LDPOR		000012'		LICWCR		400000	SIN
L2LBBP		040000	SPD	LDLCOM		020000	SIN	LDPPA		000015'		LINFLG		020141'	EXT
L2LBSP		001000	SPD	LDLDEF		001000	SPD	LDPPAR		000013'		LINFSV		017032'	
L2LCCS		200000	SPD	LDLECS		100000	SPD	LDPPB		000016'		LINJOB		007441'	INT
L2LDEL		004000	SPD	LDLFRM		000001	SPD	LDPPC		000017'		LINPNM		017031'	
L2LLDF		010000	SPD	LDLIMI		002000	SPD	LDPPD		000023'		LINPTR		017021'	
L2LNTB		020000	SPD	LDLLCP		000004	SPD	LDPPOS		000175'		LINTAB		016402'	EXT
L2LOEX		400000	SPD	LDLLCT		000020	SPD	LDPPSM		000176'		LINTRP		016021'	
L2LOWS		002000	SPD	LDLNEC		000100	SPD	LDPPTP		000213'		LLLHDX		004000	SPD
L2LOWT		000400	SPD	LDLNFC		000200	SPD	LDPQM		000027'		LLLNLN		100000	SPD
L2LTBK		100000	SPD	LDLNOP		400000	SPD	LDPRTC		000222'		LLLZAP		200000	SPD
LAPBIT		000026	SPD	LDLOSU		000400	SPD	LDPRXE		000022'		LMLBIO		001000	SPD
LDB.HI		017215'		LDLPTP		000002	SPD	LDPSOX		000205'		LMLPSP		200000	SPD
LDB.LO		017214'		LDLPTY		040000	SPD	LDPSPA		000030'		LMLTBI		400000	SPD
LDBBIO		000005	SPD	LDLSOX		200000	SPD	LDPTAB		000212'		LNLZIN		400000	SPD
LDBBK2		000016	SPD	LDLTAB		000010	SPD	LDPTBK		000161'		LOGCH1		002042'	
LDBBKC		000015	SPD	LDPBBP		000162'		LDPTIM		000174'		LOGCH2		002045'	
LDBBKI		000007	SPD	LDPBSD		000217'		LDPTOB		000025'		LOGCHR		001746'	
LDBBKP		000006	SPD	LDPBSP		000164'		LDPTYP		000224'		LOGIN		001214'	
LDBBYT		000027	SPD	LDPCHG		000177'		LDPWDA		000171'		LOGLDB		015564'	EXT
LDBCLA		000033	SPD	LDPCIE		000005'		LDPWID		000170'		LOGZAP		017136'	
LDBDCH		000031	SIN	LDPCLA		000223'		LDPXON		000020'		LOPBIN		000061'	
LDBDCX		000032	SPD	LDPCOM		000206'		LDRBIP		010000	SPD	LOPBOP		000065'	
LDBDDB		000000	SIN	LDPCRD		000010'		LDRBPS		400000	SPD	LOPBOT		000076'	
LDBECC		000014	SPD	LDPDEM		000216'		LDRDEM		040000	SPD	LOPBPF		000064'	
LDBECT		000013	SPD	LDPECH		000021'		LDRFCS		020000	SPD	LOPBPN		000063'	
LDBFLP		000022	SPD	LDPECO		000004'		LDRNXO		100000	SPD	LOPCGB		000060'	
LDBLEN		000051	SIN	LDPECR		000007'		LDRXOS		200000	SPD	LOPECO		000102'	
LDBLIN		000001	SPD	LDPELF		000006'		LDSCIE		000032'		LOPFIL		000073'	
LDBLOG		000026	SIN	LDPERA		000220'		LDSCRD		000035'		LOPHNG		000100'	
LDBMOD		000030	SPD	LDPESC		000026'		LDSECH		000046'		LOPHSH		000056'	
LDBOPB		000002	SPD	LDPFA1		000173'		LDSECO		000031'		LOPOUT		000075'	
LDBOUT		000003	SPD	LDPFA2		000167'		LDSECR		000034'		LOPRUB		000074'	
LDBRBC		000025	SPD	LDPFC1		000172'		LDSELF		000033'		LOPSBL		000072'	
LDBRBI		000023	SPD	LDPFC2		000166'		LDSESC		000053'		LOPSEC		000067'	
LDBRBO		000024	SPD	LDPFRM		000214'		LDSHDX		000041'		LOPSGR		000103'	
LDBSTR		000034	SIN	LDPHDX		000014'		LDSIR		000036'		LOPSOG		000104'	
LDBTCB		000004	SPD	LDPHST		000160'		LDSKAT		000051'		LOPSRD		000066'	
LDBTIC		000012	SPD	LDPIMB		000203'		LDSOR		000037'		LOPSTC		000071'	
LDBTIP		000010	SPD	LDPIR		000011'		LDSPA		000042'		LOPSTP		000070'	
LDBTIT		000011	SPD	LDPKAT		000024'		LDSPAR		000040'		LOPSYL		000077'	
LDBTMR		000044	SPD	LDPLCO		000221'		LDSPB		000043'		LOPTRI		000062'	
LDBTMS		000046	SPD	LDPLCT		000211'		LDSPC		000044'		LOPTRO		000057'	
LDBTMT		000050	SPD	LDPLMD		000200'		LDSPD		000050'		LOPZAP		000101'	
LDBTOC		000021	SPD	LDPLNO		000157'	INT	LDSQM		000054'		LOS620		017123'	
LDBTOP		000017	SPD	LDPMDF		000207'		LDSRXE		000047'	INT	LOSPDP		017122'	
LDBTOT		000020	SPD	LDPMEC		000201'		LDSSPA		000055'		LP.I8C		002000	SPD
LDBTYP		000033	SPD	LDPMIN		000202'		LDSTOB		000052'		LP.PIA		000007	SPD
LDEC		001231'		LDPMOD		000165'		LDSXON		000045'		LP.SSF		010000	SPD
LDICLE		000050	SPD	LDPMOU		000204'		LEVDEF		007477'		LPERDR		000100	SPD
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 258-6
SCNSER.MAC	25-JAN-91 22:40		SYMBOL TABLE

LPOPJ		015414'		MDRL1		012721'		NTTOPR		004434'		OUTSN1		007250'	
LTSCIE	200000	000000	SPD	MDRLUP		012660'		NUMECO		000024	SPD	OUTSN2		007257'	
LTSCRD	020000	000000	SPD	MDRMSG		012653'		NXTTTY		016112'		OUTSNW		007240'	
LTSECH	000020	000000	SPD	MDRNXT		012627'		NZAPAX		017144'		OUTST1		007137'	
LTSECO	400000	000000	SPD	MDRRET		012723'		NZAPIN		017141'		OUTSTR		007134'	
LTSECR	040000	000000	SPD	MDRSHT		012577'		NZAPLG		017143'		OUTTRN		003364'	
LTSELF	100000	000000	SPD	MDRUP		012726'		NZAPN2		017142'		OWK120		017127'	
LTSESC		400000	SPD	MLOWQ		014730'	EXT	NZAPOT		017146'		OWK30		017125'	
LTSHDX	001000	000000	SPD	MLTNDB		001572'		NZAPRS		017145'		OWTIM		000024	SPD
LTSIR	010000	000000	SPD	MONHNG		014244'	INT	OBFND		001260'		P		000001	INT
LTSKAT	000002	000000	SPD	MORLIN		003305'		OBFND1		001261'		P1		000014	INT
LTSOR	004000	000000	SPD	MORLN2		003312'		OBREC		016060'		P2		000015	INT
LTSPA	000400	000000	SPD	MOVCH1		001613'		OMX120		017126'		P3		000016	INT
LTSPAR	002000	000000	SPD	MOVCH2		001610'		OMX30		017124'		P4		000017	INT
LTSPB	000200	000000	SPD	MOVCHR		001606'		ONEOU2		007117'		PATCH2		016355'	INT
LTSPC	000100	000000	SPD	MOVSLJ	016000	000000		ONEOU3		007121'		PBDISC		017201'	
LTSPD	000004	000000	SPD	MSG777		775777	INT	ONEOUT		007107'		PBTIMO		003710'	
LTSQM		200000	SPD	MSGBUF		774004	INT	OP0TYO		014355'	INT	PEVEN8		014366'	EXT
LTSRXE	000010	000000	SPD	MSGIN1		014443'		OP1TYO		014351'		PG		000003	INT
LTSSPA		100000	SPD	MSGINI		014430'	INT	OP2TYO		014343'		PGBIN		003666'	
LTSTOB	000001	000000	SPD	MSGLG.		774000	INT	OPCRET		000001	SPD	PGBIN1		003702'	
LTSXON	000040	000000	SPD	MSGLGI		774002	INT	OPRCT2		014277'		PGBOP		004012'	
LXL120		400000	SPD	MSGLGO		774003	INT	OPRCTY		014264'		PGBOP1		004027'	
LXLBSD		100000	SPD	MSGLGP		017216'		OPRFIL		014323'		PGBOP2		004032'	
LXLDLR		020000	SPD	MSGLGS		774001	INT	OPRFR1		014743'		PGBOP3		004046'	
LXLERA		040000	SPD	MSGLOG		014456'	INT	OPRFRE		014737'	INT	PGBOT		003736'	
LXLLCO		010000	SPD	MSGSIM		003570'		OPRLDB		017027'	INT	PGBOT1		003752'	
LXLOOK		004000	SPD	MSKIRG		001466'	EXT	OPROUT		014334'	INT	PGBOTC		003777'	
LXLRTC		002000	SPD	MSKORG		017347'	EXT	OPRSN2		014711'		PGBPF		003614'	
LXRBRK		004000	SPD	MULCNT		017043'		OPRSND		014707'	INT	PGBPN		003606'	
LXRCGS		001000	SPD	MXLIN		007430'	EXT	OPRTIC		014263'	INT	PGCGB		003576'	
LXRCHR		010000	SPD	MXMCNT		017045'		OPRTIM		017035'	INT	PGECO		004726'	
LXRESC		400000	SPD	MXTIM		016360'	EXT	OPRWAT		014730'		PGFIL		005330'	
LXRICL		040000	SPD	MXTYP		000063	SPD	OPRWJB		017116'		PGHNG		003566'	
LXRIOS		000400	SPD	NAMSC1		016000'		OPSND1		014716'		PGHSH		004215'	
LXROBS		200000	SPD	NAMSC2		016006'		OQUEUE		013053'		PGOUT		004642'	
LXROCL		020000	SPD	NAMSCN		015775'		ORANGE		001255'		PGRUB		004620'	
LXRPSS		100000	SPD	NEWJER		002055'		ORING		015226'	EXT	PGSBL		004100'	
LXRTCC		000200	SPD	NEWTER		002060'		ORP620		017346'	EXT	PGSEC		003566'	
LXRYBS		002000	SPD	NMXFLG		003202'	EXT	ORPLO1		016510'		PGSGR		003565'	
M		000013	INT	NMXLIN		000000	EXT	ORPLOG		016501'		PGSOG		003600'	
MAKDET		011147'		NOBASE		005624'	INT	ORPOLD		017211'		PGSRD		003565'	
MAKDLC		011170'		NOCTRO		007152'		ORPPDP		017350'	EXT	PGSTC		003567'	
MAXDR		013575	SPD	NODIE		017770'	EXT	ORPTIM		004137'	EXT	PGSTP		003566'	
MAXTMC		000024	SPD	NOECHO		000200	SPD	OUPLIN		000275'		PGSYL		003620'	
MD0405		001631'		NOLIN		003352'		OUPTYP		000274'		PGSYLN		003641'	
MD0607		001635'		NOLIN2		003355'		OUT		006340'	EXT	PGTRI		003650'	
MD1011		001641'		NOOUT		001177'		OUTCHI		007106'		PGTRI1		003663'	
MD1213		001645'		NOTLIN		004376'		OUTPC1		007220'		PGTRO		004051'	
MDFLMD		003135'		NOTOPR		004366'		OUTPC2		007225'		PGZAP		004055'	
MDRANS		012621'		NOXEXE		014522'	INT	OUTPCF		007232'		PGZAP1		004076'	
MDRBRK		012605'		NRPCNT		017071'		OUTPT1		007175'		PJBSTS		014745'	EXT
MDRCLP		012613'		NTTOPR		004434'		OUTPTC		007212'		PJOBN		016321'	EXT
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 258-7
SCNSER.MAC	25-JAN-91 22:40		SYMBOL TABLE

PJRST	324740	000000		RCCDBG		006056'	INT	RMTCNT		002253'		S$HALT	777777	777777	SIN
PJUMPE	322000	000000		RCCSTP		006211'	INT	RMTCR		002347'		S$INFO		000005	SIN
PNTOB1		007642'		RCVANS		013007'		RMTECR		002264'		S$JOB		000002	SIN
PNTOBK		007632'		RCVAUX		011342'		RMTECT		002270'		S$NAME		000000'	SPD
POLPRT		011766'	INT	RCVCH1		001660'		RMTEU1		002360'		S$NONA		000000	SIN
POLPT1		011774'		RCVCH2		001700'		RMTEXC		002352'		S$PATC		000007	SIN
POLPT3		012011'		RCVCHR		001651'		RMTEXU		002356'		S$STOP		000001	SIN
POLPT4		012014'		RCVLOS		001437'		RMTFF		002377'		S$TEMP		000000	SPD
POLPT5		012015'		RCVNSP		011262'		RMTPAT		002330'		S$XCT	777777	777776	SIN
PORTN		016313'	EXT	RCVPS		001501'		RMTRUB		002364'		S..KAF		000530'	EXT
PPORTN		000000	EXT	RCVRAK		012742'		RMTS10		002304'		SAV30		017232'	EXT
PRCCR		005351'		RCVRES		012746'		RMTS94		002316'		SBBLUP		012535'	
PRCFIL		005356'		RCVS2		011305'		RMTSPA		002275'		SCANBB		012525'	
PRCFL1		005373'		RCVS2A		011307'		RMTSPT		002300'		SCN1PD		000564'	
PRCOCW		005350'		RCVS4		011314'		RMTTAB		002405'		SCNBUF		016510'	EXT
PRCOM		001066'	EXT	RCVS6		011321'		RMTTB1		002420'		SCNDDB		000250'	INT
PRCOT1		005376'		RCVSP		011325'		RMTVT		002371'		SCNDDS		000016	SIN
PRCOT2		005377'		RCVSUR		011273'		RMXLIN		001000'	EXT	SCNDRD		012556'	
PRCOT3		005400'		RCVTCX		001462'		RNQ		014744'	EXT	SCNDSP		006331'	
PRCOUT		005340'		RCVTMC		001454'		RPORTN		012767'	EXT	SCNEND		020157'	INT
PROACT		005405'		RCVWK1		006021'		RT.CON		020000	SPD	SCNIN		000741'	
PROUCC		005603'		RCVZAP		001514'		RT.MOD		300000	SPD	SCNIN0		000752'	
PRPRMT		015605'	EXT	RDAPR	700240	000000		RT.SIG		040000	SPD	SCNIN1		001011'	
PRTBTM		005627'		RDIO	712000	000000		RT.SLV		400000	SPD	SCNIN2		001014'	
PRTBVR		000000	SPD	RDNXT		007461'		RTATC		015547'		SCNINT		000627'	INT
PRTCRS		000566'		RECHLT		001731'		RTATS		015610'		SCNLIT		017217'	INT
PRTDDB		006115'	EXT	RECHT1		001742'		RTATS1		015623'		SCNMI2		012566'	
PRTIRG		001033'	INT	RECVRG		001704'		RTATS2		015634'		SCNMIN		012553'	
PRTKEY		000616'	INT	RED		001247'		RTAUX%		000010	SPD	SCNMSK		016503'	EXT
PRTOCT		001070'	EXT	REFLAG		016403'	EXT	RTCCO		015602'		SCNNAM		015764'	
PRTUT1		003233'		RELB0		012376'		RTCONT		015476'		SCNNMR		014677'	
PSDONE		001513'		RELBB		012473'		RTCSV		015572'		SCNNT0		000641'	
PTBSIZ		000170	SPD	RELBB1		012503'		RTCUS		015576'		SCNNT2		000733'	
PTYBUD		007744'		RELBBF		012475'		RTERJ		015663'		SCNOUT		003175'	
PTYBUF		017151'		RELBI		012366'		RTERR		015664'		SCNPTR		016502'	EXT
PTYDDB		010004'		RELBIO		012431'		RTFIN		015641'		SCNREL		000000	SPD
PTYFLO		017150'		RELBO		012372'		RTFIN1		015654'		SCNSC0		005650'	
PTYLDB		007750'		RELEA6		015661'	EXT	RTFIN2		015660'		SCNSC1		005667'	
PTYLOS		017135'		RELKMC		012512'		RTNRM%		000011	SPD	SCNSC2		005673'	
PTYSBL		004111'	INT	REQBUF		012222'		RTSAC%		000001	SPD	SCNSEC		005610'	INT
PTYTRN		003413'		RETACH		015503'	INT	RTSCP%		000007	SPD	SCNSER		000000'	ENT
PUNIT		015765'	EXT	RETCH1		015534'		RTSNA%		000005	SPD	SCNTCD		014754'	INT
PVYHNG		006653'	EXT	RETCH2		015536'		RTSNX%		000002	SPD	SCNTIC		000717'	
PVYMOD		013562'	EXT	RETZRO		007422'		RTTAC%		000003	SPD	SCNUDT		016506'	EXT
PX.MEM		000004	SPD	RIDLIN		002665'		RTTAT%		000006	SPD	SCNVER		000001	SPD
PX.SRC		000001	SPD	RIDLN1		002700'		RTTNX%		000004	SPD	SCOLP		003207'	
PXCT	256000	000000		RIDLN2		002713'		RUBSTR		002444'		SCOLP1		003203'	
QUEPCB		014750'	EXT	RIDLN3		002715'		RWARN		001717'		SCOPTY		003221'	
RCC.HI		017213'	INT	RLBIO1		012441'		RWARN1		001725'		SCORTY		003253'	
RCC.LO		017212'	INT	RMTAL1		002334'		S		000000	INT	SCOTTY		003262'	
RCC.T1		006114'		RMTALT		002336'		S$DEBU		000003	SIN	SECLOP		005674'	
RCC.T3		006111'		RMTBSP		002426'		S$ENTR	777777	777775	SIN	SECLP1		005703'	
RCCBAD		006107'	INT	RMTCN1		002332'		S$EVEN		000006	SIN	SECLP2		005742'	
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 258-8
SCNSER.MAC	25-JAN-91 22:40		SYMBOL TABLE

SECLP3		005752'		SPEVM		005217'		TAKNZJ		016065'	EXT	TINASS		016325'	INT
SECLP4		005765'		SPOBS1		005473'		TAKOTJ		016030'	EXT	TINDET		016337'	
SECTM1		005716'		SPOBS2		005464'		TAKTRJ		015657'	EXT	TINFIO		040000	SPD
SECTM2		005724'		SPOBSP		005466'		TAKTRP		016351'	EXT	TIOUSE		020000	SPD
SECTM3		005736'		SPOCR		005414'		TATUU1		015472'		TIRSVD		000003	SPD
SENT41		016676'		SPOFF		005446'		TATUUO		015444'	INT	TIWAIT		013720'	
SETBRK		006411'		SPOFF1		005452'		TBFL		005550'		TIWAKE		006010'	
SETFIO		016307'		SPOFIL		005477'		TBFL2		005554'		TIWAKN		006022'	
SETIO2		010717'	EXT	SPOFL1		005501'		TCBALL		000003'		TIWKC		000110	SPD
SETLIN		007331'		SPOTAB		005416'		TCNBSD		000031	SPD	TIWRNN		017117'	
SETLMD		007603'		SPOTB0		005431'		TCNBSP		000020	SPD	TKATT%		000002	SIN
SETLN1		007334'		SPOTB1		005441'		TCNCLA		000032	SPD	TKBSY%		000003	SIN
SETOPB		010553'		SPOTBL		005407'		TCNCRD		000000	SPD	TKEXS%		000001	SIN
SETOUT		004140'		SPOVT		005455'		TCNDEF		000022	SPD	TKROM%		000000	SIN
SETPTB		003464'		SPOVT1		005461'		TCNDSP		010420'		TMCALL		000077	SPD
SETPTL		003442'		SPRCOM		014145'		TCNECH		000011	SPD	TMCCIE		000001	SPD
SETPTP		007671'		SPRCTB		014151'		TCNERA		000021	SPD	TMCCRD		000004	SPD
SETRUN		015502'	EXT	SPREAT		013317'		TCNFC1		000016	SPD	TMCECH		000015	SPD
SETSHT		015156'	INT	SPRETB		013325'		TCNFC2		000017	SPD	TMCECO		000000	SPD
SETTB1		007622'		SPRTTB		013202'		TCNFRM		000025	SPD	TMCECR		000003	SPD
SETTBK		007607'		SPRTYI		013177'		TCNHDX		000004	SPD	TMCELF		000002	SPD
SETTC1		010357'		SSPT		005601'		TCNIR		000001	SPD	TMCESC		000022	SPD
SETTC2		010413'		STATES		020041'	EXT	TCNKAT		000034	SPD	TMCHDX		000010	SPD
SETTCN		010356'		STAUTO	000001	000000	SIN	TCNLCO		000023	SPD	TMCIR		000005	SPD
SIMRZP		001521'		STDALT		000033	SPD	TCNLCT		000026	SPD	TMCKAT		000020	SPD
SKPFLG		017205'		STLST		006063'		TCNN		000036	SPD	TMCOOR		017147'	
SKPIN1		007167'		STOP10		000003	SPD	TCNNFC		000027	SPD	TMCOR		000006	SPD
SKPINC		007147'		STOP9		000037	SPD	TCNNXO		000014	SPD	TMCPA		000011	SPD
SKPINL		007157'		STOTC1		007423'		TCNOR		000002	SPD	TMCPAR		000007	SPD
SLCTAB		007322'		STRUB		002437'		TCNPA		000005	SPD	TMCPB		000012	SPD
SLCTBN		000007	SPD	STRUB1		002433'		TCNPAR		000003	SPD	TMCPC		000013	SPD
SNDAUX		011406'		STSHUT		400000	SIN	TCNPB		000006	SPD	TMCPD		000017	SPD
SNDHSI		012571'		STSUPR		200000	SIN	TCNPC		000007	SPD	TMCQM		000023	SPD
SNDSAD		015206'		STTIOD		006016'	EXT	TCNPD		000013	SPD	TMCRXE		000016	SPD
SNDSRQ		011424'		STTLK		006747'	INT	TCNPTP		000030	SPD	TMCSIZ		000002	SPD
SPE940		005146'		STTLK0		006757'		TCNRTC		000033	SPD	TMCSLP		000025	SPD
SPEALP		005173'		STTLK1		007002'		TCNRXE		000012	SPD	TMCSPA		000024	SPD
SPEALT		005175'		STTLK2		007007'		TCNTAB		000024	SPD	TMCTOB		000021	SPD
SPEAP1		005170'		STTLK3		007020'		TCNTYP		000035	SPD	TMCXON		000014	SPD
SPEBK3		005164'		STTYBF		000020	SIN	TCNWID		000015	SPD	TOEMAX		017130'	
SPEBK6		005166'		SUPTIM		011263'	EXT	TCNXON		000010	SPD	TOWAIT		013733'	
SPEBRK		005162'		SVOJFF		017033'		TCVMAX		010456'		TOWAT1		013736'	
SPEBS		005223'		SVPPC		014512'	INT	TDTUUO		015333'	INT	TOWATA		014613'	
SPEBS1		005232'		SVSPC		017024'		THSDAT		000000	EXT	TPOPJ		016323'	EXT
SPECR		005160'		SYSNUM		016414'	EXT	THSTIM		016357'	EXT	TPOPJ1		016324'	EXT
SPEPDP		005134'		T1		000006	INT	TIHLTN		017120'		TRESCN		014062'	INT
SPETAB		005204'		T2		000007	INT	TILOW		000120	SPD	TRESCU		007144'	
SPETB1		005213'		T2POPJ		014071'	EXT	TIMDRD		016666'		TRMAUX		000000	SPD
SPEUC1		005302'		T3		000010	INT	TIME		000000	EXT	TRMBYP		000156'	
SPEUCM		005264'		T4		000011	INT	TIMMIN		016665'		TRMTAB		002063'	
SPEUX		005236'		TABPTR		005571'		TIMOW		017046'		TRPLEN		000014	SPD
SPEUX1		005262'		TABTMR		000004'		TIMRST		015560'	EXT	TSETBI		006257'	INT
SPEUXC		005245'		TABTMS		000031'		TINAS1		016200'	INT	TSETBO		006305'	
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 258-9
SCNSER.MAC	25-JAN-91 22:40		SYMBOL TABLE

TSTBO1		006307'		TTPC2		006230'		TTYOUW		400000	SIN	TYI		013135'	
TSTBO2		006324'		TTPUTC		006177'		TTYPH2		014654'		TYI940		013215'	
TSTDRU		011636'		TTSCL1		016163'		TTYPH3		014652'		TYIALT		013237'	
TSTKTJ		013677'	EXT	TTSCL2		016136'		TTYPH4		014642'		TYIATB		013162'	
TSTKTP		013450'	EXT	TTSCL3		016164'		TTYPHY		014630'	INT	TYIBRK		013227'	
TSTTRJ		000000	EXT	TTSCLR		016123'	INT	TTYPTY		003222'	INT	TYIBSP		013231'	
TT2CHK		000010	SPD	TTTCL1		016173'		TTYRES		006717'	INT	TYIC		013167'	
TTCCLR		015056'		TTTCL2		016175'		TTYRHT		017121'		TYICC		013252'	
TTCCNT		010167'	INT	TTTCLR		016167'	INT	TTYRS1		006737'		TYICCP		013250'	
TTCDO1		015065'		TTUNEG		007061'		TTYSET		007152'	INT	TYICZ		013243'	
TTCFIL		015141'		TTUUOT		007066'		TTYSOW		014625'	INT	TYID		013172'	
TTCFIN		015070'		TTVIN2		014536'	EXT	TTYSRC		014563'	INT	TYIEAT		013264'	
TTCFL0		015146'		TTVINI		016404'	EXT	TTYSTC		014230'	INT	TYIET2		013335'	
TTCFL1		015147'		TTYAT1		015422'		TTYSTR		014233'	INT	TYIET3		013334'	
TTCGO		015131'		TTYAT2		015430'		TTYSZS		006437'		TYIL		013270'	
TTCHKS		000004	SPD	TTYATC		020000	SIN	TTYTAB		020135'	EXT	TYIOS1		015354'	
TTCLST		016445'	EXT	TTYATI		015416'		TTYTBL		014763'	INT	TYIOS2		015356'	
TTCMCA		017026'	INT	TTYATT		015407'	INT	TTYUS0		014214'		TYIPAL		013235'	
TTCMCH		017025'	INT	TTYBCN		012333'	INT	TTYUS1		014221'		TYIPDP		013206'	
TTCNEG		010162'		TTYBMT		001007'	INT	TTYUSM		014213'	INT	TYIRPT		013157'	
TTCNO		015054'		TTYBNP		001315'	INT	TTYUSR		014210'	INT	TYITAB		013224'	
TTCSET		015057'		TTYBPN		001032'	INT	TTYUSW		014207'	INT	TYMTC		010521'	
TTCSIX		015106'		TTYCMR		014225'	INT	TTYUU1		007036'		TYMTC1		010522'	
TTCTYP		015114'		TTYDET		015341'	INT	TTYUU2		007042'		TYMTC2		010544'	
TTCVAL		015072'		TTYERP		014571'	INT	TTYUU3		007052'		TYO		013343'	
TTCVL0		015100'		TTYFLK		017037'	INT	TTYUUO		007023'	INT	TYO1		013351'	
TTCVL1		015101'		TTYFLM		006076'	INT	TTYWAK		016066'	INT	TYO2		013361'	
TTCVL2		015102'		TTYFND		014560'	INT	TTYWK1		016105'		TYO3		013373'	
TTCVL3		015103'		TTYFNU		014557'	INT	TTYWK2		016072'		TYOW		013377'	
TTCWDD		015017'		TTYFUW		014606'	INT	TTYWK3		016101'		TYOW1		013407'	
TTCWDN		000035	SPD	TTYFW1		014607'		TTYYLS		016300'	INT	TYOW2		013410'	
TTCWDT		014762'		TTYHLT		014250'	INT	TTYZAP		015372'		TYOW3		013413'	
TTFORC		014046'		TTYIN		006344'		TTYZNE		001310'	INT	TYOW4		013414'	
TTFREE		016444'	EXT	TTYIN1		006366'		TTYZP1		015377'		TYP.00		000000	
TTFREN		017017'		TTYIN3		006374'		TUUAIR		040000	SPD	TYPANS		000001	SPD
TTGC1		006173'		TTYIN5		006354'		TUUATI		400000	SPD	TYPAUX		000007	SPD
TTGETC		006152'		TTYIN6		006405'		TUUATO		200000	SPD	TYPAXC		000030	SPD
TTIEND		016467'	INT	TTYIN8		006402'		TUUATR		100000	SPD	TYPBIN		000046	SPD
TTINI2		016371'		TTYINI		016354'	INT	TUUEAT		010000	SPD	TYPBKO		000044	SPD
TTINI3		016435'		TTYINX		006403'		TUUFXI		004000	SPD	TYPBOC		000045	SPD
TTINI4		016461'		TTYKD1		015315'		TUUIMI		002000	SPD	TYPBRK		000057	SPD
TTKJOB		006664'	EXT	TTYKDB		015254'		TUUROM		020000	SPD	TYPCLP		000042	SPD
TTNCHR		000001	SIN	TTYKIL		015237'	INT	TWABT		013716'		TYPCLR		000043	SPD
TTNEGL		000005	SPD	TTYLOS		017134'		TWAITC		013664'		TYPEAD		000061	SPD
TTNESC		000000	SIN	TTYLST		000250'		TWAITL		013621'		TYPECF		000035	SPD
TTNLIN		000002	SIN	TTYMXL		033000	SIN	TWAITS		013662'		TYPECN		000034	SPD
TTNYLB		000006	SIN	TTYNAM		014670'	INT	TWTC1		013701'		TYPEDC		000014	SPD
TTOUT1		006462'		TTYNFB		012462'	INT	TWTC2		013714'		TYPETM		000023	SPD
TTOUT2		006472'		TTYNFR		015751'	INT	TWTL1		013646'		TYPGOB		000012	SPD
TTOUT3		006500'		TTYNNC		006174'	INT	TWTL2		013655'		TYPGRN		000016	SPD
TTOUT4		006507'		TTYNPB		003674'	INT	TWTL3		013652'		TYPHNG		000022	SPD
TTOUT5		006510'		TTYOUS		006527'		TWTSPC		200000	SPD	TYPHSI		000041	SPD
TTPC1		006231'		TTYOUT		006445'		TYCIOS		015351'	INT	TYPIHR		000053	SPD
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91 PAGE 258-10
SCNSER.MAC	25-JAN-91 22:40		SYMBOL TABLE

TYPINB		000047	SPD	WATLIN		003323'		ZBGOUT		004465'		
TYPINE		000050	SPD	WRAPR	700200	000000		ZBGPC		004461'		
TYPINT		000051	SPD	WRDOT2		004177'		ZRPCNT		017072'		
TYPIRQ		000052	SPD	WRDOUT		004161'		ZZ	000055	576645	SPD	
TYPKAF		000063	SPD	WRIO	713000	000000		ZZ0		000002	SPD	
TYPLAD		000062	SPD	WRP3N4		000301'		ZZBIT		000043	SPD	
TYPLDC		000015	SPD	WRPCH2		000300'		ZZN		000002	SPD	
TYPLOG		000006	SPD	WRPCHR		000277'		ZZPOS		000000	SPD	
TYPLOS		000025	SPD	WRPLIN		000276'		ZZWORD		000001	SPD	
TYPLTM		000024	SPD	WSCHED		014735'	EXT	%CHBRK		000002	SPD	
TYPNEG		000056	SPD	WSYNC		014617'	EXT	%CHRMX		000036	SPD	
TYPNOP		000010	SPD	WSYNC1		013764'		%FRAUX		000001	SPD	
TYPNSP		000005	SPD	WSYNC2		013763'		%FRBIG		000002	SPD	
TYPOHR		000055	SPD	WSYNCS		013740'		%FRBRK		000004	SPD	
TYPORG		000021	SPD	WTCHK		004712'		%FRCMD		000003	SPD	
TYPORQ		000054	SPD	XA		000002	SIN	%FRFUL		000006	SPD	
TYPOUP		000011	SPD	XCTLUP		012304'		%FRNBK		000005	SPD	
TYPPSR		000060	SPD	XMTWAK		006126'		%FROK		000000	SPD	
TYPRAK		000004	SPD	XMTWK1		006146'		%MS0		774000	SIN	
TYPRED		000017	SPD	XPNOUT		006520'		%MS1		775000	SIN	
TYPRES		000003	SPD	XXCBLK		015324'		%PBTIM		000017	SPD	
TYPSAD		000033	SPD	XXCDDB		015322'		.ARATT		000007	SIN	
TYPSHT		000002	SPD	XXCSER		015323'		.ARDET		000010	SIN	
TYPSUP		000026	SPD	XXNBLK		015327'		.ARHNG		000054	SIN	
TYPSUR		000027	SPD	XXNDDB		015325'		.ASIDL		000000	SPD	
TYPTCP		000037	SPD	XXNSER		015326'		.ASLOG		000005	SPD	
TYPTCR		000040	SPD	XXPBLK		015332'		.ASRQ1		000001	SPD	
TYPTCS		000036	SPD	XXPDDB		015330'		.ASRQ2		000003	SPD	
TYPTRN		001073'		XXPSER		015331'		.ASWPT		000006	SPD	
TYPTSP		000031	SPD	XXQ		000000	SPD	.ASWR1		000002	SPD	
TYPTSR		000032	SPD	XXXQ		000007	SPD	.ASWR2		000004	SPD	
TYPYEL		000020	SPD	XXXR		000000	SPD	.ASWTP		000007	SPD	
TYPZAP		000013	SPD	YELLOW		001265'		.CPDWD		014357'	EXT	
U		000005	INT	YELLW1		001300'		.CPTIA		016362'	EXT	
UBABIO		013622	SPD	YLBUG		000000	SPD	.CPTOA		016364'	EXT	
UBAEND		000000	EXT	ZAPAL1		011754'		.PVHCN		000002	SIN	
UBANXT		000000	EXT	ZAPALL		011752'		.RTMCO		000002	SPD	
UMOVE	704000	000000		ZAPAUX		011235'		.RTMCU		000001	SPD	
UMOVEM	705000	000000		ZAPBG0		004500'		.RTMSV		000000	SPD	
UPARPT		005525'		ZAPBG1		004516'		.RTMUS		000003	SPD	
UPASC		005526'		ZAPBUG		004477'		
UPDKEY		000513'	INT	ZAPCIR		011742'	INT	
UPOPJ		003552'		ZAPDFR		001304'		
UPSHUT		017030'		ZAPLOG		001305'		
UPTIME		000627'	EXT	ZAPLPT		017137'		
USRWAK		005774'		ZBGBIT		004466'		
USRWK1		006000'		ZBGBUG		004460'		
UUIDPB	102000	000000		ZBGBYT		004467'		
UUILDB	101000	000000		ZBGDCH		004463'		
UUOLDB		013554'		ZBGDCX		004471'		

SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

A	   621
ABTUUO	   112%	  5301	  5379	  5443	  5743	  5746	  5751	  5893	  5913	  7029	  7137	  8612	  8614	  8625
	  8631	  8789	  8943	  8950	  9119	  9122	  9158	 10913
ACBBP	  6518	  6844#
ACBRKC	  6475	  6927#
ACBSPC	  6643	  6757#
ACDEFC	  6645	  6776#
ACERAC	  6644	  6768#
ACHNG	  6512	  6910#
ACIN1	  6936#	  6938
ACIN2	  6939#	  6953	  6959
ACINSC	  6465	  6944#
ACINWB	  6466	  6955#
ACINWC	  6464	  6935#
ACNTB	  6485	  6824#
ACNZP	  6525	  6869#
ACOTCI	  5826#	  6468
ACPSM	  6513	  6920#
ACPTPC	  6651	  6794#
ACSFS	  6516	  6885#
ACSOB	  6520	  6898#
ACSOX	  6521	  6855#
ACSYL	  6474	  6892#
ACTBK	  6486	  6833#
ACTCLA	  6653	  6818#
ACTCN	  6523	  6548#
ACTCP	  6524	  6558#
ACTCP1	  6564	  6567#
ACTCP2	  6566	  6577#
ACTMC	  6476	  6477	  6478	  6479	  6480	  6481	  6482	  6483	  6484	  6487	  6488	  6489	  6507	  6508
	  6509	  6510	  6511	  6514	  6515	  6517	  6527	  6528	  6529	  6530	  6531	  6876#
ACTTYP	  6656	  6807#
ACTWRT	  7594%	  7594	  7604%	  7604
ACWIDC	  6640	  6747#
ADRERR	    95%	  5312
ADVBFE	    95%	  5413	  5431
ADVBFF	    95%	  5332
ADVPTR	  3600#	  3650	  3668
AL	   621
ALR620	    81%	  4875	 10187	 10208	 10222	 10228
ALROPR	  4874	 10186
ALRSNT	 10209	 10220	 11485#
ARSTAB	  7240	  7242#
ASSCON	  5640	  6417	  7134	  7167	  7187	  7583	 10274	 10362	 10444	 10695	 10730	 10801	 10829
ASSPRG	  7134	 10274	 10362	 10801
AUXCHR	  7369	  7391#
AUXCLP	  7399#	  7405
AUXDET	  7461	  7463	  7466	  7471#
AUXDRU	  7547	  7554#
AUXEND	  7504	 11489#
AUXERR	  7285	  7458	  7569	  7599	 11491#
AUXGA1	  7532#	  7537
AUXGAN	  7511	  7526#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

AUXGV1	  7596	  7607#
AUXINP	  7312	  7327#
AUXJOB	  7289	  7473	 11492#
AUXLIC	  7519	  7521	  7523	  7528	  7540#
AUXNSB	  7495	  7496	  7498#
AUXNTB	  7531	  7532	  7533	 11350#	 11364
AUXNTL	  7530	 11364#
AUXPRT	  7328	  7381	  7383	  7394	  7472	  7555	 11499#
AUXRCP	  7194	  7196	  7232	  7286	  7331	  7459	  7571	  7587	  7605	 11486#
AUXRED	  7614#
AUXRID	  7134#	  8636	  8916	  8925	  9124	  9151
AUXRL1	  7621#	  7624	  7626	  7631
AUXRL2	  7627	  7631#
AUXRN1	  7619	  7622	  7632#
AUXSLP	  7486#	  7498
AUXSTA	  7230	  7235	  7239	  7254	  7259	  7282	  7288	  7304	  7307	  7310	  7359	  7387	  7420	  7426
	  7567	  7608	 11487#
AUXSTL	    45#	   507	  2130	  7219	  7353	  7484	 11488
AUXSTM	    44#	    45	  7477
AUXSTP	  7257	  7399	  7409	 11490#
AUXSTR	  7256	  7351	  7476	  7482	  7483	  7484	 11488#
AUXTIM	  7366	  7368	  7370	  7371	  7386	  7419	 11500#
AUXTMP	  7374#	  7418
AUXTMR	  7373#	  7385
AUXTOV	  7361	  7425#
AUXTU0	  6442	  6445#
AUXTU1	  6457	  6461#
AUXTUU	  6428#	  6444
AUXUNM	  7478	  7480	  7481	  7512	  7513	  7529	 11501#
AUXWAK	  7275	  7288#
AUXWPC	  7320	 11494#
AUXWPN	  7319#	  7330
AUXWPT	  7321	 11495#
AUXWSC	  7316	 11493#
AUXWST	  7306	  7313	  7315#
AUXZAP	  5295	  7211#
AUXZPT	  7317	  7322	  7324#
AXAVAL	   105%	  7610
AXCCNT	  6437	  6537#	  6544
AXCDON	  7400	  7411	  7417#
AXCLEN	  6435	  6532#	  6537	  6544
AXCLP1	  7396#	  7415
AXCLP2	  7404	  7407#
AXCTAB	  6438	  6464#	  6532
AXELOG	  7598#
AXERGV	  7517	  7525	  7535	  7546	  7570	  7575	  7581	  7597#
AXGIV	  7456	  7598	  7605#
AXNRL	  7435	  7436	  7441#
AXNRR	  7431	  7433	  7438#
AXREQ	   105%	  7453	  7609
AXSFIN	  7491	  7502#
AXSFN1	  7487	  7500#
AXSNTB	  7360	  7364#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

AXSWT	   105%	  7455
AXTOTB	  7427	  7429#
AXWAIT	   105%	  7454
AXZP1	  7212	  7220#
B	   621	  1676
BADGUY	  3682	 11458#
BADKEY	  1103	  1133	  1299	 11566#
BADPR1	  1381#	  1409
BADPRT	  1380	  1396#
BASDWN	  1128%	  1128	  1247%	  1247	  1267	  1297%	  1297	  4843%	  4843
BASE	  1140#
BASE04	  1139#
BASEOK	  1344	  8491#
BASTIM	  4837	  4837#	  4838	  4838#	  4840
BASVER	  1298%	  1298	  1565	  4829	  8490%	  8490	  8529%	  8529
BBCNTS	  8238	  8288	 11368#
BBCRE	  8235	 11510#
BBFREE	  8210	  8246	  8249	  8278	 11509#
BBPAGE	  8230	  8233	  8294	  8295	 11369#
BBPOOL	  8250	 11512#
BBREL	  8296	 11511#
BGCTYP	  5092%	  5092
BIOANS	 11513#
BIOATT	  8616	  8630#
BIOBUF	  8107	  8241	  8266	 11508#
BIOCHG	  4888	  4966#
BIOCHK	  7797	  7824	  7852#
BIOCHR	  1648	  1705	  1720	  1735	  3196	  3272	  3353	  3404	  3430	  3474	  3476	  3477	  3489	  4011
	  4977	  7716#	  7764	  7810	  7837	  7872	  7951	  7981	  8647
BIOCNT	  3384	  8063	  8071	  8083	  8090	  8093	  8098	  8100	 11503#
BIOCOR	    92%	  8212	  8267
BIOCSH	  7712#
BIODAT	  3406	  3491	  4026	  7717#
BIOJOB	 11498#
BIOLNK	  7711#
BIOPBC	  3200	  3258	  3356	  3388	  3405	  3435	  3490	  3502	  3523	  7714#
BIOPBP	  3198	  3255	  3408	  3493	  3503	  3530	  7713#
BIOPRT	 11506#
BIOREL	  5530	  5627	  7775#	 10406
BIOREQ	  3471	  3472	  3473	  7715#	  7908	  7912	  7914	  7935
BIORES	  7751	  7767	  7776	  7788	  7792#
BIOWAK	  1652	  4979#
BIOZAD	  3970#
BIOZAP	  1915	  7783#
BITNTB	    81%	  2957
BK2IOS	   653#	  5621	  9070
BKTOPN	  6227	  6233#
BLKEOF	  7802	  7829	  7846#
BLKEOT	  1498	  1669#
BLKIB1	  1647#	  1677	  1681	  1697
BLKIB2	  1652#	  1683
BLKIB3	  1661#	  1736
BLKIBF	  1497	  1638#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

BLKICK	  1640	  1671	  1689	  1718#
BLKIHR	  1502	  1728#
BLKINP	  6493	  7797#	  7821
BLKINS	  6494	  7824#
BLKIO	  6492	  7721#	  7730	  7736
BLKIO1	  7727	  7732#
BLKIO2	  7725	  7739#
BLKIP1	  7805	  7808	  7811	  7819#
BLKIRQ	  1706	  7915	  7937	  7943#
BLKITM	  1499	  1687#
BLKNEG	  1506	  1761#
BLKOH1	  1751	  1753	  1757#
BLKOHR	  1494	  1505	  1745#
BLKOT1	  7963	  7967#
BLKOUT	  6495	  7958#	  7966
BLKTRQ	  1678	  8645	  8657#
BLKX1	  7753	  7760#	  7778	  7780
BLKX2	  7761	  7766#
BLKXI1	  8644	  8651#
BLKXIN	  6496	  7762	  8640#
BLKXIO	  6498	  7747#	  7756
BLKXOT	  6497	  7779	  8668#
BLKXT1	  8676	  8680#
BPAVAL	   107%	  8065	  8202
BPFCOM	  9215	  9228	  9238	  9241	  9243#
BPFTYI	  8689	  9219#
BPLVD	  6122	  9206#
BPLVD1	  9208	  9211#
BPOFF	  4925	  6198	  9236#	  9444
BPOKBN	   333#	  3020
BPREQ	   107%	  8064	  8091	  8159	  8177	  8201	 11188
BPTEST	  6197	  9251#	  9443	  9449
BPWAIT	   107%	  8178
BPXOFF	  4200	  5255	  7857	  9235#	  9450
BSLASC	  4739	  4740#
BUFCLR	    95%	  5311
BUFLST	  8251	  8256	  8275	  8277	 11502#
BV.DBG	  4828	  8487#
BV.HDN	  8488#
BYP1	   829#	   852	   861	  1266	  1268
BYP2	   830#	   853	   856	   862	   866	  1270	  1934	  3628	  4029	 10229
BYP3	   831#	   854	   867	  1266	  1268	  4027
BYP4	   832#	   855	   857	   868	   869	  1266	  1268	  4012	 10223
BYTTC	  6639	  6641	  6642	  6646	  6647	  6648	  6649	  6650	  6652	  6654	  6692#
CCASC	  4721	  4722#	  4725
CCPTR	  2888	  2891	  4721#
CCTYI	  9314#	 11192
CCTYI1	  9316	  9322#
CCTYO	  9304#	  9525	  9534	  9986	  9991	 11194
CHCNT	  3015	  3072	  3211	  3256	  3451	  3480	  3505	  3506	  3521	  3587	  3768	  4529	  4535	  4551
	  4599	  4616	  4708	 11463#
CHECKU	  5046	  5076#	  5130
CHGCLK	   105%	 10449	 10629
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

CHKBAS	  1118#
CHKCHR	 11036	 11058#
CHKLIN	  6067	  6075#	  6087	  6094	  6099
CHKLN2	  5946	  6074#	  6130
CHKLOS	 11040	 11051#
CHKPSP	 11043	 11084#
CHKRM1	  8932	  8941#
CHKRM2	  8949#	  8956
CHKRM3	  8935	  8954#
CHKROM	  5381	  5758	  6443	  8931#
CHKSEG	    97%	  6085
CHKTCC	 11046	 11091#
CHKYEL	 11044	 11109#
CHPECH	   883#	  2354	  4184
CHPINP	   879#	  1973	  2815
CHPOUT	   880#	  4570
CHPRED	   882#	  8703	  8814	  9340
CHPSPE	   886#	  2380	  4359
CHPSPI	   885#	  2571	  2825
CHPSPO	   881#	  4621
CHPSPR	   884#	  8725	  8824	  9355
CHQTA	  3014	  3071	  3257	  3452	 11464#
CHRCNT	  6233	  6244	  6257#
CHRML1	  1936#	  1938
CHRML2	  1959#	  1962
CHRML3	  1939	  1962#
CHRMLT	  1384	  1931#
CHRRDP	  1935	  1936	  1959	 11478#
CHRTAB	   889#	  1971	  1972	  2814	  4182	  4183	  4568	  4569	  8701	  8702	  8812	  8813	  9339
CHRTRP	  2030	 10866#
CHRWRP	  3180	  3199	  3215	  3254	  3514	  3629	  3651	  3669	  3670	  3766	  4527	  4533	  4549	  4597
	  4614	  4706	 11479#
CIMTAB	  1974	  1979#
CKATI1	  8998	  9011#
CKATI2	  8991	  8995#
CKATIW	  8999#	  9013
CKATO1	  9027	  9034#
CKATO2	  5745	  9020	  9024#
CKATTF	  5404	  5422	  8920#	  8927	  9892
CKATTI	  5300	  5442	  5750	  8788	  8989#	  9009	  9121	  9144
CKATTO	  5378	  5742	  9018#	  9033
CKLGO	 10198#
CKLN1	  6076	  6080#
CKLNTR	 11037	 11068#
CKOPR	 10184	 10190#
CKSXON	  9431	  9449#
CLKJOB	 10448%	 10448	 10628%	 10628
CLKRSP	  1491	  1858#
CLNOC	  4093	  4119#
CLNOCP	  4101	  4118#
CLRIM1	  6188	  6192#
CLRIMI	  5384	  5812	  5829	  5837	  5877	  5897	  5925	  6187#
CLRMLT	  1940#	  1966
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

CLRPTY	  3876	  3882#
CLRTTY	  3684	  3863#	  8567
CLSCHR	  3079	  3582#	  3689	  3746	  3777	  3796	  3819	  3994	  4047	  4128	  7378	  7391	  8448	 10212
CLSLP1	  3229#	  3235
CLSLP2	  3238	  3241#
CLSPBF	  3259	  3272#
CLSPTB	  3213	  3246#
CLSPTL	  3088	  3210#
CMDCKW	  4151%	  4151
CMDTYO	  5936	  8888#	  9310
CMDWAK	  2539	  4241	  9262#	  9432
CMDWK1	  9263	  9266#
CMFCHT	  5036%	  5036
CMFCKM	 11241%	 11241
CMFCXI	  9829%	  9829	 11238%	 11238
CMFCXN	  2181%	  2181
CMFSTA	  2864%	  2864
CNCCHK	  2877	  5023#	  8777
CNCCK1	  5027	  5035#
CNCMD1	  9423	  9442#
CNCMOD	  5035	  9441#	 10479	 10659
CNTCHR	  6263	  6267	  6276#	  6281
CNTECO	  4174#	  4198
CNTOUT	  4094#	  4104
CNTPRT	  1387#	  1398	  1401	  1404	  1407
CNTRUB	  4067#	  4077
COASC	  4735	  4736#
COM940	  9360	  9361	  9372#
COMATB	  9341	  9349#
COMATT	  6423	 10452	 10632	 10704	 10747#
COMBSP	  9370	  9378	  9385#
COMGMS	  1867%	  1867
COMKJB	  5587%	  5587
COMPA	  9376	  9390#
COMPDP	  9359	  9362	  9364#
COMTAB	  9369	  9377	  9380#
COMTI1	  9337#	  9343
COMTI2	  9344#	  9358	  9383	  9388	  9393
COMTYI	  9326#
COMTYO	  5723	  9298#
COMTYT	  9326	  9330#
COMWCM	  9281%	  9281
COMXON	  3760	  3766#	  3788	  3812
CONFIG	    84%
CONMES	  1172%	  1172	  2187%	  2187	  2193%	  2193	  9809%	  9809	  9812%	  9812
COPTR	  2699	  2702	  4735#
CPERR	  6314	  6320	  6331	  6337#
CPNPT%	  6309#	  6313
CPNRM%	  6310#	  6319	  6330
CPOPJ	    87%	  1537	  1712	  1758	  1836	  1919	  2095	  2786	  3619	  4692	  4966	  5097	  5366	  5374
	  5595	  5620	  5753	  5786	  5817	  5900	  5928	  6081	  6083	  6433	  6826	  6835	  6846	  6871
	  7143	  7643	  7838	  8085	  8427	  8465	  8511%	  8511	  8672	  8720	  9040	  9210	  9223	  9240
	  9305	  9404	  9421	  9425	  9579	  9859	  9861	  9948	 10272	 10308	 10329	 10343	 10787	 10871
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

	 10879	 10895	 10922	 10950	 11026	 11028	 11121	 11143
CPOPJ1	    87%	  3585	  3630	  3655	  3674	  4156	  4158	  4163	  4510	  4515	  4537	  4618	  4705	  4714
	  4718	  5136	  5159	  5290	  5599	  5730	  5930	  6072	  6335	  6354	  6578	  6621	  6696	  6709
	  6748	  6753	  6760	  6764	  6769	  6772	  6777	  6785	  6789	  6795	  6803	  6809	  6814	  6821
	  6977	  6985	  7362	  7364	  7634	  7814	  7841	  7859	  7918	  8010	  8066	  8072	  8123	  8130
	  8188	  8321	  8398	  8407	  8415	  8633	  8699	  8706	  8710	  8940	  8994	  9023	  9333	  9347
	  9518	  9832	  9864	  9872	  9942	  9950	  9985	 10027	 10165	 10166	 10171	 10199	 10201	 10210
	 10232	 10371	 10453	 10816	 10833	 11074
CPUF3	  1261	  1342	  7451	  9461	  9620	  9630	  9664	  9681	 11275
CPUKI	  1328	  1760	  1765	  4038	  7450	  8047	  8062	  8086	  8089	  8494	  8511	  9461	  9620	  9630
	  9664	  9681
CPUKL	  1328	  1760	  1765	  3943	  3973	  4980	  7450	  7944	  8047	  8062	  8086	  8089	  8180	  8494
	  8511	  9463	  9659	  9716
CPUKS	  1342	  3954	  4837	  7451	  9462	  9659	  9691
CPUTYP	  1261	  1328	  1342	  1760	  1765	  3943	  3954	  3973	  4038	  4837	  4980	  7450	  7451	  7944
	  8047	  8062	  8086	  8089	  8180	  8494	  8511	  9461	  9462	  9463	  9620	  9630	  9659	  9664
	  9681	  9691	  9716	 11275
CPZZ	  1261#	  1261	  1328#	  1328	  1342#	  1342	  1760#	  1760	  1765#	  1765	  3943#	  3943	  3954#	  3954
	  3973#	  3973	  4038#	  4038	  4837#	  4837	  4980#	  4980	  7450#	  7450	  7451#	  7451	  7944#	  7944
	  8047#	  8047	  8062#	  8062	  8086#	  8086	  8089#	  8089	  8180#	  8180	  8494#	  8494	  8511#	  8511
	  9461#	  9461	  9462#	  9462	  9463#	  9463	  9620#	  9620	  9630#	  9630	  9659#	  9659	  9664#	  9664
	  9681#	  9681	  9691#	  9691	  9716#	  9716	 11275#	 11275
CREAUX	  7453#
CREPTY	  6312#
CRLF	  1177%	  1177	  1440%	  1440	  2998%	  2998
CRPTR	  2370	  4483	  4591	  4646	  4725#
CRSHWD	  1118	  1123	  1142%	  1142	  4854%	  4854	  5603%	  5603
CSINVL	  3954%	  3954
CTEXT1	 10133%	 10133	 10142%	 10142
CTY	    63#
CTYBLF	  1240	  9454#	  9467	  9469
CTYBUF	  9592%	  9592
CTYCHR	  9471	  9481	  9496	  9557	  9566	  9679	  9692#
CTYDO	  4830%	  4830
CTYFIL	  9487	  9561	  9564	 11517#
CTYFLN	  9473	  9489	  9497	 11518#
CTYFRM	  9485	  9492#
CTYINP	  1242%	  1242
CTYLDB	   346#	   522	  1239	  5077	  5677	  8972	  9306	  9457	  9533	  9802	  9879	  9978	  9980	  9989
CTYLOG	  9479	  9554	  9585#
CTYMSK	  9591%	  9591
CTYNFL	  9488	  9499#
CTYOCH	  9697
CTYOVL	  9698
CTYOWD	  9462%	  9462	  9694%	  9694	  9699%	  9699
CTYPTR	  9589%	  9589	  9590%	  9590
CTYSFL	  9489#	  9493
CTYTY1	  9565#	  9567
CTYTYL	  9578#	  9581
CTYTYO	  9544	  9552#	  9580
CTYTYP	  9577#
CUASC	  4727	  4728#
CUPTR	  2694	  2697	  4727#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

CX2AX%	  7123#	  7524
CXDCB%	  7125#	  7580
CXDTP	  7451#	  7471
CXERR%	  7129#	  7266
CXLOG%	  7124#	  7516	  7534
CXNCH%	  7128#	  7574	  7603
CXNRL%	  7127#	  7441
CXNRR%	  7126#	  7438
DATE	  1868%	  1868	  7228%	  7228	 11326%	 11326	 11341%	 11341
DBYT	  5287#
DCL	  5292#
DCLBBP	   629#	 10767
DCLCOM	   632#	  5585	 10645
DCLNTB	   631#	 10758
DCLTBK	   630#	 10763
DDBBLK	   634#	  7158	 10276	 10284	 10288	 10292	 10299	 10792	 10799
DDBCNE	 10311#
DDBDCH	   606	   607	   608	   609	   611	   628#	  5586	 10646	 10756	 10815
DDBLDB	   635#	  5317	  5402	  5554	  5596	  5623	  5689	  6432	  6886	  7174	  7205	  7211	  7214	  7462
	  7590	  7625	  7642	  7654	  7686	  8632	  8912	  8921	  8990	  9019	  9862	 10200	 10260	 10273
	 10337	 10338	 10440	 10462	 10589	 10621	 10674	 10710	 10750	 10826	 10934	 10981	 11029	 11120
	 11157
DDBSR1	  6412	  7159	  7579	 10688	 10786#	 11233
DDBSRC	 10434	 10785#	 10824
DDBTRP	   582	   583	   584	   585	   586	   587	   588	   589	   590	   591	   592	   593	   636#	 10809
	 10810	 11012	 11013
DDINT	  5286#
DDPBBP	   606#	  6847
DDPCOM	   611#	  5560	 10342	 10602
DDPIMB	   609#	  6931	 10754
DDPMOD	   610#	  1675	  1694
DDPNTB	   608#	  6827
DDPNZP	   612#	  6869	  6872
DDPTAB	   580#	   595	   599	   600	   601	   602	 11024	 11027
DDPTBK	   607#	  6836
DDPTCG	   592#	  1528
DDPTCH	   583#	   600	 10872	 10974	 10976	 10989	 10991
DDPTLC	   587#	  1839	  2082
DDPTLN	   584#	   601	  1655	 10883	 10977	 10979	 10986	 10988
DDPTOB	   588#	   602	 10923	 10983	 10985
DDPTPS	   590#	  1882
DDPTSC	   582#	   599	 10897	 10909
DDPTTC	   593#	  6614
DDPTTI	   585#	  7025	  8610	  8621	  8898	  8944	  8954	  9001	  9028	  9117	  9140
DDPTTS	   586#	  5104
DDPTYB	   591#	  1617
DDPTZP	   589#	  5572	  7185	 10728
DDTIN	  5441#
DDTINL	  5450#	  5456
DDTINX	  5451	  5453	  5457#
DDTOUT	  5463#
DDXZ	  5285#
DEBUGF	  1269%	  1269
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

DECBC	  1713	  1756	  7794	  8077#
DECBC1	  8094	  8102	  8106#
DECBC2	  8109#	  8113
DECBC3	  8110	  8114#
DECIN1	 10117%	 10117	 10164%	 10164
DECPBC	  8079	  8098#
DEFBRK	  2244#	  2293
DEFCHR	  2243#	  2283	  2302
DEFNBK	  2245#	  2548	  2557	  2567
DETALL	  1252	  8554#
DETON1	  8565	  8568#
DETONE	  8542	  8555	  8561#
DEVBUF	  5319	  5397
DEVCLS	   627#
DEVIAD	  5310	  5313	  5329
DEVIOS	   610	  1680	  1693	  1838	  2081	  4159	  4919	  4955	  4960	  4995	  5002	  5011	  5101	  5108
	  5336	  5387	  5389	  5394	  5416	  5434	  5574	  5622	  6103	  6189	  6439	  6887	  7024	  7173
	  7222	  7224	  7847	  8652	  8770	  8870	  8920	  8958	  8989	  9005	  9007	  9018	  9084	  9093
	  9131	  9160	  9162	  9176	  9178	  9188	  9200	  9407	  9863	  9897	  9904	  9908	 10258	 10358
	 10361	 10770	 10814	 10931	 11051	 11129
DEVLOG	 10253	 10803
DEVLST	 10306%	 10306
DEVMOD	   612	  1921	  5029	  5543	  5638	  6418	  6420	  7135	  7141	  7164	  7166	  7168	  7586	  7623
	  7652	  7684	  8635	  8915	  8924	  8993	  9022	  9150	 10275	 10297	 10356	 10363	 10445	 10696
	 10703	 10713	 10797	 10802	 10830	 10951	 10972
DEVNAM	  5555	  7171	  7220	  9949	 10252	 10339	 10441	 10680	 10711	 10828	 10841	 10842	 10853
DEVOAD	  5395
DEVOPR	    91%	  3825	  3867	  9915	 10190	 11247
DEVSER	 10277	 10282	 10286	 10290	 10295	 10302	 10309	 10788	 10790	 10791	 10794	 10949
DFRZAP	  1628	 11550#
DHNG	  5290#
DIDPBI	  3178	  3193	  3212	  3449	 11561#
DIE	    16	    16%	    17	  1139	  1140	  1386	  1409	  1632	  1641	  2976	  3402	  3574	  3913	  3970
	  4842	  5050	  5069	  5081	  5156	  5176	  8085	  8247	  8491	 10311
DIN	  5294#
DINI	  5289#
DINITF	  1105%	  1105
DLRSUP	   654#	  5621	  9056
DOOUT	  1455	  1543#
DOU	  5293#
DR1BIT	  7549	  8467#	  8474
DR2BIT	  7550	  8468#	  8476
DR3BIT	  7551	  8469#	  8478
DR4BIT	  7552	  8470#	  8480
DRDOW	  8343	  8347	  8352	 11379#
DRFLAG	  8346	  8473#
DRL	  5291#
DRMANS	  1320	  8387	  8389	  8393	  8596	  8599	 11376#
DRMBRK	  8339	  8371	  8373	  8377	 11375#
DRMCLP	  8379	  8381	  8385	  8589	  8592	 11377#
DRMHSI	  8351	  8355	  8357	  8361	 11373#
DRMSHT	  1318	  8363	  8365	  8369	  8601	  8604	 11374#
DRMTIM	  4857	  8396	  8409	  8420	  8532	  8577	 11378#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

DRZAP	  8542#	  8548
DSPSIZ	  5285	  5296#
DVIN	   621
DVNZP	  5637	  7163	  7585
DVOUT	   621
DVRMT	 10298	 10355	 10952	 10971
DVSIZ	  5288#
DVTTY	   621	  7620	  7651	  7685	 10298	 10798	 10952
DWNFLG	  3837	  3879	  5604	 11516#
DZAP	  5295#
E1IDPB	  4259	  4313	  4332	  4526#
E2IDPB	  4273	  4302	  4508	  4532#
EAC10A	  4279	  4282#	  4306	  4355
EAC10B	  4285#	  4296
EAC11A	  4301	  4304#
EAC14A	  4229	  4231	  4339	  4342#
EAC15A	  4230	  4350	  4353#
EAC4A	  4228	  4267#
EACT1	  4213	  4236#
EACT10	  4215	  4216	  4278#
EACT11	  4225	  4226	  4300#
EACT12	  4214	  4215	  4216	  4318	  4324#	  4331	  4333
EACT13	  4219	  4220	  4221	  4330#
EACT14	  4219	  4221	  4338#
EACT15	  4220	  4349#
EACT16	  4223	  4247#
EACT17	  4224	  4225	  4226	  4317#
EACT1A	  4241#	  4255
EACT1B	  4238#	  4269	  4275
EACT2	  4213	  4252#	  4260
EACT3	  4218	  4259#
EACT4	  4218	  4265#
EACT5	  4223	  4273#
EACT6	  4214	  4291#
EACT6A	  4292	  4295#	  4307	  4312	  4314	  4326	  4344
EACT7	  4224	  4311#
EATTAB	  8815	  8818#
ECHBAK	  4192#	  4237	  4248	  4266	  4281	  4294	  4320	  4341	  4352	  4472	  4482
ECHLST	  4197#	  4240	  4284
ECHRPT	  4180	  4185#	  4391	  4396	  4401	  4406	  4437	  4442	  4459	  4464
ECHSPA	  4204	  4358#
ECHSPT	  4360	  4362#
ECHT12	  4205	  4206	  4213#
ECHT34	  4207	  4208	  4218#
ECHT56	  4209	  4210	  4223#
ECHT7	  4211	  4228#
ECHTAB	  4186	  4204#
EDEC	  1458	  1579#
ENTRUB	  2041	  2436	  2439	  2481#	  2505	  2756	  2758	  2762	  2771	  4512
EPCOU1	  4496	  4519#	  4526	  4532
EPCOUT	  4236	  4247	  4265	  4280	  4293	  4319	  4340	  4351	  4518#
ERRBNG	 11515#
ERRXIT	  7267	  7273	  7279	  7285#	  7439	  7442
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

ESCTR1	  8776	 10906#
ESCTRP	  2868	 10890#
F	   582	   583	   584	   585	   586	   587	   588	   589	   590	   591	   592	   593	   606	   607
	   608	   609	   610	   611	   612	  1518	  1519	  1525	  1526	  1615	  1616	  1643	  1674	  1680
	  1691	  1693	  1722	  1737	  1738	  1757	  1758	  1835	  1836	  1838	  1880	  1881	  1918	  1919
	  1921	  1949	  1950	  2078	  2079	  2081	  2176	  3068	  3069	  3573	  4154	  4155	  4157	  4158
	  4159	  4884	  4907	  4919	  4953	  4955	  4960	  4966	  4993	  4994	  4995	  5002	  5011	  5026
	  5027	  5029	  5090	  5096	  5097	  5101	  5108	  5310	  5313	  5317	  5319	  5329	  5336	  5365
	  5366	  5387	  5389	  5394	  5395	  5397	  5402	  5416	  5434	  5540	  5541	  5543	  5554	  5555
	  5574	  5586	  5594	  5595	  5596	  5619	  5620	  5622	  5623	  5638	  5830	  6082	  6083	  6089
	  6090	  6101	  6102	  6103	  6187	  6188	  6189	  6321	  6325	  6418	  6420	  6428	  6432	  6439
	  6607	  6612	  6613	  6618	  6886	  6887	  7024	  7135	  7141	  7157	  7158	  7162	  7168	  7171
	  7172	  7173	  7174	  7183	  7184	  7202	  7203	  7205	  7211	  7214	  7220	  7222	  7224	  7460
	  7461	  7462	  7586	  7590	  7591	  7623	  7625	  7639	  7642	  7652	  7654	  7684	  7686	  7847
	  8632	  8635	  8652	  8767	  8768	  8770	  8870	  8912	  8915	  8920	  8921	  8924	  8958	  8989
	  8990	  8993	  9005	  9007	  9018	  9019	  9022	  9084	  9093	  9131	  9150	  9160	  9162	  9176
	  9178	  9182	  9186	  9188	  9200	  9273	  9274	  9275	  9276	  9277	  9283	  9405	  9406	  9407
	  9860	  9861	  9862	  9863	  9887	  9897	  9904	  9908	  9941	  9948	  9949	 10198	 10199	 10200
	 10248	 10252	 10253	 10258	 10260	 10272	 10273	 10275	 10276	 10277	 10279	 10282	 10284	 10302
	 10303	 10304	 10337	 10338	 10339	 10356	 10358	 10361	 10363	 10414	 10437	 10438	 10439	 10440
	 10441	 10442	 10445	 10450	 10462	 10586	 10589	 10606	 10612	 10613	 10621	 10646	 10665	 10669
	 10674	 10680	 10696	 10703	 10709	 10710	 10711	 10713	 10747	 10750	 10751	 10756	 10770	 10786
	 10787	 10788	 10789	 10791	 10792	 10794	 10799	 10802	 10803	 10809	 10810	 10814	 10815	 10826
	 10828	 10830	 10832	 10841	 10842	 10853	 10870	 10871	 10878	 10879	 10894	 10895	 10921	 10922
	 10927	 10931	 10934	 10943	 10947	 10949	 10950	 10951	 10960	 10972	 10981	 10998	 11012	 11013
	 11029	 11051	 11120	 11129	 11137	 11139	 11141	 11142	 11143	 11156	 11157	 11158	 11160	 11162
FARCHK	 10550%	 10550	 10567%	 10567
FCREQ	   106%	  8161	  8213	  8216	  8218	  8262
FCS	   656#	  5621	  9064
FCWAIT	   106%	  8217
FDRUPX	  5494%	  5494
FFFLP	  2456	  4667	  4743#
FFLP0	  4743	  4744#	  4746
FILERS	  4761	  4762	  4763	  4766	  4767	  4768	  4771	  4772	  4773	  4776	  4777	  4778	  4793#
FINLIN	  3050#	  3482	  3527	  3561	  3685	  3709	  3751	  3769	  3861	  3957	  3971	  3989	  3990	  4085
	  4112	  4199
FINOUT	  2947	  3082	  3092	  3102#
FIXIMI	  5305	  6173#	  6888
FLGCHR	 10873
FLGESC	 10898	 10910
FLGLIN	 10884
FLLBSC	  2700	  2701	  2854	  2889	  2890	  4739#
FLLFFS	  4670	  4760#
FLLVTS	  4680	  4765#
FLMX	  4761	  4762	  4763	  4766	  4767	  4768	  4771	  4772	  4773	  4776	  4777	  4778	  4793	  4801
FMTB	  3713	  3718	  3725	  3733	  3738	  3746#	  4057	  4146
FMTB1	  3748#	  3782	  3801	  4052	  4135
FNDPRT	  6430	  7640	 10587	 10666	 11137#	 11163
FNDPT1	 11138	 11143#
FPOPJ	  9275	  9277	  9283#
FRCCGB	  1525#	  3311
FRCDOO	  1544#	  3337	  3415
FRCEOT	  1671#	  3357
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

FRCIBF	  1640#	  3273
FRCIHR	  1730#	  3391
FRCINP	  6491	  6962#
FRCITM	  1689#	  3436
FRCLOS	  1831#	  3567	  3571
FRCLP0	  6966#	  6969
FRCLP1	  6975#	  6979
FRCLP2	  6983#	  6988
FRCNOO	  1536#	  3279	  3330	  3359	  3439
FRCOHR	  1750#	  3481	  3525	  3537	  8678
FRCORG	  1596#	  3321
FRCRS1	  7016#	  7034
FRCRS2	  7022	  7035#
FRCRS3	  7054#	  7061
FRCRS4	  7055	  7074#
FRCRS5	  7066	  7081#
FRCRS6	  7069	  7077	  7082	  7085#
FRCRS7	  7086	  7089#
FRCRSC	  6522	  6999#
FRCRSX	  7003	  7008	  7014	  7095#
FRCYEL	  1605#	  3368
FRCZAP	  1641	  1898#	  3559	  8566
FREBUF	  1643	  1663	  1674	  1691	  1711#	  1738
FRECHK	  4069	  4096	  5201#	  8692	  8803	  9477
FREST	  5048#	  5054
FRETTY	 10301	 10303	 10786	 10789	 11476#
FREUP	  4083	  5046#	  5235	  5237	  5261
FRMASN	  2177%	  2177	  9825%	  9825	 11225%	 11225
FRMKJF	  2194%	  2194	  9828%	  9828
FRSDEF	  7041	  7043	  7085	 11563#
FRSFLG	  7037	  7039	  7060	  7075	  9262	  9264	 11562#
FRSTTY	  7150	  7518	  7618	  7647	  7680	 10349	 10929	 10947#	 10969	 11000
FSCN	  1341	  3102	  3104	  3588	  3646	  3664	 11459#
FULLCQ	  2686	  2739	  2779	  5014#
FULLIN	  3028	  3046	  3055	  3065	  3068#	  3532	  3690	  3708	  3747	  3778	  3797	  3820	  3941	  3964
	  4048	  4066	  4074	  4123	  4129	  4173	  4193	  4524	  4552
FULLN2	  3069	  3075#
FULLN3	  3075	  3086#
GBXLUP	  7892#	  7894
GEPM10	  6150	  6167#
GEPM11	  6152	  6168#
GEPM12	  6154	  6169#
GEPMC1	  6134	  6158#
GEPMC2	  6136	  6159#
GEPMC3	  6138	  6160#
GEPMC4	  6139	  6161#
GEPMC5	  6140	  6162#
GEPMC6	  6142	  6163#
GEPMC7	  6144	  6164#
GEPMC8	  6146	  6165#
GEPMC9	  6148	  6166#
GET4WD	    92%	  8214
GETBB	  8179	  8210#	  8219
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

GETBB1	  8211	  8249#
GETBBP	  8111	  8246#
GETBI	  7910	  7927	  8120#
GETBIO	  8120	  8127	  8170#
GETBO	  7967	  8127#
GETCHK	  2051	  2490	  5213#	  8890
GETCTY	  9871	  9879#
GETDDB	  9946#
GETLIN	  5795	  5945#
GETLNZ	  5947	  5977#	  6131
GETLOG	  6067#
GETLPS	  6094#
GETMC	  5787	  6129#
GETMOD	  6099#
GETPP	  6312	  6344#
GETPP1	  6345#	  6350	  6353
GINST	  5315#	  5315	  5316	  5326#	  5326	  5327	  5331#	  5331	  5332	  5369#	  5369	  5370	  5396#	  5396
	  5397	  5405#	  5405	  5406	  5445#	  5445	  5446	  5455#	  5455	  5456	  5458#	  5458	  5459	  5720#
	  5720	  5721	  5840#	  5840	  5841	  5879#	  5879	  5880	  5881#	  5881	  5882	  5889#	  5889	  5890
	  5899#	  5899	  5900	  5901#	  5901	  5902	  5903#	  5903	  5904	  5916#	  5916	  5917	  5917#	  5918
	  5929#	  5929	  5930	  5931#	  5931	  5932	  5935#	  5935	  5936	  5945#	  5945	  5946	  5974#	  5974
	  5975	  5977#	  5977	  5978	  6007#	  6007	  6008	  6054#	  6054	  6055	  6117#	  6117	  6118	  6428#
	  6428	  6429	  6434#	  6434	  6435	  6548#	  6548	  6549	  6549#	  6550	  6552#	  6552	  6553	  6565#
	  6565	  6566	  6572#	  6572	  6573	  6576#	  6576	  6577	  6825#	  6825	  6826	  6834#	  6834	  6835
	  6845#	  6845	  6846	  6861#	  6861	  6862	  6870#	  6870	  6871	  6877#	  6877	  6878	  6880#	  6880
	  6881	  6966#	  6966	  6967	  6975#	  6975	  6976	  6983#	  6983	  6984	  7010#	  7010	  7011	  7050#
	  7050	  7051	  7056#	  7056	  7057	  7067#	  7067	  7068	  7097#	  7097	  7098	  7486#	  7486	  7487
	  7615#	  7615	  7632#	  7632	  7633	  7676#	  7676	  7677	  7696#	  7696	  7697	  7698#	  7698	  7699
	  7932#	  7932	  7933	  7969#	  7969	  7970	  7980#	  7980	  7981	  9984#	  9984	  9985	  9990#	  9990
	  9991	 10543#	 10543	 10544	 10544#	 10545
GIV4WD	    92%	  8269
GOBCH1	  1524	  1528#
GOBCH2	  1526	  1529	  1531#
GOBCHR	  1456	  1518#
GOBIN	  3112	  3940#
GOBIO1	  3940	  3963	  3994#
GOBIO2	  3956	  3988	  4009#
GOBOP	  3116	  3962#
GOBOT	  3125	  3963#
GOBOT3	  3967	  3972#
GOBPF	  3115	  3774#
GOBPN	  3114	  3792#
GOBPN1	  3793	  3796#
GOCGB	  3111	  3717#
GOECO	  3129	  4167#
GOFIL	  3122	  4543#	  4553
GOHNG	  3127	  3737#
GOHSH	  3109	  3680#
GOLIN	  3017	  3019#	  3040
GOLIN1	  3019	  3021	  3031#
GOLIN2	  3025	  3030#
GOLIN3	  3026#	  4170
GOOUT	  3124	  4090#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

GORUB	  3123	  4063#
GOSBL	  3121	  3755#
GOSEC	  3118	  3729#
GOSGR	  3130	  4139#
GOSOG	  3131	  4141#
GOSRD	  3117	  3712#
GOSTC	  3120	  3689#
GOSTC1	  3691#	  3706
GOSTP	  3119	  3722#
GOSYL	  3126	  4128#
GOTBF0	  7907	  7913#
GOTBF1	  7903	  7911	  7916#
GOTBUF	  7812	  7839	  7865#
GOTRI	  3113	  4056#
GOTRO	  3110	  4047#
GOXOFF	  3795	  3805#
GOXON	  3776	  3786#
GOZAP	  3128	  3815#
GREEN	  1460	  1583#
GTBIO1	  8176	  8179#
GTCGSZ	    96%	  5347
GTLCRD	  5965	  5988#	  5999
GTLDEF	  5989#
GTLECS	  5983#
GTLESC	  5956	  5987#
GTLFRM	  5995#	  6004
GTLHDX	  5953	  5986#	  5998
GTLLCT	  5973	  5992#	  6001	  6008
GTLLRD	  5971	  5972	  5991#
GTLMSK	  5950	  5981#
GTLNFC	  5990#	  6000
GTLOBS	  5958	  5985#
GTLPSP	  5962	  5984#
GTLPTP	  5994#	  6003
GTLTAB	  5993#	  6002
HIGHJB	    84%	  5608
HNGAL1	  5610#	  5615
HNGALL	  4855	  5511	  5603#
HNGAUX	  5539	  5544	  7183#
HNGAX1	  7185#	  7207
HNGAX4	  7195	  7198#
HNGAXD	  7184	  7192#	  7203
HNGJOB	  5513	  5592#	  5612
HNGMON	  5499	  5509#	  9436
HNGPRT	  5527#	  7645	  7657
HNGTT1	  5553	  5556	  5564#
HNGTT2	  5565	  5581#
HNGTT3	  5568	  5585#
HNGTTY	  1927	  5547	  5552#	  5598	 10720
HNGUUL	  5486	  5503#
HNGUUO	  5484#
HWDPNT	  1160%	  1160	  2993	  2997
I	   621	  1695	  5339	  5406	  6175	  6190
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

I1CHRW	  6060#	  6500
I1CHWL	  6039#	  6502
IAC10A	  2325	  2340#
IAC11A	  2348#	  2514
IAC11B	  2317	  2342	  2350#
IAC11C	  2318	  2351#
IAC11D	  2349	  2352#	  2540
IAC16B	  2520	  2538#
IAC16C	  2529	  2539#
IACT0	  2001	  2006	  2011	  2016	  2570#
IACT1	  2002	  2281#
IACT10	  2009	  2014	  2337#
IACT11	  2012	  2346#
IACT12	  2014	  2509#
IACT13	  2017	  2518#
IACT14	  2018	  2524#
IACT15	  2019	  2533#
IACT17	  2019	  2543#
IACT2	  2003	  2287#
IACT21	  2017	  2555#
IACT22	  2018	  2561#
IACT2A	  2291#	  2310
IACT3	  2004	  2297#
IACT4	  2004	  2306#
IACT5	  2007	  2314#
IACT5A	  2316#	  2333
IACT6	  2008	  2013	  2322#
IACT7	  2009	  2328#
IB	   621
ICH0	  6044	  6057#
ICS1	  6023#	  6027	  6035
ICW1	  6050#	  6058
ICW1A	  6029	  6049#	  6065
ICW1B	  6037	  6048#
IDLNEC	  2691	  2694#
IFDET	 10370#
IFROOM	  5713	  5933	  8968#	  9308
IGOBEC	  2675	  2699#
IMGCH1	  5354	  5362#
IMGCHG	  2256	  4910	  5358	  5363#
IMGCNT	  2242	  2271	  5352#
IMGDEF	  1980	  2237#
IMGDIM	    52#	  2238	  2252	  2267
IMGIT2	  1679#	  1739
IMGITM	  1678#	  1696
IMGRM1	  2262	  2273	  2276#
IMGRMA	  1981	  2251#
IMGRMT	  1982	  2266#
IMGTIM	    53#	  9163
INCBC	  7739	  8040#
INCHRS	  5791	  6021#	  6501
INCHRW	  5789	  6061#
INCHSL	  5794	  6030#	  6503
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

INCHWL	  5793	  6040#
INCPBC	  8042	  8071#
INISET	  9799#
INISL2	  9817	  9831#
INISLP	  9814#	  9831
INLMES	  1149%	  1149	  1153%	  1153	  1157%	  1157	  1161%	  1161	  1168%	  1168	  1414%	  1414	  1418%	  1418
	  1422%	  1422	  1427%	  1427	  2990	  2994	  4846%	  4846
INPA10	  2574	  2577	  2579#
INPA94	  2575	  2576	  2597#
INPACT	  2572	  2574#
INPAL1	  2609	  2665#
INPBK2	  2592	  2610	  2644	  2661#	  2780
INPBRK	  2583	  2586	  2587	  2588	  2590	  2591	  2593	  2598	  2600	  2602	  2613	  2616#	  2666	  2687
	  2740	  2863	  2895
INPBS1	  2612	  2631#
INPBSP	  2594	  2629#
INPCH	  2748	  2764	  2789	  2810	 11461#
INPCH2	   855#	  1438	  1844
INPCHR	   854#	  1435	  1830	  1845	  1874	  7253	  7264	  7272	  7278	  7327
INPCLD	  2605	  2658#
INPDL1	   856#	  1861
INPDL2	   857#	  1564	  1638	  1669	  1687	  1728	  1858	  8533	  8578
INPDLN	  2584	  2601	  2686#
INPES0	  2878	  2893#
INPES1	  2876	  2895#
INPESC	  2580	  2604	  2606	  2667	  2868#
INPEST	  2885	  2888#
INPGOB	  2582	  2611	  2671#
INPLIN	   853#	  1378	  1432	  8534	  8579
INPOTP	  2676#	  2692	  2855	  2886
INPRA1	  2829#	  2852
INPRAC	  2821	  2825#
INPRB1	  2608	  2631	  2739#
INPRB2	  2742	  2854#
INPRB3	  2807	  2809#
INPRB4	  2800	  2810#
INPRB5	  2817#	  2830
INPRB6	  2754	  2759#
INPRB7	  2747	  2761#
INPRB8	  2760	  2767	  2771#
INPRB9	  2751	  2768#
INPRBC	  2741	  2781	  2785#
INPRET	  2581	  2599	  2648#
INPRT2	  2779#
INPRTA	  2826	  2832#
INPRTB	  2816	  2821#
INPRUB	  2589	  2629	  2737#
INPSTA	  2595	  2861#
INPTAB	  2585	  2603	  2621#
INPTCA	  2643#
INPTYP	   852#	  1377	  1429	  1947
INRW1	  6062#	  6064
INTERM	  2099	  2168	  3836	  3878	 11187	 11474#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

INTSET	 11030	 11035#
INWL1	  6041#	  6047
IO	  5393	  9004	  9159	  9175	  9896	  9907
IOACT	  4160	  4996	  5001	  5010	  5112	  5415	  5433	  9006	  9161	  9175	  9189	  9397	  9896	  9907
	 10357	 10360
IOBEG	  5385
IOBKTL	  1692	  1837	  2080	 11052
IODEND	  7846	  7855	  8651
IOEND	  1679	  4918	  5302	  6042	  7801	  7828	  7846	  7900	  8649	  8769	  9108
IOFST	  5335	  5393	 10257	 10812
IONEOU	  5802	  5827#	  6467
IOSBKA	   647#	  5621	  9068	  9092	  9130
IOW	  4999	  5001	  9397	 10357	 10360
IPOPJ	    87%
IPOPJ1	    87%	 10719	 10722	 10732
IQUEUE	  7734	  7819	  8610#
IRING	    83%	   852	   853	   854	   855	   856	   857	  1373	  1933	  1943	  8489	 11322
IRP620	    83%	  1124	  1155	  1254	  1339	  1348	  1360
IRPLO1	 11325	 11329#
IRPLOG	  1353	 11322#
IRPMB1	  1358	  1361	 11454#
IRPMB2	  1356	  1359	 11455#
IRPMB3	  1357	 11456#
IRPMP1	  1365	  1367	 11451#
IRPMP2	  1363	  1366	 11452#
IRPMP3	  1364	 11453#
IRPMS2	  1369	  1372	 11449#
IRPMS3	  1370	 11450#
IRPMSG	  1371	  1374	  1942	 11448#
IRPOLD	  1125	  1256	 11567#
IRPPDP	    83%	  1253	  1338	  1389	  1420	  1424
IRPSTP	  1349	  1351	 11565#
IRPTIM	  1234%	  1234	  1343%	  1343	  1347%	  1347	  4833%	  4833	  4839%	  4839	  4850%	  4850
J	  1520	  1521	  1527	  1926	  5105	  5109	  5110	  5111	  5346	  5348	  5490	  5497	  5498	  5504
	  5545	  5546	  5552	  5564	  5597	  5619	  5697	  6084	  6409	  6415	  6429	  6608	  6617	  7148
	  7157	  7161	  7162	  7169	  7289	  7457	  7460	  7473	  7510	  7514	  7515	  7526	  7577	  7582
	  7607	  7868	  7976	  8613	  8624	  8630	  8775	  8902	  8941	  8942	  9047	  9048	  9051	  9278
	  9279	  9280	  9282	  9840	  9859	  9860	  9998	  9999	 10010	 10011	 10015	 10016	 10018	 10198
	 10446	 10448	 10450	 10467	 10493	 10556	 10561	 10573	 10578	 10581	 10585	 10605	 10611	 10612
	 10628	 10685	 10693	 10708	 10736	 10831	 10832	 10947	 10955	 11137	 11146	 11154	 11156	 11251
	 11252	 11260	 11261	 11262	 11264	 11269
JACCT	  5033
JACCT2	  5033
JBTABT	    81%	  7457	  7607
JBTAUN	  7526%	  7526
JBTAWQ	    82%	  8613	  8624	  8630	  8902	  8942	  8996	  9025
JBTBCS	    82%	  5348	  5349
JBTBET	    82%	  4968	  4969
JBTBIO	    82%	  7868	  7869	  7976	  7977
JBTCIN	    82%	  1952	  1953
JBTCOT	    82%	  3073	  3074
JBTLIC	    82%	  5504	  5697	  7148	  7510
JBTPIP	   112%	 11154
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

JBTPRV	    88%
JBTSTS	    88%	  1521	  5032	  5683	 10493	 10556	 10573
JBTUN1	    81%	  7515
JBTUNM	    81%	  7514
JBYEXC	 10966%	 10966	 10968%	 10968
JBYWAK	 10963%	 10963	 10965%	 10965
JERR	 10495
JFYMIN	  1108%	  1108
JFYSEC	    91%	  1865	  4836%	  4836
JLOG	  1522
JNA	  5680	 10555	 10572
JOB	    89%	  6429	  8775	  9840
JOBN	    84%	  5592	  5682
KAF1	  1109#
KEPBI	  7905	  8154#
KEPBI1	  8157	  8161#
KEY10	  1091#	  1096	  1101	  1132	  1171	  9540
KEY620	  1097%	  1097	  1131%	  1131	  1134%	  1134	  1170
KEYSET	  1097#	  9542
KEYTIM	  1099%	  1099	  1233%	  1233	  4832%	  4832
KMCCAC	  8541%	  8541
KMCDO	 11240%	 11240
KMCFLG	  8411	 11383#
KMCGAC	  8403%	  8403
KMCGAV	  8399%	  8399
KMCGUP	  7543	  8472%	  8472
KMCLAS	  8406	  8408	 11381#
KMCPDP	  8410	  8414	 11382#
KMCRST	  8345%	  8345
KMCSHT	  8595	  8601#
KMCSUP	  8585%	  8585
KSNOCH	  5304	  5304%	  5383	  5444	  5811	  5828	  5838	  5878	  5898	  5926	  6021	  6030	  6040	  6061
	  6105	  6935	  6944	  6955	  7858	  7961	  8046
L2LBBP	   404#	  2636	  2849	  4456	  4461	  5632	  6221	  6224	  6848	  6850	  8755	  8838	  9385	 10766
	 10768
L2LBSP	   411#	  2746	  4688
L2LCCS	   402#	  2046	  2874	  2898	  5253
L2LDEL	   407#	  2036	  2046	  2678	  2761	  3317	  4142	  5253
L2LLDF	   406#	  4154	  4991	  5857	  6120	  6902	  9268
L2LNTB	   405#	  2445	  2452	  2459	  4432	  4446	  5628	 10759	 10760
L2LOEX	   399#	  5423	  9035	 10936
L2LOWS	   409#	  3366	  4132	  4933
L2LOWT	   412#	  1598	  1899	  3364	  3543	  3815	  4130	  4929	  4948	  5098	  5270
L2LTBK	   403#	  2622	  2839	  4434	  4439	  5630	  6837	  6839	  8749	  8837	  9380	 10762	 10764
LAPBIT	   336#	  3022
LDB.HI	  5080	 11246	 11572#
LDB.LO	  5079	 11197	 11571#
LDBBIO	   358#	  1647	  1704	  1718	  1732	  1750	  1914	  3194	  3251	  3351	  3382	  3400	  3428	  3462
	  3466	  3469	  3470	  3486	  3499	  3545	  3817	  3942	  3966	  4975	  5927	  7724	  7750	  7763
	  7766	  7775	  7799	  7826	  7962	  8122	  8129	  8135	  8137	  8143	  8145	  8148	  8158	  8175
	  8200	  8205	  8643	  8646	  8671	  8931
LDBBK2	   372#	  2060	  2301	  2309	  2330	  2339	  2513	  2537	  2547	  2721	  2724	  2725	  2728	  2824
	  2829	  4268	  4343	  4354	  5242	  5871	  5969	  6234	  6247	  8719	  9101	 11076
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

LDBBKC	   370#	  2059	  2290	  2324	  2526	  2564	  4253	  4325	  5241	  5872	  5967	  6236	  6245	  8711
	  8774	  8784	  8840	  9099	  9430	 11077
LDBBKI	   362#	  2035	  2055	  2291	  2300	  2332	  2340	  2512	  2528	  2536	  2546	  2565	  2708	  2717
	  2718	  2785	  2790	  2818	  2871	  5243	  6251	  8695	  8722	  8806
LDBBKP	   361#	  2056	  2292	  2341	  2527	  2566	  2705	  5244	  6250	  8694	  8697	  8805	  8808
LDBBYT	   397#	   530	   531	   532	   533	   534	   535	   536	   537	   538	   539	   540	   541	   542
	  1599	  1900	  2037	  2047	  2109	  2446	  2453	  2460	  2623	  2637	  2679	  2681	  2745	  2763
	  2827	  2850	  2875	  2899	  3318	  3365	  3367	  3544	  3816	  3925	  4131	  4133	  4143	  4155
	  4431	  4447	  4453	  4689	  4931	  4934	  4936	  4949	  4992	  5099	  5254	  5271	  5273	  5424
	  5629	  5858	  6121	  6161	  6215	  6219	  6387	  6903	  7337	  8750	  8756	  8826	  8827	  8878
	  9036	  9269	  9381	  9386	 10757	 10761	 10937
LDBCLA	   505#	   506	   567	  2124
LDBDCH	   432#	   552	   553	   554	   555	   556	   557	   558	   559	   560	   561	  1382	  1539	  1545
	  1576	  1581	  1747	  1908	  2123	  2672	  2882	  2883	  2965	  2978	  3005	  3173	  3249	  3277
	  3304	  3327	  3329	  3336	  3343	  3345	  3350	  3379	  3381	  3397	  3414	  3433	  3457	  3558
	  3730	  3755	  3775	  3780	  3786	  3799	  3807	  3808	  3810	  3920	  3985	  4050	  4883	  4893
	  4902	  4924	  5014	  5251	  5252	  5277	  5318	  5390	  5391	  5535	  5700	  5849	  5860	  5949
	  5966	  6173	  6178	  6180	  6194	  6196	  6287	  6290	  6398	  6459	  6558	  6598	  6778	  6782
	  6783	  6855	  6999	  7036	  7044	  7088	  7090	  7092	  7176	  7348	  7465	  8040	  8077	  8156
	  8174	  8198	  8563	  8674	  8763	  8842	  8845	  8882	  9011	  9041	  9076	  9077	  9079	  9095
	  9098	  9133	  9135	  9207	  9220	  9237	  9336	  9410	  9418	  9426	  9442	  9446	  9820	 10155
	 10403	 10483	 10615	 10651	 10656	 10701	 11058	 11068	 11091	 11218
LDBDCX	   467#	   563	   564	   565	   566	  1532	  1614	  1621	  1654	  1834	  1877	  2077	  2105	  2418
	  2632	  2752	  2862	  4119	  4423	  4816	  5110	  5954	  5959	  6400	  6611	  6898	  6901	  7350
	  7691	  7692	  8874	  8937	  8978	  9055	  9059	  9823	 10869	 10881	 10893	 10908	 10920	 11114
	 11223
LDBDDB	   348#	  1518	  1525	  1615	  1722	  1737	  1757	  1835	  1880	  1918	  1949	  2078	  2160	  3068
	  3573	  3921	  4157	  4884	  4993	  5026	  5090	  5096	  5365	  5540	  5557	  6082	  6089	  6101
	  6187	  6328	  6612	  7183	  7202	  7206	  7215	  7591	  8767	  9276	  9405	  9887	  9941	 10266
	 10344	 10438	 10596	 10751	 10870	 10878	 10894	 10921	 11142
LDBECC	   369#	  1572	  2027	  2058	  2245	  2710	  2716	  2731	  2798	  2801	  3183	  4167	  4197	  4242
	  4286	  4916	  5246	  5853	  6106	  6262	  6945	  6971	  9110	  9114	  9138	  9211	  9224	  9253
	 11061	 11072
LDBECT	   368#	  2054	  2276	  2352	  2437	  2714	  2803	  4174	  4177	  4192	  4505	  4523	  5245	  6261
LDBFLP	   379#	  4543	  4545	  4605	  4715	  5265
LDBLEN	   522#
LDBLIN	   349#	   527	   528	  1552	  1888	  1893	  3848	  3851	  3888	  3891	  3919	  3969	  4943	  7296
	  8171
LDBLOG	   384#	   525	  1557	  1563	  1901	  1902	  1911	  1931	  2090	  2094	  2116	  2167	  3547	  3556
	  3833	  3843	  3875	  3883	  3927	  5518	  5537	  6069	  6329	  6349	  6352	  6383	  7145	  7301
	  7333	  8564	  9815	  9819	 10203	 10331	 10396	 10465	 11160	 11217
LDBMOD	   420#	   544	   545	   546	   547	   548	   549	   550	  1568	  1662	  1701	  1731	  1754	  1879
	  1912	  3549	  3845	  3885	  3926	  4885	  5529	  5625	  5961	  6388	  6923	  7338	  7722	  7742
	  7747	  7769	  7784	  7793	  7803	  7830	  7852	  7898	  7948	  7958	  8186	  8640	  8658	  8660
	  8668	 10405	 11085
LDBOPB	   354#	  1540	  1547	  1585	  1592	  1601	  1625	  1749	  1906	  1965	  2044	  2066	  2086	  2159
	  2442	  2502	  2774	  3027	  3044	  3063	  3240	  3553	  3853	  3893	  3923	  4521	  4945	  4947
	  5278	  5419	  5822	  5892	  5920	  6125	  6299	  6741	  6788	  6982	  7954	  8009	  8663	  8681
	  8910	  9090	  9168	  9245	 10401	 10753	 11125	 11207
LDBOUT	   309	   310	   311	   312	   313	   314	   315	   316	   317	   318	   319	   320	   321	   322
	   323	   324	   325	   326	   327	   328	   329	   330	   331	   355#	  1898	  2155	  3016	  3039
	  3053	  3852	  3892	  3922	  6386	  7336
LDBRBC	   383#	  2487	  2493	  4063	  4076	  5247
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

LDBRBI	   381#	  2483	  2486	  2491	  4081	  5236	  5249
LDBRBO	   382#	  2492	  4067	  4070	  4073	  4082	  4084	  5248
LDBSTR	   507#	  2127	  2128	  2130	  7216	  7217	  7219	  7352	  7353
LDBTCB	   356#	  6401	  6563	  6570	  6604	 11096
LDBTIC	   367#	  2026	  2057	  2277	  2353	  2712	  2732	  2802	  3182	  4238	  4254	  4282	  4295	  4915
	  5240	  5340	  5450	  5854	  5865	  6107	  6266	  6946	  6970	  8686	  8687	  8798	  8799	  9097
	  9107	  9136	  9212	  9225	  9252	 11062	 11071
LDBTIP	   365#	  2031	  2034	  2052	  2707	  2788	  2791	  2797	  5234	  5238	  6249	  9315
LDBTIT	   366#	  2053	  5239	  6110	  6265	  8690	  8693	  8801	  8804	  9290
LDBTMR	   207	   208	   209	   210	   211	   212	   213	   214	   215	   216	   217	   218	   219	   220
	   221	   222	   223	   224	   225	   226	   227	   508#	  2141	  2142	  6395	  6396	  7345	  7346
LDBTMS	   237	   238	   239	   240	   241	   242	   243	   244	   245	   246	   247	   248	   249	   250
	   251	   252	   253	   254	   255	   256	   257	   509#
LDBTMT	   510#	  2153	  3691	  3701	  3707	  6296	  6391	  6732	  6737	  7339
LDBTOC	   377#	  1239	  4090	  4103	  4118	  5263	  5425	  8873	  8893	  8896	  8936	  8977	  9172	  9499
	  9882	  9893	  9979	  9980
LDBTOP	   375#	  5260	  5262	  8888	  8891	  8895
LDBTOT	   376#	  4094	  4097	  4100	  5264	  8892	  9475	  9478
LDBTYP	   506#	   568	  2126
LDEC	  1459	  1572#
LDICLE	   520#	 11204
LDICLR	   347#	 11201	 11202	 11203
LDLAUX	   449#	  1575	  1580	  1916	  2164	  3832	  3874	  4913	  5538	  5981	  6174	  6193	  7000	  7347
	  9042	 10616
LDLBK2	   443#	  5870	  5968	  8716	  9071	  9078	  9100	 11075
LDLBKA	   442#	  5016	  9069	  9078	  9094	  9132
LDLCOM	   441#	  2106	  2419	  2461	  2804	  2893	  4150	  4424	  4467	  4477	  5015	  5023	  5701	  5761
	  6446	  7005	  7040	  7089	  7175	  9012	  9266	  9409	  9427	  9445	  9818	 10482	 10650	 10655
	 10700	 10866	 10890	 11059	 11069	 11216
LDLDEF	   445#	  1574	  1579	  2106	  2122	  5981	  6397	  7042	  7087	  7347
LDLECS	   439#	  5250	  5848	  5981	  7091	  8794	  8841	  9417	  9441
LDLFRM	   454#	  2447	  2454	  4665	  4675	  5981
LDLIMI	   444#	  3756	  3794	  4892	  4923	  5308	  5344	  5866	  6041	  6176	  6177	  6192	  6458	  7347
	  9105	  9164	  9422	  9441
LDLLCP	   452#	  2108	  2121	  2362	  2415	  2429	  2433	  2447	  2454	  2465	  2676	  2806	  5981
LDLLCT	   450#	  2106	  2408	  2413	  2665	  4410	  4416	  5981	  8713	  8760	  8772	  9391
LDLNEC	   448#	  2805	  3731	  4278	  4291	  4300	  4311	  4317	  4330	  4338	  4349	  4468	  4478	  5981
	  6784	  7347	  9067	  9078	  9085
LDLNFC	   447#	  2365	  4587	  4641	  5981	  7347
LDLNOP	   436#	  1538	  1544	  1746	  1907	  3984	  4049	  5276	  5981	  8673	 10402
LDLOSU	   446#	  2671	  2881	  5386	  5859	  5981	  8883
LDLPTP	   453#	  2362	  2415	  2429	  2433	  2447	  2454	  2465	  2649	  2737	  5981	  6288	  6291
LDLPTY	   440#	  2975	  3002	  3832	  6397	  6559	  6596	  6856	  7464	  8041	  8078	  8155	  8173	  8197
	 11092
LDLSOX	   438#	  4565	  4587
LDLTAB	   451#	  2465	  4652	  5981
LDPBBP	   531#	  6844
LDPBSD	   563#	  6652
LDPBSP	   533#	  6759	  6761	  6771
LDPCHG	   545#	  5355	  5359	  5364
LDPCIE	   208#
LDPCLA	   567#	  6810	  6818	  6820
LDPCOM	   553#	  5559	 10601
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

LDPCRD	   211#	  5963
LDPDEM	   561#	  6776
LDPECH	   220#	  2769	  4454	  4691
LDPECO	   207#
LDPECR	   210#
LDPELF	   209#
LDPERA	   564#	  6757	  6763	  6768	  6770
LDPESC	   225#
LDPFA1	   540#
LDPFA2	   536#
LDPFC1	   539#	  2110	  4669	  4679	  6133	  6641
LDPFC2	   535#	  2112	  4658	  6135	  6642
LDPFRM	   559#	  6648
LDPHDX	   215#	  2119	  5951	  6149
LDPHST	   528#	  1567	  1903	  3548	  3844	  3884	  6385	  9822	 11220
LDPIMB	   549#	  2258	  4304	  4908	  5352	  6930	 10755
LDPIR	   212#	  6141
LDPKAT	   223#
LDPLCO	   565#	  6646
LDPLCT	   556#	  6649
LDPLMD	   546#	  6203
LDPLNO	   527#	  3591	  3702	  3748	  3855	  4009	  5948	  6360	  6371	  6380	  7178	  7588	  7628	  7697
	  9954	 10665	 10838	 11205
LDPMDF	   554#	  6201
LDPMEC	   547#	  4185
LDPMIN	   548#	  1969
LDPMOD	   534#	  2379	  2570	  2674	  2690	  2884	  4358	  8726	  8779	  9050	  9356
LDPMOU	   550#
LDPNFC	   555#	  6650
LDPNTB	   532#	  6824	  6828
LDPNXO	   560#	  6639
LDPOR	   213#	  6143
LDPPA	   216#	  6147
LDPPAR	   214#	  6145
LDPPB	   217#	  6151
LDPPC	   218#	  6153
LDPPD	   222#
LDPPOS	   542#	  2361	  2369	  2374	  2377	  2410	  2426	  2464	  2475	  4486	  4497	  4503	  4573	  4609
	  4613	  4637	  4645	  4649	  4651	  4693	  4695	  4819	  6096
LDPPSM	   544#	  1875	  6920
LDPPTP	   558#	  6794	  6796
LDPQM	   226#
LDPRTC	   566#	  6654
LDPRXE	   221#
LDPSOX	   552#	  6860	  6863
LDPSPA	   227#
LDPTAB	   557#	  6647
LDPTBK	   530#	  6833
LDPTIM	   541#	  2239	  2253	  2268	  3266	  3275	  3399	  4897	  4899	  9165
LDPTOB	   224#
LDPTYP	   568#	  6807	  6812
LDPWDA	   538#
LDPWID	   537#	  2114	  2364	  4585	  4640	  6137	  6390	  6747	  6752
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

LDPXON	   219#
LDRBIP	   466#	  3172	  3248	  3276	  3344	  3378	  3396	  3432	  3456	  4889	  4901
LDRBPS	   461#	  3779	  3798	  9206	  9219	  9235	  9236
LDRDEM	   464#	  3731	  6780	  6781	  9086
LDRFCS	   465#	  5016	  8762	  9065	  9078
LDRNXO	   463#	  3757	  3805
LDRXOS	   462#	  3326	  3335	  3774	  3806	  9206	  9219	  9235
LDSCIE	   238#	  2149
LDSCRD	   241#
LDSECH	   250#
LDSECO	   237#
LDSECR	   240#	  2151	  6294
LDSELF	   239#	  2148
LDSESC	   255#
LDSHDX	   245#
LDSIR	   242#
LDSKAT	   253#
LDSOR	   243#
LDSPA	   246#
LDSPAR	   244#
LDSPB	   247#
LDSPC	   248#
LDSPD	   252#
LDSQM	   256#
LDSRXE	   251#	   258
LDSSPA	   257#
LDSTOB	   254#
LDSXON	   249#
LEVDEF	  5784	  6120#	  6473
LICAC	  7147	  7509
LICOPR	  5698
LICWCR	  5503
LINFLG	    81%	  2955	 11198
LINFSV	  2961	  3097	 11472#
LINJOB	  6087#
LINPNM	  2963	  3096	 11471#
LINPTR	  2952	  2954	  3099	  3101	 11462#
LINTAB	    88%	  1381	  2964	  4882	  5516	  6079	  6348	  6351	  6362	  6368	  8562	  9814	  9940	 11141
	 11196	 11200	 11209
LINTRP	  2244	  2261	  2275	  2350	  4911	 10878#
LISTSN	     3	     6
LLLHDX	   392#	  2115
LLLNLN	   389#	  1910	  9818	 10398	 11216
LLLZAP	   388#	  1910	  5536	  7144	 10202	 10330	 10464	 11159
LMLBIO	   425#	  1661	  1755	  1913	  4886	  5528	  5626	  7721	  7741	  7748	  7768	  7792	  7853	  7959
	  8187	  8641	  8669	 10404
LMLPSP	   423#	  1878	  5960	  6922	 11084
LMLTBI	   422#	  1702	  1730	  7783	  7804	  7831	  7899	  7949	  8657
LNLZIN	   353#	  1553	  1889	  3849	  3889	  3968	  4942	  7297	  8170
LOGCH1	  2163	  2167#
LOGCH2	  2166	  2171#
LOGCHR	  1979	  2090#
LOGIN	  1452	  1552#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

LOGLDB	 10631%	 10631
LOGZAP	  1629	 11548#
LOPBIN	   312#	  7953
LOPBOP	   316#	  3495	  3536	  7785
LOPBOT	   325#	  8008	  8675	  8677
LOPBPF	   315#	   333	  9244
LOPBPN	   314#	  2065	  2069	  9209	  9222	  9239
LOPCGB	   311#	  5275
LOPECO	   329#	   335	  1964	  3024	  3239	  6124	  6981	  9167
LOPFIL	   322#	  4607	  4717
LOPHNG	   327#	  6911
LOPHSH	   309#	   333	   335	   336	 11222
LOPOUT	   324#	  5418	  5821	  5891	  5919	  8909
LOPRUB	   323#	  2043	  2441	  2501	  2773	  4514
LOPSBL	   321#	  2085
LOPSEC	   318#	  6787	  9089
LOPSGR	   330#	  1584	  1589
LOPSOG	   331#	   336	  1624	  6905	 11109	 11112
LOPSRD	   317#	  1591
LOPSTC	   320#	  2157	  6298	  6739
LOPSTP	   319#	  2158
LOPSYL	   326#	  5274	  6893	 10399	 11124
LOPTRI	   313#	  8662
LOPTRO	   310#	  8680
LOPZAP	   328#	  1536	  1905	  3680	  4946	  9274	 10400
LOS620	  2072	 11534#
LOSPDP	  2071	 11532#
LP.I8C	  9702
LP.PIA	  9701
LP.SSF	  9702
LPERDR	  1276#	  1278	  1280	  1281	  8434	  8435	  8437	  8545	  8546
LPOPJ	 10416	 10418#	 10435
LTSCIE	   518#	  2152
LTSCRD	   518#
LTSECH	   518#
LTSECO	   518#
LTSECR	   518#	  2152	  6295
LTSELF	   518#	  2152
LTSESC	   518#
LTSHDX	   518#
LTSIR	   518#
LTSKAT	   518#
LTSOR	   518#
LTSPA	   518#
LTSPAR	   518#
LTSPB	   518#
LTSPC	   518#
LTSPD	   518#
LTSQM	   518#
LTSRXE	   518#
LTSSPA	   518#
LTSTOB	   518#
LTSXON	   518#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

LXL120	   471#	  2104	  6399	  7349
LXLBSD	   473#	  2633
LXLDLR	   476#	  2417	  4422	  9057	  9058
LXLERA	   474#	  2753
LXLLCO	   477#	  4817
LXLOOK	   478#	  1620	  6899	 11113
LXLRTC	   481#	  2861
LXRBRK	   495#	  1653	 10880
LXRCGS	   501#	  1531
LXRCHR	   494#	 10868
LXRESC	   489#	  5955	 10892	 10907
LXRICL	   492#	  1833	  2076
LXRIOS	   502#	  5109
LXROBS	   490#	  5957	 10919
LXROCL	   493#	  1832
LXRPSS	   491#	  1876
LXRTCC	   503#	  6610
LXRYBS	   500#	  1613
M	  5445	  5463	  5809	  5810	  5826	  5827	  5839	  5840	  5879	  5889	  5899	  5901	  5916	  5917
	  5929	  5931	  5945	  5974	  5977	  6007	  6054	  6071	  6117	  6129	  6155	  6334	  6337	  6548
	  6549	  6552	  6565	  6572	  6576	  6825	  6834	  6845	  6861	  6870	  6877	  6880	  6921	  6927
	  6940	  6962	  6963	  6964	  6975	  6983	  7010	  7050	  7067	  7179	  7873	  7932	  7969	  7980
	  9975	  9976	  9984	  9990	 10604	 10737
MAKDET	  6499	  7140#
MAKDLC	  7149	  7151	  7153	  7155	  7157#
MAXDR	  1278#	  1290	  8431	  8435	  8437
MAXTMC	   260#	   265	  1846	  6706
MD0405	  1983	  1984	  2001#
MD0607	  1985	  1986	  2006#
MD1011	  1987	  1988	  2011#
MD1213	  1989	  1990	  2016#
MDFLMD	  2906#	  6202
MDRANS	  8380	  8387#
MDRBRK	  8364	  8371#
MDRCLP	  8372	  8379#
MDRL1	  8429	  8432	  8456	  8461#
MDRLUP	  8426#	  8462
MDRMSG	  1295	  8359	  8367	  8375	  8383	  8391	  8417#
MDRNXT	  8388	  8395#
MDRRET	  8449	  8451	  8463#
MDRSHT	  8356	  8363#
MDRUP	  1315	  8338	  8472#
MLOWQ	   105%	  7565	  9995
MLTNDB	  1932	  1950	  1954#
MONHNG	  9435#
MORLIN	  3036#	  3292	  3297	  3307	  3328	  3370	  3417	  3496	  3528	  3538	  3576	  3693	  3752	  3758
	  3770	  3809	  3958	  4064	  4086	  4091	  4113	  4168	  4201	  4546
MORLN2	  3018	  3023	  3044#	  3054
MOVCH1	  1974#	  2617	  2625	  2639	  2650	  2651	  2662
MOVCH2	  1971#	  2659
MOVCHR	  1937	  1960	  1969#	  2654	  3230	  6978	  6986	  7058
MSG777	  9602#	  9609	  9613	  9618	  9636	  9639
MSGBUF	  9601#	  9607	  9609	  9613	  9630	  9634	  9635	  9642
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

MSGIN1	  9617	  9619	  9634#
MSGINI	  9612#
MSGLG.	  9597#	  9607	  9615	  9637
MSGLGI	  9599#	  9640	  9657	  9658
MSGLGO	  9600#	  9641
MSGLGP	  9631	  9643	  9650	  9661	 11573#
MSGLGS	  9598#	  9616	  9638	  9660
MSGLOG	  9307	  9553	  9650#
MSGSIM	  3302#	  3312	  3322	  3331	  3338
MSKIRG	    83%	  1388	  1860
MSKORG	    83%	  3600	  3613	  3615	  3653	  3672	  3998	  4016	  7408	 10216	 10227
MULCNT	  2945	  2981	  3006	  3080	  3089	  3090	  3504	  3520	  3584	  3586	  3610	  3624	  3648	  3666
	  3767	  4528	  4534	  4550	  4598	  4615	  4707	  4870	 11481#
MXLIN	  4856%	  4856	  4880%	  4880	  6077%	  6077
MXMCNT	  3582	  3609	  3625	  3649	  3667	  7396	 11483#
MXTIM	  1231%	  1231	  1232%	  1232	 11191%	 11191
MXTYP	  1385	  1515#
NAMSC1	 10854#	 10859
NAMSC2	 10856	 10860#
NAMSCN	 10603	 10851#
NEWJER	  2178	  2184#
NEWTER	  2180	  2190#
NMXFLG	    81%	  2953
NMXLIN	 11199%	 11199
NOBASE	  4842#
NOCTRO	  5337	  5459	  5857#	  5874	  6023	  6055	  6942	  6952	  9428	  9433	  9451
NODIE	    16%	  1140	  1386	  1409	  1641	  2976	  3574	  3913	  3970	  4842	  5050	  5069	  5156	  8085
	  8491
NOECHO	   655#	  5621	  9066
NOLIN	  2982	  3007	  3081	  3091	  3096#
NOLIN2	  2956	  2959	  3099#
NOOUT	  1454	  1535#
NOTLIN	  3834	  3840#
NOTOPR	  3823	  3829	  3832#
NOXEXE	  9797#	  9803	  9806
NRPCNT	  7573	 11496#
NTTOPR	  3865	  3871	  3874#
NUMECO	   335#	  3030
NXTTTY	  5635	  7152	  7154	  7520	  7522	  7621	  7649	  7701	 10353	 10939	 10949#	 10993	 11015
NZAPAX	  7298	 11554#
NZAPIN	  1887	 11551#
NZAPLG	  1554	 11553#
NZAPN2	  1890	 11552#
NZAPOT	  3850	  3890	 11556#
NZAPRS	  4951	 11555#
OBFND	  1598#	  4939
OBFND1	  1599#
OBREC	  1596	 10919#
OMX120	  8875	  8938	  8979	 11538#
OMX30	  8876	  8939	  8980	 11536#
ONEOU2	  5818#	  5832
ONEOU3	  5820#	  5841	  5882	  9311
ONEOUT	  5790	  5810#	  5830
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

OP0TYO	  9512	  9539#
OP1TYO	  9512	  9528	  9532#
OP2TYO	  9512	  9522#
OPCRET	    76#	  5766	  6451
OPRCT2	  9468	  9473#
OPRCTY	  1241	  9457#
OPRFIL	  9474	  9495#
OPRFR1	 10011#	 10017
OPRFRE	  3826	  3868	  4111	  5268	  9501	 10007#
OPRLDB	  3822	  3824	  3864	  3866	  4110	  5267	  5695	  9524	  9977	  9987	  9992	 11248	 11468#
OPROUT	  5676	  9512#
OPRSN2	  9977#	 10001
OPRSND	  9975#
OPRTIC	  9455#	  9458	  9459	  9460
OPRTIM	  3831	  3873	  4871	  4872	 10185	 10193	 11189	 11475#
OPRWAT	  9981	  9995#
OPRWJB	  9997	  9999	 10007	 10009	 11519#
OPSND1	  9984#	  9988	  9993
OQUEUE	  7728	  7754	  7964	  8621#
ORANGE	  1463	  1595#
ORING	    83%	   861	   862	  1271	  1286	  3594	  3627	  3644	  3661	  4013	  7402	 10224
ORP620	    83%	  1119	  1151	  1258	  3611	  3614	  3999	 10217
ORPLO1	 11340	 11344#
ORPLOG	  1272	  1287	  3595	  3645	  4014	  7403	 10225	 11337#
ORPOLD	  1120	  1260	 11568#
ORPPDP	    83%	  1257	  1265	  1289	  1416	  3601	  3612	  3616	  3626	  3654	  3673	  3996	  7412	  7417
	 10214
ORPTIM	  1235%	  1235	  3602%	  3602
OUPLIN	   862#	  3592
OUPTYP	   861#	  3590
OUT	    95%	  5292
OUTCHI	  5803	  5809#	  6505
OUTPC1	  5903#	  5906
OUTPC2	  5905	  5909#
OUTPCF	  5907	  5912	  5916#	  5939	  5941
OUTPT1	  5881#	  5885
OUTPTC	  5897#	  6519
OUTPTR	  5804	  5877#	  6469
OUTSN1	  5933#	  5937
OUTSN2	  5934	  5940#
OUTSNW	  5925#	  6526
OUTST1	  5840#	  5844
OUTSTR	  5792	  5837#	  6506
OUTTRN	  3032	  3109#
OWK120	  4120	 11539#
OWK30	  4121	 11537#
OWTIM	    60#	  4878
P	    17	  1136	  1137	  1139	  1140	  1141	  1149	  1152	  1153	  1156	  1157	  1160	  1161	  1164
	  1165	  1167	  1168	  1176	  1241	  1242	  1252	  1272	  1287	  1295	  1300	  1305	  1315	  1322
	  1324	  1326	  1353	  1386	  1409	  1414	  1417	  1418	  1421	  1422	  1426	  1427	  1430	  1431
	  1433	  1434	  1436	  1437	  1439	  1440	  1454	  1455	  1456	  1457	  1458	  1459	  1462	  1463
	  1467	  1494	  1497	  1498	  1499	  1502	  1505	  1530	  1541	  1548	  1555	  1559	  1596	  1602
	  1619	  1622	  1626	  1631	  1632	  1640	  1641	  1652	  1656	  1664	  1671	  1678	  1682	  1689
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

	  1690	  1703	  1711	  1721	  1723	  1724	  1734	  1752	  1756	  1867	  1883	  1891	  1909	  1915	  1927
	  1928	  1937	  1960	  2030	  2032	  2033	  2039	  2041	  2045	  2048	  2049	  2051	  2061	  2083
	  2087	  2091	  2171	  2177	  2179	  2187	  2193	  2240	  2241	  2242	  2244	  2246	  2247	  2254
	  2255	  2256	  2257	  2261	  2269	  2270	  2271	  2274	  2275	  2278	  2281	  2282	  2287	  2288
	  2297	  2298	  2306	  2307	  2314	  2315	  2322	  2323	  2328	  2329	  2337	  2338	  2346	  2347
	  2350	  2351	  2363	  2367	  2375	  2376	  2398	  2400	  2402	  2405	  2409	  2416	  2421	  2427
	  2430	  2431	  2434	  2436	  2439	  2443	  2448	  2455	  2463	  2476	  2482	  2485	  2488	  2490
	  2503	  2505	  2509	  2510	  2518	  2519	  2524	  2525	  2533	  2534	  2539	  2543	  2544	  2555
	  2556	  2561	  2562	  2579	  2597	  2607	  2651	  2673	  2677	  2686	  2688	  2689	  2715	  2726
	  2729	  2733	  2738	  2739	  2741	  2743	  2756	  2758	  2762	  2771	  2775	  2779	  2781	  2782
	  2783	  2784	  2787	  2795	  2808	  2813	  2819	  2822	  2823	  2828	  2833	  2834	  2835	  2836
	  2837	  2838	  2841	  2842	  2843	  2844	  2845	  2846	  2848	  2851	  2868	  2872	  2877	  2879
	  2880	  2894	  2895	  2897	  2900	  2944	  2976	  2983	  2988	  2989	  2990	  2992	  2993	  2994
	  2996	  2997	  3045	  3064	  3079	  3088	  3105	  3170	  3171	  3188	  3189	  3201	  3202	  3217
	  3219	  3220	  3221	  3222	  3228	  3229	  3230	  3232	  3233	  3234	  3237	  3241	  3242	  3243
	  3246	  3247	  3267	  3268	  3273	  3278	  3279	  3280	  3302	  3303	  3305	  3306	  3319	  3341
	  3342	  3357	  3358	  3359	  3368	  3369	  3391	  3402	  3412	  3413	  3415	  3416	  3423	  3424
	  3425	  3426	  3436	  3437	  3438	  3439	  3440	  3442	  3443	  3444	  3445	  3446	  3454	  3455
	  3459	  3465	  3479	  3481	  3507	  3510	  3517	  3522	  3525	  3526	  3531	  3537	  3550	  3551
	  3554	  3555	  3559	  3560	  3567	  3568	  3569	  3571	  3572	  3574	  3593	  3595	  3596	  3618
	  3645	  3684	  3689	  3704	  3746	  3750	  3777	  3796	  3819	  3826	  3846	  3847	  3859	  3868
	  3886	  3887	  3894	  3913	  3914	  3918	  3934	  3935	  3940	  3954	  3956	  3963	  3970	  3988
	  3994	  3995	  4000	  4001	  4014	  4022	  4047	  4068	  4069	  4071	  4083	  4095	  4096	  4098
	  4108	  4111	  4122	  4128	  4144	  4162	  4169	  4175	  4200	  4236	  4241	  4247	  4259	  4265
	  4273	  4280	  4285	  4293	  4302	  4313	  4319	  4332	  4340	  4351	  4471	  4481	  4487	  4491
	  4500	  4501	  4508	  4512	  4519	  4530	  4536	  4610	  4685	  4696	  4842	  4844	  4846	  4851
	  4855	  4861	  4866	  4888	  4904	  4910	  4911	  4912	  4925	  4926	  4939	  4961	  4963	  4970
	  4978	  5003	  5004	  5005	  5006	  5007	  5008	  5012	  5017	  5018	  5024	  5025	  5035	  5037
	  5046	  5050	  5069	  5073	  5078	  5081	  5082	  5087	  5091	  5100	  5105	  5106	  5111	  5114
	  5130	  5151	  5156	  5176	  5177	  5191	  5194	  5201	  5207	  5208	  5227	  5235	  5237	  5261
	  5268	  5279	  5286	  5291	  5300	  5304	  5305	  5306	  5309	  5311	  5320	  5323	  5332	  5345
	  5347	  5350	  5360	  5378	  5381	  5383	  5384	  5398	  5401	  5404	  5410	  5413	  5420	  5422
	  5427	  5429	  5431	  5435	  5441	  5442	  5444	  5448	  5449	  5452	  5494	  5495	  5505	  5515
	  5521	  5522	  5527	  5530	  5531	  5558	  5573	  5576	  5577	  5581	  5587	  5588	  5593	  5598
	  5607	  5609	  5612	  5614	  5627	  5631	  5633	  5634	  5635	  5636	  5641	  5676	  5685	  5692
	  5704	  5708	  5711	  5713	  5716	  5717	  5718	  5720	  5723	  5728	  5729	  5737	  5742	  5745
	  5750	  5755	  5758	  5763	  5765	  5811	  5812	  5818	  5823	  5828	  5829	  5837	  5838	  5842
	  5850	  5855	  5861	  5873	  5877	  5878	  5883	  5897	  5898	  5904	  5912	  5921	  5925	  5926
	  5933	  5936	  5938	  5940	  5946	  5975	  5978	  6015	  6018	  6021	  6022	  6024	  6025	  6026
	  6028	  6030	  6031	  6032	  6033	  6034	  6036	  6039	  6040	  6045	  6046	  6049	  6060	  6061
	  6062	  6063	  6067	  6068	  6078	  6080	  6087	  6088	  6094	  6095	  6099	  6100	  6105	  6108
	  6109	  6111	  6118	  6122	  6126	  6130	  6156	  6179	  6191	  6195	  6197	  6198	  6204	  6217
	  6233	  6237	  6244	  6252	  6257	  6258	  6263	  6267	  6269	  6270	  6271	  6276	  6282	  6289
	  6300	  6312	  6316	  6318	  6323	  6324	  6326	  6338	  6347	  6363	  6402	  6403	  6412	  6413
	  6416	  6422	  6430	  6431	  6436	  6440	  6443	  6448	  6450	  6460	  6550	  6551	  6553	  6554
	  6560	  6561	  6562	  6574	  6577	  6590	  6592	  6593	  6594	  6597	  6600	  6605	  6606	  6607
	  6608	  6609	  6616	  6617	  6618	  6619	  6620	  6740	  6742	  6751	  6797	  6800	  6802	  6829
	  6857	  6858	  6859	  6864	  6865	  6873	  6878	  6881	  6885	  6900	  6924	  6932	  6935	  6936
	  6937	  6941	  6944	  6949	  6950	  6951	  6955	  6956	  6957	  6958	  6973	  6978	  6986	  7026
	  7028	  7031	  7032	  7033	  7035	  7045	  7052	  7054	  7058	  7065	  7074	  7093	  7096	  7098
	  7136	  7142	  7146	  7150	  7152	  7154	  7156	  7159	  7160	  7170	  7177	  7186	  7192	  7198
	  7204	  7213	  7233	  7267	  7273	  7275	  7279	  7287	  7299	  7303	  7324	  7355	  7378	  7379
	  7391	  7392	  7403	  7413	  7414	  7425	  7454	  7518	  7520	  7522	  7543	  7568	  7579	  7592
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

	  7594	  7595	  7604	  7606	  7611	  7616	  7618	  7621	  7640	  7641	  7647	  7648	  7649	  7650	  7657
	  7680	  7701	  7704	  7706	  7723	  7728	  7729	  7734	  7735	  7739	  7740	  7743	  7744	  7749
	  7754	  7755	  7762	  7765	  7770	  7779	  7786	  7787	  7797	  7798	  7806	  7807	  7812	  7819
	  7820	  7824	  7825	  7832	  7833	  7834	  7835	  7839	  7840	  7848	  7854	  7856	  7857	  7858
	  7866	  7867	  7881	  7882	  7895	  7896	  7902	  7905	  7909	  7910	  7915	  7916	  7917	  7919
	  7927	  7928	  7936	  7955	  7960	  7961	  7964	  7965	  7967	  7968	  7992	  8005	  8046	  8085
	  8108	  8109	  8111	  8112	  8114	  8115	  8120	  8121	  8127	  8128	  8149	  8154	  8163	  8164
	  8165	  8172	  8178	  8179	  8196	  8203	  8206	  8214	  8217	  8222	  8223	  8239	  8242	  8247
	  8257	  8268	  8279	  8282	  8283	  8285	  8298	  8299	  8300	  8307	  8308	  8309	  8317	  8318
	  8319	  8329	  8330	  8331	  8332	  8338	  8340	  8345	  8346	  8350	  8353	  8359	  8362	  8367
	  8370	  8375	  8378	  8383	  8386	  8391	  8394	  8399	  8403	  8446	  8447	  8448	  8450	  8452
	  8453	  8463	  8464	  8472	  8483	  8491	  8541	  8542	  8555	  8561	  8566	  8567	  8568	  8569
	  8584	  8585	  8586	  8611	  8615	  8622	  8623	  8626	  8637	  8642	  8645	  8648	  8653	  8659
	  8664	  8670	  8682	  8685	  8688	  8689	  8691	  8692	  8718	  8723	  8776	  8777	  8787	  8788
	  8795	  8796	  8797	  8802	  8803	  8821	  8829	  8843	  8844	  8846	  8881	  8884	  8890	  8894
	  8897	  8899	  8900	  8904	  8911	  8926	  8945	  8949	  8955	  8970	  8975	  8976	  8981	  8982
	  8997	  9000	  9002	  9003	  9008	  9014	  9015	  9026	  9029	  9031	  9034	  9043	  9047	  9051
	  9096	  9104	  9109	  9118	  9120	  9121	  9129	  9134	  9137	  9141	  9143	  9144	  9152	  9153
	  9155	  9174	  9179	  9180	  9181	  9182	  9183	  9184	  9185	  9186	  9187	  9194	  9196	  9197
	  9198	  9201	  9214	  9227	  9246	  9251	  9265	  9267	  9273	  9278	  9281	  9282	  9283	  9284
	  9294	  9298	  9299	  9307	  9308	  9309	  9310	  9317	  9320	  9323	  9326	  9328	  9334	  9335
	  9337	  9345	  9346	  9353	  9398	  9408	  9412	  9413	  9419	  9423	  9429	  9432	  9436	  9438
	  9443	  9444	  9449	  9450	  9464	  9476	  9477	  9479	  9480	  9481	  9490	  9496	  9498	  9500
	  9501	  9502	  9503	  9514	  9515	  9516	  9517	  9522	  9523	  9525	  9526	  9527	  9532	  9534
	  9539	  9543	  9552	  9553	  9554	  9556	  9557	  9563	  9566	  9568	  9580	  9587	  9588	  9594
	  9595	  9632	  9644	  9651	  9654	  9655	  9656	  9672	  9673	  9674	  9692	  9696	  9703	  9704
	  9707	  9709	  9710	  9712	  9713	  9801	  9812	  9824	  9825	  9826	  9827	  9830	  9841	  9843
	  9870	  9880	  9881	  9884	  9885	  9886	  9888	  9891	  9892	  9895	  9898	  9899	  9900	  9901
	  9902	  9905	  9909	  9919	  9920	  9921	  9922	  9924	  9933	  9936	  9937	  9939	  9946	  9947
	  9955	  9956	  9958	  9959	  9960	  9965	  9967	  9968	  9971	  9986	  9991	 10000	 10008	 10010
	 10014	 10018	 10019	 10096	 10104	 10105	 10106	 10108	 10109	 10111	 10115	 10117	 10122	 10124
	 10125	 10126	 10130	 10133	 10134	 10139	 10142	 10143	 10153	 10156	 10158	 10159	 10160	 10164
	 10170	 10173	 10174	 10175	 10188	 10191	 10194	 10204	 10205	 10211	 10212	 10219	 10225	 10230
	 10231	 10267	 10282	 10283	 10284	 10285	 10286	 10287	 10288	 10289	 10290	 10291	 10292	 10293
	 10296	 10300	 10311	 10313	 10327	 10328	 10332	 10349	 10350	 10353	 10354	 10364	 10370	 10406
	 10407	 10413	 10415	 10418	 10419	 10432	 10433	 10434	 10436	 10437	 10442	 10443	 10449	 10451
	 10452	 10459	 10460	 10467	 10468	 10470	 10471	 10472	 10474	 10475	 10478	 10479	 10484	 10485
	 10494	 10496	 10550	 10567	 10581	 10587	 10603	 10629	 10630	 10631	 10632	 10635	 10652	 10658
	 10659	 10666	 10688	 10694	 10704	 10720	 10729	 10731	 10736	 10738	 10765	 10769	 10790	 10793
	 10796	 10800	 10823	 10824	 10825	 10843	 10844	 10845	 10846	 10851	 10860	 10861	 10867	 10882
	 10885	 10886	 10887	 10891	 10896	 10899	 10901	 10906	 10911	 10927	 10928	 10929	 10932	 10933
	 10938	 10939	 10942	 10943	 10944	 10953	 10956	 10957	 10960	 10961	 10969	 10980	 10992	 10993
	 10998	 10999	 11000	 11015	 11031	 11035	 11038	 11039	 11041	 11042	 11045	 11053	 11054	 11060
	 11063	 11064	 11070	 11078	 11079	 11086	 11087	 11093	 11094	 11095	 11097	 11098	 11099	 11111
	 11115	 11116	 11122	 11131	 11140	 11144	 11155	 11161	 11163	 11164	 11167	 11168	 11170	 11172
	 11173	 11224	 11225	 11233	 11235	 11243	 11271	 11330	 11337	 11345	 11346
P1	   536	   538	   540	  1356	  1357	  1358	  1359	  1360	  1361	  1363	  1364	  1365	  1366	  1369
	  1370	  1371	  1372	  1373	  1374	  1377	  1383	  1385	  1387	  1396	  1397	  1399	  1400	  1402
	  1403	  1405	  1406	  1938	  1939	  1942	  1943	  1947	  1948	  1952	  1953	  1954	  1955	  1956
	  1962	  3423	  3445	  4065	  4077	  4085	  4092	  4104	  4112	  4172	  4198	  4199	  4274	  4303
	  4484	  4507	  4509	  4617	  4711	  5177	  5178	  5179	  5180	  5181	  5184	  5185	  5186	  5188
	  5189	  5191	  5313	  5315	  5326	  5330	  5331	  5370	  5374	  5395	  5396	  5405	  5447	  5456
	  5490	  5491	  5496	  5498	  5899	  5900	  5906	  5916	  5929	  5930	  5937	  6007	  6008	  6011
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

	  6257	  6259	  6270	  6279	  6315	  6322	  6332	  6333	  6334	  7002	  7007	  7010	  7011	  7013	  7016
	  7031	  7033	  7052	  7068	  7076	  7081	  7095	  7097	  7474	  7542	  7584	  7866	  7908	  7912
	  7917	  9179	  9198	  9898	  9902	 10095	 10100	 10102	 10110	 10116	 10131	 10140	 10154	 10163
	 10543	 10548	 10561	 10565	 10578	 10585	 10605	 10611	 10708	 11198	 11206	 11207	 11208	 11323
	 11324	 11325	 11326	 11327	 11328	 11329	 11337	 11338	 11339	 11340	 11341	 11342	 11343	 11344
	 11345
P2	  1969	  1974	  3424	  3444	  5315	  5316	  5328	  5329	  5330	  5331	  5373	  5396	  5399	  5412
	  5445	  5446	  5455	  5458	  6009	  6010	  6014	  6017	  6258	  6260	  6264	  6268	  6269	  6280
	  6317	  6321	  6325	  6327	  7479	  7493	  7496	  9180	  9197	  9899	  9901	 10544	 10586	 10606
	 10607	 10634	 10637	 10668	 10709	 10718	 10726	 11199	 11200	 11205	 11209	 11245
P3	   866	   867	   868	   869	   879	   880	   881	   882	   883	   884	   885	   886	  1266	  1268
	  1270	  1271	  1274	  1286	  1294	  1307	  1316	  1317	  1319	  1971	  1972	  2814	  3425	  3443
	  3593	  3594	  3596	  3644	  3647	  3648	  3649	  3650	  3661	  3665	  3666	  3667	  3668	  3694
	  3712	  3717	  3722	  3729	  3732	  3737	  3781	  3800	  3854	  3955	  3987	  4012	  4013	  4017
	  4027	  4029	  4051	  4056	  4134	  4139	  4141	  4182	  4183	  4568	  4569	  5493	  7380	  7393
	  7402	  7477	  7498	  8358	  8366	  8374	  8382	  8390	  8424	  8425	  8426	  8428	  8429	  8430
	  8431	  8433	  8434	  8435	  8436	  8437	  8439	  8440	  8441	  8444	  8445	  8701	  8702	  8726
	  8727	  8779	  8781	  8782	  8797	  8812	  8813	  8843	  9335	  9339	  9345	  9813	  9814	  9831
	 10221	 10223	 10224	 10229	 10549	 10566	 11344
P4	   852	   853	   854	   855	   856	   857	   861	   862	  1265	  1271	  1273	  1286	  1288	  1289
	  1338	  1339	  1351	  1367	  1373	  1388	  1389	  1392	  1424	  1425	  1448	  1464	  1465	  1466
	  1475	  1507	  1509	  1510	  1524	  1535	  1543	  1569	  1577	  1582	  1586	  1593	  1595	  1604
	  1639	  1670	  1688	  1729	  1745	  1828	  1849	  1855	  1859	  1860	  1870	  1884	  1894	  1933
	  1943	  1956	  3426	  3442	  3594	  3599	  3600	  3601	  3611	  3612	  3613	  3615	  3616	  3617
	  3619	  3620	  3621	  3622	  3623	  3624	  3625	  3626	  3627	  3644	  3650	  3652	  3653	  3654
	  3661	  3668	  3671	  3672	  3673	  4013	  4015	  4016	  4856	  4880	  4882	  4962	  5492	  7231
	  7236	  7242	  7243	  7245	  7247	  7255	  7260	  7268	  7274	  7276	  7280	  7283	  7306	  7325
	  7356	  7402	  7405	  7407	  7408	  7412	  7417	  7476	  7488	  7501	  7503	  7504	  7505	  7506
	  7507	  8489	  8492	  8537	  8549	  8582	  8600	  8605	 10224	 10226	 10227	 10548	 10565	 11322
PATCH2	 11185#
PBDISC	  3169	  3210	  3478	  3518	 11560#
PBTIMO	  3423#	  4904
PEVEN8	    89%	  9480	  9556
PG	  7050	  7051	  7056	  7067
PGBIN	  3137	  3396#
PGBIN1	  3392	  3412#
PGBOP	  3141	  3499#
PGBOP1	  3513#	  3515
PGBOP2	  3512	  3517#
PGBOP3	  3524	  3530#
PGBOT	  3150	  3449#
PGBOT1	  3458	  3462#
PGBOTC	  3450	  3453	  3460	  3486#
PGBPF	  3140	  3335#
PGBPN	  3139	  3326#
PGCGB	  3136	  3311#
PGECO	  3154	  4166#
PGFIL	  3147	  4542#
PGHNG	  3152	  3291#
PGHSH	  3134	  3679#
PGOUT	  3149	  4089#
PGRUB	  3148	  4062#
PGSBL	  3146	  3565#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

PGSEC	  3143	  3289#
PGSGR	  3155	  3284#
PGSOG	  3156	  3317#
PGSRD	  3142	  3283#
PGSTC	  3145	  3296#
PGSTP	  3144	  3290#
PGSYL	  3151	  3341#
PGSYLN	  3346	  3364#
PGTRI	  3138	  3378#
PGTRI1	  3380	  3390#
PGTRO	  3135	  3535#
PGZAP	  3153	  3543#
PGZAP1	  3557	  3560#
PJBSTS	  7291%	  7291	  7566%	  7566	  9996%	  9996	 10013%	 10013
PJOBN	    89%	  1520	  1527	  1926	  1951	  3070	  4967	  5031	  5346	  5545	  6084	  6091	  6415	  7169
	  7582	  8901	  8941	  8995	  9024	  9048	  9279	 10254	 10259	 10446	 10693	 10813	 10831	 10954
	 11145
PNTOB1	  6248	  6252#
PNTOBK	  6226	  6244#
POLPRT	  7676#
POLPT1	  7684#	  7703
POLPT3	  7687	  7693	  7701#
POLPT4	  7681	  7702	  7704#
POLPT5	  7694	  7705#
PORTN	  6344%	  6344	  6346%	  6346	  9813%	  9813	  9938%	  9938	 11139%	 11139
PPORTN	  6344%	  6344
PRCCR	  4500	  4585#
PRCFIL	  4592#	  4601
PRCFL1	  4604	  4608#
PRCOCW	  4580#	  4820
PRCOM	  1165%	  1165	  1431%	  1431	  1434%	  1434	  1437%	  1437
PRCOT1	  4588	  4612#
PRCOT2	  4595	  4613#	  4633
PRCOT3	  4566	  4574	  4614#	  4686
PRCOUT	  4071	  4098	  4518	  4564#
PROACT	  4572	  4621#
PROUCC	  4575	  4816#
PRPRMT	 10478%	 10478	 10658%	 10658
PRTBTM	  4842	  4846#
PRTBVR	  8491	  8511#
PRTCRS	  1139	  1140	  1149#	  1441
PRTDDB	  5091%	  5091
PRTIRG	  1386	  1409	  1414#	  1632
PRTKEY	  1168#
PRTOCT	  1152%	  1152	  1156%	  1156	  1164%	  1164	  1167%	  1167	  1176%	  1176	  1417%	  1417	  1421%	  1421
	  1426%	  1426	  1430%	  1430	  1433%	  1433	  1436%	  1436	  1439%	  1439
PRTUT1	  2976	  2988#
PSDONE	  1881	  1884#
PTBSIZ	  3159#	  3186	  3187	 11559
PTYBUD	  3171	  3228	  3247	  3303	  3342	  3413	  3438	  3455	  3555	  3569	  6360#	  6562	  6609	  6859
	 11095
PTYBUF	  3179	  3216	  3222	 11559#
PTYDDB	  6318	  6324	  6409#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

PTYFLO	  4869	 11558#
PTYLDB	  6316	  6323	  6368#
PTYLOS	  3565	 11547#
PTYSBL	  3574#
PTYTRN	  3033	  3134#
PUNIT	    90%	 10839
PVYHNG	  5566%	  5566
PVYMOD	    90%	  9049
PX.MEM	  5315	  5326	  5331	  5369	  5396	  5405	  5445	  5455	  5458	  5720	  5840	  5879	  5881	  5889
	  5899	  5901	  5903	  5916	  5917	  5929	  5931	  5935	  5945	  5974	  5977	  6007	  6054	  6117
	  6428	  6434	  6548	  6549	  6552	  6565	  6572	  6576	  6825	  6834	  6845	  6861	  6870	  6877
	  6880	  6966	  6975	  6983	  7010	  7050	  7056	  7067	  7097	  7486	  7615	  7632	  7676	  7696
	  7698	  7932	  7969	  7980	  9984	  9990	 10543	 10544
PX.SRC	  5315	  5326	  5369	  5405	  5455	  5458	  5720	  5840	  5881	  5903	  5935	  6966	  6975	  6983
	  7056	  7486	  9984	  9990
QUEPCB	    84%	  9998	 10015	 10016
RCC.HI	  5049	  5060	  5143	  5175	  5181	  5215	 11258	 11570#
RCC.LO	  5048	  5059	  5142	  5174	  5180	  5214	 11250	 11569#
RCC.T1	  5050	  5069	  5081	  5090#	  5176
RCC.T3	  5050	  5069	  5081	  5085#
RCCBAD	  5081#
RCCDBG	  5050#	  5144
RCCSTP	  5176#	  5182	  5216
RCVANS	  1447	  8571#
RCVAUX	  1453	  7296#
RCVCH1	  2030#	  2067
RCVCH2	  2038	  2046#
RCVCHR	  2023#	  2240	  2254	  2269	  2281	  2287	  2297	  2306	  2314	  2322	  2328	  2337	  2346	  2509
	  2518	  2524	  2533	  2543	  2555	  2561
RCVLOS	  1467	  1828#
RCVNSP	  1451	  7228#
RCVPS	  1508	  1874#
RCVRAK	  1450	  8489#
RCVRES	  1449	  8529#
RCVS2	  7244	  7253#
RCVS2A	  7256#	  7265
RCVS4	  7246	  7264#
RCVS6	  7248	  7272#
RCVSP	  7249	  7278#
RCVSUR	  1470	  7239#
RCVTCX	  1847	  1851#
RCVTMC	  1486	  1844#
RCVWK1	  4994	  4998	  5008#
RCVZAP	  1457	  1887#
RDNXT	  5785	  6105#
RECHLT	  2025	  2073	  2075#
RECHT1	  2079	  2084#
RECVRG	  2032	  2051#
RED	  1461	  1588#
REFLAG	    89%	 11210
RELB0	  8136	  8144	  8148#
RELBB	  8196	  8262#
RELBB1	  8263	  8273#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

RELBBF	  8112	  8264#
RELBI	  1682	  1711	  7765	  7786	  7849	  7902	  7909	  8135#
RELBIO	  8138	  8146	  8189	  8196#
RELBO	  1752	  7787	  7972	  8143#
RELEA6	    96%	  5641	  7188	 10731
RELKMC	  8268	  8282#
REQBUF	  7806	  7833	  7927#
RETACH	 10543#
RETCH1	 10588	 10591#
RETCH2	 10590	 10596#
RETZRO	  6070#	  6090	  6102
RIDLIN	  2688	  2705#	  2872
RIDLN1	  2711	  2716#
RIDLN2	  2722	  2728#
RIDLN3	  2706	  2731#
RLBIO1	  8199	  8205#
RMTAL1	  2396	  2413#
RMTALT	  2392	  2415#
RMTBSP	  2397	  2407	  2478#
RMTCN1	  2410#	  2414
RMTCNT	  2356	  2359#	  2411
RMTCR	  2389	  2399	  2425#
RMTECR	  2368#	  2432
RMTECT	  2355	  2373#
RMTEU1	  2431	  2435#
RMTEXC	  2388	  2395	  2429#
RMTEXU	  2390	  2433#
RMTFF	  2394	  2404	  2452#
RMTPAT	  2406	  2408#
RMTRUB	  2423	  2439#
RMTS10	  2383	  2386	  2388#
RMTS94	  2384	  2385	  2398#
RMTSPA	  2373	  2379#
RMTSPT	  2381	  2383#
RMTTAB	  2391	  2401	  2459#
RMTTB1	  2466	  2471#
RMTVT	  2393	  2403	  2445#
RMXLIN	  1379%	  1379
RNQ	   105%	  7290	 10012
RPORTN	  1275%	  1275	  1278%	  1278	  2966	  3857%	  3857	  5514%	  5514	  8435%	  8435	  8437%	  8437	  8536%
	  8536	  8547%	  8547	  8554%	  8554
RT.CON	 10530#	 10634
RT.MOD	 10523#
RT.SIG	 10529#	 10718	 10726
RT.SLV	 10522#
RTATC	 10611#
RTATS	 10607	 10665#
RTATS1	 10667	 10670	 10685#
RTATS2	 10681	 10700#
RTAUX%	 10539#	 10618
RTCCO	 10641	 10648	 10655#
RTCONT	 10474	 10493#	 10635
RTCSV	 10639	 10645#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

RTCUS	 10642	 10647	 10650#
RTERJ	 10592	 10599	 10619	 10624	 10677	 10691	 10736#
RTERR	 10553	 10559	 10570	 10576	 10737#
RTFIN	 10640	 10653	 10657	 10660	 10705	 10708#
RTFIN1	 10714	 10726#
RTFIN2	 10727	 10730#
RTNRM%	 10540#	 10690
RTSAC%	 10532#	 10552
RTSCP%	 10538#	 10598
RTSNA%	 10536#	 10591
RTSNX%	 10533#	 10558
RTTAC%	 10534#	 10569
RTTAT%	 10537#	 10623	 10676
RTTNX%	 10535#	 10575
RUBSTR	  2371	  2450	  2457	  2469	  2498#	  2506	  2682	  4491
RWARN	  2029	  2062#
RWARN1	  2063	  2069#
S	  1679	  1680	  1692	  1693	  4159	  4160	  4161	  4918	  4919	  4920	  4921	  4954	  4955	  4960
	  4995	  4996	  4997	  4999	  5001	  5002	  5010	  5011	  5098	  5099	  5101	  5102	  5107	  5108
	  5112	  5113	  5302	  5335	  5336	  5339	  5385	  5387	  5389	  5393	  5394	  5406	  5415	  5416
	  5433	  5434	  5574	  5575	  5621	  5622	  5813	  5814	  6042	  6050	  6051	  6113	  6114	  6175
	  6189	  6190	  6439	  6887	  7023	  7024	  7173	  7224	  7801	  7828	  7846	  7847	  7855	  7900
	  8649	  8651	  8652	  8920	  8989	  9004	  9005	  9006	  9007	  9018	  9056	  9064	  9066	  9068
	  9070	  9084	  9092	  9093	  9108	  9130	  9131	  9159	  9160	  9161	  9162	  9175	  9176	  9177
	  9178	  9188	  9189	  9199	  9200	  9396	  9397	  9403	  9407	  9863	  9896	  9897	  9903	  9904
	  9907	  9908	 10357	 10358	 10360	 10361	 10770	 10928	 10931	 10936	 10937	 10942	 10951	 10952
	 10954	 10955	 10961	 10963	 10964	 10966	 10967	 10971	 10972	 10974	 10975	 10977	 10978	 10983
	 10984	 10986	 10987	 10989	 10990	 10999	 11051	 11052	 11128	 11129
S$DEBU	  1632	  1633	  5081	  5082
S$ENTR	    16	    22	  1109	  1140	  1141	  1344	  1387	  1410	  1445	  1468	  1471	  1473	  1476	  1478
	  1480	  1482	  1484	  1487	  1489	  1492	  1495	  1500	  1503	  1511	  1633	  1642	  1672	  1761
	  1944	  2977	  3003	  3087	  3197	  3253	  3264	  3285	  3354	  3385	  3403	  3431	  3464	  3468
	  3475	  3488	  3501	  3575	  3643	  3660	  3679	  3858	  3914	  3962	  3971	  4023	  4843	  5051
	  5070	  5082	  5144	  5157	  5171	  5177	  5182	  5216	  5688	  6016	  6370	  6373	  6411	  6575
	  6707	  6801	  7038	  7429	  7430	  7432	  7434	  7950	  8086	  8099	  8225	  8248	  8253	  8265
	  8274	  8286	  8492	  8791	  9842	 10312	 10614	 10687	 10749	 11226	 11234	 11237
S$EVEN	  1139	  1140	  1386	  1409	  1632	  1641	  2976	  3402	  3574	  3913	  3970	  4842	  4843	  5050
	  5069	  5081	  5156	  5176	  8085	  8247	  8491	  8492	 10311
S$HALT	    16	  1109	  1139	  1140	  1344	  1386	  1409	  1445	  1468	  1471	  1473	  1476	  1478	  1480
	  1482	  1484	  1487	  1489	  1492	  1495	  1500	  1503	  1511	  1632	  1641	  1672	  1761	  1944
	  2976	  3003	  3087	  3197	  3253	  3264	  3285	  3354	  3385	  3402	  3431	  3464	  3468	  3475
	  3488	  3501	  3574	  3643	  3660	  3679	  3858	  3913	  3962	  3970	  4023	  4842	  5050	  5069
	  5081	  5144	  5156	  5171	  5176	  5182	  5216	  5688	  6016	  6370	  6373	  6411	  6575	  6707
	  6801	  7038	  7429	  7430	  7432	  7434	  7950	  8085	  8099	  8225	  8247	  8253	  8265	  8274
	  8286	  8491	  8791	  9842	 10311	 10614	 10687	 10749	 11226	 11234	 11237
S$INFO	  1139	  1140	  1141	  1386	  1387	  1409	  1410	  1632	  1641	  1642	  2976	  2977	  3402	  3574
	  3575	  3913	  3914	  3970	  3971	  4842	  5050	  5051	  5069	  5070	  5081	  5156	  5157	  5176
	  8085	  8086	  8247	  8491	 10311
S$JOB	  3402	  3403
S$NAME	    20#	  1944	  3087	  3197	  3253	  3264	  3285	  3354	  3431	  3464	  3468	  3475	  3488	  3501
	  3643	  3660	  3679	  3858	  3962	  4023	  5171	  5688	  6016	  6370	  6373	  6411	  6575	  6707
	  6801	  7038	  7429	  7430	  7432	  7434	  7950	  8225	  8265	  8274	  8286	  8791	  9842	 10614
	 10687	 10749	 11226	 11234	 11237
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

S$NONA	    19	    22	  1110	  1140	  1141	  1345	  1387	  1410	  1446	  1469	  1472	  1474	  1477	  1479
	  1481	  1483	  1485	  1488	  1490	  1493	  1496	  1501	  1504	  1512	  1633	  1642	  1673	  1762
	  1944	  2977	  3004	  3087	  3197	  3253	  3264	  3285	  3354	  3386	  3403	  3431	  3464	  3468
	  3475	  3488	  3501	  3575	  3643	  3660	  3679	  3858	  3914	  3962	  3971	  4023	  4843	  5051
	  5070	  5082	  5145	  5157	  5171	  5177	  5183	  5217	  5688	  6016	  6370	  6373	  6411	  6575
	  6707	  6801	  7038	  7429	  7430	  7432	  7434	  7950	  8086	  8100	  8225	  8248	  8254	  8265
	  8274	  8286	  8492	  8791	  9842	 10312	 10614	 10687	 10749	 11226	 11234	 11237
S$PATC	  1139	  1140	  1386	  1409	  1632	  1641	  2976	  3402	  3574	  3913	  3970	  4842	  5050	  5069
	  5081	  5156	  5176	  8085	  8247	  8491	 10311
S$STOP	  1139	  1140	  5176	  5177	  8247	  8248	 10311	 10312
S$TEMP	    16#	    16	  1109#	  1109	  1139#	  1139	  1140#	  1140	  1344#	  1344	  1386#	  1386	  1409#	  1409
	  1445#	  1445	  1468#	  1468	  1471#	  1471	  1473#	  1473	  1476#	  1476	  1478#	  1478	  1480#	  1480
	  1482#	  1482	  1484#	  1484	  1487#	  1487	  1489#	  1489	  1492#	  1492	  1495#	  1495	  1500#	  1500
	  1503#	  1503	  1511#	  1511	  1632#	  1632	  1641#	  1641	  1672#	  1672	  1761#	  1761	  1944#	  1944
	  2976#	  2976	  3003#	  3003	  3087#	  3087	  3197#	  3197	  3253#	  3253	  3264#	  3264	  3285#	  3285
	  3354#	  3354	  3385#	  3385	  3402#	  3402	  3431#	  3431	  3464#	  3464	  3468#	  3468	  3475#	  3475
	  3488#	  3488	  3501#	  3501	  3574#	  3574	  3643#	  3643	  3660#	  3660	  3679#	  3679	  3858#	  3858
	  3913#	  3913	  3962#	  3962	  3970#	  3970	  4023#	  4023	  4842#	  4842	  5050#	  5050	  5069#	  5069
	  5081#	  5081	  5144#	  5144	  5156#	  5156	  5171#	  5171	  5176#	  5176	  5182#	  5182	  5216#	  5216
	  5688#	  5688	  6016#	  6016	  6370#	  6370	  6373#	  6373	  6411#	  6411	  6575#	  6575	  6707#	  6707
	  6801#	  6801	  7038#	  7038	  7429#	  7429	  7430#	  7430	  7432#	  7432	  7434#	  7434	  7950#	  7950
	  8085#	  8085	  8099#	  8099	  8225#	  8225	  8247#	  8247	  8253#	  8253	  8265#	  8265	  8274#	  8274
	  8286#	  8286	  8491#	  8491	  8791#	  8791	  9842#	  9842	 10311#	 10311	 10614#	 10614	 10687#	 10687
	 10749#	 10749	 11226#	 11226	 11234#	 11234	 11237#	 11237
S$XCT	    22	  1109	  1110	  1140	  1141	  1344	  1345	  1387	  1410	  1445	  1446	  1468	  1469	  1471
	  1472	  1473	  1474	  1476	  1477	  1478	  1479	  1480	  1481	  1482	  1483	  1484	  1485	  1487
	  1488	  1489	  1490	  1492	  1493	  1495	  1496	  1500	  1501	  1503	  1504	  1511	  1512	  1633
	  1642	  1672	  1673	  1761	  1762	  1944	  2977	  3003	  3004	  3087	  3197	  3253	  3264	  3285
	  3354	  3385	  3386	  3403	  3431	  3464	  3468	  3475	  3488	  3501	  3575	  3643	  3660	  3679
	  3858	  3914	  3962	  3971	  4023	  4843	  5051	  5070	  5082	  5144	  5145	  5157	  5171	  5177
	  5182	  5183	  5216	  5217	  5688	  6016	  6370	  6373	  6411	  6575	  6707	  6801	  7038	  7429
	  7430	  7432	  7434	  7950	  8086	  8099	  8100	  8225	  8248	  8253	  8254	  8265	  8274	  8286
	  8492	  8791	  9842	 10312	 10614	 10687	 10749	 11226	 11234	 11237
S..KAF	  1109	  1109%
SAV30	  1159%	  1159	  1163	  1166
SBBLUP	  8314#	  8327
SCANBB	  4022	  8223	  8285	  8306#
SCN1PD	  1136	  1137	  1141	  1145#
SCNBUF	 11329%	 11329	 11344%	 11344
SCNDDB	   616#	   640
SCNDDS	   640#	  5288
SCNDRD	  4866	  8342#
SCNDSP	   620	  5284#
SCNEND	 12044#
SCNIN	  1306	  1323	  1325	  1327	  1338#	  3103
SCNIN0	  1351#	  1390
SCNIN1	  1388#	  1392	  1448	  1464	  1465	  1466	  1475	  1507	  1509	  1510	  1560	  1569	  1586	  1593
	  1849	  1855	  1870	  1884	  1957	  7231	  7236	  7242	  7243	  7245	  7247	  7255	  7260	  7268
	  7274	  7276	  7280	  7283	  7308	  7325	  7356	  8492	  8537	  8549	  8582	  8600	  8605
SCNIN2	  1386	  1392#
SCNINT	  1226#	  9184
SCNLIT	 11575#
SCNMI2	  8344	  8351#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

SCNMIN	  4861	  8338#
SCNMSK	 11324%	 11324	 11339%	 11339
SCNNAM	  6416	  7170	  7592	 10451	 10630	 10694	 10838#
SCNNMR	  9958	  9964#	  9967	 10844
SCNNT0	  1228	  1239#
SCNNT2	  1308	  1322#
SCNOUT	  1340	  1352	  2944#
SCNPTR	 11323%	 11323	 11338%	 11338
SCNREL	    25#	  1266	  1268
SCNSC0	  4831	  4841	  4853#
SCNSC1	  4873	  4876#
SCNSC2	  4877	  4880#
SCNSEC	  4828#
SCNSER	    16	    17#	    20
SCNTCD	 10024#
SCNTIC	  1248	  1304#
SCNUDT	 11327%	 11327	 11342%	 11342
SCNVER	    24#	  1266	  1268
SCOLP	  2958#	  3098
SCOLP1	  2954#	  3100
SCOPTY	  2968	  2975#
SCORTY	  2967	  3002#
SCOTTY	  2985	  3010	  3014#
SECLOP	  4882#	  4962
SECLP1	  4890	  4893#
SECLP2	  4894	  4900	  4905	  4914	  4917	  4922	  4929#
SECLP3	  4932	  4937	  4943#
SECLP4	  4953	  4956	  4959	  4962#
SECTM1	  4903	  4907#
SECTM2	  4909	  4913#
SECTM3	  4907	  4923#
SENT41	  8460	  8540	  8581	  8583	 11380#
SETBRK	  5309	  5344#	  5367	  5449	  6049
SETFIO	  5940	  7028	  8623	  8900	  8949	  9030	 11128#
SETIO2	    97%	  6490	  6885
SETLIN	  5796	  6007#
SETLMD	  1577	  1582	  2171	  4926	  6181	  6199	  6201#	  6402	  6460	  6948	  7045	  7093	  7355	  9087
	  9091	  9096	  9134	  9412	  9447	  9824	 10484	 10652	 11224
SETLN1	  6010#	  6017
SETOPB	  6741#	  6894	  6906	  6912
SETOUT	  1305	  2944	  3583	  3603	  3609#	  7413	  7421
SETPTB	  3174	  3193#
SETPTL	  2983	  3169#
SETPTP	  6287#
SETRUN	    89%	  7292	  9399	 10014	 10497
SETSHT	  5607	  8557	 10178#
SETTB1	  6222	  6225#
SETTBK	  5631	  5633	  6214#	  6840	  6851	 10765	 10769
SETTC1	  6589#	  6878	 10156
SETTC2	  6613	  6615	  6617#
SETTCN	  6015	  6550	  6574	  6588#
SIMRZP	  1519	  1523	  1633	  1892	  1894#
SIZIRG	 11526	 11527
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

SKPFLG	  8999	  9146	  9147	  9157	  9191	  9193	 11564#
SKPIN1	  5869	  5873#
SKPINC	  5800	  5853#	  6022	  6472
SKPINL	  5801	  5865#	  6031	  6504
SLCTAB	  5998#	  6005	  6009
SLCTBN	  6005#	  6009
SNDAUX	  1326	  7359#
SNDHSI	  1324	  8355#
SNDSAD	  1322	 10208#
SNDSRQ	  7365	  7367	  7378#
SPE940	  4363	  4364	  4378#
SPEALP	  4375	  4416#
SPEALT	  4371	  4418	  4422#
SPEAP1	  4386	  4410#
SPEBK3	  4400#
SPEBK6	  4405#	  4411	  4417	  4428	  4435	  4448	  4457
SPEBRK	  4378	  4380	  4382	  4385	  4395#	  4412	  4426	  4440	  4449	  4462	  4470	  4473	  4480	  4488
	  4489	  4492
SPEBS	  4376	  4387	  4453#
SPEBS1	  4455	  4461#
SPECR	  4368	  4379	  4390#
SPEPDP	  4362	  4365	  4367#
SPETAB	  4370	  4381	  4431#
SPETB1	  4433	  4439#
SPEUC1	  4507	  4512#
SPEUCM	  4471	  4481	  4496#
SPEUX	  4369	  4467#
SPEUX1	  4484	  4491#
SPEUXC	  4367	  4374	  4477#
SPEVM	  4372	  4373	  4383	  4384	  4446#
SPOBS1	  4690	  4693#
SPOBS2	  4628	  4685#
SPOBSP	  2478	  4685	  4688#
SPOCR	  4624	  4632#
SPOFF	  4627	  4665#
SPOFF1	  4666	  4669#
SPOFIL	  4487	  4647	  4656	  4668	  4678	  4704#	  4710
SPOFL1	  4662	  4671	  4681	  4706#
SPOTAB	  4625	  4637#
SPOTB0	  4643	  4649#
SPOTB1	  4653	  4658#
SPOTBL	  4622	  4624#
SPOVT	  4626	  4675#
SPOVT1	  4676	  4679#
SPRCOM	  9349	  9355#
SPRCTB	  9357	  9359#
SPREAT	  8818	  8824#
SPRETB	  8825	  8832#
SPRTTB	  8727	  8729#
SPRTYI	  8709	  8725#
SSPT	  4803	  4804	  4805	  4806	  4807	  4808	  4809	  4810	  4812#
STATES	    90%	  2162	  2165	  3828	  3839	  3870	  3881	  5606	  8594	  9800	  9805	 10180	 10183	 11214
STAUTO	  9799	 11213
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

STDALT	    47#	  8764
STLST	  5052	  5058#	  5072
STOP10	  1087#
STOP9	  1088#
STOTC1	  6071#	  6092	  6097	  6104	 11169	 11174
STRUB	  2484	  2490#
STRUB1	  2485#	  2494
STSHUT	  3827	  3869	  8593	 10179
STSUPR	  2161	  3835	  3877	  9804
STTIOD	    88%	  5005
STTLK	  5671#
STTLK0	  5672	  5680#
STTLK1	  5678	  5696	  5699	  5702	  5707#
STTLK2	  5713#	  5726
STTLK3	  5722	  5725	  5728#
STTYBF	   618
SUPTIM	  1869%	  1869	  7229%	  7229
SVOJFF	  3031	  3036	  3050	 11473#
SVPPC	  9706#
SVSPC	 11465#
SYSNUM	  1284%	  1284	  6384%	  6384	  9821%	  9821	 11219%	 11219
T1	  1111	  1122	  1127	  1143	  1151	  1155	  1159	  1163	  1166	  1170	  1171	  1172	  1175	  1247
	  1251	  1275	  1279	  1280	  1281	  1283	  1284	  1285	  1290	  1318	  1320	  1348	  1349	  1416
	  1420	  1425	  1429	  1432	  1435	  1438	  1528	  1529	  1531	  1532	  1536	  1537	  1538	  1539
	  1540	  1544	  1545	  1546	  1547	  1552	  1553	  1554	  1562	  1563	  1564	  1567	  1574	  1576
	  1579	  1581	  1583	  1584	  1585	  1588	  1589	  1590	  1591	  1592	  1598	  1599	  1600	  1601
	  1613	  1614	  1617	  1618	  1620	  1621	  1623	  1624	  1625	  1647	  1648	  1653	  1654	  1655
	  1675	  1676	  1694	  1695	  1701	  1702	  1704	  1705	  1712	  1718	  1719	  1720	  1730	  1731
	  1732	  1733	  1735	  1746	  1747	  1748	  1749	  1750	  1751	  1753	  1830	  1831	  1832	  1833
	  1834	  1837	  1838	  1839	  1844	  1848	  1861	  1862	  1863	  1864	  1866	  1868	  1869	  1874
	  1875	  1876	  1877	  1878	  1879	  1882	  1888	  1889	  1890	  1893	  1899	  1900	  1902	  1903
	  1904	  1905	  1906	  1907	  1908	  1910	  1911	  1912	  1913	  1920	  1921	  1933	  1934	  1935
	  1951	  1952	  1963	  1964	  1965	  1975	  1983	  1984	  1985	  1986	  1987	  1988	  1989	  1990
	  2036	  2037	  2042	  2043	  2044	  2046	  2047	  2064	  2065	  2066	  2069	  2070	  2076	  2077
	  2080	  2081	  2082	  2084	  2085	  2086	  2100	  2101	  2102	  2107	  2110	  2111	  2112	  2113
	  2114	  2115	  2116	  2117	  2118	  2119	  2120	  2125	  2126	  2128	  2129	  2130	  2147	  2148
	  2149	  2150	  2151	  2152	  2153	  2156	  2157	  2158	  2159	  2161	  2162	  2167	  2181	  2184
	  2190	  2238	  2239	  2252	  2253	  2258	  2259	  2267	  2268	  2289	  2290	  2299	  2300	  2301
	  2308	  2309	  2331	  2332	  2354	  2355	  2364	  2366	  2368	  2369	  2379	  2381	  2425	  2426
	  2440	  2441	  2442	  2471	  2500	  2501	  2502	  2511	  2512	  2535	  2536	  2545	  2546	  2547
	  2563	  2564	  2570	  2572	  2622	  2623	  2632	  2633	  2636	  2637	  2671	  2672	  2678	  2679
	  2681	  2690	  2691	  2705	  2707	  2714	  2748	  2749	  2750	  2769	  2770	  2772	  2773	  2774
	  2785	  2786	  2815	  2816	  2817	  2818	  2825	  2826	  2827	  2839	  2847	  2849	  2850	  2861
	  2862	  2864	  2874	  2875	  2881	  2882	  2884	  2885	  2898	  2899	  2952	  2953	  2954	  2955
	  2957	  2960	  2962	  2963	  2964	  2966	  2979	  2980	  2988	  2992	  2996	  3008	  3014	  3015
	  3016	  3017	  3024	  3025	  3026	  3027	  3037	  3038	  3039	  3040	  3044	  3051	  3052	  3053
	  3054	  3062	  3063	  3070	  3073	  3099	  3100	  3172	  3173	  3179	  3180	  3181	  3182	  3183
	  3184	  3185	  3186	  3187	  3194	  3195	  3196	  3198	  3200	  3210	  3211	  3215	  3216	  3221
	  3233	  3234	  3237	  3239	  3240	  3248	  3249	  3251	  3252	  3255	  3258	  3265	  3266	  3272
	  3274	  3275	  3276	  3277	  3305	  3311	  3321	  3326	  3327	  3329	  3330	  3335	  3336	  3337
	  3344	  3345	  3350	  3351	  3352	  3353	  3356	  3364	  3365	  3366	  3367	  3378	  3379	  3381
	  3382	  3383	  3384	  3388	  3396	  3397	  3398	  3399	  3400	  3401	  3404	  3405	  3407	  3408
	  3428	  3429	  3430	  3435	  3451	  3452	  3456	  3457	  3462	  3463	  3470	  3471	  3473	  3474
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

	  3476	  3477	  3478	  3486	  3487	  3489	  3490	  3492	  3493	  3494	  3495	  3499	  3500	  3502	  3503
	  3523	  3526	  3527	  3530	  3531	  3535	  3536	  3543	  3544	  3547	  3548	  3552	  3553	  3566
	  3570	  3582	  3584	  3585	  3589	  3590	  3597	  3598	  3599	  3627	  3628	  3629	  3680	  3681
	  3696	  3697	  3698	  3700	  3701	  3730	  3731	  3792	  3793	  3805	  3808	  3815	  3816	  3821
	  3822	  3827	  3828	  3830	  3831	  3835	  3839	  3843	  3844	  3848	  3849	  3851	  3852	  3853
	  3863	  3864	  3869	  3870	  3872	  3873	  3877	  3881	  3883	  3884	  3888	  3889	  3891	  3892
	  3893	  3916	  3917	  3923	  3924	  3984	  3985	  3996	  3997	  3998	  3999	  4009	  4010	  4011
	  4012	  4021	  4025	  4026	  4027	  4028	  4029	  4049	  4050	  4130	  4131	  4132	  4133	  4179
	  4184	  4186	  4187	  4205	  4206	  4207	  4208	  4209	  4210	  4211	  4252	  4253	  4267	  4268
	  4304	  4305	  4324	  4325	  4342	  4343	  4353	  4354	  4358	  4360	  4390	  4395	  4400	  4405
	  4431	  4432	  4434	  4436	  4439	  4441	  4446	  4447	  4453	  4456	  4458	  4461	  4463	  4513
	  4514	  4519	  4520	  4521	  4570	  4576	  4585	  4586	  4637	  4638	  4639	  4642	  4644	  4645
	  4650	  4651	  4658	  4660	  4661	  4669	  4670	  4679	  4680	  4688	  4689	  4691	  4692	  4693
	  4694	  4695	  4816	  4817	  4832	  4834	  4835	  4836	  4840	  4849	  4850	  4859	  4860	  4864
	  4865	  4869	  4870	  4874	  4875	  4878	  4879	  4885	  4886	  4889	  4892	  4893	  4901	  4902
	  4908	  4909	  4923	  4924	  4929	  4931	  4933	  4934	  4936	  4944	  4946	  4947	  4948	  4949
	  4957	  4958	  4967	  4968	  4975	  4976	  4977	  4991	  4992	  5003	  5007	  5014	  5015	  5016
	  5025	  5028	  5029	  5031	  5032	  5033	  5036	  5051	  5052	  5053	  5058	  5059	  5060	  5061
	  5062	  5065	  5066	  5071	  5076	  5077	  5079	  5080	  5085	  5092	  5093	  5104	  5137	  5140
	  5141	  5142	  5143	  5146	  5169	  5172	  5173	  5174	  5175	  5178	  5189	  5190	  5192	  5202
	  5203	  5218	  5219	  5222	  5223	  5266	  5267	  5270	  5271	  5273	  5276	  5277	  5288	  5310
	  5319	  5348	  5349	  5352	  5353	  5355	  5356	  5357	  5359	  5363	  5364	  5369	  5371	  5372
	  5373	  5386	  5390	  5391	  5397	  5417	  5418	  5419	  5423	  5424	  5425	  5426	  5484	  5485
	  5491	  5492	  5496	  5497	  5509	  5510	  5512	  5519	  5520	  5527	  5531	  5546	  5559	  5560
	  5566	  5567	  5572	  5585	  5586	  5597	  5605	  5606	  5608	  5609	  5610	  5611	  5614	  5625
	  5626	  5628	  5629	  5630	  5632	  5671	  5673	  5674	  5675	  5682	  5683	  5684	  5686	  5691
	  5703	  5715	  5820	  5821	  5822	  5848	  5849	  5857	  5858	  5859	  5860	  5865	  5867	  5868
	  5890	  5891	  5892	  5918	  5919	  5920	  5927	  5928	  5945	  5948	  5949	  5950	  5953	  5956
	  5958	  5962	  5965	  5971	  5972	  5973	  5974	  6014	  6069	  6070	  6071	  6074	  6075	  6091
	  6096	  6103	  6120	  6121	  6123	  6124	  6125	  6129	  6132	  6155	  6158	  6159	  6160	  6162
	  6163	  6164	  6165	  6166	  6167	  6168	  6169	  6173	  6174	  6176	  6177	  6178	  6180	  6192
	  6194	  6196	  6201	  6202	  6203	  6214	  6215	  6216	  6218	  6219	  6220	  6223	  6234	  6235
	  6236	  6245	  6246	  6247	  6248	  6259	  6268	  6287	  6288	  6290	  6291	  6292	  6293	  6294
	  6295	  6296	  6297	  6298	  6299	  6313	  6315	  6319	  6322	  6330	  6337	  6344	  6345	  6346
	  6348	  6351	  6368	  6372	  6379	  6382	  6383	  6384	  6385	  6389	  6390	  6397	  6398	  6399
	  6400	  6409	  6410	  6417	  6418	  6419	  6420	  6434	  6435	  6437	  6438	  6458	  6459	  6548
	  6563	  6564	  6567	  6569	  6571	  6572	  6588	  6589	  6591	  6592	  6596	  6598	  6600	  6601
	  6603	  6610	  6611	  6614	  6615	  6692	  6693	  6695	  6705	  6706	  6708	  6710	  6718	  6719
	  6734	  6736	  6738	  6739	  6741	  6778	  6780	  6781	  6782	  6783	  6784	  6786	  6787	  6788
	  6799	  6837	  6839	  6848	  6850	  6860	  6861	  6862	  6863	  6869	  6870	  6871	  6872	  6876
	  6892	  6893	  6898	  6899	  6901	  6902	  6903	  6904	  6905	  6910	  6911	  6920	  6921	  6922
	  6923	  6927	  6928	  6929	  6930	  6931	  6964	  6966	  6980	  6981	  6982	  7016	  7017	  7018
	  7021	  7025	  7065	  7066	  7074	  7087	  7088	  7089	  7090	  7091	  7092	  7134	  7135	  7140
	  7141	  7144	  7145	  7147	  7148	  7158	  7163	  7164	  7165	  7166	  7167	  7168	  7178	  7179
	  7185	  7217	  7218	  7219	  7221	  7222	  7228	  7229	  7234	  7235	  7239	  7240	  7253	  7254
	  7256	  7257	  7258	  7259	  7264	  7265	  7266	  7272	  7273	  7278	  7279	  7281	  7282	  7285
	  7290	  7291	  7296	  7297	  7298	  7304	  7305	  7310	  7311	  7321	  7327	  7329	  7332	  7333
	  7347	  7348	  7349	  7350	  7351	  7352	  7353	  7359	  7360	  7381	  7382	  7383	  7384	  7385
	  7386	  7394	  7395	  7399	  7400	  7401	  7409	  7410	  7411	  7418	  7419	  7426	  7427	  7438
	  7441	  7474	  7475	  7486	  7549	  7550	  7551	  7552	  7565	  7566	  7577	  7578	  7583	  7585
	  7586	  7588	  7589	  7593	  7600	  7615	  7617	  7627	  7629	  7630	  7632	  7638	  7639	  7644
	  7651	  7652	  7656	  7676	  7678	  7690	  7721	  7722	  7726	  7727	  7732	  7733	  7741	  7742
	  7747	  7748	  7752	  7753	  7760	  7761	  7763	  7764	  7768	  7769	  7777	  7778	  7783	  7784
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

	  7785	  7792	  7793	  7799	  7800	  7810	  7826	  7827	  7837	  7852	  7853	  7872	  7881	  7886	  7887
	  7892	  7893	  7896	  7908	  7912	  7914	  7916	  7918	  7935	  7951	  7952	  7953	  7954	  7958
	  7959	  7962	  7963	  7981	  7996	  7997	  8002	  8003	  8007	  8008	  8009	  8083	  8084	  8090
	  8093	  8098	  8101	  8106	  8107	  8108	  8114	  8122	  8129	  8135	  8136	  8143	  8144	  8148
	  8154	  8155	  8156	  8158	  8160	  8164	  8170	  8171	  8173	  8174	  8197	  8198	  8200	  8205
	  8222	  8227	  8228	  8229	  8230	  8231	  8232	  8233	  8239	  8251	  8252	  8255	  8264	  8267
	  8273	  8276	  8277	  8282	  8284	  8290	  8292	  8293	  8299	  8306	  8307	  8310	  8311	  8316
	  8319	  8331	  8339	  8343	  8347	  8348	  8349	  8351	  8355	  8360	  8361	  8363	  8368	  8369
	  8371	  8376	  8377	  8379	  8384	  8385	  8387	  8392	  8393	  8396	  8397	  8398	  8400	  8404
	  8405	  8406	  8408	  8409	  8411	  8426	  8446	  8453	  8457	  8461	  8464	  8473	  8474	  8475
	  8476	  8477	  8478	  8479	  8480	  8481	  8482	  8489	  8490	  8530	  8531	  8532	  8533	  8538
	  8539	  8540	  8544	  8546	  8548	  8577	  8578	  8579	  8580	  8581	  8583	  8584	  8586	  8587
	  8588	  8591	  8598	  8603	  8610	  8621	  8634	  8635	  8640	  8641	  8643	  8644	  8646	  8647
	  8657	  8658	  8660	  8661	  8662	  8663	  8668	  8669	  8671	  8672	  8673	  8674	  8675	  8676
	  8677	  8680	  8681	  8694	  8696	  8720	  8721	  8722	  8805	  8807	  8841	  8842	  8866	  8867
	  8869	  8870	  8873	  8875	  8876	  8879	  8898	  8901	  8908	  8909	  8910	  8914	  8915	  8923
	  8924	  8931	  8932	  8933	  8934	  8936	  8938	  8939	  8944	  8954	  8957	  8958	  8968	  8969
	  8971	  8972	  8973	  8974	  8977	  8979	  8980	  8992	  8993	  8995	  8996	  9001	  9021	  9022
	  9024	  9025	  9028	  9035	  9036	  9055	  9057	  9058	  9059	  9063	  9065	  9067	  9069	  9071
	  9075	  9077	  9078	  9079	  9080	  9086	  9088	  9089	  9090	  9094	  9095	  9097	  9102	  9114
	  9115	  9117	  9132	  9133	  9140	  9146	  9149	  9150	  9154	  9163	  9165	  9166	  9167	  9168
	  9172	  9173	  9206	  9207	  9209	  9210	  9211	  9212	  9213	  9219	  9220	  9222	  9223	  9224
	  9225	  9226	  9235	  9236	  9237	  9239	  9240	  9243	  9244	  9245	  9251	  9252	  9253	  9254
	  9268	  9269	  9270	  9304	  9305	  9306	  9340	  9341	  9355	  9359	  9360	  9361	  9362	  9380
	  9381	  9385	  9386	  9409	  9410	  9417	  9418	  9422	  9430	  9431	  9435	  9441	  9442	  9445
	  9446	  9512	  9513	  9514	  9515	  9539	  9540	  9543	  9552	  9564	  9567	  9577	  9578	  9588
	  9590	  9591	  9592	  9593	  9594	  9612	  9615	  9630	  9631	  9637	  9642	  9643	  9655	  9657
	  9658	  9660	  9673	  9707	  9710	  9799	  9800	  9804	  9805	  9807	  9810	  9821	  9822	  9829
	  9880	  9882	  9883	  9886	  9893	  9894	  9914	  9915	  9916	  9918	  9920	  9924	  9925	  9926
	  9927	  9930	  9933	  9936	  9937	  9949	  9954	  9964	  9965	  9966	  9968	  9969	  9970	  9975
	  9979	  9980	  9981	  9995	  9996	  9997	  9998	 10012	 10013	 10024	 10025	 10026	 10027	 10028
	 10101	 10115	 10122	 10123	 10130	 10134	 10139	 10143	 10150	 10169	 10172	 10178	 10181	 10182
	 10208	 10209	 10211	 10219	 10220	 10222	 10223	 10228	 10229	 10254	 10255	 10256	 10257	 10258
	 10259	 10274	 10275	 10277	 10280	 10286	 10288	 10295	 10297	 10299	 10301	 10302	 10306	 10308
	 10309	 10330	 10331	 10341	 10342	 10355	 10356	 10362	 10363	 10396	 10397	 10398	 10402	 10403
	 10404	 10405	 10444	 10445	 10447	 10459	 10464	 10465	 10470	 10472	 10473	 10475	 10476	 10482
	 10483	 10493	 10495	 10543	 10544	 10552	 10555	 10556	 10558	 10569	 10572	 10573	 10575	 10591
	 10598	 10601	 10602	 10604	 10618	 10621	 10622	 10623	 10627	 10637	 10643	 10645	 10646	 10650
	 10651	 10655	 10656	 10668	 10669	 10674	 10675	 10676	 10679	 10680	 10685	 10686	 10690	 10695
	 10696	 10700	 10701	 10702	 10703	 10712	 10713	 10728	 10737	 10752	 10753	 10754	 10755	 10757
	 10759	 10760	 10761	 10762	 10764	 10766	 10768	 10785	 10790	 10791	 10792	 10793	 10794	 10795
	 10797	 10799	 10801	 10802	 10812	 10813	 10814	 10827	 10828	 10829	 10830	 10838	 10839	 10852
	 10858	 10868	 10869	 10872	 10880	 10881	 10883	 10892	 10893	 10896	 10897	 10901	 10906	 10907
	 10908	 10909	 10919	 10920	 10923	 11024	 11026	 11071	 11072	 11073	 11084	 11085	 11109	 11110
	 11112	 11113	 11114	 11122	 11123	 11124	 11125	 11144	 11145	 11146	 11152	 11162	 11165	 11170
	 11171	 11173	 11192	 11193	 11194	 11195	 11201	 11202	 11204	 11213	 11214	 11216	 11217	 11218
	 11219	 11220	 11221	 11222	 11232	 11238	 11241	 11249	 11250	 11251	 11257	 11259	 11260	 11261
	 11263	 11265	 11266	 11267	 11268	 11270
T2	  1096	  1097	  1098	  1100	  1101	  1103	  1104	  1106	  1107	  1108	  1118	  1119	  1120	  1123
	  1124	  1125	  1129	  1130	  1131	  1132	  1133	  1134	  1135	  1138	  1253	  1254	  1255	  1256
	  1257	  1258	  1259	  1260	  1521	  1522	  1565	  1566	  1661	  1662	  1705	  1735	  1736	  1754
	  1755	  1845	  1846	  1848	  1858	  1862	  1865	  1866	  1973	  1983	  1984	  1985	  1986	  1987
	  1988	  1989	  1990	  2031	  2034	  2039	  2045	  2052	  2053	  2054	  2276	  2292	  2341	  2352
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

	  2380	  2383	  2384	  2385	  2386	  2483	  2486	  2491	  2492	  2527	  2566	  2571	  2574	  2575	  2576
	  2577	  2616	  2621	  2624	  2629	  2631	  2634	  2635	  2638	  2648	  2661	  2708	  2709	  2710
	  2711	  2712	  2713	  2716	  2717	  2719	  2720	  2721	  2722	  2723	  2724	  2725	  2728	  2791
	  2793	  2794	  2797	  2803	  3020	  3022	  3030	  3031	  3032	  3033	  3036	  3038	  3050	  3052
	  3198	  3199	  3317	  3318	  3353	  3355	  3384	  3387	  3404	  3405	  3406	  3407	  3408	  3432
	  3433	  3465	  3466	  3470	  3489	  3490	  3502	  3508	  3509	  3510	  3512	  3515	  3517	  3518
	  3519	  3755	  3757	  3774	  3775	  3779	  3780	  3786	  3798	  3799	  3855	  3856	  3857	  3914
	  3915	  3916	  3918	  3919	  3920	  3921	  3922	  3924	  3925	  3926	  3927	  3934	  4024	  4025
	  4067	  4070	  4082	  4094	  4097	  4103	  4109	  4110	  4118	  4120	  4121	  4142	  4143	  4174
	  4177	  4185	  4205	  4206	  4207	  4208	  4209	  4210	  4211	  4359	  4362	  4363	  4364	  4365
	  4454	  4455	  4592	  4593	  4597	  4621	  4622	  4833	  4834	  4835	  4945	  4950	  5004	  5006
	  5047	  5048	  5049	  5051	  5053	  5062	  5063	  5066	  5067	  5068	  5071	  5072	  5085	  5093
	  5131	  5134	  5137	  5138	  5140	  5146	  5147	  5148	  5149	  5150	  5155	  5166	  5167	  5169
	  5170	  5188	  5190	  5192	  5193	  5201	  5202	  5204	  5205	  5207	  5213	  5214	  5215	  5218
	  5224	  5225	  5234	  5236	  5250	  5251	  5253	  5254	  5260	  5269	  5274	  5275	  5278	  5327
	  5369	  5370	  5372	  5503	  5504	  5509	  5514	  5516	  5528	  5529	  5536	  5537	  5542	  5543
	  5592	  5594	  5611	  5637	  5638	  5640	  5710	  5711	  5716	  5728	  6012	  6013	  6048	  6110
	  6214	  6216	  6218	  6221	  6224	  6225	  6249	  6250	  6261	  6265	  6348	  6349	  6351	  6352
	  6371	  6372	  6380	  6381	  6382	  6549	  6567	  6571	  6573	  6589	  6593	  6602	  6603	  6604
	  6694	  6695	  6709	  6710	  6723	  6724	  6725	  6726	  6727	  6728	  6729	  6731	  6732	  6735
	  6736	  6737	  6748	  6749	  6750	  6752	  6760	  6761	  6762	  6763	  6769	  6770	  6771	  6777
	  6779	  6795	  6796	  6798	  6808	  6810	  6812	  6819	  6820	  6824	  6825	  6826	  6827	  6828
	  6833	  6834	  6835	  6836	  6838	  6844	  6845	  6846	  6847	  6849	  6877	  6965	  6969	  6970
	  6971	  6972	  7019	  7020	  7021	  7161	  7164	  7166	  7172	  7175	  7176	  7187	  7328	  7329
	  7396	  7397	  7398	  7404	  7456	  7457	  7464	  7465	  7483	  7484	  7486	  7487	  7488	  7489
	  7490	  7492	  7494	  7495	  7497	  7500	  7501	  7502	  7503	  7506	  7509	  7510	  7512	  7514
	  7516	  7524	  7529	  7532	  7534	  7544	  7569	  7574	  7580	  7597	  7599	  7601	  7602	  7603
	  7614	  7631	  7633	  7676	  7677	  7678	  7694	  7696	  7698	  7803	  7804	  7810	  7811	  7830
	  7831	  7837	  7838	  7867	  7868	  7869	  7870	  7871	  7883	  7894	  7898	  7899	  7914	  7932
	  7933	  7934	  7935	  7951	  7969	  7970	  7971	  7973	  7974	  7978	  7979	  7993	  8004	  8100
	  8101	  8186	  8187	  8212	  8224	  8226	  8229	  8230	  8232	  8233	  8234	  8237	  8238	  8255
	  8256	  8264	  8275	  8276	  8283	  8284	  8287	  8288	  8289	  8291	  8292	  8293	  8294	  8295
	  8298	  8313	  8314	  8320	  8324	  8325	  8326	  8328	  8400	  8401	  8402	  8405	  8410	  8411
	  8412	  8413	  8414	  8420	  8422	  8423	  8425	  8442	  8445	  8447	  8452	  8454	  8463	  8589
	  8590	  8591	  8592	  8593	  8594	  8596	  8597	  8598	  8599	  8601	  8602	  8603	  8604	  8690
	  8693	  8696	  8703	  8704	  8717	  8725	  8729	  8730	  8731	  8732	  8749	  8750	  8752	  8755
	  8756	  8762	  8763	  8801	  8804	  8807	  8814	  8815	  8824	  8825	  8827	  8888	  8891	  8892
	  8895	  9290	  9291	  9298	  9314	  9315	  9319	  9334	  9346	  9356	  9357	  9475	  9478	  9613
	  9616	  9638	  9656	  9661	  9662	  9672	  9818	  9819	  9820	  9881	  9885	  9959	 10007	 10011
	 10015	 10017	 10025	 10028	 10029	 10103	 10107	 10121	 10132	 10141	 10144	 10145	 10148	 10149
	 10168	 10179	 10180	 10183	 10186	 10187	 10192	 10193	 10214	 10215	 10216	 10217	 10276	 10281
	 10290	 10292	 10295	 10299	 10304	 10307	 10310	 10395	 10399	 10400	 10401	 10730	 10843	 10845
	 10851	 10853	 10854	 10855	 10857	 10860	 10873	 10882	 10884	 10886	 10898	 10910	 10962	 10965
	 10968	 10976	 10979	 10985	 10988	 10991	 11024	 11027	 11030	 11159	 11160	 11165	 11166
T2POPJ	  9300%	  9300
T3	  1936	  1959	  1970	  1971	  1972	  2040	  2093	  2103	  2104	  2105	  2106	  2108	  2121	  2122
	  2123	  2132	  2237	  2251	  2259	  2266	  2417	  2418	  2422	  2435	  2437	  2438	  2498	  2499
	  2643	  2653	  2658	  2744	  2755	  2757	  2759	  2764	  2765	  2766	  2768	  2788	  2789	  2810
	  2811	  2812	  2814	  3229	  3254	  3255	  3256	  3257	  3258	  3259	  3263	  3466	  3467	  3469
	  3472	  3476	  3491	  3492	  3493	  3503	  3513	  3530	  3591	  3592	  3691	  3692	  3702	  3703
	  3723	  3724	  3748	  3749	  3759	  3766	  3787	  3806	  3807	  3810	  3811	  3942	  3966	  3967
	  3968	  3969	  4011	  4021	  4073	  4100	  4178	  4181	  4182	  4183	  4192	  4305	  4422	  4423
	  4427	  4485	  4486	  4499	  4505	  4506	  4522	  4523	  4527	  4533	  4543	  4544	  4548	  4549
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

	  4564	  4567	  4568	  4569	  4602	  4603	  4604	  4608	  4609	  4614	  4704	  4705	  4706	  4712	  4713
	  4714	  4716	  4717	  4818	  4828	  4829	  4897	  4898	  4899	  4900	  5086	  5131	  5150	  5158
	  5193	  5325	  5326	  5353	  5405	  5407	  5408	  5409	  5454	  5455	  5457	  5458	  5677	  5680
	  5683	  5686	  5687	  5689	  5690	  5695	  5700	  5709	  5720	  5722	  5739	  5740	  5748	  5752
	  5754	  5756	  5760	  5764	  5770	  5809	  5810	  5815	  5816	  5817	  5826	  5827	  5831	  5840
	  5841	  5881	  5882	  5886	  5887	  5888	  5903	  5909	  5910	  5911	  5935	  5951	  5952	  5954
	  5955	  5957	  5959	  5960	  5961	  5963	  5964	  5967	  5969	  5970	  6010	  6011	  6052	  6053
	  6054	  6057	  6115	  6116	  6117	  6133	  6134	  6135	  6136	  6137	  6138	  6139	  6140	  6141
	  6142	  6143	  6144	  6145	  6146	  6147	  6148	  6149	  6150	  6151	  6152	  6153	  6154	  6278
	  6279	  6438	  6441	  6445	  6449	  6456	  6461	  6552	  6576	  6591	  6594	  6605	  6620	  6693
	  6708	  6747	  6757	  6758	  6759	  6768	  6776	  6794	  6797	  6802	  6807	  6818	  6876	  6880
	  6939	  6940	  6966	  6967	  6968	  6975	  6976	  6977	  6983	  6984	  6985	  7056	  7057	  7505
	  7507	  7513	  7515	  7533	  7542	  7545	  7554	  7555	  7628	  7629	  7684	  7685	  7690	  7691
	  7692	  7693	  7696	  7697	  7698	  7724	  7726	  7732	  7750	  7752	  7760	  7775	  7777	  7872
	  7873	  7884	  7885	  7886	  7889	  7890	  7892	  7948	  7949	  7974	  7975	  7976	  7977	  7980
	  7981	  7994	  7995	  7996	  7999	  8000	  8002	  8308	  8314	  8315	  8316	  8318	  8323	  8330
	  8442	  8443	  8454	  8455	  8457	  8458	  8459	  8460	  8698	  8700	  8701	  8702	  8705	  8764
	  8780	  8783	  8796	  8809	  8811	  8812	  8813	  8826	  8827	  8837	  8838	  8844	  9181	  9187
	  9292	  9293	  9322	  9327	  9330	  9331	  9332	  9338	  9339	  9342	  9344	  9351	  9364	  9365
	  9366	  9367	  9368	  9372	  9373	  9374	  9375	  9382	  9387	  9390	  9392	  9470	  9482	  9483
	  9484	  9486	  9487	  9489	  9492	  9495	  9522	  9527	  9555	  9559	  9560	  9563	  9565	  9568
	  9578	  9579	  9585	  9586	  9593	  9614	  9618	  9639	  9652	  9653	  9662	  9692	  9693	  9695
	  9696	  9697	  9698	  9699	  9700	  9701	  9702	  9703	  9956	  9957	  9970	  9984	  9985	  9990
	 10296	 10297	 10298	 10300	 10756	 10758	 10763	 10767	 10796	 10797	 10798	 10800	 10840	 10841
	 10842	 11025	 11027	 11028	 11152	 11153	 11171	 11209	 11211	 11253	 11254	 11256	 11257	 11258
	 11262	 11263	 11265	 11267	 11268
T4	  1226	  1227	  1228	  1229	  1230	  1231	  1232	  1638	  1648	  1669	  1681	  1687	  1697	  1728
	  2023	  2024	  2026	  2027	  2028	  2062	  2090	  2092	  2093	  2094	  2095	  2243	  2260	  2272
	  2316	  2348	  2359	  2360	  2361	  2366	  2370	  2374	  2377	  2410	  2445	  2446	  2449	  2452
	  2453	  2456	  2459	  2460	  2464	  2467	  2468	  2471	  2472	  2473	  2474	  2475	  2498	  2538
	  2674	  2675	  2680	  2691	  2745	  2746	  2752	  2753	  2761	  2763	  2799	  2809	  2824	  2829
	  2854	  2885	  2957	  2962	  3071	  3072	  3073	  3074	  3096	  3272	  3355	  3356	  3387	  3388
	  3390	  3430	  3434	  3435	  3471	  3472	  3473	  3504	  3505	  3506	  3507	  3508	  3509	  3513
	  3514	  3519	  3520	  3521	  3522	  3523	  3524	  3695	  3696	  3699	  3700	  4238	  4239	  4282
	  4283	  4483	  4497	  4498	  4502	  4503	  4573	  4580	  4586	  4591	  4592	  4594	  4602	  4605
	  4606	  4607	  4612	  4613	  4632	  4640	  4642	  4646	  4649	  4654	  4655	  4659	  4660	  4661
	  4667	  4670	  4677	  4680	  4704	  4712	  4715	  4819	  5362	  5697	  5698	  5700	  5701	  5707
	  5721	  5724	  5725	  6262	  6266	  6281	  6568	  6569	  6570	  7478	  7497	  7526	  7527	  7530
	  7531	  7532	  7533	  7536	  7537	  7620	  7623	  7679	  7695	  7705	  7882	  7884	  7887	  7888
	  7891	  7893	  7895	  7992	  7994	  7997	  7998	  8001	  8003	  8005	  8309	  8312	  8317	  8324
	  8328	  8329	  8769	  8770	  9049	  9050	  9075	  9076	  9085	  9099	  9101	  9103	  9113	  9635
	  9636	 10202	 10203
TABPTR	  2468	  4655	  4803#
TABTMR	   207#	  1848	  6708	  6724	  6729
TABTMS	   237#	   260	  3696	  6710	  6723	  6725
TAKNZJ	   112%	 10899	 10911	 10924
TAKOTJ	   112%	 10874	 10885
TAKTRJ	   112%	  1619	  1656	  1840	  1883	  2083	  5106	  6616	  7186	 10729
TAKTRP	   112%	  1530	  5573	 11172
TATUU1	 10477	 10482#
TATUUO	 10459#
TBFL	  4661	  4770#
TBFL2	  4660	  4775#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

TCBALL	   161#
TCNBSD	   155#	  6527	 10087
TCNBSP	   155#	  6511	 10082
TCNCLA	   155#	  6528	 10089
TCNCRD	   155#	  5999	  6476
TCNDEF	   155#	  6515	 10085
TCNDSP	  6591	  6627#	  6692	  6705
TCNECH	   155#	  6508	 10088
TCNERA	   155#	  6514	 10083
TCNFC1	   155#	  6488	 10074	 10169
TCNFC2	   155#	  6489	 10075	 10172
TCNFRM	   155#	  6004	 10066
TCNHDX	   155#	  5998	  6480	 10069
TCNIR	   155#	  6477	 10076
TCNKAT	   155#	  6530	 10091
TCNLCO	   155#	  6517	 10086
TCNLCT	   155#	  6001	 10067
TCNN	   156#	   157	   161	  6588
TCNNFC	   155#	  6000	 10070
TCNNXO	   155#	  6484
TCNOR	   155#	  6478	 10077
TCNPA	   155#	  6481	 10078
TCNPAR	   155#	  6479
TCNPB	   155#	  6482	 10079
TCNPC	   155#	  6483	 10080
TCNPD	   155#	  6510	 10081	 10150
TCNPTP	   155#	  6003	 10072	 10073
TCNRTC	   155#	  6529	 10090
TCNRXE	   155#	  6509	 10084
TCNTAB	   155#	  6002	 10065
TCNTYP	   155#	  6531	 10092
TCNWID	   155#	  6487	 10071
TCNXON	   155#	  6507
TCVMAX	  6589	  6659#
TDTUUO	 10327#
THSDAT	    91%
THSTIM	  1106%	  1106	  1107%	  1107	  1227%	  1227	  1229%	  1229	 11190%	 11190
TIHLTN	  2062	  6972	 11522#
TILOW	    58#	 11520	 11527
TIMDRD	  4863	  4865	  8349	  8531	 11372#
TIME	    91%
TIMMIN	  4858	  4860	 11371#
TIMOW	  4876	  4879	  4930	 11484#
TIMRST	 10447%	 10447	 10627%	 10627
TINAS1	 11024#	 11168
TINASS	 11152#
TINDET	 11158	 11162#
TINFIO	   648#	  5102	  5107	 11128
TIOUSE	   649#	  5575	  7221	  9177	  9199	  9896	  9903	 10360
TIRSVD	    54#	  2024	  2980	  4958	  7020	  8867	  8934	  8969	  8974
TIWAIT	  8615	  8787	  9120	  9143	  9159#
TIWAKE	  4999#	  5115	  5576	  7225	 10932
TIWAKN	  5000	  5010#	  9194
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

TIWKC	    55#	    56	    58	  2243	  2260	  2272	  2316	  2348	  2538	  4239	  4283	  5357	  5362	  5868
	  7011	  9102	  9115	  9213	 11073
TIWRNN	  2028	  3181	  9254	 11520#
TKATT%	  5666#	  5691
TKBSY%	  5667#	  5703
TKEXS%	  5665#	  5684
TKROM%	  5664#	  5715
TMCALL	   197#	  3723
TMCCIE	   195#
TMCCRD	   195#	  6627
TMCECH	   195#	  6636
TMCECO	   195#
TMCECR	   195#	  6799
TMCELF	   195#
TMCESC	   195#
TMCHDX	   195#	  6631
TMCIR	   195#	  6628
TMCKAT	   195#	  6655	  6719	  6723	  6724	  6731
TMCOOR	  1854	 11557#
TMCOR	   195#	  6629
TMCPA	   195#	  6632
TMCPAR	   195#	  6630
TMCPB	   195#	  6633
TMCPC	   195#	  6634
TMCPD	   195#	  6638	  6718	  6725	  6729	  6731
TMCQM	   195#
TMCRXE	   195#	  6637
TMCSIZ	   264#	   508	   509	  2138	  6393	  7341
TMCSLP	   261#
TMCSPA	   195#
TMCTOB	   195#
TMCXON	   195#	  6635
TOEMAX	  5426	  8879	 11540#
TOWAIT	  9172#
TOWAT1	  7032	  8626	  8911	  8947	  8959	  9175#
TOWATA	  8926	  9031	  9896#
TPOPJ	    87%	  5030	  5034	  6595	  9255	  9562	  9569	  9934	 10213	 10218	 10461	 10463	 10466	 10469
	 10900	 10902	 10912	 11126	 11147
TPOPJ1	    87%	  5038	  5616	  6599	  9256	 10118	 10119	 11148
TRESCN	  9290#
TRESCU	  5797	  5848#
TRMAUX	  2234#
TRMBYP	   525#	  2100	  3792
TRMTAB	  2101	  2200#
TRPLEN	   595#	   636	 10806	 11009	 11166
TSETBI	  1533	  2734	  2879	  3551	  3847	  3887	  5156	  5230#	  5798	  6470	  7035
TSETBO	  2673	  2880	  2894	  3550	  3846	  3886	  5260#	  5799	  6471	  9502	  9884
TSTBO1	  5262#
TSTBO2	  5272	  5275#
TSTDRU	  7545	  7549#
TSTKTJ	   112%	  7026	  8611	  8622	  8899	  8955	  9002	  9029	  9118	  9141
TSTKTP	   112%	  8945
TSTTRJ	   112%
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

TT2CHK	    50#	 11263	 11268
TTCCLR	 10067	 10069	 10070	 10086	 10100#
TTCCNT	  5738	  6536#	  6542
TTCDO1	 10102	 10107#
TTCFIL	 10068	 10163#
TTCFIN	 10110#
TTCFL0	 10163	 10168#
TTCFL1	 10167	 10169#
TTCGO	 10104	 10108	 10124	 10153#	 10170	 10173
TTCHKS	    49#	    50	  5149	  7017	  7018	 11251	 11256	 11265	 11266
TTCLST	 11249%	 11249	 11253%	 11253
TTCMCA	  9291	  9314	  9319	 11467#
TTCMCH	  9293	  9330	  9344	 11466#
TTCNEG	  6535#	  6536	  6540
TTCNO	 10064	 10095#
TTCSET	 10065	 10066	 10072	 10073	 10082	 10083	 10084	 10085	 10087	 10088	 10090	 10091	 10101#
TTCSIX	 10089	 10130#
TTCTYP	 10092	 10139#
TTCVAL	 10071	 10074	 10075	 10076	 10077	 10078	 10079	 10080	 10081	 10115#
TTCVL0	 10116	 10121#
TTCVL1	 10120	 10122#
TTCVL2	 10123#	 10135	 10147
TTCVL3	 10124#	 10151
TTCWDD	 10028	 10064#	 10101	 10123
TTCWDN	 10024	 10061#	 10062
TTCWDT	 10025	 10032#	 10061
TTFORC	  2182	  2865	  5037	  9273#	  9830	 11243
TTFREE	  2481%	  2481	  5058%	  5058	  5061%	  5061	  5063%	  5063	  5068%	  5068	  5173%	  5173	  5184%	  5184
	  5204%	  5204	  5205%	  5205	  5213%	  5213	  5219%	  5219	 11252%	 11252
TTFREN	  2023	  2979	  4957	  5064	  5187	  5206	  5226	  7019	  8866	  8933	  8968	  8973	 11254	 11255
	 11264	 11460#
TTGC1	  5141	  5155#
TTGETC	  2795	  4068	  4095	  4175	  5130#	  6111	  6276	  8691	  8802	  9317	  9476
TTIEND	 11273#
TTINI2	 11200#	 11245
TTINI3	 11212	 11215	 11245#
TTINI4	 11265#	 11269
TTKJOB	  5581%	  5581
TTNCHR	   600#
TTNEGL	  6534#	  6535	  6536	  6540
TTNESC	   599#
TTNLIN	   601#
TTNYLB	   602#
TTOUT1	  5388	  5391#
TTOUT2	  5399#	  5412
TTOUT3	  5400	  5403	  5405#
TTOUT4	  5409	  5412#
TTOUT5	  5392	  5413#
TTPC1	  5168	  5193#
TTPC2	  5172	  5192#
TTPUTC	  2033	  2485	  5166#	  8894
TTSCL1	 10982	 10992#
TTSCL2	 10971#	 10995
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

TTSCL3	 10973	 10993#
TTSCLR	 10960#
TTTCL1	 11002#	 11017
TTTCL2	 11015#
TTTCLR	 10998#
TTUNEG	  5784#	  6534
TTUUOT	  5739	  5789#	  6534
TTVIN2	    99%	  9816
TTVINI	    99%	 11211
TTYAT1	 10417	 10436#	 11236
TTYAT2	 10439	 10442#
TTYATC	  1920	  5028	  5542	  6419	  7140	  7165	  8634	  8914	  8923	  8992	  9021	  9149	 10274	 10362
	 10444	 10702	 10712	 10801	 10829
TTYATI	  2179	  9827	 10432#
TTYATT	 10413#	 10468
TTYBCN	  8085#	  8099
TTYBMT	  1386#	  1445	  1468	  1471	  1473	  1476	  1478	  1480	  1482	  1484	  1487	  1489	  1492	  1495
	  1500	  1503	  1511	  1761
TTYBNP	  1641#	  1672
TTYBPN	  1409#
TTYCMR	  9417#
TTYDET	 10333	 10337#
TTYERP	  9870#
TTYFLK	 10785	 11477#
TTYFLM	  5069#
TTYFND	  9841#	 10370
TTYFNU	  5441	  5737	  6080	  9840#	  9891
TTYFUW	  9891#
TTYFW1	  9892#	 10372
TTYHLT	  9440#
TTYIN	  5294	  5300#
TTYIN1	  5323#	  5328
TTYIN3	  5324	  5329#
TTYIN5	  5310#	  5342
TTYIN6	  5334	  5339#
TTYIN8	  5335#	  5341
TTYINI	  5289	 11185	 11187#
TTYINX	  5303	  5336#
TTYKD1	 10308#	 10310
TTYKDB	  6326	  7136	  7223	 10261	 10268	 10272#	 10364
TTYKIL	 10248#
TTYLOS	  1829	 11543	 11545#
TTYLST	   615#	 11232
TTYMXL	 10062#
TTYNAM	  9954#
TTYNFB	  8247#	  8253
TTYNFR	 10823#
TTYNNC	  5156#
TTYNPB	  3385	  3402#
TTYOUS	  5380	  5431#
TTYOUT	  5293	  5378#	  5382
TTYOUW	   645#	  4161	  4997	  5113	  9004	  9159	  9175	  9896	  9907
TTYPH2	  9925	  9936#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

TTYPH3	  9928	  9933#
TTYPH4	  9924#	  9931
TTYPHY	  9914#	  9946
TTYPTY	  2976#	  3003
TTYRES	  5619#
TTYRHT	  2075	 11530#
TTYRS1	  5624	  5635#	  5639	  5642
TTYSET	  5856#
TTYSOW	  9907#
TTYSRC	  9841	  9859#	  9870	 10327	 10415	 10433	 10460	 10823
TTYSTC	  9421#	 10480
TTYSTR	  9425#
TTYSZS	  5320	  5369#	  5398
TTYTAB	    90%	  5594	  5619	  5686	  6409	  7157	  7161	  7162	  7460	  7577	  9860	 10198	 10256	 10450
	 10612	 10685	 10832	 10947	 11137	 11156
TTYTBL	 10033#
TTYUS0	  9398	  9404#
TTYUS1	  9406	  9409#
TTYUSM	  9403#
TTYUSR	  9397#
TTYUSW	  9396#
TTYUU1	  5741	  5744	  5748#
TTYUU2	  5749	  5752#
TTYUU3	  5757	  5760#
TTYUUO	  5465	  5737#	  5759
TTYWAK	 10927#
TTYWK1	 10930	 10942#	 10970	 10994	 11001	 11016
TTYWK2	 10931#	 10941
TTYWK3	 10935	 10938#
TTYYLS	 11120#
TTYZAP	  2169	  2188	  5541	  5558	  7192	  7204	  7213	  7233	  7287	  7324	  7606	 10248	 10267	 10345
	 10395#
TTYZNE	  1632#
TTYZP1	 10397	 10400#
TUUAIR	  5752	  5760	  5776#	  5784	  5785	  5791	  5794	  5800	  5801	  6445	  6464	  6465	  6466	  6472
	  6493	  6494	  6501	  6503	  6504
TUUATI	  5748	  5754	  5773#	  5788	  5789	  5793
TUUATO	  5740	  5754	  5774#	  5790	  5792	  5796	  5802	  5803	  5804
TUUATR	  5752	  5775#	  5797	  5798	  5799
TUUEAT	  5764	  5778#	  5785	  5788	  5789	  5791	  5793	  5794	  5800	  5801	  6449	  6464	  6465	  6466
	  6472	  6493	  6494	  6500	  6501	  6502	  6503	  6504
TUUFXI	  5779#	  5785	  5788	  5789	  5791	  5793	  5794	  5800	  5801	  6472	  6473	  6500	  6501	  6502
	  6503	  6504
TUUIMI	  5780#	  6456	  6464	  6465	  6466
TUUROM	  5756	  5777#	  5790	  5792	  5802	  5803	  5804	  6441	  6467	  6468	  6469	  6505	  6506	  6519
TWABT	  9142	  9145	  9157#
TWAITC	  5448	  5788	  6062	  6936	  9130#	  9154
TWAITL	  5306	  6033	  6045	  6956	  9092#	  9123
TWAITS	  6024	  6949	  9126#
TWTC1	  9139	  9143#
TWTC2	  9148	  9154#
TWTL1	  9106	  9113#
TWTL2	  9111	  9113	  9116	  9120#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

TWTL3	  9112	  9117#
TWTSPC	   646#	  4954	  5621	  7023	  8869	  8957
TYCIOS	 10349#
TYI	  5323	  5452	  6026	  6034	  6046	  6063	  6937	  6951	  6957	  8685#	  8790
TYI940	  8730	  8731	  8741#
TYIALT	  8734	  8762#
TYIATB	  8704	  8708#
TYIBRK	  8735	  8741	  8744	  8752#	  8758	  8761	  8765	  8768	  8771	  8773	  8785
TYIBSP	  8739	  8747	  8755#
TYIC	  8712	  8716#	  8751	  8757
TYICC	  8733	  8742	  8743	  8774#
TYICCP	  8745	  8772#
TYICZ	  8736	  8767#
TYID	  8719#	  8821	  8829
TYIEAT	  5765	  6450	  8685	  8794#	  9014	  9429
TYIET2	  8800	  8841#
TYIET3	  8820	  8828	  8832	  8833	  8834	  8835	  8836	  8840#
TYIL	  8798#	  8810	  8816	  8819	  8822	  8830
TYIOS1	 10353#	 10359	 10365
TYIOS2	 10351	 10355#
TYIPAL	  8737	  8760#
TYIPDP	  8729	  8732	  8733#
TYIRPT	  8704#	  8753
TYITAB	  8738	  8746	  8749#
TYMTC	  6627	  6628	  6629	  6630	  6631	  6632	  6633	  6634	  6635	  6636	  6637	  6638	  6655	  6705#
TYMTC1	  6706#	  6800
TYMTC2	  6721	  6734#
TYO	  5410	  5818	  5842	  5883	  5904	  8866#	  8905	  8913
TYO1	  8868	  8873#
TYO2	  8877	  8881#
TYO3	  8889	  8894#
TYOW	  8880	  8898#	  8917
TYOW1	  8903	  8907#
TYOW2	  8871	  8908#
TYOW3	  8907	  8911#
TYOW4	  8912#
TYP.00	  1445#
TYPANS	   675#	  1319	  1396	  1447#	  8390	 10181
TYPAUX	   693#	  1453#
TYPAXC	   744#	  1471#	  7393
TYPBIN	   786#	  1495#	  3955
TYPBKO	   780#	  1492#	  3987
TYPBOC	   783#	  1494#
TYPBRK	   813#	  1507#	  8374
TYPCLP	   774#	  1268	  1489#	  8382
TYPCLR	   777#	  1406	  1491#
TYPEAD	   819#	  1509#
TYPECF	   759#	  1480#	  3732
TYPECN	   756#	  1478#	  3729
TYPEDC	   708#	  1458#
TYPETM	   729#	  1465#
TYPGOB	   702#	  1456#	  3717
TYPGRN	   714#	  1460#	  4139
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

TYPHNG	   726#	  1464#	  3737
TYPHSI	   771#	  1274	  1294	  1487#	  8358	  8443	  8455
TYPIHR	   801#	  1502#
TYPINB	   789#	  1497#
TYPINE	   792#	  1498#
TYPINT	   795#	  1499#
TYPIRQ	   798#	  1500#	  4056
TYPKAF	   825#	  1511#
TYPLAD	   822#	  1510#
TYPLDC	   711#	  1459#
TYPLOG	   690#	  1452#
TYPLOS	   735#	  1467#
TYPLTM	   732#	  1466#
TYPNEG	   810#	  1506#
TYPNOP	   696#	  1454#	  3800
TYPNSP	   687#	  1402	  1451#
TYPOHR	   807#	  1505#
TYPORG	   723#	  1463#	  4141
TYPORQ	   804#	  1503#	  4051
TYPOUP	   699#	  1455#	  3781
TYPPSR	   816#	  1508#
TYPRAK	   684#	  1266	  1400	  1450#
TYPRED	   717#	  1461#	  3712
TYPRES	   681#	  1399	  1449#
TYPSAD	   753#	  1476#	 10221
TYPSHT	   678#	  1317	  1397	  1448#	  8366	 10178
TYPSUP	   738#	  1468#	  7380
TYPSUR	   741#	  1403	  1470#
TYPTCP	   765#	  1484#	  3722
TYPTCR	   768#	  1486#
TYPTCS	   762#	  1482#	  3694
TYPTRN	  1387	  1444#	  1515
TYPTSP	   747#	  1473#
TYPTSR	   750#	  1405	  1475#
TYPYEL	   720#	  1462#	  4134
TYPZAP	   705#	  1457#	  3854
U	   207	   208	   209	   210	   211	   212	   213	   214	   215	   216	   217	   218	   219	   220
	   221	   222	   223	   224	   225	   226	   227	   237	   238	   239	   240	   241	   242	   243
	   244	   245	   246	   247	   248	   249	   250	   251	   252	   253	   254	   255	   256	   257
	   309	   310	   311	   312	   313	   314	   315	   316	   317	   318	   319	   320	   321	   322
	   323	   324	   325	   326	   327	   328	   329	   330	   331	   525	   527	   528	   530	   531
	   532	   533	   534	   535	   537	   539	   541	   542	   544	   545	   546	   547	   548	   549
	   550	   552	   553	   554	   555	   556	   557	   558	   559	   560	   561	   563	   564	   565
	   566	   567	   568	  1378	  1379	  1381	  1382	  1408	  1518	  1525	  1532	  1539	  1540	  1545
	  1547	  1552	  1557	  1563	  1568	  1572	  1575	  1576	  1580	  1581	  1585	  1592	  1599	  1601
	  1614	  1615	  1621	  1625	  1630	  1647	  1654	  1662	  1701	  1704	  1718	  1722	  1731	  1732
	  1737	  1747	  1749	  1750	  1754	  1757	  1834	  1835	  1877	  1879	  1880	  1888	  1893	  1898
	  1900	  1901	  1902	  1906	  1908	  1911	  1912	  1914	  1916	  1918	  1931	  1949	  1965	  2026
	  2027	  2031	  2034	  2035	  2037	  2044	  2047	  2052	  2053	  2054	  2055	  2056	  2057	  2058
	  2059	  2060	  2066	  2077	  2078	  2086	  2090	  2094	  2105	  2109	  2116	  2123	  2124	  2126
	  2127	  2128	  2130	  2132	  2141	  2142	  2153	  2155	  2159	  2160	  2164	  2167	  2245	  2276
	  2277	  2290	  2291	  2292	  2300	  2301	  2309	  2324	  2330	  2332	  2339	  2340	  2341	  2352
	  2353	  2362	  2365	  2408	  2413	  2415	  2418	  2419	  2429	  2433	  2437	  2442	  2446	  2447
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

	  2453	  2454	  2460	  2461	  2465	  2483	  2486	  2487	  2491	  2492	  2493	  2502	  2512	  2513	  2526
	  2527	  2528	  2536	  2537	  2546	  2547	  2564	  2565	  2566	  2623	  2632	  2637	  2649	  2665
	  2672	  2676	  2679	  2681	  2705	  2707	  2708	  2710	  2712	  2714	  2716	  2717	  2718	  2721
	  2724	  2725	  2728	  2731	  2732	  2737	  2745	  2752	  2763	  2774	  2785	  2788	  2790	  2791
	  2797	  2798	  2801	  2802	  2803	  2804	  2805	  2806	  2818	  2824	  2827	  2829	  2850	  2862
	  2871	  2875	  2882	  2883	  2893	  2899	  2955	  2958	  2960	  2961	  2964	  2965	  2975	  2978
	  2989	  3002	  3005	  3016	  3019	  3027	  3039	  3044	  3053	  3063	  3068	  3097	  3098	  3170
	  3173	  3182	  3183	  3188	  3194	  3201	  3219	  3240	  3242	  3246	  3249	  3251	  3267	  3277
	  3278	  3302	  3304	  3306	  3318	  3327	  3329	  3336	  3341	  3343	  3345	  3350	  3351	  3358
	  3365	  3367	  3369	  3379	  3381	  3382	  3397	  3400	  3412	  3414	  3416	  3428	  3433	  3437
	  3440	  3454	  3457	  3459	  3462	  3469	  3479	  3486	  3499	  3544	  3545	  3547	  3549	  3553
	  3554	  3556	  3558	  3560	  3568	  3572	  3573	  3691	  3701	  3707	  3730	  3755	  3756	  3775
	  3780	  3786	  3794	  3799	  3807	  3808	  3810	  3816	  3817	  3821	  3832	  3833	  3843	  3845
	  3848	  3851	  3852	  3853	  3863	  3874	  3875	  3883	  3885	  3888	  3891	  3892	  3893	  3919
	  3920	  3921	  3922	  3923	  3925	  3926	  3927	  3942	  3966	  3969	  3985	  4050	  4063	  4067
	  4070	  4073	  4076	  4081	  4082	  4084	  4090	  4094	  4097	  4100	  4103	  4109	  4118	  4119
	  4131	  4133	  4143	  4150	  4155	  4157	  4167	  4170	  4174	  4177	  4192	  4197	  4238	  4242
	  4253	  4254	  4268	  4278	  4282	  4286	  4291	  4295	  4300	  4311	  4317	  4325	  4330	  4338
	  4343	  4349	  4354	  4410	  4416	  4423	  4424	  4431	  4447	  4453	  4467	  4468	  4477	  4478
	  4496	  4505	  4518	  4521	  4523	  4526	  4532	  4543	  4545	  4565	  4587	  4605	  4641	  4652
	  4665	  4675	  4689	  4715	  4816	  4882	  4883	  4884	  4885	  4893	  4902	  4913	  4915	  4916
	  4924	  4931	  4934	  4936	  4943	  4945	  4947	  4949	  4975	  4992	  4993	  5014	  5023	  5026
	  5076	  5090	  5093	  5096	  5099	  5110	  5234	  5236	  5238	  5239	  5240	  5241	  5242	  5243
	  5244	  5245	  5246	  5247	  5248	  5249	  5251	  5252	  5254	  5260	  5262	  5263	  5264	  5265
	  5266	  5271	  5273	  5277	  5278	  5302	  5308	  5317	  5318	  5340	  5344	  5365	  5380	  5390
	  5391	  5402	  5403	  5419	  5424	  5425	  5450	  5516	  5518	  5529	  5535	  5537	  5538	  5540
	  5556	  5557	  5596	  5623	  5624	  5625	  5629	  5708	  5709	  5717	  5729	  5744	  5747	  5753
	  5761	  5822	  5849	  5853	  5854	  5858	  5860	  5865	  5866	  5870	  5871	  5872	  5892	  5920
	  5927	  5949	  5954	  5959	  5961	  5966	  5967	  5968	  5969	  6041	  6069	  6074	  6075	  6076
	  6077	  6079	  6081	  6082	  6089	  6101	  6106	  6107	  6110	  6121	  6125	  6161	  6173	  6178
	  6180	  6187	  6193	  6194	  6196	  6215	  6219	  6234	  6236	  6245	  6247	  6249	  6250	  6251
	  6261	  6262	  6265	  6266	  6287	  6290	  6296	  6299	  6317	  6327	  6328	  6329	  6360	  6361
	  6362	  6368	  6369	  6383	  6386	  6387	  6388	  6391	  6395	  6396	  6398	  6400	  6401	  6432
	  6433	  6446	  6459	  6558	  6559	  6561	  6563	  6570	  6577	  6598	  6604	  6606	  6611	  6612
	  6619	  6732	  6737	  6741	  6778	  6782	  6783	  6788	  6855	  6856	  6858	  6864	  6886	  6898
	  6901	  6903	  6923	  6945	  6946	  6970	  6971	  6982	  6999	  7000	  7005	  7036	  7040	  7042
	  7044	  7088	  7090	  7092	  7143	  7145	  7174	  7176	  7183	  7193	  7194	  7202	  7206	  7211
	  7212	  7215	  7216	  7217	  7219	  7232	  7286	  7296	  7301	  7331	  7333	  7336	  7337	  7338
	  7339	  7345	  7346	  7348	  7350	  7352	  7353	  7462	  7463	  7465	  7471	  7472	  7587	  7590
	  7591	  7605	  7625	  7626	  7642	  7643	  7654	  7655	  7686	  7691	  7692	  7722	  7724	  7742
	  7747	  7750	  7763	  7766	  7769	  7775	  7784	  7793	  7799	  7803	  7826	  7830	  7852	  7898
	  7948	  7954	  7958	  7962	  8009	  8040	  8041	  8077	  8078	  8122	  8129	  8135	  8137	  8143
	  8145	  8148	  8156	  8158	  8171	  8174	  8175	  8186	  8198	  8200	  8205	  8534	  8535	  8536
	  8538	  8543	  8544	  8547	  8554	  8556	  8561	  8562	  8563	  8564	  8568	  8632	  8633	  8640
	  8643	  8646	  8658	  8660	  8663	  8668	  8671	  8674	  8681	  8686	  8687	  8690	  8693	  8694
	  8695	  8697	  8711	  8713	  8716	  8719	  8722	  8750	  8756	  8760	  8763	  8767	  8772	  8774
	  8784	  8790	  8794	  8798	  8799	  8801	  8804	  8805	  8806	  8808	  8826	  8827	  8840	  8842
	  8845	  8873	  8874	  8878	  8882	  8883	  8888	  8891	  8892	  8893	  8895	  8896	  8907	  8910
	  8912	  8913	  8921	  8922	  8931	  8936	  8937	  8971	  8977	  8978	  8990	  8991	  8998	  9011
	  9012	  9019	  9020	  9027	  9036	  9040	  9041	  9042	  9055	  9059	  9076	  9077	  9079	  9080
	  9090	  9095	  9097	  9098	  9099	  9100	  9101	  9105	  9107	  9110	  9114	  9123	  9133	  9135
	  9136	  9138	  9148	  9164	  9168	  9172	  9207	  9211	  9212	  9220	  9224	  9225	  9237	  9245
	  9252	  9253	  9266	  9269	  9276	  9290	  9304	  9315	  9336	  9381	  9386	  9391	  9404	  9405
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

	  9410	  9418	  9421	  9425	  9426	  9427	  9430	  9442	  9446	  9457	  9475	  9478	  9499	  9523	  9524
	  9526	  9532	  9533	  9802	  9814	  9815	  9816	  9819	  9820	  9823	  9862	  9872	  9879	  9882
	  9887	  9893	  9916	  9917	  9923	  9929	  9930	  9938	  9940	  9941	  9977	  9978	  9979	  9989
	  9992	 10153	 10154	 10155	 10159	 10200	 10201	 10203	 10260	 10261	 10266	 10329	 10331	 10337
	 10343	 10344	 10371	 10396	 10401	 10403	 10405	 10413	 10417	 10418	 10432	 10436	 10438	 10443
	 10462	 10463	 10465	 10483	 10589	 10590	 10596	 10615	 10616	 10651	 10656	 10701	 10748	 10750
	 10751	 10753	 10757	 10761	 10866	 10869	 10870	 10878	 10881	 10890	 10893	 10894	 10908	 10920
	 10921	 10933	 10934	 10935	 10937	 10938	 10980	 10981	 10982	 10992	 11029	 11036	 11037	 11043
	 11044	 11046	 11058	 11059	 11061	 11062	 11068	 11069	 11071	 11072	 11075	 11076	 11077	 11085
	 11091	 11092	 11094	 11096	 11098	 11114	 11120	 11121	 11125	 11196	 11197	 11200	 11201	 11202
	 11203	 11204	 11207	 11217	 11218	 11223	 11235	 11246	 11322	 11329
UBABIO	  4020#	  4024	  8224	  8229	  8232	  8292	  8293	  8314	  8326
UBAEND	  4019%	  8224	  8326
UBANXT	  4019%	  4020
UPARPT	  2695	  2696	  4731#
UPASC	  4731	  4732#
UPDKEY	  1096#
UPOPJ	  3250	  3267#	  9535
UPSHUT	  1307	  1321	 10182	 11469#
UPTIME	    90%	  1104%	  1104	  1226
USRWAK	  2257	  2274	  2351	  4285	  4912	  4975#
USRWK1	  4976	  4991#
UUOLDB	  5634	  5755	  6440	  7180	  8922	  9016	  9037	  9040#	  9408	 10771
VTFLP	  2449	  4677	  4746#
W	  1293	  1304	  2984	  3009	  3032	  3075	  3086	  3642	  3659	  3766	  3767	  4527	  4528	  4533
	  4534	  4549	  4550	  4597	  4598	  4614	  4615	  4706	  4707	  5464	  5738	  5739	  5879	  5880
	  5881	  5886	  5888	  5889	  5901	  5902	  5903	  5909	  5911	  5917	  5931	  5932	  5935	  6428
	  6434	  7097	  7589	  7597	  7615	  7633	  7705	  9183	  9185
WATLIN	  3062#	  3320	  3360	  3546	  3683	  3818	  4145	  4171	  4243	  4287
WRDOT2	  3659#	  4043	 10230
WRDOUT	  3642#	  3704	  3750	  3859	  7388	  8450
WRP3N4	   869#	  7384
WRPCH2	   868#	  3697
WRPCHR	   867#	  1285	  3695	  3724	  7401
WRPLIN	   866#	  1283	  3703	  3749	  3856	  4010	  7382	  7395
WSCHED	   105%	  5401	  7568	 10000
WSYNC	    89%	  9196	  9900
WSYNC1	  9190	  9197#
WSYNC2	  9192	  9196#
WSYNCS	  9008	  9169	  9177#
WTCHK	  3319	  4144	  4150#	  4169
XA	   621
XCTLUP	  8002#	  8004
XMTWAK	  1759	  3045	  3064	  4108	  4122	  4961	  5096#
XMTWK1	  5103	  5112#
XPNOUT	  5411	  5422#	  5819	  5843
XXCBLK	 10285	 10317#
XXCDDB	 10279	 10315#
XXCSER	 10283	 10316#
XXNBLK	 10289	 10320#
XXNDDB	 10280	 10318#
XXNSER	 10287	 10319#
XXPBLK	 10293	 10323#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

XXPDDB	 10281	 10321#
XXPSER	 10291	 10322#
XXQ	  4793#	  4793	  4801	  4801#	  4802
XXXQ	  4761#	  4761	  4762#	  4762	  4763#	  4763	  4766#	  4766	  4767#	  4767	  4768#	  4768	  4771#	  4771
	  4772#	  4772	  4773#	  4773	  4776#	  4776	  4777#	  4777	  4778#	  4778
XXXR	  4761#	  4761	  4762#	  4762	  4763	  4763#	  4764	  4766#	  4766	  4767#	  4767	  4768	  4768#	  4769
	  4771#	  4771	  4772#	  4772	  4773#	  4773	  4776#	  4776	  4777#	  4777	  4778	  4778#	  4779
YELLOW	  1462	  1604#
YELLW1	  1616	  1618	  1623#
YLBUG	    75#	  1605
ZAPAL1	  7649#	  7653	  7655	  7658
ZAPALL	  7638	  7647#
ZAPAUX	  1917	  1922	  7202#
ZAPBG0	  1631	  3914#
ZAPBG1	  3928#
ZAPBUG	  1555	  1891	  3913#	  7299
ZAPCIR	  7638#
ZAPDFR	  1573	  1628#
ZAPLOG	  1559	  1629#	  7303
ZAPLPT	  1630	 11549#
ZBGBIT	  3903#
ZBGBUG	  3897#	  3915
ZBGBYT	  3904#
ZBGDCH	  3900#
ZBGDCX	  3906#
ZBGDDB	  3901#
ZBGLIN	  3899#
ZBGLOG	  3907#
ZBGMOD	  3905#
ZBGOUT	  3902#
ZBGPC	  3898#
ZRPCNT	  7197	 11497#
ZZ	  5315#	  5315	  5326#	  5326	  5331#	  5331	  5369#	  5369	  5396#	  5396	  5405#	  5405	  5445#	  5445
	  5455#	  5455	  5458#	  5458	  5720#	  5720	  5840#	  5840	  5879#	  5879	  5881#	  5881	  5889#	  5889
	  5899#	  5899	  5901#	  5901	  5903#	  5903	  5916#	  5916	  5917#	  5917	  5929#	  5929	  5931#	  5931
	  5935#	  5935	  5945#	  5945	  5974#	  5974	  5977#	  5977	  6007#	  6007	  6054#	  6054	  6117#	  6117
	  6428#	  6428	  6434#	  6434	  6548#	  6548	  6549#	  6549	  6552#	  6552	  6565#	  6565	  6572#	  6572
	  6576#	  6576	  6825#	  6825	  6834#	  6834	  6845#	  6845	  6861#	  6861	  6870#	  6870	  6877#	  6877
	  6880#	  6880	  6966#	  6966	  6975#	  6975	  6983#	  6983	  7010#	  7010	  7050#	  7050	  7056#	  7056
	  7067#	  7067	  7097#	  7097	  7486#	  7486	  7615#	  7615	  7632#	  7632	  7676#	  7676	  7696#	  7696
	  7698#	  7698	  7932#	  7932	  7969#	  7969	  7980#	  7980	  9984#	  9984	  9990#	  9990	 10543#	 10543
	 10544#	 10544
ZZ0	 10805#	 10809	 10810	 10810#	 10811	 10811#	 11008#	 11012	 11013	 11013#	 11014	 11014#
ZZ1	  5315#	  5315	  5326#	  5326	  5331#	  5331	  5369#	  5369	  5396#	  5396	  5405#	  5405	  5445#	  5445
	  5455#	  5455	  5458#	  5458	  5720#	  5720	  5840#	  5840	  5879#	  5879	  5881#	  5881	  5889#	  5889
	  5899#	  5899	  5901#	  5901	  5903#	  5903	  5916#	  5916	  5917#	  5917	  5929#	  5929	  5931#	  5931
	  5935#	  5935	  5945#	  5945	  5974#	  5974	  5977#	  5977	  6007#	  6007	  6054#	  6054	  6117#	  6117
	  6428#	  6428	  6434#	  6434	  6548#	  6548	  6549#	  6549	  6552#	  6552	  6565#	  6565	  6572#	  6572
	  6576#	  6576	  6825#	  6825	  6834#	  6834	  6845#	  6845	  6861#	  6861	  6870#	  6870	  6877#	  6877
	  6880#	  6880	  6966#	  6966	  6975#	  6975	  6983#	  6983	  7010#	  7010	  7050#	  7050	  7056#	  7056
	  7067#	  7067	  7097#	  7097	  7486#	  7486	  7615#	  7615	  7632#	  7632	  7676#	  7676	  7696#	  7696
	  7698#	  7698	  7932#	  7932	  7969#	  7969	  7980#	  7980	  9984#	  9984	  9990#	  9990	 10543#	 10543
	 10544#	 10544
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Symbol cross reference

ZZBIT	   574#	   582	   582#	   583	   583#	   584	   584#	   585	   585#	   586	   586#	   587	   587#	   588
	   588#	   589	   589#	   590	   590#	   591	   591#	   592	   592#	   593	   593#
ZZN	   150#	   155	   155#	   156	   192#	   195	   195#	   300#	   309	   310	   310#	   311	   311#	   312
	   312#	   313	   313#	   314	   314#	   315	   315#	   316	   316#	   317	   317#	   318	   318#	   319
	   319#	   320	   320#	   321	   321#	   322	   322#	   323	   323#	   324	   324#	   325	   325#	   326
	   326#	   327	   327#	   328	   328#	   329	   329#	   330	   330#	   331	   331#	   332	   332#	   514#
	   518	   518#	  2137#	  2141	  2142	  2142#	  2143	  2143#	  6392#	  6395	  6396	  6396#	  6397	  6397#
	  7340#	  7345	  7346	  7346#	  7347	  7347#
ZZPOS	   201#	   207	   207#	   208	   208#	   209	   209#	   210	   210#	   211	   211#	   212	   212#	   213
	   213#	   214	   214#	   215	   215#	   216	   216#	   217	   217#	   218	   218#	   219	   219#	   220
	   220#	   221	   221#	   222	   222#	   223	   223#	   224	   224#	   225	   225#	   226	   226#	   227
	   227#	   231#	   237	   237#	   238	   238#	   239	   239#	   240	   240#	   241	   241#	   242	   242#
	   243	   243#	   244	   244#	   245	   245#	   246	   246#	   247	   247#	   248	   248#	   249	   249#
	   250	   250#	   251	   251#	   252	   252#	   253	   253#	   254	   254#	   255	   255#	   256	   256#
	   257	   257#
ZZWORD	   200#	   207	   208	   209	   210	   211	   212	   213	   214	   215	   216	   217	   218	   219
	   220	   221	   222	   223	   224	   225	   226	   227	   227#	   230#	   237	   238	   239	   240
	   241	   242	   243	   244	   245	   246	   247	   248	   249	   250	   251	   252	   253	   254
	   255	   256	   257	   257#	   264	   573#	   582	   583	   584	   585	   586	   587	   588	   588#
	   589	   590	   591	   592	   593
%CHBRK	  5327	  6048	  8711#	  8717	  8752
%CHRMX	    65#	  3008	  3185
%FRAUX	  6992#	  7002
%FRBIG	  6993#	  7013
%FRBRK	  6995#	  7068
%FRCMD	  6994#	  7007
%FRFUL	  6997#
%FRNBK	  6996#	  7076
%FROK	  6991#	  7081
%MS0	  9597	  9598	  9599	  9600	  9601
%MS1	  9602
%PBTIM	    71#	  3265	  3398
..	  4942#	  6538#	  6538	  6545	  9605#	  9605	  9610	 11541#	 11542	 11543	 11544
.ARATT	 10566
.ARDET	 10549
.ARHNG	  5493
.ASIDL	  7107#
.ASLOG	  7114#	  7258
.ASRQ1	  7108#	  7234	  7281
.ASRQ2	  7110#
.ASWPT	  7115#	  7305	  7311
.ASWR1	  7109#
.ASWR2	  7113#
.ASWTP	  7116#
.CPDWD	  9541%	  9541
.CPTIA	  9337	 11193%	 11193
.CPTOA	  9299%	  9299	  9513%	  9513	  9517%	  9517	 11195%	 11195
.PVHCN	  5567
.RTMCO	 10527#
.RTMCU	 10526#
.RTMSV	 10525#
.RTMUS	 10528#
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Macro/Opdef cross reference

ADJBP	  9661
CHRATR	   877#	   892	   893	   894	   895	   898	   899	   900	   901	   902	   903	   904	   905	   906
	   907	   908	   909	   910	   911	   914	   915	   916	   917	   920	   921	   922	   923	   924
	   925	   926	   927	   928	   929	   934	   935	   936	   937	   938	   939	   940	   941	   942
	   943	   944	   945	   946	   947	   948	   949	   952	   953	   954	   955	   956	   957	   958
	   959	   960	   961	   964	   965	   966	   967	   968	   969	   970	   975	   976	   977	   978
	   979	   980	   981	   982	   983	   984	   985	   986	   987	   988	   989	   990	   991	   992
	   993	   994	   995	   996	   997	   998	   999	  1000	  1003	  1004	  1005	  1006	  1007	  1008
	  1013	  1014	  1015	  1016	  1017	  1018	  1019	  1020	  1021	  1022	  1023	  1024	  1025	  1026
	  1027	  1028	  1029	  1030	  1031	  1032	  1033	  1034	  1035	  1036	  1037	  1038	  1041	  1042
	  1043	  1044	  1045
CSHIVL	  3954
EXTEND	   835#
FILLP	  4749#	  4761	  4762	  4763	  4766	  4767	  4768	  4771	  4772	  4773	  4776	  4777	  4778
GENFL	  4783#	  4793
GTLNK	 11541
IFCPU	  1261	  1328	  1342	  1765	  3943	  3954	  3973	  4038	  4837	  4980	  7450	  7451	  7944	  8047
	  8086	  8180	  8494	  9461	  9462	  9463	  9620	  9659	  9664	  9681	  9691	  9716	 11275
IFKMC	   828	  1276	  1290	  1315	  1324	  1355	  1942	  4018	  4854	  7541	  7878	  7989	  8221	  8268
	  8281	  8528	  8577	 11239	 11367
IFNCPU	  1760	  8062	  8089	  8511	  9630
IFNKMC	   840	  1309	  4031	  7467	  7557	  7874	  7982	  8513	  8572
LMOD	  2904#	  2906	  2907	  2908	  2909	  2910	  2911	  2912	  2913	  2914	  2915	  2916	  2917	  2918
	  2919	  2920	  2921	  2922	  2923	  2924	  2925	  2926	  2927	  2928	  2929	  2930	  2931	  2932
	  2933	  2934	  2935	  2936	  2937
MOVSLJ	   836#
ND	  4837	  4838
NOCHAR	  5304	  5383	  5444	  5811	  5828	  5838	  5878	  5898	  5926	  6021	  6030	  6040	  6061	  6105
	  6935	  6944	  6955	  7858	  7961	  8046
OUTBIT	   273#	   309	  3109	  3134
PFALL	  2073	  2356	  2968	  3010	  3603	  3738	  3760	  4418	  5547	  6199	  7082	  7313	  7322	  7788
	  8102	  8189	  9037	  9241	  9528	  9544	 10268	 10333	 10705
PJRST	  1177	  1441	  1533	  1633	  1663	  1706	  1713	  1759	  1840	  1917	  1922	  2182	  2188	  2194
	  2371	  2450	  2457	  2469	  2478	  2682	  2692	  2706	  2734	  2865	  2886	  2998	  3312	  3322
	  3331	  3338	  4043	  5115	  5255	  5337	  5459	  5832	  5874	  5907	  6181	  6226	  6227	  6423
	  6840	  6851	  6888	  6894	  6906	  6912	  7029	  7180	  7188	  7223	  7225	  7292	  7421	  7439
	  7442	  7767	  7776	  7794	  7849	  7937	  7972	  8138	  8146	  8269	  8557	  8616	  8678	  8916
	  8959	  9016	  9030	  9087	  9091	  9311	  9399	  9428	  9433	  9447	  9471	  9809	  9828	 10345
	 10497	 10771	 10874
PJUMPE	  1674	  1691	  1738
PRINTF	    10#	  1410	  1571	  5669	  6722	  6813	  9558	  9689
PXCT	  5315	  5326	  5331	  5369	  5396	  5405	  5445	  5455	  5458	  5720	  5840	  5879	  5881	  5889
	  5899	  5901	  5903	  5916	  5917	  5929	  5931	  5935	  5945	  5974	  5977	  6007	  6054	  6117
	  6428	  6434	  6548	  6549	  6552	  6565	  6572	  6576	  6825	  6834	  6845	  6861	  6870	  6877
	  6880	  6966	  6975	  6983	  7010	  7050	  7056	  7067	  7097	  7486	  7615	  7632	  7676	  7696
	  7698	  7932	  7969	  7980	  9984	  9990	 10543	 10544
PXGEN	  5315	  5326	  5331	  5369	  5396	  5405	  5445	  5455	  5458	  5720	  5840	  5879	  5881	  5889
	  5899	  5901	  5903	  5916	  5917	  5929	  5931	  5935	  5945	  5974	  5977	  6007	  6054	  6117
	  6428	  6434	  6548	  6549	  6552	  6565	  6572	  6576	  6825	  6834	  6845	  6861	  6870	  6877
	  6880	  6966	  6975	  6983	  7010	  7050	  7056	  7067	  7097	  7486	  7615	  7632	  7676	  7696
	  7698	  7932	  7969	  7980	  9984	  9990	 10543	 10544
RDAPR	  9700
RDIO	  8314
SCNSER - TYMNET VERSION OF SCNSER	MACRO 12.5-46.0 22:41 25-JAN-91
SCNSER.MAC	25-JAN-91 22:40		Macro/Opdef cross reference

RTYMOD	 10524#	 10637
STOPCD	    15	  1109	  1139	  1140	  1344	  1386	  1409	  1445	  1468	  1471	  1473	  1476	  1478	  1480
	  1482	  1484	  1487	  1489	  1492	  1495	  1500	  1503	  1511	  1632	  1641	  1672	  1761	  1944
	  2976	  3003	  3087	  3197	  3253	  3264	  3285	  3354	  3385	  3402	  3431	  3464	  3468	  3475
	  3488	  3501	  3574	  3643	  3660	  3679	  3858	  3913	  3962	  3970	  4023	  4842	  5050	  5069
	  5081	  5144	  5156	  5171	  5176	  5182	  5216	  5688	  6016	  6370	  6373	  6411	  6575	  6707
	  6801	  7038	  7429	  7430	  7432	  7434	  7950	  8085	  8099	  8225	  8247	  8253	  8265	  8274
	  8286	  8491	  8791	  9842	 10311	 10614	 10687	 10749	 11226	 11234	 11237
SY$DV0	  6539#	  6539	  6541	  6543	  6545	  9606#	  9606	  9608	  9610
SY$DV1	  6539#	  6539	  6541	  6543	  6545	  9606#	  9606	  9608	  9610
SYDVF	  6538	  9605
TC	   193#	   195	   202#	   207	   208	   209	   210	   211	   212	   213	   214	   215	   216	   217
	   218	   219	   220	   221	   222	   223	   224	   225	   226	   227	   232#	   237	   238	   239
	   240	   241	   242	   243	   244	   245	   246	   247	   248	   249	   250	   251	   252	   253
	   254	   255	   256	   257	   515#	   518
TCHARS	   117#	   155	  6627	  6659
TERCH	  2198#	  2200	  2201	  2202	  2203	  2204	  2205	  2206	  2207	  2208	  2209	  2210	  2211	  2212
	  2213	  2214	  2215	  2216	  2217	  2218	  2219	  2220	  2221	  2222	  2223	  2224	  2225	  2226
	  2227	  2228	  2229	  2230	  2231
TERCHR	   166#	   195	   207	   237	   518
TYPI	   838#	  1274	  1294	  1317	  1319	  3694	  3712	  3717	  3722	  3729	  3732	  3737	  3781	  3800
	  3854	  3955	  3987	  4051	  4056	  4134	  4139	  4141	  7380	  7393	  8358	  8366	  8374	  8382
	  8390	  8443	  8455	 10178	 10181	 10221
UMOVE	  5463	  5810	  5827	  6129	  6927	  6962
UMOVEM	  6071	  6155	  6334	  6337	  6921	  6940	  7179	  7589	  7597	  7629	  7633	  7705	 10604	 10737
UUIDPB	   834#	  3514	  3766	  4527	  4533	  4549	  4597	  4614	  4706
UUILDB	   833#	  1936	  1959	  3229	  3513
WRAPR	  9702
WRIO	  8229	  8232	  8292	  8293
XCTBU	  5369	  5916	  5977	  6552	  6572	  6576	  6825	  6834	  6845	  6861	  6870	  7696	  7698	  7969
	  7980
XCTFU	  5315	  5326	  5331	  5396	  5405	  5445	  5455	  5458	  5720	  5840	  5879	  5881	  5899	  5901
	  5903	  5929	  5931	  5935	  5945	  6007	  6428	  6434	  6548	  6549	  6877	  6966	  6975	  6983
	  7010	  7050	  7056	  7486	  7676	  7932	  9984	  9990	 10543	 10544
XCTTU	  5889	  5917	  5974	  6054	  6117	  6565	  6880	  7067	  7097	  7615	  7632
Z	   151#	   155	  6626#	  6627	  6628	  6629	  6630	  6631	  6632	  6633	  6634	  6635	  6636	  6637
	  6638	  6639	  6640	  6641	  6642	  6643	  6644	  6645	  6646	  6647	  6648	  6649	  6650	  6651
	  6652	  6653	  6654	  6655	  6656	  6658#	  6659	  6660	  6661	  6662	  6663	  6664	  6665	  6666
	  6667	  6668	  6669	  6670	  6671	  6672	  6673	  6674	  6675	  6676	  6677	  6678	  6679	  6680
	  6681	  6682	  6683	  6684	  6685	  6686	  6687	  6688
ZZZ	   301#	   309	   310	   311	   312	   313	   314	   315	   316	   317	   318	   319	   320	   321
	   322	   323	   324	   325	   326	   327	   328	   329	   330	   331	   575#	   582	   583	   584
	   585	   586	   587	   588	   589	   590	   591	   592	   593	  3108#	  3109	  3110	  3111	  3112
	  3113	  3114	  3115	  3116	  3117	  3118	  3119	  3120	  3121	  3122	  3123	  3124	  3125	  3126
	  3127	  3128	  3129	  3130	  3131	  3133#	  3134	  3135	  3136	  3137	  3138	  3139	  3140	  3141
	  3142	  3143	  3144	  3145	  3146	  3147	  3148	  3149	  3150	  3151	  3152	  3153	  3154	  3155
	  3156
$END	 11575b@
O