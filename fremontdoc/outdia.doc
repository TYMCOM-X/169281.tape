


                      Description of the Out-Dial Service
                         date this document  May 2,1980










































                  copyright 1979; Tymshare inc. Cupertino Ca.


















                                                                          Page 2


1.0 Introduction






               This  design  document  describes  a  service  known   as
          Out-Dial  to become available to Tymnet.  The service Out-Dial
          is not a new concept and has been  implemented  previously  in
          past  software  systems as ONTYME for the PDP-10 and Honeywell
          computers  plus  an  incomplete  implementation   for   Tymnet
          Tymsats.   The  presentation of the Out-Dial service contained
          in this document is a description of a new approach that hopes
          to accomplish its function in a simple and orderly manner.

               The description will proceed in a logical fashion,  first
          stating  the design objectives which shall give reason for the
          new approach to the Out-Dial problem.  Using these  objectives
          as  a guideline, an overall description of the Out-Dial system
          will be explored.  Then the Host to Out-Dial protocol will  be
          described  and  will  be  followed  by  the  protocol  for all
          internal Out-Dial communication.   It  is  expected  that  the
          complete  picture  presented  here will be used as a blueprint
          for the final product and this document will be referenced  by
          all system programmers intending to use this service.





































                                                                          Page 3


2.0 Objectives of the Out-Dial System






               1) The primary objective  for  the  new  Out-dial  is  to
          provide  a  service  for dialing-out messages generated by the
          OSIRIS message switch.   This  resource  will  be  implemented
          through  a  Tymnet type network and will be logically separate
          from the OSIRIS switch.  Out-Dial  will  be  able  to  receive
          out-dial   requests,   determine  the  least  expensive  phone
          connection to the target modem, and establish this  connection
          in an orderly manner.  Using this path, the OSIRIS system will
          be  able  to  transmit  characters  to   the   modem   without
          consideration of modem and terminal protocols.




               2) Since the service can be accessed by any Host  in  the
          network,  Out-Dial  will  respond  to  all  computer generated
          out-dial requests that meet the User Host to Out-Dial protocol
          stated within this document.


               3) The system must be able to interface to a wide variety
          of modem and terminal protocols including both synchronous and
          asynchronous modems.  For the initial implementation, Out-Dial
          will  have  the  capability  to handle all asynchronous modems
          that the Tymnet network currently supports.   Included  within
          this  range is the ability to handle full duplex communication
          between the host and the modem.


               4) It is desired that the  system  have  the  ability  to
          consist  of one or more components;  a component being defined
          as one or  more  pairs  of  dialer-modems  and  the  necessary
          software  to support this set of equipment.  This setup should
          make it possible to locate components  at  various  geographic
          locations  throughout the network and thus allow the system to
          take advantage of cheaper rates due to the  dialer's  location
          or the type of phone lines available(WATS,tie,local).



















                                                                          Page 4


               5) There should be a provision for a parent system with a
          disc  to store code loading files and configuration tables for
          the Out-Dial system.  These files and tables will be used  for
          system  generation  and  to  determine  the dialer, modem, and
          phone line configuration for each component in the system.  As
          a  second feature, the parent system should be able to request
          and receive all diagnostic and status  information  logged  by
          the executive module of the Out-Dial system.


               6)  The  system  will  provide  detailed  logs   of   all
          collectable data for accounting and billing.  This information
          will be forwarded to an established  location  on  a  periodic
          basis.


               7) For the  initial  phase  of  this  service,  Bell  801
          dialers  and  a combination of Bell 103 and 212 modems will be
          the equipment supported.  To allow for the ability to  replace
          old  equipment  or  add  different manufacturer's equipment to
          this system, the design of the software modules will  make  it
          easy to add or replace equipment drivers.









































                                                                          Page 5


3.0 General Structural Overview







               From the most basic point of view,  the  Out-Dial  system
          appears  as  a  set  of  one  or more ISIS slots, scattered at
          various locations in the network.  The slots are  functionally
          similiar,  but  may differ in size.  This difference is due to
          the amount and type of equipment each slot is supporting.  The
          logical  functions  for  Out-Dial  can  be  separated into the
          various divisions of labor by viewing the slot's activity from
          the  bottom  up.   The underlying structure for contact to the
          outside world and the network is the ISIS system.  At the next
          level  is  the  Pascal  Nucleus.  This division is a series of
          assembly language programs whose  purpose  is  to  act  as  an
          interface  between  the higher level of operation and the ISIS
          system.  These activities  include  device  I/O,  dialer-modem
          communication,  and  process  scheduling.   Sitting on the top
          level are the Concurrent Pascal programs which are responsible
          for managing all Out-Dial operations.





3.1 Configuration Table



               The Configuration Table is a list of information on  each
          dialer-modem  pair  which  Out-Dial  will use to determine the
          optimal location to  make  the  phone  call.   This  table  is
          explained further in section 10.0.


























                                                                          Page 6


3.2 Components of the Out-Dial System



               Below is a description of each component in the  Out-Dial
          system.





3.2.1 Out-Dial Slot



               As stated previously, an Out-Dial Slot contains a set  of
          one  or  more pairs of dialer-modems and the required software
          to drive the equipment and to handle proper  Out-Dial  message
          protocol.   Each slot will have a distinct host number and can
          be  addressed  by  an  account  name  stored  in  the   Tymnet
          Supervisor's MUD (eg.  OUTDIAL03).





3.2.2 Captain



               One of  the  active  Out-Dial  slots  is  considered  the
          Captain.   The Captain will act as the intelligence source for
          controlling the flow of incoming requests and directing  these
          requests  to the optimal dialer location in the network.  This
          Captain will have an established circuit built  to  all  other
          Out-Dial  slots  for  carrying  on any internal communication.
          Through these  channels,  the  Captain  can  forward  Out-Dial
          requests  and  can receive information from the Out-Dial slots
          pertaining to the success of the phone call.
























                                                                          Page 7


3.2.3 Accounting



               Co-resident, in an ISIS slot, with  the  Captain  is  the
          operation    handling    all   accountable   information   and
          communication with the parent.  This set of functions is known
          as Accounting.  This process will receive all messages dealing
          with billing and status information coming from  any  Out-dial
          slot.    The   status   information  is  used  to  update  the
          Configuration Tables when equipment becomes  free  or  broken.
          All  billing  information  is  forwarded  to the parent system
          approxiamately once a minute.  (polling  interval  is  set  by
          parent:  see below).

               As a second feature, Accounting is  responsible  for  any
          communication  with  the  parent  system  (see 3.2.4), such as
          retrieving equipment status for the parent, shutting off usage
          of   any   equipment,  or  updating  any  Configuration  Table
          information.





3.2.4 Parent



               A parent is a Tymnet Host responsible for overseeing  the
          Out-Dial   system.    This   responsiblity   includes  several
          activities.  First, it is the parent system that generates the
          Out-Dial  service  by loading the ISIS slots with the Out-Dial
          software modules.  After Out-Dial is active, the parent system
          can  make  necessary  changes  to Out-Dial's operation such as
          changing Captains or turning on  or  off  Out-Dial  equipment.
          Also, the parent periodically logs into the Captain to receive
          all accountable information from the Accounting process.





3.2.5 User Host



               A User Host is defined as any Tymnet Host that wishes  to
          use  the  Out-Dial  service.   For  the purpose of billing and
          accessibility to the Out-Dial equipment, the Captain  contains
          a  list  of  all  valid User Host numbers in the Configuration
          Tables.











                                                                          Page 8


4.0 Communication with Out-Dial



               This section defines the types of circuits  that  can  be
          built  to  Out-Dial  and the duration of time each circuit may
          remain connected.


4.1 Parent to Out-Dial



               A parent system can log into  any  Out-Dial  slot.   Each
          slot  has  hard-wired  into  the  Pascal  code a list of legal
          parents and their access rights.  All hosts posing as a parent
          who  are  not  on  this  list will have their circuits zapped.
          Messages received from any legitimate  parent  will  be  acted
          upon  only  if a parent has the proper license.  The parent is
          responsible for zapping all circuits to an Out-Dial slot.

               A parent will log into the Out-Dial  slot  designated  as
          the Captain for the following reasons:
                                 1) Request accounting and status 
                                    information.
                                 2) Change state of Configuration Tables
                                 3) Switch Captain into a regular
                                    Out-Dial slot.


               A parent will log into a regular Out-Dial slot to  notify
          the  slot  to  report  to  a  new Captain or to become the new
          Captain.






























                                                                          Page 9


4.2 User Host to Captain



               All circuits built to the Captain from a  User  Host  are
          called  command circuits.  Through this circuit, the User Host
          can place a  series  of  out-dial  requests  and  wait  for  a
          response  for  each one.  It is not necessary for this circuit
          to be zapped upon completion of  an  out-dial  session.   This
          circuit  may  remain established for future out-dial activity.
          It should be noted that the Captain will zap the circuit after
          a  lengthy  period of time if the Captain does not receive any
          requests (approx.  10 minutes).





4.3 User Host to Out-Dial Slot



               All  circuits  built  into  an  Out-Dial  slot  for  data
          transmission  are  called data circuits.  A user Host may have
          as  many  data  circuits  as  the  number  of  modems  it   is
          communicating  with  at  that  instant  of  time.   After  the
          completion of a  session,  the  Out-Dial  slot  will  zap  the
          circuit from the User Host.



































                                                                         Page 10


5.0 Operation of Out-Dial Service






               A User Host system may view the  Out-Dial  service  as  a
          series  of  Hosts,  each  containing  the means to receive and
          build circuits through the network.  The establishment of each
          Out-Dial  Host  location  is  a  function  of  the area of the
          network that Out-Dial will be used to make  phone  calls.   As
          the  needs  of  a customer or a group of customers change, the
          locations of the Out-Dial User Hosts may be  re-configured  to
          give  cheaper  and  faster response to the initiating Out-Dial
          request.  To the internal operations, each Out-Dial Host is  a
          separate  component  of  the  system.   This setup allows each
          component to exist as a complete entity and  thus  prevents  a
          total  breakdown  in  service  caused  by the failure of a few
          system components.





5.1 System Generation



               A  parent  system  (such  as  a  PDP-10  host),  via  the
          facilities  of  NAD,  will  load the software modules into the
          ISIS slots.  After each slot  is  loaded  and  activated,  the
          parent  system  (such  as  OSIRIS) will build a circuit to the
          Out-Dial slot designated as the Captain.  A message is sent to
          the  Accounting  process  notifying  the  slot  it  is now the
          Captain.   Processes  dealing  with   the   phone   connection
          activities are awakened from a delayed state.  Now the Captain
          waits for circuits coming from other Out-Dial slots.

               As the Captain is waiting, the  parent  system  builds  a
          circuit  to  each slot in the system, notifies the slot of the
          present Captain, and zaps the  circuit.   Each  Out-Dial  slot
          builds  a  circuit  to the Captain for internal communication.
          The circuit between the parent system and the Captain  remains
          intact  for  any future communication.  At this time, Out-Dial
          is ready to receive requests from User Hosts  wishing  to  use
          this service.
















                                                                         Page 11


5.2 Activities of an Out-Dial Session



               An Out-Dial  request  begins  by  a  Tymnet  User  Host's
          building  a  circuit to the Captain and sending a message with
          correct protocol containing the  phone  number,  the  type  of
          service,  and  the  type  of  equipment.   Upon receiving this
          message, the Captain  commences  searching  the  Configuration
          Tables  to  map  the user's desires to a specific dialer-modem
          combination.  If the equipment is available for  service,  the
          Captain  places a request to the Out-Dial Slot containing this
          equipment via the established circuit.   Otherwise,  the  User
          Host receives a negative response.


               The receiving Out-Dial Slot takes the phone  number  from
          the  incoming  message  and  attempts  to place the phone call
          through the specific dialer-modem combination selected by  the
          Captain.   The  Out-Dial  slot  reports  back  to the Captain,
          through the same circuit, that the phone connection  has  been
          successful  or  unsucessful  due  to  a  busy signal or faulty
          dialer, etc.  In response to an unsuccessful attempt, a status
          message  returns  to  the  initiating User Host indicating the
          Out-Dial failure.  Otherwise, the Captain sets the equipment's
          status  as  busy  in  the Configuration Tables and returns the
          Out-Dial Host extension and a modem index  to  the  requesting
          Host.

               As soon as the Out-Dial slot has placed the  phone  call,
          it  will  back-pressure  the  terminal  and  collect  up to 40
          characters possibly transmitted from a terminal's answer  back
          memory,  waiting  for  the  User  Host  to build a circuit and
          present  the  proper  modem  index.   An  improper  index   or
          connection  time-out  causes  the Out-Dial Slot to hang-up the
          phone and respond to any further User Host inquiries  that  no
          phone  calls  are  waiting.   Once the setup has been properly
          established, the component prepares a gateway  from  the  User
          Host  to the target modem for a full duplex transmission.  The
          actual transmission begins by the Out-Dial  slot's  issuing  a
          request for data from the User Host.

               Termination of the session may be induced by one of three
          possibilities:   1)  User  Host circuit lost, 2) the User Host
          requests a hang-up, or 3) the  terminal  issues  the  hang-up,
          which  the  Out-Dial  slot will reflect back to the User Host.
          The Out-Dial slot will return an  accounting  message  to  the
          User Host and then zap the circuit.










                                                                         Page 12


5.3 Changing Captains



               A parent  system  with  the  proper  license  can  switch
          Captains  from  one  Out-Dial  slot  to  another.  This may be
          necessary due to the original Captain's crashing or  a  change
          in  Out-Dial's  configuration.   The  takeover  begins  by the
          parent's choosing the next slot to become Captain and  sending
          notice  that  the  slot  is now the Captain.  Next, the parent
          system notifies the remaining active slots of the new Captain.
          Each Out-Dial slot builds a new circuit to the Captain without
          interrupting on-going Out-Dial sessions.  Finally, the  Parent
          builds a circuit to the old Captain and notifies Accounting to
          turn this slot into a regular Out-Dial slot.





5.4 Collecting Accounting and Status Information



               The parent system will periodically build  a  circuit  to
          the slot designated as the Captain.  A message will be sent to
          the Accounting process requesting all accountable  information
          logged  by the Out-Dial system.  This information includes all
          completed and incompleted phone calls.  The Accounting process
          sends  a  message prompting the parent system into being ready
          to receive the accounting records.  Each  record  is  given  a
          sequence  number  and  forwarded  to the parent system via the
          established circuit.  Following the record, Accounting sends a
          yellow  ball  and waits for an orange ball.  If the circuit is
          broken during this session, Accounting will restore  the  last
          record  sent  and  wait  for another request for data from the
          Parent.   The  final  record  sent  will  contain   a   marker
          indicating  the end of transmission.  At this time, the parent
          system may zap the circuit.
























                                                                         Page 13


6.0 User Host to Out-Dial Protocol



               This section gives a detailed description of the  message
          formats  for communication with Out-Dial.  Each message has an
          unique identification code, identifying the receiver  and  the
          type  of  message.   Numbers  are  shown  in their hexadecimal
          representation.





6.1 User Host to Captain Messages


          REQUEST TO INITIATE A PHONE CALL



               First the User Host builds a circuit to the Captain.  The
          User  Host then initiates a request by sending this message to
          the Captain.  Multiple requests can be sent by repeating  this
          message  with  each  one  having  the suitable information for
          completing the phone call.


          --------.--------.--------.--------
          - 10    - 01     - Service- TID   -
          --------.--------.--------.--------
          - Modem - Digits - Options        -
          --------.--------.--------.--------
          - Phone Number                    -
          ---------.--------.--------.-------


          TYPE           LENGTH          USAGE


          Service        byte            Type of Service:

                                         0  - Cheapest way possible
                                         1  - Normal Service
                                         2  - Rush Service



          TID            byte            Terminal Identification Code:

                                                 Init Charc      Baud

                                         1  -    A               300
                                         2  -    C               300









                                                                         Page 14


                                         3  -    E               300
                                         4  -    G               300
                                         5  -    B               150
                                         6  -    F               150
                                         7  -    D               110
                                         8  -    A               1200
                                         9  -    I               1200



               The index indicates what kind of terminal will be
          receiving the phone call.


          Modem          byte            Type of Modem:

                                         1  - Bell 103
                                         2  - Bell 212A



               This index indicates the type of modem  the  user  wishes
          Out-Dial to use to transmit the characters to the terminal.


          Options        halfword        Terminal options selected



               The option field is a sixteen bit array allowing the User
          host  to  control certain terminal characteristics.  Presently
          the following options are defined for bit 0 (leftmost) to  bit
          15 (rightmost):


                         bit 15 - set: No echo of input from modem
                         bit 14 - set: Treat XOFF,XON as data charc
                         bit 13 - set: Treat target modem as non-ASCII 


          Digits         byte            Number of digits in Phone 
                                         Number


          Phone Number   10 bytes        Phone Number in hexadecimal 
                                         representation



               The complete phone number is placed here.  This field may
          be only the extension for a centrex system or a ten digit long
          distance phone number.  Each digit of the number will occupy a
          half-byte such that a hexadecimal representation of the number
          is exactly what Out-Dial will use without any need for  format









                                                                         Page 15


          conversion.   Any half filled or unfilled bytes must be padded
          with 0's to completely fill the 10 bytes.

               For example, take the following request from a User Host.
          The  User  would  like  to  make  a  rush call to 408-446-7172
          through a Bell 212A  modem  and  will  link  to  a  1200  baud
          terminal  needing an 'A' for the TID.  The message sent to the
          Captain would look like:

          ------.------.------.------
          - 10  - 01   -  02  - 08  -
          ------.------.------.------
          - 02  - 0A   - 00   - 00  -
          ------.------.------.------
          - 40  - 84   - 46   - 71  -
          ------.------.------.------
          - 72  - 00   - 00   - 00  -
          ------.------.------.------













































                                                                         Page 16


6.2 Captain to User Host


          RESPONSE TO OUT-DIAL REQUEST



               For each Out-Dial request message,  the  User  Host  will
          receive a copy of the following message.


          --------.--------.--------.--------
          - 20    - 01     - Status - Key   -
          --------.--------.--------.--------
          - Host Extension                  -
          --------.--------.--------.--------
          - size  -        - Phone Number   -
          --------.--------.--------.--------


          TYPE           LENGTH          USAGE


          Status         byte            Response to Host Request:

                                         0  - Phone connection made
                                         4  - Remote busy
                                         8  - Trunk busy
                                         0C - Ring,no answer
                                         10 - Call complete but no
                                              carrier detect (DCD)
                                         14 - One of 4,8,0C, or 10
                                              Can't tell which
                                         18 - Service not available
                                              at request priority
                                         1C - No service available
                                              at this time
                                         20 - Equipment requested
                                              is not available
                                         24 - Equipment requested
                                              is out of service



               Upon the completion of a call, the User Host has 1 minute
          to build a circuit to the Out-Dial slot indicated by the modem
          index and host extension, before the phone line is terminated.
          For the case of unavailable service at the priority requested,
          the user may try again at a higher priority.


          Key            byte            Modem Key











                                                                         Page 17


               The User Host places the modem index in the correct field
          for the message going to the Out-Dial slot.  This index allows
          the slot to recognize the User-Host.


          Host Ext       4 Charc         Append to Host name



               The 4  ASCII  characters  are  appended  to  the  general
          account  name  intended for the Tymnet Supervisor for building
          the data circuit.  For example, the Captain returns '0001'  as
          the  Host  extension.  The User Host appends this extension to
          the Out-Dial account name to make OUTDIAL0001 and  sends  this
          name to the Supervisor.


          Size           byte            No. of digits in number


          Phone Number   10 bytes        Hexadecimal representation



               The phone number is returned in order for the  User  Host
          to identify the response for a series of requests.





































                                                                         Page 18


6.3 User Host to Out-Dial slot


          ESTABLISH CONNECTION TO MODEM


          --------.--------.--------
          - 40    - 02     - Key   -
          --------.--------.--------


          TYPE           LENGTH          USAGE


          Key            byte            Modem Key



               The modem index is a marker identifying the User Host  to
          the proper phone connection.





          HANG-UP PHONE CONNECTION


          --------.--------
          - 01    - FF    -
          --------.--------



               This message is the request for hang-up by the User Host.
          The  Out-Dial  Slot  notices  the character 01 followed by the
          hang request and tells the dialer to cause a disconnect.   The
          data  mode  established between the Out-Dial slot and the User
          Host is terminated.
























                                                                         Page 19


6.4 Out-Dial Slot to User Host


          READY TO RECEIVE DATA


          --------.--------.--------.--------
          - 20    - 02     - Size   -       -
          --------.--------.--------.
          - Character string                -
          --------.--------.--------.--------


          TYPE           LENGTH          USAGE


          Size           byte            Charc count of answer back 
                                         0 - No answer back memory


          Charc string   variable        Contents of answer back memory



               On receipt of this message, data mode  is  entered.   All
          control messages from this point on are a character 01 follwed
          by the appropiate control character.  A pair of 01's  will  be
          interpreted as a transmission of the character 01.





          TERMINAL OR PHONE LINE HANG-UP


          --------.--------
          - 01    - FF    -
          --------.--------


          See section 6.3





















                                                                         Page 20


          ACCOUNTING RECORD OF CALL



               After each Out-Dial session, the User  Host  receives  an
          accounting  record.   The character 01 followed by the control
          character signifies the beginning of the accounting record


          --------.--------.--------.--------
          - 01    - FE     - Index  - Line  -
          --------.--------.--------.--------
          - Time Started                    -
          --------.--------.--------.--------
          - Time Stopped                    -
          --------.--------.--------.--------
          - Incount                         -
          --------.--------.--------.--------
          - Outcount                        -
          --------.--------.--------.--------


          TYPE           Length          USAGE


          Index          byte            Modem Index used in session


          Line           byte            Index to line used


          Time Started   word            Time of start of call
                                         (seconds from Jan 1,1974)


          Time Stopped   word            Time at end of call 
                                         (seconds from Jan 1,1974)


          Incount        word            Count:charc sent to
                                         User Host


          Outcount       word            Count:charc received from
                                         User Host


















                                                                         Page 21


7.0 Internal Communication Protocol



               The following section describes the messages between  the
          Out-Dial  components.   These  messages follow the same format
          used in section 6.0





7.1 Parent to Accounting


          SEND ACCOUNTING AND STATUS INFORMATION


          --------.--------.
          - 30    - 01    -
          --------.--------



               Once a minute the parent will  build  a  circuit  to  the
          Captain and send this message.





































                                                                         Page 22


          SHUT DOWN DIALER


          --------.--------.--------
          - 30    - 02     - Index -
          --------.--------.--------


          TYPE           LENGTH          USAGE


          Index          byte            Dialer associated with index
                                         is placed out of service



               The  parent  sends  this   message   to   Accounting   to
          discontinue the use of a dialer.





          RESUME USAGE OF DIALER


          --------.--------.--------
          - 30    - 03     - Index -
          --------.--------.--------


          TYPE           LENGTH          USAGE


          Index          byte            Dialer associated with index
                                         placed in service again



               The parent sends this message to Accounting  to  place  a
          repaired dialer back into service.






















                                                                         Page 23


7.2 Accounting process to Parent


          ACCOUNTING INFORMATION COMING


          --------.--------.
          - 50    - 01     -
          --------.--------.



               The parent system will be ready to  receive  the  records
          from the Accounting process upon receipt of this message.





7.2.1 Accounting Records



               There are 2 types of accounting records.  First there  is
          a  record  for information dealing with billing.  Second there
          is a record for information dealing with equipment  breakdown.
          Each  record  is  followed  by  a yellow ball.  The Accounting
          process will not send the next record until  it  has  received
          back an orange ball.  If the circuit is broken, the Accounting
          process will restore the last record sent.


          BILLING INFORMATION


          --------.--------.--------.--------
          - 50    - 02     - Sequence- Modem-
          --------.--------.--------.--------
          -Service-  Line  - Status -Digit  -
          --------.--------.--------.--------
          - Host No        - Incount        -
          --------.--------.--------.--------
          - Outcount                        -
          --------.--------.--------.--------
          - Start Time                      -
          --------.--------.--------.--------
          - Stop Time                       -
          --------.--------.--------.--------
          - Digit - Phone Number            -
          --------.--------.--------.--------













                                                                         Page 24


          TYPE           LENGTH          USAGE


          Sequence       byte            Record sequence number


          Modem          byte            Index to Modem Used


          Service        byte            Type of Service
                                         see section 6.1


          Line           byte            Index to phone line used


          Status         byte            How call was terminated

                                         32  - User Host hang-up
                                         36  - Terminal hang-up
                                         3A  - User Host circuit lost
                                         3E  - Modem breakdown
                                         0C  - Busy,no answer
                                         42  - Timeout


          Host Number    halfword        User Host Number


          Incount        word            Count:Charc sent to
                                         User Host


          Outcount       word            Count:Charc received from
                                         User Host


          Time Started   word            Time of start of call
                                         (seconds from Jan 1,1974)


          Time Stopped   word            Time at end of call
                                         (seconds from Jan 1,1974)


          Digits         byte            No. of digits in number


          Phone Number   10 bytes        Hexadecimal repr. of number














                                                                         Page 25


          BREAKDOWN INFORMATION


          --------.--------.--------.--------
          - 50    - 03     - Sequno - Index -
          --------.--------.--------.--------
          -Status - Line   - User  Host     -
          --------.--------.--------.--------
          - Digits-        - Time           -
          --------.--------.--------.--------
          - Phone Number                    -
          --------.--------.--------.--------


          TYPE           LENGTH          USAGE


          Sequno         byte            Record sequence number


          Index          byte            Index to Modem


          Status         byte            Reason for breakdown
                                         see section 6.2


          Line           byte            Index to phone line used


          User Host      halfword        User Host number


          Time           word            Time of breakdown
                                         (seconds from Jan 1,1974)


          Digits         byte            Number of digits in number


          Phone Number   10 bytes        Number attempted to call






















                                                                         Page 26


7.3 Parent to Out-Dial Slot


          CHANGE ALLEGIANCE TO NEW CAPTAIN


          --------.--------.--------
          - 60    - 01     - Index -
          --------.--------.--------


          TYPE           LENGTH          USAGE


          Index          byte            Pointer into table of
                                         Out-Dial Host extensions



               This message causes the Out-DIal slot to zap the  circuit
          to  the  present Captain and examine the Captain list.  If the
          slot becomes the new Captain, the processes dealing with phone
          connections  in  the  slot are activated.  Otherwise, the slot
          builds a circuit to the new Captain.





7.4 Parent to Captain


          STOP BEING THE CAPTAIN


          --------.--------.--------
          - 30    - 04     - Index -
          --------.--------.--------


          TYPE           LENGTH          USAGE


          Index          byte            Pointer into table of
                                         Out-Dial Host extensions



               This message causes the Captain to go to sleep  and  turn
          the  slot  into  a  regular  Out-Dial Slot.  Using the Captain
          list, the slot builds a circuit to the new Captain.












                                                                         Page 27


7.5 Captain to Out-Dial Slot


          PLACE A PHONE CALL


          --------.--------.--------.--------
          - 40    - 01     - Index  - TID   -
          --------.--------.--------.--------
          - Host Index     - Service- Line  -
          --------.--------.--------.--------
          - Digits- Phone Number            -
          --------.--------.--------.--------


          TYPE           LENGTH          USAGE


          Index          byte            Index to dialer-modem 
                                         combination


          TID            byte            Terminal Identification
                                         Code (see 6.1)


          Host Index     halfword        User host number


          Service        byte            Type of service requested


          Line           byte            Index to phone line used


          Digits         byte            Number of digits in number


          Phone Number   10 bytes        Hexadecimal repr. of Number



               This message is sent to the  Out-Dial  Slot  through  the
          established circuit between the Captain and the slot.



















                                                                         Page 28


7.6 Out-Dial Slot to Captain


          REPLY TO DIAL REQUEST


          --------.--------.--------.--------
          - 10    - 02     - Index  - Status-
          --------.--------.--------.--------


          TYPE           LENGTH          USAGE


          Index          byte            Index to dialer-modem
                                         combination


          Status         byte            returned state of attempt
                                         see section 6.2



               After the dialer attempts a phone call, the status of the
          call will be returned to the Captain.





          OUT-DIAL SLOT IS UP


          --------.--------.--------.--------
          - 30    -  07    - Index  - Status-
          --------.--------.--------.--------
          - Host  -
          --------


          TYPE           LENGTH          USAGE


          Index          byte            Index to dialer-modem
                                         combination


          Status         byte            Initial state of dialer
                                         see section 6.2


          Host           byte            Slot's host index number











                                                                         Page 29


               This message is sent to the Captain by the Out-Dial  Slot
          after  the  Out-Dial  Slot  initially  builds a circuit to the
          Captain.




























































                                                                         Page 30


7.7 Out-Dial Slot to Accounting



               The Out-Dial Slot returns to Accounting a record for each
          Out-Dial session completed.


          --------.--------.--------.--------
          - 30    - 05     - Index  - Status-
          --------.--------.--------.--------
          - Line  - Service- Host Number    -
          --------.--------.--------.--------
          - Incount                         -
          --------.--------.--------.--------
          - Outcount                        -
          --------.--------.--------.-------
          - Time Started                    -
          --------.--------.--------.--------
          - Time Stopped                    -
          --------.--------.--------.--------
          - Digit - Phone Number            -
          --------.--------.--------.--------


          TYPE           LENGTH          USAGE


          Index          byte            Index to dialer-modem
                                         combination


          Status         byte            How call was teminated
                                         see section 7.2.1


          Host Number    halfword        User Host number


          Service        byte            Type of Service
                                         see section 6.1


          Line           byte            Index to phone line used


          Incount        word            Count:charc sent to
                                         User Host


          Outcount       word            Count:charc received from
                                         User Host











                                                                         Page 31


          Time Started   word            Time at start of call
                                         (seconds from Jan 1,1974)


          Time Stopped   word            Time at end of call
                                         (seconds from Jan 1,1974)


          Digits         byte            No. of digits in number


          Phone Number   variable        Number dialed



















































                                                                         Page 32


8.0 General Characteristics of Out-Dial



               Out-Dial requires a Tymnet Engine running ISIS II with  a
          slot  containing  at least 120K core.  The slot can support up
          to 12 dialers and can have a maximum of 30  incoming  circuits
          at  1 time.  Out-Dial communicates to the dialers by the async
          ports, using 5 sequential ports per 801 dialer or 1 async port
          per Vadic 81152 dialer.  Each slot requires the loading of the
          Out-Dial Nucleus and the pre-configured Out-Dial  Pascal  code
          containing the various parameters defined in sections 11.0 .





9.0 Loading the Outdial Nucleus






               From the account (OUTDIAL) on sytem 25,23,28 or  33  copy
          files  OUTDIA.LS  and  OUTDIA.HST into your account.  Using an
          editor modify the following parameters in OUTDIA.HST:


                 NASYC           number of async boards in slot
                 SLOT            slot in engine using
                 N801            number of Bell 801 dialers assigned to 
                                 slot
                 NVADIC          number of Vadic dialers assigned to 
                                 slot
                 D1PRT           largest number of the 5 async ports 
                                 used for dialer 1 if 801
                  D1TYP           0 for 801, 1 for Vadic
                  D2PRT           largest numer of the 5 async ports
                                 use for dialer 2 if 801
                  D2TYP           0 if 801, 1 if Vadic
                    ---------
                 D12PRT          largest number of the 5 async ports 
                                 used for dialer 12 if 801
                 D12TYP          0 if 801, 1 if Vadic



               Again,using an editor modify the file  OUTDIA.LS  to  use
          OUTDIA.HST   from   your  account  instead  from  the  account
          (OUTDIAL):


          ;@((your account))OUTDIA.HST









                                                                         Page 33


          ;@(OUTDIAL)OUTDIA.COM
                 .
                 .
                 .




               Become familiar with the operations of NAD  in  the  ISIS
          document  and  understand the implementation of command files.
          Run NAD and use OUTDIA.LS to load  the  Outdial  Nucleus  into
          your slot.



















































                                                                         Page 34


10.0 Configuration Tables Description 



               The Configuration table consists of 5  individual  arrays
          of  information.   These  are the User Host Acess Table,Dialer
          Attribute Table,Phone Line Attribute Table,Areacode Table, and
          the Phone Line Availabity List.






10.1 User Host Acess Table



               This table is a set of records,one record for  each  User
          Host  who  may  use  Outdial.   There  are  two fields in each
          record.  NODE is the Tymnet node the host is  associated  with
          and  LIST  is  an  integer  set  of  pointers  to  the dialers
          described by the Dialer Attribute Table that the User Host may
          use.


10.2 Dialer Attribute Table



               This table is a set  of  records,  one  record  for  each
          dialer configured into Outdial.  Certain fields of this record
          contain status information on the dialer.  These include:


                 STATE           present state of dialer
                 TIME            time in seconds used
                 WATS            number of WATS calls
                 LOCAL           number of local calls
                 LD              number of long distance calls



               The  dialer  configuration   information   includes   the
          following fields:


                 CIRCUIT         internal channel number
                 EXT             host extension
                 PHONE           pointer to phone line lists
                 MODEMTYPE       modem acess
                 HOMEAC          areacode of dialer











                                                                         Page 35


10.3 Phone Line Attribute Table



               This table is a set of records, one record for each  type
          of phone line available to Outdial.  The fields in this record
          include:


                 USE             busy or not
                 TANDEM          1 to 3 tandem digits
                 COSTPTR         pointer to cost factor table


10.4 Areacode Table (Cost Factor Table)



               This table is an array of records, one for each  type  of
          phone line available (wats,local,etc.).  Within each record is
          a list of all areacodes and the cost factor assigned  to  make
          the desired phone call.


10.5 Phone Line List



               Each dialer points to a list of integer pointers  to  the
          various records in the Phone Line Attribute Table.

































                                                                         Page 36


11.0 Configuration Of Out-Dial


11.1 Out-Dial Parameters



               Out-Dial has various constants and tables  that  must  be
          modified  to  the desired configuration.  These parameters lie
          in the following files in (OUTDIAL) on system 23,25,28 or 33:


                 GLOBL0.DIA
                 PARENT.DIA
                 TCAPRG.DIA



               For each slot configured into Out-Dial, make  a  copy  of
          GLOBL0.DIA  and  rename  the  extension.   For  each  Out-Dial
          system, make a copy of PARENT.DIA and  TCAPRG.DIA  and  rename
          the extensions.


11.1.1 GLOBL0.*



               Modify the following constants in every copy of  GLOBL0.*
          for the same system:


                 NOPHONELINES            number of phone lines available
                 NOUSERHOSTS             number of allowed User Hosts
                 NODIALERSINSYS          number of dialers in Out-Dial
                 NOLINETYPES             number of phone line types
                 NOPARENTS               number of parents that can 
                                         acess system
                 NOOFSLOTS               number of slots in system



               Define a constant stating the Tymnet node each User  Host
          is  connected to.  Do the same for each parent.  Eliminate the
          constants defined in the source that do  not  represent  legal
          parents  or  acceptable User Host nodes.  Define PARENT1 to be
          the node of a  legal  parent.   Define  a  constant  for  each
          account name associated with a host number in Out-Dial.















                                                                         Page 37


          With each copy of  GLOBL0.*  modify  the  following  constants
          according to the slot's makeup:


                 CIRCNUMBER              number of incoming circuits
                 NODIALERS               number of dialers in slot
                 HOSTINDEX               host index number,starting from
                                         1
                 HOSTNAME                Supervisor account name for 
                                         slot



               Define MDI1 through MDI5 to  be  the  dialer-modem  index
          numbers  associated  with  each  dialer.  These numbers should
          start from 1 for each system.  Use  a  -1  for  each  instance
          there are less than 5 dialers configured for a slot.


11.1.2 PARENT.*



               Within the intial procedure, define each entry  in  table
          PARDESCR using the constants declared in GLOBL0.*.


11.1.3 TCAPRG.*



               Within the inital procedure, define each entry  in  table
          CAPTLIST using the constants declared in GLOBL0.*.






























                                                                         Page 38


11.2 Out-Dial Configuration Table



               Make a copy of INCFTB.DIA for each system and modify  the
          extension.  Below are the table names for the arrays described
          in section 10.0:


                 HOSTTABLE               User Host Table
                 DIALERTABLE             Dialer Attribute Table
                 PHONETABLE              Phone Line List
                 ACTTABLE                Areacode Table
                 PHONEDESCR              Phone line Attribute Table


11.2.1 HOSTTABLE



               For each User Host, add an array element with  the  field
          NODE set the the Tymnet node value and LIST set to the integer
          set of pointers to the available dialers in DIALERTABLE.


11.2.2 DIALERTABLE



               Use the dialer-modem index number as the indice for  this
          array.  With each element,assign the following fields:


                 EXT             4 character extension for slot's
                                 account name dialer resides within
                 PHONE           index pointer to one element of
                                 PHONETABLE
                 MODEMTYPE       BELL103 or BELL212A
                                 (constants defined in GLOBL0.*)
                 HOMEAC          areacode of dialer(base 16)


11.2.3 PHONELIST



               Assign an integer value,starting from  1  to  each  phone
          line.   Create  the  set  of  integers  each dialer can acess.
          Place the values as an array element  in  PHONELIST,using  the
          integer  value  assigned  to the field PHONE in DIALERTABLE as
          the indice to PHONELIST.












                                                                         Page 39


11.2.4 PHONEDESCR



               Using the integer  values  stored  in  PHONELIST  as  the
          indice  of  PHONEDESCR,  setup  the  following fields for each
          record:


                 TANDEM
                 no tandem dialing       TANDEM[1]:= NOPREFIX;
                                         TANDEM[2]:= NOPREFIX;
                 9+number                TANDEM[1]:= LOCPREFIX;
                                         TANDEM[2]:= NOPREFIX;
                 118+number              TANDEM[1]:= (:17:);
                                         TANDEM[2]:= (:141:);
                 4+number                TANDEM[1]:= (:77:);
                                         TANDEM[2]:= NOPREFIX;


               LOCPREFIX AND NOPREFIX are constants defined in GLOBL0.*.

                 COSTPTR
                 
                 enumeration type LOC,BAND3, or BAND5;


11.2.5 ACTTABLE



               For each  COSTPTR  type  declared,create  an  entry  into
          ACTTABLE.   The  field  NUM  is  a  list of areacodes base 16.
          PRICE is a threshold value based on the service requested:


                 SERVICE         THRESHOLD
                 0: Cheapest     0-99
                 1: Normal       100-150
                 2: Rush         151-200



               A threshold value allows a user to make the call  to  the
          target  areacode  if his request is greater than the threshold
          assigned to the areacode.

















                                                                         Page 40


12.0 Loading Out-Dial Pascal Code



               For each slot in Out-Dial create  a  build  file  BUILD.*
          with the following input:


          N OUTDIA.(EXT NAME)
          M 24261311005
          S GLOBL0.DIA GLOBL0.* 
          S PARENT.DIA PARENT.*
          S INCFTB.DIA INCFTB.*
          S TCAPRG.DIA TCPARG.*
          R CONCAT.DIA



               (filename).* is the new file created for this  particular
          slot.



               Run the program CONCAT in (EPASCAL) to create your source
          file.  Next run CPAS1 in (EPASCAL) to create your object code.
          Run OBJNIB in (EPASCAL) to create your nib file.  Now use  NAD
          to load this file into your slot starting at address X'30000'.
          After sucessfully loading this file and your Nucleus, you  are
          ready to start the slot.
    \P[M