Page  1-1	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)ND5321.T05	 

     1				        GL      NTOUT,NBUF,NBFLET,MAXONT,MINONT
     2	000001			MAXHST  EQ      1               : only one host in slot
     3	000020			MAXPRT  EQ      $A 32
     4	0007FC			IRSIZE  EQ      800-4
     5	001FFC			ORSIZE  EQ      2000-4
     6	00000C			CNTRL   EQ      0C
     7	0010A1			HOST0   EQ      $A 4257
     8	000099			PRODID  EQ      99      
     9	000001			ENGINE  EQ      1
    10	000001			CRSTOP  EQ      1
    11	000021			NPORT   EQ      21
    12	000003			NGRP    eq      (NPORT+0f)/10   
    13	000042			NBUF    EQ      2*NPORT
    14	000008			NTOUT   EQ      8
    15	000100			MAXCHAR EQ      100
    16	000000			ECHO    eq      0
    17	000008			MAXDISP EQ      8
    18	000001			BUFTRC  EQ      1
    19	001300			NBFLET  EQ      1300
    20	000003			A.BUFF  EQ      3
    21				
    22	000032			NEVNTS  EQ      $A 50           :SAVE 50 BACKPRESSURE EVENTS
    23	000045			MINONT  EQ      45              :ASCII OF LOWEST ONTYME HOST ID
    24	000048			MAXONT  EQ      48              :ASCII OF HIGHEST ONTYME HOST ID
    25	000004			NHOSTS  EQ      MAXONT-MINONT+1
Page  2-1	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)START.LIB	 ISIS Assembly Switch Definitions	- START.LIB

    26				
    27					SUBTTL	ISIS Assembly Switch Definitions	- START.LIB
    28				:******************************************************************
    29				:
    30				:	This program is the sole property and confidential
    31				:	information of Tymshare, Inc., and may not be copied
    32				:	in whole or in part or disclosed to any third party
    33				:	without the prior written consent of Tymshare.
    34				:
    35				:*******************************************************************
    36				
    37					REMARK %Start.Lib Version 
    38	000000			SREV	EQ	0
    39					NUMBER SREV
    40					REMARK .0
    41	000005			SLEV	EQ	05
    42					NUMBER SLEV
    43				
    44				: Version 0.05 01/19/83 MDS
    45				:	Delete Remark regarding incompatibility with ISIS 5.00
    46				: Version 0.04 03/12/82  MDS
    47				:	Add new fields to SYS SVC Sub-operand definitions,
    48				:	per ISIS2 v.5.01
    49				: Version 0.03 03/08/82  MDS
    50				:	Add new fields to Seg F table per ISIS 5.01
    51				:	(note - Start.lib ** NOT ** compatible with ISIS 5.00
    52				:	because SLCNT and LCX were reversed in 5.00 )
    53				: Version 0.02  12/08/81  MDS
    54				:	Add QSTART remark, add I/O sub-ops for mother board.
    55				:	Delete ISIS (one) code - force ISIS2
    56				: Version 0.01  01/08/81  MDS
    57				:	Correct relative addresses of local clock index and values.
    58				
    59					RA	0		:	START.LIB
    60				
    61				:	this file should always be assembled IMMEDIATELY AFTER the *.TYM file
    62				
    63				
    64	000001			ISIS2	EQ	1	:Force ISIS2 for other library routines
    65							:Note - ISIS 1 is no longer supported
    66				
    67				:			ISIS - II Version
    68				:
    69				:	The following parameters should be defined in the *.TYM file:
    70				:	MAXHST	maximum number of hosts associated with this interface slot
    71				:	MAXPRT	number of highest port associated with this interface slot
    72				:			(number of ports - 1)
    73				:	IRSIZE	 number of bytes to provide for input ring, from dispatcher
    74				:	ORSIZE	 number of bytes to provide for output ring, to dispatcher
    75				:	CNTRL	dispatcher control bits
    76				:	ENGINE	set to 1 if executing on a Tymnet Engine
    77				
    78				:	the following symbols MUST be defined SOMEWHERE in the assembly:
Page  2-2	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)START.LIB	 ISIS Assembly Switch Definitions	- START.LIB

    79				:	IRING	the start of the input ring, from dispatcher
    80				:	ORING	the start of the output ring, to dispatcher
    81				:	ENTRY	the location of the first instruction to be executed
    82				
    83				:	the following symbols are defined for convenience:
    84				:	RATE	the rate of the fast clock (ticks/second)
    85				:	NRATE	word containing the value of RATE
    86				:	FASTC	word containing  realtime fast clock
    87				:	SLOWC	word containing  realtime slow clock (1-second)
    88				:	GMT	word containing GMT clock
    89				:	TEMPER	byte containing machine temperature
    90				:	VOLTS	byte containing machine voltage
    91				:	VERNO	halfword containing ISIS version number
    92				:	WWVBT	word containing WWVB time
    93				:	HOSTX	halfword containing kernel host number
    94				:	NODEX	halfword containing kernel node number
    95				:	LCX	halfword, offset of local clocks within seg F
    96				:	SLCNT	halfword, number of slots known to ISIS dispatcher
    97				:	LCT	halfword, pointer to crash table
    98				:	MAXP0	halfword, highest port 0 msg. #
    99				:	MAXMSG	halfword, highest msg # for all other ports
   100				:	LP0LST	halfword, length table for port 0 msgs.
   101				:	LENGTH	length table for msgs. all other ports
   102				:	R0-R15	symbolic names for the registers
   103				:	SEGn	the start address of segment n (0-0E)
   104				:	HOSTS	halfword array of host numbers as known by the dispatcher (R/O)
   105				:	PORTS	halfword array of ports/host as known by dispatcher (R/O)
   106				:
   107				:	the following symbols MAY be defined. defaults used otherwise
   108				:	APROTn	protection byte for area n. default area 1 write protected,
   109				:		other areas execution protected.
   110				:	HOSTn	host number for host position n. default none.
   111				:	HPRTn	number of ports for host position n. default none.
   112				:	DSTART	user DDT execution start address. default none.
   113				:	QSTART  user DDT query handler start address, default none.
   114				:	FPANEL	halfword cell for front panel display. default cell allocated
   115				:	FRISIS	bit array for input backpressure (1=no backpressure) default
   116				:			array allocated.
   117				:	TOISIS	bit array for output backpressure (1=no backpressure) default
   118				:			array allocated.
   119				:	VERSION	version number for slot code (default zero)
   120				:	PCTTBL	bit array for indicating terminating character for project
   121				:			code. (default none)
   122				:	REVLEV	revision level for slot code (default zero)
   123				:	A.DATA	segment number for data area. Default 0
   124				:	A.CODE	segment number for code area. Default 1
   125				:	A.BDAT	segment number for based data. Default 2.
   126				:	A.RING	segment number for rings. Default 2.
   127				:	A.BUFF	segment numberfor buffer(let)s. Default 2.
   128				:
   129				:	in addition most SVC calls have been assigned symbolic names.
   130				Page  2-3	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)START.LIB	 ISIS Assembly Switch Definitions	- START.LIB

   131				
   132					GL	FASTC,SLOWC,RATE,NRATE,GMT,TEMPER,VOLTS,VERNO,HOSTX,NODEX,SLOTNO
   133					GL	R0,R1,R2,R3,R4,R5,R6,R7,R8,R9,R10,R11,R12,R13,R14,R15
   134					GL	IRSIZE,ORSIZE,CNTRL
   135					GL	ENTRY,IRING,ORING,ENGINE,LCX
   136					GL	VERREV,COREST,FPANEL,HOSTS,PORTS,FRISIS,TOISIS
   137				
   138				:	DEFINE SEG 15d LOCATIONS
   139	000258			RATE	EQ	$A 600		:clock rate, ticks per second
   140	0F0000			NRATE	EQ	0F0000		:word, contains RATE
   141	0F0004			FASTC	EQ	0F0004		:word, contains fast clock (ticks)
   142	0F0008			SLOWC	EQ	0F0008		:word, contains slow clock (seconds)
   143	0F000C			GMT	EQ	0F000C		:word, contains GMT (seconds since 1/1/72)
   144	0F0010			TEMPER	EQ	0F0010		:byte, contains machine temperature
   145	0F0011			VOLTS	EQ	0F0011		:byte, contains machine voltage
   146	0F0012			VERNO	EQ	0F0012		:halfword, ISIS version number
   147	0F0014			WWVBT	EQ	0F0014		:word, WWVB time (format ??)
   148	0F0018			HOSTX	EQ	0F0018		:halfword, kernel host number
   149	0F001A			NODEX	EQ	0F001A		:halfword, kernel node number
   150				
   151				: Local clocks displacements
   152				
   153	0F001C			LCX	EQ	0F001C	:1/2 word, contains offset of LOCLKS within seg F
   154				: LOCLKX and LOCLKS must be referenced by the pointer in LCX
   155				:LOCLKX	EQ	LOCLKS-2 :1/2 word, index to current clock from LOCLKX
   156				:LOCLKS	EQ	Seg F + contents of LCX
   157							:clocks for slots, array of word entries per slot
   158							:1st halfword is user ticks, 2nd is sys ticks for slot
   159				
   160	0F001E			SLCNT	EQ	0F001E		:halfword, number of dispatcher slots
   161	0F0020			LCT	EQ	0F0020		:halfword, pointer to crash table
   162	0F0022			MAXP0	EQ	0F0022		:halfword, max. msg. # for port 0
   163	0F0024			MAXMSG	EQ	0F0024		:halfword, max. msg #, all non-0 ports
   164	0F0026			LP0LST	EQ	0F0026		:halfword, offset to port 0 msg length table
   165	0F0028			LENGTH	EQ	0F0028		:byte table, lengths of non-0 port msgs
   166				
   167				:	Define Registers
   168	000000			R0	EQ	0
   169	000001			R1	EQ	1
   170	000002			R2	EQ	2
   171	000003			R3	EQ	3
   172	000004			R4	EQ	4
   173	000005			R5	EQ	5
   174	000006			R6	EQ	6
   175	000007			R7	EQ	7
   176	000008			R8	EQ	8
   177	000009			R9	EQ	9
   178	00000A			R10	EQ	$A 10
   179	00000B			R11	EQ	$A 11
   180	00000C			R12	EQ	$A 12
   181	00000D			R13	EQ	$A 13
   182	00000E			R14	EQ	$A 14
   183	00000F			R15	EQ	$A 15
Page  2-4	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)START.LIB	 ISIS Assembly Switch Definitions	- START.LIB

   184				Page  2-5	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)START.LIB	 ISIS Assembly Switch Definitions	- START.LIB

   185				
   186				:	AREA DEFINITIONS
   187					GL	A.DATA,A.CODE,A.BDAT,A.RING,A.BUFF
   188				:
   189	000000			  IF	\A.DATA
   190	000001			  ELSE
   191	000000			A.DATA	EQ	0	:DEFAULT DATA AREA
   192				  EI
   193				
   194	000000			  IF	\A.CODE
   195	000001			  ELSE
   196	000001			A.CODE	EQ	1	:DEFAULT CODE AREA
   197				  EI
   198				
   199	000000			  IF	\A.BDAT
   200	000001			  ELSE
   201	000002			A.BDAT	EQ	2	:DEFAULT BASED DATA AREA
   202				  EI
   203				
   204	000000			  IF	\A.RING
   205	000001			  ELSE
   206	000002			A.RING	EQ	2	:DEFAULT RING AREA
   207				  EI
   208				
   209	000001			  IF	\A.BUFF
   210	000000			  ELSE
   211				A.BUFF	EQ	2	:DEFAULT BUFFER AREA
   212				  EI
   213				Page  2-6	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)START.LIB	 ISIS Assembly Switch Definitions	- START.LIB

   214				
   215				:	SVC DEFINITIONS
   216				:
   217					GL	DISMIS,FASTD,SYS,RSTRT.,CFGND.,DBGON.,DBGOF.,TSTDB.
   218					GL	FREEZ.,THAW.,TFREZ.,RDDTR.,RDDTP.,RBREG.,RBPSD.
   219					GL	RFREG.,RFPSD.,RDMAC.,RBMAC.,RFMAC.,SET1P.,SETP.,SETBE.
   220					GL	SETFE.,IO,IOQRY.,CSYNI.,CSYNO.,FSYNO.,TIISC.
   221					GL	CSUPF.,CSUPR.,FREZS.,THAWS.,ALARM.,RSCLK.,SSCLK.,SUDIA.
   222					GL	SFREZ.,HALT.,SHALT.
   223					GL	TIISI.,CASYN.,CPRT.,FPRT.,CSIO.,CMBRD.,FMBIN.,FMBOT.
   224					GL	SHARE,K.IN,K.OUT,KIO,BDISC,SDISC
   225				:
   226	000000			DISMIS	EQ	0	:DISMISS SVC
   227	000001			FASTD	EQ	1	:FAST DISMISS SVC
   228				:
   229	000002			SYS	EQ	2	:SYS SVC
   230				
   231				:	SYS SVC SUBOPERANDS
   232	000000			RSTRT.	EQ	0	:Restart syscall
   233	000001			CFGND.	EQ	1	:Connect foreground syscall
   234	000002			DBGON.	EQ	2	:Debug mode ON syscall
   235	000003			DBGOF.	EQ	3	:Debug mode OFF syscall
   236	000004			TSTDB.	EQ	4	:Test debug mode syscall
   237	000005			FREEZ.	EQ	5	:Freeze slot syscall
   238	000006			THAW.	EQ	6	:Thaw slot syscall
   239	000007			TFREZ.	EQ	7	:Test freeze syscall
   240	000008			RDDTR.	EQ	8	:Read DDT register syscall
   241	000009			RDDTP.	EQ	9	:Read DDT PSD syscall
   242	00000A			RBREG.	EQ	0A	:Read background register syscall
   243	00000B			RBPSD.	EQ	0B	:Read background PSD syscall
   244	00000C			RFREG.	EQ	0C	:Read foreground register syscall
   245	00000D			RFPSD.	EQ	0D	:Read foreground PSD syscall
   246	00000E			RDMAC.	EQ	0E	:Read DDT MAC register syscall
   247	00000F			RBMAC.	EQ	0F	:Read background MAC register syscall
   248	000010			RFMAC.	EQ	10	:Read foreground MAC register syscall
   249	000011			SET1P.	EQ	11	:Set 1 protect syscall
   250	000012			SETP.	EQ	12	:Set protection syscall
   251	000013			SETBE.	EQ	13	:Set background execution addr syscall
   252	000014			SETFE.	EQ	14	:Set foreground execution addr syscall
   253	000015			LMAC.	EQ	15	:Set up MAC from CTA (DDT only)
   254	000016			CSUPF.	EQ	16	:Check SUP freeze state
   255	000017			CSUPR.	EQ	17	:Check SUP run Q state
   256	000018			FREZS.	EQ	18	:Freeze the SUP
   257	000019			THAWS.	EQ	19	:Thaw the SUP
   258	00001A			ALARM.	EQ	1A	:Set/Clear alarm
   259	00001B			RSCLK.	EQ	1B	:Read the super-clock
   260	00001C			SSCLK.	EQ	1C	:Set the super-clock
   261	00001D			SUDIA.	EQ	1D	:Set user diagnostic
   262	00001E			UCORE.	EQ	1E	:Get slot physical addr & size (DDT only)
   263	00001F			SFREZ.	EQ	1F	:Super-freeze slot
   264	000020			HALT.	EQ	20	:Halt the slot
   265	000021			SHALT.	EQ	21	:Super-halt the slot
   266	000022			SVSPY.	EQ	22	:Start/Stop SPY
Page  2-7	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)START.LIB	 ISIS Assembly Switch Definitions	- START.LIB

   267	000023			DISCO.	EQ	23	:Disconnect Logical Unit
   268				Page  2-8	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)START.LIB	 ISIS Assembly Switch Definitions	- START.LIB

   269				
   270	000003			IO	EQ	3	:I/O SVC
   271				:	I/O SUBOPERANDS
   272	008000			IOQRY.	EQ	8000	:Query I/O attributes
   273	000000			CSYNI.	EQ	0	:Connect SYNC input
   274	000001			CSYNO.	EQ	1	:Connect SYNC output
   275	000002			FSYNO.	EQ	2	:Force SYNC output
   276	000003			CASYN.	EQ	3	:Connect ASYNC
   277	000004			CPRT.	EQ	4	:Connect Printer
   278	000005			FPRT.	EQ	5	:Force Printer
   279	000006			TIISC.	EQ	6	:T-II SYNC Connect
   280	000007			TIISI.	EQ	7	:T-II SYNC Idle test
   281	000008			CSIO.	EQ	8	:Connect SIO
   282	000009			CMBRD.	EQ	9	:Connect SIO mother board
   283	00000A			FMBIN.	EQ	0A	:Force mother board input
   284	00000B			FMBOT.	EQ	0B	:Force mother board output
   285	000004			SHARE	EQ	04	:Shared device SVC
   286	00000A			K.IN	EQ	0A	:Kernel Input SVC
   287	00000B			K.OUT	EQ	0B	:Kernel Output SVC
   288	00000D			KIO	EQ	0D	:Kernel-I/O (general) SVC
   289	00000E			BDISC	EQ	0E	:Big disc SVC (obsolete)
   290	00000F			SDISC	EQ	0F	:Small disc SVC (obsolete)
   291				Page  2-9	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)START.LIB	 ISIS Assembly Switch Definitions	- START.LIB

   292				
   293	000000				IF	IRSIZE&3;	REMARK	%IRSIZE should be multiple of 4
   294				IRSIZE	EQ	(IRSIZE!3)+1;	EI
   295	000000				IF	ORSIZE&3;	REMARK	%ORSIZE should be multiple of 4
   296				ORSIZE	EQ	(ORSIZE!3)+1;	EI
   297				
   298	000001			  IF	\MAXPRT
   299	000000			  ELSE
   300					REMARK	%PLEASE DEFINE MAXPRT. NPORTT ASSUMED.
   301				MAXPRT	EQ	NPORTT-1
   302				HPRT0	EQ	MAXPRT
   303				  EI
   304				
   305	000001			  IF	\MAXHST
   306	000000			  ELSE
   307					REMARK	%PLEASE DEFINE MAXHST. 1 ASSUMED.
   308				MAXHST	EQ	1
   309				HOST0	EQ	HOSTNO
   310				  EI
   311				
   312				
   313				:	DEFINE START OF SEGMENTS
   314	000000			Q	EQ	0
   315					LIST
   316				
   317				:GENERATE DIAGNOSTICS
   318	000000			Q	EQ	0
   319					LIST
   320				
   321	000000				IF	QQ;
   322					REMARK	%START.LIB **MUST** be assembled FIRST!!%;
   323					EI
Page  3-1	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)FRING.LIB	 ISIS Ring Handling Routines	- FRING.LIB

   324					SUBTTL	ISIS Ring Handling Routines	- FRING.LIB
   325				:******************************************************************
   326				:
   327				:	This program is the sole property and confidential
   328				:	information of Tymshare, Inc., and may not be copied
   329				:	in whole or in part or disclosed to any third party
   330				:	without the prior written consent of Tymshare.
   331				:
   332				:*******************************************************************
   333					RA	0		:	FRING.LIB
   334				
   335				:	ISIS RING HANDLERS
   336				
   337				:	This package is the fast, efficient ring handler set
   338				:	The following CONSTRAINTS apply:
   339				:	1.  Once started, register 14 or 15 is dedicated to that
   340				:		operation, until it is "ended".
   341				:	2.  If a new operation is started before the previous operation is
   342				:		"ended", the previous operation is aborted, and the
   343				:		appropriate ring is effectively left unchanged.
   344				:
   345				:	This package now permits simultaneous input and output!!!
   346				:		R15 is used for output operations
   347				:		R14 is used for input operations
   348				
   349				:*: NOTE: ISIS II will soon use negative indexing, like this ring package.
   350				:*:	To convert this package, remove all lines with ':*:' in them,
   351				:*:	and change all occurrences of 'LHL R15/R14' to 'LH R15/R14'.
   352				
   353				:	The package contains both utility and primitive routines:
   354				
   355				:	utility routines are called with link R5,
   356				:	they preserve registers R6--R14.
   357				:	OCS	Output Canned String
   358				:		R2 = port #, R3 = pointer to string (SC format)
   359				:		OCS will output string as a data message to the specified
   360				:		port. OCS goes to completion, and "ends the operation.
   361				:	OCM	Output Canned Message
   362				:		R2 = port #, R3 = pointer to string (SC format)
   363				:		OCM will output the string as a message to the specified port
   364				:		OCM goes to completion, and "ends the operation.
   365				:	OBS	Output Byte String
   366				:		R2 = number of characters, R3 = pointer to string
   367				:		OBS will output specified string into the current message
   368				:		message must have already been "started", and is NOT "ended".
   369				
   370				:	primitive input routines.  All link on R4, & preserve R1-R3, R5-R13, R15:
   371				:	LOOK	Determine if an input message exists...normal return if not
   372				:		skip (4) return if so, and then:
   373				:		R1 = port n
   374				:		R2 = message type code (peek)
   375				:		On skip return, condition codes are set such that JE will
   376				:		succeed on port 0.  The port number will have been removed
Page  3-2	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)FRING.LIB	 ISIS Ring Handling Routines	- FRING.LIB

   377				:		from the message but the message code will not have been
   378				:		removed (you get a peek at it).
   379				:	GETCH	Get a character, returned in R0.
   380				:	GETH	Get a halfword, returned in R0.  An even number of bytes 
   381				:		should have been removed previously for expected results.
   382				:	GETW	Get a word, returned in R0.  An even number of halfwords 
   383				:		should have been removed previously for expected results.
   384				:	FLUSH	Flush away ("end") remainder of input message.  R0 is number
   385				:		of bytes remaining to flush.
   386				:	ELIR	End-Logical-Input-Record.  "Ends" current message, sets
   387				:		up pointers for next message.
   388				
   389				:	Primative output routines.  All link on R4, preserve R1-R3, R5-R14,
   390				:	unless used for arguments, or otherwise specified:
   391				:	SPACE	Returns R0 = number of characters of space available in	
   392				:		output ring. Sets up R15 for "start" of message.
   393				:	ROOM	R0 = number of characters required for next message,
   394				:		returns when that much room is available in output ring.
   395				:		MAY DISMISS.
   396				:		sets up R15 for "start" of message. SMASHES R1.
   397				:	SLOR	Start Logical Output Record.
   398				:		R0 = number of bytes required.
   399				:		R1 = port #
   400				:		R2 = message type code.
   401				:		Provides function of ROOM, PUTH, and PUTCH for first 3 chars
   402				:		of message. MAY DISMISS. SMASHES R3.
   403				:	PUTCH	places character in R0 in next position of ring.
   404				:	PUTH	places halfword in R0 in next position of ring.  Even number
   405				:		of bytes have been output previously in this message.
   406				:	PUTW	places word in R0 in next position of ring.  Even number of
   407				:		halfwords should have been output previously in this message.
   408				:	ELODR	End Logical Output Data Record
   409				:		places byte count into message type to make data message,
   410				:		then "ends" message.  Smashes R0, R1.
   411				:	ELOR	End Logical Output Record
   412				:		"ends" message.
   413				
   414				:	CONVENTIONS:
   415				:	ROUTINES USE DEDICATED REGISTERS:
   416				:	R15	OUTPUT RING INDEX
   417				:	R14	INPUT RING INDEX
   418				:
   419				:	NOTE....
   420				:		IRSIZE AND ORSIZE MUST EACH BE LESS THAN 32K.
   421				Page  3-3	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)FRING.LIB	 ISIS Ring Handling Routines	- FRING.LIB

   422				
   423					GL	IRING,ORING,IRSIZE,ORSIZE
   424					GL	OCS,OCM,OBS
   425					GL	LOOK,GETCH,GETH,GETW,FLUSH,ELIR
   426					GL	SPACE,ROOM,SLOR,PUTCH,PUTH,PUTW,ELODR,ELOR
   427				
   428					MO	.,RING
   429	000000			NFMI	EQ	0		:RELATIVE INDEX OF NEXT-FILL-MESSAGE-INDEX
   430	000002			CEI	EQ	2		:RELATIVE INDEX OF CURRENT-EMPTY-INDEX
   431	000004			RING	EQ	4		:RELATIVE INDEX OF START OF RING DATA
   432				
   433				:	DEFINE DATA AREA
   434	020000				SEG	A.RING		:RINGS IN RING AREA
   435				
   436				:	THE DISPATCHER OUTPUT RING
   437	020000			ORING	HS	0		:OUTPUT BLOCK START ADDRESS
   438	020000	0000 			HC	0		:OUTPUT NEXT FILL MESSAGE INDEX
   439	020002	0000 			HC	0		:OUTPUT CURRENT ENTRY INDEX
   440	020004				BS	ORSIZE		:THE OUTPUT RING
   441				
   442				:	THE DISPATCHER INPUT RING
   443	022000			IRING	HS	0		:INPUT BLOCK START ADDRESS
   444	022000	0000 			HC	0		:INPUT NEXT FILL MESSAGE INDEX
   445	022002	0000 			HC	0		:INPUT CURRENT EMPTY INDEX
   446	022004				BS	IRSIZE		:THE INPUT RING
   447				Page  3-4	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)FRING.LIB	 ISIS Ring Handling Routines	- FRING.LIB

   448				
   449				:	CODE AREA
   450	010000				SEG	A.CODE
   451				:	INPUT ROUTINES
   452				
   453				:	LOOK AT A RING ENTRY
   454				:	NORMAL RETURN IF RING EMPTY
   455				:	ELSE SKIP RETURN, PORT RETURNED IN R1
   456				:	MESSAGE TYPE RETURNED IN R2
   457				:	ALL REGISTERS SET UP FOR TRANSFER
   458				:	POSITION IS ADVANCED PAST PORT#
   459	000000				IF	\LOOK;.LOOK.	 HS	0;
000001				ELSE
   460	010000			LOOK	 HS	0
   461					EI
   462	010000	73E0 4002 2002 		LHL	R14,CEI+IRING,,	:GET CURRENT EMPTY INDEX
   463	010006	45E0 4002 2000 		CLH	R14,NFMI+IRING,,	:TEST IF CAUGHT UP
   464	01000C	0334 			JER	R4		:EMPTY...NORMAL RETURN
   465	01000E	CBE0 07FC 		SHI	R14,IRSIZE	:*: CONVERT TO NEGATIVE INDEX
   466	010012	731E 4002 2800 		LHL	R1,IRING+RING+IRSIZE,R14,	:GET PORT #
   467	010018	26E2 			AIS	R14,2		:BUMP POINTER PAST PORT #
   468	01001A	D32E 4002 2800 		LB	R2,IRING+RING+IRSIZE,R14,	:GET MESSAGE TYPE
   469	010020	0811 			LR	R1,R1		:SET CONDITION CODES
   470	010022	4304 0004 		J	4,R4		:THEN SKIP RETURN
   471				
   472				:	GET A CHARACTER FROM THE INPUT RING
   473				:	CHARACTER RETURNED IN R0
   474	010026	D30E 4002 2800 	GETCH	LB	R0,IRING+RING+IRSIZE,R14,	:GET THE CHAR
   475	01002C	26E1 			AIS	R14,1		:BUMP INDEX
   476	01002E	0214 			JLR	R4		:RETURN IF NOT
   477	010030	C8E0 F804 		LHI	R14,-IRSIZE	:ELSE FOLD IT
   478	010034	0304 			JR	R4		:AND EXIT
   479				
   480				:	GET A HALF-WORD FROM THE INPUT RING
   481				:	ASSUME HAVE REMOVED AN INTEGRAL NUMBER OF HALF-WORDS FROM RECORD
   482				:	HALF-WORD RETURNED IN R0
   483	010036	730E 4002 2800 	GETH	LHL	R0,IRING+RING+IRSIZE,R14,	:GET THE DATA
   484	01003C	26E2 			AIS	R14,2		:BUMP INDEX
   485	01003E	0214 			JLR	R4		:RETURN IF NOT
   486	010040	C8E0 F804 		LHI	R14,-IRSIZE	:ELSE FOLD IT
   487	010044	0304 			JR	R4		:AND EXIT
   488				
   489				:	GET A WORD FROM THE INPUT RING
   490				:	ASSUME HAVE REMOVED AN INTEGRAL NUMBER OF WORDS FROM RECORD
   491				:	WORD RETURNED IN R0
   492	010046	580E 4002 2800 	GETW	L	R0,IRING+RING+IRSIZE,R14,	:GET THE DATA
   493	01004C	26E4 			AIS	R14,4		:BUMP INDEX
   494	01004E	0214 			JLR	R4		:RETURN IF NOT
   495	010050	C8E0 F804 		LHI	R14,-IRSIZE	:ELSE FOLD IT
   496	010054	0304 			JR	R4		:AND EXIT
   497				
   498				:	FLUSH AN INPUT RECORD
   499				:	NUMBER OF CHARS TO FLUSH IN R0
Page  3-5	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)FRING.LIB	 ISIS Ring Handling Routines	- FRING.LIB

   500	010056	0AE0 		FLUSH	AR	R14,R0		:ADVANCE RING AND FALL THROUGH
   501				
   502				:	END LOGICAL INPUT RECORD
   503	010058	26E3 		ELIR	AIS	R14,3		:FORCE TO NEXT WORD
   504	01005A	C4E0 FFFC 		NHI	R14,-4
   505	01005E	2113 			JLFS	ELIR2		:NO
   506	010060	CBE0 07FC 		SHI	R14,IRSIZE	:YES
   507				ELIR2
   508	010064	CAE0 07FC 		AHI	R14,IRSIZE	:*: CONVERT TO POSITIVE INDEX
   509	010068	40E0 4002 2002 		STH	R14,CEI+IRING,,
   510	01006E	0304 			JR	R4		:AND EXIT
   511				Page  3-6	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)FRING.LIB	 ISIS Ring Handling Routines	- FRING.LIB

   512				
   513				:	OUTPUT ROUTINES
   514				
   515				:	OUTPUT "CANNED" MESSAGE
   516				:	LINK ON R5
   517				:	R2 = PORT #
   518				:	R3 = POINTER TO STRING (FORMAT: n\B1\...\Bn)
   519	010070	D303 0000 	OCM	LB	R0,0,R3		:GET COUNT n
   520	010074	2605 			AIS	R0,5		:COMPUTE SPACE REQUIREMENTS
   521	010076	C400 FFFC 		NHI	R0,-4
   522	01007A	4140 806E 		JAL	R4,ROOM		:INSURE THERE IS ROOM
   523	01007E	0802 			LR	R0,R2		:COPY PORT #
   524	010080	4140 80E0 		JAL	R4,PUTH		:PLACE PORT NUMBER
   525	010084	D323 0000 		LB	R2,0,R3		:GET COUNT AGAIN
   526	010088	4300 801E 		J	OCS1		:SKIP TO PLACE THE STRING
   527				
   528				:	OUTPUT "CANNED" STRING
   529				:	LINK ON R5
   530				:	R2 = PORT #
   531				:	R3 = POINTER TO TEXT STRING (FORMAT n\B1\...\Bn)
   532	01008C	D303 0000 	OCS	LB	R0,0,R3		GET COUNT n
   533	010090	2606 			AIS	R0,6		:COMPUTE SPACE REQUIREMENTS
   534	010092	C400 FFFC 		NHI	R0,-4
   535	010096	4140 8052 		JAL	R4,ROOM		:INSURE THERE IS ROOM
   536	01009A	0802 			LR	R0,R2
   537	01009C	4140 80C4 		JAL	R4,PUTH		:PLACE PORT NUMBER
   538	0100A0	D323 0000 		LB	R2,0,R3
   539	0100A4	0802 			LR	R0,R2		:GET THE COUNT n
   540	0100A6	4140 80AA 		JAL	R4,PUTCH	:PLACE IT...MESSAGE TYPE 1-7D
   541	0100AA	2631 		OCS1	AIS	R3,1		:BUMP SOURCE CHARACTER POINTER
   542	0100AC	D303 0000 		LB	R0,0,R3		:GET THE NEXT CHARACTER
   543	0100B0	4140 80A0 		JAL	R4,PUTCH	:PLACE IT INTO RING
   544	0100B4	2721 			SIS	R2,1		:REDUCE COUNT
   545	0100B6	2026 			JGBS	OCS1		:REPEAT UNTIL ALL CHARACTERS PLACED
   546	0100B8	4140 80E6 		JAL	R4,ELOR		:END LOGICAL OUTPUT RECORD
   547	0100BC	0305 			JR	R5		:THEN EXIT
   548				
   549				:	OUTPUT A BYTE STRING
   550				:	LINK ON R5
   551				:	R3 = POINTER TO STRING
   552				:	R2 = NUMBER OF CHARACTERS TO OUTPUT FROM STRING
   553	0100BE	2631 		OBS1	AIS	R3,1		:BUMP CHARACTER POINTER
   554	0100C0	D303 0000 	OBS	LB	R0,0,R3		:GET THE NEXT CHARACTER
   555	0100C4	4140 808C 		JAL	R4,PUTCH	:PLACE IT INTO RING
   556	0100C8	2721 			SIS	R2,1		:REDUCE COUNT
   557	0100CA	2026 			JGBS	OBS1		:REPEAT UNTIL ALL CHARACTERS PLACED
   558	0100CC	0305 			JR	R5		:THEN EXIT
   559				
   560				:	FIND SPACE IN THE RING (HOW BIG A MESSAGE IT WILL TAKE)
   561				:	RETURNS R0 = NUMBER OF CHARS OF SPACE
   562	0100CE	2504 		SPACE	LCS	R0,4		:SET MASK
   563	0100D0	73F0 4002 0000 		LHL	R15,NFMI+ORING,,
   564	0100D6	4400 4002 0002 		NH	R0,CEI+ORING,,	:FORCE EMPTIER TO WORD BOUNDARY
Page  3-7	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)FRING.LIB	 ISIS Ring Handling Routines	- FRING.LIB

   565	0100DC	0B0F 			SR	R0,R15		:SPACE BETWEEN US AND EMPTIER
   566	0100DE	2123 			JGFS	SPACE1		:SKIP IF NO WRAP-AROUND
   567	0100E0	CA00 1FFC 		AHI	R0,ORSIZE	:ELSE CORRECT FOR WRAP
   568	0100E4	2704 		SPACE1	SIS	R0,4		:CORRECT FOR POSSIBLE OVERFLOW
   569	0100E6	CBF0 1FFC 		SHI	R15,ORSIZE	:*: CONVERT TO NEGATIVE INDEX
   570	0100EA	0304 			JR	R4		:AND RETURN
   571				
   572				:	INSURE THERE IS ROOM IN THE RING (DISMISS IF NECESSARY)
   573				:	EXPECTS R0 = NUMBER OF CHARACTERS OF SPACE
   574	0100EC	73F0 4002 0000 	ROOM	LHL	R15,NFMI+ORING,,
   575	0100F2	CBF0 1FFC 		SHI	R15,ORSIZE	:*: CONVERT TO NEG. INDEX
   576	0100F6	2514 		ROOM1	LCS	R1,4		:SET MASK
   577	0100F8	4410 4002 0002 		NH	R1,CEI+ORING,,	:FORCE HIM TO WORD BOUNDARY
   578	0100FE	CB10 1FFC 		SHI	R1,ORSIZE	:*:
   579	010102	0B1F 			SR	R1,R15		:CHECK RELATIVE POSITIONS
   580	010104	2124 			JGFS	ROOM2		:SKIP IF HE'S AHEAD OF US
   581	010106	0334 			JER	R4		:EQUAL...HE'S EMPTY...GO DO IT
   582	010108	CA10 1FFC 		AHI	R1,ORSIZE		:HE'S BEHIND US
   583	01010C	2714 		ROOM2	SIS	R1,4		:ALLOW FOR POTENTIAL OVERFLOW
   584	01010E	0901 			CR	R0,R1
   585	010110	0324 			JLER	R4		:ROOM EXISTS...GO DO IT
   586	010112	E100 0000 		SVC	DISMISS,0
   587	010116	4300 FFDC 		J	ROOM1		:AND GO TRY AGAIN
   588				
   589				:	START LOGICAL OUTPUT RECORD
   590				:	PROVIDES FUNCTION OF ROOM, PUTH, & PUTCH FOR FIRST 3 CHARS OF MESSAGE
   591				:	R0 = NUMBER OF CHARACTERS OF SPACE REQUIRED
   592				:	R1 = PORT #
   593				:	R2 = MESSAGE CHARACTER CODE
   594	01011A	73F0 4002 0000 	SLOR	LHL	R15,NFMI+ORING,,
   595	010120	CBF0 1FFC 		SHI	R15,ORSIZE	:*: CONVERT TO NEG. INDEX
   596	010124	2534 		SLOR1	LCS	R3,4		:SET A MASK
   597	010126	4430 4002 0002 		NH	R3,CEI+ORING,,	:FORCE RECEIVER TO WORD BOUNDARY
   598	01012C	CB30 1FFC 		SHI	R3,ORSIZE	:*:
   599	010130	0B3F 			SR	R3,R15
   600	010132	2123 			JGFS	SLOR2
   601	010134	CA30 1FFC 		AHI	R3,ORSIZE	:ACCOUNT FOR POSSIBLE RING FOLDING
   602	010138	2734 		SLOR2	SIS	R3,4		:ALLOW FOR POTENTIAL OVERFLOW
   603	01013A	0930 			CR	R3,R0
   604	01013C	2314 			JGEFS	SLOR3		:SKIP IF WE CAN GO
   605	01013E	E100 0000 		SVC	DISMISS,0
   606	010142	220F 			JBS	SLOR1
   607	010144	401F 4002 2000 	SLOR3	STH	R1,ORING+RING+ORSIZE,R15,	:OK...PLACE MESSAGE
   608	01014A	D22F 4002 2002 		STB	R2,2+ORING+RING+ORSIZE,R15,
   609	010150	26F3 			AIS	R15,3		:BUMP PAST THESE CHARACTERS
   610	010152	0304 			JR	R4		:AND EXIT
   611				
   612				:	PUT A CHARACTER INTO THE RING
   613				:	R0 = CHARACTER
   614	010154	D20F 4002 2000 	PUTCH	STB	R0,ORING+RING+ORSIZE,R15,	:PLACE THE CHARACTER
   615	01015A	26F1 			AIS	R15,1		:BUMP INDEX
   616	01015C	0214 			JLR	R4		:SKIP IF NOT
   617	01015E	C8F0 E004 		LHI	R15,-ORSIZE	:ELSE WRAP AROUND
Page  3-8	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)FRING.LIB	 ISIS Ring Handling Routines	- FRING.LIB

   618	010162	0304 			JR	R4		:AND EXIT
   619				
   620				:	PUT A HALF-WORD INTO THE RING
   621				:	R0 = HALF-WORD
   622	010164	400F 4002 2000 	PUTH	STH	R0,ORING+RING+ORSIZE,R15,	:PLACE THE HALF-WORD
   623	01016A	26F2 			AIS	R15,2		:BUMP INDEX
   624	01016C	0214 			JLR	R4		:EXIT IF NOT
   625	01016E	C8F0 E004 		LHI	R15,-ORSIZE	:ELSE WRAP AROUND
   626	010172	0304 			JR	R4		:AND EXIT
   627				
   628				:	PUT A WORD INTO THE RING
   629				:	R0 = WORD
   630	010174	500F 4002 2000 	PUTW	ST	R0,ORING+RING+ORSIZE,R15,	:PLACE THE WORD
   631	01017A	26F4 			AIS	R15,4		:BUMP INDEX
   632	01017C	0214 			JLR	R4		:SKIP IF NOT
   633	01017E	C8F0 E004 		LHI	R15,-ORSIZE	:ELSE WRAP AROUND
   634	010182	0304 			JR	R4		:AND EXIT
   635				
   636				:	END LOGICAL OUTPUT DATA RECORD
   637	010184	7310 4002 0000 	ELODR	LHL	R1,NFMI+ORING,,	:GET START OF THIS MESSAGE
   638	01018A	CB10 1FFC 		SHI	R1,ORSIZE	:*: CONVERT TO NEG. INDEX
   639	01018E	080F 			LR	R0,R15		:COPY MESSAGE END
   640	010190	0B01 			SR	R0,R1		:COMPUTE SIZE OF THIS MESSAGE
   641	010192	2313 			JGEFS	ELODR2		:SKIP IF NO WRAP-AROUND
   642	010194	CA00 1FFC 		AHI	R0,ORSIZE		:ELSE CORRECT FOR WRAP
   643	010198	2703 		ELODR2	SIS	R0,3		:MAKE ALLOWANCE FOR HEADER
   644	01019A	0334 			JER	R4		:EXIT IF ZERO LENGTH MESSAGE
   645	01019C	D201 4002 2002 		STB	R0,2+ORING+RING+ORSIZE,R1,	:INSERT MESSAGE TYPE INTO MESSAGE
   646								:AND FALL THROUGH
   647				
   648				:	END LOGICAL OUTPUT RECORD
   649	0101A2	26F3 		ELOR	AIS	R15,3
   650	0101A4	C4F0 FFFC 		NHI	R15,-4
   651	0101A8	2113 			JLFS	ELOR2
   652	0101AA	C8F0 E004 		LHI	R15,-ORSIZE	:FOLD IF NECESSARY
   653				ELOR2
   654	0101AE	CAF0 1FFC 		AHI	R15,ORSIZE	:*: CONVERT BACK
   655	0101B2	40F0 4002 0000 		STH	R15,NFMI+ORING,,	:NOW ADVANCE POINTER TO NEXT MESSAGE
   656	0101B8	0304 			JR	R4		:AND EXIT
   657					EM
Page  4-1	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)CRASH.LIB	 ISIS STARTUP AND CRASH LIBRARY	- CRASH.LIB

   658					SUBTTL	ISIS STARTUP AND CRASH LIBRARY	- CRASH.LIB
   659				        REMARK  %CRASH.LIB    11-15-84 AWT
   660					REMARK	%THIS VERSION HAS AN OPTION FOR EXTENDED CRASH PROCESSING.
   661				
   662				:******************************************************************
   663				:
   664				:	This program is the sole property and confidential
   665				:	information of Tymshare, Inc., and may not be copied
   666				:	in whole or in part or disclosed to any third party
   667				:	without the prior written consent of Tymshare.
   668				:
   669				:*******************************************************************
   670					RA	0		:	CRASH.LIB	MFR 07/14/81
   671				
   672				:       Set UPSW to turn off tracing.
   673				:       Added CTIME and CRTIME to save crash times in GMT.
   674				:       Added a NCRSAV option to keep old copies of crash tables.
   675				:         April 13, 1983 AWT
   676				:
   677				:	Changed the supervisor's log message to report the PRODID.
   678				:	Sep. 20, 1982 SCY.
   679				:	ENTRY2 (restart service) changed to clear input and output
   680				:	rings PRIOR to issuing Restart SVC to prevent crash-loop if
   681				:	Dispatcher has crashed. June 17, 1982 MDS.
   682				
   683				:			ISIS - II Version
   684				:
   685					GL	CRASH,CRASHC,CPOINT,CFROM,CRREG,ENTRY,START,CRAT,CRSHCT,CRSTOP
   686				        GL      PRODID,NCRSAV,CTIME,CRTIME,EXCRSH
   687					MO	.,CRASH
   688				
   689				
   690				:	Generalized crash package.
   691				:	Handles both software and hardware crashes.  On any crash, the
   692				:	registers are saved in CRXREG, and CRSHCT is incremented.
   693				:	Software crashes occur via  JAL R10,CRASH .  CRASH saves (R10) in cell
   694				:	CPOINT.  Software crashes may be "good" or "bad"...if "good", the
   695				:	calling sequence is:
   696				
   697				:		JAL	R10,CRASH
   698				:						from a bad one
   699				:		HC	0		:this key distinguishes a good crash
   700				:		BC	4*L,Y		:first byte is 4*register linked to
   701				:						routine, Y is the reason
   702				:	then register (L) is saved in CFROM, and Y is saved in CRASHC
   703				
   704				:	in the event of a hardware failure, CPOINT contains the instruction
   705				:	address at the time of failure, CRASHC contains the failure reason,
   706				:	and CFROM is set =-1.
   707				
   708				:	On completion of crash, transfers to label START, defined
   709				:	in the user code.
   710				:
Page  4-2	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)CRASH.LIB	 ISIS STARTUP AND CRASH LIBRARY	- CRASH.LIB

   711				:	The symbol CRSTOP may be set to 0 or 1.  If 1 the crash routine will
   712				:	be executed only once.  the second time through the crash area will
   713				:	be set up as specified above and then registers will be restored to
   714				:	their entry value and the slot will be frozen. If it is thawed it
   715				:	will restart.
   716				:
   717				:       The symbol NCRSAV defines the number of crash tables to be saved.
   718				:       It will be set to 1 by default. (In TYMFIL CRSHTB macro is used
   719				:       to define NCRSAV)
   720				:
   721				:       Entering :R CRAT,CRTSIZ (or 4C) will dump the last 
   722				:       crash table, CRAT+CRTLEN (or 50),CRTSIZ will dump the    
   723				:       previous crash table and so on.
   724				:
   725				:       CTIME,4 gives the last crash time (in GMT), CTIME+CRTLEN,4
   726				:       gives the previous crash time and so on.
   727				:
   728				:	The symbol EXCRSH, if set to 1, allows a JAL to label
   729				:	CRSH.P out of the crash routine for extended crash processing.
   730				:	The link is R5.  EXCRSH is defaulted to 0.
   731				:
   732				:
   733				Page  4-3	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)CRASH.LIB	 ISIS STARTUP AND CRASH LIBRARY	- CRASH.LIB

   734				
   735	000001			  IF	\CRSTOP
   736	000000			  ELSE
   737				CRSTOP	EQ	0
   738				  EI
   739				  
   740	000000			  IF    \NCRSAV                 :# OF CRASH TABLES TO SAVE
   741	000001			  ELSE                          :IT MAY BE DEFINED IN TYMFIL
   742	000001			NCRSAV  EQ      1               :OTHERWISE IT IS 1 BY DEFAULT
   743				  EI
   744				
   745	000000			  IF	\EXCRSH			:DEFAULT TO NO EXTENDED CRASH HANDLING
   746	000001			  ELSE
   747	000000			EXCRSH	EQ	0
   748				  EI
   749				
   750				
   751	000000			CRTENT  EQ      .               :CRASH TABLE ENTRY
   752	000000			        ORG     0
   753	000000			CRSHCT	HS	1		:CRASH COUNT...HOW MANY TIMES CRASHED
   754	000002			CRASHC	HS	1		:CRASH CODE (INIT'ED TO MANUAL RESTART)
   755	000004			CPOINT	HS	2		:WHERE CRASH OCCURED
   756	000008			CFROM	HS	2    		:WHERE CRASH WAS CALLED FROM
   757	00000C			CRXREG	HS	20		:CRASH REGISTER SAVE AREA
   758	00004C			CRTSIZ  WS      0               :SIZE OF CRASH TABLE WITHOUT CRTIME
   759	00004C			CRTIME  WS      1               :REAL TIME OF CRASH (GMT)
   760	000050			CRTLEN  WS      0               :LENGTH OF CRASH TABLE WITH CRTIME
   761	000000			        ORG     CRTENT  
   762				
   763	000000			        SEG     A.DATA
   764	000000			        HS      0
   765	000000			CTIME   WS      1               :STORAGE FOR CRASH TIME OF LAST CRASH
   766	000004			CRAT    BS      CRTLEN*NCRSAV   :STORAGE FOR CRASH TABLE(S)
   767	000010			CRREG   EQ      CRAT+CRXREG
   768	000054			RGSTOR  WS      10              :TEMPORARY STORAGE FOR REGISTERS
   769	000094			FGNDFL	HS	1		:FOREGROUND FLAG
   770				
   771	000098	0000 0000 0001 	TRBOFF  WC      0,FAIL0         :TRACE BIT OFF, GO TO FAIL0
		01F4 		
   772	0000A0	0000 0000 0001 	TRCOFF  WC      0,CRASH0        :TRACE BIT OFF, GO TO CRASH0
		026A 		
   773	0000A8	0000 0000 0001 	PSWSAV  WC      0,START         :RESTORE PSW,  GO TO INITIALIZATION CODE
		0000 		
   774	0000B0	0000 0000 	CHFLAG  WC      0               :USED FOR ANY CHANGES ON PSW
   775				
   776				
   777	0101BA				SEG	A.CODE		:CODE AREA
   778	0101BA	01		CRSHCD	BC	1	:MANUAL RESTART
   779	0101BB	00 			BC	0	:POWER FAILURE
   780	0101BC	0E			BC	0E	:PARITY ERROR
   781	0101BD	10 			BC	10	:DISPATCHER CRASH
   782	0101BE	11			BC	11	:ILLEGAL INSTRUCTION
   783	0101BF	12 			BC	12	:ILLEGAL SVC
Page  4-4	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)CRASH.LIB	 ISIS STARTUP AND CRASH LIBRARY	- CRASH.LIB

   784	0101C0	13			BC	13	:SYSTEM CRASH
   785	0101C1	14 			BC	14	:PROTECTION VIOLATION
   786	0101C2	15			BC	15	:NON-RECOVERABLE DEVICE CHECK
   787	0101C3	16 			BC	16	:WATCH FROG TIMER - - TIME OUT
   788				
   789					RA	0
   790				:	GENERAL MACHINE FAILURE
   791	0101C4			FAIL	HS	4		:PSD SAVED HERE
   792	0101CC				HS	4		:R0,R1 SAVED HERE
   793	0101D4	5000 4000 0054 	        ST      R0,RGSTOR,,     :SAVE R0
   794	0101DA	5020 4000 0058 	        ST      R2,RGSTOR+4,,   :SAVE R2
   795	0101E0	4120 8196 	        JAL     R2,SAVPSW       :SAVE CURRENT PSW
   796	0101E4	5800 4000 0054 	        L       R0,RGSTOR,,     :RESTORE R0
   797	0101EA	5820 4000 0058 	        L       R2,RGSTOR+4,,   :RESTORE R2
   798	0101F0	D500 0098 	        UPSW    TRBOFF          :TRACE BIT OFF AND CONTINUE
   799	0101F4	D301 FFC2 	FAIL0   LB      R0,CRSHCD,R1    :CONVERT CRASH REASON
   800	0101F8	C500 0012 		CLHI	R0,12		:TEST IF ILLEGAL SVC
   801	0101FC	2135 			JNFS	FAIL1		:NO...SKIP
   802	0101FE	7300 0094 		LHL	R0,FGNDFL	:DID FOREGROUND CAUSE THE CRASH?
   803	010202	4230 80EE 		JN	ENTRY2		:YES....JUMP OVER
   804	010206	D000 4000 0054 	FAIL1   STM     R0,RGSTOR,,     :SAVE REGISTERS
   805	01020C	4120 819A 	        JAL     R2,PSHTBS       :PUSH DOWN CRASH TABLES
   806	010210	5810 400F 000C 	        L       R1,GMT,,        :GET GMT CLOCK
   807	010216	5010 4000 0000 	        ST      R1,CTIME,,      :SAVE IT AS THE CRASH TIME
   808	01021C	D100 4000 0054 	        LM      R0,RGSTOR,,     :RESTORE REGISTERS
   809	010222	D020 4000 0018 	        STM     R2,CRAT+CRXREG+8,, :SAVE THE REGISTERS
   810	010228	4000 4000 0006 	        STH     R0,CRAT+CRASHC,,  :SAVE CRASH CODE
   811	01022E	D1C0 FF92 	        LM      R12,FAIL          :GET THE REST
   812	010232	D0E0 4000 0010 	        STM     R14,CRAT+CRXREG,,  :SAVE R0 & R1
   813	010238	50D0 4000 0008 	        ST      R13,CRAT+CPOINT,, :SAVE FAILURE ADDRESS
   814	01023E	2511 			LCS	R1,1
   815	010240	5010 4000 000C 	        ST      R1,CRAT+CFROM,,   :FLUSH PLACE CALLED FROM
   816	010246	4300 8074 	        J       ENTRY1            :AND SKIP TO START UP AGAIN
   817				
   818				
   819				
   820				:	CRASH ROUTINE AND GENERAL INITIALIZER
   821				:	IF "GOOD" CALL TO CRASH, HAS HALFWORD 0'S FOLLOWING,
   822				:	THEN BYTE WITH 4*LINK REGISTER, THEN BYTE WITH CRASH REASON
   823				
   824	01024A	5000 4000 0054 	CRASH   ST      R0,RGSTOR,,     :SAVE R0
   825	010250	5020 4000 0058 	        ST      R2,RGSTOR+4,,   :SAVE R2         
   826	010256	4120 8120 	        JAL     R2,SAVPSW       :SAVE CURRENT PSW
   827	01025A	5800 4000 0054 	        L       R0,RGSTOR,,     :RESTORE R0
   828	010260	5820 4000 0058 	        L       R2,RGSTOR+4,,   :RESTORE R2
   829	010266	D500 00A0 	        UPSW    TRCOFF          :TRACE BIT OFF AND CONTINUE
   830	01026A	D000 4000 0054 	CRASH0  STM     R0,RGSTOR,,     :SAVE REGISTERS
   831	010270	4120 8136 	        JAL     R2,PSHTBS       :PUSH DOWN THE CRASH TABLES
   832	010274	5810 400F 000C 	        L       R1,GMT,,        :GET GMT CLOCK
   833	01027A	5010 4000 0000 	        ST      R1,CTIME,,      :SAVE IT AS THE CRASH TIME
   834	010280	D100 4000 0054 	        LM      R0,RGSTOR,,     :RESTORE REGISTERS
   835	010286	D000 4000 0010 	        STM     R0,CRAT+CRXREG,, :SAVE REGISTERS AND
   836	01028C	50A0 4000 0008 	        ST      R10,CRAT+CPOINT,,                    
Page  4-5	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)CRASH.LIB	 ISIS STARTUP AND CRASH LIBRARY	- CRASH.LIB

   837	010292	240A 			LIS	R0,$A10		:FAKE UNKNOWN CRASH
   838	010294	2511 			LCS	R1,1		:FROM NOWHERE
   839	010296	732A 0000 		LHL	R2,0,R10	:CHECK WHERE CALLED FROM
   840	01029A	2137 			JNFS	CRASH1		:NOT KNOWN...USE DEFAULT
   841	01029C	D30A 0003 		LB	R0,3,R10	:GET CRASH CONDITION
   842	0102A0	D32A 0002 		LB	R2,2,R10	:GET CALLING REGISTER
   843	0102A4	5812 0010 	        L       R1,CRAT+CRXREG,R2 :GET CONTENTS OF REGISTER
   844				        
   845	0102A8	4000 4000 0006 	CRASH1  STH     R0,CRAT+CRASHC,, :SAVE CRASH CODE
   846	0102AE	5010 4000 000C 	        ST      R1,CRAT+CFROM,,  :SAVE PLACE CRASHED FROM
   847	0102B4	2305 			JFS	ENTRY1
   848				
   849				:	ENTER HERE WITH RESTART
   850	0102B6	2401 		ENTRY	LIS	R0,1		:LOAD CRASH CODE REGISTER
   851	0102B8	4000 4000 0006 	        STH     R0,CRAT+CRASHC,, :STORE IT
   852	0102BE	2411 		ENTRY1	LIS	R1,1
   853	0102C0	6110 4000 0004 	        AHM     R1,CRAT+CRSHCT,, :SAVE INTERESTING DATA
   854				
   855	000001			  IF	CRSTOP		:IF STOPPING ON CONSECUTIVE CRASHES
   856	0102C6	C500 0001 		CLHI	R0,1
   857	0102CA	4320 8026 		JLE	ENTRY2		:IF POWER FAILURE OR MANUAL RESTART
   858	0102CE	C600 CC00 		OHI	R0,0CC00	:CRASH INDICATOR FOR FRONT PANEL
   859	0102D2	4000 4000 0003 		STH	R0,FPANEL,,	:SET PANEL TO BAD CRASH
   860	000000			   IF	EXCRSH
   861					JAL	R5,CRSH.P,,	:GO DO EXTENDED CRASH PROCESSING
   862				   EI	EXCRSH
   863	0102D8	D100 4000 0010 	        LM      R0,CRAT+CRXREG,, :RESTORE REGISTERS
   864	0102DE	E120 0020 		SVC	SYS,HALT.	:HALT THE SLOT
   865				  EI	CRSTOP
   866				
   867	0102E2	2401 			LIS	R0,1		:WANT SECOND WORD OF PSD
   868	0102E4	E120 000D 		SVC	SYS,RFPSD.	:READ FOREGROUND PSD
   869	0102E8	F500 0001 02E8 		CLI	R0,.		:TEST IF FOREGROUND IS EXECUTING THIS INSTRUCTION
   870	0102EE	2133 			JNFS	ENTRY2		:SKIP IF NOT
   871	0102F0	4000 0094 		STH	R0,FGNDFL	:SET THE FOREGROUND FLAG
   872				
   873				ENTRY2		: NOW RESET OUTPUT RING, REPORT CRASH
   874	000001			  IF	CRSTOP
   875	000000			  ELSE
   876				   IF	EXCRSH
   877					JAL	R5,CRSH.P,,	:GO DO EXTENDED CRASH PROCESSING
   878				   EI	EXCRSH
   879				  EI	CRSTOP
   880	0102F4	2400 			LIS	R0,0
   881	0102F6	5000 4002 0000 		ST	R0,ORING,,	:EMPTY OUTPUT RING
   882	0102FC	5000 4002 2000 		ST	R0,IRING,,	:EMPTY INPUT RING
   883				
   884	010302	E600 FEBE 		LA	R0,FAIL		:LOAD TRAP AREA ADDRESS
   885	010306	E120 0000 		SVC	SYS,RSTRT.	:RESTART SVC
   886	01030A	41A0 FF3C 		JAL	R10,CRASH	:NON-SKIP RETURN...CRASH
   887				
   888				
   889	01030E	2400 			LIS	R0,0
Page  4-6	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)CRASH.LIB	 ISIS STARTUP AND CRASH LIBRARY	- CRASH.LIB

   890	010310	4000 0094 		STH	R0,FGNDFL	:CLEAR THE FOREGROUND FLAG
   891				
   892	010314	4140 4001 00CE 		JAL	R4,SPACE,,	:SET UP FOR DIAGNOSTIC
   893	01031A	C800 0300 		LHI	R0,0300
   894	01031E	4140 4001 0174 		JAL	R4,PUTW,,	:PORT 0 + DIAGNOSTIC MESSAGE + PAD
   895	010324	7300 4000 0004 		LHL	R0,CRAT+CRSHCT,,
   896	01032A	4140 4001 0154 		JAL	R4,PUTCH,,	:HW4 LOW = CRASH COUNT
   897	010330	2400 			LIS	R0,0
   898	010332	4140 4001 0154 		JAL	R4,PUTCH,,	:RESERVED BYTE
   899	010338	2401 			LIS	R0,1
   900	01033A	4140 4001 0154 		JAL	R4,PUTCH,,	:REPORT TYPE = 1
   901	010340	7300 4000 0006 		LHL	R0,CRAT+CRASHC,,
   902	010346	4140 4001 0154 		JAL	R4,PUTCH,,	:HW3 HIGH = CRASH CODE
   903	01034C	C800 0099 		LHI	R0,PRODID
   904	010350	4140 4001 0154 		JAL	R4,PUTCH,,	:HW2 LOW IS PRODUCT ID
   905	010356	4140 4001 01A2 		JAL	R4,ELOR,,	:END LOGICAL OUTPUT RECORD
   906	01035C	5810 4000 00B0 	        L       R1,CHFLAG,,     :SEE IF PSW HAS BEEN CHANGED
   907	010362	C510 0001 	        CLHI    R1,1
   908	010366	2137 		        JNFS    CURPSW          :NO CHANGE, GO TO USE CURRENT PSW
   909	010368	2410 		        LIS     R1,0
   910	01036A	5010 4000 00B0 	        ST      R1,CHFLAG,,     :RESET CHFLAG FOR FUTURE PSW CHANGE
   911	010370	D500 00A8 	        UPSW    PSWSAV          :INITIALIZE WITH RESTORED PSW
   912	010374	4300 4000 08D3 	CURPSW  J       START,,         :INITIALIZE WITH CURRENT PSW
   913				
   914	01037A	2401 		SAVPSW  LIS     R0,1            :GET PC OF BACKGROUND PSD
   915	01037C	5000 4000 00B0 	        ST      R0,CHFLAG,,     :ALSO INDICATE PSW WILL BE MODIFIED
   916	010382	E120 000B 	        SVC     SYS,RBPSD.      :READ BACKGROUND PSD
   917	010386	F500 0001 0386 	        CLI     R0,.            :IS IT RUNNING?
   918	01038C	2138 		        JNFS    ISFGND          :NO, IT MUST BE FOREGROUND JOB
   919	01038E	2400 		        LIS     R0,0            :GET PSW OF BACKGROUND JOB
   920	010390	E120 000B 	        SVC     SYS,RBPSD.
   921	010394	5000 4000 00A8 	        ST      R0,PSWSAV,,     :SAVE IT
   922	01039A	0302 		        JR      R2              :RETURN
   923	01039C	2400 		ISFGND  LIS     R0,0            :GET PSW OF FORGROUND JOB
   924	01039E	E120 000D 	        SVC     SYS,RFPSD.
   925	0103A2	5000 4000 00A8 	        ST      R0,PSWSAV,,     :SAVE IT
   926	0103A8	0302 		        JR      R2              :RETURN
   927				
   928				
   929	0103AA	C810 FFB0 	PSHTBS  LHI     R1,CRTLEN*NCRSAV-CRTLEN*2
   930	0103AE	0212 		        JLR     R2              :IF ONLY 1 CRASH TABLE, SKIP AND RETURN
   931	0103B0	D161 0004 	PUSHIT  LM      R6,CRAT,R1      :PUSH DOWN THE CRASH TABLE
   932	0103B4	D061 0054 	        STM     R6,CRAT+CRTLEN,R1
   933	0103B8	D161 002C 	        LM      R6,CRAT+CRTLEN/2,R1
   934	0103BC	D061 007C 	        STM     R6,CRAT+CRTLEN+CRTLEN/2,R1
   935	0103C0	CB10 0050 	        SHI     R1,CRTLEN
   936	0103C4	221A 		        JGEBS   PUSHIT
   937	0103C6	5810 4000 0000 	        L       R1,CTIME,,
   938	0103CC	5010 4000 0050 	        ST      R1,CRAT+CRTSIZ,,
   939	0103D2	0302 		        JR      R2              :RETURN
   940				         
   941					EM
   942				Page  4-7	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)CRASH.LIB	 ISIS STARTUP AND CRASH LIBRARY	- CRASH.LIB

   943				
Page  5-1	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)CONVRT.LIB	 Data Conversion Routines	- CONVRT.LIB

   944					SUBTTL	Data Conversion Routines	- CONVRT.LIB
   945				:******************************************************************
   946				:
   947				:	This program is the sole property and confidential
   948				:	information of Tymshare, Inc., and may not be copied
   949				:	in whole or in part or disclosed to any third party
   950				:	without the prior written consent of Tymshare.
   951				:
   952				:*******************************************************************
   953				:
   954					RA	0
   955				:
   956					MO	.,CONVRT
   957				:
   958					GL	BINDEC,BINHEX
   959				:
   960				:*****************************************************************
   961				:
   962				:	BINDEC IS A ROUTINE TO CONVERT INTERNAL BINARY REPRESENTATION OF
   963				:	DATA TO ASCII DECIMAL CHARACTERS.
   964				:
   965				:	ARGUMENTS: R9 CONTAINS THE BINARY NUMBER
   966				:	           R10 CONTAINS NUMBER OF DIGITS OF OUTPUT
   967				:	           R11 POINTS TO OUTPUT AREA
   968				:	LINK ON R4
   969				:
   970				:****************************************************************
   971				:
   972	0000B4				SEG	A.DATA
   973				:
   974	0000B4			RSAVE	HS	10	:REGISTER SAVE AREA
   975				:
   976	0103D4				SEG	A.CODE
   977				:
   978	0103D4	B0B1 B2B3 B4B5 	DIGIT	AC	/0123456789ABCDEF/
		B6B7 B8B9 C1C2 	
		C3C4 C5C6 	
   979				:
   980				:	FIRST CHECK FOR A NEGATIVE NUMBER
   981				:		IF FOUND, PUT A LEADING '-' (MINUS SIGN) IN FIELD
   982	0103E4	D080 00B4 	BINDEC	STM	R8,RSAVE	:PRESERVE REGISTERS
   983	0103E8	0899 			LR	R9,R9		: TEST FOR NEGATIVE NUMBER
   984	0103EA	231D 			JGEFS	NOTNEG		:JUMP IF NOT NEGATIVE
   985	0103EC	C8C0 00AD 		LHI	R12,$0 00AD	:'ASCII '-'
   986	0103F0	D2CB 0000 		STB	R12,0,R11
   987	0103F4	27A1 			SIS	R10,1		: ROOM FOR ONE LESS DIGIT
   988	0103F6	26B1 			AIS	R11,1		: DITTO
   989	0103F8	4320 801E 		JLE	RTRN		:NO ROOM FOR DIGIT AFTER MINUS SINE
   990				:	COMPLEMENT THE NUMBER TO POSITIVE
   991	0103FC	F790 FFFF FFFF 		XI	R9,-1
   992	010402	2691 			AIS	R9,1
   993	010404	27B1 		NOTNEG	SIS	R11,1
   994	010406	24CA 			LIS	R12,$A 10	: DIVISOR
Page  5-2	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)CONVRT.LIB	 Data Conversion Routines	- CONVRT.LIB

   995	010408	0B88 		DIVIDE	SR	R8,R8		: CLEAR HI ORDER BITS OF DIVIDEND
   996	01040A	1D8C 			DR	R8,R12		:GET LOW DIGIT IN R9
   997	01040C	D3D8 FFC4 		LB	R13,DIGIT,R8	:GET ASCII EQUIVALENT OF DEC NUMBER
   998	010410	D2DA 4B00 0000 		STB	R13,0,R10,R11	:STORE IN REVERSE ORDER
   999	010416	27A1 			SIS	R10,1		:DECREMENT COUNTER
  1000	010418	2028 			JGBS	DIVIDE		: KEEP LOOPING
  1001	01041A	D180 00B4 	RTRN	LM	R8,RSAVE	:RESTORE THE REGISTERS
  1002	01041E	0304 			JR	R4		:AND RETURN
  1003				:
  1004				:******************************************************************
  1005				:
  1006				:	BINHEX IS A ROUTINE TO CONVERT INTERNAL BINARY REPRESENTATION OF
  1007				:	DATA TO ASCII HEX CHARACTERS. A SPACE CHARACTER IS APPENDED ON THE
  1008				:	END OF THE HEX CHARACTER STRING.
  1009				:	ARGUMENTS: R8 - ADDRESS OF WHERE TO PUT ASCII CHARACTERS
  1010				:			   THIS REGISTER IS RETURNED UPDATED TO NEXT AVAIL
  1011				:				LOCATION
  1012				:	           R9 - BYTE COUNT
  1013				:		   R10 - START ADDRESS OF MEMORY TO BE PROCESSED
  1014				:	LINKS R4
  1015				:
  1016				:******************************************************************
  1017	010420	D090 00B4 	BINHEX	STM	R9,RSAVE	:PRESERVE REGISTERS
  1018	010424	D3BA 0000 	LOOP	LB	R11,0,R10	:LOAD BYTE
  1019	010428	93CB 			LBR	R12,R11		:COPY THE BYTE
  1020	01042A	90C4 			SRHLS	R12,4		:GET FIRST DIGIT
  1021	01042C	D3DC FFA4 		LB	R13,DIGIT,R12	:GET ASCII CHARACTER
  1022	010430	D2D8 0000 		STB	R13,0,R8	:STORE THE CHARACTER
  1023	010434	24CF 			LIS	R12,0F		:LOAD MASK
  1024	010436	04CB 			NR	R12,R11		:MASK OFF HIGH DIGIT
  1025	010438	D3DC FF98 		LB	R13,DIGIT,R12	:GET ASCII CHAR
  1026	01043C	D2D8 0001 		STB	R13,1,R8	:STORE THE CHARACTER
  1027	010440	2791 			SIS	R9,1		:DECREMENT LOOP COUNT
  1028	010442	2129 			JGFS	REPEAT		:MORE TO DO?
  1029	010444	C8D0 00A0 		LHI	R13,$0 0A0	:LOAD SPACE CHARACTER
  1030	010448	D2D8 0002 		STB	R13,2,R8	:STORE IT
  1031	01044C	2683 			AIS	R8,3		:INCREMENT STRING POINTER
  1032	01044E	D190 00B4 		LM	R9,RSAVE	:RESTORE THE REGISTERS
  1033	010452	0304 			JR	R4		:AND RETURN
  1034				:
  1035	010454	2682 		REPEAT	AIS	R8,2		:INCREMENT STRING POINTER
  1036	010456	26A1 			AIS	R10,1		:INCREMENT BYTE ADDRESS
  1037	010458	4300 FFC8 		J	LOOP		:REPEAT
  1038				
  1039					EM
  1040				:
Page  6-1	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)DATIME.LIB	 GMT Clock Conversion Routines	- DATIME.LIB

  1041					SUBTTL	GMT Clock Conversion Routines	- DATIME.LIB
  1042				:******************************************************************
  1043				:
  1044				:	This program is the sole property and confidential
  1045				:	information of Tymshare, Inc., and may not be copied
  1046				:	in whole or in part or disclosed to any third party
  1047				:	without the prior written consent of Tymshare.
  1048				:
  1049				:*******************************************************************
  1050				:
  1051					RA	$0 0A
  1052				:
  1053					MO	.,DATIME
  1054				:
  1055					GL	DATIME,TMSTMP,DATE
  1056				:
  1057				:***************************************************************
  1058				:
  1059				:	THIS PROCEDURE CONVERTS THE GMT CLOCK
  1060				:	RELATIVE TO 1/1/74 FROM SECONDS TO
  1061				:	DDMMMYY HH:MM (GMT) OR
  1062				:	DDMMMYY HH:MM:SS (GMT)
  1063				:
  1064				:	PARMS
  1065				:		R3 = # OF SECONDS SINCE 1/1/74 (BEYOND1/1/76)
  1066				:		R4 = CHARACTERS OF OUTPUT (13 OR 16)
  1067				:		R5 = ADDRESS OF OUTPUT STRING
  1068				:		R6 = LINK REGISTER
  1069				:	ALL REGISTERS ARE PRESERVED
  1070				:
  1071				:**************************************************************
  1072				:
  1073	0000D4				SEG	A.DATA
  1074				:
  1075	0000D4			RSAVE	HS	$020	:REGISTER SAVE AREA
  1076				:
  1077	01045C				SEG	A.CODE
  1078	01045C	D000 00D4 	DATIME	STM	R0,RSAVE	:PRESERVE THE REGISTERS
  1079	010460	5B30 81B0 		S	R3,SEC745	
  1080				:	MAKE TIME RELATIVE TO 1/1/76 - THE START OF
  1081				:	A 'QUAD-YEAR'.  'QUAD-YEAR' = 1 LEAP
  1082				:	YEAR + 3 REGULAR YEARS.  THERE ARE
  1083				:	24 QUADS PLUS 4 REG YEARS IN A CENTURY
  1084				:
  1085	010464	0B22 			SR	R2,R2		: CLEAR HI ORDER BYTES
  1086	010466	5D20 819A 		D	R2,SECDAY	:QUOTIENT IS # OF DAYS
  1087				:				:REMAINDER IS TIME
  1088	01046A	08E2 			LR	R14,R2		:COPY TIME OF DAY
  1089	01046C	0B22 			SR	R2,R2		:CLEAR HI ORDER BYTES
  1090	01046E	5D20 81AE 		D	R2,QUADAY	:DIVIDE BY DAYS IN A QUAD
  1091				:
  1092				:	QUOTIENT(R3) IS NUMB. OF QUAD YEARS
  1093				:	REMAINDER(R2) IS # OF DAYS INTO QUAD-YEAR
Page  6-2	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)DATIME.LIB	 GMT Clock Conversion Routines	- DATIME.LIB

  1094				:
  1095	010472	C880 004C 		LHI	R8,76		:BASE YEAR
  1096	010476	1132 			SLLS	R3,2		:QUAD YEAR * 4
  1097	010478	0A83 			AR	R8,R3		:ADD TO BASE YEAR
  1098	01047A	E670 81A6 		LA	R7,LEPYEA	:POINT TO DAYS IN MONTH
  1099	01047E	5920 819A 		C	R2,W366		:IS IT IN CURRENT YEAR?
  1100	010482	4210 8018 		JL	MONTHD		:JUMP IF SO
  1101	010486	5B20 8192 		S	R2,W366		:SUBTRACT DAYS IN YEAR
  1102	01048A	2681 			AIS	R8,1		:ADD 1 TO YEAR
  1103	01048C	08B2 			LR	R11,R2		:GET REMAIN DAYS IN QUAD
  1104	01048E	0BAA 			SR	R10,R10
  1105	010490	5DA0 8184 		D	R10,W365	:AND DIVIDE BY REGYEAR
  1106				:	R11 HAS ADDTL YEARS
  1107				:	R10 HAS DAYS IN YEAR
  1108	010494	082A 			LR	R2,10
  1109	010496	0A8B 			AR	R8,R11
  1110	010498	F870 0001 0630 		LI	R7,REGYER	:POINT TO DAYS IN MONTHS
  1111				:
  1112				:	DAYS IN R2
  1113				:	YEAR IN R8
  1114	01049E	0B66 		MONTHD	SR	R6,R6		:MONTH COUNTER
  1115	0104A0	2621 			AIS	R2,1		:MAKE 1/1/76 = DAY 1
  1116	0104A2	0892 		MONLOP	LR	R9,R2		:SAVE DAYS
  1117	0104A4	D336 4700 0000 		LB	R3,0,R6,R7	:GET DAYS IN MONTH
  1118	0104AA	0B23 			SR	R2,R3		:AND SUBTRACT FROM DAYS IN YEAR
  1119	0104AC	2323 			JLEFS	DAZE		:IF MINUS OR ZERO WE'RE IN THE MONTH
  1120	0104AE	2661 			AIS	R6,1		:INCREMENT INDEX
  1121	0104B0	2207 			JBS	MONLOP
  1122				:
  1123				:	DAYS IN R3
  1124				:	MONTH NUMBER - 1 IN R6
  1125				:	YEAR IN R8
  1126				:
  1127				:	SAVE R4 AND R5
  1128	0104B2	2748 		DAZE	SIS	R4,8		:SUBTRACT OUT DATE LENGTH
  1129	0104B4	08D4 			LR	R13,R4		:PRESERVE IT
  1130	0104B6	08B5 			LR	R11,R5		:COPY OUPUT AREA POINTER
  1131				:
  1132				:	CONVERT DAY
  1133	0104B8	24A2 			LIS	R10,2		:# OF OUTPUT CHARACTERS
  1134	0104BA	4140 FF26 		JAL	R4,BINDEC	:CONVERT TO DECIMAL ASCII
  1135				:
  1136				:	MOVE IN MONTH
  1137	0104BE	26B2 			AIS	R11,2
  1138	0104C0	9162 			SLHLS	R6,2		:MULTIPLY MONTH NUMBER BY 4
  1139	0104C2	5846 8176 		L	R4,MONTHS,R6	:GET THE NAME IN R4
  1140	0104C6	D24B 0002 		STB	R4,2,R11
  1141	0104CA	1048 			SRLS	R4,8
  1142	0104CC	D24B 0001 		STB	R4,1,R11
  1143	0104D0	1048 			SRLS	R4,8
  1144	0104D2	D24B 0000 		STB	R4,0,R11
  1145	0104D6	26B3 			AIS	R11,3
  1146				:
Page  6-3	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)DATIME.LIB	 GMT Clock Conversion Routines	- DATIME.LIB

  1147				:	CONVERT YEAR
  1148	0104D8	0898 			LR	R9,R8
  1149	0104DA	24A2 			LIS	R10,2
  1150	0104DC	4140 FF04 		JAL	R4,BINDEC	:CONVERT TO CHARACTERS
  1151	0104E0	C830 00A0 		LHI	R3,$00A0	:ASCII SPACE
  1152	0104E4	D23B 0002 		STB	R3,2,R11	:PUT IT AFTER DATE
  1153	0104E8	C85B 0003 		LHI	R5,3,R11	:SET UP OUTPUT POINTER
  1154	0104EC	084D 			LR	R4,R13		:COPY LENGTH ARGUEMENT
  1155	0104EE	083E 			LR	R3,R14		:COPY TIME OF DAY
  1156	0104F0	2303 			JFS	TIME1		:JUMP
  1157				:*************************************************************
  1158				:
  1159				:	GET THE TIME STAMP
  1160				:
  1161				:	TIME STAMP ROUTINE
  1162				:		THIS ROUTINE CONVERTS THE FULLWORD GMT TIME OF DAY
  1163				:	TO HH:MM OR HH:MM:SS
  1164				:
  1165				:	PARAMETERS:
  1166				:		R3 = FULLWORD TIME OF DAY (GMT CLOCK)
  1167				:		R4 = 5 OR 8 (# OF CHARACTERS TO OUTPUT)
  1168				:		R5 = FULLWORD ADDRESS OF OUTPUT
  1169				:		R6 = LINK REGISTER
  1170				:
  1171				:	DIVIDE TIME BY SECONDS PER DAY.  THE REMAINDER
  1172				:	IS THE SECONDS IN THIS DAY, WHICH IS WHAT THIS
  1173				:	ROUTINE IS ALL ABOUT
  1174				:
  1175				:****************************************************************
  1176	0104F2	D000 00D4 	TMSTMP	STM	R0,RSAVE	:PRESERVE THE REGISTERS
  1177	000000			  IF \TIMZON
  1178					AHI	R3,TIMZON*$A3600	:TIME ZONE CONVERSION
  1179				  EI
  1180	0104F6	0B88 		TIME1	SR	R8,R8		:INDEX FOR OUTPUT AREA
  1181				:
  1182	0104F8	0B22 			SR	R2,R2		:CLEAR HI-ORDER BITS
  1183	0104FA	5D20 8106 		D	R2,SECDAY
  1184				:		SECONDS NOW IN R2
  1185	0104FE	0832 			LR	R3,R2		:GET READY FOR
  1186	010500	0B22 			SR	R2,R2		:ANOTHER DIVIDE
  1187	010502	5D20 8102 		D	R2,TENOUR	:GET TENS OF HOURS
  1188	010506	4160 8040 		JAL	R6,ASCOUT	:PRINT IT OUT IN ASCII
  1189	01050A	4D20 80FE 		DH	R2,OURS		:GET HOURS
  1190				:		R2 HAS REMAINDER, R3 HAS QUOTIENT
  1191	01050E	4160 8038 		JAL	R6,ASCOUT	:PRINT IT OUT
  1192	010512	C830 00BA 		LHI	R3,$00BA	:COLON
  1193	010516	4160 8034 		JAL	R6,PRTOUT
  1194	01051A	4D20 80F0 		DH	R2,TENMIN
  1195	01051E	4160 8028 		JAL	R6,ASCOUT
  1196	010522	4D20 80EA 		DH	R2,MIN
  1197	010526	4160 8020 		JAL	R6,ASCOUT
  1198				:	THE CONDITION CODE HAS BEEN SET -
  1199				:	SET IF ANY MORE CHARACTER WANTED
Page  6-4	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)DATIME.LIB	 GMT Clock Conversion Routines	- DATIME.LIB

  1200	01052A	4330 8016 		JE	RETRN		:JUMP IF ONLY 5 CHAR
  1201				:
  1202				:	PUT IN COLON BEFORE SECONDS
  1203	01052E	C830 00BA 		LHI	R3,$00BA
  1204	010532	4160 8018 		JAL	R6,PRTOUT
  1205	010536	4D20 80D8 		DH	R2,TENSEC
  1206	01053A	4160 800C 		JAL	R6,ASCOUT
  1207	01053E	0832 			LR	R3,R2		:GET SECONDS IN R3
  1208	010540	4160 8006 		JAL	R6,ASCOUT
  1209	010544	D100 00D4 	RETRN	LM	R0,RSAVE	:RESTORE THE REGISTERS
  1210	010548	0306 			JR	R6		:RETURN
  1211				:
  1212				:
  1213	01054A	CA30 00B0 	ASCOUT	AHI	R3,$00B0
  1214	01054E	D238 4500 0000 	PRTOUT	STB	R3,0,R8,R5
  1215	010554	2681 			AIS	R8,1	: UPDATE INDEX
  1216	010556	2741 			SIS	R4,1
  1217	010558	0306 			JR	R6
  1218				:
  1219				:****************************************************************
  1220				:
  1221				:	THIS ROUTINE RETURNS A FULLWORD REPRESENTATION OF THE DATE
  1222				:	AND TIME. THE FORMAT OF THE RESULT IS MMDDHHMM WHERE
  1223				:	MM, DD, HH, & MM REPRESENT MONTH, DAY, HOUR, & MINUTES RESPECTIVELY
  1224				:	ALL IN DECIMAL FORMAT. I.E. DEC 12 13:41 WOULD BE 12121341.
  1225				:
  1226				:	IF THE SYMBOL TIMEZON IS DEFINED IT SHOULD BE THE TIME-ZONE
  1227				:	CORRECTION FACTOR FROM CUT (COORDINATED UNIVERSAL TIME)
  1228				:	I.E. PST IS -8.
  1229				:
  1230				:	PARMS
  1231				:		R3 = GMT CLOCK VALUE
  1232				:		R6 = RESULT FULLWORD
  1233				:
  1234				:	LINKS R5
  1235				:
  1236				:	PRESERVES REGISTERS R7 - R15
  1237				:
  1238				:******************************************************************
  1239	01055A	D070 00D4 	DATE	STM	R7,RSAVE	:PRESERVE THE REGISTERS
  1240	01055E	5B30 80B2 		S	R3,SEC745
  1241				:	MAKE TIME RELATIVE TO 1/1/76 - THE START OF
  1242				:	A 'QUAD-YEAR'.  'QUAD-YEAR' = 1 LEAP
  1243				:	YEAR + 3 REGULAR YEARS.  THERE ARE
  1244				:	24 QUADS PLUS 4 REG YEARS IN A CENTURY
  1245				:
  1246	010562	0B22 			SR	R2,R2		: CLEAR HI ORDER BYTES
  1247	010564	5D20 809C 		D	R2,SECDAY	:QUOTIENT IS # OF DAYS
  1248				:				:REMAINDER IS TIME
  1249	010568	08E2 			LR	R14,R2		:COPY TIME OF DAY
  1250	01056A	0B22 			SR	R2,R2		:CLEAR HI ORDER BYTES
  1251	01056C	5D20 80B0 		D	R2,QUADAY	:DIVIDE BY DAYS IN A QUAD
  1252				:
Page  6-5	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)DATIME.LIB	 GMT Clock Conversion Routines	- DATIME.LIB

  1253				:	QUOTIENT(R3) IS NUMB. OF QUAD YEARS
  1254				:	REMAINDER(R2) IS # OF DAYS INTO QUAD-YEAR
  1255				:
  1256	010570	C880 004C 		LHI	R8,76		:BASE YEAR
  1257	010574	1132 			SLLS	R3,2		:QUAD YEAR * 4
  1258	010576	0A83 			AR	R8,R3		:ADD TO BASE YEAR
  1259	010578	E670 80A8 		LA	R7,LEPYEA	:POINT TO DAYS IN MONTH
  1260	01057C	5920 809C 		C	R2,W366		:IS IT IN CURRENT YEAR?
  1261	010580	4210 8018 		JL	MNTHD		:JUMP IF SO
  1262	010584	5B20 8094 		S	R2,W366		:SUBTRACT DAYS IN YEAR
  1263	010588	2681 			AIS	R8,1		:ADD 1 TO YEAR
  1264	01058A	08B2 			LR	R11,R2		:GET REMAIN DAYS IN QUAD
  1265	01058C	0BAA 			SR	R10,R10
  1266	01058E	5DA0 8086 		D	R10,W365	:AND DIVIDE BY REGYEAR
  1267				:	R11 HAS ADDTL YEARS
  1268				:	R10 HAS DAYS IN YEAR
  1269	010592	082A 			LR	R2,10
  1270	010594	0A8B 			AR	R8,R11
  1271	010596	F870 0001 0630 		LI	R7,REGYER	:POINT TO DAYS IN MONTHS
  1272				:
  1273				:	DAYS IN R2
  1274				:	YEAR IN R8
  1275	01059C	0B66 		MNTHD	SR	R6,R6		:MONTH COUNTER
  1276	01059E	2621 			AIS	R2,1		:MAKE 1/1/76 = DAY 1
  1277	0105A0	0892 		MLOOP	LR	R9,R2		:SAVE DAYS
  1278	0105A2	D336 4700 0000 		LB	R3,0,R6,R7	:GET DAYS IN MONTH
  1279	0105A8	0B23 			SR	R2,R3		:AND SUBTRACT FROM DAYS IN YEAR
  1280	0105AA	2323 			JLEFS	DAZE1		:IF MINUS OR ZERO WE'RE IN THE MONTH
  1281	0105AC	2661 			AIS	R6,1		:INCREMENT INDEX
  1282	0105AE	2207 			JBS	MLOOP
  1283				:
  1284				:	DAYS IN R9
  1285				:	MONTH NUMBER - 1 IN R6
  1286				:	YEAR IN R8
  1287				:
  1288	0105B0	2661 		DAZE1	AIS	R6,1		:CONVERT TO MONTH NUMBER
  1289	0105B2	D366 802C 		LB	R6,DECMAL,R6	:CONVERT TO DECIMAL REPRESENTATION
  1290	0105B6	1168 			SLLS	R6,8		:MOVE IT OVER
  1291	0105B8	D399 8026 		LB	R9,DECMAL,R9	:CONVERT DAY TO DECIMAL
  1292	0105BC	0669 			OR	R6,R9		:OR IT IN
  1293	0105BE	1168 			SLLS	R6,8		:SHIFT IT OVER
  1294	0105C0	082E 			LR	R2,R14		:COPY SECONDS IN THE DAY
  1295	0105C2	4D20 8046 		DH	R2,OURS		:R3 HAS NUMBER OF HOURS
  1296	0105C6	D333 8018 		LB	R3,DECMAL,R3	:CONVERT TO DECIMAL
  1297	0105CA	0663 			OR	R6,R3		:OR IT IN
  1298	0105CC	1164 			SLLS	R6,4		:SHIFT IT OVER
  1299	0105CE	4D20 803C 		DH	R2,TENMIN	:R3 HAS TENS OF MINUTES
  1300	0105D2	0663 			OR	R6,R3		:OR IT IN
  1301	0105D4	1164 			SLLS	R6,4		:SHIFT IT OVER
  1302	0105D6	4D20 8036 		DH	R2,MIN		:R3 HAS MINUTES
  1303	0105DA	0663 			OR	R6,R3		:OR IT IN
  1304				:
  1305	0105DC	D170 00D4 		LM	R7,RSAVE	:RESTORE REGISTERS
Page  6-6	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)DATIME.LIB	 GMT Clock Conversion Routines	- DATIME.LIB

  1306	0105E0	0305 			JR	R5		:RETURN
  1307				:
  1308	0105E2	0001 0203 0405 	DECMAL	XC	0001020304050607080910111213141516171819202122232425262728293031
		0607 0809 1011 	
		1213 1415 1617 	
		1819 2021 2223 	
		2425 2627 2829 	
		3031 		
  1309	010604	0001 5180 	SECDAY	WC	24*60*60	:SECONDS IN A DAY
  1310	010608	0000 8CA0 	TENOUR	WC	10*60*60	:TENS OF HOURS
  1311	01060C	0E10 		OURS	HC	60*60		:HOURS
  1312	01060E	0258 		TENMIN	HC	10*60		:TENS OF MINS
  1313	010610	003C 		MIN	HC	60		:MIN
  1314	010612	000A 		TENSEC	HC	10		:TENS OF SECS
  1315	000000			  IF	\TIMZON
  1316				SEC745	WC	24*60*60*365*2-TIMZON*60*60	:SECONDS IN 74 & 75 PLUS 
  1317										:TIME-ZONE CORRECTION
  1318	000001			  ELSE
  1319	010614	03C2 6700 	SEC745	WC	24*60*60*365*2	:SECONDS IN 74 AND 75
  1320				  EI
  1321	010618	0000 016D 	W365	WC	365
  1322	01061C	0000 016E 	W366	WC	366
  1323	010620	0000 05B5 	QUADAY	WC	4*365+1
  1324	010624	1F1D 1F1E 1F1E 	LEPYEA	BC	31,29,31,30,31,30,31,31,30,31,30,31
		1F1F 1E1F 1E1F 	
  1325	010630	1F1C 1F1E 1F1E 	REGYER	BC	31,28,31,30,31,30,31,31,30,31,30,31
		1F1F 1E1F 1E1F 	
  1326	01063C				WS	0
  1327	01063C	A0CA E1EE 	MONTHS	AC	/ Jan/
  1328	010640	A0C6 E5E2 		AC	/ Feb/
  1329	010644	A0CD E1F2 		AC	/ Mar/
  1330	010648	A0C1 F0F2 		AC	/ Apr/
  1331	01064C	A0CD E1F9 		AC	/ May/
  1332	010650	A0CA F5EE 		AC	/ Jun/
  1333	010654	A0CA F5EC 		AC	/ Jul/
  1334	010658	A0C1 F5E7 		AC	/ Aug/
  1335	01065C	A0D3 E5F0 		AC	/ Sep/
  1336	010660	A0CF E3F4 		AC	/ Oct/
  1337	010664	A0CE EFF6 		AC	/ Nov/
  1338	010668	A0C4 E5E3 		AC	/ Dec/
  1339					EM
  1340				
  1341					RA	0	:RADIX TO HEX
  1342				
Page  7-1	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)BID.LIB		 Library Package for BID and BIDH	- BID.LIB

  1343					SUBTTL	Library Package for BID and BIDH	- BID.LIB
  1344				:******************************************************************
  1345				:
  1346				:	This program is the sole property and confidential
  1347				:	information of Tymshare, Inc., and may not be copied
  1348				:	in whole or in part or disclosed to any third party
  1349				:	without the prior written consent of Tymshare.
  1350				:
  1351				:*******************************************************************
  1352					RA	0		:	BID.LIB
  1353				:	Library package for BID, BIDH
  1354				
  1355				:	either routine called with bit pattern in R1, link on R3
  1356				:	returns number of a non-zero bit in R2
  1357					GL	BID,BIDH
  1358	01066C				SEG	A.CODE		:PLACE IN CODE AREA
  1359					MO	.,BID
  1360				:
  1361				
  1362				:	HALFWORD Bit identifier
  1363				:	left half of R1 must be zero if bit 16 is zero
  1364				:	returns original word in R1
  1365				:	number of leftmost bit of right half or R1 in R2
  1366	000001			  IF	ENGINE
  1367	01066C	3313 		BIDH	JFFOH	R1,BIDH1	:FIND FIRST NON-ZERO BIT
  1368	01066E	C820 0010 		LHI	R2,10	:RETURN 10 IF NO BIT IS FOUND
  1369	010672	0303 		BIDH1	JR	R3	:AND RETURN
  1370	000000			  ELSE
  1371				BIDH1	LB	R2,BIDTAB,R1	:LEFT HALF IS EMPTY
  1372					JR	R3		:GET ID OF FIRST BIT IN RIGHT HALF
  1373				BIDH	THI	R1,0FF00	:TEST IF FIRST BIT IS IN LEFT OR RIGHT BYTE OF HALFWORD
  1374					JEBS	BIDH1		:RIGHT HALF
  1375					EXBR	R2,R1		:LEFT HALF
  1376					LBR	R2,R2		:COPY LEFT BYTE
  1377					LB	R2,BIDTAB,R2	:USE IT TO INDEX INTO ID TABLE
  1378					SIS	R2,8		:ADJUST NUMBER TO CORRESPOND TO LEFT BYTE
  1379					JR	R3		:AND RETURN
  1380				  EI	ENGINE
  1381				
  1382				:	FULLWORD Bit identifier
  1383				:	returns original word in R1
  1384				:	number of leftmost non-zero bit in R2
  1385	000001			  IF	ENGINE
  1386	010674	3113 		BID	JFFO	R1,BID1		:TEST FULLWORD FOR FIRST NON-ZERO BIT
  1387	010676	C820 0020 		LHI	R2,20		:RETURN 20 IF NO BIT FOUND
  1388	01067A	0303 		BID1	JR	R3		:AND RETURN
  1389	000000			  ELSE
  1390				BID1	LB	R2,BIDTAB,R1	:IN BYTE 4
  1391					AHI	R2,10		:GET BIT ID FOR BYTE AND ADJUST FOR BYTE 4
  1392					JR	R3
  1393				BID2	THI	R1,0FF00	:BYTE 1 AND 2 = 0
  1394					JEBS	BID1		:IF BYTE 3 IS 0, LOOK UP BYTE 4
  1395					EXBR	R2,R1		:ELSE COPY OUT BYTE 3
Page  7-2	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)BID.LIB		 Library Package for BID and BIDH	- BID.LIB

  1396					LBR	R2,R2
  1397					LB	R2,BIDTAB,R2	:PICK UP INDEX FOR THAT BYTE
  1398					AIS	R2,8		:ADJUST FOR BYTE 3
  1399					JR	R3
  1400				BID	THI	R1,8000		:TEST IF IN LEFT 17 BITS
  1401					JEBS	BID2		:IF NOT, MUST BE IN BYTE 3 OR 4
  1402					EXHR	R2,R1		:BIT IS IN BYTE 1 OR 2 (OR BIT 16)
  1403					TI	R2,0FF00	:TEST IF BYTE 1
  1404					JEFS	BID3		:SKIP IF NOT
  1405					EXBR	R2,R2		:BIT IS IN BYTE 1, SO COPY BYTE 1
  1406					LBR	R2,R2		:TO USE AS INDEX
  1407					LB	R2,BIDTAB,R2	:LOOK UP ID WITHIN THIS BYTE
  1408					SIS	R2,8		:ADJUST FOR REALLY BEING IN BYTE 1
  1409					JR	R3
  1410				BID3	LBR	R2,R2		:HERE WITH BIT IN BYTE 2 (OR BIT 16)
  1411					LB	R2,BIDTAB,R2	:LOOK UP ID WITHIN THIS BYTE
  1412					JR	R3		:IF FIRST BIT WAS BIT 16, USE ENTRY 0 IN TABLE
  1413				BIDTAB	HS	0		:TABLE OF BIT NUMBERS IN A BYTE, BIASED BY 8
  1414					NOLIST
  1415					XC	100F0E0E0D0D0D0D0C0C0C0C0C0C0C0C0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B
  1416					XC	0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A
  1417					RE	2
  1418					XC	0909090909090909090909090909090909090909090909090909090909090909
  1419					ER
  1420					RE	4
  1421					XC	0808080808080808080808080808080808080808080808080808080808080808
  1422					ER
  1423					LIST
  1424				  EI	ENGINE
  1425					EM
Page  8-1	TRACE COLLE,~      	  P    7    ,>  S"  	br+   @@  ,~   7    ,>      @@  ,~   7    ,>  @@  S"  	b          +    S"   (B  T`  	bo+    ,~   O@  	`                 	  "P      P  i    al	` Vf     9X     A<     A@      A}    	M       	    SW&f    SW,    SW    ^}	`^}-F	`rP       P 1;     h1i	`omun            WP       (                         g  0       g  H     	         7    ,  ,>  ,>  ,>  ,>  ,>   %p  Q$A` 'p Q&A` 	p 
    3J  +   3j     (D  (    +   
    +       +   @    +   ,^  ,^  ,^  ,^  ,^  ,~   =h  +      	    P       P  i    P  O	    P  O    P  T	    P  T    P  U    1a    
aF       "  g     P       K    	K3    
M      (                         AS  0       AS   	 Q"     7    ,>  6@  +       (Z@  X    @  (
&  	b  
&  	b  	`  g    O     @  	+                      (            	,~   please save this core image.     	          }K	`  qxs    AS     u^v
&   P       pW    	pZS    P  Q            r'    (  (                          Y  0        Y    @        7    ,>  
:  +p              Y     _?a
:     (      45498450286061115.129212000326614014040000000000.1592000006800046580004302159ED0000000000.0000VL01081;                 0
45499180286061115.130312000747112001040000000000.1053000002900004620004305978ED0000000000.0000VL05647;                 0
45500010286061115.132512000206616067020000000000.0250000001500003950004305397ED0000000000.0000VL04676;                 0
45500950386061115.134412000362514017020000000000.2142000019400248780004303354CD0000000000.0000VL06070;                 0
45503490286061115.139212000467214014040000000000.0333000002900004120004301981ED0000000000.0000VL00541;                 0
45503920386061115.140312000634212002040000000000.0350000001300004110004301101ED0000000000.0000VL00593;                 0
45504680386061115.141712000376416002040000000000.0417000000800000960004303610ED0000000000.0000VL08945;                 0
45504920386061115.142212000650116012040000000000.0417000001400001560004302346CD0000000000.0000VL06897;                 0
45508180286061115.149212000634212003040000000000.4122000028100215460004301101ED0000000000.0000VL00550;                 0
45508880386061115.150812000342014042020000000000.0794000010700018310004302958ED0000000000.0000VL01095;                 0
45509770286061115.152212000206616017040000000000.04170000058		:number of bytes in list entry
  1475	000118			TLIST	BS	(NTOUT+1)*LSIZ	:timeout list
  1476				:				active list entry = halfword chain pointer
  1477				:				word routine address
  1478				:				word time of next activiation
  1479				
  1480				:		free list pointer is at TLIST
  1481				:		active list chain pointer is at TLIST+2
  1482				:	CODE SEGMENT
  1483	01067C				SEG	A.CODE
  1484				
  1485	01067C	5800 0114 	TORET	L	R0,TO9		:TIMEOUT ROUTINES EXIT HERE
  1486				:	CALL NEXT TIME OUT ROUTINE (IF ANY) THAT HAS BECOME DUE
  1487	010680	7320 011A 	TIMOUT	LHL	R2,TLIST+2	:GET ACTIVE LIST POINTER
  1488	010684	0330 			JER	R0		:EXIT IF NO ACTIVE ENTRIES
  1489	010686	5810 400F 0004 		L	R1,FASTC,,	:GET CURRENT CLOCK TIME
  1490	01068C	5512 011E 		CL	R1,TLIST+6,R2	:IS 1ST ACTIVE LIST TIMEOUT DUE
  1491	010690	0210 			JLR	R0		:NO TIMEOUTS DUE TO PROCESS
  1492	010692	5000 0114 		ST	R0,TO9		:ROUTINE MUST TERMINATE BY JUMPING TO TORET
  1493	010696	7332 0118 		LHL	R3,TLIST,R2
  1494	01069A	4030 011A 		STH	R3,TLIST+2	:SHORTEN ACTIVE LIST
  1495	01069E	7340 0118 		LHL	R4,TLIST
  1496	0106A2	4042 0118 		STH	R4,TLIST,R2	:SPLICE INTO HEAD OF FREE CHAIN
  1497	0106A6	4020 0118 		STH	R2,TLIST
  1498	0106AA	5802 011A 		L	R0,TLIST+2,R2
  1499	0106AE	0300 			JR	R0		:FETCH ADRS AND ENTER TIMED OUT ROUTINE
  1500				
  1501				:	PUT ADRS R0 TO EXECUTE AT TIME R1 ON ACTIVE TIMEOUT LIST. LINK=R5.
  1502	0106B0	2422 		TOPUT	LIS	R2,2		:FIND ACTIVE LIST ENTRY BETWEEN EARLIER, LATER TIMEOUT.
  1503	0106B2	0832 		TPT1	LR	R3,R2
  1504	0106B4	7322 0118 		LHL	R2,TLIST,R2	:CHECK NEXT TIMEOUT ENTRY
  1505	0106B8	2334 			JEFS	TPT2		:ACTIVE LIST IS EMPTY
  1506	0106BA	5512 011E 		CL	R1,TLIST+6,R2	:IS IT EARLIER THAN ARGUMENT DUE TIME
  1507	0106BE	2026 			JGBS	TPT1		:YES, CONTINUE TIL R3 IS EARLIER AND R2 IS EQUAL OR LATE
				**R
  1508	0106C0	7340 0118 	TPT2	LHL	R4,TLIST
  1509	0106C4	2126 			JGFS	TPT3
  1510	0106C6	41A0 4001 024A 		JAL	R10,CRASH,,	:FREE LIST EXHAUSTED
  1511	0106CC	0000 140F 		BC	0,0,4*R5,0F	:FLAG--LINK R5, TYPE 15d CRASH
  1512	0106D0	4043 0118 	TPT3	STH	R4,TLIST,R3	:MAKE EARLIER ACTIVE LIST ENTRY POINT TO NEW ENTRY
  1513	0106D4	7334 0118 		LHL	R3,TLIST,R4
  1514	0106D8	4030 0118 		STH	R3,TLIST	:SHORTEN FREE LIST
  1515	0106DC	4024 0118 		STH	R2,TLIST,R4	:HAVE NEW ENTRY POINT TO NEXT GREATER TIMEOUT ENTRY
Page  8-3	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(ISIS2)TIMOUT.LIB	 Standard Timeout Routine Library	- TIMOUT.LIB

  1516	0106E0	5004 011A 		ST	R0,TLIST+2,R4
  1517	0106E4	5014 011E 		ST	R1,TLIST+6,R4
  1518	0106E8	0305 			JR	R5		:STORE ARGUMENTS AND RETURN
  1519				
  1520	0106EA	2412 		TONOW	LIS	R1,2		:SEARCH ACTIVE LIST
  1521	0106EC	0821 		TONOW1	LR	R2,R1		:COPY CURRENT ENTRY POINTER
  1522	0106EE	7312 0118 		LHL	R1,TLIST,R2	:GET NEXT ENTRY
  1523	0106F2	0335 			JER	R5		:LIST EXHAUSTED...EXIT
  1524	0106F4	5501 011A 		CL	R0,TLIST+2,R1	:CHECK THIS ENTRY
  1525	0106F8	2036 			JNBS	TONOW1		:LOOP IF NOT MATCH
  1526	0106FA	7331 0118 		LHL	R3,TLIST,R1	:WE GOT A MATCH
  1527	0106FE	4032 0118 		STH	R3,TLIST,R2	:UNLINK THIS ENTRY
  1528	010702	7330 0118 		LHL	R3,TLIST	:GET START OF FREE LIST
  1529	010706	4031 0118 		STH	R3,TLIST,R1	:LINK THIS ENTRY TO FREE LIST
  1530	01070A	4010 0118 		STH	R1,TLIST	:PLACE ON FREE LIST
  1531	01070E	5050 0114 		ST	R5,TO9		:SAVE RETURN ADDRESS
  1532	010712	0300 			JR	R0		:AND GO TO ROUTINE
  1533				
  1534	010714	2412 		TOGET	LIS	R1,2		:SEARCH ACTIVE LIST
  1535	010716	0821 		TOGET1	LR	R2,R1		:COPY CURRENT ENTRY POINTER
  1536	010718	7312 0118 		LHL	R1,TLIST,R2	:GET NEXT ENTRY
  1537	01071C	0335 			JER	R5		:LIST EXHAUSTED...EXIT
  1538	01071E	5501 011A 		CL	R0,TLIST+2,R1	:CHECK THIS ENTRY
  1539	010722	2036 			JNBS	TOGET1		:LOOP IF NOT MATCH
  1540	010724	7331 0118 		LHL	R3,TLIST,R1	:WE GOT A MATCH
  1541	010728	4032 0118 		STH	R3,TLIST,R2	:UNLINK THIS ENTRY
  1542	01072C	7330 0118 		LHL	R3,TLIST	:GET START OF FREE LIST
  1543	010730	4031 0118 		STH	R3,TLIST,R1	:LINK THIS ENTRY TO FREE LIST
  1544	010734	4010 0118 		STH	R1,TLIST	:PLACE ON FREE LIST
  1545	010738	0305 			JR	R5		:AND EXIT
  1546				
  1547	01073A	C810 0050 	IZT	LHI	R1,NTOUT*LSIZ	:INITIALIZE TIMEOUT FREE LIST
  1548	01073E	2420 			LIS	R2,0		:0 TERMINATES LIST
  1549	010740	4020 011A 		STH	R2,TLIST+2	:ACTIVE LIST IS EMPTY
  1550	010744	4021 0118 		STH	R2,TLIST,R1	:TERMINATE FREE LIST
  1551	010748	4011 010E 		STH	R1,TLIST-LSIZ,R1
  1552	01074C	271A 			SIS	R1,LSIZ
  1553	01074E	2023 			JGBS	.-6
  1554	010750	0300 			JR	R0
  1555					EM
Page  9-1	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)BUFLIB.V01	 

  1556					RA	0		:	BUFFER.LIB
  1557				
  1558				:	This package contains all code and storage allocation needed for
  1559				:	bufferlet usage.
  1560				:	Includes a trace of all GCI and WCI calls.
  1561				
  1562				:	the following parameters MUST be defined before assembly:
  1563				:	NBUF	the number of buffers to create
  1564				:	NBFLET	the number of bufferlets to create
  1565				
  1566				:	uses routines in TIMOUT.LIB - - - requires one timeout list entry
  1567				
  1568				:	may JAL R10,CRASH on certain conditions
  1569				
  1570				:	Each routine is called with:
  1571				:	Link on R4
  1572				:	R0 = argument
  1573				:	R1 = buffer index (buffer number*2)
  1574				
  1575				:	routines:
  1576				:	IZBF	link on R5, used to initialize buffers
  1577				:	GCI	get a character from buffer
  1578				:	WCI	write a character into buffer
  1579				:	WCD	back up a buffer to restore last character
  1580				:	EMPTY	empty (flush) buffer
  1581				
  1582				:	buffer index may be used to index into the following halfword arrays
  1583				:	from external routines:
  1584				:	BF	buffer flags
  1585				:	BB	buffer start address
  1586				:	BE	buffer end address
  1587				:	BCT	buffer counts
  1588				
  1589				:	the following should also be defined externally:
  1590				:	FLAGS	a bit array of length corresponding to the maximum buffer flag value
  1591				
  1592				
  1593					MO	.,BUFFER
  1594					GL	FASTC,TORET,TOPUT,RATE,FLAGS,CRASH
  1595					GL	BF,BCT,BB,BE
  1596					GL	IZBF,GCI,WCI,WCD,EMPTY,GCPEEK,GCSCAN,MCI
  1597				        GL      BKPRON,BUFUSD,NGRP
  1598				
  1599				:	THE DATA FOR THESE ROUTINES
  1600	000172				SEG	0		:PLACE IN SEG 0
  1601	000172	0000 		REBL	HC	0		:FREE LIST POINTER FOR RESERVE STORAGE LIST
  1602	000174	0000 		REBC1	HC	0		:COUNTS TIMES BUFFER STORAGE WAS MOVED TO MAIN FREE LIST
  1603	000176	0000 		REBC2	HC	0		:COUNTS TOTAL NUMBER OF BUFFER ZAPS
  1604	000178	FFFF 		BFZ	HC	-1		:LAST BUFFER ZAPPED
  1605				
  1606	00017A			BF	HS	NBUF		:BUFFER FLAGS
  1607	0001FE			BCT	HS	NBUF		:BUFFER COUNTS
  1608	000282			BB	HS	NBUF		:BUFFER START ADDRESS
Page  9-2	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)BUFLIB.V01	 

  1609	000306			BE	HS	NBUF		:BUFFER END ADDRESS
  1610				
  1611	00038A	0000 		HISX	HC	0		:INDEX FOR HISTORY
  1612	00038C			HISTAB	HS	200		:HISTORY DATA...400 BYTES...100 HISTORY ENTRIES
  1613				
  1614	00078C			BKPRON  HS      1               :FLAG INDICATING ALL PORTS BACKPRESSURED
  1615	00078E			BUFUSD  HS      1               :COUNT OF BUFFERLETS USED
  1616	000790			        BND     4
  1617	000790			R2SAVE  WS      1
  1618				
  1619				
  1620				:	CODE SECTION
  1621	010752				SEG	1		:PLACE IN SEGMENT 1
  1622				
  1623				:	INITIALIZE BUFFERS
  1624	010752	2400 		IZBF	LIS	R0,0		:SET A CONSTANT
  1625	010754	C810 0082 		LHI	R1,NBUF*2-2	:FOR ALL BUFFERS
  1626	010758	4001 01FE 	IZBF1	STH	R0,BCT,R1	:SET EMPTY
  1627	01075C	7321 017A 		LHL	R2,BF,R1
  1628	010760	7620 0002 		RBT	R2,FLAGS	:TURN OFF FLAG BIT
  1629	010764	2712 			SIS	R1,2
  1630	010766	2217 			JGEBS	IZBF1
  1631	010768	F810 0000 9800 	        LI      R1,NBFLET*8     :FOR ALL BUFERLETS
  1632	01076E	4001 4003 0000 		STH	R0,BUFERS,R1,	:TERMINATE LIST
  1633	010774	4011 4002 FFF8 	IZBF2	STH	R1,BUFERS-8,R1,	:LINK LAST TO THIS
  1634	01077A	4001 4002 FFFA 		STH	R0,BUFERS-6,R1,	:CLEAR DATA AREA
  1635	010780	5001 4002 FFFC 		ST	R0,BUFERS-4,R1,
  1636	010786	2718 			SIS	R1,8
  1637	010788	202A 			JGBS	IZBF2		:REPEAT FOR ALL BUFFERLETS
  1638	01078A	4000 0172 		STH	R0,REBL		:SET SPARE TANK EMPTY
  1639	01078E	5810 400F 0004 		L	R1,FASTC,,
  1640	010794	C811 0018 		LHI	R1,RATE/$A25,R1	:CALL EVERY 40 MS.
  1641	010798	E600 8304 		LA	R0,CKBZ		:PUT BUFFER CHECKING LOGIN ON QUEUE
  1642	01079C	4300 FF10 		J	TOPUT		:EXIT VIA TIMEOUT LIST ENTRY
  1643				:	CHARACTER HANDLERS. THESE ROUTINES PASS BFR CHR IN R0,
  1644				:	R1 FOR TWICE THE BUFFER NUMBER, R2,R3 FOR WORKING REGISTERS, R4 IS LINK.
  1645				
  1646				:	GET CHAR FROM BUFFER AND INCREMENT FORWARD THRU THE BUFFER.
  1647	0107A0	41A0 FAA6 	GCICRA	JAL	R10,CRASH
  1648	0107A4	0000 1003 		BC	0,0,4*R4,3	:FLAG--LINK R4, TYPE 3
  1649	0107A8	C510 0084 	GCI	CLHI	R1,2*NBUF	:RANGE CHECK ON BUFFER NUMBER
  1650	0107AC	2216 			JGEBS	GCICRA		:BUFFER NUMBER OUT OF RANGE...CRASH
  1651	0107AE	7321 0282 		LHL	R2,BB,R1	:GOOD BUFFER...GET INDEX TO CHARACTER
  1652	0107B2	D302 4003 0000 		LB	R0,BUFERS,R2,	:PICK UP CHAR
  1653	0107B8	2531 			LCS	R3,1
  1654	0107BA	6131 01FE 		AHM	R3,BCT,R1	:REDUCE COUNT OF CHARS IN BUFFER
  1655	0107BE	4320 8038 		JLE	GCILAS		:SKIP IF NO CHARACTERS LEFT
  1656	0107C2	2621 			AIS	R2,1		:ELSE INCREMENT BB VALUE
  1657	0107C4	C320 0007 		THI	R2,7		:TEST IF AT END OF BUFFERLET
  1658	0107C8	2335 			JEFS	GCI1		:RETURN BUFFERLET TO FREE LIST IF SO
  1659	0107CA	4021 0282 		STH	R2,BB,R1	:ELSE UPDATE BB
  1660	0107CE	4300 8120 		J	HIST		:AND RETURN WITH THE CHAR
  1661				
Page  9-3	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)BUFLIB.V01	 

  1662	0107D2	7332 4003 0000 	GCI1	LHL	R3,BUFERS,R2,	:BUFFERLET EXHAUSTED
  1663	0107D8	2736 			SIS	R3,6		:CHAIN TO NEXT BUFFERLET
  1664	0107DA	4031 0282 		STH	R3,BB,R1	:SET BB TO START OF NEXT BUFFERLET
  1665	0107DE	7330 4003 0000 		LHL	R3,BUFERS,,	:GET POINTER TO FREE LIST
  1666	0107E4	4032 4003 0000 		STH	R3,BUFERS,R2,	:LINK LAST BUFFERLET TO FREE LIST
  1667	0107EA	4020 4003 0000 		STH	R2,BUFERS,,	:AND PUT AT THE HEAD OF THE FREE LIST
  1668	0107F0	2531 		        LCS     R3,1
  1669	0107F2	6130 078E 	        AHM     R3,BUFUSD       :DECREMENT COUNT OF BFRLTS USED
  1670	0107F6	4300 80F8 		J	HIST		:THEN EXIT
  1671				
  1672	0107FA	4210 FFA2 	GCILAS	JL	GCICRA		:CRASH IF BUFFER WAS EMPTY
  1673	0107FE	7331 017A 		LHL	R3,BF,R1	:OK...GET POINTER TO FLAG BIT
  1674	010802	7630 0516 		RBT	R3,FLAGS	:RESET ATTENTION FLAG
  1675	010806	2626 			AIS	R2,6		:BUMP CHARACTER POINTER PAST END OF BUFFERLET
  1676	010808	C420 FFF8 		NHI	R2,-8		:MAKE CHAIN A MULTIPLE OF 8
  1677	01080C	7330 4003 0000 		LHL	R3,BUFERS,,
  1678	010812	4032 4003 0000 		STH	R3,BUFERS,R2,
  1679	010818	4020 4003 0000 		STH	R2,BUFERS,,	:UPDATE FREE LIST
  1680	01081E	2531 		        LCS     R3,1
  1681	010820	6130 078E 	        AHM     R3,BUFUSD       :DECREMENT COUNT OF BUFRLETS USED
  1682	010824	4300 80CA 		J	HIST
  1683				
  1684				:	PUT A CHARACTER INTO THE BUFFER
  1685	010828	C510 0084 	WCI	CLHI	R1,2*NBUF	:RANGE CHECK ON BUFFER NUMBER
  1686	01082C	2115 			JLFS	WCI1		:SKIP IF OK
  1687	01082E	41A0 FA18 	WCICRA	JAL	R10,CRASH	:ELSE CRASH
  1688	010832	0000 1005 		BC	0,0,4*R4,5	:FLAG--LINK R4, TYPE 5 CRASH
  1689				
  1690	010836	7321 01FE 	WCI1	LHL	R2,BCT,R1	:CHECK COUNT
  1691	01083A	4330 805A 		JE	WCIFRS		:IF NEW BUFFER, SET UP ATTENTION FLAGS
  1692	01083E	2621 			AIS	R2,1		:ELSE UPDATE COUNT
  1693	010840	4021 01FE 		STH	R2,BCT,R1
  1694	010844	7321 0306 		LHL	R2,BE,R1	:GET POINTER TO LAST CHARACTER POSITION
  1695	010848	2621 			AIS	R2,1		:BUMP POINTER
  1696	01084A	C320 0007 		THI	R2,7		:TEST IF BUFFERLET FULL
  1697	01084E	2338 			JEFS	WCINXB
  1698	010850	4021 0306 		STH	R2,BE,R1	:ELSE UPDATE BE
  1699	010854	D202 4003 0000 		STB	R0,BUFERS,R2,	:AND SAVE CHAR IN BUFFER
  1700	01085A	4300 8094 		J	HIST
  1701				
  1702	01085E			WCINXB  EQ      .
  1703	01085E	7330 4003 0000 	      	LHL	R3,BUFERS,,	:NEED A NEW BUFFERLET
  1704	010864	2136 			JNFS	WCINXC		:SKIP IF THERE IS ANOTHER
  1705	010866	4120 8072 		JAL	R2,WRE		:(OPEN THE RESERVE TANK)
  1706	01086A	7321 0306 		LHL	R2,BE,R1	:RESTORE R2
  1707	01086E	2621 			AIS	R2,1
  1708	010870	4032 4003 0000 	WCINXC	STH	R3,BUFERS,R2,	:LINK NEW BUFFERLET TO LAST ONE
  1709	010876	7323 4003 0000 		LHL	R2,BUFERS,R3,	:AND REMOVE FROM FREE LIST
  1710	01087C	4020 4003 0000 		STH	R2,BUFERS,,
  1711	010882	2736 			SIS	R3,6		:BACK UP NEW BUFFERLET
  1712	010884	4031 0306 		STH	R3,BE,R1	:SAVE AS NEW BE
  1713	010888	D203 4003 0000 		STB	R0,BUFERS,R3,	:PUT THE CHARACTER THERE
  1714	01088E	2431 		        LIS     R3,1
Page  9-4	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)BUFLIB.V01	 

  1715	010890	6130 078E 	        AHM     R3,BUFUSD       :INCREMENT COUNT OF BUFFERLETS USED
  1716	010894	4300 805A 		J	HIST
  1717				
  1718	010898	4821 017A 	WCIFRS	LH	R2,BF,R1	:THE BUFFER WAS EMPTY
  1719	01089C	4330 8052 		JE	HIST		:TOSS THE CHAR, DONT WASTE SPACE ON UNASSIGNED BFR.
  1720	0108A0	7520 04F6 		SBT	R2,FLAGS	:ATTENTION BIT ON TO ALERT SOME PROCESS OF DATA WAITING
  1721	0108A4	2421 			LIS	R2,1
  1722	0108A6	4021 01FE 		STH	R2,BCT,R1	:SET COUNT = 1
  1723	0108AA	7330 4003 0000 		LHL	R3,BUFERS,,	:POP A BUFFERLET OFF FREE LIST
  1724	0108B0	2123 			JGFS	.+6		:SKIP IF THERE WAS ONE
  1725	0108B2	4120 8026 		JAL	R2,WRE		:ELSE OPEN THE RESERVE TANK
  1726	0108B6	7323 4003 0000 		LHL	R2,BUFERS,R3,
  1727	0108BC	4020 4003 0000 		STH	R2,BUFERS,,	:UPDATE FREE LIST
  1728	0108C2	2736 			SIS	R3,6		:POINT IT AT FIRST CHARACTER
  1729	0108C4	4031 0282 		STH	R3,BB,R1	:SET UP BB
  1730	0108C8	4031 0306 		STH	R3,BE,R1	:AND BE
  1731	0108CC	D203 4003 0000 		STB	R0,BUFERS,R3,	:PUT THE CHARACTER THERE
  1732	0108D2	2431 		        LIS     R3,1
  1733	0108D4	6130 078E 	        AHM     R3,BUFUSD       :INCREMENT COUNT OF BUFFERLETS USED
  1734	0108D8	4300 8016 		J	HIST
  1735				
  1736				:	MOVE RESERVE STORAGE SUPPLY TO MAIN FREE LIST
  1737	0108DC	7330 0172 	WRE	LHL	R3,REBL		:GET POINTER TO RESERVE BUFFERLETS
  1738	0108E0	3433 			EXHR	R3,R3
  1739	0108E2	4030 0172 		STH	R3,REBL		:SET RESERVE BUFFERLETS EMPTY (=0)
  1740	0108E6	3433 			EXHR	R3,R3
  1741	0108E8	0232 			JNR	R2		:IF IT WASN'T EMPTY, RETURN
  1742	0108EA	41A0 F95C 		JAL	R10,CRASH	:BUG, UNREASONABLY FAST STORAGE DRAIN
  1743	0108EE	0000 1006 		BC	0,0,4*R4,6	:FLAG--LINK R4, TYPE 6
  1744				
  1745				:	UPDATE HISTORY (TRACE) AFTER EVERY BUFFER OPERATION
  1746	0108F2	4830 038A 	HIST	LH	R3,HISX		:GET HISTORY RING INDEX
  1747	0108F6	2634 			AIS	R3,4		:BUMP TO NEXT ENTRY
  1748	0108F8	C430 03FF 		NHI	R3,3FF		:ACCOUNT FOR FOLDING
  1749	0108FC	4030 038A 		STH	R3,HISX		:SAVE IT AGAIN
  1750	010900	D203 038C 		STB	R0,HISTAB,R3	:ENTRY (0) = CHARACTER
  1751	010904	0821 			LR	R2,R1
  1752	010906	9021 			SRHLS	R2,1		:COMPUTE BUFFER #
  1753	010908	D223 038D 		STB	R2,HISTAB+1,R3	:ENTRY (1) = PORT #
  1754	01090C	4043 038E 		STH	R4,HISTAB+2,R3	:ENTRY (2, 3) = LOCATION WHERE CHAR PLACED
  1755	010910	0304 			JR	R4
  1756				
  1757				:	PEEK AT FIRST CHAR OF BUFFER
  1758	010912	41A0 F934 	GCPCRA	JAL	R10,CRASH
  1759	010916	0000 1006 		BC	0,0,4*R4,6	:CRASH TYPE 6
  1760	01091A	C510 0084 	GCPEEK	CLHI	R1,2*NBUF	:RANGE CHECK
  1761	01091E	2216 			JGEBS	GCPCRA
  1762	010920	7321 0282 		LHL	R2,BB,R1	:GET POINTER TO START OF BUFFER DATA
  1763	010924	7331 01FE 		LHL	R3,BCT,R1	:GET COUNT OF CHARS THERE
  1764	010928	2304 			JFS	GCS		:AND SKIP
  1765				
  1766				:	SCAN SUCESSIVE CHARACTERS IN BUFFER
  1767	01092A	C510 0084 	GCSCAN	CLHI	R1,2*NBUF	:RANGE CHECK
Page  9-5	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)BUFLIB.V01	 

  1768	01092E	221E 			JGEBS	GCPCRA
  1769	010930	2731 		GCS	SIS	R3,1
  1770	010932	4210 FFDC 		JL	GCPCRA		:CRASH IF NO MORE CHARACTERS THERE
  1771	010936	D302 4003 0000 		LB	R0,BUFERS,R2,	:ELSE GET CHAR
  1772	01093C	2621 			AIS	R2,1		:BUMP POINTER FOR NEXT TIME
  1773	01093E	C320 0007 		THI	R2,7
  1774	010942	0234 			JNR	R4		:EXIT IF NOT AT END OF BUFFERLET
  1775	010944	7322 4003 0000 		LHL	R2,BUFERS,R2,	:ELSE ADVANCE TO NEXT BUFFERLET
  1776	01094A	2726 			SIS	R2,6		:POINT AT START
  1777	01094C	0304 			JR	R4
  1778				
  1779				:	MCI - MOVE ALL CHARACTERS FROM SOURCE TO DESTINATION BUFFER
  1780				:	R5 = SOURCE BUFFER INDEX
  1781				:	R6 = DESTINATION BUFFER INDEX
  1782				:	R7 = LINK
  1783	01094E	41A0 F8F8 	MCICRA	JAL	R10,CRASH
  1784	010952	0000 1C04 		BC	0,0,4*R7,4	:FLAG--LINK R7, TYPE 4
  1785	010956	C550 0084 	MCI	CLHI	R5,2*NBUF
  1786	01095A	2026 			JGBS	MCICRA		:RANGE CHECK ON SOURCE
  1787	01095C	C560 0084 		CLHI	R6,2*NBUF
  1788	010960	2029 			JGBS	MCICRA		:RANGE CHECK ON DESTINATION
  1789	010962	7305 01FE 		LHL	R0,BCT,R5	:CHECK SOURCE
  1790	010966	0337 			JER	R7		:EXIT IF EMPTY
  1791	010968	7316 017A 		LHL	R1,BF,R6	:SET DESTINATION FLAG
  1792	01096C	2135 			JNFS	MCI1		:FLAG = 0 IS BIT BUCKET
  1793	01096E	0815 			LR	R1,R5		:THEN JUST EMPTY BUFFERS
  1794	010970	0847 			LR	R4,R7
  1795	010972	4300 80CA 		J	EMPTY
  1796	010976	7510 06B6 	MCI1	SBT	R1,FLAGS	:SET THE FLAG
  1797	01097A	2137 			JNFS	MCI2		:NOT EMPTY...GO APPEND
  1798	01097C	7305 0282 		LHL	R0,BB,R5	:EMPTY...COPY BUFFER START
  1799	010980	4006 0282 		STH	R0,BB,R6
  1800	010984	4300 8036 		J	MCI4		:AND SKIP TO FINISH TRANSFER OF DATA
  1801	010988	7316 0306 	MCI2	LHL	R1,BE,R6	:CHECK DESTINATION
  1802	01098C	2611 			AIS	R1,1		:IS IT AT END OF BUFFERLET?
  1803	01098E	C310 0007 		THI	R1,7
  1804	010992	213B 			JNFS	MCI3		:SKIP IF NOT
  1805	010994	7325 0282 		LHL	R2,BB,R5	:YES...IS SOURCE ON BUFFERLET BOUNDARY?
  1806	010998	2626 			AIS	R2,6
  1807	01099A	C320 0007 		THI	R2,7
  1808	01099E	2135 			JNFS	MCI3		:SKIP IF NOT
  1809	0109A0	4021 4003 0000 		STH	R2,BUFERS,R1,	:ELSE APPEND SOURCE TO DESTINATION
  1810	0109A6	230C 			JFS	MCI4		:AND SKIP
  1811	0109A8	0815 		MCI3	LR	R1,R5		:MOVE A CHAR
  1812	0109AA	4140 FDFA 		JAL	R4,GCI
  1813	0109AE	0816 			LR	R1,R6
  1814	0109B0	4140 FE74 		JAL	R4,WCI
  1815	0109B4	7305 01FE 		LHL	R0,BCT,R5	:CHECK SOURCE
  1816	0109B8	4220 FFCC 		JG	MCI2		:LOOP IF NOT EMPTY
  1817	0109BC	0307 			JR	R7		:ELSE RETURN
  1818	0109BE	7305 0306 	MCI4	LHL	R0,BE,R5
  1819	0109C2	4006 0306 		STH	R0,BE,R6	:UPDATE BUFFER END
  1820	0109C6	7305 01FE 		LHL	R0,BCT,R5
Page  9-6	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)BUFLIB.V01	 

  1821	0109CA	6106 01FE 		AHM	R0,BCT,R6	:UPDATE COUNT
  1822	0109CE	2400 			LIS	R0,0
  1823	0109D0	4005 01FE 		STH	R0,BCT,R5	:CLEAR SOURCE BUFFER
  1824	0109D4	7315 017A 		LHL	R1,BF,R5
  1825	0109D8	7610 0316 		RBT	R1,FLAGS	:TURN OFF SOURCE FLAG
  1826	0109DC	0307 			JR	R7		:AND EXIT
  1827				
  1828				:	BACK UP A BUFFER TO RESTORE LAST CHAR
  1829	0109DE	7321 01FE 	WCD	LHL	R2,BCT,R1	:PICK UP COUNT
  1830	0109E2	4330 8038 		JE	WCDZ		:BFR IS EMPTY BUT OLD CHAR IS STILL AROUND
  1831	0109E6	2621 			AIS	R2,1		:ELSE UPDATE COUNT
  1832	0109E8	4021 01FE 		STH	R2,BCT,R1
  1833	0109EC	7321 0282 		LHL	R2,BB,R1	:BACK UP BB
  1834	0109F0	2721 			SIS	R2,1
  1835	0109F2	4021 0282 		STH	R2,BB,R1
  1836	0109F6	2627 			AIS	R2,7		:TEST IF BACKED OVER BEGINNING OF BUFFERLET
  1837	0109F8	C320 0007 		THI	R2,7
  1838	0109FC	0234 			JNR	R4		:EXIT IF NOT
  1839	0109FE	7330 4003 0000 		LHL	R3,BUFERS,,	:ELSE GET LAST ENTRY FROM FREE LIST
  1840	010A04	7303 4003 0000 		LHL	R0,BUFERS,R3,
  1841	010A0A	4000 4003 0000 		STH	R0,BUFERS,,
  1842	010A10	4023 4003 0000 		STH	R2,BUFERS,R3,	:LINK NEW FIRST ENTRY TO OLD FIRST
  1843	010A16	2731 			SIS	R3,1
  1844	010A18	4031 0282 		STH	R3,BB,R1	:SET NEW ENTRY INTO BB
  1845	010A1C	0304 			JR	R4
  1846				
  1847	010A1E	7320 4003 0000 	WCDZ	LHL	R2,BUFERS,,	:HERE WITH BUFFER EMPTY (BB IS OK)
  1848	010A24	7332 4003 0000 		LHL	R3,BUFERS,R2,
  1849	010A2A	4030 4003 0000 		STH	R3,BUFERS,,	:FIXUP FREE LIST
  1850	010A30	7321 017A 		LHL	R2,BF,R1
  1851	010A34	7520 02E6 		SBT	R2,FLAGS	:SET NONEMPTY BFR ATTENTION FLAG
  1852	010A38	2421 			LIS	R2,1
  1853	010A3A	4021 01FE 		STH	R2,BCT,R1	:SET COUNT = 1 CHARACTER
  1854	010A3E	0304 			JR	R4
  1855				
  1856				:	RETURN ALL THE SPACE USED BY THE BUFFER
  1857	010A40	C510 0084 	EMPTY	CLHI	R1,2*NBUF	:RANGE CHECK ON BUFFER NUMBER
  1858	010A44	2115 			JLFS	C1		:BFR ARGUMENT ACCEPTED
  1859	010A46	41A0 F800 		JAL	R10,CRASH	:BFR ARG OUT OF RANGE
  1860	010A4A	0000 100D 		BC	0,0,4*R4,0D	:FLAG--LINK R4, TYPE 13d
  1861				
  1862	010A4E	7331 01FE 	C1	LHL	R3,BCT,R1	:CHECK CONTENTS
  1863	010A52	0334 			JER	R4		:EXIT...BUFFER EMPTY
  1864				:       CALCULATE HOW MANY BUFFERLETS USED AND UPDATE BUFUSD
  1865	010A54	2420 		        LIS     R2,0            :GET R2 READY FOR DIVIDE OP (BCT IN R3)
  1866	010A56	2456 		        LIS     R5,6            :6 BYTES PER BFRLET--DIVIDE BCT BY 6
  1867	010A58	1D25 		        DR      R2,R5           :QUOTIENT IN R3 -- REMAINDER IN R2
  1868	010A5A	0822 		        LR      R2,R2           :IF A REMAINDER, ADD 1 TO COUNT
  1869	010A5C	2332 		        JEFS    EMPT0
  1870	010A5E	2631 		        AIS     R3,1
  1871	010A60	7350 078E 	EMPT0   LHL     R5,BUFUSD       :GET CURRENT BUFFERLETS USED COUNT
  1872	010A64	0B53 		        SR      R5,R3           :SUBTRACT # BUFRLTS USED BY THIS BUFFER
  1873	010A66	4050 078E 	        STH     R5,BUFUSD       :SAVE UDATED COUNT
Page  9-7	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)BUFLIB.V01	 

  1874	010A6A	2420 			LIS	R2,0
  1875	010A6C	4021 01FE 		STH	R2,BCT,R1	:NOT EMPTY...SET COUNT = 0
  1876	010A70	7321 0282 		LHL	R2,BB,R1	:POINTER TO FIRST CHAR IN BUFFER
  1877	010A74	2626 			AIS	R2,6
  1878	010A76	C420 FFF8 		NHI	R2,-8
  1879	010A7A	7330 4003 0000 		LHL	R3,BUFERS,,	:GET POINTER TO FREE LIST
  1880	010A80	4020 4003 0000 		STH	R2,BUFERS,,	:PUT THE BUFFERS BUFFERLETS ONTO FREE LIST
  1881	010A86	7321 0306 		LHL	R2,BE,R1	:GET POINTER TO LAST CHARACTER IN BUFFER
  1882	010A8A	2626 			AIS	R2,6		:LOCATE THE POINTER IN THIS BUFFERLET
  1883	010A8C	C420 FFF8 		NHI	R2,-8
  1884	010A90	4032 4003 0000 		STH	R3,BUFERS,R2,	:CHAIN PREVIOUS FREE LIST TO THIS BUFFERLET
  1885	010A96	4821 017A 		LH	R2,BF,R1
  1886	010A9A	7620 0336 		RBT	R2,FLAGS	:SET FLAGS TO EMPTY BUFFER
  1887	010A9E	0304 			JR	R4		:AND RETURN
  1888				
  1889				:	SEE IF WE MUST ZAP BFRS BECAUSE BFR STORAGE RUNNING LOW
  1890	010AA0	C811 0018 	CKBZ	LHI	R1,RATE/$A25,R1	:SET TIMER FOR NEXT CALL
  1891	010AA4	4150 FC08 		JAL	R5,TOPUT	:RUN 25 TIMES PER SECOND
  1892	010AA8	4810 0172 		LH	R1,REBL		:ARE WE ON THE RESERVE TANK?
  1893	010AAC	4230 FBCC 		JN	TORET		:PLENTY OF BFR STORAGE. DONT ZAP BFRS
  1894				
  1895				:	WCI GRABBED RESERVE BFR FREE LIST AND MOVED IT TO MAIN FREE LIST.
  1896				:	REFILL FREE LIST WITH 1/8 OF TOTAL BFR STORAGE. ZAP BFRS IF NECESSARY.
  1897	010AB0	2401 			LIS	R0,1
  1898	010AB2	6100 0174 		AHM	R0,REBC1	:STATISTIC
  1899	010AB6	2420 		REB1	LIS	R2,0		:INITIAL POINTER IS TO START OF FREE LIST
  1900	010AB8	E610 0260 		LA	R1,NBFLET/8	:SCAN MAIN FREE LIST FOR 1/8 FREE STORAGE
  1901				
  1902	010ABC	7322 4003 0000 	REB2	LHL	R2,BUFERS,R2,	:GET NEXT BUFFER ON FREE LIST
  1903	010AC2	4330 8024 		JE	REBZ		:NOT ENOUGH SPARE SPACE. ZAP A BFR
  1904	010AC6	2711 			SIS	R1,1		:GOT ANOTHER...COUNT IT
  1905	010AC8	2026 			JGBS	REB2		:GO UNTIL WE'VE GOT ENOUGH
  1906	010ACA	7330 4003 0000 		LHL	R3,BUFERS,,	:DONE...SEPERATE FREE LIST INTO TWO PARTS
  1907	010AD0	4030 0172 		STH	R3,REBL		:BEGINNING OF THE RESERVE LIST
  1908	010AD4	7342 4003 0000 		LHL	R4,BUFERS,R2,,
  1909	010ADA	4040 4003 0000 		STH	R4,BUFERS,,	:BEGINNING OF MAIN LIST
  1910	010AE0	4012 4003 0000 		STH	R1,BUFERS,R2,,	:DEATH'S BRIGHT ANGEL AT END OF SPARE LIST (=0)
  1911	010AE6	4300 FB92 		J	TORET
  1912				
  1913				:	ZAP A BFR IN ORDER TO GET RESERVE TANK UP TO 1/8 OF TOTAL BFR STORAGE
  1914	010AEA	C810 0082 	REBZ	LHI	R1,NBUF*2-2	:BCT INDEX
  1915	010AEE	2571 			LCS	R7,1		:BCT CONTENTS OF LARGEST BFR
  1916	010AF0	7301 01FE 	REBZ1	LHL	R0,BCT,R1
  1917	010AF4	0570 			CLR	R7,R0
  1918	010AF6	2313 			JGEFS	.+6
  1919	010AF8	0870 			LR	R7,R0
  1920	010AFA	0881 			LR	R8,R1
  1921	010AFC	2712 			SIS	R1,2
  1922	010AFE	2217 			JGEBS	REBZ1
  1923	010B00	2401 			LIS	R0,1
  1924	010B02	6100 0176 		AHM	R0,REBC2
  1925	010B06	4080 0178 		STH	R8,BFZ		:STATISTICS
  1926	010B0A	0818 			LR	R1,R8		:ZAP BIGGEST BUFFER FOUND
Page  9-8	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)BUFLIB.V01	 

  1927	010B0C	4140 FF30 		JAL	R4,EMPTY	:RETRIEVE STORAGE
  1928	010B10	2409 			LIS	R0,9
  1929	010B12	4140 F5D6 		JAL	R4,ROOM		:WE WANT TO SEND A 9-BYTE MESSAGE
  1930	010B16	C800 0300 		LHI	R0,0300		:SPECIAL MESSAGE TYPE 3...
  1931	010B1A	4140 F656 		JAL	R4,PUTW		:SEND DIAGNOSTIC TO SUP
  1932	010B1E	0807 			LR	R0,R7
  1933	010B20	4140 F640 		JAL	R4,PUTH		:HW4 = CHAR COUNT
  1934	010B24	0808 			LR	R0,R8
  1935	010B26	9001 			SRHLS	R0,1
  1936	010B28	4140 F638 		JAL	R4,PUTH		:HW3 = BUFFER NUMBER
  1937	010B2C	2400 			LIS	R0,0
  1938	010B2E	4140 F622 		JAL	R4,PUTCH	:HW2 = 0
  1939	010B32	4140 F66C 		JAL	R4,ELOR		:END LOGICAL OUTPUT RECORD
  1940	010B36	4300 FF7C 		J	REB1		:TRY AGAIN TO FILL RESERVE STORAGE LIST
  1941				
  1942				
  1943				:	BUFFER SEGMENT
  1944	030000				SEG	3		:BUFFERLETS ARE IN SEGMENT 3
  1945	030000			BUFERS	HS	4*NBFLET+1	:THE STORAGE FOR THE BUFFERLETS
  1946					EM
  1947	019802			S2SIZE	EQ	.-SEG2		:UPDATE SEG 2 SIZE
  1948	039802			        END
Page  10-1	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  1949					SUBTTL	ISIS Front-end Package
  1950					REMARK %FrontLib V0.15 04-05-82 SCY
  1951				:******************************************************************
  1952				:
  1953				:	This program is the sole property and confidential
  1954				:	information of Tymshare, Inc., and may not be copied
  1955				:	in whole or in part or disclosed to any third party
  1956				:	without the prior written consent of Tymshare.
  1957				:
  1958				:*******************************************************************
  1959					RA	0		:	FRONT.LIB
  1960				
  1961				: V 0.15 04-05-82 SCY
  1962				:	Added DCTFLG to make use of DCT optional
  1963				: V 0.14 03-18-82 SCY
  1964				:	Added DCT to count real data characters count
  1965				: V 0.13 03-15-82 MDS
  1966				:	Add code to handle port starting in No-Echo mode
  1967				: V 0,12 11-19-81 SCY
  1968				:	Send bell for read_line @ that column
  1969				: V 0.11 09-01-81 SMF
  1970				:	Added condtional flag 'MBUFER' to allow usage with MBUFER.LIB.
  1971				:	Added PTTOUT entry to set port timeout.
  1972				:	Added ZAPPRT entry to zap port bypassing buffers.
  1973				:	Added CHRLIM array of input limits by port.
  1974				:	User routine is now given a chance to empty buffer before
  1975				:	backpressure is sent.
  1976				: V 0.10 06-01-81 SMF
  1977				:	Force the WAITZA option on so that zapper ack's will be handled
  1978				:	correctly.
  1979				: V 0.9 05-22-81 SMF
  1980				:	Force the CNTRL bit on to get zapper acknowledgements.  This
  1981				:	ensures that the buffers for the port will get cleared after the
  1982				:	circuit is torn down.
  1983				: V 0.8 04-03-81 MDS
  1984				:	Needle activations now set the ACP bit before activating the user
  1985				:	code. This gives the host the opportunity to reset ACP, thereby
  1986				:	notifying FrontLib that this circuit is rejected.
  1987				: V 0.7 03-31-81 MDS
  1988				:	Added routines to handle messages BA, BB, BC, BD, BE.
  1989				:	Permit user to select clearing port after zapper acknowledgement
  1990				:	   arrives (set WAITZA EQ 1) as an option.
  1991				:	Made use of UMTOSS table optional.
  1992				: V 0.6 02-20-81 MDS
  1993				:	Made outgoing zappers reset same bits as incoming zappers.
  1994				: V 0.5 02-06-81 MDS
  1995				:	Fixed handling of Red Balls, to flush a pending Green Ball, rather
  1996				:	than to force the return of it.
  1997				: V 0.4 01-17-81 MDS
  1998				:	Fixed Setting port flags, moved from B2 routine to B6 routine,
  1999				:	note that B2 does not necessarily imply a circuit is built.
  2000				:	B2 messages are now tossed.
  2001				: V 0.3 11-24-80 MDS
Page  10-2	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  2002				:	Added use of NOESC0 flag to suppress putting escape char ahead of
  2003				:	data nulls, and the table UMTOSS to indicate that a break message
  2004				:	handled by the user should not be put in the input buffer.
  2005				: V 0.2 11-19-80  MDS
  2006				:	Added bit array OUTCRT, bit set to indicate this port has
  2007				:	aux. circuit built "out" and we need to act like a remote
  2008				:	with regard to B1 messages.
  2009				: V 0.1 11-17-80  MDS
  2010				:	Added ECHOFF variable, and handling of B1 (echo control) messages
  2011				:	per PASCAL nucleus usage.
  2012				
  2013				
  2014				:		This package is the ISIS front end...used to service the
  2015				:	ISIS input and output rings, and to activate user code
  2016				:	whenever a break (user defined) is encountered.
  2017				:	It also activates user code when a user-processable
  2018				:	(also user defined) non-data message is encountered,
  2019				:	if excessive data is input without a break, or if a timeout
  2020				:	occurs for a port.
  2021				
  2022				:			CONVENTIONS
  2023				
  2024				:		Each of NPORT ports has a buffer-pair associated with it.
  2025				:	Even numbered buffers are input buffers...the corresponding
  2026				:	odd numbered buffer is that port's output buffer.  The user-
  2027				:	provided code should intialize these buffers.
  2028				
  2029				:	A 0-byte in the buffer is an escape...it is followed by a
  2030				:	data-0, or by an ISIS message code and the appropriate
  2031				:	character stream following. (But note NOESC0 flag and UMTOSS
  2032				:	bit table added V 0.3 can change this escape convention.)
  2033				:	This does NOT apply to needles,
  2034				:	and thus unassigned ports should be connected to an appropriate
  2035				:	process.  Needles are parsed, and the following usage applies on
  2036				:	activation <Needles ALWAYS activate>:
  2037				:		R5	Invoice number,
  2038				:		R6	Destination Host number,
  2039				:		R7	Originating Node number,
  2040				:		R8	Originating Host Number
  2041				:		R9	Originating Port number,
  2042				:		R10	Dialect Code
  2043				:		R11	TID
  2044				:		R12	number of characters in user name,
  2045				:			The username is placed into the port's buffer.)
  2046				
  2047				:	Data breaks on C/R if no break array is specified.
  2048				
  2049				:	Activation always occurs after the breaking data character
  2050				:	is placed into the buffer, or after a complete MESSAGE is
  2051				:	placed in the buffer.
  2052				
  2053				:	Break is activated with the buffer index in R1, and links on R15.
  2054				:	R0 contains an activation key, and condition codes are set appropriately:
Page  10-3	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  2055				:	>0	R0 is message type
  2056				:	=0	data break...R2 contains the activation char
  2057				:	=-1	needle
  2058				:	=-2	too many chars
  2059				:	=-3	flushing...next will not necessarily be data
  2060				:	=-4	timout
  2061				:	=-5	port 0 message
  2062				
  2063				:	All registers are available for use while in the user code, and
  2064				:	on return, R0 is to contain a number N.  If N>0, it is default timeout
  2065				:	(in seconds) until the next activation, if N=0, timeout is disabled,
  2066				:	and if N<0, timeout retains its previous status.
  2067				:	All data characters are automatically placed in the input buffer,
  2068				:	as are any control messages specified for user-handling.
  2069				
  2070				:	ALL ISIS special messages are placed in the buffer for port 0,
  2071				:	and each breaks automatically.
  2072				
  2073				:	For non-text messages, the escape convention applies ONLY to the
  2074				:	message type...the body of the message is unescaped.  ALL such
  2075				:	messages handled by the user cause a break.
  2076				
  2077				:	The following WORD arrays (length NPORT words), and are to be initalized
  2078				:	by the user program:
  2079				
  2080				:	BREAK	a pointer to the bit array of characters to break upon.
  2081				:	MBREAK	a pointer to the bit array of message types to break on.
  2082				:	PROCESS	a pointer to the process to be activated upon a break condition.
  2083				
  2084				:	The following items are to be provided by the user:
  2085				
  2086				:	A bit array TISIS of length NPORT, to signal output data.
  2087				:	A symbol MAXCHAR...default limit for buffer count
  2088				:	A symbol ECHO...causes tymsat echoing for terminals if >0.
  2089				:	A 256 bit table UMTOSS...indicates break messages not put in buffer.
  2090				
  2091				:	the following routines should be called by the user (link R0):
  2092				
  2093				:	IZFRONT	at initialization time, after calling IZT.
  2094				:	INPUT	from exec loop, to process input from ISIS.
  2095				:	OUTPUT	from exec loop, to process output to ISIS.
  2096				
  2097				:	These routines are also available:
  2098				
  2099				:	PTTOUT - Set timeout time for port
  2100				:		(R0 = # seconds, R1 = input buffer pointer, link on R4)
  2101				:	ZAPPRT - Send zapper to ring for port (R1 = port #, link on R5)
  2102				
  2103				:	The halfword array CHRLIM (by port) holds the input limits for
  2104				:	each port.  When IZBF is called, each entry is initialized to
  2105				:	MAXCHAR, but individual input limits may be changed afterwards.
  2106				:	When an input limit activation occurs, the user is given a chance
  2107				:	to empty the buffer.  If the buffer is still over the input limit
Page  10-4	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  2108				:	when the user code returns, backpressure is applied on that port.
  2109				
  2110				:	In addition, if the symbol MBUFER is defined and positive,
  2111				:	FRONT.LIB will be assembled to work with the microcode buffer
  2112				:	library.  The library MBUFER.LIB defines this symbol, so if it
  2113				:	is assembled before FRONT.LIB, the user will not have to define
  2114				:	it.  Note that the use of this library changes the buffer pointers
  2115				:	to be fullword rather than halfword pointers.
  2116				
  2117					GL	NPORT,MAXCHAR,ECHO,TISIS,BREAK,MBREAK,PROCESS,ACP,CHRLIM
  2118					GL	IZFRONT,INPUT,OUTPUT,ECHOFF,PTTOUT,ZAPPRT
  2119					GL	TOPUT,TORET,PORT
  2120					GL	GCI,WCI,BCT,BBELL,BELCOL
  2121				
  2122					MO	.,FRONT
  2123				
  2124	000794				SEG	A.DATA
  2125				
  2126					GL	CNTRL
  2127	000001				IF	\CNTRL
  2128	00028C			CNTRL	EQ	CNTRL!280	:Make sure zappers get acknowledged
  2129	000000				ELSE
  2130				CNTRL	EQ	80		:Zapper ack's on
  2131					EI
  2132				
  2133	000001			WAITZA	EQ	1		:Clean up on Zapper ack's
  2134				
  2135	000794			BREAK	HS	2*NPORT		:pointer to data break array
  2136	000818			MBREAK	HS	2*NPORT		:pointer to message break array
  2137	00089C			PROCESS HS      2*NPORT         :-> user supplied process data routine
  2138	000920			ATIME	HS	2*NPORT		:next time to activate user.
  2139	0009A4			CHRLIM	HS	NPORT		:Input char limit before backpressuring
  2140	0009E6			XLIMIT	BS	NPORT		:max number of data characters we can send at one time.
  2141	000A08			PORT	HS	1		:CURRENT PORT WE ARE PROCESSING
  2142	000A0A			BUFFER	HS	1		:CURRENT BUFFER INDEX WE ARE PROCESSING.
  2143	000A0C			SAVE	HS	20		:save registers here
  2144	000A4C			RETP	HS	2		:save return here.
  2145				
  2146	000003			NGRP	EQ	(NPORT+0F)/10	:number of port groups to process.
  2147	000A50			ACP	HS	NGRP		:active ports.
  2148	000A56			PTIME	HS	NGRP		:ports on activate timeout.
  2149	000A5C			TOISIS	HS	NGRP		:ports we can send data on.
  2150	000A62			FRISIS	HS	NGRP		:ports we have NOT backpressured.
  2151	000A68			DEM	HS	NGRP		:ports in defered echo mode.
  2152	000A6E			ECHOFF	HS	NGRP		:Ports in no-echo mode
  2153	000A74			OUTCRT	HS	NGRP		:Port has 'outbuilt' aux. circuit
  2154	000A7A			GBALL	HS	NGRP		:HAVE A GREEN-BALL FOR THESE PORTS
  2155	000A80			WTZA	HS	NGRP		:Expecting Zapper Ack to arrive
  2156	000A86			PRTSVC	HS	1		:PORT ELIGIBLE FOR SERVICE INDICATOR
  2157	000000				IF	\DCTFLG
  2158				DCT	WS	NBUF		:DATA COUNTS
  2159					EI
  2160				Page  10-5	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  2161				
  2162	010B3A				SEG	A.CODE		:THE CODE AND DATA AREA.
  2163				 
  2164				:	HANDY INDEXABLE HALFWORD BIT MASKS
  2165	010B3A	8000 4000 2000 	HMASK	HC	8000,4000,2000,1000,800,400,200,100,80,40,20,10,8,4,2,1
		1000 0800 0400 	
		0200 0100 0080 	
		0040 0020 0010 	
		0008 0004 0002 	
		0001 		
  2166				
  2167				
  2168				:	DEFAULT BREAK ARRAY (CARRIAGE RETURN ONLY)
  2169	010B5A	0004 0000 0000 	DEFAULT	HC	4,0,0		:C/R ONLY
  2170	010B60	0000 0000 0000 		HC	0,0,0
  2171	010B66	0000 0000 0004 		HC	0,0,4		:C/R ONLY
  2172	010B6C	0000 0000 0000 		HC	0,0,0
  2173	010B72	0000 0000 0000 		HC	0,0,0
  2174	010B78	0000 			HC	0
  2175				
  2176				:	-----	ISIS INTERFACE	-----
  2177				
  2178				:	BIT ARRAY TO IDENTIFY DATA MESSAGES
  2179	010B7A	7FFF FFFF FFFF 	BDATA	HC	07FFF,-1,-1	:00
  2180	010B80	FFFF FFFF FFFF 		HC	-1,-1,-1	:30
  2181	010B86	FFFF FFFF FFFF 		HC	-1,-1,-1	:60
  2182	010B8C	FFFC 0000 0000 		HC	0FFFC,0,0	:90
  2183	010B92	0000 0000 0000 		HC	0,0,0		:C0
  2184	010B98	0000 			HC	0		:F0
  2185				
  2186	010B9A	0000 0000 0000 	BCTL	HC	0,0,0		:00	BIT ARRAY TO IDENTIFY CONTROL MESSAGES REQUIRING
				** SPECIAL HANDLING
  2187	010BA0	0000 0000 0000 		HC	0,0,0		:30
  2188	010BA6	0000 0000 0000 		HC	0,0,0		:60
  2189	010BAC	0003 F000 3740 		HC	3,0F000,3740	:90  9E 9F A0 A1 A2 A3 B2 B3 B6 B7 B9
  2190	010BB2	0000 0000 0000 		HC	0,0,0		:C0
  2191	010BB8	0000 			HC	0		:F0
  2192				
  2193				
  2194	000001				IF	\WAITZA
  2195	000000				ELSE
  2196				WAITZA	EQ	0
  2197					EI
  2198				
  2199	000000				IF	\NOESC0
  2200	000001				ELSE
  2201	000000			NOESC0	EQ	0
  2202					EI
  2203				
  2204	000000				IF	\MBUFER
  2205	000001				ELSE
  2206	000000			MBUFER	EQ	0		:Default MBUFER to off.
  2207					EI
Page  10-6	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  2208				
  2209				Page  10-7	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  2210				
  2211	010BBA	00		LENGTH	BC	0		:MESSAGE LENGTH TABLE
  2212	00009D				RE	9D
  2213	010BBB	02 			BC	.-LENGTH+1
  2214					LIST	:DATA TEXT STRINGS
  2215	010C58	01			BC	1		: 9E	DETACH
  2216	010C59	01 			BC	1		: 9F	DISCONNECT
  2217	010C5A	01			BC	1		: A0	APPLY BACKPRESSURE
  2218	010C5B	01 			BC	1		: A1	RELEASE BACKPRESSURE
  2219	010C5C	01			BC	1		: A2	FLUSH FORWARD
  2220	010C5D	01 			BC	1		: A3	FLUSH BACKWARD
  2221	010C5E	01			BC	1		: A4	BLACK BALL
  2222	010C5F	01 			BC	1		: A5	GREY BALL
  2223	010C60	01			BC	1		: A6	ENTER "DEM"
  2224	010C61	01 			BC	1		: A7	LEAVE "DEM"
  2225	010C62	01			BC	1		: A8	ENTER "TRANSPARENCY"
  2226	010C63	01 			BC	1		: A9	LEAVE "TRANSPARENCY"
  2227	010C64	01			BC	1		: AA	GREEN BALL
  2228	010C65	01 			BC	1		: AB	RED BALL
  2229	010C66	01			BC	1		: AC	YELLOW BALL
  2230	010C67	01 			BC	1		: AD	ORANGE BALL
  2231	010C68	01			BC	1		: AE	"BREAK" DETECTED
  2232	010C69	01 			BC	1		: AF	"HANG UP"
  2233	010C6A	02			BC	2		: B0	QUERY TERMINAL PARAMETER
  2234	010C6B	03 			BC	3		: B1	SET TERMINAL PARAMETER
  2235	010C6C	04			BC	4		: B2	PSEUDO-NEEDLE
  2236	010C6D	02 			BC	2		: B3	LOGON CHARACTER
  2237	010C6E	02			BC	2		: B4	NORMAL LOGON STATUS
  2238	010C6F	02 			BC	2		: B5	LOGON FAILURE
  2239	010C70	08			BC	8		: B6	SUCCESSFUL LOGON FROM THIS PORT
  2240	010C71	06 			BC	6		: B7	ADDENDUM TO ACCOUNTING
  2241	010C72	01			BC	1		: B8	SUPER-"HANG UP"
  2242	010C73	02 			BC	2		: B9	TRANSMIT LIMIT
  2243	010C74	01			BC	1		: BA	Break end
  2244	010C75	01 			BC	1		: BB	Zapper acknowledgement
  2245	010C76	01			BC	1		: BC	ENTER Alternate Output Device Mode
  2246	010C77	01 			BC	1		: BD	LEAVE     "        "      "     "
  2247	010C78	02			BC	2		: BE	Zapper with Reason Code
  2248	010C79	01 			BC	1		: BF	SIIX Comand
  2249	010C7A	01			BC	1		: C0	TIIX Command
  2250				
  2251				Page  10-8	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  2252				
  2253				:		**INTERFACE DATA TYPES**
  2254				
  2255				
  2256	000000			NEDMSG	EQ	0		:NEEDLE
  2257	00009E			FIRST	EQ	9E		:FIRST MESSAGE IN LIST
  2258	00009E			DETMSG	EQ	9E		:DETACH MESSAGE
  2259	00009F			ZAPMSG	EQ	9F		:DISCONNECT MESSAGE
  2260	0000A0			NOSMSG	EQ	0A0		:APPLY BACK-PRESSURE
  2261	0000A1			SNDMSG	EQ	0A1		:RELEASE BACK-PRESSURE
  2262	0000A2			GOBMSG	EQ	0A2		:FLUSH OUTPUT
  2263	0000A3			BKGMSG	EQ	0A3		:FLUSH INPUT
  2264	0000A4			BLKMSG	EQ	0A4		:DATA LOST IN THIS DIRECTION
  2265	0000A5			GRYMSG	EQ	0A5		:DATA LOST IN OPPOSITE DIRECTION
  2266	0000A6			EDMMSG	EQ	0A6		:ENTER DEFERED ECHO MESSAGE
  2267	0000A7			LDMMSG	EQ	0A7		:LEAVE DEFERED ECHO MESSAGE
  2268	0000A8			ETMMSG	EQ	0A8		:ENTER TRANSPARENCY MODE
  2269	0000A9			LTMMSG	EQ	0A9		:LEAVE TRANSPARENCY MODE
  2270	0000AA			GBMSG	EQ	0AA		:GREEN BALL
  2271	0000AB			RBMSG	EQ	0AB		:RED BALL
  2272	0000AC			YBMSG	EQ	0AC		:YELLOW BALL
  2273	0000AD			OBMSG	EQ	0AD		:ORANGE BALL
  2274	0000AE			BRKMSG	EQ	0AE		:BREAK DETECTED
  2275	0000AF			HNGMSG	EQ	0AF		:HANG UP
  2276	0000B0			QTPMSG	EQ	0B0		:QUERY TERMINAL PARAMETER
  2277	0000B1			STPMSG	EQ	0B1		:SET TERMINAL PARAMETER
  2278	0000B2			PNDMSG	EQ	0B2		:PSEUDO NEEDLE
  2279	0000B3			NLOGCH	EQ	0B3		:NORMAL LOGON CHAR
  2280	0000B4			NLOGST	EQ	0B4		:NORMAL LOGON STATUS
  2281	0000B5			LOGFAL	EQ	0B5		:NORMAL LOGON STATUS
  2282	0000B6			LOGOK	EQ	0B6		:SUCCESSFUL NORMAL LOGON
  2283	0000B7			ADACTG	EQ	0B7		:ADDENDUM TO ACCOUNTING
  2284	0000B8			SHGMSG	EQ	0B8		:SUPER-HANG UP
  2285	0000B9			XMTLIM	EQ	0B9		:Transmit Limit
  2286	0000BA			BRKEND	EQ	0BA		:Break End
  2287	0000BB			ZAPACK	EQ	0BB		:Zapper Acknowledgement
  2288	0000BC			EAODM	EQ	0BC		:ENTER Alternate Output Device Mode
  2289	0000BD			LAODM	EQ	0BD		:LEAVE     "        "      "     "
  2290	0000BE			ZAPREA	EQ	0BE		:Zapper with Reason Code
  2291	0000BF			SIIX	EQ	0BF		:SIIX Command
  2292	0000C0			TIIX	EQ	0C0		:TIIX Command
  2293	0000C0			MAXTYP	EQ	0C0		:MAXIMUM TYPE DEFINED
  2294				Page  10-9	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  2295				
  2296				:	INPUT FROM ISIS
  2297	010C7C	5000 4000 0A4C 	INPUT   ST      R0,RETP,,       :Save return
  2298	010C82	4140 4001 0000 	INPUT1	JAL	R4,LOOK,,	:IS THERE ANYTHING THERE?
  2299	010C88	4300 8648 		J	RET		:NORMAL RETURN...JUST EXIT
  2300	010C8C	08C1 			LR	R12,R1		:SET BREAK # 0, EXCEPT FOR PORT 0
  2301	010C8E	4230 805A 		JN	INPUT2		:SKIP IF NOT PORT 0
  2302	010C92	4140 4001 0036 		JAL	R4,GETH,,	:PORT 0---SPECIAL
  2303	010C98	9450 			EXBR	R5,R0		:GET CODE
  2304	010C9A	9355 			LBR	R5,R5
  2305	010C9C	0855 			LR	R5,R5		:CHECK FOR MESSAGE 0
  2306	010C9E	4330 8030 		JE	SPEC4		:IGNOR IF SO
  2307	010CA2	D375 8036 		LB	R7,SPECL,R5	:GET MESSAGE REMAINDER LENGTH
  2308	010CA6	C370 0080 		THI	R7,80		:80 FLAG MEANS WE HAVE NO BUSINESS GETTING THESE...
  2309	010CAA	2333 			JEFS	SPEC0
  2310	010CAC	41A0 F59A 		JAL	R10,CRASH	:CRASH IF WE DO
  2311				
  2312	010CB0	0850 		SPEC0	LR	R5,R0		:COPY MESSAGE
  2313	010CB2	4160 8610 		JAL	R6,PAIR		:ELSE PLACE MESSAGE TYPE IN BUFFER 0
  2314	010CB6	2771 		SPEC1	SIS	R7,1		:ANY MORE
  2315	010CB8	232A 			JLEFS	SPEC3
  2316	010CBA	4140 4001 0026 		JAL	R4,GETCH,,	:YES
  2317	010CC0	2133 			JNFS	SPEC2		:TEST IF CHARACTER SHOULD BE ESCAPED
  2318	010CC2	4140 FB62 		JAL	R4,WCI		:ESCAPE IT
  2319	010CC6	4140 FB5E 	SPEC2	JAL	R4,WCI
  2320	010CCA	220A 			JBS	SPEC1
  2321	010CCC	2505 		SPEC3	LCS	R0,5		:DONE...SET PORT 0 MESSAGE CODE
  2322	010CCE	4140 860A 		JAL	R4,ACTIV
  2323	010CD2	4140 4001 0058 	SPEC4	JAL	R4,ELIR,,	:DONE...END LOGICAL INPUT RECORD
  2324	010CD8	4300 FFA6 		J	INPUT1		:AND CONTINUE
  2325				
  2326	010CDC	0000 0186 8885 	SPECL	BC	0,0,1,86,88,85,5,88	:LENGTH OF SPECIAL (PORT 0) MESSAGES
		0588 		
  2327	010CE4	8804 8704 8780 		BC	88,4,87,4,87,80,80,80	:"80" MEANS TO CRASH
		8080 		
  2328				
  2329	010CEC	4010 4000 0A08 	INPUT2  STH     R1,PORT,,       :Save ISIS port number
  2330	010CF2	0891 			LR	R9,R1		:And copy out of the way
  2331	010CF4	1112 			SLLS	R1,2		:Convert to fullword pointer
  2332	010CF6	0881 			LR	R8,R1		:Copy
  2333	000000			    IF MBUFER
  2334					SLLS	R1,1		:CONVERT TO BUFFER NUMBER
  2335	000001			    ELSE			:(Coincidence - FW pointer = buffer #)
  2336				    EI
  2337	010CF8	4010 4000 0A0A 	        STH     R1,BUFFER,,
  2338	010CFE	4140 4001 0026 		JAL	R4,GETCH,,	:SKIP OVER MESSAGE TYPE
  2339	010D04	7400 FE72 		TBT	R0,BDATA	:IS THIS DATA MESSAGE?
  2340	010D08	4330 80B4 		JE	INCONT		:NO...SKIP TO PROCESS CONTROL
  2341				
  2342				:	TEXT MESSAGE...PASS TO BUFFER, ACTIVATE IF TOO MANY CHARS, BREAK CHAR
  2343	010D0C	0850 			LR	R5,R0		:YES...SAVE COUNT OF CHARS
  2344	010D0E	58A8 4000 0794 	        L       R10,BREAK,R8,   :GET POINTER TO PORT'S BREAK TABLE
  2345	010D14	2136 			JNFS	INDAT1		:SKIP IF NOT NULL
Page  10-10	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  2346	010D16	E6A0 FE40 		LA	R10,DEFAULT	:ELSE SET DEFAULT
  2347	010D1A	50A8 4000 0794 		ST	R10,BREAK,R8,
  2348				
  2349	010D20	4140 4001 0026 	INDAT1	JAL	R4,GETCH,,
  2350	010D26	0800 			LR	R0,R0		:GET AND TEST A CHAR
  2351	010D28	2133 			JNFS	INDAT2		:SKIP IF NOT NULL
  2352	000000				IF NOESC0
  2353	000001				ELSE
  2354	010D2A	4140 FAFA 		JAL	R4,WCI		:ESCAPE ALL ZEROS
  2355					EI
  2356	010D2E	4140 FAF6 	INDAT2	JAL	R4,WCI		:COPY THE CHAR TO BUFFER
  2357	000000				IF	\DCTFLG
  2358					LIS	R2,1
  2359				        AHM     R2,DCT,R1,      :Update data counter
  2360					EI
  2361				
  2362	010D32	7490 4000 0A6E 	        TBT     R9,ECHOFF,,     :No echo mode?
  2363	010D38	213D 			JNFS	INDAT4		:Yes, never echo
  2364				
  2365	010D3A	7490 4000 0A68 	        TBT     R9,DEM,,        :Are we to do echoing?
  2366	010D40	2339 			JEFS	INDAT4		:SKIP IF NOT
  2367	000000			    IF MBUFER
  2368					AIS	R1,4		:SET OUTPUT BUFFER
  2369	000001			    ELSE
  2370	010D42	2612 			AIS	R1,2		:SET OUTPUT BUFFER
  2371				    EI
  2372	010D44	4140 FAE0 		JAL	R4,WCI
  2373	010D48	0800 			LR	R0,R0		:IS THE ECHOED CHAR TO BE ESCAPED?
  2374	010D4A	2133 			JNFS	INDAT3		:SKIP IF NOT
  2375	010D4C	4140 FAD8 		JAL	R4,WCI		:ELSE DO SO
  2376				INDAT3
  2377	000000			    IF MBUFER
  2378					SIS	R1,4		:REVERT TO INPUT BUFFER INDEX
  2379	000001			    ELSE
  2380	010D50	2712 			SIS	R1,2		:REVERT TO INPUT BUFFER INDEX
  2381				    EI
  2382	010D52	740A 0000 	INDAT4	TBT	R0,0,R10	:CHECK IF BREAK CHAR
  2383	010D56	2335 			JEFS	INDAT5
  2384	010D58	0820 			LR	R2,R0		:OK...WE'VE GOT A BREAK CHAR...PASS IT ON IN R2
  2385	010D5A	2400 			LIS	R0,0		:SET BREAK ACTIVATION CODE
  2386	010D5C	4140 857C 		JAL	R4,ACTIV	:GO ACTIVATE JOB
  2387	010D60	2751 		INDAT5	SIS	R5,1
  2388	010D62	4220 FFBA 		JG	INDAT1		:REPEAT FOR ALL CHARS
  2389	010D66	4140 4001 0058 		JAL	R4,ELIR,,	:END LOGICAL INPUT RECORD
  2390	000000				IF	\DCTFLG
  2391				        LHL     R0,DCT,R1,      :Check Buffer size
  2392	000001				ELSE
  2393	010D6C	7301 01FE 		LHL	R0,BCT,R1
  2394					EI
  2395	010D70	7349 4900 0003 		LHL	R4,BELCOL,R9,R9	:Check bell column #
  2396	010D76	4330 801E 		JE	INDAT6		:Skip if bell column hasn't been set
  2397	010D7A	0904 			CR	R0,R4		:Compare the dct with bell column #
  2398	010D7C	4210 8018 		JL	INDAT6
Page  10-11	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  2399	010D80	0820 			LR	R2,R0		:Save BCT/DCT
  2400	000000			    IF MBUFER
  2401					AIS	R1,4		:Point to output buffer
  2402	000001			    ELSE
  2403	010D82	2612 			AIS	R1,2
  2404				    EI
  2405	010D84	C800 0000 		LHI	R0,BBELL
  2406	010D88	4140 FA9C 		JAL	R4,WCI		:Send it
  2407	000000			    IF MBUFER
  2408					SIS	R1,4		:Point back to input buffer
  2409	000001			    ELSE
  2410	010D8C	2712 			SIS	R1,2
  2411				    EI
  2412	010D8E	2400 			LIS	R0,0
  2413	010D90	4009 4900 0107 		STH	R0,BELCOL,R9,R9
  2414	010D96	0802 			LR	R0,R2		:Copy counter back
  2415	010D98	4509 4900 09A4 	INDAT6	CLH	R0,CHRLIM,R9,R9	:AGAINST LIMIT FOR PORT
  2416	010D9E	4210 FEE0 		JL	INPUT1		:CONTINUE IF FULL
  2417	010DA2	2502 			LCS	R0,2		:IF EXCEEDED, BREAK NOW
  2418	010DA4	4140 8534 		JAL	R4,ACTIV	:ACTIVATE PORT PROCESS..CODE -2
  2419	000000				IF	\DCTFLG
  2420				        LHL     R0,DCT,R1,      :Get data count
  2421	000001				ELSE
  2422	010DA8	7301 01FE 		LHL	R0,BCT,R1	:Now get buffer count
  2423					EI
  2424	010DAC	4509 4900 09A4 		CLH	R0,CHRLIM,R9,R9	:Still full?
  2425	010DB2	4210 FECC 		JL	INPUT1		:No, don't backpressure
  2426	010DB6	7690 4000 0A62 	        RBT     R9,FRISIS,,     :Set backpressure indicator
  2427	010DBC	4300 FEC2 		J	INPUT1		:THEN PROCESS ANOTHER RECORD
  2428				
  2429				:	NOT DATA...PROCESS IT
  2430	010DC0	0830 		INCONT	LR	R3,R0		:COPY MESSAGE TYPE
  2431	010DC2	4230 80B4 		JN	INCON		:SKIP IF NOT NEEDLE
  2432				
  2433				:	Handle needle that has arrived
  2434	010DC6	7590 4000 0A50 	        SBT     R9,ACP,,        :Set now, host may reset to reject needle
  2435	010DCC	2333 			JEFS	NEED2
  2436	010DCE	41A0 F478 		JAL	R10,CRASH	:It was already set, impossible
  2437				NEED2
  2438	010DD2	4140 4001 0026 		JAL	R4,GETCH,,	:NEEDLE...SKIP LENGTH
  2439	010DD8	4140 4001 0046 		JAL	R4,GETW,,
  2440	010DDE	0850 			LR	R5,R0		:INVOICE NUMBER
  2441	010DE0	4140 4001 0036 		JAL	R4,GETH,,
  2442	010DE6	0860 			LR	R6,R0		:DESTINATION HOST
  2443	010DE8	4140 4001 0036 		JAL	R4,GETH,,
  2444	010DEE	0870 			LR	R7,R0		:SOURCE NODE
  2445	010DF0	4140 4001 0036 		JAL	R4,GETH,,
  2446	010DF6	0880 			LR	R8,R0		:SOURCE HOST
  2447	010DF8	4140 4001 0036 		JAL	R4,GETH,,
  2448	010DFE	0890 			LR	R9,R0		:SOURCE PORT
  2449	010E00	4140 4001 0046 		JAL	R4,GETW,,	:EXPANSION
  2450	010E06	4140 4001 0036 		JAL	R4,GETH,,
  2451	010E0C	08A0 			LR	R10,R0		:DIALECT
Page  10-12	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  2452	010E0E	4140 4001 0026 		JAL	R4,GETCH,,
  2453	010E14	08B0 			LR	R11,R0		:TID
  2454	010E16	4140 4001 0026 		JAL	R4,GETCH,,
  2455	010E1C	08C0 			LR	R12,R0		:CHARACTERS IN USER NAME
  2456	010E1E	08D0 			LR	R13,R0		:SAVE A COPY FOR US TO COUNT WITH
  2457	010E20	4140 4001 0026 	NEEDLE	JAL	R4,GETCH,,
  2458	010E26	4140 F9FE 		JAL	R4,WCI		:MOVE A CHARACTER
  2459	010E2A	27D1 			SIS	R13,1
  2460	010E2C	2026 			JGBS	NEEDLE		:REPEAT UNTIL DONE
  2461	010E2E	4140 4001 0058 		JAL	R4,ELIR,,	:END LOGICAL INPUT RECORD
  2462	010E34	2501 			LCS	R0,1		:SET NEEDLE CODE..-1
  2463	010E36	4140 84A2 		JAL	R4,ACTIV	:ACTIVATE USER CODE
  2464				:	host wants circuit?
  2465	010E3A	7310 4000 0A08 	        LHL     R1,PORT,,
  2466	010E40	7410 4000 0A50 	        TBT     R1,ACP,,        :Still set?
  2467	010E46	4330 801A 		JE	NEDZAP		:no, zap
  2468				
  2469	000000			   IF	ECHO
  2470				:		TYMSAT SHOULD ECHO
  2471					THI	R11,1F		:CHECK FOR TERMINAL
  2472					JE	NEED1		:SKIP IF NOT
  2473					THI	R11,20		:CHECK IF HALF DUPLEX TID
  2474					JNFS	NEED0		:DON'T SET DEM IF SO
  2475				        SBT     R1,DEM,,
  2476				NEED0   RBT     R1,GBALL,,      :Set to correct initial state
  2477					LIS	R0,5
  2478					LHI	R2,STPMSG
  2479					JAL	R4,SLOR,,	:SET ECHO ON/OFF
  2480					LIS	R0,0
  2481					JAL	R4,PUTCH,,
  2482				
  2483				  IF	INECHO			:Initial state should be No-Echo
  2484					LIS	R0,0		:Echo Off
  2485				  ELSE
  2486					LIS	R0,1		:Echo On
  2487				  EI	: INECHO
  2488				
  2489					JAL	R4,PUTCH,,
  2490					JAL	R4,ELOR,,
  2491				   EI	:ECHO
  2492				
  2493	010E4A	C800 009D 	NEED1	LHI	R0,FIRST-1	:SET UP TRANSMIT LIMIT FOR PORT
  2494	010E4E	D201 4000 09E6 	        STB     R0,XLIMIT,R1,
  2495	010E54	7510 4000 0A5C 	        SBT     R1,TOISIS,,     :Clear backpressures
  2496	010E5A	7510 4000 0A62 	        SBT     R1,FRISIS,,
  2497	010E60	4300 FE1E 		J	INPUT1		:GO BACK FOR MORE INPUT
  2498				
  2499	010E64	2403 		NEDZAP	LIS	R0,3		:zap length
  2500	010E66	C820 009F 		LHI	R2,ZAPMSG
  2501	010E6A	4140 4001 011A 		JAL	R4,SLOR,,
  2502	010E70	4140 4001 01A2 		JAL	R4,ELOR,,
  2503	010E76	4300 FE08 		J	INPUT1
  2504				
Page  10-13	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  2505				:	NOT A NEEDLE...DOES USER WANT TO PROCESS MESSAGE?
  2506				INCON
  2507	010E7A	58A8 4000 0818 	        L       R10,MBREAK,R8,  :R10 -> Message Break table
  2508	010E80	4330 806A 		JE	INCTL		:IGNORE IF NULL
  2509	010E84	740A 0000 		TBT	R0,0,R10	:DOES HE WANT TO HANDLE IT?
  2510	010E88	4330 8062 		JE	INCTL		:NO...WE'LL DO IT
  2511	010E8C	0850 			LR	R5,R0		:HE WANTS TO
  2512	010E8E	7341 01FE 		LHL	R4,BCT,R1	:CHECK IF BUFFER IS EMPTY
  2513	010E92	2334 			JEFS	INCON1		:SKIP IF SO
  2514	010E94	2503 			LCS	R0,3		:ELSE GIVE A CHANCE TO FLUSH IT
  2515	010E96	4140 8442 		JAL	R4,ACTIV
  2516				INCON1
  2517	000000			   IF   \UMTOSS
  2518					LA	R10,UMTOTB,,
  2519					TBT	R5,0,R10	:should we put message in buffer?
  2520					JN	INCON5		:Nope
  2521				   EI
  2522	010E9A	4160 8428 		JAL	R6,PAIR		:FIRST PLACE ESCAPED MESSAGE TYPE
  2523	010E9E	D375 FD18 		LB	R7,LENGTH,R5
  2524	010EA2	2771 		INCON2	SIS	R7,1
  2525	010EA4	2327 			JLEFS	INCON3		:SKIP WHEN DONE
  2526	010EA6	4140 4001 0026 		JAL	R4,GETCH,,
  2527	010EAC	4140 F978 		JAL	R4,WCI		:COPY A CHAR
  2528	010EB0	2207 			JBS	INCON2		:MOVE AS MANY AS NECESSARY
  2529	010EB2	0805 		INCON3	LR	R0,R5		:SET MESSAGE TYPE (CODE>0)
  2530	010EB4	4140 8424 		JAL	R4,ACTIV	:ACTIVATE USER
  2531	010EB8	7450 FCDE 		TBT	R5,BCTL		:DO WE WANT TO PROCESS THIS TOO?
  2532	010EBC	2136 			JNFS	INCON4		:SKIP IF SO
  2533	010EBE	4140 4001 0058 		JAL	R4,ELIR,,	:ELSE END LOGICAL INPUT RECORD
  2534	010EC4	4300 FDBA 		J	INPUT1		:THEN GO BACK FOR ANOTHER RECORD
  2535				
  2536	010EC8	4140 4001 0000 	INCON4	JAL	R4,LOOK,,	:WE WANT TO LOOK TOO...BACK UP
  2537	010ECE	41A0 F378 		JAL	R10,CRASH	:ERROR IF WE TAKE THIS RETURN
  2538	010ED2	4140 4001 0026 		JAL	R4,GETCH,,	:GET THE MESSAGE AGAIN
  2539	010ED8	0830 			LR	R3,R0		:COPY IT
  2540	010EDA	230A 			JFS	INCTL
  2541				
  2542	010EDC	D375 FCDA 	INCON5	LB	R7,LENGTH,R5
  2543	010EE0	2771 		INCON6	SIS	R7,1
  2544	010EE2	4320 FFCC 		JLE	INCON3
  2545	010EE6	4140 4001 0026 		JAL	R4,GETCH,,
  2546	010EEC	2206 			JBS	INCON6
  2547				
  2548				
  2549				Page  10-14	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  2550				
  2551				:	PROCESS THE MESSAGE OURSELF
  2552	010EEE	9132 		INCTL	SLHLS	R3,2		:MAKE A WORD INDEX
  2553	010EF0	4303 FD88 		J	IFAN-(4*FIRST),R3	:AND GO PROCESS MESSAGE
  2554				
  2555				:	INPUT FANOUT FOR SPECIAL PROCESSING
  2556	010EF4	4300 8090 	IFAN	J	ZAP		:9E - ZAPPER
  2557	010EF8	4300 808C 		J	ZAP		:9F - DISCONNECT
  2558	010EFC	4300 80E4 		J	NOSEND		:A0 - APPLY BACK-PRESSURE
  2559	010F00	4300 80F0 		J	RESEND		:A1 - RELEASE BACK-PRESSURE
  2560	010F04	4300 80FC 		J	GOBBLE		:A2 - FLUSH FORWARD
  2561	010F08	4300 8112 		J	FLBACK		:A3 - FLUSH BACKWARD
  2562	010F0C	4300 81AC 		J	OB		:A4 - DATA LOST IN THIS DIRECTION
  2563	010F10	4300 8064 		J	TOSS		:A5 - DATA LOST IN OTHER DIRECTION
  2564	010F14	4300 812E 		J	EDEM		:A6 - ENTER DEFERED ECHO MODE
  2565	010F18	4300 8142 		J	LDEM		:A7 - LEAVE DEFERED ECHO MODE
  2566	010F1C	4300 8058 		J	TOSS		:A8 - ENTER TRANSPARENCY
  2567	010F20	4300 8054 		J	TOSS		:A9 - LEAVE TRANSPARENCY
  2568	010F24	4300 8144 		J	GB		:AA - GREEN BALL
  2569	010F28	4300 8172 		J	RB		:AB - RED BALL
  2570	010F2C	4300 818C 		J	OB		:AC - YELLOW BALL
  2571	010F30	4300 8044 		J	TOSS		:AD - ORANGE BALL
  2572	010F34	4300 8040 		J	TOSS		:AE - BREAK DETECTED
  2573	010F38	4300 803C 		J	TOSS		:AF - HANG UP
  2574	010F3C	4300 8038 		J	TOSS		:B0 - QUERY TERMINAL PARAMETER
  2575	010F40	4300 81B0 		J	SETTP		:B1 - SET TERMINAL PARAMETER
  2576	010F44	4300 8030 		J	TOSS		:B2 - PSEUDO NEEDLE
  2577	010F48	41A0 F2FE 		JAL	R10,CRASH	:B3 - LOGON CHAR---WE SHOULDN'T GET THESE!
  2578	010F4C	4300 8028 		J	TOSS		:B4 - NORMAL LOGON STATUS
  2579	010F50	4300 8024 		J	TOSS		:B5 - LOGON FAILURE
  2580	010F54	4300 8208 		J	B6MSG		:B6 - Succesful circuit build
  2581	010F58	41A0 F2EE 		JAL	R10,CRASH	:B7 - ADDENDUM TO ACCOUNTING---WE SHOULDN'T GET THESE
  2582	010F5C	4300 8018 		J	TOSS		:B8 - SUPER-HANG UP
  2583	010F60	4300 8172 		J	XLIM		:B9 - TRANSMIT LIMIT
  2584	010F64	4300 8010 		J	TOSS		:BA - Break End
  2585	010F68	4300 8066 		J	ZA		:BB - Zapper Ack
  2586	010F6C	4300 8008 		J	TOSS		:BC - Enter Alternate Output Device Mode
  2587	010F70	4300 8004 		J	TOSS		:BD - Leave     "        "      "     "
  2588	010F74	4300 821E 		J	ZR		:BE - Zapper with Reason Code
  2589				
  2590				
  2591				Page  10-15	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  2592				
  2593				:	TOSS A MESSAGE
  2594	010F78	D302 FC3E 	TOSS	LB	R0,LENGTH,R2	:PICK UP MESSAGE LENGTH
  2595	010F7C	2701 			SIS	R0,1		:WE'VE ALREADY GOTTEN MESSAGE TYPE
  2596	010F7E	4140 4001 0056 		JAL	R4,FLUSH,,	:DELETE REMAINDER OF MESSAGE
  2597	010F84	4300 FCFA 		J	INPUT1		:AND CONTINUE
  2598				
  2599				:	DISCONNECT
  2600	010F88	4140 4001 0058 	ZAP	JAL	R4,ELIR,,	:END LOGICAL INPUT RECORD
  2601	010F8E	7310 4000 0A0A 	        LHL     R1,BUFFER,,     :Get buffer number
  2602	010F94	4140 FAA8 		JAL	R4,EMPTY	:EMPTY INPUT BUFFER
  2603	000000			    IF MBUFER
  2604					AIS	R1,4
  2605	000001			    ELSE
  2606	010F98	2612 			AIS	R1,2
  2607				    EI
  2608	010F9A	4140 FAA2 		JAL	R4,EMPTY	:EMPTY OUTPUT BUFFER
  2609	010F9E	7690 4000 0A50 	        RBT     R9,ACP,,        :Set port not active
  2610	010FA4	7690 4000 0A68 	        RBT     R9,DEM,,        :Not in DEM
  2611	010FAA	7690 4000 0A74 	        RBT     R9,OUTCRT,,     :No longer 'outbuilt'
  2612	010FB0	7690 4000 0A80 	        RBT     R9,WTZA,,       :Not waiting for Zap Ack
  2613	010FB6	7690 4000 0A7A 	        RBT     R9,GBALL,,      :No green balls
  2614	010FBC	7690 4000 0A56 	        RBT     R9,PTIME,,      :Turn off timeout
  2615	010FC2	7590 4000 0A5C 	        SBT     R9,TOISIS,,     :Clear backpressure
  2616	010FC8	7590 4000 0A62 	        SBT     R9,FRISIS,,
  2617	010FCE	4300 FCB0 		J	INPUT1
  2618				
  2619				: Zapper Acknowledgement
  2620				ZA
  2621	010FD2	7690 4000 0A80 	        RBT     R9,WTZA,,       :Reset ZapAck wait bit
  2622	010FD8	4230 8004 		JN	ZA1		:We were expecting it
  2623	010FDC	4300 FF98 		J	TOSS		:Could crash here
  2624				ZA1
  2625	010FE0	4300 FFA4 		J	ZAP		:Do Zap stuff now
  2626				Page  10-16	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  2627				
  2628				:	APPLY BACKPRESSURE
  2629	010FE4	4140 4001 0058 	NOSEND	JAL	R4,ELIR,,	:END LOGICAL INPUT RECORD
  2630	010FEA	7690 4000 0A5C 	        RBT     R9,TOISIS,,
  2631	010FF0	4300 FC8E 		J	INPUT1		:AND CONTINUE
  2632				
  2633				:	RELEASE BACKPRESSURE
  2634	010FF4	4140 4001 0058 	RESEND	JAL	R4,ELIR,,	:END LOGICAL INPUT RECORD
  2635	010FFA	7590 4000 0A5C 	        SBT     R9,TOISIS,,     :Turn it on for port
  2636	011000	4300 FC7E 		J	INPUT1
  2637				
  2638				:	GOBBLER
  2639	011004	4140 4001 0058 	GOBBLE	JAL	R4,ELIR,,	:END LOGICAL INPUT RECORD
  2640	01100A	7310 4000 0A0A 	        LHL     R1,BUFFER,,
  2641	011010	4140 FA2C 		JAL	R4,EMPTY	:EMPTY INPUT BUFFER
  2642	011014	7590 4000 0A62 	        SBT     R9,FRISIS,,     :Check if we've applied backpressure
  2643	01101A	4300 FC64 		J	INPUT1		:AND CONTINUE
  2644				
  2645				:	FLUSH BACKWARD
  2646	01101E	4140 F036 	FLBACK	JAL	R4,ELIR		:END LOGICAL INPUT RECORD
  2647	011022	7310 4000 0A0A 	        LHL     R1,BUFFER,,
  2648	000000			    IF MBUFER
  2649					AIS	R1,4		:COMPUTE OUTPUT BUFFER
  2650	000001			    ELSE
  2651	011028	2612 			AIS	R1,2		:COMPUTE OUTPUT BUFFER
  2652				    EI
  2653	01102A	4140 FA12 		JAL	R4,EMPTY	:EMPTY IT
  2654	01102E	2403 			LIS	R0,3
  2655	011030	0819 			LR	R1,R9		:Port #
  2656	011032	C820 00A2 		LHI	R2,GOBMSG	:SEND GOBBLER IN OTHER DIRECTION
  2657	011036	4140 4001 011A 		JAL	R4,SLOR,,	:START LOGICAL OUTPUT RECORD
  2658	01103C	4140 4001 01A2 		JAL	R4,ELOR,,	:END LOGICAL OUTPUT RECORD
  2659	011042	4300 FC3C 		J	INPUT1		:DO ANOTHER MESSAGE
  2660				
  2661				:	ENTER DEM
  2662	011046	4140 F00E 	EDEM	JAL	R4,ELIR		:END LOGICAL INPUT RECORD
  2663	01104A	7490 4000 0A74 	        TBT     R9,OUTCRT,,     :Acting as remote?
  2664	011050	4230 FC2E 		JN	INPUT1		:YES, SHOULDN'T GET EDEM
  2665	011054	7590 4000 0A68 	        SBT     R9,DEM,,        :Set DEM
  2666	01105A	4300 FC24 		J	INPUT1		:AND DO ANOTHER
  2667				
  2668				:	LEAVE DEM
  2669	01105E	4140 EFF6 	LDEM	JAL	R4,ELIR		:END LOGICAL INPUT RECORD
  2670	011062	7690 4000 0A68 	        RBT     R9,DEM,,        :Clear DEM
  2671	011068	4300 FC16 		J	INPUT1		:AND DO ANOTHER
  2672				
  2673				:	GREEN BALL
  2674	01106C	4140 EFE8 	GB	JAL	R4,ELIR		:END LOGICAL INPUT RECORD
  2675	011070	0819 			LR	R1,R9		:GET PORT NUMBER
  2676	011072	7320 4000 0A0A 	        LHL     R2,BUFFER,,     :Get buffer number
  2677	000000			    IF MBUFER
  2678					LHL	R0,BCT+4,R2	:CHECK IF OUTPUT BUFFER IS EMPTY
  2679	000001			    ELSE
Page  10-17	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  2680	011078	7302 0200 		LHL	R0,BCT+2,R2	:CHECK IF OUTPUT BUFFER IS EMPTY
  2681				    EI
  2682	01107C	2336 			JEFS	GB1		:SKIP IF SO
  2683	01107E	7510 4000 0A7A 	        SBT     R1,GBALL,,      :Not empty ... set flag
  2684	011084	4300 FBFA 		J	INPUT1
  2685	011088	2403 		GB1	LIS	R0,3		:EMPTY...RETURN GREEN BALL
  2686	01108A	C820 00AA 		LHI	R2,GBMSG
  2687	01108E	4140 4001 011A 		JAL	R4,SLOR,,
  2688	011094	4140 4001 01A2 		JAL	R4,ELOR,,	:SEND GREEN BALL BACK
  2689	01109A	4300 FBE4 		J	INPUT1
  2690				
  2691				:	RED BALL
  2692	01109E	4140 EFB6 	RB	JAL	R4,ELIR		:END LOGICAL INPUT RECORD
  2693	0110A2	0819 			LR	R1,R9		:GET PORT NUMBER
  2694	0110A4	7610 4000 0A7A 	        RBT     R1,GBALL,,      :Flush any pending Green Ball
  2695	0110AA	2403 			LIS	R0,3
  2696	0110AC	4140 4001 011A 		JAL	R4,SLOR,,	:Reflect Red Ball
  2697	0110B2	4140 4001 01A2 		JAL	R4,ELOR,,
  2698	0110B8	4300 FBC6 		J	INPUT1		:AND PROCESS NEXT MESSAGE
  2699				
  2700				:	ORANGE (OR BLACK) BALL
  2701	0110BC	4140 EF98 	OB	JAL	R4,ELIR		:END LOGICAL INPUT RECORD
  2702	0110C0	2403 			LIS	R0,3
  2703	0110C2	0819 			LR	R1,R9		:GET PORT NUMBER
  2704	0110C4	2621 			AIS	R2,1		:SET OTHER BALL OF PAIR
  2705	0110C6	4140 4001 011A 		JAL	R4,SLOR,,
  2706	0110CC	4140 4001 01A2 		JAL	R4,ELOR,,	:SEND IT BACK
  2707	0110D2	4300 FBAC 		J	INPUT1		:AND CONTINUE
  2708				
  2709				:	TRANSMIT LIMIT
  2710	0110D6	4140 EF4C 	XLIM	JAL	R4,GETCH		:GET RESTRICTION
  2711	0110DA	4140 EF7A 		JAL	R4,ELIR		:END LOGICAL INPUT RECORD
  2712	0110DE	9300 			LBR	R0,R0		:EXTRACT VALUE
  2713	0110E0	C500 009D 		CLHI	R0,FIRST-1	:RANGE CHECK
  2714	0110E4	2113 			JLFS	XLIM1
  2715	0110E6	C800 009D 		LHI	R0,FIRST-1
  2716	0110EA	D209 4000 09E6 	XLIM1   STB     R0,XLIMIT,R9,   :Set up restriction
  2717	0110F0	4300 FB8E 		J	INPUT1
  2718				
  2719				:	Set Terminal Parameters
  2720	0110F4	0819 		SETTP	LR	R1,R9		:Get port #
  2721	0110F6	7410 4000 0A74 	        TBT     R1,OUTCRT,,     :Should we act like a remote ?
  2722	0110FC	4230 8038 		JN	SETTP3		:Yes, go bounce the B1 back
  2723	011100	4140 EF22 		JAL	R4,GETCH	:Get B1 use code
  2724	011104	0820 			LR	R2,R0		:save it
  2725	011106	4140 EF1C 		JAL	R4,GETCH	:get "value"
  2726	01110A	4140 EF4A 		JAL	R4,ELIR		:End input record
  2727	01110E	0822 			LR	R2,R2		:This is echo control msg ?
  2728	011110	4230 FB6E 		JN	INPUT1		:No, do nothing
  2729	011114	0800 			LR	R0,R0		:echo OFF ?
  2730	011116	2339 			JEFS	SETTP1		:OFF, jump
  2731	011118	7510 4000 0A68 	        SBT     R1,DEM,,        :echo ON starts in DEM by convention
  2732	01111E	7610 4000 0A6E 	        RBT     R1,ECHOFF,,
Page  10-18	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  2733	011124	4300 FB5A 		J	INPUT1
  2734	011128	7610 4000 0A68 	SETTP1  RBT     R1,DEM,,
  2735	01112E	7510 4000 0A6E 	        SBT     R1,ECHOFF,,     :echo OFF
  2736	011134	4300 FB4A 		J	INPUT1
  2737				
  2738	011138	2405 		SETTP3	LIS	R0,5		:length of B1
  2739	01113A	C820 00B1 		LHI	R2,STPMSG	:B1 code
  2740	01113E	4140 EFD8 		JAL	R4,SLOR
  2741	011142	4140 EEE0 		JAL	R4,GETCH
  2742	011146	4140 F00A 		JAL	R4,PUTCH	:type code
  2743	01114A	4140 EED8 		JAL	R4,GETCH
  2744	01114E	4140 EF06 		JAL	R4,ELIR
  2745	011152	4140 EFFE 		JAL	R4,PUTCH	: "value"
  2746	011156	4140 4001 01A2 		JAL	R4,ELOR,,	: reflect the B1
  2747	01115C	4300 FB22 		J	INPUT1
  2748				
  2749				:	B6 message - mark this as circuit built out
  2750	011160	7590 4000 0A74 	B6MSG   SBT     R9,OUTCRT,,
  2751	011166	7590 4000 0A6E 	        SBT     R9,ECHOFF,,     :Enforce no echoing
  2752	01116C	7690 4000 0A68 	        RBT     R9,DEM,,
  2753	011172	7590 4000 0A5C 	        SBT     R9,TOISIS,,     :Clear back-pressures
  2754	011178	7590 4000 0A62 	        SBT     R9,FRISIS,,
  2755	01117E	C800 009D 		LHI	R0,FIRST-1	:port Xmit limit
  2756	011182	D209 4000 09E6 	        STB     R0,XLIMIT,R9,
  2757	011188	7590 4000 0A50 	        SBT     R9,ACP,,        :Set, test port active
  2758	01118E	4330 FDE6 		JE	TOSS
  2759	011192	41A0 F0B4 		JAL	R10,CRASH	:Port already active - gross error
  2760				
  2761				
  2762				:		Zapper with Reason Code - treat same as zapper except eat extra byte
  2763				ZR
  2764	011196	4140 EE8C 		JAL	R4,GETCH	:Pick up reason code
  2765	01119A	4300 FDEA 		J	ZAP		:treat as zapper
  2766				Page  10-19	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  2767				
  2768				:	OUTPUT TO ISIS
  2769				
  2770	01119E	5000 4000 0A4C 	OUTPUT  ST      R0,RETP,,
  2771	0111A4	C8C0 0004 		LHI	R12,(NGRP-1)*2
  2772	0111A8	2511 		OUT0	LCS	R1,1		:SET UP MASK OF SERVICED PORTS
  2773	0111AA	4010 4000 0A86 	        STH     R1,PRTSVC,,     :Save PORT serviced mask
  2774	0111B0	731C 4000 0A50 	OUT1    LHL     R1,ACP,R12,     :Active port
  2775	0111B6	441C 4000 0003 	        NH      R1,TISIS,R12,   :WITH DATA PRESENT
  2776	0111BC	441C 4000 0A5C 	        NH      R1,TOISIS,R12,  :And not backpressured
  2777	0111C2	4410 4000 0A86 	        NH      R1,PRTSVC,,     :And not already serviced
  2778	0111C8	2136 			JNFS	OUT2		:SERVICE IF ANYTHING TO DO
  2779	0111CA	27C2 			SIS	R12,2		:REPEAT FOR ALL GROUPS
  2780	0111CC	4310 FFD8 	        JGE     OUT0
  2781	0111D0	4300 8100 		J	RET		:THEN EXIT
  2782	0111D4	4130 F494 	OUT2	JAL	R3,BIDH
  2783	0111D8	081C 			LR	R1,R12		:CONSTRUCT INTERNAL PORT NUMBER
  2784	0111DA	9113 			SLHLS	R1,3
  2785	0111DC	0A12 			AR	R1,R2
  2786	0111DE	7620 4000 0A86 	        RBT     R2,PRTSVC,,     :Clear port to be serviced bit
  2787	0111E4	4010 4000 0A08 	        STH     R1,PORT,,
  2788	000000			    IF MBUFER
  2789					SLLS	R1,3		:MAKE BUFFER NUMBER
  2790					AIS	R1,4
  2791	000001			    ELSE
  2792	0111EA	1112 			SLLS	R1,2		:MAKE BUFFER NUMBER
  2793	0111EC	2612 			AIS	R1,2
  2794				    EI
  2795	0111EE	4010 4000 0A0A 	        STH     R1,BUFFER,,
  2796	0111F4	4140 F5B0 		JAL	R4,GCI		:PEEK AT NEXT CHAR
  2797	0111F8	0850 			LR	R5,R0
  2798	0111FA	2136 			JNFS	OUT3		:SKIP IF NOT AN ESCAPE
  2799	0111FC	4140 F5A8 		JAL	R4,GCI		:ELSE GET ESCAPED CHAR
  2800	011200	0850 			LR	R5,R0		:SAVE COPY
  2801	011202	4230 8050 		JN	OUT7		:SKIP IF NOT A "0"
  2802				
  2803				:	WE HAVE DATA...CONSTRUCT A DATA MESSAGE
  2804	011206	7310 4000 0A08 	OUT3    LHL     R1,PORT,,
  2805	01120C	D361 4000 09E6 	        LB      R6,XLIMIT,R1,   :Limit of chars we can send at once
  2806	011212	C806 0003 		LHI	R0,3,R6		:HOW BIG THE RECORD WILL BE
  2807	011216	4140 EF00 		JAL	R4,SLOR		:START LOGICAL OUTPUT RECORD
  2808	01121A	0805 			LR	R0,R5		:SEND FIRST CHAR
  2809	01121C	4140 EF34 	OUT4	JAL	R4,PUTCH	:SEND CHAR
  2810	011220	7310 4000 0A0A 	        LHL     R1,BUFFER,,     :Get any further chars from BUFFER
  2811	011226	2761 			SIS	R6,1
  2812	011228	2128 			JGFS	OUT6		:DON'T MAKE MESSAGE TOO BIG
  2813	01122A	4140 EF56 	OUT5	JAL	R4,ELODR	:BIG ENOUGH...STOP NOW
  2814	01122E	7310 4000 0A0A 	        LHL     R1,BUFFER,,     :Get buffer number
  2815	011234	4300 8064 		J	OUT10
  2816	011238	4801 01FE 	OUT6	LH	R0,BCT,R1	:CHECK STATE OF BUFFER
  2817	01123C	2229 			JLEBS	OUT5		:QUIT NOW IF BUFFER IS EMPTY
  2818	01123E	4140 F566 		JAL	R4,GCI		:OK...LOOK AT NEXT CHAR
  2819	011242	0850 			LR	R5,R0
Page  10-20	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  2820	011244	4230 FFD4 		JN	OUT4		:NOT ESCAPED, SO SEND IT ON
  2821	011248	4140 F55C 		JAL	R4,GCI		:ESCAPED...LOOK AT NEXT
  2822	01124C	0850 			LR	R5,R0		:COPY IT
  2823	01124E	4330 FFCA 		JE	OUT4		:PASS IF DATA
  2824	011252	4140 EF2E 		JAL	R4,ELODR	:END LOGICAL OUTPUT DATA RECORD
  2825				
  2826				:	WE GOT A CONTROL MESSAGE
  2827	011256	D365 F960 	OUT7	LB	R6,LENGTH,R5	:COPY IT
  2828	01125A	C806 0002 		LHI	R0,2,R6		:...TO THE ISIS BUFFER TOO
  2829	01125E	7310 4000 0A08 	        LHL     R1,PORT,,
  2830	011264	0825 			LR	R2,R5
  2831	011266	4140 EEB0 		JAL	R4,SLOR		:START LOGICAL OUTPUT RECORD
  2832	01126A	7310 4000 0A0A 	        LHL     R1,BUFFER,,     :Get any subsequent chars from buffer
  2833	011270	2761 		OUT8	SIS	R6,1		:COPY THE WHOLE MESSAGE
  2834	011272	2326 			JLEFS	OUT9		:NO MORE...SKIP
  2835	011274	4140 F530 		JAL	R4,GCI		:COPY ANOTHER CHAR OF MESSAGE
  2836	011278	4140 EED8 		JAL	R4,PUTCH
  2837	01127C	2206 			JBS	OUT8		:AND GO BACK FOR ANY MORE
  2838	01127E	4140 EF20 	OUT9	JAL	R4,ELOR		:END LOGICAL OUTPUT RECORD
  2839	011282	CB50 009E 		SHI	R5,DETMSG	:CHECK IF CIRCUIT ZAPPER
  2840	011286	211B 			JLFS	OUT10		:SKIP IF NOT
  2841	011288	2751 			SIS	R5,ZAPMSG-DETMSG
  2842	01128A	2129 			JGFS	OUT10
  2843	01128C	7350 4000 0A08 	        LHL     R5,PORT,,       :Yes, get port #
  2844				: See if we should clean up now, or wait for zapper Ack
  2845	000001			   IF   WAITZA
  2846	011292	7550 4000 0A80 	        SBT     R5,WTZA,,       :Tell ourselves to clean up when zap ack comes
  2847	000000			   ELSE
  2848				        RBT     R5,ACP,,        :Clean up now
  2849				        RBT     R5,DEM,,
  2850				        RBT     R5,OUTCRT,,
  2851				        RBT     R5,GBALL,,
  2852				   EI
  2853	011298	4300 FF14 		J	OUT1
  2854				
  2855	01129C	7301 01FE 	OUT10	LHL	R0,BCT,R1	:CHECK FOR EMPTY BUFFER
  2856	0112A0	4230 FF0C 		JN	OUT1		:GO ON TO NEXT PORT IF NOT
  2857	0112A4	7310 4000 0A08 	        LHL     R1,PORT,,
  2858	0112AA	7610 4000 0A7A 	        RBT     R1,GBALL,,      :Are we holding a green ball?
  2859	0112B0	4330 FEFC 		JE	OUT1		:NO...GO ON
  2860	0112B4	2403 			LIS	R0,3
  2861	0112B6	C820 00AA 		LHI	R2,GBMSG
  2862	0112BA	4140 EE5C 		JAL	R4,SLOR
  2863	0112BE	4140 EEE0 		JAL	R4,ELOR		:BUFFER IS NOW EMPTY...RETURN GREEN BALL
  2864	0112C2	4300 FEEA 		J	OUT1		:REPEAT FOR NEXT PORT
  2865				Page  10-21	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  2866				
  2867				:	SEND A CHAR PAIR
  2868				:	R5 = CHAR PAIR
  2869				:	R6 = LINK
  2870	0112C6	9405 		PAIR	EXBR	R0,R5		:FIRST CHAR
  2871	0112C8	4140 F55C 		JAL	R4,WCI
  2872	0112CC	9305 			LBR	R0,R5		:SECOND CHAR
  2873	0112CE	4140 F556 		JAL	R4,WCI
  2874	0112D2	0306 			JR	R6		:AND RETURN
  2875				
  2876				
  2877				:	GENERAL RETURN ROUTINE
  2878	0112D4	5800 4000 0A4C 	RET     L       R0,RETP,,       :Exit for several routines
  2879	0112DA	0300 			JR	R0
  2880				
  2881				
  2882				:	GENERAL ROUTINE TO ACTIVATE A PROCESS
  2883				:	LINK ON R4
  2884	0112DC	D010 4000 0A0C 	ACTIV   STM     R1,SAVE,,
  2885	000000			    IF MBUFER
  2886					LR	R15,R1		:COPY BUFFER #
  2887					SRLS	R15,1		:CONVERT TO FULLLWORD PONTER
  2888				        L       R15,PROCESS,R15,        :Locate process
  2889	000001			    ELSE
  2890	0112E2	58F1 4000 089C 	        L       R15,PROCESS,R1,         :Locate process
  2891				    EI
  2892	0112E8	2135 			JNFS	ACTIV1
  2893	0112EA	41A0 EF5C 		JAL	R10,CRASH	:NONE...CRASH
  2894	0112EE	0000 1010 		BC	0,0,4*R4,10	:CRASH TYPE 10
  2895	0112F2	0800 		ACTIV1	LR	R0,R0		:OK...SET CONDITION CODES
  2896	0112F4	01FF 			JALR	R15,R15		:NOW GO THERE
  2897	0112F6	D110 4000 0A0C 	        LM      R1,SAVE,,       :Restore regs
  2898	0112FC	0800 			LR	R0,R0
  2899	0112FE	0214 			JLR	R4		:Return if timeout to be left alone
  2900	011300	2128 			JGFS	ACTIV2		:SKIP IF TO ACTIVATE ON TIMEOUT
  2901	011302	7300 4000 0A08 	        LHL     R0,PORT,,       :Else turn off activation on timeout
  2902	011308	7600 4000 0A56 	        RBT     R0,PTIME,,
  2903	01130E	0304 			JR	R4		:AND RETURN
  2904	011310	5A00 400F 0008 	ACTIV2	A	R0,SLOWC,,	:SET UP TIMEOUT
  2905	000000			    IF MBUFER
  2906					SRLS	R1,1		:CONVERT TO FULLWORD POINTER
  2907				    EI
  2908	011316	5001 4000 0920 	        ST      R0,ATIME,R1,
  2909	000000			    IF MBUFER
  2910					SLLS	R1,1		:CONVERT TO BUFFER #
  2911				    EI
  2912	01131C	7300 4000 0A08 	        LHL     R0,PORT,,
  2913	011322	7500 4000 0A56 	        SBT     R0,PTIME,,
  2914	011328	0304 			JR	R4		:AND RETURN
  2915				
  2916				
  2917				:	INITIALIZE
  2918	01132A	5000 4000 0A4C 	IZFRONT ST      R0,RETP,,       :Save return
Page  10-22	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  2919	011330	C810 0020 		LHI	R1,NPORT-1
  2920	011334	C820 0100 		LHI	R2,MAXCHAR
  2921	011338	7610 4000 0A56 	IZF1    RBT     R1,PTIME,,      :Cancel outstanding timeouts
  2922	01133E	7510 4000 0A5C 	        SBT     R1,TOISIS,,     :Cancel all back-pressure
  2923	011344	7510 4000 0A62 	        SBT     R1,FRISIS,,
  2924	01134A	7610 4000 0A50 	        RBT     R1,ACP,,        :Port not active
  2925	011350	7610 4000 0A80 	        RBT     R1,WTZA,,       :Reset Zap Ack expected bit
  2926	011356	7610 4000 0A74 	        RBT     R1,OUTCRT,,     :Port not 'outbuilt'
  2927	01135C	4021 4100 09A4 		STH	R2,CHRLIM,R1,R1	:Initialize input limits to MAXCHAR chars
  2928	011362	2711 			SIS	R1,1
  2929	011364	4310 FFD0 		JGE	IZF1		:DO FOR ALL
  2930	011368	5870 400F 0004 		L	R7,FASTC,,	:GET CURRENT TIME
  2931	01136E	E600 8058 		LA	R0,HS		:PUT HALFSECOND LOGIC ON TIMEOUT
  2932	011372	C817 012C 		LHI	R1,RATE/2,R7
  2933	011376	4150 F336 		JAL	R5,TOPUT
  2934	01137A	E600 80A2 		LA	R0,ONESEC	:PUT ONE SECOND LOGIC ON TIMEOUT
  2935	01137E	C817 0258 		LHI	R1,RATE,R7
  2936	011382	CA10 0258 		AHI	R1,RATE		:START ONE SECOND FROM NOW
  2937	011386	4150 F326 		JAL	R5,TOPUT
  2938	01138A	4300 FF46 		J	RET		:AND EXIT
  2939				Page  10-23	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  2940				:
  2941				: PTTOUT - Set timeout activation time for port
  2942				:	R0 = # of seconds from now to activate (0 = cancel)
  2943				:	R1 = buffer # on port (input side!)
  2944				:	Destroys R2
  2945				:	Link on R4
  2946				:
  2947				
  2948	01138E	0821 		PTTOUT	LR	R2,R1		:Copy buffer #
  2949	011390	0800 			LR	R0,R0		:Check time
  2950	011392	2126 			JGFS	PTTSET		:Skip if positive
  2951	000000				IF	MBUFER
  2952					SRLS	R2,3		:Convert to port #
  2953	000001				ELSE
  2954	011394	1022 			SRLS	R2,2		:Convert to port #
  2955					EI
  2956	011396	7620 4000 0A56 	        RBT     R2,PTIME,,      :Cancel timeout
  2957	01139C	0304 			JR	R4		:Return
  2958				
  2959	01139E	5A00 400F 0008 	PTTSET	A	R0,SLOWC,,	:Compute activation time
  2960	000000				IF	MBUFER
  2961					SRLS	R2,1		:Convert to fullword pointer
  2962					EI
  2963	0113A4	5002 4000 0920 	        ST      R0,ATIME,R2,    :Save activation time
  2964	0113AA	1022 			SRLS	R2,2		:Convert to port #
  2965	0113AC	7520 4000 0A56 	        SBT     R2,PTIME,,      :Set timeout request bit
  2966	0113B2	0304 			JR	R4
  2967				Page  10-24	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  2968				:
  2969				: ZAPPRT - Send a zapper directly to the ring, bypassing the bufferlets.
  2970				:	This is the only way to disconnect a backpressured circuit
  2971				:	without having to wait for the backpressure to clear up.
  2972				:
  2973				:	Expects R1 = Port number, link on R5
  2974				:
  2975				
  2976	0113B4	C820 009F 	ZAPPRT	LHI	R2,ZAPMSG	:A zapper
  2977	0113B8	2403 			LIS	R0,3		:Length of zap msg
  2978	0113BA	4140 ED5C 		JAL	R4,SLOR		:Start message
  2979	0113BE	4140 EDE0 		JAL	R4,ELOR		:End message
  2980	000001			  IF WAITZA
  2981	0113C2	7510 4000 0A80 	        SBT     R1,WTZA,,       :Set waiting for zapper ack
  2982	000000			  ELSE
  2983				        RBT     R1,ACP,,        :Clean up now
  2984				        RBT     R1,DEM,,
  2985				        RBT     R1,OUTCRT,,
  2986				        RBT     R1,GBALL,,
  2987				  EI
  2988	0113C8	0305 			JR	R5
  2989				Page  10-25	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  2990				:	HALF SECOND PROCESSERS
  2991	0113CA	CA10 012C 	HS	AHI	R1,RATE/2
  2992	0113CE	4150 F2DE 		JAL	R5,TOPUT	:RUN AGAIN IN ABOUT A HALF SECOND
  2993				
  2994				:	CHECK ALL BUFFERS FOR BACKPRESSURE APPLIED, RELEASE WHERE POSSIBLE
  2995	0113D2	C850 0004 		LHI	R5,(NGRP-1)*2
  2996	0113D6	C860 0020 		LHI	R6,(NGRP-1)*10
  2997	0113DA	2571 		HS1	LCS	R7,1
  2998	0113DC	4775 4000 0A62 	        XH      R7,FRISIS,R5,   :Backpressure applied
  2999	0113E2	4475 4000 0A50 	        NH      R7,ACP,R5,      :And port active
  3000	0113E8	0817 		HS2	LR	R1,R7
  3001	0113EA	2137 			JNFS	HS3		:SOMETHING TO DO
  3002	0113EC	2752 			SIS	R5,2		:END OF A RING GROUP
  3003	0113EE	CB60 0010 		SHI	R6,10
  3004	0113F2	221C 			JGEBS	HS1		:NEXT RING GROUP
  3005	0113F4	4300 F284 		J	TORET
  3006				
  3007	0113F8	4130 F270 	HS3	JAL	R3,BIDH		:DETERMINE WHICH PORT ON GROUP MAY NEED SERVICE
  3008	0113FC	4772 4201 0B3A 		XH	R7,HMASK,R2,R2	:MARK PORT AS SERVICED
  3009	011402	0A26 			AR	R2,R6
  3010	011404	0812 			LR	R1,R2		:SAVE COPY OF PORT #
  3011	000000			    IF MBUFER
  3012					SLLS	R2,3		:BUFFER NUMBER
  3013	000001			    ELSE
  3014	011406	1122 			SLLS	R2,2		:BUFFER NUMBER
  3015				    EI
  3016	000000				IF	\DCTFLG
  3017				        LH      R0,DCT,R2,      :Contents of DCT
  3018	000001				ELSE
  3019	011408	4802 01FE 		LH	R0,BCT,R2	:CONTENTS OF INCOMING BUFFER
  3020					EI
  3021	01140C	4B01 4100 09A4 		SH	R0,CHRLIM,R1,R1	:Below limit?
  3022	011412	4220 FFD2 		JG	HS2		:NOT YET
  3023	011416	7510 4000 0A62 	        SBT     R1,FRISIS,,
  3024	01141C	4300 FFC8 		J	HS2		:AND PROCEED
  3025				
  3026				
  3027				:	ONE SECOND LOGIC
  3028	011420	CA10 0258 	ONESEC	AHI	R1,RATE
  3029	011424	4150 F288 		JAL	R5,TOPUT	:DO AGAIN IN ANOTHER SECOND
  3030	011428	C8F0 0004 		LHI	R15,(NGRP-1)*2	:SEARCH BY GROUPS
  3031	01142C	48EF 4000 0A50 	OS1     LH      R14,ACP,R15,    :Active port
  3032	011432	44EF 4000 0A56 	        NH      R14,PTIME,R15,
  3033	011438	2135 			JNFS	OS3		:SKIP IF ANY TO DO
  3034	01143A	27F2 		OS2	SIS	R15,2
  3035	01143C	2218 			JGEBS	OS1		:REPEAT FOR ALL GROUPS
  3036	01143E	4300 F23A 		J	TORET		:THEN EXIT
  3037				
  3038	011442	081E 		OS3	LR	R1,R14		:COPY MASK OF PORTS TO PROCESS
  3039	011444	2235 			JEBS	OS2		:NONE...GO ON TO NEXT GROUP
  3040	011446	4130 F222 		JAL	R3,BIDH
  3041	01144A	47E2 4201 0B3A 		XH	R14,HMASK,R2,R2	:SET IT EXAMINED
  3042	011450	081F 			LR	R1,R15
Page  10-26	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)FRONT.V01	 ISIS Front-end Package

  3043	011452	9113 			SLHLS	R1,3		:MAKE PORT # (ALLOW FOR COUNT BY 2'S)
  3044	011454	0A12 			AR	R1,R2
  3045	011456	4010 4000 0A08 	        STH     R1,PORT,,
  3046	01145C	9112 			SLHLS	R1,2		:MAKE BUFFER NUMBER
  3047	01145E	5801 4000 0920 	        L       R0,ATIME,R1,    :Check if timeout has expired
  3048	000000			    IF MBUFER
  3049					SLLS	R1,1		:CONVERT TO BUFFER #
  3050				    EI
  3051	011464	4010 4000 0A0A 	        STH     R1,BUFFER,,
  3052	01146A	5B00 400F 0008 		S	R0,SLOWC,,
  3053	011470	4220 FFCE 		JG	OS3		:NO...IGNOR FOR NOW
  3054	011474	7300 4000 0A08 	        LHL     R0,PORT,,       :Get port #
  3055	01147A	7600 4000 0A56 	        RBT     R0,PTIME,,      :Clear timeout for port
  3056	011480	2504 			LCS	R0,4		:YES...SET ACTIVATION DUE TO TIMEOUT
  3057	011482	4140 FE56 		JAL	R4,ACTIV	:AND ACTIVATE PORT
  3058	011486	4300 FFB8 		J	OS3		:AND GO DO ANOTHER
  3059				
  3060				
  3061					EM
Page  11-1	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  3062				: TRACE FILE STORAGE UTILITY (06-24-86)
  3063				        RA      $0  0
  3064				
  3065				        GL      TIMZON
  3066	000A88			        SEG     A.DATA
  3067	000A88	F8		TIMZON  BC      -8 
  3068	000A8A			BELCOL  HS      NPORT   
  3069	000ACC	003F 		BBELL   HC      3F
  3070	000ACE			TISIS   EQ      .               :FLAGS FOR FRONT.LIB
  3071	000ACE			FLAGS   HS      NGRP            :FLAGS FOR BUFFER.LIB
  3072	000AD4			IFLAGS  HS      NGRP            :EXTRA FLAGS
  3073	000ADA			PDATA   HS      2*NPORT
  3074	000B5E	01		BUFTRC  BC      1               :THIS WILL CAUSE TRACE OF GCI,WCI CALLS
  3075	000B60			CURSAV  WS      10
  3076	000BA0			MSGBUF  BS      140
  3077	000CE0			        BND     2
  3078	000CE0			ERRFND  BS      ((NPORT*4)+8)/8
  3079	000CF2			EFNPTR  HS      1
  3080	000CF4			R1VALU  BS      1
  3081	000CF5			WRTCNT  BS      1
  3082	000CF6			BIXONT  BS      1
  3083	000CF7			BIX370  BS      1
  3084	000CF8			THISID  BS      1
  3085	000CF9			IBX370  BS      1
  3086	000CFA			FLG370  BS      1
  3087	000CFB			IBXSWI  BS      1
  3088	000CFC			IBXOLD  BS      1
  3089	000CFD			ENDOHL  BS      1
  3090	000CFE			USRNM1  BS      1
  3091	000CFF			USRNM2  BS      1
  3092	000D00			USROLD  BS      1
  3093	000D01			USRNID  BS      1
  3094	000D02			STARTS  BS      1
  3095	000D03			VALIN5  BS      1
  3096	000D04			R8VALU  BS      1
  3097	000D05			BYTE2   BS      1
  3098	000D06			OHOPIX  BS      8
  3099	000D0E			USRBUF  BS      8
  3100	000D16	0DCF F0E5 EEE9 	BEGFIL  SC      /Opening file /
		EEE7 A0E6 E9EC 	
		E5A0 		
  3101	000D24	07A0 F4E9 EDE5 	TIMMSG  SC      / time: /
		BAA0 		
  3102	000D2C	1AC4 E9F3 E3EF 	DISCO1  SC      /Disconnecting host EMSxx"8D"8A/
		EEEE E5E3 F4E9 	
		EEE7 A0E8 EFF3 	
		F4A0 C5CD D3F8 	
		F88D 8A		
  3103	000D47	28 BEC4 E9F3 E3	DISCO2  SC      />Disconnecting 370 username TRACEx..."8D"8A"3E/
		EF EEEE E5E3 F4	
		E9 EEE7 A0B3 B7	
		B0 A0F5 F3E5 F2	
		EE E1ED E5A0 D4	
Page  11-2	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

		D2 C1C3 C5F8 AE	
		AE AE8D 8A3E 	
  3104	000D70	21CE EFF4 A0EC 	NOSWI   SC      /Not logged into 2nd 370 username /
		EFE7 E7E5 E4A0 	
		E9EE F4EF A0B2 	
		EEE4 A0B3 B7B0 	
		A0F5 F3E5 F2EE 	
		E1ED E5A0 	
  3105	000D92	20BE C1EC F2E5 	ALRDYM  SC      />Already logged on this username/
		E1E4 F9A0 ECEF 	
		E7E7 E5E4 A0EF 	
		EEA0 F4E8 E9F3 	
		A0F5 F3E5 F2EE 	
		E1ED E5		
  3106	000DB3	23 BEC1 ECF2 E5	OALLMS  SC      />Already logged on this ontyme host/
		E1 E4F9 A0EC EF	
		E7 E7E5 E4A0 EF	
		EE A0F4 E8E9 F3	
		A0 EFEE F4F9 ED	
		E5 A0E8 EFF3 F4	
  3107	000DD7	24 BEC1 ECF2 E5	TWOUNS  SC      />Already logged on two 370 usernames/
		E1 E4F9 A0EC EF	
		E7 E7E5 E4A0 EF	
		EE A0F4 F7EF A0	
		B3 B7B0 A0F5 F3	
		E5 F2EE E1ED E5	
		F3 		
  3108	000DFC	3ED3 F7E9 F4E3 	SWIMSG SC /Switching to 2nd username--logging off original username..."8D"8A"3E/
		E8E9 EEE7 A0F4 	
		EFA0 B2EE E4A0 	
		F5F3 E5F2 EEE1 	
		EDE5 ADAD ECEF 	
		E7E7 E9EE E7A0 	
		EFE6 E6A0 EFF2 	
		E9E7 E9EE E1EC 	
		A0F5 F3E5 F2EE 	
		E1ED E5AE AEAE 	
		8D8A 3E		
  3109	000E3B	1C BECE EFF4 A0	NONMSG  SC      />Not logged on this username/
		EC EFE7 E7E5 E4	
		A0 EFEE A0F4 E8	
		E9 F3A0 F5F3 E5	
		F2 EEE1 EDE5 	
  3110	000E58	0FCE CFD4 A0C1 	NAVMSG  SC      /NOT AVAILABLE"8D"8A/
		D6C1 C9CC C1C2 	
		CCC5 8D8A 	
  3111	000E68	14B3 B7B0 A0CE 	NAMSG3  SC      /370 NOT AVAILABLE"8D"8A"3E/
		CFD4 A0C1 D6C1 	
		C9CC C1C2 CCC5 	
		8D8A 3E		
  3112	000E7D	14 0707 07C3 E9	CIRGON  SC      /"07"07"07Circuit gone--EMS/
		F2 E3F5 E9F4 A0	
		E7 EFEE E5AD AD	
Page  11-3	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

		C5 CDD3 	
  3113	000E92	2607 0707 C3E9 	CIRGO3  SC      /"07"07"07Circuit to 370 username TRACEx gone/
		F2E3 F5E9 F4A0 	
		F4EF A0B3 B7B0 	
		A0F5 F3E5 F2EE 	
		E1ED E5A0 D4D2 	
		C1C3 C5F8 A0E7 	
		EFEE E5		
  3114	000EB9	29 0707 07C3 E9	BAKGON  SC      /"07"07"07Circuit to 370 username  TRACBAK  gone/
		F2 E3F5 E9F4 A0	
		F4 EFA0 B3B7 B0	
		A0 F5F3 E5F2 EE	
		E1 EDE5 A0A0 D4	
		D2 C1C3 C2C1 CB	
		A0 A0E7 EFEE E5	
  3115	000EE3	04 CFCB 8D8A 	OKMSG   SC      /OK"8D"8A/
  3116	000EE8	12CC EFE7 EFEE 	OKMSG3  SC      /Logon to 370 OK"8D"8A"BE/
		A0F4 EFA0 B3B7 	
		B0A0 CFCB 8D8A 	
		BE		
  3117	000EFB	28 BECC EFE7 E7	STRMSG  SC      />Logging in to 370 username TRACEx..."8D"8A"3E/
		E9 EEE7 A0E9 EE	
		A0 F4EF A0B3 B7	
		B0 A0F5 F3E5 F2	
		EE E1ED E5A0 D4	
		D2 C1C3 C5F8 AE	
		AE AE8D 8A3E 	
  3118	000F24	28BE CCEF E7E7 	BAKMSG  SC      />Logging in to 370 username  TRACBAK "8D"8A"3E/
		E9EE E7A0 E9EE 	
		A0F4 EFA0 B3B7 	
		B0A0 F5F3 E5F2 	
		EEE1 EDE5 A0A0 	
		D4D2 C1C3 C2C1 	
		CBA0 8D8A 3E	
  3119	000F4D	21 BED0 ECE5 E1	ENTER3  SC      />Please log on to 370 username"8D"8A"3E/
		F3 E5A0 ECEF E7	
		A0 EFEE A0F4 EF	
		A0 B3B7 B0A0 F5	
		F3 E5F2 EEE1 ED	
		E5 8D8A 3E	
  3120	000F6F	D3 D7C9 D4C3 C8	SWISTR  AC      /SWITCH/
  3121	000F75	28 AAAA AAAA AA	BANNER  SC      /***************************************"8D/
		AA AAAA AAAA AA	
		AA AAAA AAAA AA	
		AA AAAA AAAA AA	
		AA AAAA AAAA AA	
		AA AAAA AAAA AA	
		AA AAAA AA8D 	
  3122	000F9E	28AA AAAA AAAA 	BBALLM  SC      /***** DATA LOST (BLACK BALL REC'D) ****"8D/
		A0C4 C1D4 C1A0 	
		CCCF D3D4 A0A8 	
		C2CC C1C3 CBA0 	
		C2C1 CCCC A0D2 	
Page  11-4	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

		C5C3 A7C4 A9A0 	
		AAAA AAAA 8D	
  3123	000FC8			LOGREQ  HS      1
  3124	000FCA			FILDAT  HS      1
  3125	000FCC			DATWRD  WS      1
  3126	000FD0			R10VAL  WS      1
  3127	000FD4			DAYT    BS      9
  3128	000FDD			DATBYT  BS      1
  3129	000FDE			FLGONT  BS      1
  3130	000FDF			CURLEN  BS      1
  3131	000FE0			USERON  BS      1
  3132	000FE1			USR2ON  BS      1
  3133	000FE2			US2OPB  BS      1
  3134	000FE3			US2ACT  BS      1
  3135	000FE4			U2HOST  BS      1
  3136	000FE5			PASSWO  BS      1
  3137	000FE6			OCMBY2  BS      1
  3138	000FE7			ORIGR1  BS      1
  3139	000FE8			HTOZAP  BS      1
  3140	000FE9			CIRACT  BS      1
  3141	000FEA			HOSTID  BS      1
  3142	000FEB			HOSTYP  BS      1
  3143	000FEC			CURHID  BS      1
  3144	000FED			USROPB  BS      1
  3145	000FEE	33		CHR370  BC      33              
  3146	000FEF	41 		MINUN   BC      41
  3147	000FF0	49		MAXUN   BC      49              :ASCII 'I'--TRACBAK4
  3148	000FF2			        BND     2
  3149	000FF2	14		REQLEN  BC      14
  3150	000FF3			OUTBIX  BS      1
  3151	000FF4	0FBA C5D8 C5C3 	TRAMSG  SC      /:EXEC * TRACE"8D"8A/
		A0AA A0D4 D2C1 	
		C3C5 8D8A 	
  3152	001004	09C4 C9D3 CBC9 	DIOMSG  SC      /DISKIO W /
		CFA0 D7A0 	
  3153	00100E			FNMPTR  BS      1
  3154	00100F	05 8DCC CFC7 8D	LOGMSG  SC      /"8DLOG"8D/
  3155	001015	06 8DBA CCCF C7	LOGOMS  SC      /"8D:LOG"8D/
		8D 		
  3156	00101C			        BND     2
  3157				
  3158	00101C			PROMPT  BS 1
  3159	00101D	23 8D8A D4F2 E1	HELLO   SC      /"8D"8ATrace File Storage Utility  1.1"8D"8A/
		E3 E5A0 C6E9 EC	
		E5 A0D3 F4EF F2	
		E1 E7E5 A0D5 F4	
		E9 ECE9 F4F9 A0	
		A0 B1AE B18D 8A	
  3160	001041	34 8D8A A8D4 C6	HELLO2  SC      /"8D"8A(TFSU  1.1)  Enter log-in string for target host"8D"8A/
		D3 D5A0 A0B1 AE	
		B1 A9A0 A0C5 EE	
		F4 E5F2 A0EC EF	
		E7 ADE9 EEA0 F3	
Page  11-5	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

		F4 F2E9 EEE7 A0	
		E6 EFF2 A0F4 E1	
		F2 E7E5 F4A0 E8	
		EF F3F4 8D8A 	
  3161	001076	1A07 0707 C3C9 	NOCMSG  SC      /"07"07"07CIRCUIT TO HOST GONE"8D"8A"3E/
		D2C3 D5C9 D4A0 	
		D4CF A0C8 CFD3 	
		D4A0 C7CF CEC5 	
		8D8A 3E		
  3162	001094			        BND     4
  3163	001094	0000 0102 0304 	NUMTBL  BC      0,0,1,2,3,4,5,6,7,8
		0506 0708 	
  3164	00109E	0000 0000 0000 	BAKTBL  BC      0,0,0,0,0,0,0B1,0B2,0B3,0B4
		B1B2 B3B4 	
  3165				Page  11-6	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  3166				
  3167				:	ONTYME HOST AUX REQUEST STRING TABLE
  3168				
  3169	0010A8			        BND     4
  3170	0010A8			REQSTR	EQ	.		:START OF ONT HOST AUX REQ STR TABLE
  3171	0000C5			ID	EQ	MINONT!80       :SET HI-ORDER BIT OF HOST ID
  3172	000004				RE	NHOSTS		:REPEAT NUMBER OF ONTYME HOSTS
  3173	0010A8	27			BC	27		:EACH STRING IS 39 decimal BYTES LONG
  3174	0010A9	08 			BC	8		:THIS IS INTRA-NODE MSG 8
  3175	0010AA	0000 0100 00		BC	0,0,1,0,0	:AS PER FORMAT OF AUX REQ STRING
  3176	0010AF	10 		        BC      (HOST0&0FF00)^-8        :INTERFACE HOST NMBR (HI BYTE)
  3177	0010B0	A1		        BC      HOST0&00FF              :INTERFACE HOST NMBR (LOW BYTE)
  3178	0010B1	1E 			BC	1E		:LEN OF LOGON STRING
  3179				:	"EMSOPER"
  3180	0010B2	C5CD D3CF D0C5 		BC	0C5,0CD,0D3,0CF,0D0,0C5,0D2
		D2		
  3181	0010B9	C5 			BC	ID		:ONTYME HOST ID
  3182	0010BA	8D			BC	8D		:CR
  3183				:	"OPER"
  3184	0010BB	CF D0C5 D2		BC	0CF,0D0,0C5,0D2
  3185	0010BF	C5 			BC	ID
  3186				:	".TRACE"
  3187	0010C0	AED4 D2C1 C3C5 		BC	0AE,0D4,0D2,0C1,0C3,0C5
  3188	0010C6	8D			BC	8D		:CR
  3189				:	"THIS1S4U"
  3190	0010C7	D4 C8C9 D3B1 D3		BC	0D4,0C8,0C9,0D3,0B1,0D3,0B4,0D5
		B4 D5		
  3191	0010CF	8D 			BC	8D
  3192	0000C6			ID	EQ	ID+1
  3193	000000				ER
  3194				
  3195				:	GENERATE TBLONT
  3196				
  3197	001148			        BND     4
  3198	001148			TBLONT	EQ	.
  3199	000045			ID	EQ	MINONT
  3200	000004				RE	NHOSTS
  3201	001148	45			BC	ID
  3202	001149				BS	3
  3203	000046			ID	EQ	ID+1
  3204	000000				ER
  3205				
  3206				:	GENERATE FILE NAME STRING TABLE
  3207				
  3208	001158			        BND     4
  3209	001158			FNMSTR	EQ	.
  3210	000045			ID	EQ	MINONT
  3211	000004				RE	NHOSTS
  3212	001158	0B			BC	0B		:EACH STRING IS THIS LONG
  3213	001159	45 			BC	ID		:HOST ID
  3214	00115A	0000 0000 A000 		BC	0,0,0,0,0A0,0,0,0,0
		0000 00		
  3215	001163	8D 			BC	8D
Page  11-7	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  3216	000046			ID	EQ	ID+1
  3217	000000				ER
  3218				
  3219	001188			        BND     2
  3220	001188	0A04 00		HOSTUP  BC      0A,04,0                 :INTRA-NODE MSG 4
  3221	00118B	10 		        BC      (HOST0&0FF00)^-8         :INTERFACE HOST NMBR (HI BYTE)
  3222	00118C	A1		        BC      HOST0&00FF              :INTERFACE HOST NMBR (LOW BYTE)
  3223	00118D	00 2000 0000 00	        BC      0,20,0,0,0,0
  3224				
  3225	001193			LOGST2  BS      1
  3226	001194	08		        BC      8                       :INTRA-NODE MSG 8
  3227	001195	00 0001 0000 	        BC      0,0,1,0,0
  3228	00119A	10		        BC      (HOST0&0FF00)^-8        :INTERFACE HOST NMBR (HI BYTE)
  3229	00119B	A1 		        BC      HOST0&00FF              :INTERFACE HOST NMBR (LOW BYTE)
  3230	00119C	B0		        BC      0B0
  3231	00119D			        BS      $A 35
  3232				
  3233	0011C0	1C		AXREQ3  BC      1C
  3234	0011C1	08 		        BC      8                       :INTRA-NODE MSG TYP 8
  3235	0011C2	0000 0100 00	        BC      0,0,1,0,0
  3236	0011C7	10 		        BC      (HOST0&0FF00)^-8        :INTERFACE HOST NMBR (HI BYTE)
  3237	0011C8	A1		        BC      HOST0&00FF              :INTERFACE HOST NMBR (LOW BYTE)
  3238	0011C9	13 		        BC      13                      :LEN OF STRING
  3239				:       "TRACE"
  3240	0011CA	D4D2 C1C3 C5	        BC      0D4,0D2,0C1,0C3,0C5
  3241	0011CF			        BS      1
  3242	0011D0	BA		        BC      0BA			:0BA = :
  3243	0011D1	B4 B0		        BC      0B4,0B0                 :370 SYSTEM 40
  3244	0011D3	BB 		        BC      0BB                     :0BB = 
  3245				
  3246				:       "ON TYME"
  3247	0011D4	CFCE A0D4 D9CD 	        BC      0CF,0CE,0A0,0D4,0D9,0CD,0C5
		C5		
  3248	0011DB	8D 8D		        BC      8D,8D
  3249				
  3250	0011DD	1E 		BKREQ3  BC      1E
  3251	0011DE	08		        BC      8
  3252	0011DF	00 0001 0000 	        BC      0,0,1,0,0
  3253	0011E4	10		        BC      (HOST0&0FF00)^-8        :INTERFACE HOST NMBR (HI BYTE)
  3254	0011E5	A1 		        BC      HOST0&00FF              :INTERFACE HOST NMBR (LOW BYTE)
  3255	0011E6	15		        BC      15
  3256				:       "TRACBAK"
  3257	0011E7	D4 D2C1 C3C2 C1	        BC      0D4,0D2,0C1,0C3,0C2,0C1,0CB
		CB 		
  3258	0011EE			        BS      1
  3259	0011EF	BA 		        BC      0BA
  3260	0011F0	B4B3 		        BC      0B4,0B3                 :370 SYSTEM 43
  3261	0011F2	BB		        BC      0BB
  3262				:       "ON TYME"
  3263	0011F3	CF CEA0 D4D9 CD	        BC      0CF,0CE,0A0,0D4,0D9,0CD,0C5,08D,08D
		C5 8D8D 	
  3264					
  3265	0011FC			        BND     4
Page  11-8	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  3266	0011FC	0004 0000 0000 	AUXBRK  HC      4,0,0
  3267	001202	0000 0000 0000 	        HC      0,0,0
  3268	001208	0000 0000 0004 	        HC      0,0,4
  3269	00120E	0000 0000 0000 	        HC      0,0,0
  3270	001214	0000 0000 0000 	        HC      0,0,0
  3271	00121A	0000 		        HC      0
  3272				 
  3273	00121C	0000 0000 0000 	USRTBL  HC      0,0,0           :MBREAK TABLE FOR OPER CIRCUIT
  3274	001222	0000 0000 0000 	        HC      0,0,0
  3275	001228	0000 0000 0000 	        HC      0,0,0
  3276	00122E	0003 0000 0000 	        HC      3,0,0           :9E,9F MESSAGES
  3277	001234	0000 0000 0000 	        HC      0,0,0
  3278	00123A	0000 		        HC      0
  3279				 
  3280	00123C	0000 0000 0000 	W370TB  HC      0,0,0
  3281	001242	0000 0000 0000 	        HC      0,0,0
  3282	001248	0000 0000 0000 	        HC      0,0,0
  3283	00124E	0003 C000 0000 	        HC      3,0C000,0       :9E,9F,A0,A1
  3284	001254	0000 0000 0000 	        HC      0,0,0
  3285	00125A	0000 		        HC      0
  3286				 
  3287	00125C	0000 0000 0000 	WRMTBL  HC      0,0,0           :MBREAK TBLE FOR MSGS FROM ONTYM HOSTS CIRCS.
  3288	001262	0000 0000 0000 	        HC      0,0,0   
  3289	001268	0000 0000 0000 	        HC      0,0,0
  3290	00126E	0003 0800 0000 	        HC      3,0800,0        :9E,9F,A4 (DETACH, ZAP, BLACK_BALL)
  3291	001274	0000 0000 0000 	        HC      0,0,0
  3292	00127A	0000 		        HC      0
  3293				
  3294	00127C	0000 0000 0000 	AXBTBL  HC      0,0,0           :MSG BREAK TBL FOR BUILD AUX CIRC PROC.
  3295	001282	0000 0000 0000 	        HC      0,0,0
  3296	001288	0000 0000 0000 	        HC      0,0,0
  3297	00128E	0000 0000 0600 	        HC      0,0,600          :B5, B6  MESSAGES
  3298	001294	0000 0000 0000 	        HC      0,0,0
  3299	00129A	0000 		        HC      0
  3300				
  3301				
  3302				Page  11-9	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  3303				
  3304	01148A			        SEG     A.CODE
  3305	01148A			START   EQ      .
  3306	01148A	2410 		        LIS     R1,0            :SET INDEX TO 0
  3307	01148C	C820 0030 	        LHI     R2,NGRP*10      :DISPLACEMENT TO IFLAGS
  3308	011490	0832 		        LR      R3,R2           :PUT IN R3 ALSO
  3309				
  3310	011492			INITBF  EQ      .
  3311	011492	4031 017A 	        STH     R3,BF,R1        :STORE INPUT BUFS IN EXTRA FLAGS
  3312	011496	2612 		        AIS     R1,2            :MOVE TO OUTBUF INDEX
  3313	011498	0843 		        LR      R4,R3           :GET INBUF INDEX
  3314	01149A	0B42 		        SR      R4,R2           :SUBTRACT NGRP*10
  3315	01149C	4041 4000 017A 	        STH     R4,BF,R1,       :STORE OUTBUFS IN FLAGS
  3316	0114A2	2631 		        AIS     R3,1            :NEXT BF ENTRY
  3317	0114A4	2612 		        AIS     R1,2            :NEXT BUF INDEX
  3318	0114A6	C510 0084 	        CLHI    R1,NBUF*2       :LAST BUFFER?
  3319	0114AA	4210 FFE4 	        JL      INITBF          :IF NOT, DO ANOTHER
  3320				
  3321	0114AE	4100 F288 	        JAL     R0,IZT          :INITIALIZE TIMEOUT
  3322	0114B2	4150 F29C 	        JAL     R5,IZBF         :INITIALIZE BUFFERS
  3323	0114B6	4100 FE70 	        JAL     R0,IZFRONT      :INITIALIZE FRONT END
  3324	0114BA			INIT0   EQ      .
  3325	0114BA	E610 8774 	        LA      R1,IMSG0
  3326	0114BE	5010 089C 	        ST      R1,PROCESS      :STORE ISIS MESSAGE ROUTINE
  3327	0114C2	C820 0080 	        LHI     R2,(NPORT-1)*4  :INIT COUNTER FOR ALL PORTS
  3328	0114C6	E630 121C 	        LA      R3,USRTBL       :PUT ADDRESS OF MSG TABLE IN R3
  3329	0114CA	E610 80DA 	        LA      R1,USRMSG       :PUT ADDRESS OF USER MSG PROCESS IN R1
  3330	0114CE			INIT1   EQ      .
  3331	0114CE	5012 089C 	        ST      R1,PROCESS,R2   :STORE ADDR
  3332	0114D2	5032 0818 	        ST      R3,MBREAK,R2    :STORE TABLE ADDR
  3333	0114D6	2724 		        SIS     R2,4            :DECREMENT COUNTER
  3334	0114D8	4230 FFF2 	        JN      INIT1           :IF NOT, INIT NEXT ELEMENT OF ARRAY
  3335				 
  3336				
  3337	0114DC			INIT2   EQ      .
  3338	0114DC	2420 		        LIS     R2,0            :PUT RPORT 0 IN R2
  3339	0114DE	E630 1188 	        LA      R3,HOSTUP       :POINT TO HOST UP STRING
  3340	0114E2	4150 EB8A 	        JAL     R5,OCM          :OUTPUT HOST UP STRING
  3341				 
  3342	0114E6	2400 		        LIS     R0,0
  3343	0114E8	5000 0D06 	        ST      R0,OHOPIX
  3344	0114EC	5000 0D0A 	        ST      R0,OHOPIX+4
  3345	0114F0	E100 0000 	MAIN    SVC     DISMISS
  3346	0114F4	4100 F784 	        JAL     R0,INPUT        :CHECK INPUT
  3347				
  3348	0114F8	4810 078C 		LH	R1,BKPRON	:BAKPRSR ON BEACUSE BUFRLTS LOW?
  3349	0114FC	4210 801A 		JL	CHKBF0		:YES
  3350	011500	7310 078E 		LHL	R1,BUFUSD	:BUFFERLETS USED COUNT
  3351	011504	C510 0E40 		CLHI	R1,(NBFLET/4)*3 : USD UP 3/4THS OF BUFERLETS?
  3352	011508	4210 8028 		JL	CHKBF1		:NO, ELSE BACKPRESSURE ONTYME HOSTS
  3353	01150C	E000 078C 	        TS      BKPRON
  3354	011510	C800 00A0 	BKPOUT	LHI	R0,0A0		:BACKPRESSURE MSG
  3355	011514	4160 8EB2 	        JAL     R6,SBKMOH       :SEND BACKPRESSURE MSG TO ONT HOST
Page  11-10	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  3356	011518	230E 		        JFS     CHKBF1
  3357	01151A	7310 078E 	CHKBF0	LHL	R1,BUFUSD
  3358	01151E	C510 04C0 		CLHI	R1,(NBFLET/4)
  3359	011522	4220 800E 		JG	CHKBF1		:STILL TOO MANY USED BUFERLTS
  3360	011526	C800 00A1 	RELBKP	LHI	R0,0A1
  3361	01152A	4160 8E9C 	        JAL     R6,SBKMOH       :SEND RELEASE BKPRS MSG TO ONT HOST
  3362	01152E	2400 		        LIS     R0,0
  3363	011530	4000 078C 	        STH     R0,BKPRON
  3364	011534			CHKBF1	EQ	.
  3365				
  3366	011534	4100 FC66 	        JAL     R0,OUTPUT       :CHECK OUTPUT
  3367	011538	D350 0FE6 	        LB      R5,OCMBY2       :DID USER2 FLAG AN OCM CALL?
  3368	01153C	4230 8040 	        JN      U2OCM           :IS SO JUMP TO USER2 OCM CALL ROUTINE
  3369	011540	D350 0FDE 	        LB      R5,FLGONT       :IS FLGONT = 1?
  3370	011544	4230 804C 	        JN      ONTOCM          :IF 1, SEND AUX REQ TO ONTYME HOST
  3371	011548	D350 0CFA 	        LB      R5,FLG370       :REQUEST TO LOGON TO A 370?
  3372	01154C	4330 FFA0 	        JE      MAIN            :NO
  3373				
  3374	011550	C550 0045 	        CLHI    R5,45           :YES--WHAT'S THE ID?
  3375	011554	4320 8014 	        JLE     OCM370          :IT'S A THRU E
  3376	011558	2420 		        LIS     R2,0
  3377	01155A	E630 11DD 	        LA      R3,BKREQ3       :IT'S A REQUEST FOR LOG-IN TO A BACKUP USERNAME
  3378	01155E	4150 EB0E 	        JAL     R5,OCM
  3379	011562	2450 		        LIS     R5,0
  3380	011564	D250 0CFA 	        STB     R5,FLG370
  3381	011568	4300 FF84 	        J       MAIN
  3382				
  3383	01156C	2420 		OCM370  LIS     R2,0
  3384	01156E	E630 11C0 	        LA      R3,AXREQ3
  3385	011572	4150 EAFA 	        JAL     R5,OCM
  3386	011576	2450 		        LIS     R5,0
  3387	011578	D250 0CFA 	        STB     R5,FLG370
  3388	01157C	4300 FF70 	        J       MAIN
  3389				
  3390	011580			U2OCM   EQ      .
  3391	011580	2420 		        LIS     R2,0            :0 IN R2 FOR OCM CALL
  3392	011582	E630 1193 	        LA      R3,LOGST2       :POINT TO LOG-IN STRING 
  3393	011586	4150 EAE6 	        JAL     R5,OCM
  3394	01158A	2450 		        LIS     R5,0
  3395	01158C	D250 0FE6 	        STB     R5,OCMBY2       :0 OUT OCMCALLBYUSER2 FLAG
  3396	011590	4300 FF5C 	        J       MAIN
  3397				 
  3398	011594			ONTOCM  EQ      .
  3399	011594	2420 		        LIS     R2,0            :SET UP AUXREQ
  3400	011596	4140 8E76 	        JAL     R4,GETAXR       :GET AUX REQ STRING
  3401	01159A	4150 EAD2 	        JAL     R5,OCM          :SEND AUXREQ VIA OCM
  3402	01159E	2410 		        LIS     R1,0            :PUT A 0 IN R1
  3403	0115A0	D210 0FDE 	        STB     R1,FLGONT       :SET FLGONT TO 0
  3404	0115A4	4300 FF48 	        J       MAIN            :BACK TO TOP OF LOOP
  3405				
  3406	0115A8			USRMSG  EQ      .
  3407	0115A8	D350 0FE9 	        LB      R5,CIRACT       :PUT CIRCUIT ACTION FLAG IN R5
  3408	0115AC	0855 		        LR      R5,R5           :DOES CIRACT = O?
Page  11-11	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  3409	0115AE	4230 867A 	        JN      RETURN          :IF NOT DON'T ALLOW USR INPUT
  3410	0115B2	0800 		        LR      R0,R0           :IS IT CONDITION CODE 0?
  3411	0115B4	4210 8418 	        JL      NEEDLE           :IF LESS THAN 0, IT'S A NEEDLE
  3412	0115B8	4220 8472 	        JG      USRISM          :IT'S A USER ISIS MSG
  3413				
  3414	0115BC			USRINP  EQ      .
  3415	0115BC	D210 0FE7 	        STB     R1,ORIGR1       :SAVE ORIGINAL INP BUF IDX
  3416	0115C0	2450 		        LIS     R5,0            :INIT R5
  3417	0115C2	4140 F1E2 	NXTUIN  JAL     R4,GCI          :GET BYTE
  3418	0115C6	C400 007F 	        NHI     R0,007F         :AND OUT PARITY BIT
  3419	0115CA	C500 000D 	        CLHI    R0,0D           :CR?
  3420	0115CE	4330 8014 	        JE      ENDUIN          :JUMP IF =
  3421	0115D2	D205 0D0E 	        STB     R0,USRBUF,R5    :ELSE SAV IN BUFR
  3422	0115D6	2651 		        AIS     R5,1            :INCRMENT
  3423	0115D8	C550 0007 	        CLHI    R5,7            :END OF BUFR?
  3424	0115DC	4210 FFE2 	        JL      NXTUIN          :IF NOT GET NXT BYTE
  3425	0115E0	2751 		        SIS     R5,1            :ELSE MAKE ROOM FOR CR
  3426	0115E2	C800 000D 	        LHI     R0,0D           :PUT IN CR
  3427	0115E6			ENDUIN  EQ      .
  3428	0115E6	D205 0D0E 	        STB     R0,USRBUF,R5    :PUT CR IN USRBUF
  3429	0115EA	C800 000A 	        LHI     R0,0A           :LF IN R0
  3430	0115EE	2651 		        AIS     R5,1            :INCREMNT
  3431	0115F0	D205 0D0E 	        STB     R0,USRBUF,R5    :PUT IN BUF
  3432	0115F4	2612 		        AIS     R1,2            :MAKE INP BUF IDX INTO OUT BUF IDX
  3433	0115F6	2450 		        LIS     R5,0            :INIT R5
  3434	0115F8			WRIUN   EQ      .               :WRITE USER INPUT TO SCREEN
  3435	0115F8	D305 0D0E 	        LB      R0,USRBUF,R5    :PUT BYTE IN BUF
  3436	0115FC	4140 F228 	        JAL     R4,WCI          :SEND
  3437	011600	2651 		        AIS     R5,1            :INC
  3438	011602	C500 000A 	        CLHI    R0,0A           :END OF MSG?
  3439	011606	4230 FFEE 	        JN      WRIUN           :IF NO GET NXT BYTE
  3440				 
  3441	01160A	2450 		        LIS     R5,0            :0 IN R5
  3442	01160C	D345 0D0E 	        LB      R4,USRBUF,R5    :GET FIRST USRBUF BYTE
  3443	011610	C540 0033 	        CLHI    R4,33           : = 3?
  3444	011614	4330 803E 	        JE      CHKBY2          :IF SO CHECK 2ND BYTE
  3445	011618	D350 0CF9 	        LB      R5,IBX370       :ALREADY LOGGED ONTO 370 USRNAME?
  3446	01161C	0855 		        LR      R5,R5           :SET CC
  3447	01161E	4230 8134 	        JN      ON370           :JUMP IF NOT 0
  3448	011622	2451 		        LIS     R5,1            :INIT R5
  3449	011624			NXTENT  EQ      .
  3450	011624	D305 0F4D 	        LB      R0,ENTER3,R5    :TELL USER TO LOG IN TO 370
  3451	011628	4140 F1FC 	        JAL     R4,WCI          :SEND
  3452	01162C	2651 		        AIS     R5,1            :INCR
  3453	01162E	D450 0F4D 	        CLB     R5,ENTER3       :END OF MSG?
  3454	011632	4320 FFEE 	        JLE     NXTENT          :IF NOT GET NXT BYTE
  3455	011636	D310 0FE7 	        LB      R1,ORIGR1       :GET ORIG INP BUF IDX
  3456	01163A	4300 85EE 	        J       RETURN
  3457				 
  3458	01163E			ALONMS  EQ      .
  3459	01163E	2451 		        LIS     R5,1
  3460	011640	D305 0D92 	NXTAOM  LB      R0,ALRDYM,R5    :GET ALREADY ON MSG BYTE
  3461	011644	4140 F1E0 	        JAL     R4,WCI
Page  11-12	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  3462	011648	2651 		        AIS     R5,1
  3463	01164A	D450 0D92 	        CLB     R5,ALRDYM
  3464	01164E	4320 FFEE 	        JLE     NXTAOM
  3465	011652	4300 835A 	        J       WRIPRM
  3466				 
  3467	011656			CHKBY2  EQ      .
  3468	011656	2451 		        LIS     R5,1    
  3469	011658	D345 0D0E 	        LB      R4,USRBUF,R5    
  3470	01165C	D240 0D05 	        STB     R4,BYTE2        :SAVE 2ND BYTE
  3471	011660	D440 0FF0 	        CLB     R4,MAXUN        :2ND BYTE = MAX USERNAME?
  3472	011664	4220 8340 	        JG      BADINP          :IF > THEN BAD INPUT
  3473	011668	D440 0FEF 	        CLB     R4,MINUN        :2ND BYTE < MIN USERNAME?
  3474	01166C	4210 8338 	        JL      BADINP
  3475	011670	2452 		        LIS     R5,2            :CHECK 3RD BYTE
  3476	011672	D345 0D0E 	        LB      R4,USRBUF,R5
  3477	011676	C540 0020 	        CLHI    R4,20           :IS IT A SPACE?
  3478	01167A	4230 832A 	        JN      BADINP          :IF NOT, IT'S BAD INPUT
  3479	01167E	2453 		        LIS     R5,3            :CHECK 4TH BYTE
  3480	011680	D345 0D0E 	        LB      R4,USRBUF,R5    
  3481	011684	C540 0047 	        CLHI    R4,47           :"G"?
  3482	011688	4230 825C 	        JN      CHKIFL          :IF NOT = CHECK IF "L"
  3483	01168C	2454 		        LIS     R5,4            :CHECK 5TH BYTE
  3484	01168E	D345 0D0E 	        LB      R4,USRBUF,R5    
  3485	011692	C540 004F 	        CLHI    R4,4F           :"O"?
  3486	011696	4230 830E 	        JN      BADINP
  3487				 
  3488	01169A	D350 0CF9 	        LB      R5,IBX370       :IS A 370 USERNAME ALREADY LOGGED IN?
  3489	01169E	0855 		        LR      R5,R5           :SET CC
  3490	0116A0	4230 807A 	        JN      CHKSWI          :IF SO, CHECK IBXSWI 
  3491	0116A4	D340 0D05 	        LB      R4,BYTE2        :PUT 2ND BYTE IN R4--THIS IS THE USERNAME ID
  3492	0116A8	D240 0CFE 	        STB     R4,USRNM1       :SAVE "ID" OF FIRST USERNAME
  3493	0116AC	D240 0CFA 	PICKUN  STB     R4,FLG370       :PUT ID IN FLAG FOR AUX REQUEST
  3494				        
  3495	0116B0			LOGON3  EQ      .
  3496	0116B0	2453 		        LIS     R5,3            :SET FLAG FOR 370 LOGON REQ
  3497	0116B2	D250 0FEB 	        STB     R5,HOSTYP       :SET HOSTYP FLAG TO 3
  3498	0116B6	2451 		        LIS     R5,1            :1 IN R5
  3499	0116B8	D345 0D0E 	        LB      R4,USRBUF,R5    :GET 2ND BYTE FROM BUFR
  3500	0116BC	C540 0045 	        CLHI    R4,45           :"E"?
  3501	0116C0	4320 8022 	        JLE     ATHRUE
  3502	0116C4	C440 000F 	        NHI     R4,0F
  3503	0116C8	D344 109E 	        LB      R4,BAKTBL,R4
  3504	0116CC	C850 0025 	        LHI     R5,25
  3505	0116D0	D245 0F24 	        STB     R4,BAKMSG,R5
  3506	0116D4	E660 0F24 	        LA      R6,BAKMSG
  3507	0116D8	D370 0F24 	        LB      R7,BAKMSG
  3508	0116DC	C850 0011 	        LHI     R5,11           :SET UP LOG REQUEST STRING
  3509	0116E0	D245 11DD 	        STB     R4,BKREQ3,R5    
  3510	0116E4	230D 		        JFS     PUTON3
  3511	0116E6	C850 0022 	ATHRUE  LHI     R5,22           :22 IN R5
  3512	0116EA	D245 0EFB 	        STB     R4,STRMSG,R5    :PUT USERNAME ID BYTE IN STRMSG
  3513	0116EE	E660 0EFB 	        LA      R6,STRMSG
  3514	0116F2	D370 0EFB 	        LB      R7,STRMSG
Page  11-13	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  3515	0116F6	C850 000F 	        LHI     R5,0F           :SET UP AUX REQUEST STRING
  3516	0116FA	D245 11C0 	        STB     R4,AXREQ3,R5
  3517	0116FE			PUTON3  EQ      .
  3518	0116FE	2451 		        LIS     R5,1            :1 IN R5
  3519	011700	D250 0FE9 	        STB     R5,CIRACT       :SET CIRACT FLAG
  3520	011704	D306 4500 0000 	STRTLO  LB      R0,0,R6,R5      :GET MSG BYTE
  3521	01170A	4140 F11A 	        JAL     R4,WCI          :SEND
  3522	01170E	2651 		        AIS     R5,1            :INCR   
  3523	011710	0957 		        CR      R5,R7           :END OF MSG?
  3524	011712	4320 FFEE 	        JLE     STRTLO          :IF NOT GET NXT BYT
  3525	011716	D310 0FE7 	        LB      R1,ORIGR1       :GET ORIG INP BUF IDX
  3526	01171A	4300 850E 	        J       RETURN
  3527				 
  3528	01171E			CHKSWI  EQ      .
  3529	01171E	D350 0CFB 	        LB      R5,IBXSWI       :GET IBXSWI VALUE
  3530	011722	0855 		        LR      R5,R5           :SET CC
  3531	011724	4330 8018 	        JE      USNFLG          :IF 0 SET USERNM2
  3532	011728	2451 		        LIS     R5,1            :OTHERWISE IT'S AN ERR TO LOG ONTO
  3533	01172A			NXTNO3  EQ      .               :MORE THAN 2 370 USERNAMES
  3534	01172A	D305 0DD7 	        LB      R0,TWOUNS,R5    :GET MSG BYTE
  3535	01172E	4140 F0F6 	        JAL     R4,WCI          :SEND
  3536	011732	2651 		        AIS     R5,1            :INC
  3537	011734	D450 0DD7 	        CLB     R5,TWOUNS       :END?
  3538	011738	4320 FFEE 	        JLE     NXTNO3
  3539	01173C	4300 8270 	        J       WRIPRM
  3540				 
  3541	011740			USNFLG  EQ      .
  3542	011740	D340 0D05 	        LB      R4,BYTE2        :GET 2ND BYTE FROM USRBUF
  3543	011744	D360 0CFE 	        LB      R6,USRNM1       :PUT USRNM1 VALUE IN R6
  3544	011748	0946 		        CR      R4,R6           : IF = THEN ALREADY LOGD ON THIS USERNMAE
  3545	01174A	4330 FEF0 	        JE      ALONMS          :TELL USR THIS USERNAME ALREADY LOD ON
  3546	01174E	D240 0CFF 	        STB     R4,USRNM2       :THIS IS THE 2ND USERNAME ID--SAVE IT
  3547	011752	4300 FF56 	        J       PICKUN          :PICK USERNAME BASED ON USRNM2
  3548				 
  3549	011756			ON370   EQ      .
  3550	011756	2451 		        LIS     R5,1
  3551	011758	D345 0D0E 	        LB      R4,USRBUF,R5    :GET 2ND BYTE FROM USRBUF
  3552	01175C	C540 000D 	        CLHI    R4,0D           :CR?
  3553	011760	4330 8122 	        JE      OHOSTS          :IF CR CHECK FIRST BYTE FOR ONT HOST ID
  3554				 
  3555	011764	2450 		        LIS     R5,0
  3556	011766	D345 0D0E 	        LB      R4,USRBUF,R5    :GET USRBUF BYTE
  3557	01176A	C540 0053 	        CLHI    R4,53           :"S"?
  3558	01176E	4230 8236 	        JN      BADINP
  3559	011772	2451 		        LIS     R5,1
  3560	011774	D345 0D0E 	        LB      R4,USRBUF,R5
  3561	011778	C540 0057 	        CLHI    R4,57           :"W"?
  3562	01177C	4230 8228 	        JN      BADINP
  3563	011780	2452 		        LIS     R5,2
  3564	011782	D345 0D0E 	        LB      R4,USRBUF,R5
  3565	011786	C540 0049 	        CLHI    R4,49           :"I"?
  3566	01178A	4230 821A 	        JN      BADINP
  3567				 
Page  11-14	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  3568	01178E	C800 003E 	        LHI     R0,3E
  3569	011792	4140 F092 	        JAL     R4,WCI
  3570	011796	D350 0CFB 	        LB      R5,IBXSWI       :IS 2ND 370 USERNAME LOGGED ON?
  3571	01179A	0855 		        LR      R5,R5           :SET CC
  3572	01179C	4330 80CE 	        JE      NEEDA3          :IF 0, NEED ANOTHER 370 LOG ON
  3573	0117A0	D350 0CF9 	        LB      R5,IBX370       :PUT 1ST 370 USRNAM IBX IN R5
  3574	0117A4	D250 0CFC 	        STB     R5,IBXOLD       :SAVE IN IBXOLD HOLDER
  3575	0117A8	D350 0CFB 	        LB      R5,IBXSWI       :PUT IBX OF 2ND USRNAM--THE ONE TO SWITCH TO--
  3576	0117AC	D250 0CF9 	        STB     R5,IBX370       :IN R5 AND SAVE AS "NEW" IBX370
  3577	0117B0	2450 		        LIS     R5,0            :0 OUT IBXSWI HOLDER
  3578	0117B2	D250 0CFB 	        STB     R5,IBXSWI       :0 OUT IBXSWI HOLDER
  3579	0117B6	D340 0CFE 	        LB      R4,USRNM1       :PUT USRNM1 IN USROLD
  3580	0117BA	D240 0D00 	        STB     R4,USROLD       :PUT USRNM1 IN USROLD
  3581	0117BE	D340 0CFF 	        LB      R4,USRNM2       :PUT USRNM2 IN USRNM1
  3582	0117C2	D240 0CFE 	        STB     R4,USRNM1       :PUT USRNM2 IN USRNM1
  3583	0117C6	2450 		        LIS     R5,0            :0 OUT USRNM2
  3584	0117C8	D250 0CFF 	        STB     R5,USRNM2       :0 OUT USRNM2
  3585				 
  3586	0117CC	4170 8ADC 	        JAL     R7,GETDAT       :GET DATE--NOW RENAME ALL FILES BASED ON DATE
  3587	0117D0	2480 		        LIS     R8,0            :INIT COUNTER
  3588	0117D2	D280 0CFD 	        STB     R8,ENDOHL       :SET END ONTYME HOST LIST FLAG TO 0
  3589	0117D6			RSETFN  EQ      .
  3590	0117D6	D358 1148 	        LB      R5,TBLONT,R8    :GET HOSTID FROM TBLONT
  3591	0117DA	C550 0048 	        CLHI    R5,MAXONT       :GOT LAST HOST ID?
  3592	0117DE	4330 8004 	        JE      SETEOL          :IF SO SET END OF LIST FLAG
  3593	0117E2	4300 8006 	        J       NOTEOL          :ELSE SKIP
  3594	0117E6	2471 		SETEOL  LIS     R7,1            :1 IN R7
  3595	0117E8	D270 0CFD 	        STB     R7,ENDOHL       :SET END OF ONTYME HOST LIST FLAG
  3596	0117EC			NOTEOL  EQ      .
  3597	0117EC	2681 		        AIS     R8,1            :INC R3
  3598	0117EE	D348 1148 	        LB      R4,TBLONT,R8    :GET BUF IDX FIELD FROM TBL
  3599	0117F2	2781 		        SIS     R8,1            :POINT BAK TO HOSTID FIELD
  3600	0117F4	0844 		        LR      R4,R4           :SET CC
  3601	0117F6	4330 804A 	        JE      SKPRFN          :IF 0 SKIP RENAME FILE NAME ROUTINE
  3602	0117FA	D280 0D04 	        STB     R8,R8VALU       :SAVE R8 VALUE FOR DEFLNM CALL
  3603	0117FE	4170 8B6A 	        JAL     R7,DEFLNM       :GET NEW FILENAME FOR THIS ONTYME HOST
  3604	011802	D380 0D04 	        LB      R8,R8VALU       :GET BACK VALU OF COUNTER
  3605	011806	2451 		        LIS     R5,1
  3606	011808			OPNEWF  EQ      .
  3607	011808	D305 0D16 	        LB      R0,BEGFIL,R5    :GET BEG FILE MSG BYTE
  3608	01180C	4140 F018 	        JAL     R4,WCI          :SEND
  3609	011810	2651 		        AIS     R5,1
  3610	011812	D450 0D16 	        CLB     R5,BEGFIL       :END OF MSG?
  3611	011816	4320 FFEE 	        JLE     OPNEWF
  3612	01181A	2451 		        LIS     R5,1            :INIT COUNTER
  3613	01181C	D360 100E 	        LB      R6,FNMPTR       :GET POINTER INTO FNMSTR
  3614	011820			NXTNEW  EQ      .
  3615	011820	D306 1158 	        LB      R0,FNMSTR,R6    :GET BYTE
  3616	011824	4140 F000 	        JAL     R4,WCI
  3617	011828	2661 		        AIS     R6,1
  3618	01182A	2651 		        AIS     R5,1
  3619	01182C	D450 1158 	        CLB     R5,FNMSTR
  3620	011830	4320 FFEC 	        JLE     NXTNEW
Page  11-15	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  3621	011834	C800 008A 	        LHI     R0,8A
  3622	011838	4140 EFEC 	        JAL     R4,WCI
  3623	01183C	C800 00BE 	        LHI     R0,0BE
  3624	011840	4140 EFE4 	        JAL     R4,WCI
  3625	011844			SKPRFN  EQ      .
  3626	011844	2684 		        AIS     R8,4            :INCREMENT COUNTER TO POINT TO NXT HOSTID
  3627	011846	D360 0CFD 	        LB      R6,ENDOHL       :CHECK ENDOHL FLAG
  3628	01184A	0866 		        LR      R6,R6           :SET CC
  3629	01184C	4330 FF86 	        JE      RSETFN          :IF 0 RESET NEXT FILE NAME
  3630	011850	2451 		        LIS     R5,1
  3631	011852			LOGORG  EQ      .               :ELSE LOG OFF ORIGINAL USERNAME
  3632	011852	D305 0DFC 	        LB      R0,SWIMSG,R5    :GET SWIMSG BYTE
  3633	011856	4140 EFCE 	        JAL     R4,WCI
  3634	01185A	2651 		        AIS     R5,1
  3635	01185C	D450 0DFC 	        CLB     R5,SWIMSG
  3636	011860	4320 FFEE 	        JLE     LOGORG
  3637				 
  3638	011864	D310 0CFC 	        LB      R1,IBXOLD       :PUT ORIGINAL USRNAM IBX IN R1
  3639	011868	2612 		        AIS     R1,2            :MAKE INTO OUT BUF IDX
  3640	01186A	4300 8106 	        J       LOGO3           :LOG OFF
  3641				 
  3642	01186E			NEEDA3  EQ      .
  3643	01186E	2451 		        LIS     R5,1
  3644	011870			NXTNSW  EQ      .
  3645	011870	D305 0D70 	        LB      R0,NOSWI,R5
  3646	011874	4140 EFB0 	        JAL     R4,WCI
  3647	011878	2651 		        AIS     R5,1
  3648	01187A	D450 0D70 	        CLB     R5,NOSWI
  3649	01187E	4320 FFEE 	        JLE     NXTNSW
  3650	011882	4300 812A 	        J       WRIPRM
  3651				 
  3652	011886			OHOSTS  EQ      .
  3653	011886	2450 		        LIS     R5,0
  3654	011888	D345 0D0E 	        LB      R4,USRBUF,R5    :GET USER INPUT
  3655	01188C	C540 0048 	        CLHI    R4,MAXONT       :IS IT A VALID HOST ID?
  3656	011890	4220 8114 	        JG      BADINP          :JUMP IF > VALID HOST ID
  3657	011894	C540 0045 	        CLHI    R4,MINONT       :IS IT VALID HOST?
  3658	011898	4210 810C 	        JL      BADINP          :BAD INPUT IF <
  3659	01189C	2450 		        LIS     R5,0
  3660	01189E			NXTOHO  EQ      .
  3661	01189E	D365 1148 	        LB      R6,TBLONT,R5    :GET HOST ID FROM TBLONT
  3662	0118A2	0946 		        CR      R4,R6           : = TO BYTE2?
  3663	0118A4	4330 8006 	        JE      GOTOHO          :JUMP I F =
  3664	0118A8	2654 		        AIS     R5,4            :ELSE INCREMENT
  3665	0118AA	4300 FFF0 	        J       NXTOHO          :GET NEXT ONTYME HOST ID
  3666	0118AE			GOTOHO  EQ      .
  3667	0118AE	2651 		        AIS     R5,1            :R5 NOW POINTS TO INP BUF IDX FIELD
  3668	0118B0	D365 1148 	        LB      R6,TBLONT,R5    :GET INP BUF IDX FROM TBLONT
  3669	0118B4	0866 		        LR      R6,R6           :SET CC
  3670	0118B6	4330 8018 	        JE      OKOHGO          :IF 0 THEN OK TO BUILD CIRC TO ONT HOST
  3671	0118BA	2451 		        LIS     R5,1
  3672	0118BC			NXTOAM  EQ      .
  3673	0118BC	D305 0DB3 	        LB      R0,OALLMS,R5    :GET MSG BYTE
Page  11-16	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  3674	0118C0	4140 EF64 	        JAL     R4,WCI          :SEND
  3675	0118C4	2651 		        AIS     R5,1
  3676	0118C6	D450 0DB3 	        CLB     R5,OALLMS       :END OF MSG?
  3677	0118CA	4320 FFEE 	        JLE     NXTOAM
  3678	0118CE	4300 80DE 	        J       WRIPRM
  3679				        
  3680	0118D2			OKOHGO  EQ      .
  3681	0118D2	D240 0FEA 	        STB     R4,HOSTID       :SAVE HOST ID
  3682	0118D6	2451 		        LIS     R5,1            :1 IN R5
  3683	0118D8	D250 0FE9 	        STB     R5,CIRACT       :SET CIRACT FLAG TO 1
  3684	0118DC	D250 0FEB 	        STB     R5,HOSTYP       :1 IN HOSTYP MEANS ONTYME HOST
  3685	0118E0	D250 0FDE 	        STB     R5,FLGONT       :SET FLGONT TO 1
  3686	0118E4	4300 80C8 	        J       WRIPRM
  3687				 
  3688	0118E8			CHKIFL  EQ      .
  3689	0118E8	C540 004C 	        CLHI    R4,4C           :"L"?
  3690	0118EC	4230 80B8 	        JN      BADINP          :IF NOT, BAD INPUT
  3691	0118F0	2454 		        LIS     R5,4            :CHECK 5TH BYT
  3692	0118F2	D345 0D0E 	        LB      R4,USRBUF,R5
  3693	0118F6	C540 004F 	        CLHI    R4,4F           :"O"?
  3694	0118FA	4230 80AA 	        JN      BADINP
  3695	0118FE	2455 		        LIS     R5,5            :CHECK 6TH BYTE
  3696	011900	D345 0D0E 	        LB      R4,USRBUF,R5
  3697	011904	C540 0047 	        CLHI    R4,47           :"G"?
  3698	011908	4230 809C 	        JN      BADINP
  3699				 
  3700	01190C	D350 0CFE 	        LB      R5,USRNM1       :GET USERNAME VALUE
  3701	011910	2461 		        LIS     R6,1            
  3702	011912	D346 0D0E 	        LB      R4,USRBUF,R6    :GET ID BYT FROM BUFR
  3703	011916	0945 		        CR      R4,R5           :SET CC
  3704	011918	4330 801A 	        JE      LOGUN1          :JUMP
  3705	01191C	D350 0CFF 	        LB      R5,USRNM2       :GET USRNAM2 VALUE
  3706	011920	0945 		        CR      R4,R5           
  3707	011922	4230 806A 	        JN      NOTON3
  3708				 
  3709	011926	C850 0022 	        LHI     R5,22           :POINT TO ID FIELD OF DISCO2 STR
  3710	01192A	D340 0CFF 	        LB      R4,USRNM2       :WE'RE LOGGING OFF USERNAME 2
  3711	01192E	D245 0D47 	        STB     R4,DISCO2,R5    :PUT IN STRING
  3712	011932	4300 800C 	        J       LOGOFF
  3713	011936	C850 0022 	LOGUN1  LHI     R5,22   
  3714	01193A	D340 0CFE 	        LB      R4,USRNM1       :LOGGING OFF USERNAME 1
  3715	01193E	D245 0D47 	        STB     R4,DISCO2,R5
  3716				 
  3717	011942			LOGOFF  EQ      .
  3718	011942	2451 		        LIS     R5,1            :INIT R5
  3719	011944			LEAV3M  EQ      .
  3720	011944	D305 0D47 	        LB      R0,DISCO2,R5    :gET DISCONNECT MSG BYTE
  3721	011948	4140 EEDC 	        JAL     R4,WCI          :SEND IT
  3722	01194C	2651 		        AIS     R5,1            :INCREM
  3723	01194E	D450 0D47 	        CLB     R5,DISCO2       :END OF MSG?
  3724	011952	4320 FFEE 	        JLE     LEAV3M          :IF NO GET NXT BYT
  3725	011956	D350 0CFE 	        LB      R5,USRNM1       :LOGGING OFF USRNM1?
  3726	01195A	2461 		        LIS     R6,1
Page  11-17	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  3727	01195C	D346 0D0E 	        LB      R4,USRBUF,R6    :GET USRNM ID BYTE FROM BUFR
  3728	011960	0945 		        CR      R4,R5           : = TO USRNM1?
  3729	011962	4230 8008 	        JN      SWINR1          :IF <> THEN LOG OFF IBXSWI
  3730	011966	D310 0CF9 	        LB      R1,IBX370       :PUT INP BUF IDX INR1
  3731	01196A	4300 8004 	        J       ADDR1
  3732	01196E	D310 0CFB 	SWINR1  LB      R1,IBXSWI       :GET IBXSWI 
  3733	011972	2612 		ADDR1   AIS     R1,2            :MAKE INTO OUT BUF IDX
  3734	011974			LOGO3   EQ      .
  3735	011974	2451 		        LIS     R5,1            :INIT R5
  3736	011976			PUTLOG  EQ      .
  3737	011976	D305 100F 	        LB      R0,LOGMSG,R5    :GET LOGOUT MSG BYTE
  3738	01197A	4140 EEAA 	        JAL     R4,WCI
  3739	01197E	2651 		        AIS     R5,1            :INCR
  3740	011980	D450 100F 	        CLB     R5,LOGMSG       :END OF MSG?
  3741	011984	4320 FFEE 	        JLE     PUTLOG          :IF NOT GET NXT BYT
  3742	011988	D310 0FE7 	        LB      R1,ORIGR1       :GET INP BUF IDX
  3743	01198C	4300 829C 	        J       RETURN
  3744				 
  3745	011990			NOTON3  EQ      .
  3746	011990	2451 		        LIS     R5,1
  3747	011992			NOTON   EQ      .
  3748	011992	D305 0E3B 	        LB      R0,NONMSG,R5
  3749	011996	4140 EE8E 	        JAL     R4,WCI
  3750	01199A	2651 		        AIS     R5,1
  3751	01199C	D450 0E3B 	        CLB     R5,NONMSG
  3752	0119A0	4320 FFEE 	        JLE     NOTON
  3753	0119A4	4300 8008 	        J       WRIPRM
  3754				 
  3755	0119A8			BADINP  EQ      .
  3756	0119A8	C800 003F 	        LHI     R0,3F           :PUT ? IN R0
  3757	0119AC	4140 EE78 	        JAL     R4,WCI          :SEND IT
  3758	0119B0			WRIPRM  EQ      .
  3759	0119B0	C800 008D 	        LHI     R0,8D           :CR IN R0
  3760	0119B4	4140 EE70 	        JAL     R4,WCI          :SEND IT OUT
  3761	0119B8	C800 008A 	        LHI     R0,8A           :LF IN R0
  3762	0119BC	4140 EE68 	        JAL     R4,WCI          :SEND IT OUT
  3763	0119C0	C800 003E 	        LHI     R0,3E           :PROMPT CHAR IN R0
  3764	0119C4	4140 EE60 	        JAL     R4,WCI          :SEND IT OUT
  3765	0119C8	D310 0FE7 	        LB      R1,ORIGR1       :R1 NOW POINTS TO INP BUF IDX
  3766	0119CC	4300 825C 	        J       RETURN
  3767				 
  3768				 
  3769	0119D0			NEEDLE   EQ      .               :IT'S A NEEDLE
  3770	0119D0	2451 		        LIS     R5,1            :PUT 1 IN R5
  3771	0119D2	D450 0FE0 	        CLB     R5,USERON       :DOES USERON FLG = 1?
  3772	0119D6	4330 8252 	        JE      RETURN          :IF SO, REJECT THIS NEEDLE
  3773	0119DA	D250 0FE0 	        STB     R5,USERON       :ELSE SET USERON FLG TO 1
  3774	0119DE	2612 		        AIS     R1,2            :GET OUT BUFFER
  3775	0119E0	D210 0FED 	        STB     R1,USROPB       :SAVE USER'S OUTPUT BUFFER IDX
  3776	0119E4	2451 		        LIS     R5,1            :INIT COUNTER
  3777				 
  3778	0119E6			HELMSG  EQ      .
  3779	0119E6	D305 101D 	        LB      R0,HELLO,R5     :GET BYTE
Page  11-18	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  3780	0119EA	4140 EE3A 	        JAL     R4,WCI          :SEND IT OUT
  3781	0119EE	2651 		        AIS     R5,1            :INCREMENT
  3782	0119F0	D450 101D 	        CLB     R5,HELLO        :END OF MSG?
  3783	0119F4	4320 FFEE 	        JLE     HELMSG          :IF NOT GET NEXT BYTE
  3784	0119F8	C800 003E 	        LHI     R0,3E           :PROMPT CHAR IN R0
  3785	0119FC	4140 EE28 	        JAL     R4,WCI          :SEND IT
  3786				
  3787	011A00	2712 		        SIS     R1,2            :MAKE INPUT BUFFER
  3788	011A02	C820 0080 	        LHI     R2,(NPORT-1)*4  :INIT COUNTER FOR ALL PORTS
  3789	011A06	E630 8028 	        LA      R3,AUXBLD       :BUILD AUX CIRC PROCESS PTR
  3790	011A0A	E640 11FC 	        LA      R4,AUXBRK       :GET ADDR FOR AUX BREAK TBLE
  3791	011A0E	E650 127C 	        LA      R5,AXBTBL       :MBREAK TBLE FOR BUILD AUX CIRC PROCESS
  3792	011A12			AUXINI  EQ      .
  3793	011A12	0921 		        CR      R2,R1           :DOES R2 = USER INPUT BUF IDX?
  3794	011A14	4330 800C 	        JE      GETNIX          :IF SO, SKIP AND GET NEXT BUF IDX
  3795	011A18	5032 089C 	        ST      R3,PROCESS,R2   :STORE AUX PROCESS ADDRE
  3796	011A1C	5042 0794 	        ST      R4,BREAK,R2     :STORE AUX BREAK ADDR
  3797	011A20	5052 0818 	        ST      R5,MBREAK,R2    :STORE AUXBLD BREAK ADDR
  3798	011A24	2724 		GETNIX  SIS     R2,4            :DECREMENT COUNTER
  3799	011A26	4230 FFE8 	        JN      AUXINI          :IF NOT 0, INIT NEXT PROCESS ARRAY ELEMENT
  3800	011A2A	4300 81FE 	        J       RETURN
  3801				 
  3802	011A2E			USRISM  EQ      .
  3803	011A2E	4300 81FA 	        J       RETURN
  3804				 
  3805	011A32			AUXBLD  EQ      .
  3806	011A32	0800 		        LR      R0,R0           :SET CC
  3807	011A34	4330 81F4 	        JE      RETURN          :IGNORE DATA MSG
  3808	011A38	4210 8334 	        JL      LOGIN2          :IF NEEDLE, CHECK FOR USER2 LOG-IN
  3809	011A3C	D350 0FE3 	NOU2GO  LB      R5,US2ACT       :DID USER2 INITIATE ACTION? (WAS FLAG SET?)
  3810	011A40	0855 		        LR      R5,R5           :SET CC
  3811	011A42	4230 8370 	        JN      U2AUXB          :IF FLAG=1, JUMP TO USER2 BUILD AUX CIRC CODE
  3812	011A46	C500 00B6 	        CLHI    R0,0B6          :B6 MSG?
  3813	011A4A	4230 814C 	        JN      CHKB5          :IF NOT, CHECK FOR B5 OR ZAP
  3814				 
  3815	011A4E	D340 0FEB 	        LB      R4,HOSTYP       :PUT HOSTYP IN R4
  3816	011A52	C540 0003 	        CLHI    R4,03           :IS IT A 370?
  3817	011A56	4330 80E4 	        JE      SET370          :IF SO, SET THE 370 TBLE
  3818	011A5A	D340 0FEA 	        LB      R4,HOSTID       :PUT HOSTID IN R4
  3819	011A5E	2450 		        LIS     R5,0            :INIT COUNTER
  3820	011A60			LOKTBL  EQ      .
  3821	011A60	D365 1148 	        LB      R6,TBLONT,R5    :GET HOST ID BTYE FROM TABLE
  3822	011A64	0964 		        CR      R6,R4           :EQUAL TO HOSTID?
  3823	011A66	4330 8006 	        JE      SETIDX          :IF SO, PUT BUFIDX IN TBLE
  3824	011A6A	2654 		        AIS     R5,4            :INCREMENT POINTER
  3825	011A6C	4300 FFF0 	        J       LOKTBL          :GET NEXT BYTE
  3826	011A70			SETIDX  EQ      .
  3827	011A70	2651 		        AIS     R5,1            :INCREMENT POINTER
  3828	011A72	D345 1148 	        LB      R4,TBLONT,R5    :IF BUFR IDX ALREADY HERE, IGNORE THIS B6
  3829	011A76	4230 81B2 	        JN      RETURN
  3830	011A7A	D215 1148 	        STB     R1,TBLONT,R5    :SAVE BUF IDX IN TBLE
  3831	011A7E	D210 0FE7 	        STB     R1,ORIGR1       :SAVE ORIGINAL R1
  3832	011A82	D310 0FED 	        LB      R1,USROPB       :PUT USER'S OUT BUF IN R1
Page  11-19	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  3833	011A86	2451 		        LIS     R5,1            :INIT R5
  3834	011A88			NEXTOK  EQ      .
  3835	011A88	D305 0EE3 	        LB      R0,OKMSG,R5     :GET OK MSG BYTE
  3836	011A8C	4140 ED98 	        JAL     R4,WCI          :SEND
  3837	011A90	2651 		        AIS     R5,1            :INCREMENT
  3838	011A92	D450 0EE3 	        CLB     R5,OKMSG        :END OF MSG?
  3839	011A96	4320 FFEE 	        JLE     NEXTOK          :JUMP IF NOT
  3840	011A9A	C800 003E 	        LHI     R0,3E           :PROMPT CHAR IN R0
  3841	011A9E	4140 ED86 	        JAL     R4,WCI          :SEND IT OUT
  3842	011AA2	4170 8806 	        JAL     R7,GETDAT       :GET DATE STRING
  3843	011AA6	D350 0FEA 	        LB      R5,HOSTID       :PUT HOSTID IN R5 FOR DEFLNM CALL
  3844	011AAA	4170 88BE 	        JAL     R7,DEFLNM       :DEFINE FILE NAME FOR THIS TRACE SESSION
  3845	011AAE	2451 		        LIS    R5,1            :INIT R5
  3846	011AB0			NXTOPN  EQ      .
  3847	011AB0	D305 0D16 	        LB      R0,BEGFIL,R5    :GET OPENING FILE MSG
  3848	011AB4	4140 ED70 	        JAL     R4,WCI          :SEND IT
  3849	011AB8	2651 		        AIS     R5,1            :INCREMENT
  3850	011ABA	D450 0D16 	        CLB     R5,BEGFIL       :END?
  3851	011ABE	4320 FFEE 	        JLE     NXTOPN          :IF NOT GET NEXT BYTE
  3852	011AC2	2451 		        LIS     R5,1            :INIT
  3853	011AC4	D360 100E 	        LB      R6,FNMPTR       :GET FNMPTR
  3854	011AC8			NXTFIL  EQ      .
  3855	011AC8	D306 1158 	        LB      R0,FNMSTR,R6    :GET FILE NAME STRING BYTE
  3856	011ACC	4140 ED58 	        JAL     R4,WCI          :SEND IT
  3857	011AD0	2651 		        AIS     R5,1            :INCREMETN
  3858	011AD2	2661 		        AIS     R6,1            :INCREMTN PTR INTO FNMSTR
  3859	011AD4	D450 1158 	        CLB     R5,FNMSTR       :END OF FILE NAME STRING?
  3860	011AD8	4320 FFEC 	        JLE     NXTFIL          :IF NOT GET NEXT BYTE
  3861	011ADC	C800 008A 	        LHI     R0,8A           :LF
  3862	011AE0	4140 ED44 	        JAL     R4,WCI          :SEND
  3863	011AE4	C800 00BE 	        LHI     R0,0BE             :">" IN R0
  3864	011AE8	4140 ED3C 	        JAL     R4,WCI          :SEND
  3865				 
  3866	011AEC	D310 0FE7 	        LB      R1,ORIGR1       :GET INP BUF IDX
  3867	011AF0	2612 		        AIS     R1,2            :MAKE INTO OUTPUT BUF
  3868	011AF2	2451 		        LIS     R5,1            :INIT R5 TO 1
  3869	011AF4			STRTRA  EQ      .
  3870	011AF4	D305 0FF4 	        LB      R0,TRAMSG,R5    :GET START TRACE MSG BYTE
  3871	011AF8	4140 ED2C 	        JAL     R4,WCI          :SEND IT OUT
  3872	011AFC	2651 		        AIS     R5,1            :INCREMENT
  3873	011AFE	D450 0FF4 	        CLB     R5,TRAMSG       :END OF MSG?
  3874	011B02	4320 FFEE 	        JLE     STRTRA          :IF NOT, GET NEXT BYTE
  3875	011B06	2450 		        LIS     R5,0
  3876	011B08	D305 0D06 	STRTR0  LB      R0,OHOPIX,R5            :ONTYME HOST OP IDX ARRAY
  3877	011B0C	2333 		        JEFS    STRTR1                  :GOT EMTPY ARRAY BYTE
  3878	011B0E	2651 		        AIS     R5,1
  3879	011B10	2204 		        JBS     STRTR0
  3880	011B12	D215 0D06 	STRTR1  STB     R1,OHOPIX,R5            :SAVE OP IDX IN ARRAY
  3881	011B16	2712 		        SIS     R1,2            :POINT BACK TO INP BUF
  3882	011B18	E640 8126 	        LA      R4,AUXWRI       :ADDR OF AUX CIRC WRITE PROCESS
  3883	011B1C	E650 125C 	        LA      R5,WRMTBL       :ADDR OF MSG BRK FOR AUX WRITE
  3884	011B20	E660 11FC 	        LA      R6,AUXBRK       :GET ADDR FOR AUX BREAK TBLE
  3885	011B24	5041 089C 	        ST      R4,PROCESS,R1   :STORE IN PROCESS ARRAY 
Page  11-20	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  3886	011B28	5051 0818 	        ST      R5,MBREAK,R1    :STORE IN MBREAK ARRAY
  3887	011B2C	5061 0794 	        ST      R6,BREAK,R1     :STORE AUX BREAK ADDR
  3888				        
  3889	011B30	2450 		        LIS     R5,0            :0 IN R5
  3890	011B32	D250 0FEB 	        STB     R5,HOSTYP       :SET HOSTYP TO 0
  3891	011B36	D250 0FE9 	        STB     R5,CIRACT       :SET CIRACT TO 0
  3892	011B3A	4300 80EE 	        J       RETURN
  3893				 
  3894	011B3E			SET370  EQ      .
  3895	011B3E	D210 0FE7 	        STB     R1,ORIGR1       :SAVE ORIGR1 VALUE
  3896	011B42	D350 0CF9 	        LB      R5,IBX370
  3897	011B46	0855 		        LR      R5,R5
  3898	011B48	4330 8008 	        JE      ITSX3           :IF IBX370 = 0 THEN IT'S 1ST LOGIN
  3899	011B4C	D210 0CFB 	        STB     R1,IBXSWI       :OTHERWISE, IT'S 2ND 370 LOGIN
  3900	011B50	4300 8004 	        J       SKIPX3          :SKIP SETTING IBX370
  3901	011B54	D210 0CF9 	ITSX3   STB     R1,IBX370       :SAVE R1 IN IBX370
  3902	011B58			SKIPX3  EQ      .
  3903	011B58	2451 		        LIS     R5,1            :1 IN R5
  3904	011B5A	D310 0FED 	        LB      R1,USROPB       :PUT USER'S OUT BUF IDX IN R1
  3905	011B5E			NXTOK3  EQ      .
  3906	011B5E	D305 0EE8 	        LB      R0,OKMSG3,R5    :GET OKMSG BYTE
  3907	011B62	4140 ECC2 	        JAL     R4,WCI          :SEND
  3908	011B66	2651 		        AIS     R5,1            :INCREMENT
  3909	011B68	D450 0EE8 	        CLB     R5,OKMSG3       :END OF MSG?
  3910	011B6C	4320 FFEE 	        JLE     NXTOK3          :IF NOT GET NXT BYTE
  3911	011B70	D310 0FE7 	        LB      R1,ORIGR1       :GET ORIG INP BUF IDX IN R1
  3912	011B74	E640 80C0 	        LA      R4,WRI370       :GET ADDR OF AUX CIRC WRITE TO 370 PROCESS
  3913	011B78	E650 123C 	        LA      R5,W370TB       :BREAK MSG FOR 370 CIRCUIT
  3914	011B7C	E660 11FC 	        LA      R6,AUXBRK       :GET ADDR FOR AUX BREAK ARRAY
  3915	011B80	5041 089C 	        ST      R4,PROCESS,R1   :SAVE IT IN PROCESS ARRAY
  3916	011B84	5051 0818 	        ST      R5,MBREAK,R1    :SAVE MBREAK TBL IN ARRAY
  3917	011B88	5061 0794 	        ST      R6,BREAK,R1     :SAVE BREAK ADDR FOR AUX WRITE
  3918	011B8C	2450 		        LIS     R5,0            :0 IN R5
  3919	011B8E	D250 0FEB 	        STB     R5,HOSTYP       :0 OUT HOSTYP
  3920	011B92	D250 0FE9 	        STB     R5,CIRACT       :0 OUT CIRACT
  3921	011B96	4300 8092 	        J       RETURN
  3922				 
  3923	011B9A			CHKB5  EQ      .
  3924	011B9A	D340 0FEB 	        LB      R4,HOSTYP       :PUT HOSTYP IN R4
  3925	011B9E	C540 0003 	        CLHI    R4,03           :IF = 3, IT'S A 370
  3926	011BA2	4330 8036 	        JE      NO370           :IF 370, JUMP TO NO 370 CIRC ROUTINE
  3927				
  3928	011BA6	D210 0FE7 	        STB     R1,ORIGR1       :SAVE ORIGINAL R1
  3929	011BAA	D310 0FED 	        LB      R1,USROPB       :PUT USER'S OUT BUF IN R1
  3930	011BAE	2451 		        LIS     R5,1            :INIT R5
  3931	011BB0			NEXTNA  EQ      .
  3932	011BB0	D305 0E58 	        LB      R0,NAVMSG,R5    :GET NOT AVAIL MSG BYTE
  3933	011BB4	4140 EC70 	        JAL     R4,WCI          :SEND
  3934	011BB8	2651 		        AIS     R5,1            :INCR
  3935	011BBA	D450 0E58 	        CLB     R5,NAVMSG       :END OF MSG?
  3936	011BBE	4320 FFEE 	        JLE     NEXTNA          :IF NOT GET NXT BYT
  3937	011BC2	C800 003E 	        LHI     R0,3E           :PROMPT CHAR IN R0
  3938	011BC6	4140 EC5E 	        JAL     R4,WCI          :SEND IT
Page  11-21	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  3939	011BCA	D310 0FE7 	        LB      R1,ORIGR1       :POINT BACK TO ORIG BUF IDX
  3940	011BCE	2450 		        LIS     R5,0            :0 IN R5
  3941	011BD0	D250 0FE9 	        STB     R5,CIRACT       :SET CIRACT TO 0
  3942	011BD4	D250 0FEB 	        STB     R5,HOSTYP       :SET HOSTYP TO 0
  3943	011BD8	4300 8050 	        J       RETURN
  3944				 
  3945	011BDC			NO370   EQ      .
  3946	011BDC	D310 0FED 	        LB      R1,USROPB       :USER'S OP BUF IN R1
  3947	011BE0	2451 		        LIS     R5,1            :INIT R5
  3948	011BE2			NXTNA3  EQ      .
  3949	011BE2	D305 0E68 	        LB      R0,NAMSG3,R5    :GET NO AVAIL MSG BYTE
  3950	011BE6	4140 EC3E 	        JAL     R4,WCI          :SEND
  3951	011BEA	2651 		        AIS     R5,1            :INCR
  3952	011BEC	D450 0E68 	        CLB     R5,NAMSG3       :END OF MSG?
  3953	011BF0	4320 FFEE 	        JLE     NXTNA3          :IF NOT GET NXT BYT
  3954	011BF4	D310 0FE7 	        LB      R1,ORIGR1       :PUT ORIGR1 IN R1
  3955	011BF8	2450 		        LIS     R5,0            :0 IN R5
  3956	011BFA	D250 0FEB 	        STB     R5,HOSTYP       :SET HOSTYP TO 0
  3957	011BFE	D250 0FE9 	        STB     R5,CIRACT       :SET CIRACT TO 0
  3958	011C02	4300 8026 	        J       RETURN
  3959				 
  3960				 
  3961	011C06			GONMSG  EQ      .
  3962	011C06	2451 		        LIS     R5,1            :INIT R5
  3963	011C08			NXTGON  EQ      .
  3964	011C08	D305 0E7D 	        LB      R0,CIRGON,R5    :GET CIRCUIT GONE MSG BYTE
  3965	011C0C	4140 EC18 	        JAL     R4,WCI          :SEND IT
  3966	011C10	2651 		        AIS     R5,1            :INCREMNT
  3967	011C12	D450 0E7D 	        CLB     R5,CIRGON       :END OF MSG?
  3968	011C16	4320 FFEE 	        JLE     NXTGON          :IF NOT GET NEXT VBYTE
  3969	011C1A	D300 0FEC 	        LB      R0,CURHID       :PUT CURRENT HOSTID IN R0
  3970	011C1E	4140 EC06 	        JAL     R4,WCI          :SEND IT
  3971	011C22	D300 0FEC 	        LB      R0,CURHID       :AGAIN
  3972	011C26	4140 EBFE 	        JAL     R4,WCI          :SEND
  3973	011C2A	0306 		        JR      R6              :RETURN
  3974				 
  3975	011C2C			RETURN  EQ      .
  3976	011C2C	4140 EE10 	        JAL     R4,EMPTY        :FLUSH BUFFER
  3977	011C30	030F 		        JR      R15             :RETURN
  3978				 
  3979	011C32			IMSG0   EQ      .
  3980	011C32	4140 EE0A 	        JAL     R4,EMPTY        :FLUSH BUFFER
  3981	011C36	030F 		        JR      R15             :RETURN
  3982				 
  3983	011C38			WRI370  EQ      .
  3984	011C38	0800 		        LR      R0,R0   
  3985	011C3A	4220 846C 	        JG      ISM370          :JUMP TO ISIS MSG HNADLER
  3986	011C3E	4300 FFEA 	        J       RETURN          :IGNORE DATA BREAK OR < 0 MSG FROM 370
  3987				 
  3988				
  3989				Page  11-22	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  3990				
  3991				:       HANDLER FOR INPUT DATA AND ISIS MSGS FROM ONTYME HOSTS
  3992	011C42			AUXWRI  EQ      .
  3993	011C42	D210 0FE7 	        STB     R1,ORIGR1       :SAVE ORIG IN BUF IDX
  3994	011C46	0800 		        LR      R0,R0           :SET CC
  3995	011C48	4210 FFE0 	        JL      RETURN          :IF NEEDLE, THROW AWAY
  3996	011C4C	4220 83A6 	        JG      AUXISM          :CHECK ISIS MSG
  3997				 
  3998	011C50	2451 		        LIS     R5,1            :INIT TBLONT PTR
  3999	011C52			NXTBIX  EQ      .
  4000	011C52	D365 1148 	        LB      R6,TBLONT,R5    :GET BUF IDX FROM TBL
  4001	011C56	0916 		        CR      R1,R6           :EQUAL TO BUF IDX?
  4002	011C58	4330 8006 	        JE      GET3IX          :GET BUF IDX OF 370
  4003	011C5C	2654 		        AIS     R5,4            :INCREMENT TBLONT PTR
  4004	011C5E	4300 FFF0 	        J       NXTBIX          :GET NXT BUF IDX FROM TBL
  4005				 
  4006	011C62			GET3IX  EQ      .
  4007	011C62	D360 0CF9 	        LB      R6,IBX370       :GET INP BUF IDX FOR 370
  4008	011C66	2662 		        AIS     R6,2            :MAKE INTO OUT BUF IDX
  4009	011C68	D260 0FF3 	        STB     R6,OUTBIX       :SAVE OUTPUT BUF FOR WRITE TO 370
  4010	011C6C	2751 		        SIS     R5,1            :DECREMENT R5
  4011	011C6E	D365 1148 	        LB      R6,TBLONT,R5     :SAVE CURRENT HOSTID FROM TBLE
  4012	011C72	D260 0FEC 	        STB     R6,CURHID       :SAVE HOSTID FROM TBLE
  4013	011C76	2652 		        AIS     R5,2            :NOW POINT TO DATE FIELD IN TBLONT
  4014	011C78	4865 1148 	        LH      R6,TBLONT,R5    :GET FILE DATE
  4015	011C7C	4060 0FCA 	        STH     R6,FILDAT       :SAVE 
  4016				 
  4017	011C80	2450 		        LIS     R5,0            :INIT R5
  4018	011C82			GETINP  EQ      .
  4019	011C82	4140 EB22 	        JAL     R4,GCI          :GET CHAR FROM BUFFER
  4020	011C86	C400 007F 	        NHI     R0,007F         :TURN OFF PARITY BIT
  4021	011C8A	C500 000D 	        CLHI    R0,0D           :CR?
  4022	011C8E	4330 8024 	        JE      ENDAWR          :IF SO, IT'S END OF LINE
  4023	011C92	C500 000A 	        CLHI    R0,0A           :LF?
  4024	011C96	2337 		        JEFS    SKIPLF          :IF LF THEN DONT PUT IN MSGBUF
  4025	011C98	C500 0023 	        CLHI    R0,23           :IS IT A POUND SIGN? (#)
  4026	011C9C	2336 		        JEFS    PNDSGN          :YES, REPLACE IT WITH A (-)
  4027	011C9E	D205 0BA0 	        STB     R0,MSGBUF,R5    :PUT BYTE IN MSGBUF
  4028	011CA2	2651 		        AIS     R5,1            :INCREMENT
  4029	011CA4	4300 FFDA 	SKIPLF  J       GETINP          :GET NEXT BYTE
  4030	011CA8	C800 002D 	PNDSGN  LHI     R0,2D           :GET A (-)
  4031	011CAC	D205 0BA0 	        STB     R0,MSGBUF,R5
  4032	011CB0	2651 		        AIS     R5,1
  4033	011CB2	4300 FFCC 	        J       GETINP
  4034				 
  4035	011CB6			ENDAWR  EQ      .
  4036	011CB6	D205 0BA0 	        STB     R0,MSGBUF,R5    :PUT CR IN MSGBUF
  4037	011CBA	D250 0FDF 	        STB     R5,CURLEN       :SAVE CURRENT LENGHT OF LINE
  4038	011CBE	5830 400F 000C 	        L       R3,GMT,,        :GET GMT
  4039	011CC4	4150 E892 	        JAL     R5,DATE         :THIS RETURNS DATIME STAMP IN R6
  4040	011CC8	F460 FFFF 0000 	        NI      R6,0FFFF0000    :AND OUT HOUR AND MINUTE BYTES
  4041	011CCE	EC60 0010 	        SRL     R6,10           :SHIFT RIGHT 16 BITS
  4042	011CD2	4560 0FCA 	        CLH     R6,FILDAT       :FILDATE = TO CUR DATE?
Page  11-23	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  4043	011CD6	4330 800C 	        JE      SAMFIL          :SKIP ROUTINE TO GET NEW FILE NAME
  4044	011CDA	4170 85CE 	        JAL     R7,GETDAT       :GET DATE STRING
  4045	011CDE	D350 0FEC 	        LB      R5,CURHID       :PUT CURHID IN R5 FOR DEFLNM CALL
  4046	011CE2	4170 8686 	        JAL     R7,DEFLNM       :GET NEW FILE NAME
  4047	011CE6			SAMFIL  EQ      .
  4048	011CE6	D310 0FF3 	        LB      R1,OUTBIX       :PUT OUTPUT BUF IDX IN R1
  4049	011CEA	2451 		        LIS     R5,1            :INIT R5
  4050				:diskio call is in format:  'DISKIO W <filename> <filetype> / <data to write>'
  4051	011CEC			NXTDIO  EQ      .
  4052	011CEC	D305 1004 	        LB      R0,DIOMSG,R5    :PUT DISKIO CALL MSG BYTE IN R0
  4053	011CF0	4140 EB34 	        JAL     R4,WCI          :SEND IT OUT
  4054	011CF4	2651 		        AIS     R5,1            :INCREMENT
  4055	011CF6	D450 1004 	        CLB     R5,DIOMSG       :END OF MSG?
  4056	011CFA	4320 FFEE 	        JLE     NXTDIO          :IF NOT GET NEXT BYTE
  4057	011CFE	2451 		        LIS     R5,1            :INIT R5
  4058	011D00	D370 0FEC 	        LB      R7,CURHID       :PUT CURRENT HOSTID IN R7
  4059	011D04			FNDFNM  EQ      .
  4060	011D04	D365 1158 	        LB      R6,FNMSTR,R5    :GET HOSTID BYTE FROM FNMSTR
  4061	011D08	0967 		        CR      R6,R7           := TO HOSTID?
  4062	011D0A	4330 8008 	        JE      GOTFNM          :JUMP IF FOUND
  4063	011D0E	CA50 000C 	        AHI     R5,0C           :ELSE POINT TO NEXT HOSTID BYTE IN FNMSTR
  4064	011D12	4300 FFEE 	        J       FNDFNM          :CHECK NEXT FILE NAME STRING
  4065	011D16			GOTFNM  EQ      .
  4066	011D16	2471 		        LIS     R7,1            :INIT COUNTER
  4067	011D18			NXTFNM  EQ      .
  4068	011D18	D305 1158 	        LB      R0,FNMSTR,R5    :GET FILE NAME BYTE
  4069	011D1C	4140 EB08 	        JAL     R4,WCI          :ELSE SEND OUT BYTE
  4070	011D20	2651 		        AIS     R5,1            :INCREMENT
  4071	011D22	2671 		        AIS     R7,1            :INCREMENT
  4072	011D24	D470 1158 	        CLB     R7,FNMSTR       :END OF FNMSTR?
  4073	011D28	4320 FFEC 	        JLE     NXTFNM          :GET NEXT BYTE
  4074	011D2C	C800 0020 	        LHI     R0,20            :SPACE IN R0
  4075	011D30	4140 EAF4 	        JAL     R4,WCI          :SEND IT OUT
  4076	011D34	C800 00AF 	        LHI     R0,0AF           :"/" IN R0--THIS IS PART OF DISKIO CONVENTION
  4077	011D38	4140 EAEC 	        JAL     R4,WCI          :SEND IT OUT
  4078	011D3C	C800 0020 	        LHI     R0,20            :SPACE IN R0
  4079	011D40	4140 EAE4 	        JAL     R4,WCI          :SEND IT OUT
  4080	011D44	D350 0FDF 	        LB      R5,CURLEN       :LENGTH=0
  4081	011D48	2137 		        JNFS    INITR5          :NO
  4082	011D4A	D300 0BA0 	        LB      R0,MSGBUF       :YES, GET THE BYTE 
  4083	011D4E	4140 EAD6 	        JAL     R4,WCI          :SEND IT
  4084	011D52	4300 8012 	        J       ONEBYT          :AND GET OUT
  4085	011D56			INITR5  EQ      .
  4086	011D56	2450 		        LIS     R5,0            :INIT R5
  4087	011D58			WRITO3  EQ      .
  4088	011D58	D305 0BA0 	        LB      R0,MSGBUF,R5    :PUT BYTE IN R0 FROM MSGBUF
  4089	011D5C	4140 EAC8 	        JAL     R4,WCI          :SEND IT OUT
  4090	011D60	2651 		        AIS     R5,1            :INCREMENT
  4091	011D62	D450 0FDF 	        CLB     R5,CURLEN       :END OF MSG?
  4092	011D66	2227 		        JLEBS   WRITO3          :IF NOT, GET NEXT BYTE
  4093				
  4094	011D68	D310 0FE7 	ONEBYT  LB      R1,ORIGR1         
  4095	011D6C	4300 FEBC 	        J       RETURN
Page  11-24	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  4096				
  4097				
  4098				Page  11-25	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  4099				
  4100				:       2ND USER LOGON
  4101	011D70			LOGIN2  EQ      . 
  4102	011D70	D350 0FE1 	        LB      R5,USR2ON       :IS USER 2 LOGGED IN?
  4103	011D74	4230 FEB4 	        JN      RETURN          :IF SO, REJECT THIS LOGON
  4104	011D78	2451 		        LIS     R5,1
  4105	011D7A	D250 0FE1 	        STB     R5,USR2ON       :ELSE SET USR2ON FLAG
  4106				 
  4107	011D7E	2612 		        AIS     R1,2            :GET OUT BUF IDX
  4108	011D80	D210 0FE2 	        STB     R1,US2OPB       :SAVE USER2 OUT BUF IDX
  4109	011D84	2451 		        LIS     R5,1
  4110	011D86			HELMS2  EQ      .
  4111	011D86	D305 1041 	        LB      R0,HELLO2,R5    :GET HELLO USER 2 MSG BYTE
  4112	011D8A	4140 EA9A 	        JAL     R4,WCI
  4113	011D8E	2651 		        AIS     R5,1
  4114	011D90	D450 1041 	        CLB     R5,HELLO2       :END OF MSG?
  4115	011D94	4320 FFEE 	        JLE     HELMS2
  4116	011D98	C800 003E 	        LHI     R0,3E
  4117	011D9C	4140 EA88 	        JAL     R4,WCI
  4118				         
  4119	011DA0	2712 		        SIS     R1,2            :GET BACK TO INP BUF IDX
  4120	011DA2	E640 80F4 	        LA      R4,USR2IN       :POINT TO USER 2 PROCESS
  4121	011DA6	5041 089C 	        ST      R4,PROCESS,R1   :SAVE IN PROCESS ARRAY
  4122	011DAA	E640 125C 	        LA      R4,WRMTBL       :POINT TO MBREAK TBLE
  4123	011DAE	5041 0818 	        ST      R4,MBREAK,R1    :SAVE
  4124	011DB2	4300 FE76 	        J       RETURN
  4125				 
  4126	011DB6			U2AUXB  EQ      .
  4127	011DB6	C500 00B6 	        CLHI    R0,0B6          :B6 MSG?
  4128	011DBA	4230 8026 	        JN      USR2B5          :IF NOT, IT'S B5 MSG FOR USER 2
  4129	011DBE	2612 		        AIS     R1,2            :GET OUT BUF IDX
  4130	011DC0	D210 0FE4 	        STB     R1,U2HOST       :SAVE OUT BUF IDSX FOR USER2'S HOST
  4131	011DC4	2712 		        SIS     R1,2            :BACK TO INP BUF IDX
  4132	011DC6	E640 81CE 	        LA      R4,U2HDAT       :PT TO PROCESS FOR DATA FROM USER2'S HOST
  4133	011DCA	5041 089C 	        ST      R4,PROCESS,R1   :SAVE IN PROCESS ARRAY
  4134	011DCE	E640 125C 	        LA      R4,WRMTBL       :BREAK TBLE FOR PROCESS
  4135	011DD2	5041 0818 	        ST      R4,MBREAK,R1    :SAVE
  4136	011DD6	2450 		        LIS     R5,0    
  4137	011DD8	D250 0FE9 	        STB     R5,CIRACT       :0 OUT CIRACTG FLAG
  4138	011DDC	D250 0FE3 	        STB     R5,US2ACT       :0 OUT USER 2 ACTION FLAG
  4139	011DE0	4300 FE48 	        J       RETURN
  4140				 
  4141	011DE4			USR2B5  EQ      .
  4142	011DE4	D210 0FE7 	        STB     R1,ORIGR1       :SAVE ORIG INP BUF IDX
  4143	011DE8	D310 0FE2 	        LB      R1,US2OPB      :GET USER2 OUT BUF IDX
  4144	011DEC	2451 		        LIS     R5,1
  4145	011DEE			U2NAMS  EQ      .
  4146	011DEE	D305 0E58 	        LB      R0,NAVMSG,R5    :GET NOT AVAILABLE MSG BYTE
  4147	011DF2	4140 EA32 	        JAL     R4,WCI
  4148	011DF6	2651 		        AIS     R5,1
  4149	011DF8	D450 0E58 	        CLB     R5,NAVMSG       :END OF MSG?
  4150	011DFC	4320 FFEE 	        JLE     U2NAMS
  4151	011E00	C800 003E 	        LHI     R0,3E
Page  11-26	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  4152	011E04	4140 EA20 	        JAL     R4,WCI
  4153				         
  4154	011E08	D310 0FE7 	        LB      R1,ORIGR1       :GET ORIGINAL INP BUF IDX
  4155	011E0C	2450 		        LIS     R5,0
  4156	011E0E	D250 0FE9 	        STB     R5,CIRACT       :0 OUT CIRACT FLAG
  4157	011E12	D250 0FE3 	        STB     R5,US2ACT       :O OUT USER2ACTION FLAG
  4158	011E16	4300 FE12 	        J       RETURN
  4159				 
  4160	011E1A			U2HISM  EQ      .
  4161	011E1A	D210 0FE7 	        STB     R1,ORIGR1       :SAVE INP BUF IDX
  4162	011E1E	D310 0FE2 	        LB      R1,US2OPB       :GET USER2 OUT BUF IDX
  4163	011E22	0811 		        LR      R1,R1           :SET CC
  4164	011E24	4330 8014 	        JE      NOU2ON          :IF 0, USER2 NOT LOGGED ON
  4165	011E28	2450 		        LIS     R5,0
  4166	011E2A			LOSTC   EQ      .
  4167	011E2A	D305 1076 	        LB      R0,NOCMSG,R5
  4168	011E2E	4140 E9F6 	        JAL     R4,WCI
  4169	011E32	2651 		        AIS     R5,1
  4170	011E34	D450 1076 	        CLB     R5,NOCMSG       :END OF MSG?
  4171	011E38	4320 FFEE 	        JLE     LOSTC
  4172	011E3C	D310 0FE7 	NOU2ON  LB      R1,ORIGR1       :GET ORIG INP BUF IDX
  4173	011E40	E640 FBEE 	        LA      R4,AUXBLD       
  4174	011E44	5041 089C 	        ST      R4,PROCESS,R1   :SAVE PTR TO BUILD AUX CIRC PROCESS
  4175	011E48	E640 127C 	        LA      R4,AXBTBL
  4176	011E4C	5041 0818 	        ST      R4,MBREAK,R1    :SAVE PTR TO MBREAK TABLE
  4177	011E50	2450 		        LIS     R5,0
  4178	011E52	D250 0FE4 	        STB     R5,U2HOST       :0 OUT USER2 HOST OUT BUF IDX VARIABLE
  4179	011E56	D310 0FE7 	        LB      R1,ORIGR1       :BACK TO ORIG INP BUF IDX
  4180	011E5A	4300 FDCE 	        J       RETURN
  4181				         
  4182	011E5E			US2ISM  EQ      .
  4183	011E5E	D210 0FE7 	        STB     R1,ORIGR1       :SAVE ORIG INP BUF IDX
  4184	011E62	E640 FBCC 	        LA      R4,AUXBLD       :POINT TO BUILD AUX CIRC PROCESS
  4185	011E66	5041 089C 	        ST      R4,PROCESS,R1   :SAVE IN PROC ESS ARRAY
  4186	011E6A	E640 127C 	        LA      R4,AXBTBL       :POINT TO BREAK TBLE FOR BUILD AUX CIRC PROCES
  4187	011E6E	5041 0818 	        ST      R4,MBREAK,R1    :SAVE
  4188	011E72	2450 		        LIS     R5,0
  4189	011E74	D250 0FE1 	        STB     R5,USR2ON       :O OUT USER2 FLAG
  4190	011E78	D250 0FE2 	        STB     R5,US2OPB       :0 OUT USER2 OPBUF VARIABLE
  4191	011E7C	D310 0FE4 	        LB      R1,U2HOST       :CIRCUIT BUILT TO USER2 HOST?
  4192	011E80	0811 		        LR      R1,R1           :SET CC
  4193	011E82	4330 8010 	        JE      NOU2HO          :IF 0, USER2 HOST NOT LOGGED ON
  4194	011E86	D310 0FE4 	        LB      R1,U2HOST       :PUT USER2HOST OUT BUF IDX IN R1
  4195	011E8A	C800 009E 	        LHI     R0,9E           :ZAP CIRCUIT TO USER2 HOST
  4196	011E8E	4140 E996 	        JAL     R4,WCI          :SEND ZAP
  4197	011E92	D310 0FE7 	        LB      R1,ORIGR1       :GET ORIG INP BUF IDX
  4198	011E96	4300 FD92 	NOU2HO  J       RETURN
  4199				 
  4200	011E9A			USR2IN  EQ      .
  4201	011E9A	D210 0FE7 	        STB     R1,ORIGR1       :SAVE ORIGINAL R1 VALUE
  4202	011E9E	0800 		        LR      R0,R0           :SET CC
  4203	011EA0	4220 FFBA 	        JG      US2ISM          :IF > 0 IT'S ISIS MSG
  4204	011EA4	4210 FD84 	        JL      RETURN          :IGNORE IF < 0
Page  11-27	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  4205				 
  4206	011EA8	2450 		        LIS     R5,0            :INIT R5
  4207	011EAA			NXTU2I  EQ      .               :GET INPUT FROM USER 2
  4208	011EAA	4140 E8FA 	        JAL     R4,GCI          :GET BYTE FROM RING
  4209	011EAE	C400 007F 	        NHI     R0,007F         :TURN OFF PARITY BIT
  4210	011EB2	C500 000D 	        CLHI    R0,0D           :CR?
  4211	011EB6	4330 800A 	        JE      ENDU2I
  4212	011EBA	D205 0BA0 	        STB     R0,MSGBUF,R5    :SAVE IN MSGBUF
  4213	011EBE	2651 		        AIS     R5,1            :INCREMENT
  4214	011EC0	4300 FFE6 	        J       NXTU2I          :GET NXT BYTE
  4215	011EC4			ENDU2I  EQ      .
  4216	011EC4	D205 0BA0 	        STB     R0,MSGBUF,R5    :SAVE CR
  4217	011EC8	C800 000A 	        LHI     R0,0A           :GET LF
  4218	011ECC	2651 		        AIS     R5,1            :INCREMNT
  4219	011ECE	D205 0BA0 	        STB     R0,MSGBUF,R5    :SAVE LF
  4220				         
  4221	011ED2	2612 		        AIS     R1,2            :GET OUT BUF IDX
  4222	011ED4	2450 		        LIS     R5,0            :INIT R5
  4223	011ED6	D250 0FE5 	        STB     R5,PASSWO       :0 OUT PASSWORD FLAG
  4224	011EDA			WRIU2  EQ      .
  4225	011EDA	D305 0BA0 	        LB      R0,MSGBUF,R5    :GET MSGBUF BYTE
  4226	011EDE	C500 003B 	        CLHI    R0,3B           :SEMI-COLON?
  4227	011EE2	4230 8006 	        JN      NOSEMI
  4228	011EE6	2461 		        LIS     R6,1            :1 IN R6
  4229	011EE8	D260 0FE5 	        STB     R6,PASSWO       :SET PASSWORD FLAG
  4230	011EEC	D360 0FE5 	NOSEMI  LB      R6,PASSWO       :PASSWORD FLAG SET TO 1?
  4231	011EF0	0866 		        LR      R6,R6           :SET CC
  4232	011EF2	4230 8004 	        JN      SKPWCI          :IF <> 0, DON'T SEND OUT CHAR 
  4233	011EF6	4140 E92E 	        JAL     R4,WCI          :ELSE SEND OUT CHAR
  4234	011EFA	2651 		SKPWCI  AIS     R5,1            :INCREMENT
  4235	011EFC	C500 000A 	        CLHI    R0,0A           :LF?
  4236	011F00	4230 FFD6 	        JN      WRIU2
  4237	011F04	2461 		        LIS     R6,1
  4238	011F06	D460 0FE5 	        CLB     R6,PASSWO       :PASSWORD FLAG SET?
  4239	011F0A	4230 8010 	        JN      NOPASW
  4240	011F0E	C800 008D 	        LHI     R0,8D           :IF PASSWORD, SEND OUT LF AND CR
  4241	011F12	4140 E912 	        JAL     R4,WCI
  4242	011F16	C800 008A 	        LHI     R0,8A
  4243	011F1A	4140 E90A 	        JAL     R4,WCI
  4244	011F1E			NOPASW  EQ      .
  4245	011F1E	D250 0FDF 	        STB     R5,CURLEN       :SAVE CURRENT LENGTH
  4246	011F22	C800 003E 	        LHI     R0,3E           :PROMPT CHAR
  4247	011F26	4140 E8FE 	        JAL     R4,WCI          :SEND IT
  4248				 
  4249	011F2A	D300 0FE4 	        LB      R0,U2HOST       :IS USER 2 LOGGED INTO HOST?
  4250	011F2E	0800 		        LR      R0,R0           :SET CC
  4251	011F30	4330 8020 	        JE      LOGU2H          :IF 0, PREPARE STRING FOR OCM CALL
  4252				 
  4253	011F34	D310 0FE4 	RDY2RI  LB      R1,U2HOST       :SEND STRING TO HOST
  4254	011F38	2450 		        LIS     R5,0            :INIT R5
  4255	011F3A			WRIU2H  EQ      .       
  4256	011F3A	D305 0BA0 	        LB      R0,MSGBUF,R5    :GET BYTE
  4257	011F3E	4140 E8E6 	        JAL     R4,WCI          :SEND IT
Page  11-28	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  4258	011F42	2651 		        AIS     R5,1            :INCREMENT
  4259	011F44	C500 000D 	        CLHI    R0,0D           :CR?
  4260	011F48	4230 FFEE 	        JN      WRIU2H   
  4261	011F4C	D310 0FE7 	        LB      R1,ORIGR1       :GET ORIG R1 VALUE
  4262	011F50	4300 FCD8 	        J       RETURN
  4263				 
  4264	011F54			LOGU2H  EQ      .
  4265	011F54	D350 0FDF 	        LB      R5,CURLEN       :GET CURRENT LENGTH OF STRING
  4266	011F58	2751 		        SIS     R5,1            :WON'T SEND LF, CURLEN NOW POINTS TO CR
  4267	011F5A	2469 		        LIS     R6,9            :POINT TO STRING LENGTH BYTE OF OCM CALL MSG
  4268	011F5C	D256 1193 	        STB     R5,LOGST2,R6    :PUT LENGTH IN LENGTH BYTE OF OCM CALL MSG
  4269	011F60	0A56 		        AR      R5,R6           :GET TOTAL LENGTH OF OCM CALL STRING
  4270	011F62	D250 1193 	        STB     R5,LOGST2       :PUT LENGTH IN FIRST BYTE 
  4271				 
  4272	011F66	2661 		        AIS     R6,1            :POINT TO START OF LOG STRING IN OCM STRING
  4273	011F68	2450 		        LIS     R5,0            :POINT TO START OF LOG STRING IN MSGBUF
  4274	011F6A			GETLGB  EQ      .               :GET LOG STRING BYTES FROM MSGBUF
  4275	011F6A	D345 0BA0 	        LB      R4,MSGBUF,R5    :GET ONE BYTE
  4276	011F6E	D246 1193 	        STB     R4,LOGST2,R6    :STORE IN OCM CALL STRING
  4277	011F72	C540 000D 	        CLHI    R4,0D           :CR?
  4278	011F76	4330 8008 	        JE      LOGRDY          :IF SO, LOG-IN STRING IS READY
  4279	011F7A	2651 		        AIS     R5,1            :INCREMENT
  4280	011F7C	2661 		        AIS     R6,1            :INCREMENT
  4281	011F7E	4300 FFE8 	        J       GETLGB
  4282				 
  4283	011F82			LOGRDY  EQ      .
  4284	011F82	2451 		        LIS     R5,1            
  4285	011F84	D250 0FE6 	        STB     R5,OCMBY2       :SET FLAG FOR OCM CALL BY USER 2
  4286	011F88	D250 0FE3 	        STB     R5,US2ACT       :SET USER2 ACTION FLAG
  4287	011F8C	D250 0FE9 	        STB     R5,CIRACT       :SET CIRCUITACTION FLAG
  4288	011F90	D310 0FE7 	        LB      R1,ORIGR1
  4289	011F94	4300 FC94 	        J       RETURN
  4290				 
  4291	011F98			U2HDAT  EQ      .
  4292	011F98	D210 0FE7 	        STB     R1,ORIGR1       :SAVE ORIGINAL R1 VALUE
  4293	011F9C	0800 		        LR      R0,R0           :SET CC
  4294	011F9E	4220 FE78 	        JG      U2HISM          :IF > IT'S USER 2 ISIS MSG
  4295	011FA2	4210 FC86 	        JL      RETURN          :IF < 0, IGNORE
  4296				 
  4297	011FA6	2450 		        LIS     R5,0            :INIT R5
  4298	011FA8			GETUHD  EQ      .               :GET DATA  FROM HOST LOGGED INTO BY USER 2
  4299	011FA8	4140 E7FC 	        JAL     R4,GCI          :GET BYTE FROM RING
  4300	011FAC	C400 007F 	        NHI     R0,007F         :GET RID OR PARITY BIT
  4301	011FB0	C500 000D 	        CLHI    R0,0D           :CR?
  4302	011FB4	4330 800A 	        JE      ENDUHD
  4303	011FB8	D205 0BA0 	        STB     R0,MSGBUF,R5    :SAVE IN MSGBUF
  4304	011FBC	2651 		        AIS     R5,1            :INCREMENT
  4305	011FBE	4300 FFE6 	        J       GETUHD          :GET NEXT BYTE
  4306	011FC2			ENDUHD  EQ      .
  4307	011FC2	D205 0BA0 	        STB     R0,MSGBUF,R5    :SAVE CR
  4308	011FC6	D250 0FDF 	        STB     R5,CURLEN       :SAVE CURRENT LENGTH OF MSG
  4309				 
  4310	011FCA	D310 0FE2 	        LB      R1,US2OPB       :GET USER 2 OUT BUF IDX
Page  11-29	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  4311	011FCE	0855 		        LR      R5,R5           :CURLEN=0?
  4312	011FD0	2135 		        JNFS    GT1BYT          :NO, GREATER THAN 1 BYTE
  4313	011FD2	4140 E852 	        JAL     R4,WCI
  4314	011FD6	4300 8014 	        J       ENDOP2
  4315	011FDA			GT1BYT  EQ      .
  4316	011FDA	2450 		        LIS     R5,0            :INIT R5
  4317	011FDC			WRITU2  EQ      .
  4318	011FDC	D305 0BA0 	        LB      R0,MSGBUF,R5    :GET BYTE FROM MSGBUF
  4319	011FE0	4140 E844 	        JAL     R4,WCI          :SEND IT OUT
  4320	011FE4	2651 		        AIS     R5,1            :INCREMENT
  4321	011FE6	D450 0FDF 	        CLB     R5,CURLEN       :END OF MSG?
  4322	011FEA	4320 FFEE 	        JLE     WRITU2
  4323				 
  4324	011FEE	D310 0FE7 	ENDOP2  LB      R1,ORIGR1       :GET ORIGINAL INPU BUF IDX
  4325	011FF2	4300 FC36 	        J       RETURN
  4326				 
  4327				 
  4328				
  4329				Page  11-30	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  4330				
  4331				:       HANDLER FOR ZAP FROM ONTYME HOST CIRCUIT
  4332	011FF6			AUXISM  EQ      .               
  4333	011FF6	C500 00A4 	        CLHI    R0,0A4          :BLACK BALL?
  4334	011FFA	4330 8068 	        JE      SNDBBM          :YES, SEND BLACK BALL (DATA LOST) MSG
  4335	011FFE	0821 		        LR      R2,R1           :GET COPY OF INPUT IDX
  4336	012000	2622 		        AIS     R2,2            :MAKE INTO OUTPUT IDX
  4337	012002	2440 		        LIS     R4,0
  4338	012004	D364 0D06 	AUXIS0  LB      R6,OHOPIX,R4            :GET OP IDX BYTE
  4339	012008	0926 		        CR      R2,R6                   :THIS IDX?
  4340	01200A	2333 		        JEFS    AUXIS1
  4341	01200C	2641 		        AIS     R4,1
  4342	01200E	2205 		        JBS     AUXIS0
  4343	012010	0854 		AUXIS1  LR      R5,R4
  4344	012012	2651 		        AIS     R5,1
  4345	012014	D365 0D06 	AUXIS2  LB      R6,OHOPIX,R5
  4346	012018	D264 0D06 	        STB     R6,OHOPIX,R4            :NEXT IDX BYT BECOMES THIS BYTE
  4347	01201C	2334 		        JEFS    AUXIS3                  :END OF ARRAY
  4348	01201E	2641 		        AIS     R4,1
  4349	012020	2651 		        AIS     R5,1
  4350	012022	2207 		        JBS     AUXIS2
  4351	012024			AUXIS3  EQ      .
  4352	012024	2451 		        LIS     R5,1            :INIT R5
  4353	012026			NXTBX1  EQ      .
  4354	012026	D365 1148 	        LB      R6,TBLONT,R5    :GET INPBUF IDX FROM TBLONT
  4355	01202A	0916 		        CR      R1,R6           :EQUAL TO CURRENT INP BUF IDX?
  4356	01202C	4330 8006 	        JE      LOSONT          :IF SO, YOU LOST CIRC TO AN ONTYME HOST
  4357	012030	2654 		        AIS     R5,4            :INCREMTN R5
  4358	012032	4300 FFF0 	        J       NXTBX1          :GET NEXT BUF IDX FROM TBL
  4359				 
  4360	012036			LOSONT  EQ      .
  4361	012036	2460 		        LIS     R6,0            :0 IN R6
  4362	012038	D265 1148 	        STB     R6,TBLONT,R5    :0 OUT BUF IDX FIELD OF TBLONT
  4363	01203C	2751 		        SIS     R5,1            :R5 NOW POINTS TO HOSTID FIELD
  4364	01203E	D375 1148 	        LB      R7,TBLONT,R5    :GET HOSTID FROM TBLONT
  4365	012042	D270 0FEC 	        STB     R7,CURHID       :SAVE
  4366	012046	D350 0FE7 	        LB      R5,ORIGR1       :GET ORIGINAL BUF IDX
  4367	01204A	E640 F9E4 	        LA      R4,AUXBLD       :GET ADDR OF BUILD AUX CIRC PROCESS
  4368	01204E	5045 089C 	        ST      R4,PROCESS,R5   :SAVE IT IN PROCESS ARRAY
  4369	012052	E640 127C 	        LA      R4,AXBTBL       :GET ADDR OF MBREAK PROC FOR AUX BUILD PROC
  4370	012056	5045 0818 	        ST      R4,MBREAK,R5    :SAVE IN MBREAK TBL
  4371	01205A	D310 0FED 	        LB      R1,USROPB       :USER'S OUT BUF IDX IN R1
  4372	01205E	4160 FBA4 	        JAL     R6,GONMSG       :SEND OUT CIRUIT GEON MSG
  4373	012062	4300 81A0 	        J       WRITIM          :WRITE TIME
  4374				
  4375				:	SEND MSG INDICATING DATA LOST (BLACK BALL REC'D)
  4376				
  4377	012066	D310 0CF9 	SNDBBM	LB	R1,IBX370		:370 CIRCUIT IDX
  4378	01206A	2612 			AIS	R1,2			:MAKE INTO OUTPUT IDX
  4379	01206C	2451 			LIS	R5,1
  4380	01206E	D305 0F75 	SNDBB0	LB	R0,BANNER,R5		:FIRST SEND BANNER OF ASTERISKS
  4381	012072	4140 E7B2 		JAL	R4,WCI
  4382	012076	2651 			AIS	R5,1
Page  11-31	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  4383	012078	D450 0F75 		CLB	R5,BANNER
  4384	01207C	2227 			JLEBS	SNDBB0
  4385	01207E	2451 			LIS	R5,1
  4386	012080	D305 0F9E 	SNDBB1	LB	R0,BBALLM,R5
  4387	012084	4140 E7A0 		JAL	R4,WCI
  4388	012088	2651 			AIS	R5,1
  4389	01208A	D450 0F9E 		CLB	R5,BBALLM
  4390	01208E	2227 			JLEBS	SNDBB1
  4391	012090	2451 			LIS	R5,1
  4392	012092	D305 0F75 	SNDBB2	LB	R0,BANNER,R5
  4393	012096	4140 E78E 		JAL	R4,WCI
  4394	01209A	2651 			AIS	R5,1
  4395	01209C	D450 0F75 		CLB	R5,BANNER
  4396	0120A0	2227 			JLEBS	SNDBB2
  4397	0120A2	D310 0FE7 		LB	R1,ORIGR1
  4398	0120A6	4300 FB82 		J	RETURN
  4399				 
  4400				
  4401				Page  11-32	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  4402				
  4403				:       HANDLER FOR ISIS MSG FROM 370 (ZAP, SET OR RELEASE BACKPRESSURE)
  4404	0120AA			ISM370  EQ      .
  4405	0120AA	D210 0FE7 	        STB     R1,ORIGR1       :SAVE INP BUF IDX
  4406	0120AE	C500 009E 	        CLHI    R0,9E
  4407	0120B2	4330 802E 	        JE      ZAP370
  4408	0120B6	C500 009F 	        CLHI    R0,9F
  4409	0120BA	4330 8026 	        JE      ZAP370
  4410	0120BE	7390 4000 0A08 	        LHL     R9,PORT,,       :GET PORT NMBR
  4411	0120C4	C500 00A0 	        CLHI    R0,0A0          :SET BACKPRESURE MSG?
  4412	0120C8	2135 		        JNFS    RBK370          :NO--RELEASE BCKPR
  4413	0120CA	7690 4000 0A5C 	        RBT     R9,TOISIS,,     :THIS BIT RESET TELLS OUTPUT ROUTINE...
  4414	0120D0	2304 		        JFS     SBK370          :...NOT TO SEND DATA ON THIS PORT
  4415	0120D2	7590 4000 0A5C 	RBK370  SBT     R9,TOISIS,,     :FLAGS OUTPUT ROUTINE TO OUTPUT ON PORT
  4416	0120D8	4160 82EE 	SBK370  JAL     R6,SBKMOH       :SEND BKP MSG TO ONTYME HOST
  4417	0120DC	D310 0FE7 	        LB      R1,ORIGR1
  4418	0120E0	4300 FB48 	        J       RETURN
  4419	0120E4			ZAP370  EQ      .
  4420	0120E4	D410 0CFC 	        CLB     R1,IBXOLD       :IS IT IBXOLD?
  4421	0120E8	4330 8082 	        JE      ZEROLD
  4422	0120EC	D410 0CFB 	        CLB     R1,IBXSWI       :IS IT IBXSWI?
  4423	0120F0	4330 8098 	        JE      ZEROSW
  4424	0120F4	2460 		        LIS     R6,0            :0 ON R6
  4425	0120F6	D260 0CF9 	        STB     R6,IBX370       :0 OUT 370 IN BUF IDX HOLDER
  4426				  
  4427	0120FA	2451 		        LIS     R5,1            :INIT R5
  4428	0120FC	D250 0FE9 	        STB     R5,CIRACT       :DON'T ALLOW USR INP DURING OHOST LOGOFF
  4429	012100			NXTHID  EQ      .
  4430	012100	D315 1148 	        LB      R1,TBLONT,R5    :GET INP BUF IDX FROM TBLONT
  4431	012104	0811 		        LR      R1,R1           :SET CC
  4432	012106	4330 8016 	        JE      SKPLOG          :IF 0 THEN SKIP LOGOFF 
  4433	01210A	2612 		        AIS     R1,2            :ELSE MAKE INTO OUT BUF IDX
  4434	01210C	2461 		        LIS     R6,1            :INIT R6
  4435	01210E			SENLOG  EQ      .
  4436	01210E	D306 1015 	        LB      R0,LOGOMS,R6    :GET LOGOUT BYTE
  4437	012112	4140 E712 	        JAL     R4,WCI          :SEND
  4438	012116	2661 		        AIS     R6,1            :INCREMNT
  4439	012118	D460 1015 	        CLB     R6,LOGOMS       :END OF MSG?
  4440	01211C	4320 FFEE 	        JLE     SENLOG          :IF NO GET NXT BYT
  4441	012120			SKPLOG  EQ      .
  4442	012120	2751 		        SIS     R5,1            :NOW POINT TO HOSTID
  4443	012122	D315 1148 	        LB      R1,TBLONT,R5    :GET HOSTID FROM TBL
  4444	012126	C510 0048 	        CLHI    R1,MAXONT       : = TO MAX HOST ID?
  4445	01212A	4330 8006 	        JE      ZOUTUN          :JUMP IF SO
  4446	01212E	2655 		        AIS     R5,5            :ELSE POINT TO NEXT IN BUF IDX
  4447	012130	4300 FFCC 	        J       NXTHID          :TOP OF LOOP
  4448	012134			ZOUTUN  EQ      .
  4449	012134	C850 0021 	        LHI     R5,21           :POINT TO ID FIELD OF CIRGO MSG
  4450	012138	D340 0CFE 	        LB      R4,USRNM1       :GET USERNAME ID
  4451	01213C	D245 0E92 	        STB     R4,CIRGO3,R5
  4452	012140	D240 0D01 	        STB     R4,USRNID
  4453	012144	2450 		        LIS     R5,0
  4454	012146	D250 0CFE 	        STB     R5,USRNM1       :0 OUT USERNM1
Page  11-33	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  4455	01214A	D350 0CFB 	        LB      R5,IBXSWI       :IS 2ND USRNAM LOGGD ON?
  4456	01214E	0855 		        LR      R5,R5           :SET CC
  4457	012150	4330 8052 	        JE      ALLOGD          :IF NO 2ND USRNAM , JUMP
  4458	012154	D250 0CF9 	        STB     R5,IBX370       :ELSE SWITHC IBXSWI TO IBX370
  4459	012158	D350 0CFF 	        LB      R5,USRNM2       :SWITCH USRNAMES
  4460	01215C	D250 0CFE 	        STB     R5,USRNM1
  4461	012160	2450 		        LIS     R5,0
  4462	012162	D250 0CFB 	        STB     R5,IBXSWI       :NOW 0 OUT IBXSWI
  4463	012166	D250 0CFF 	        STB     R5,USRNM2       :0 OU USRNM2
  4464	01216A	4300 8038 	        J       ALLOGD
  4465	01216E			ZEROLD  EQ      .
  4466	01216E	C850 0021 	        LHI     R5,21
  4467	012172	D340 0D00 	        LB      R4,USROLD
  4468	012176	D240 0D01 	        STB     R4,USRNID       :SAVE USERNAM ID
  4469	01217A	D245 0E92 	        STB     R4,CIRGO3,R5
  4470	01217E	2450 		        LIS     R5,0
  4471	012180	D250 0CFC 	        STB     R5,IBXOLD       :0 OUT IBXOLD
  4472	012184	D250 0D00 	        STB     R5,USROLD
  4473	012188	4300 801A 	        J       ALLOGD          
  4474	01218C			ZEROSW  EQ      .
  4475	01218C	C850 0021 	        LHI     R5,21
  4476	012190	D340 0CFF 	        LB      R4,USRNM2
  4477	012194	D240 0D01 	        STB     R4,USRNID       :SAVE USERNAM ID
  4478	012198	D245 0E92 	        STB     R4,CIRGO3,R5
  4479	01219C	2450 		        LIS     R5,0
  4480	01219E	D250 0CFB 	        STB     R5,IBXSWI       :0 OUT IBXSWI
  4481	0121A2	D250 0CFF 	        STB     R5,USRNM2       :0 OUT USRNM2
  4482				 
  4483	0121A6			ALLOGD  EQ      .
  4484	0121A6	2450 		        LIS     R5,0
  4485	0121A8	D250 0FE9 	        STB     R5,CIRACT       :ALLOW USR INPUT
  4486	0121AC	D310 0FE7 	        LB      R1,ORIGR1       :PUT IN BUF IDX IN R1
  4487	0121B0	E640 F87E 	        LA      R4,AUXBLD       :GET ADDR OF BUILD AUX CIRC PROCESS
  4488	0121B4	5041 089C 	        ST      R4,PROCESS,R1   :SAVE IN PROCESS ARRAY
  4489	0121B8	E640 127C 	        LA      R4,AXBTBL       :GET ADDR OF MBREAK FOR BUILD AUX CIR PROC
  4490	0121BC	5041 0818 	        ST      R4,MBREAK,R1    :SAVE IN MBREAK TBL
  4491				
  4492	0121C0	D340 0D01 	        LB      R4,USRNID
  4493	0121C4	C540 0045 	        CLHI    R4,45           :'E'?
  4494	0121C8	4320 801A 	        JLE     ALLOG1
  4495	0121CC	C440 000F 	        NHI     R4,0F
  4496	0121D0	D344 109E 	        LB      R4,BAKTBL,R4
  4497	0121D4	C850 0024 	        LHI     R5,24
  4498	0121D8	D245 0EB9 	        STB     R4,BAKGON,R5
  4499	0121DC	E660 0EB9 	        LA      R6,BAKGON
  4500	0121E0	D370 0EB9 	        LB      R7,BAKGON
  4501	0121E4	2305 		        JFS     ALLOG2
  4502	0121E6	E660 0E92 	ALLOG1  LA      R6,CIRGO3
  4503	0121EA	D370 0E92 	        LB      R7,CIRGO3       :GET LENGTH BYT
  4504	0121EE	D310 0FED 	ALLOG2  LB      R1,USROPB       :USER'S OU T BUF IDX IN R1
  4505	0121F2	2451 		        LIS     R5,1            :INIT R5
  4506	0121F4			NXTGO3  EQ      .
  4507	0121F4	D306 4500 0000 	        LB      R0,0,R6,R5      :GET CIRCUIT GONE MSG BYTE
Page  11-34	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  4508	0121FA	4140 E62A 	        JAL     R4,WCI          :SEND
  4509	0121FE	2651 		        AIS     R5,1            :INCR
  4510	012200	0957 		        CR      R5,R7           :END OF MSG?
  4511	012202	4320 FFEE 	        JLE     NXTGO3          :IF NO GET NXT BYT
  4512				 
  4513	012206			WRITIM  EQ      .
  4514	012206	2451 		        LIS     R5,1            :INIT R5
  4515	012208			NEXTI1  EQ      .
  4516	012208	D305 0D24 	        LB      R0,TIMMSG,R5    :GET TIME MSG BYTE
  4517	01220C	4140 E618 	        JAL     R4,WCI          :SEND IT
  4518	012210	2651 		        AIS     R5,1            :INCREMENT
  4519	012212	D450 0D24 	        CLB     R5,TIMMSG       :END OF MSG?
  4520	012216	4320 FFEE 	        JLE     NEXTI1          :IF NOT GET NEXT BYTE
  4521	01221A	4170 808E 	        JAL     R7,GETDAT       :GET DATE STRING
  4522	01221E	2451 		        LIS     R5,1            :1 IN R5
  4523	012220	D305 0FD4 	        LB      R0,DAYT,R5    :GET BYTE FROM DATE STRING
  4524	012224	4140 E600 	        JAL     R4,WCI          :SEND IT OUT
  4525	012228	2651 		        AIS     R5,1            :INCREMENT
  4526	01222A	D305 0FD4 	        LB      R0,DAYT,R5    :GET BYTE
  4527	01222E	4140 E5F6 	        JAL     R4,WCI          :SEND IT
  4528	012232	C800 00AF 	        LHI     R0,0AF          :PUT / IN R0
  4529	012236	4140 E5EE 	        JAL     R4,WCI          :SEND IT
  4530	01223A	2651 		        AIS     R5,1            :INCREMENT
  4531	01223C	D305 0FD4 	        LB      R0,DAYT,R5    :etc...
  4532	012240	4140 E5E4 	        JAL     R4,WCI
  4533	012244	2651 		        AIS     R5,1
  4534	012246	D305 0FD4 	        LB      R0,DAYT,R5
  4535	01224A	4140 E5DA 	        JAL     R4,WCI
  4536	01224E	C800 00A0 	        LHI     R0,0A0          :SPACE IN R0
  4537	012252	4140 E5D2 	        JAL     R4,WCI
  4538	012256	2651 		        AIS     R5,1
  4539	012258	D305 0FD4 	        LB      R0,DAYT,R5
  4540	01225C	4140 E5C8 	        JAL     R4,WCI
  4541	012260	2651 		        AIS     R5,1
  4542	012262	D305 0FD4 	        LB      R0,DAYT,R5
  4543	012266	4140 E5BE 	        JAL     R4,WCI
  4544	01226A	C800 00BA 	        LHI     R0,0BA          :":" IN R0
  4545	01226E	4140 E5B6 	        JAL     R4,WCI
  4546	012272	2651 		        AIS     R5,1
  4547	012274	D305 0FD4 	        LB      R0,DAYT,R5
  4548	012278	4140 E5AC 	        JAL     R4,WCI
  4549	01227C	2651 		        AIS     R5,1
  4550	01227E	D305 0FD4 	        LB      R0,DAYT,R5
  4551	012282	4140 E5A2 	        JAL     R4,WCI
  4552	012286	C800 008D 	        LHI     R0,8D
  4553	01228A	4140 E59A 	        JAL     R4,WCI
  4554	01228E	C800 008A 	        LHI     R0,8A
  4555	012292	4140 E592 	        JAL     R4,WCI
  4556	012296	C800 00BE 	        LHI     R0,0BE
  4557	01229A	4140 E58A 	        JAL     R4,WCI
  4558	01229E	2450 		        LIS     R5,0            :0 IN R5
  4559	0122A0	D250 0FEC 	        STB     R5,CURHID       :0 IN HOSTID
  4560	0122A4	D310 0FE7 	        LB      R1,ORIGR1       :PUT ORIG INP BUF IDX IN R1
Page  11-35	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  4561	0122A8	4300 F980 	        J       RETURN
  4562				 
  4563				 
  4564				
  4565				Page  11-36	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  4566				
  4567	0122AC			GETDAT  EQ      .
  4568	0122AC	5830 400F 000C 	        L       R3,GMT,,        :PUT GMT IN R3
  4569	0122B2	4150 E2A4 	        JAL     R5,DATE         :GET DATE
  4570	0122B6	5060 0FCC 	        ST      R6,DATWRD       :SAVE DATE
  4571	0122BA	F460 F000 0000 	        NI      R6,0F0000000    :AND OUT ALL BUT NIBBLE WE WANT
  4572	0122C0	EC60 001C 	        SRL     R6,1C           :SHIFT RIGHT 28 BITS
  4573	0122C4	CA60 00B0 	        AHI     R6,0B0           :MAKE NIBBLE INTO ASCII CHAR
  4574	0122C8	2451 		        LIS     R5,1            :1 IN R5
  4575	0122CA	D265 0FD4 	        STB     R6,DAYT,R5      :SAVE BYTE
  4576	0122CE	5860 0FCC 	        L       R6,DATWRD       :DATWRD IN R6
  4577	0122D2	F460 0F00 0000 	        NI      R6,0F000000     :AND OUT ALL BUT NIBBLE WE WANT
  4578	0122D8	EC60 0018 	        SRL     R6,18           :SHIFT RIGHT 24 BITS
  4579	0122DC	CA60 00B0 	        AHI     R6,0B0           :MAKE NIBBLE INTO ASCII CHAR
  4580	0122E0	2452 		        LIS     R5,2
  4581	0122E2	D265 0FD4 	        STB     R6,DAYT,R5      :SAVE IT
  4582	0122E6	5860 0FCC 	        L       R6,DATWRD       :DATWRD IN R6
  4583	0122EA	F460 00F0 0000 	        NI      R6,00F00000     :AND OUT ALL BUT NIBBLE WE WNAT
  4584	0122F0	EC60 0014 	        SRL     R6,14           :SHIFT RIGHT 20 BITS
  4585	0122F4	CA60 00B0 	        AHI     R6,0B0           :MAKE INTO ASCII CHAR
  4586	0122F8	2453 		        LIS     R5,3            :POINT TO BYTE 2 IN DAYT
  4587	0122FA	D265 0FD4 	        STB     R6,DAYT,R5      :STORE CHAR
  4588	0122FE	5860 0FCC 	        L       R6,DATWRD       
  4589	012302	F460 000F 0000 	        NI      R6,000F0000     
  4590	012308	EC60 0010 	        SRL     R6,10
  4591	01230C	CA60 00B0 	        AHI     R6,0B0
  4592	012310	2454 		        LIS     R5,4
  4593	012312	D265 0FD4 	        STB     R6,DAYT,R5
  4594	012316	5860 0FCC 	        L       6,DATWRD
  4595	01231A	C460 F000 	        NHI     R6,0F000        
  4596	01231E	CC60 000C 	        SRHL    R6,0C
  4597	012322	CA60 00B0 	        AHI     R6,0B0
  4598	012326	2455 		        LIS     R5,5
  4599	012328	D265 0FD4 	        STB     R6,DAYT,R5
  4600	01232C	5860 0FCC 	        L       R6,DATWRD       
  4601	012330	C460 0F00 	        NHI     R6,0F00
  4602	012334	CC60 0008 	        SRHL    R6,8
  4603	012338	CA60 00B0 	        AHI     R6,0B0
  4604	01233C	2456 		        LIS     R5,6
  4605	01233E	D265 0FD4 	        STB     R6,DAYT,R5
  4606	012342	5860 0FCC 	        L       R6,DATWRD
  4607	012346	C460 00F0 	        NHI     R6,0F0
  4608	01234A	CC60 0004 	        SRHL    R6,4
  4609	01234E	CA60 00B0 	        AHI     R6,0B0
  4610	012352	2457 		        LIS     R5,7
  4611	012354	D265 0FD4 	        STB     R6,DAYT,R5
  4612	012358	5860 0FCC 	        L       R6,DATWRD
  4613	01235C	C460 000F 	        NHI     R6,0F
  4614	012360	CA60 00B0 	        AHI     R6,0B0
  4615	012364	2458 		        LIS     R5,8
  4616	012366	D265 0FD4 	        STB     R6,DAYT,R5
  4617	01236A	0307 		        JR      R7              :RETURN
  4618				 
Page  11-37	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  4619	01236C			DEFLNM EQ       .
  4620	01236C	2482 		        LIS     R8,2            :INIT PTR TO DATE FIELD OF TBLONT
  4621	01236E	2441 		        LIS     R4,1            :INIT POINTER INTO FNMSTR
  4622	012370			DEFLN1  EQ      .
  4623	012370	D364 1158 	        LB      R6,FNMSTR,R4    :GET HOSTID BYTE FROM FNMSTR
  4624	012374	0956 		        CR      R5,R6           :FOUND?
  4625	012376	4330 800A 	        JE      DEFLN2          :IF SO GET REST OF FNMSTR
  4626	01237A	CA40 000C 	        AHI     R4,0C           :ELSE POINT TO NEXT FNMSTR
  4627	01237E	2684 		        AIS     R8,4            :INCREMNT
  4628	012380	4300 FFEC 	        J       DEFLN1          :GET NEXT HOSTID BYTE FROM NEXT FNMSTR
  4629	012384			DEFLN2  EQ      .
  4630	012384	D240 100E 	        STB     R4,FNMPTR       :SAVE PTR INTO BEGIN OF FILE NAME
  4631	012388	2641 		        AIS     R4,1            :R4 NOW POINTS TO BEGIN OF DATE FIELD OF STRING
  4632	01238A	2451 		        LIS     R5,1            :INIT R5 AS DAYT POINTER
  4633	01238C			DEFLN3  EQ      .
  4634	01238C	D365 0FD4 	        LB      R6,DAYT,R5      :GET DAYT BYTE
  4635	012390	D264 1158 	        STB     R6,FNMSTR,R4    :PUT DAYT BYTE IN FILNAM STRING
  4636	012394	2641 		        AIS     R4,1            :INCREMENT
  4637	012396	2651 		        AIS     R5,1            :INCREMENT
  4638	012398	C550 0004 	        CLHI    R5,4            :GOT YOUR 4 DAYT BYTES?
  4639	01239C	4320 FFEC 	        JLE     DEFLN3          :IF NOT GET NEXT BYTE
  4640	0123A0	2641 		        AIS     R4,1            :NOW POINT TO SECOND PART OF DAYT STRING
  4641	0123A2			DEFLN4  EQ      .
  4642	0123A2	D365 0FD4 	        LB      R6,DAYT,R5      :GET DAYT BYTE
  4643	0123A6	D264 1158 	        STB     R6,FNMSTR,R4    :STORE IN FILNAM STRING
  4644	0123AA	2641 		        AIS     R4,1            :INCREMENT
  4645	0123AC	2651 		        AIS     R5,1            :INCREMENT
  4646	0123AE	C550 0008 	        CLHI    R5,8            :GOT YOUR 4 BYTES?
  4647	0123B2	4320 FFEC 	        JLE     DEFLN4          :IF NOT GET NEXT BYTE
  4648	0123B6	5860 0FCC 	        L       R6,DATWRD       :PUT DATWRD IN R6
  4649	0123BA	F460 FFFF 0000 	        NI      R6,0FFFF0000    :AN OUT HOUR AND MINUTE BYTES
  4650	0123C0	EC60 0010 	        SRL     R6,10           :SHIFT RIGHT 16 BITS
  4651	0123C4	4068 1148 	        STH     R6,TBLONT,R8    :SAVE FILE DATE IN TBLONT
  4652	0123C8	0307 		        JR      R7
  4653				
  4654				:       SUBROUTINE TO SEND BACKPRESSURE MSG FROM 370 TO ONTYME HOSTS
  4655				:       R0 = APPLY OR RELEASE BACKPRESSURE MSG
  4656				:       R6= LINK REG
  4657				
  4658	0123CA	2450 		SBKMOH  LIS     R5,0
  4659	0123CC	4300 800E 	        J       SAVBKP
  4660	0123D0	D315 0D06 	SBKMO1  LB      R1,OHOPIX,R5            :GET OP IDX OF ONTYME HOST
  4661	0123D4	0336 		        JER     R6                      :NO MORE, RETURN
  4662	0123D6	4140 E44E 	        JAL     R4,WCI
  4663	0123DA	2651 		        AIS     R5,1
  4664	0123DC	2206 		        JBS     SBKMO1
  4665				
  4666				 
  4667				:	STORE BACKPRESSURE EVENT DATA
  4668				:	SAVES A USER-DEFINED NUMBER OF BACKPRESSURE EVENTS, THEN 'WRAPS
  4669				:	AROUND'.  NUMBER OF EVENTS DEFINED IN TYMFILE BY NEVNTS.
  4670				:	AFTER WRAP-AROUND, TABLE WILL ALWAYS HAVE THE LAST NEVNTS OF EVENTS.
  4671				:	USE VALUE OF EVTIDX TO DETERMINE WHERE THE LAST EVENT WAS STORED, I.E.,
Page  11-38	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:00
(APSSUP)TRACOL.V06	 

  4672				:       IF EVTIDX = 40, ADD 40 TO ADDRESS OF EVTABL.  THE RESULTING ADDRESS
  4673				:       IS THE ADDRESS OF THE LAST EVENT.
  4674				
  4675				:	R6 = LINK REG. WHERE CALL TO SBKMOH WAS CALLED (EITHER FROM MAIN
  4676				:	LOOP AS A RESULT OF BUFUSD THRESHOLDS--OR FROM ISM370--THE ROUTINE
  4677				:	THAT HANDLES BACKPRESSURE OR ZAP MSGS FROM 370 CIRCUIT).
  4678				
  4679				:	R0 = 0A0 (SET BACKPRESSURE) OR 0A1 (RELEASE BACKPRESSURE)
  4680				
  4681				:	EACH EVENT IS 16 DECIMAL BYTES LONG:
  4682				:	4 BYTES = R6
  4683				:	2 BYTES = R0
  4684				:	2 BYTES = BUFUSD
  4685				:	4 BYTES OF PADDING (0)
  4686				:	4 BYTES OF FASTC (TIME OF EVENT)
  4687				
  4688	00129C				SEG	A.DATA
  4689	00129C				BND	2
  4690	00129C			EVTIDX	HS	1
  4691	0012A0			EVTABL	WS	4*NEVNTS
  4692	0123DE				SEG	A.CODE
  4693	0123DE	7320 129C 	SAVBKP	LHL	R2,EVTIDX		:GET TABLE IDX
  4694	0123E2	5062 12A0 		ST	R6,EVTABL,R2		:SAVE R6
  4695	0123E6	4002 12A4 		STH	R0,EVTABL+4,R2		:SAVE MSG (BKP ON OR OFF)
  4696	0123EA	7330 078E 		LHL	R3,BUFUSD		:BUF USED COUNT
  4697	0123EE	4032 12A6 		STH	R3,EVTABL+6,R2
  4698	0123F2	5830 400F 0004 		L	R3,FASTC,,              :GET FAST CLOCK TIME
  4699	0123F8	5032 12AC 		ST	R3,EVTABL+0C,R2
  4700	0123FC	CA20 0010 		AHI	R2,10			:INCRMNT IDX
  4701	012400	C520 0320 		CLHI	R2,10*NEVNTS		:END OF TABLE?
  4702	012404	2132 			JNFS	SAVBK0			:JUMP IF NOT
  4703	012406	2420 			LIS	R2,0			:ELSE SET TO 0
  4704	012408	4020 129C 	SAVBK0	STH	R2,EVTIDX		:SAVE IDX
  4705	01240C	4300 FFC0 		J	SBKMO1
  4706				
  4707				:       GET AUX REQ STRING FOR LOGON TO ONTYME HOST
  4708				:       MATCH HOSTID WITH HOSTID BYTE IN STRING
  4709				
  4710	012410	D350 0FEA 	GETAXR  LB      R5,HOSTID
  4711	012414	C650 0080 	        OHI     R5,80                   :SET HI-ORDER BIT
  4712	012418	2410 		        LIS     R1,0
  4713	01241A	D451 10B9 	GETAX0  CLB     R5,REQSTR+11,R1         :COMPAR ID W/ ID BYT
  4714	01241E	2334 		        JEFS    GETAX1                  :JUMP IF A MATCH
  4715	012420	CA10 0028 	        AHI     R1,28                   :ADD LENGTH OF STRING
  4716	012424	2205 		        JBS     GETAX0                  :CHECK NEXT STRING
  4717	012426	E631 10A8 	GETAX1  LA      R3,REQSTR,R1            :ADDR OF STRING IN R3 FOR OCM CALL
  4718	01242A	0304 		        JR      R4
Page  12-1	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:01
(ISIS2)FINISH.LIB	  Control Table Allocation and Diagnostics - FINISH.LIB

  4719				        SUBTTL  Control Table Allocation and Diagnostics - FINISH.LIB
  4720				 
  4721				:**********************************************************************
  4722				:                                                                     *
  4723				:       This program is the sole property and confidential            *
  4724				:       information of Tymshare, Inc., and may not be copied          *
  4725				:       in whole or in part or disclosed to any third party           *
  4726				:       without the prior written consent of Tymshare.                *
  4727				:                                                                     *
  4728				:**********************************************************************
  4729				
  4730					RA	0		:	FINISH.LIB
  4731				
  4732				:	this file should always be assembled LAST!
  4733				
  4734				:ALLOCATE FPANEL IF USER HAS NOT
  4735	000000			  IF	\FPANEL
  4736	000001			  ELSE
  4737	0015C0				SEG	A.DATA
  4738	0015C0			FPANEL  HS      1
  4739				  EI
  4740	000001			  IF	\FRISIS
  4741	000000			  ELSE
  4742					SEG	0
  4743				FRISIS	HS	$A (MAXPRT+15)/16
  4744				  EI
  4745	000001			  IF	\TOISIS
  4746	000000			  ELSE
  4747					SEG	0
  4748				TOISIS	HS	$A (MAXPRT+15)/16
  4749				  EI
  4750				
  4751	000001			  IF	1-(\PATCH0)
  4752	0015C2				SEG	0
  4753	0015C4			PATCH0	WS	20	:SEGMENT ZERO PATCH AREA
  4754				  EI
  4755	000001			  IF	1-(\PATCH1)
  4756	01242C				SEG	1
  4757	01242C			PATCH1	WS	20	:SEGMENT ONE PATCH AREA
  4758				  EI
  4759	000001			  IF	1-(\PATCH2)
  4760	022800				SEG	2
  4761	022800			PATCH2	WS	20	:SEGMENT TWO PATCH AREA
  4762				  EI
  4763				
  4764	000000				IF	\APROT0
  4765	000001				ELSE
  4766	000006			APROT0	EQ	6	:EXECUTION PROTECTED
  4767					REMARK	%DEFAULT AREA PROTECTIONS ASSUMED.%
  4768					EI
  4769	000000				IF	\APROT1
  4770	000001				ELSE
  4771	000005			APROT1	EQ	5	:WRITE PROTECTED
Page  12-2	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:01
(ISIS2)FINISH.LIB	  Control Table Allocation and Diagnostics - FINISH.LIB

  4772					EI
  4773	000002			Q1	EQ	2
  4774	00000C				RE	0C
  4775	000000				IF	\APROT|Q1|
  4776	000001				ELSE
  4777	000006			APROT|Q1| EQ	6	:EXECUTION PROTECTED
  4778					EI
  4779	000003			Q1	EQ	Q1+1
  4780	000000				ER
  4781				
  4782				:	NAD ALLOWS MORE THAN 10000X TO BE PLACED IN ONE "SEG".
  4783				:	WE MUST THEREFORE GO INTO EACH SEG AND IF > 10000X ORG BACK TO
  4784				:	10000X AND THEN ENTER THE NEXT SEG TO DEPOSIT THE REMAINDER.
  4785				:	THIS, OF COURSE, ASSUMES THAT THE NEXT SEG IS EMPTY.
  4786				:	A CHECK IS MADE TO INSURE THIS.
  4787				
  4788	000000			Q1	EQ		0
  4789	00000E				RE		0E		:FOR Q1 = 0 TO 0E
  4790	001644				  SEG		Q1
  4791	010000			Q3	  EQ		10000*(Q1+1)	:  Q3 = UPPER BOUND FOR THIS SEGMENT
  4792	FF1644				  IF		.-Q3		:  IF THIS SEGMENT OVERFLOWED
  4793				Q2	    EQ		.-Q3		:    Q2 = LENGTH OF OVERFLOW
  4794					    ORG		Q3		:    ORG TO MAXIMUM
  4795					    IF		0E-(Q1+1)	:    IF THE NEXT SEG IS NOT E
  4796					      SEG	Q1+1		:      GO INTO NEXT SEG
  4797					      IF	(.-Q3)		:      IF SEG ALREADY IN USE
  4798					        SEG	Q1		:        RETURN TO PREVIOUS SEG
  4799					      ELSE			:      ELSE
  4800				APROT|Q1+1|	EQ	APROT|Q1|	:        COPY PROTECTION
  4801					      EI			:      ENDIF
  4802					    EI				:    ENDIF
  4803					    ORG		.+Q2		:    ADD OVERFLOW TO THE CURRENT SEG
  4804					  EI				:  ENDIF
  4805	000001			Q1	  EQ		Q1+1		:NEXT Q1
  4806	000000				ER
  4807				
  4808				:GENERATE DIAGNOSTICS
  4809	000000			Q	EQ	0
  4810					LIST
  4811				
  4812				:	BITCH IF ANY SEGMENTS OVERFLOW
  4813					LIST
  4814				
  4815	000000			      IF        \XMEMRY
  4816	000001			      ELSE
  4817	000000			XMEMRY  EQ      0
  4818				      EI
  4819				
  4820				:	SET UP CTA TABLE
  4821	000000			  IF	SESIZE
  4822					REMARK	%SEGMENT E IS RESERVED FOR CTA. REMOVE OTHER ALLOCATIONS.%%
  4823	000001			  ELSE
  4824	0E0000				SEG	0E
Page  12-3	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:01
(ISIS2)FINISH.LIB	  Control Table Allocation and Diagnostics - FINISH.LIB

  4825	000000			      IF        XMEMRY
  4826				CTA     WC      CNTRL+$01000    :Control flags
  4827	000001			      ELSE
  4828	0E0000	0000 028C 	CTA	WC	CNTRL	:CONTROL FLAGS
  4829				      EI
  4830				
  4831	0E0004	0000 0120 		WC	CTASIZ	:SIZE OF CTA AREA
  4832				AREAS
  4833	000000			Q	EQ	0
  4834	00000E				RE	0E
  4835	0E0008	0000 1644 		WC	S|Q|SIZE	:AREA SIZE
  4836	000001			Q	EQ	Q+1
  4837	000000				ER
  4838				
  4839	0E0040	000E 			HC	0E	:NUMBER OF PROTECTION BYTES
  4840	000000			Q	EQ	0
  4841	00000E				RE	0E
  4842	0E0042	06			BC	APROT|Q|
  4843	000001			Q	EQ	Q+1
  4844	000000				ER
  4845				
  4846	0E0050	0001 02B6 		WC	ENTRY	:ENTRY POINT ADDRESS
  4847	000000			    IF	\DSTART
  4848					WC	DSTART	:DDT START ADDRESS
  4849	000001			    ELSE
  4850	0E0054	0000 0000 		WC	0	:NO USER DDT CODE
  4851				    EI
  4852				
  4853	0E0058	0000 15C0 		WC	FPANEL	:ADDRESS OF FRONT PANEL DISPLAY CELL
  4854				
  4855	0E005C	000E 00D8 		WC	HOSTS	:HOST TABLE ADDRESS
  4856	0E0060	000E 00DA 		WC	PORTS	:PORT TABLE ADDRESS
  4857	0E0064	000E 00DC 		WC	PTABLE	:PERMUTER TABLE ADDRESS
  4858	0E0068	0002 2000 		WC	IRING	:INPUT RING ADDRESS
  4859	0E006C	0002 0000 		WC	ORING	:OUTPUT RING ADDRESS
  4860	0E0070	0000 0A62 		WC	FRISIS	:ADDRESS TO INPUT BACKPRESSURE BIT ARRAY
  4861	0E0074	0000 0A5C 		WC	TOISIS	:ADDRESS OF OUTPUT BACKPRESSURE ARRAY
  4862	000000			  IF	\PCTTBL
  4863					WC	PCTTBL	:PROJECT CODE TERMINATION TABLE
  4864	000001			  ELSE
  4865	0E0078	0000 0000 		WC	0	:NULL TABLE
  4866				  EI
  4867	0E007C			COREST	WS	1	:ABSOLUTE CORE ADDRESS OF START OF SLOT
  4868	0E0080	0001 			HC	MAXHST	:MAXIMUM HOSTS FOR SLOT
  4869	0E0082	0020 			HC	MAXPRT	:HIGHEST PORT NUMBER FOR SLOT
  4870	0E0084	07FC 			HC	IRSIZE	:INPUT RING SIZE
  4871	0E0086	1FFC 			HC	ORSIZE	:OUTPUT RING SIZE
  4872	0E0088			SLOTNO	HS	1	:SLOT NUMBER (SUPPLIED BY ISIS)
  4873	0E008A			VERREV	HS	0
  4874	000000			  IF	\VERSION
  4875					BC	VERSION	:VERSION NUMBER
  4876	000001			  ELSE
  4877	0E008A	00			BC	0
Page  12-4	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:01
(ISIS2)FINISH.LIB	  Control Table Allocation and Diagnostics - FINISH.LIB

  4878				  EI
  4879	000000			  IF	\REVLEV
  4880					BC	REVLEV	:REVISION LEVEL
  4881	000001			  ELSE
  4882	0E008B	00 			BC	0
  4883				  EI
  4884				
  4885	000000			    IF	\QSTART
  4886					WC	QSTART	:DDT QUERRY START ADDRESS
  4887	000001			    ELSE
  4888	0E008C	0000 0000 		WC	0	:NO USER CODE
  4889				    EI
  4890	0E0090	0120 		        HC      EMMAC0-CTA
  4891	000000			    IF  \NMACSS
  4892				        HC      NMACSS          :Number of MAC Register Sets
  4893	000001			    ELSE
  4894	0E0092	0000 		        HC      0               :No extended MAC sets
  4895				    EI
  4896	0E0094	0000 		        HC      0               :Segments to be saved
  4897				
  4898	000001			    IF \PRODID
  4899	000000			    ELSE
  4900				      IF  \HID0
  4901				PRODID  EQ      HID0            :Define PRODID as alias
  4902				      ELSE
  4903				      EI  :HID0
  4904				    EI :PRODID
  4905				
  4906	000001			    IF \PRODID
  4907	FFFF9A			      IF PRODID-$a255
  4908				        REMARK  %PRODID is too large%
  4909				        QUIT    1
  4910				      EI
  4911	000069			      IF PRODID-$a48
  4912	000000			      ELSE
  4913				        REMARK  %PRODID is too small%
  4914				        QUIT    1
  4915				      EI
  4916	000000			    ELSE
  4917				        REMARK  %PRODID - Slot Product id must be defined%
  4918				        QUIT    1
  4919				    EI :PRODID
  4920	0E0096	0099 		        HC      PRODID          :slot Product id
  4921				
  4922	0E0098				WS	10	:RESERVED FOR FUTURE EXPANSION
  4923				
  4924	0E00D8			HOSTS	HS	0	:BEGINNING OF HOST TABLE
  4925	000000			Q	EQ	0
  4926	000001				RE	MAXHST
  4927	000001			    IF	\HOST|Q|
  4928	0E00D8	10A1 			HC	HOST|Q|	:HOST NUMBER
  4929	000000			    ELSE
  4930					HC	0	:NO ASSEMBLED IN HOST NUMBER
Page  12-5	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:01
(ISIS2)FINISH.LIB	  Control Table Allocation and Diagnostics - FINISH.LIB

  4931				    EI
  4932	000001			Q	EQ	Q+1
  4933	000000				ER
  4934				
  4935	0E00DA			PORTS	HS	0	:BEGINNING OF PORT TABLE
  4936	000000			Q	EQ	0
  4937	000001				RE	MAXHST
  4938	000000			    IF	\HPRT|Q|
  4939					HC	HPRT|Q|
  4940	000001			    ELSE
  4941	0E00DA	0000 			HC	0	:NO ASSEMBLED IN NUMBER OF PORTS
  4942				    EI
  4943	000001			Q	EQ	Q+1
  4944	000000				ER
  4945				
  4946	0E00DC			PTABLE	HS	MAXPRT+1	:PERMUTER TABLE
  4947				
  4948	0E0120			EMMAC0  WS      0               :Extended Memory MAC Register sets
  4949	000000			    IF XMEMRY
  4950				      IF \NMACSS
  4951				        EXPMAC
  4952				        REMARK  %Using Extended Memory Option%
  4953				        NUMBER  $a NMACSS
  4954				        REMARK  MAC Register sets allocated%
  4955				        NUMBER  $a EMEMR3
  4956				        REMARK k allocated on non-zero meg
  4957				      ELSE
  4958				        REMARK  %NMACSS must be specified with extended memory%
  4959				        QUIT    1
  4960				      EI        :NMACSS
  4961				    EI          :XMEMRY
  4962				
  4963	000120			CTASIZ	EQ	.-CTA	:CTA AREA SIZE
  4964	000120			SESIZE	EQ	.-CTA	:SEG E SIZE
  4965				  EI
  4966				
  4967				:	TELL MEMORY REQUIREMENTS
  4968	000000			Q	EQ	0
  4969	000000			QQ	EQ	0
  4970	000000			QQQ	EQ	0
  4971	00000F				RE	0F
  4972	001644				IF	S|Q|SIZE
  4973					REMARK	%SEGMENT 
  4974					NUMBER	Q
  4975					REMARK	-length 
  4976	001644			QQQ	EQ	S|Q|SIZE
  4977					NUMBER	$A QQQ
  4978					REMARK	d, requires 
  4979	001700			Q3	EQ	(S|Q|SIZE+0FF)&(@0FF)
  4980					NUMBER	Q3
  4981	001700			QQ	EQ	QQ+Q3
  4982					REMARK	x bytes of core.
  4983					EI
Page  12-6	TRACE COLLECTOR    NAD-1.1     2-jul-86 14:01
(ISIS2)FINISH.LIB	  Control Table Allocation and Diagnostics - FINISH.LIB

  4984	000001			Q	EQ	Q+1
  4985	000000				ER
  4986				
  4987				:	GIVE FINAL SIZES
  4988					REMARK	%       
  4989					NUMBER	(QQ+$03FF)/400$A	:FORCE TO BASE 10 FOR OUTPUT
  4990					REMARK	d K-bytes of core
  4991				
  4992					UN		:spew out all undefined symbols

TRACE COLLECTOR    NAD-1.1     2-jul-86 14:01
Symbol cross reference

A.BDAT	   187%	   199	   201%
A.BUFF	    20%	   187%	   209
A.CODE	   187%	   194	   196%	   450	   777	   976	  1077	  1358	  1483	  2162	  3304	  4692
A.DATA	   187%	   189	   191%	   763	   972	  1073	  1468	  2124	  3066	  4688	  4737
A.RING	   187%	   204	   206%	   434
ACP	  2117%	  2147%	  2434	  2466	  2609	  2757	  2774	  2924	  2999	  3031
ACTIV	  2322	  2386	  2418	  2463	  2515	  2530	  2884#	  3057
ACTIV1	  2892	  2895#
ACTIV2	  2900	  2904#
ADACTG	  2283#
ADDR1	  3731	  3733#
ALARM.	   221%	   258%
ALLOG1	  4494	  4502#
ALLOG2	  4501	  4504#
ALLOGD	  4457	  4464	  4473	  4483#
ALONMS	  3458#	  3545
ALRDYM	  3105#	  3460	  3463
APROT0	  4764	  4766#	  4842
APROT1	  4769	  4771#	  4844
APROT2	  4775	  4777#	  4844
APROT3	  4780	  4780#	  4844
APROT4	  4780	  4780#	  4844
APROT5	  4780	  4780#	  4844
APROT6	  4780	  4780#	  4844
APROT7	  4780	  4780#	  4844
APROT8	  4780	  4780#	  4844
APROT9	  4780	  4780#	  4844
APROTA	  4780	  4780#	  4844
APROTB	  4780	  4780#	  4844
APROTC	  4780	  4780#	  4844
APROTD	  4780	  4780#	  4844
AREAS	  4832#
ASCOUT	  1188	  1191	  1195	  1197	  1206	  1208	  1213#
ATHRUE	  3501	  3511#
ATIME	  2138#	  2908	  2963	  3047
AUXBLD	  3789	  3805#	  4173	  4184	  4367	  4487
AUXBRK	  3266#	  3790	  3884	  3914
AUXINI	  3792#	  3799
AUXIS0	  4338#	  4342
AUXIS1	  4340	  4343#
AUXIS2	  4345#	  4350
AUXIS3	  4347	  4351#
AUXISM	  3996	  4332#
AUXWRI	  3882	  3992#
AXBTBL	  3294#	  3791	  4175	  4186	  4369	  4489
AXREQ3	  3233#	  3384	  3516
B6MSG	  2580	  2750#
BADINP	  3472	  3474	  3478	  3486	  3558	  3562	  3566	  3656	  3658	  3690	  3694	  3698	  3755#
BAKGON	  3114#	  4498	  4499	  4500
BAKMSG	  3118#	  3505	  3506	  3507
BAKTBL	  3164#	  3503	  4496
BANNER	  3121#	  4380	  4383	  4392	  4395
BB	  1595%	  1608%	  1651	  1659	  1664	  1729	  1762	  1798	  1799	  1805	  1833	  1835	  1844	  1876
TRACE COLLECTOR    NAD-1.1     2-jul-86 14:01
Symbol cross reference

BBALLM	  3122#	  4386	  4389
BBELL	  2120%	  2405	  3069%
BCT	  1595%	  1607%	  1626	  1654	  1690	  1693	  1722	  1763	  1789	  1815	  1820	  1821	  1823	  1829
	  1832	  1853	  1862	  1875	  1916	  2120%	  2393	  2422	  2512	  2680	  2816	  2855	  3019
BCTL	  2186#	  2531
BDATA	  2179#	  2339
BDISC	   224%	   289%
BE	  1595%	  1609%	  1694	  1698	  1706	  1712	  1730	  1801	  1818	  1819	  1881
BEGFIL	  3100#	  3607	  3610	  3847	  3850
BELCOL	  2120%	  2395	  2413	  3068%
BF	  1595%	  1606%	  1627	  1673	  1718	  1791	  1824	  1850	  1885	  3311	  3315
BFZ	  1604#	  1925
BID	  1357%	  1386%
BID1	  1386	  1388#
BIDH	  1357%	  1367%	  2782	  3007	  3040
BIDH1	  1367	  1369#
BINDEC	   958%	   982%	  1134	  1150
BINHEX	   958%	  1017%
BIX370	  3083#
BIXONT	  3082#
BKGMSG	  2263#
BKPOUT	  3354#
BKPRON	  1597%	  1614%	  3348	  3353	  3363
BKREQ3	  3250#	  3377	  3509
BLKMSG	  2264#
BREAK	  2117%	  2135%	  2344	  2347	  3796	  3887	  3917
BRKEND	  2286#
BRKMSG	  2274#
BUFERS	  1632	  1633	  1634	  1635	  1652	  1662	  1665	  1666	  1667	  1677	  1678	  1679	  1699	  1703
	  1708	  1709	  1710	  1713	  1723	  1726	  1727	  1731	  1771	  1775	  1809	  1839	  1840	  1841
	  1842	  1847	  1848	  1849	  1879	  1880	  1884	  1902	  1906	  1908	  1909	  1910	  1945#
BUFFER	  2142#	  2337	  2601	  2640	  2647	  2676	  2795	  2810	  2814	  2832	  3051
BUFTRC	    18#	  3074#
BUFUSD	  1597%	  1615%	  1669	  1681	  1715	  1733	  1871	  1873	  3350	  3357	  4696
BYTE2	  3097#	  3470	  3491	  3542
C1	  1858	  1862#
CASYN.	   223%	   276%
CEI	   430#	   462	   509	   564	   577	   597
CFGND.	   217%	   233%
CFROM	   685%	   756%	   815	   846
CHFLAG	   774#	   906	   910	   915
CHKB5	  3813	  3923#
CHKBF0	  3349	  3357#
CHKBF1	  3352	  3356	  3359	  3364#
CHKBY2	  3444	  3467#
CHKIFL	  3482	  3688#
CHKSWI	  3490	  3528#
CHR370	  3145#
CHRLIM	  2117%	  2139%	  2415	  2424	  2927	  3021
CIRACT	  3140#	  3407	  3519	  3683	  3891	  3920	  3941	  3957	  4137	  4156	  4287	  4428	  4485
CIRGO3	  3113#	  4451	  4469	  4478	  4502	  4503
CIRGON	  3112#	  3964	  3967
CKBZ	  1641	  1890#
TRACE COLLECTOR    NAD-1.1     2-jul-86 14:01
Symbol cross reference

CMBRD.	   223%	   282%
CNTRL	     6%	   134%	  2126%	  2127	  2128	  2128%	  4828
COREST	   136%	  4867%
CPOINT	   685%	   755%	   813	   836
CPRT.	   223%	   277%
CRASH	   685%	   824%	   886	  1465%	  1510	  1594%	  1647	  1687	  1742	  1758	  1783	  1859	  2310	  2436
	  2537	  2577	  2581	  2759	  2893
CRASH0	   772	   830#
CRASH1	   840	   845#
CRASHC	   685%	   754%	   810	   845	   851	   901
CRAT	   685%	   766%	   767	   809	   810	   812	   813	   815	   835	   836	   843	   845	   846	   851
	   853	   863	   895	   901	   931	   932	   933	   934	   938
CRREG	   685%	   767%
CRSHCD	   778#	   799
CRSHCT	   685%	   753%	   853	   895
CRSTOP	    10%	   685%	   735	   855	   874
CRTENT	   751#	   761
CRTIME	   686%	   759%
CRTLEN	   760#	   766	   929	   932	   933	   934	   935
CRTSIZ	   758#	   938
CRXREG	   757#	   767	   809	   812	   835	   843	   863
CSIO.	   223%	   281%
CSUPF.	   221%	   254%
CSUPR.	   221%	   255%
CSYNI.	   220%	   273%
CSYNO.	   220%	   274%
CTA	  4828#	  4890	  4963	  4964
CTASIZ	  4831	  4963#
CTIME	   686%	   765%	   807	   833	   937
CURHID	  3143#	  3969	  3971	  4012	  4045	  4058	  4365	  4559
CURLEN	  3130#	  4037	  4080	  4091	  4245	  4265	  4308	  4321
CURPSW	   908	   912#
CURSAV	  3075#
DATBYT	  3128#
DATE	  1055%	  1239%	  4039	  4569
DATIME	  1055%	  1078%
DATWRD	  3125#	  4570	  4576	  4582	  4588	  4594	  4600	  4606	  4612	  4648
DAYT	  3127#	  4523	  4526	  4531	  4534	  4539	  4542	  4547	  4550	  4575	  4581	  4587	  4593	  4599
	  4605	  4611	  4616	  4634	  4642
DAZE	  1119	  1128#
DAZE1	  1280	  1288#
DBGOF.	   217%	   235%
DBGON.	   217%	   234%
DCTFLG	  2157	  2357	  2390	  2419	  3016
DECMAL	  1289	  1291	  1296	  1308#
DEFAUL	  2169#	  2346
DEFLN1	  4622#	  4628
DEFLN2	  4625	  4629#
DEFLN3	  4633#	  4639
DEFLN4	  4641#	  4647
DEFLNM	  3603	  3844	  4046	  4619#
DEM	  2151#	  2365	  2610	  2665	  2670	  2731	  2734	  2752
DETMSG	  2258#	  2839	  2841
TRACE COLLECTOR    NAD-1.1     2-jul-86 14:01
Symbol cross reference

DIGIT	   978#	   997	  1021	  1025
DIOMSG	  3152#	  4052	  4055
DISCO.	   267#
DISCO1	  3102#
DISCO2	  3103#	  3711	  3715	  3720	  3723
DISMIS	   217%	   226%	   586	   605	  3345
DIVIDE	   995#	  1000
DSTART	  4847
EAODM	  2288#
ECHO	    16%	  2117%	  2469
ECHOFF	  2118%	  2152%	  2362	  2732	  2735	  2751
EDEM	  2564	  2662#
EDMMSG	  2266#
EFNPTR	  3079#
ELIR	   425%	   503%	  2323	  2389	  2461	  2533	  2600	  2629	  2634	  2639	  2646	  2662	  2669	  2674
	  2692	  2701	  2711	  2726	  2744
ELIR2	   505	   507#
ELODR	   426%	   637%	  2813	  2824
ELODR2	   641	   643#
ELOR	   426%	   546	   649%	   905	  1939	  2502	  2658	  2688	  2697	  2706	  2746	  2838	  2863	  2979
ELOR2	   651	   653#
EMMAC0	  4890	  4948#
EMPT0	  1869	  1871#
EMPTY	  1596%	  1795	  1857%	  1927	  2602	  2608	  2641	  2653	  3976	  3980
ENDAWR	  4022	  4035#
ENDOHL	  3089#	  3588	  3595	  3627
ENDOP2	  4314	  4324#
ENDU2I	  4211	  4215#
ENDUHD	  4302	  4306#
ENDUIN	  3420	  3427#
ENGINE	     9%	   135%	  1366	  1385
ENTER3	  3119#	  3450	  3453
ENTRY	   135%	   685%	   850%	  4846
ENTRY1	   816	   847	   852#
ENTRY2	   803	   857	   870	   873#
ERRFND	  3078#
ETMMSG	  2268#
EVTABL	  4691#	  4694	  4695	  4697	  4699
EVTIDX	  4690#	  4693	  4704
EXCRSH	   686%	   745	   747%	   860	   876
FAIL	   791#	   811	   884
FAIL0	   771	   799#
FAIL1	   801	   804#
FASTC	   132%	   141%	  1489	  1594%	  1639	  2930	  4698
FASTD	   217%	   227%
FGNDFL	   769#	   802	   871	   890
FILDAT	  3124#	  4015	  4042
FIRST	  2257#	  2493	  2553	  2713	  2715	  2755
FLAGS	  1594%	  1628	  1674	  1720	  1796	  1825	  1851	  1886	  3071%
FLBACK	  2561	  2646#
FLG370	  3086#	  3371	  3380	  3387	  3493
FLGONT	  3129#	  3369	  3403	  3685
FLUSH	   425%	   500%	  2596
TRACE COLLECTOR    NAD-1.1     2-jul-86 14:01
Symbol cross reference

FMBIN.	   223%	   283%
FMBOT.	   223%	   284%
FNDFNM	  4059#	  4064
FNMPTR	  3153#	  3613	  3853	  4630
FNMSTR	  3209#	  3615	  3619	  3855	  3859	  4060	  4068	  4072	  4623	  4635	  4643
FPANEL	   136%	   859	  4735	  4738%	  4853
FPRT.	   223%	   278%
FREEZ.	   218%	   237%
FREZS.	   221%	   256%
FRISIS	   136%	  2150%	  2426	  2496	  2616	  2642	  2754	  2923	  2998	  3023	  4740	  4860
FSYNO.	   220%	   275%
GB	  2568	  2674#
GB1	  2682	  2685#
GBALL	  2154#	  2613	  2683	  2694	  2858
GBMSG	  2270#	  2686	  2861
GCI	  1596%	  1649%	  1812	  2120%	  2796	  2799	  2818	  2821	  2835	  3417	  4019	  4208	  4299
GCI1	  1658	  1662#
GCICRA	  1647#	  1650	  1672
GCILAS	  1655	  1672#
GCPCRA	  1758#	  1761	  1768	  1770
GCPEEK	  1596%	  1760%
GCS	  1764	  1769#
GCSCAN	  1596%	  1767%
GET3IX	  4002	  4006#
GETAX0	  4713#	  4716
GETAX1	  4714	  4717#
GETAXR	  3400	  4710#
GETCH	   425%	   474%	  2316	  2338	  2349	  2438	  2452	  2454	  2457	  2526	  2538	  2545	  2710	  2723
	  2725	  2741	  2743	  2764
GETDAT	  3586	  3842	  4044	  4521	  4567#
GETH	   425%	   483%	  2302	  2441	  2443	  2445	  2447	  2450
GETINP	  4018#	  4029	  4033
GETLGB	  4274#	  4281
GETNIX	  3794	  3798#
GETUHD	  4298#	  4305
GETW	   425%	   492%	  2439	  2449
GMT	   132%	   143%	   806	   832	  4038	  4568
GOBBLE	  2560	  2639#
GOBMSG	  2262#	  2656
GONMSG	  3961#	  4372
GOTFNM	  4062	  4065#
GOTOHO	  3663	  3666#
GRYMSG	  2265#
GT1BYT	  4312	  4315#
HALT.	   222%	   264%	   864
HELLO	  3159#	  3779	  3782
HELLO2	  3160#	  4111	  4114
HELMS2	  4110#	  4115
HELMSG	  3778#	  3783
HID0	  4900
HIST	  1660	  1670	  1682	  1700	  1716	  1719	  1734	  1746#
HISTAB	  1612#	  1750	  1753	  1754
HISX	  1611#	  1746	  1749
TRACE COLLECTOR    NAD-1.1     2-jul-86 14:01
Symbol cross reference

HMASK	  2165#	  3008	  3041
HNGMSG	  2275#
HOST0	     7#	  3176	  3177	  3193	  3221	  3222	  3228	  3229	  3236	  3237	  3253	  3254	  4927	  4928
HOSTID	  3141#	  3681	  3818	  3843	  4710
HOSTS	   136%	  4855	  4924%
HOSTUP	  3220#	  3339
HOSTX	   132%	   148%
HOSTYP	  3142#	  3497	  3684	  3815	  3890	  3919	  3924	  3942	  3956
HPRT0	  4938
HS	  2931	  2991#
HS1	  2997#	  3004
HS2	  3000#	  3022	  3024
HS3	  3001	  3007#
HTOZAP	  3139#
IBX370	  3085#	  3445	  3488	  3573	  3576	  3730	  3896	  3901	  4007	  4377	  4425	  4458
IBXOLD	  3088#	  3574	  3638	  4420	  4471
IBXSWI	  3087#	  3529	  3570	  3575	  3578	  3732	  3899	  4422	  4455	  4462	  4480
ID	  3171#	  3181	  3185	  3192	  3192#	  3193	  3193#	  3199#	  3201	  3203	  3203#	  3204	  3204#	  3210#
	  3213	  3216	  3216#	  3217	  3217#
IFAN	  2553	  2556#
IFLAGS	  3072#
IMSG0	  3325	  3979#
INCON	  2431	  2506#
INCON1	  2513	  2516#
INCON2	  2524#	  2528
INCON3	  2525	  2529#	  2544
INCON4	  2532	  2536#
INCON5	  2542#
INCON6	  2543#	  2546
INCONT	  2340	  2430#
INCTL	  2508	  2510	  2540	  2552#
INDAT1	  2345	  2349#	  2388
INDAT2	  2351	  2356#
INDAT3	  2374	  2376#
INDAT4	  2363	  2366	  2382#
INDAT5	  2383	  2387#
INDAT6	  2396	  2398	  2415#
INECHO	  2483
INIT0	  3324#
INIT1	  3330#	  3334
INIT2	  3337#
INITBF	  3310#	  3319
INITR5	  4081	  4085#
INPUT	  2118%	  2297%	  3346
INPUT1	  2298#	  2324	  2416	  2425	  2427	  2497	  2503	  2534	  2597	  2617	  2631	  2636	  2643	  2659
	  2664	  2666	  2671	  2684	  2689	  2698	  2707	  2717	  2728	  2733	  2736	  2747
INPUT2	  2301	  2329#
IO	   220%	   270%
IOQRY.	   220%	   272%
IRING	   135%	   423%	   443%	   462	   463	   466	   468	   474	   483	   492	   509	   882	  4858
IRSIZE	     4%	   134%	   293	   423%	   446	   465	   466	   468	   474	   477	   483	   486	   492	   495
	   506	   508	  4870
ISFGND	   918	   923#
TRACE COLLECTOR    NAD-1.1     2-jul-86 14:01
Symbol cross reference

ISIS2	    64#
ISM370	  3985	  4404#
ITSX3	  3898	  3901#
IZBF	  1596%	  1624%	  3322
IZBF1	  1626#	  1630
IZBF2	  1633#	  1637
IZF1	  2921#	  2929
IZFRON	  2118%	  2918%	  3323
IZT	  1465%	  1547%	  3321
K.IN	   224%	   286%
K.OUT	   224%	   287%
KIO	   224%	   288%
LAODM	  2289#
LCT	   161#
LCX	   135%	   153%
LDEM	  2565	  2669#
LDMMSG	  2267#
LEAV3M	  3719#	  3724
LENGTH	   165#	  2211#	  2213	  2214	  2523	  2542	  2594	  2827
LEPYEA	  1098	  1259	  1324#
LMAC.	   253#
LOGFAL	  2281#
LOGIN2	  3808	  4101#
LOGMSG	  3154#	  3737	  3740
LOGO3	  3640	  3734#
LOGOFF	  3712	  3717#
LOGOK	  2282#
LOGOMS	  3155#	  4436	  4439
LOGON3	  3495#
LOGORG	  3631#	  3636
LOGRDY	  4278	  4283#
LOGREQ	  3123#
LOGST2	  3225#	  3392	  4268	  4270	  4276
LOGU2H	  4251	  4264#
LOGUN1	  3704	  3713#
LOKTBL	  3820#	  3825
LOOK	   425%	   459	   460%	  2298	  2536
LOOP	  1018#	  1037
LOSONT	  4356	  4360#
LOSTC	  4166#	  4171
LP0LST	   164#
LSIZ	  1474#	  1475	  1547	  1551	  1552
LTMMSG	  2269#
MAIN	  3345#	  3372	  3381	  3388	  3396	  3404
MAXCHA	    15%	  2117%	  2920
MAXDIS	    17#
MAXHST	     2#	   305	  4868	  4926	  4937
MAXMSG	   163#
MAXONT	     1%	    24%	    25	  3591	  3655	  4444
MAXP0	   162#
MAXPRT	     3#	   298	  4869	  4946
MAXTYP	  2293#
MAXUN	  3147#	  3471
TRACE COLLECTOR    NAD-1.1     2-jul-86 14:01
Symbol cross reference

MBREAK	  2117%	  2136%	  2507	  3332	  3797	  3886	  3916	  4123	  4135	  4176	  4187	  4370	  4490
MBUFER	  2204	  2206#	  2333	  2367	  2377	  2400	  2407	  2603	  2648	  2677	  2788	  2885	  2905	  2909
	  2951	  2960	  3011	  3048
MCI	  1596%	  1785%
MCI1	  1792	  1796#
MCI2	  1797	  1801#	  1816
MCI3	  1804	  1808	  1811#
MCI4	  1800	  1810	  1818#
MCICRA	  1783#	  1786	  1788
MIN	  1196	  1302	  1313#
MINONT	     1%	    23%	    25	  3171	  3199	  3210	  3657
MINUN	  3146#	  3473
MLOOP	  1277#	  1282
MNTHD	  1261	  1275#
MONLOP	  1116#	  1121
MONTHD	  1100	  1114#
MONTHS	  1139	  1327#
MSGBUF	  3076#	  4027	  4031	  4036	  4082	  4088	  4212	  4216	  4219	  4225	  4256	  4275	  4303	  4307
	  4318
NAMSG3	  3111#	  3949	  3952
NAVMSG	  3110#	  3932	  3935	  4146	  4149
NBFLET	     1%	    19%	  1631	  1900	  1945	  3351	  3358
NBUF	     1%	    13%	  1606	  1607	  1608	  1609	  1625	  1649	  1685	  1760	  1767	  1785	  1787	  1857
	  1914	  3318
NCRSAV	   686%	   740	   742%	   766	   929
NEDMSG	  2256#
NEDZAP	  2467	  2499#
NEED1	  2493#
NEED2	  2435	  2437#
NEEDA3	  3572	  3642#
NEEDLE	  2457#	  2460	  3411	  3769#
NEVNTS	    22#	  4691	  4701
NEXTI1	  4515#	  4520
NEXTNA	  3931#	  3936
NEXTOK	  3834#	  3839
NFMI	   429#	   463	   563	   574	   594	   637	   655
NGRP	    12%	  1597%	  2146%	  2147	  2148	  2149	  2150	  2151	  2152	  2153	  2154	  2155	  2771	  2995
	  2996	  3030	  3071	  3072	  3307
NHOSTS	    25#	  3172	  3200	  3211
NLOGCH	  2279#
NLOGST	  2280#
NMACSS	  4891	  4950
NO370	  3926	  3945#
NOCMSG	  3161#	  4167	  4170
NODEX	   132%	   149%
NOESC0	  2199	  2201#	  2352
NONMSG	  3109#	  3748	  3751
NOPASW	  4239	  4244#
NOSEMI	  4227	  4230#
NOSEND	  2558	  2629#
NOSMSG	  2260#
NOSWI	  3104#	  3645	  3648
NOTEOL	  3593	  3596#
TRACE COLLECTOR    NAD-1.1     2-jul-86 14:01
Symbol cross reference

NOTNEG	   984	   993#
NOTON	  3747#	  3752
NOTON3	  3707	  3745#
NOU2GO	  3809#
NOU2HO	  4193	  4198#
NOU2ON	  4164	  4172#
NPORT	    11%	    12	    13	  2117%	  2135	  2136	  2137	  2138	  2139	  2140	  2146	  2919	  3068	  3073
	  3078	  3327	  3788
NRATE	   132%	   140%
NTOUT	     1%	    14%	  1465%	  1475	  1547
NUMTBL	  3163#
NXTAOM	  3460#	  3464
NXTBIX	  3999#	  4004
NXTBX1	  4353#	  4358
NXTDIO	  4051#	  4056
NXTENT	  3449#	  3454
NXTFIL	  3854#	  3860
NXTFNM	  4067#	  4073
NXTGO3	  4506#	  4511
NXTGON	  3963#	  3968
NXTHID	  4429#	  4447
NXTNA3	  3948#	  3953
NXTNEW	  3614#	  3620
NXTNO3	  3533#	  3538
NXTNSW	  3644#	  3649
NXTOAM	  3672#	  3677
NXTOHO	  3660#	  3665
NXTOK3	  3905#	  3910
NXTOPN	  3846#	  3851
NXTU2I	  4207#	  4214
NXTUIN	  3417#	  3424
OALLMS	  3106#	  3673	  3676
OB	  2562	  2570	  2701#
OBMSG	  2273#
OBS	   424%	   554%
OBS1	   553#	   557
OCM	   424%	   519%	  3340	  3378	  3385	  3393	  3401
OCM370	  3375	  3383#
OCMBY2	  3137#	  3367	  3395	  4285
OCS	   424%	   532%
OCS1	   526	   541#	   545
OHOPIX	  3098#	  3343	  3344	  3876	  3880	  4338	  4345	  4346	  4660
OHOSTS	  3553	  3652#
OKMSG	  3115#	  3835	  3838
OKMSG3	  3116#	  3906	  3909
OKOHGO	  3670	  3680#
ON370	  3447	  3549#
ONEBYT	  4084	  4094#
ONESEC	  2934	  3028#
ONTOCM	  3370	  3398#
OPNEWF	  3606#	  3611
ORIGR1	  3138#	  3415	  3455	  3525	  3742	  3765	  3831	  3866	  3895	  3911	  3928	  3939	  3954	  3993
	  4094	  4142	  4154	  4161	  4172	  4179	  4183	  4197	  4201	  4261	  4288	  4292	  4324	  4366
TRACE COLLECTOR    NAD-1.1     2-jul-86 14:01
Symbol cross reference

	  4397	  4405	  4417	  4486	  4560
ORING	   135%	   423%	   437%	   563	   564	   574	   577	   594	   597	   607	   608	   614	   622	   630
	   637	   645	   655	   881	  4859
ORSIZE	     5%	   134%	   295	   423%	   440	   567	   569	   575	   578	   582	   595	   598	   601	   607
	   608	   614	   617	   622	   625	   630	   633	   638	   642	   645	   652	   654	  4871
OS1	  3031#	  3035
OS2	  3034#	  3039
OS3	  3033	  3038#	  3053	  3058
OURS	  1189	  1295	  1311#
OUT0	  2772#	  2780
OUT1	  2774#	  2853	  2856	  2859	  2864
OUT10	  2815	  2840	  2842	  2855#
OUT2	  2778	  2782#
OUT3	  2798	  2804#
OUT4	  2809#	  2820	  2823
OUT5	  2813#	  2817
OUT6	  2812	  2816#
OUT7	  2801	  2827#
OUT8	  2833#	  2837
OUT9	  2834	  2838#
OUTBIX	  3150#	  4009	  4048
OUTCRT	  2153#	  2611	  2663	  2721	  2750	  2926
OUTPUT	  2118%	  2770%	  3366
PAIR	  2313	  2522	  2870#
PASSWO	  3136#	  4223	  4229	  4230	  4238
PATCH0	  4751	  4753#
PATCH1	  4755	  4757#
PATCH2	  4759	  4761#
PCTTBL	  4862
PDATA	  3073#
PICKUN	  3493#	  3547
PNDMSG	  2278#
PNDSGN	  4026	  4030#
PORT	  2119%	  2141%	  2329	  2465	  2787	  2804	  2829	  2843	  2857	  2901	  2912	  3045	  3054	  4410
PORTS	   136%	  4856	  4935%
PROCES	  2117%	  2137%	  2890	  3326	  3331	  3795	  3885	  3915	  4121	  4133	  4174	  4185	  4368	  4488
PRODID	     8%	   686%	   903	  4898	  4906	  4907	  4911	  4920
PROMPT	  3158#
PRTOUT	  1193	  1204	  1214#
PRTSVC	  2156#	  2773	  2777	  2786
PSHTBS	   805	   831	   929#
PSWSAV	   773#	   911	   921	   925
PTABLE	  4857	  4946#
PTIME	  2148#	  2614	  2902	  2913	  2921	  2956	  2965	  3032	  3055
PTTOUT	  2118%	  2948%
PTTSET	  2950	  2959#
PUSHIT	   931#	   936
PUTCH	   426%	   540	   543	   555	   614%	   896	   898	   900	   902	   904	  1938	  2742	  2745	  2809
	  2836
PUTH	   426%	   524	   537	   622%	  1933	  1936
PUTLOG	  3736#	  3741
PUTON3	  3510	  3517#
PUTW	   426%	   630%	   894	  1931
TRACE COLLECTOR    NAD-1.1     2-jul-86 14:01
Symbol cross reference

Q	   314#	   315	   315#	   318#	   319	   319#	  4809#	  4810	  4810#	  4813#	  4813	  4833#	  4835	  4836
	  4836#	  4837	  4837#	  4840#	  4842	  4843	  4843#	  4844	  4844#	  4925#	  4927	  4928	  4932	  4932#
	  4936#	  4938	  4943	  4943#	  4968#	  4972	  4974	  4976	  4979	  4984	  4984#	  4985	  4985#
Q1	  4773#	  4775	  4777	  4779	  4779#	  4780	  4780#	  4788#	  4790	  4791	  4795	  4800	  4805	  4805#
	  4806	  4806#
Q3	  4791#	  4792	  4797	  4806#	  4806	  4979#	  4980	  4981	  4985#	  4985
QQ	   319#	   321	  4969#	  4981	  4981#	  4985	  4985#	  4989
QQQ	  4970#	  4976#	  4977	  4985#	  4985
QSTART	  4885
QTPMSG	  2276#
QUADAY	  1090	  1251	  1323#
R0	   133%	   168%	   474	   483	   492	   500	   519	   520	   521	   523	   532	   533	   534	   536
	   539	   542	   554	   562	   564	   565	   567	   568	   584	   603	   614	   622	   630	   639
	   640	   642	   643	   645	   793	   796	   799	   800	   802	   804	   808	   810	   824	   827
	   830	   834	   835	   837	   841	   845	   850	   851	   856	   858	   859	   863	   867	   869
	   871	   880	   881	   882	   884	   889	   890	   893	   895	   897	   899	   901	   903	   914
	   915	   917	   919	   921	   923	   925	  1078	  1176	  1209	  1485	  1488	  1491	  1492	  1498
	  1499	  1516	  1524	  1532	  1538	  1554	  1624	  1626	  1632	  1634	  1635	  1638	  1641	  1652
	  1699	  1713	  1731	  1750	  1771	  1789	  1798	  1799	  1815	  1818	  1819	  1820	  1821	  1822
	  1823	  1840	  1841	  1897	  1898	  1916	  1917	  1919	  1923	  1924	  1928	  1930	  1932	  1934
	  1935	  1937	  2297	  2303	  2312	  2321	  2339	  2343	  2350	  2373	  2382	  2384	  2385	  2393
	  2397	  2399	  2405	  2412	  2413	  2414	  2415	  2417	  2422	  2424	  2430	  2440	  2442	  2444
	  2446	  2448	  2451	  2453	  2455	  2456	  2462	  2493	  2494	  2499	  2509	  2511	  2514	  2529
	  2539	  2594	  2595	  2654	  2680	  2685	  2695	  2702	  2712	  2713	  2715	  2716	  2724	  2729
	  2738	  2755	  2756	  2770	  2797	  2800	  2806	  2808	  2816	  2819	  2822	  2828	  2855	  2860
	  2870	  2872	  2878	  2879	  2895	  2898	  2901	  2902	  2904	  2908	  2912	  2913	  2918	  2931
	  2934	  2949	  2959	  2963	  2977	  3019	  3021	  3047	  3052	  3054	  3055	  3056	  3321	  3323
	  3342	  3343	  3344	  3346	  3354	  3360	  3362	  3363	  3366	  3410	  3418	  3419	  3421	  3426
	  3428	  3429	  3431	  3435	  3438	  3450	  3460	  3520	  3534	  3568	  3607	  3615	  3621	  3623
	  3632	  3645	  3673	  3720	  3737	  3748	  3756	  3759	  3761	  3763	  3779	  3784	  3806	  3812
	  3835	  3840	  3847	  3855	  3861	  3863	  3870	  3876	  3906	  3932	  3937	  3949	  3964	  3969
	  3971	  3984	  3994	  4020	  4021	  4023	  4025	  4027	  4030	  4031	  4036	  4052	  4068	  4074
	  4076	  4078	  4082	  4088	  4111	  4116	  4127	  4146	  4151	  4167	  4195	  4202	  4209	  4210
	  4212	  4216	  4217	  4219	  4225	  4226	  4235	  4240	  4242	  4246	  4249	  4250	  4256	  4259
	  4293	  4300	  4301	  4303	  4307	  4318	  4333	  4380	  4386	  4392	  4406	  4408	  4411	  4436
	  4507	  4516	  4523	  4526	  4528	  4531	  4534	  4536	  4539	  4542	  4544	  4547	  4550	  4552
	  4554	  4556	  4695
R1	   133%	   169%	   466	   469	   576	   577	   578	   579	   582	   583	   584	   607	   637	   638
	   640	   645	   799	   806	   807	   814	   815	   832	   833	   838	   843	   846	   852	   853
	   906	   907	   909	   910	   929	   931	   932	   933	   934	   935	   937	   938	  1367	  1386
	  1489	  1490	  1506	  1517	  1520	  1521	  1522	  1524	  1526	  1529	  1530	  1534	  1535	  1536
	  1538	  1540	  1543	  1544	  1547	  1550	  1551	  1552	  1625	  1626	  1627	  1629	  1631	  1632
	  1633	  1634	  1635	  1636	  1639	  1640	  1649	  1651	  1654	  1659	  1664	  1673	  1685	  1690
	  1693	  1694	  1698	  1706	  1712	  1718	  1722	  1729	  1730	  1751	  1760	  1762	  1763	  1767
	  1791	  1793	  1796	  1801	  1802	  1803	  1809	  1811	  1813	  1824	  1825	  1829	  1832	  1833
	  1835	  1844	  1850	  1853	  1857	  1862	  1875	  1876	  1881	  1885	  1890	  1892	  1900	  1904
	  1910	  1914	  1916	  1920	  1921	  1926	  2300	  2329	  2330	  2331	  2332	  2337	  2370	  2380
	  2393	  2403	  2410	  2422	  2465	  2466	  2494	  2495	  2496	  2512	  2601	  2606	  2640	  2647
	  2651	  2655	  2675	  2683	  2693	  2694	  2703	  2720	  2721	  2731	  2732	  2734	  2735	  2772
	  2773	  2774	  2775	  2776	  2777	  2783	  2784	  2785	  2787	  2792	  2793	  2795	  2804	  2805
	  2810	  2814	  2816	  2829	  2832	  2855	  2857	  2858	  2884	  2890	  2897	  2908	  2919	  2921
	  2922	  2923	  2924	  2925	  2926	  2927	  2928	  2932	  2935	  2936	  2948	  2981	  2991	  3000
	  3010	  3021	  3023	  3028	  3038	  3042	  3043	  3044	  3045	  3046	  3047	  3051	  3306	  3311
TRACE COLLECTOR    NAD-1.1     2-jul-86 14:01
Symbol cross reference

	  3312	  3315	  3317	  3318	  3325	  3326	  3329	  3331	  3348	  3350	  3351	  3357	  3358	  3402	  3403
	  3415	  3432	  3455	  3525	  3638	  3639	  3730	  3732	  3733	  3742	  3765	  3774	  3775	  3787
	  3793	  3830	  3831	  3832	  3866	  3867	  3880	  3881	  3885	  3886	  3887	  3895	  3899	  3901
	  3904	  3911	  3915	  3916	  3917	  3928	  3929	  3939	  3946	  3954	  3993	  4001	  4048	  4094
	  4107	  4108	  4119	  4121	  4123	  4129	  4130	  4131	  4133	  4135	  4142	  4143	  4154	  4161
	  4162	  4163	  4172	  4174	  4176	  4179	  4183	  4185	  4187	  4191	  4192	  4194	  4197	  4201
	  4221	  4253	  4261	  4288	  4292	  4310	  4324	  4335	  4355	  4371	  4377	  4378	  4397	  4405
	  4417	  4420	  4422	  4430	  4431	  4433	  4443	  4444	  4486	  4488	  4490	  4504	  4560	  4660
	  4712	  4713	  4715	  4717
R10	   133%	   178%	   836	   839	   841	   842	   886	   987	   998	   999	  1018	  1036	  1104	  1105
	  1133	  1149	  1265	  1266	  1510	  1647	  1687	  1742	  1758	  1783	  1859	  2310	  2344	  2346
	  2347	  2382	  2436	  2451	  2507	  2509	  2537	  2577	  2581	  2759	  2893
R10VAL	  3126#
R11	   133%	   179%	   986	   988	   993	   998	  1018	  1019	  1024	  1103	  1109	  1130	  1137	  1140
	  1142	  1144	  1145	  1152	  1153	  1264	  1270	  2453
R12	   133%	   180%	   811	   985	   986	   994	   996	  1019	  1020	  1021	  1023	  1024	  1025	  2300
	  2455	  2771	  2774	  2775	  2776	  2779	  2783
R13	   133%	   181%	   813	   997	   998	  1021	  1022	  1025	  1026	  1029	  1030	  1129	  1154	  2456
	  2459
R14	   133%	   182%	   462	   463	   465	   466	   467	   468	   474	   475	   477	   483	   484	   486
	   492	   493	   495	   500	   503	   504	   506	   508	   509	   812	  1088	  1155	  1249	  1294
	  3031	  3032	  3038	  3041
R15	   133%	   183%	   563	   565	   569	   574	   575	   579	   594	   595	   599	   607	   608	   609
	   614	   615	   617	   622	   623	   625	   630	   631	   633	   639	   649	   650	   652	   654
	   655	  2890	  2896	  3030	  3031	  3032	  3034	  3042	  3977	  3981
R1VALU	  3080#
R2	   133%	   170%	   468	   523	   525	   536	   538	   539	   544	   556	   608	   794	   795	   797
	   805	   809	   825	   826	   828	   831	   839	   842	   843	   922	   926	   930	   939	  1085
	  1086	  1088	  1089	  1090	  1099	  1101	  1103	  1108	  1115	  1116	  1118	  1182	  1183	  1185
	  1186	  1187	  1189	  1194	  1196	  1205	  1207	  1246	  1247	  1249	  1250	  1251	  1260	  1262
	  1264	  1269	  1276	  1277	  1279	  1294	  1295	  1299	  1302	  1368	  1387	  1487	  1490	  1493
	  1496	  1497	  1498	  1502	  1503	  1504	  1506	  1515	  1521	  1522	  1527	  1535	  1536	  1541
	  1548	  1549	  1550	  1627	  1628	  1651	  1652	  1656	  1657	  1659	  1662	  1666	  1667	  1675
	  1676	  1678	  1679	  1690	  1692	  1693	  1694	  1695	  1696	  1698	  1699	  1705	  1706	  1707
	  1708	  1709	  1710	  1718	  1720	  1721	  1722	  1725	  1726	  1727	  1741	  1751	  1752	  1753
	  1762	  1771	  1772	  1773	  1775	  1776	  1805	  1806	  1807	  1809	  1829	  1831	  1832	  1833
	  1834	  1835	  1836	  1837	  1842	  1847	  1848	  1850	  1851	  1852	  1853	  1865	  1867	  1868
	  1874	  1875	  1876	  1877	  1878	  1880	  1881	  1882	  1883	  1884	  1885	  1886	  1899	  1902
	  1908	  1910	  2384	  2399	  2414	  2500	  2594	  2656	  2676	  2680	  2686	  2704	  2724	  2727
	  2739	  2785	  2786	  2830	  2861	  2920	  2927	  2948	  2954	  2956	  2963	  2964	  2965	  2976
	  3008	  3009	  3010	  3014	  3019	  3041	  3044	  3307	  3308	  3314	  3327	  3331	  3332	  3333
	  3338	  3376	  3383	  3391	  3399	  3788	  3793	  3795	  3796	  3797	  3798	  4335	  4336	  4339
	  4693	  4694	  4695	  4697	  4699	  4700	  4701	  4703	  4704
R2SAVE	  1617#
R3	   133%	   171%	   519	   525	   532	   538	   541	   542	   553	   554	   596	   597	   598	   599
	   601	   602	   603	  1079	  1096	  1097	  1117	  1118	  1151	  1152	  1155	  1185	  1192	  1203
	  1207	  1213	  1214	  1240	  1257	  1258	  1278	  1279	  1296	  1297	  1300	  1303	  1369	  1388
	  1493	  1494	  1503	  1512	  1513	  1514	  1526	  1527	  1528	  1529	  1540	  1541	  1542	  1543
	  1653	  1654	  1662	  1663	  1664	  1665	  1666	  1668	  1669	  1673	  1674	  1677	  1678	  1680
	  1681	  1703	  1708	  1709	  1711	  1712	  1713	  1714	  1715	  1723	  1726	  1728	  1729	  1730
	  1731	  1732	  1733	  1737	  1738	  1739	  1740	  1746	  1747	  1748	  1749	  1750	  1753	  1754
	  1763	  1769	  1839	  1840	  1842	  1843	  1844	  1848	  1849	  1862	  1870	  1872	  1879	  1884
	  1906	  1907	  2430	  2539	  2552	  2553	  2782	  3007	  3040	  3308	  3311	  3313	  3316	  3328
TRACE COLLECTOR    NAD-1.1     2-jul-86 14:01
Symbol cross reference

	  3332	  3339	  3377	  3384	  3392	  3789	  3795	  4038	  4568	  4696	  4697	  4698	  4699	  4717
R4	   133%	   172%	   464	   470	   476	   478	   485	   487	   494	   496	   510	   522	   524	   535
	   537	   540	   543	   546	   555	   570	   581	   585	   610	   616	   618	   624	   626	   632
	   634	   644	   656	   892	   894	   896	   898	   900	   902	   904	   905	  1002	  1033	  1128
	  1129	  1134	  1139	  1140	  1141	  1142	  1143	  1144	  1150	  1154	  1216	  1495	  1496	  1508
	  1512	  1513	  1515	  1516	  1517	  1648	  1688	  1743	  1754	  1755	  1759	  1774	  1777	  1794
	  1812	  1814	  1838	  1845	  1854	  1860	  1863	  1887	  1908	  1909	  1927	  1929	  1931	  1933
	  1936	  1938	  1939	  2298	  2302	  2316	  2318	  2319	  2322	  2323	  2338	  2349	  2354	  2356
	  2372	  2375	  2386	  2389	  2395	  2397	  2406	  2418	  2438	  2439	  2441	  2443	  2445	  2447
	  2449	  2450	  2452	  2454	  2457	  2458	  2461	  2463	  2501	  2502	  2512	  2515	  2526	  2527
	  2530	  2533	  2536	  2538	  2545	  2596	  2600	  2602	  2608	  2629	  2634	  2639	  2641	  2646
	  2653	  2657	  2658	  2662	  2669	  2674	  2687	  2688	  2692	  2696	  2697	  2701	  2705	  2706
	  2710	  2711	  2723	  2725	  2726	  2740	  2741	  2742	  2743	  2744	  2745	  2746	  2764	  2796
	  2799	  2807	  2809	  2813	  2818	  2821	  2824	  2831	  2835	  2836	  2838	  2862	  2863	  2871
	  2873	  2894	  2899	  2903	  2914	  2957	  2966	  2978	  2979	  3057	  3313	  3314	  3315	  3400
	  3417	  3436	  3442	  3443	  3451	  3461	  3469	  3470	  3471	  3473	  3476	  3477	  3480	  3481
	  3484	  3485	  3491	  3492	  3493	  3499	  3500	  3502	  3503	  3505	  3509	  3512	  3516	  3521
	  3535	  3542	  3544	  3546	  3551	  3552	  3556	  3557	  3560	  3561	  3564	  3565	  3569	  3579
	  3580	  3581	  3582	  3598	  3600	  3608	  3616	  3622	  3624	  3633	  3646	  3654	  3655	  3657
	  3662	  3674	  3681	  3689	  3692	  3693	  3696	  3697	  3702	  3703	  3706	  3710	  3711	  3714
	  3715	  3721	  3727	  3728	  3738	  3749	  3757	  3760	  3762	  3764	  3780	  3785	  3790	  3796
	  3815	  3816	  3818	  3822	  3828	  3836	  3841	  3848	  3856	  3862	  3864	  3871	  3882	  3885
	  3907	  3912	  3915	  3924	  3925	  3933	  3938	  3950	  3965	  3970	  3972	  3976	  3980	  4019
	  4053	  4069	  4075	  4077	  4079	  4083	  4089	  4112	  4117	  4120	  4121	  4122	  4123	  4132
	  4133	  4134	  4135	  4147	  4152	  4168	  4173	  4174	  4175	  4176	  4184	  4185	  4186	  4187
	  4196	  4208	  4233	  4241	  4243	  4247	  4257	  4275	  4276	  4277	  4299	  4313	  4319	  4337
	  4338	  4341	  4343	  4346	  4348	  4367	  4368	  4369	  4370	  4381	  4387	  4393	  4437	  4450
	  4451	  4452	  4467	  4468	  4469	  4476	  4477	  4478	  4487	  4488	  4489	  4490	  4492	  4493
	  4495	  4496	  4498	  4508	  4517	  4524	  4527	  4529	  4532	  4535	  4537	  4540	  4543	  4545
	  4548	  4551	  4553	  4555	  4557	  4621	  4623	  4626	  4630	  4631	  4635	  4636	  4640	  4643
	  4644	  4662	  4718
R5	   133%	   173%	   547	   558	  1130	  1153	  1214	  1306	  1511	  1518	  1523	  1531	  1537	  1545
	  1785	  1789	  1793	  1798	  1805	  1811	  1815	  1818	  1820	  1823	  1824	  1866	  1867	  1871
	  1872	  1873	  1891	  2303	  2304	  2305	  2307	  2312	  2343	  2387	  2440	  2511	  2523	  2529
	  2531	  2542	  2797	  2800	  2808	  2819	  2822	  2827	  2830	  2839	  2841	  2843	  2846	  2870
	  2872	  2933	  2937	  2988	  2992	  2995	  2998	  2999	  3002	  3029	  3322	  3340	  3367	  3369
	  3371	  3374	  3378	  3379	  3380	  3385	  3386	  3387	  3393	  3394	  3395	  3401	  3407	  3408
	  3416	  3421	  3422	  3423	  3425	  3428	  3430	  3431	  3433	  3435	  3437	  3441	  3442	  3445
	  3446	  3448	  3450	  3452	  3453	  3459	  3460	  3462	  3463	  3468	  3469	  3475	  3476	  3479
	  3480	  3483	  3484	  3488	  3489	  3496	  3497	  3498	  3499	  3504	  3505	  3508	  3509	  3511
	  3512	  3515	  3516	  3518	  3519	  3520	  3522	  3523	  3529	  3530	  3532	  3534	  3536	  3537
	  3550	  3551	  3555	  3556	  3559	  3560	  3563	  3564	  3570	  3571	  3573	  3574	  3575	  3576
	  3577	  3578	  3583	  3584	  3590	  3591	  3605	  3607	  3609	  3610	  3612	  3618	  3619	  3630
	  3632	  3634	  3635	  3643	  3645	  3647	  3648	  3653	  3654	  3659	  3661	  3664	  3667	  3668
	  3671	  3673	  3675	  3676	  3682	  3683	  3684	  3685	  3691	  3692	  3695	  3696	  3700	  3703
	  3705	  3706	  3709	  3711	  3713	  3715	  3718	  3720	  3722	  3723	  3725	  3728	  3735	  3737
	  3739	  3740	  3746	  3748	  3750	  3751	  3770	  3771	  3773	  3776	  3779	  3781	  3782	  3791
	  3797	  3809	  3810	  3819	  3821	  3824	  3827	  3828	  3830	  3833	  3835	  3837	  3838	  3843
	  3845	  3847	  3849	  3850	  3852	  3857	  3859	  3868	  3870	  3872	  3873	  3875	  3876	  3878
	  3880	  3883	  3886	  3889	  3890	  3891	  3896	  3897	  3903	  3906	  3908	  3909	  3913	  3916
	  3918	  3919	  3920	  3930	  3932	  3934	  3935	  3940	  3941	  3942	  3947	  3949	  3951	  3952
	  3955	  3956	  3957	  3962	  3964	  3966	  3967	  3998	  4000	  4003	  4010	  4011	  4013	  4014
	  4017	  4027	  4028	  4031	  4032	  4036	  4037	  4039	  4045	  4049	  4052	  4054	  4055	  4057
TRACE COLLECTOR    NAD-1.1     2-jul-86 14:01
Symbol cross reference

	  4060	  4063	  4068	  4070	  4080	  4086	  4088	  4090	  4091	  4102	  4104	  4105	  4109	  4111	  4113
	  4114	  4136	  4137	  4138	  4144	  4146	  4148	  4149	  4155	  4156	  4157	  4165	  4167	  4169
	  4170	  4177	  4178	  4188	  4189	  4190	  4206	  4212	  4213	  4216	  4218	  4219	  4222	  4223
	  4225	  4234	  4245	  4254	  4256	  4258	  4265	  4266	  4268	  4269	  4270	  4273	  4275	  4279
	  4284	  4285	  4286	  4287	  4297	  4303	  4304	  4307	  4308	  4311	  4316	  4318	  4320	  4321
	  4343	  4344	  4345	  4349	  4352	  4354	  4357	  4362	  4363	  4364	  4366	  4368	  4370	  4379
	  4380	  4382	  4383	  4385	  4386	  4388	  4389	  4391	  4392	  4394	  4395	  4427	  4428	  4430
	  4442	  4443	  4446	  4449	  4451	  4453	  4454	  4455	  4456	  4458	  4459	  4460	  4461	  4462
	  4463	  4466	  4469	  4470	  4471	  4472	  4475	  4478	  4479	  4480	  4481	  4484	  4485	  4497
	  4498	  4505	  4507	  4509	  4510	  4514	  4516	  4518	  4519	  4522	  4523	  4525	  4526	  4530
	  4531	  4533	  4534	  4538	  4539	  4541	  4542	  4546	  4547	  4549	  4550	  4558	  4559	  4569
	  4574	  4575	  4580	  4581	  4586	  4587	  4592	  4593	  4598	  4599	  4604	  4605	  4610	  4611
	  4615	  4616	  4624	  4632	  4634	  4637	  4638	  4642	  4645	  4646	  4658	  4660	  4663	  4710
	  4711	  4713
R6	   133%	   174%	   931	   932	   933	   934	  1114	  1117	  1120	  1138	  1139	  1188	  1191	  1193
	  1195	  1197	  1204	  1206	  1208	  1210	  1217	  1275	  1278	  1281	  1288	  1289	  1290	  1292
	  1293	  1297	  1298	  1300	  1301	  1303	  1787	  1791	  1799	  1801	  1813	  1819	  1821	  2313
	  2442	  2522	  2805	  2806	  2811	  2827	  2828	  2833	  2874	  2996	  3003	  3009	  3355	  3361
	  3506	  3513	  3520	  3543	  3544	  3613	  3615	  3617	  3627	  3628	  3661	  3662	  3668	  3669
	  3701	  3702	  3726	  3727	  3821	  3822	  3853	  3855	  3858	  3884	  3887	  3914	  3917	  3973
	  4000	  4001	  4007	  4008	  4009	  4011	  4012	  4014	  4015	  4040	  4041	  4042	  4060	  4061
	  4228	  4229	  4230	  4231	  4237	  4238	  4267	  4268	  4269	  4272	  4276	  4280	  4338	  4339
	  4345	  4346	  4354	  4355	  4361	  4362	  4372	  4416	  4424	  4425	  4434	  4436	  4438	  4439
	  4499	  4502	  4507	  4570	  4571	  4572	  4573	  4575	  4576	  4577	  4578	  4579	  4581	  4582
	  4583	  4584	  4585	  4587	  4588	  4589	  4590	  4591	  4593	  4595	  4596	  4597	  4599	  4600
	  4601	  4602	  4603	  4605	  4606	  4607	  4608	  4609	  4611	  4612	  4613	  4614	  4616	  4623
	  4624	  4634	  4635	  4642	  4643	  4648	  4649	  4650	  4651	  4661	  4694
R7	   133%	   175%	  1098	  1110	  1117	  1239	  1259	  1271	  1278	  1305	  1784	  1790	  1794	  1817
	  1826	  1915	  1917	  1919	  1932	  2307	  2308	  2314	  2444	  2523	  2524	  2542	  2543	  2930
	  2932	  2935	  2997	  2998	  2999	  3000	  3008	  3507	  3514	  3523	  3586	  3594	  3595	  3603
	  3842	  3844	  4044	  4046	  4058	  4061	  4066	  4071	  4072	  4364	  4365	  4500	  4503	  4510
	  4521	  4617	  4652
R8	   133%	   176%	   982	   995	   996	   997	  1001	  1022	  1026	  1030	  1031	  1035	  1095	  1097
	  1102	  1109	  1148	  1180	  1214	  1215	  1256	  1258	  1263	  1270	  1920	  1925	  1926	  1934
	  2332	  2344	  2347	  2446	  2507	  3587	  3588	  3590	  3597	  3598	  3599	  3602	  3604	  3626
	  4620	  4627	  4651
R8VALU	  3096#	  3602	  3604
R9	   133%	   177%	   983	   991	   992	  1017	  1027	  1032	  1116	  1148	  1277	  1291	  1292	  2330
	  2362	  2365	  2395	  2413	  2415	  2424	  2426	  2434	  2448	  2609	  2610	  2611	  2612	  2613
	  2614	  2615	  2616	  2621	  2630	  2635	  2642	  2655	  2663	  2665	  2670	  2675	  2693	  2703
	  2716	  2720	  2750	  2751	  2752	  2753	  2754	  2756	  2757	  4410	  4413	  4415
RATE	   132%	   139%	  1594%	  1640	  1890	  2932	  2935	  2936	  2991	  3028
RB	  2569	  2692#
RBK370	  4412	  4415#
RBMAC.	   219%	   247%
RBMSG	  2271#
RBPSD.	   218%	   243%	   916	   920
RBREG.	   218%	   242%
RDDTP.	   218%	   241%
RDDTR.	   218%	   240%
RDMAC.	   219%	   246%
RDY2RI	  4253#
REB1	  1899#	  1940
TRACE COLLECTOR    NAD-1.1     2-jul-86 14:01
Symbol cross reference

REB2	  1902#	  1905
REBC1	  1602#	  1898
REBC2	  1603#	  1924
REBL	  1601#	  1638	  1737	  1739	  1892	  1907
REBZ	  1903	  1914#
REBZ1	  1916#	  1922
REGYER	  1110	  1271	  1325#
RELBKP	  3360#
REPEAT	  1028	  1035#
REQLEN	  3149#
REQSTR	  3170#	  4713	  4717
RESEND	  2559	  2634#
RET	  2299	  2781	  2878#	  2938
RETP	  2144#	  2297	  2770	  2878	  2918
RETRN	  1200	  1209#
RETURN	  3409	  3456	  3526	  3743	  3766	  3772	  3800	  3803	  3807	  3829	  3892	  3921	  3943	  3958
	  3975#	  3986	  3995	  4095	  4103	  4124	  4139	  4158	  4180	  4198	  4204	  4262	  4289	  4295
	  4325	  4398	  4418	  4561
REVLEV	  4879
RFMAC.	   219%	   248%
RFPSD.	   219%	   245%	   868	   924
RFREG.	   219%	   244%
RGSTOR	   768#	   793	   794	   796	   797	   804	   808	   824	   825	   827	   828	   830	   834
RING	   431#	   466	   468	   474	   483	   492	   607	   608	   614	   622	   630	   645
ROOM	   426%	   522	   535	   574%	  1929
ROOM1	   576#	   587
ROOM2	   580	   583#
RSAVE	   974#	   982	  1001	  1017	  1032	  1075#	  1078	  1176	  1209	  1239	  1305
RSCLK.	   221%	   259%
RSETFN	  3589#	  3629
RSTRT.	   217%	   232%	   885
RTRN	   989	  1001#
S0SIZE	  4810#	  4813	  4835	  4972	  4976	  4979
S1SIZE	  4810#	  4813	  4837	  4985
S2SIZE	  1947#	  4810#	  4813	  4837	  4985
S3SIZE	  4810#	  4813	  4837	  4985
S4SIZE	  4810#	  4813	  4837	  4985
S5SIZE	  4810#	  4813	  4837	  4985
S6SIZE	  4810#	  4813	  4837	  4985
S7SIZE	  4810#	  4813	  4837	  4985
S8SIZE	  4810#	  4813	  4837	  4985
S9SIZE	  4810#	  4813	  4837	  4985
SAMFIL	  4043	  4047#
SASIZE	  4810#	  4813	  4837	  4985
SAVBK0	  4702	  4704#
SAVBKP	  4659	  4693#
SAVE	  2143#	  2884	  2897
SAVPSW	   795	   826	   914#
SBK370	  4414	  4416#
SBKMO1	  4660#	  4664	  4705
SBKMOH	  3355	  3361	  4416	  4658#
SBSIZE	  4810#	  4813	  4837	  4985
SCSIZE	  4810#	  4813	  4837	  4985
TRACE COLLECTOR    NAD-1.1     2-jul-86 14:01
Symbol cross reference

SDISC	   224%	   290%
SDSIZE	  4810#	  4813	  4837	  4985
SEC745	  1079	  1240	  1319#
SECDAY	  1086	  1183	  1247	  1309#
SEG0	   315	   315%	   319	  4810	  4810%
SEG1	   315	   315%	   319	  4810	  4810%
SEG2	   315	   315%	   319	  1947	  4810	  4810%
SEG3	   315	   315%	   319	  4810	  4810%
SEG4	   315	   315%	   319	  4810	  4810%
SEG5	   315	   315%	   319	  4810	  4810%
SEG6	   315	   315%	   319	  4810	  4810%
SEG7	   315	   315%	   319	  4810	  4810%
SEG8	   315	   315%	   319	  4810	  4810%
SEG9	   315	   315%	   319	  4810	  4810%
SEGA	   315	   315%	   319	  4810	  4810%
SEGB	   315	   315%	   319	  4810	  4810%
SEGC	   315	   315%	   319	  4810	  4810%
SEGD	   315	   315%	   319	  4810	  4810%
SEGE	   315	   315%	   319	  4810	  4810%
SENLOG	  4435#	  4440
SESIZE	  4810#	  4813	  4821	  4964#	  4985
SET1P.	   219%	   249%
SET370	  3817	  3894#
SETBE.	   219%	   251%
SETEOL	  3592	  3594#
SETFE.	   220%	   252%
SETIDX	  3823	  3826#
SETP.	   219%	   250%
SETTP	  2575	  2720#
SETTP1	  2730	  2734#
SETTP3	  2722	  2738#
SFREZ.	   222%	   263%
SHALT.	   222%	   265%
SHARE	   224%	   285%
SHGMSG	  2284#
SIIX	  2291#
SKIPLF	  4024	  4029#
SKIPX3	  3900	  3902#
SKPLOG	  4432	  4441#
SKPRFN	  3601	  3625#
SKPWCI	  4232	  4234#
SLCNT	   160#
SLEV	    41#	    42
SLOR	   426%	   594%	  2501	  2657	  2687	  2696	  2705	  2740	  2807	  2831	  2862	  2978
SLOR1	   596#	   606
SLOR2	   600	   602#
SLOR3	   604	   607#
SLOTNO	   132%	  4872%
SLOWC	   132%	   142%	  2904	  2959	  3052
SNDBB0	  4380#	  4384
SNDBB1	  4386#	  4390
SNDBB2	  4392#	  4396
SNDBBM	  4334	  4377#
TRACE COLLECTOR    NAD-1.1     2-jul-86 14:01
Symbol cross reference

SNDMSG	  2261#
SPACE	   426%	   562%	   892
SPACE1	   566	   568#
SPEC0	  2309	  2312#
SPEC1	  2314#	  2320
SPEC2	  2317	  2319#
SPEC3	  2315	  2321#
SPEC4	  2306	  2323#
SPECL	  2307	  2326#
SREV	    38#	    39
SSCLK.	   221%	   260%
START	   685%	   773	   912	  3305%
STARTS	  3094#
STPMSG	  2277#	  2739
STRMSG	  3117#	  3512	  3513	  3514
STRTLO	  3520#	  3524
STRTR0	  3876#	  3879
STRTR1	  3877	  3880#
STRTRA	  3869#	  3874
SUDIA.	   221%	   261%
SVSPY.	   266#
SWIMSG	  3108#	  3632	  3635
SWINR1	  3729	  3732#
SWISTR	  3120#
SYS	   217%	   229%	   864	   868	   885	   916	   920	   924
TBLONT	  3198#	  3590	  3598	  3661	  3668	  3821	  3828	  3830	  4000	  4011	  4014	  4354	  4362	  4364
	  4430	  4443	  4651
TEMPER	   132%	   144%
TENMIN	  1194	  1299	  1312#
TENOUR	  1187	  1310#
TENSEC	  1205	  1314#
TFREZ.	   218%	   239%
THAW.	   218%	   238%
THAWS.	   221%	   257%
THISID	  3084#
TIISC.	   220%	   279%
TIISI.	   223%	   280%
TIIX	  2292#
TIME1	  1156	  1180#
TIMMSG	  3101#	  4516	  4519
TIMOUT	  1465%	  1487%
TIMZON	  1177	  1315	  3065%	  3067%
TISIS	  2117%	  2775	  3070%
TLIST	  1475#	  1487	  1490	  1493	  1494	  1495	  1496	  1497	  1498	  1504	  1506	  1508	  1512	  1513
	  1514	  1515	  1516	  1517	  1522	  1524	  1526	  1527	  1528	  1529	  1530	  1536	  1538	  1540
	  1541	  1542	  1543	  1544	  1549	  1550	  1551
TMSTMP	  1055%	  1176%
TO9	  1473#	  1485	  1492	  1531
TOGET	  1465%	  1534%
TOGET1	  1535#	  1539
TOISIS	   136%	  2149%	  2495	  2615	  2630	  2635	  2753	  2776	  2922	  4413	  4415	  4745	  4861
TONOW	  1465%	  1520%
TONOW1	  1521#	  1525
TRACE COLLECTOR    NAD-1.1     2-jul-86 14:01
Symbol cross reference

TOPUT	  1465%	  1502%	  1594%	  1642	  1891	  2119%	  2933	  2937	  2992	  3029
TORET	  1465%	  1485%	  1594%	  1893	  1911	  2119%	  3005	  3036
TOSS	  2563	  2566	  2567	  2571	  2572	  2573	  2574	  2576	  2578	  2579	  2582	  2584	  2586	  2587
	  2594#	  2623	  2758
TPT1	  1503#	  1507
TPT2	  1505	  1508#
TPT3	  1509	  1512#
TRAMSG	  3151#	  3870	  3873
TRBOFF	   771#	   798
TRCOFF	   772#	   829
TSTDB.	   217%	   236%
TWOUNS	  3107#	  3534	  3537
U2AUXB	  3811	  4126#
U2HDAT	  4132	  4291#
U2HISM	  4160#	  4294
U2HOST	  3135#	  4130	  4178	  4191	  4194	  4249	  4253
U2NAMS	  4145#	  4150
U2OCM	  3368	  3390#
UCORE.	   262#
UMTOSS	  2517
US2ACT	  3134#	  3809	  4138	  4157	  4286
US2ISM	  4182#	  4203
US2OPB	  3133#	  4108	  4143	  4162	  4190	  4310
USERON	  3131#	  3771	  3773
USNFLG	  3531	  3541#
USR2B5	  4128	  4141#
USR2IN	  4120	  4200#
USR2ON	  3132#	  4102	  4105	  4189
USRBUF	  3099#	  3421	  3428	  3431	  3435	  3442	  3469	  3476	  3480	  3484	  3499	  3551	  3556	  3560
	  3564	  3654	  3692	  3696	  3702	  3727
USRINP	  3414#
USRISM	  3412	  3802#
USRMSG	  3329	  3406#
USRNID	  3093#	  4452	  4468	  4477	  4492
USRNM1	  3090#	  3492	  3543	  3579	  3582	  3700	  3714	  3725	  4450	  4454	  4460
USRNM2	  3091#	  3546	  3581	  3584	  3705	  3710	  4459	  4463	  4476	  4481
USROLD	  3092#	  3580	  4467	  4472
USROPB	  3144#	  3775	  3832	  3904	  3929	  3946	  4371	  4504
USRTBL	  3273#	  3328
VALIN5	  3095#
VERNO	   132%	   146%
VERREV	   136%	  4873%
VERSIO	  4874
VOLTS	   132%	   145%
W365	  1105	  1266	  1321#
W366	  1099	  1101	  1260	  1262	  1322#
W370TB	  3280#	  3913
WAITZA	  2133#	  2194	  2845	  2980
WCD	  1596%	  1829%
WCDZ	  1830	  1847#
WCI	  1596%	  1685%	  1814	  2120%	  2318	  2319	  2354	  2356	  2372	  2375	  2406	  2458	  2527	  2871
	  2873	  3436	  3451	  3461	  3521	  3535	  3569	  3608	  3616	  3622	  3624	  3633	  3646	  3674
	  3721	  3738	  3749	  3757	  3760	  3762	  3764	  3780	  3785	  3836	  3841	  3848	  3856	  3862
TRACE COLLECTOR    NAD-1.1     2-jul-86 14:01
Symbol cross reference

	  3864	  3871	  3907	  3933	  3938	  3950	  3965	  3970	  3972	  4053	  4069	  4075	  4077	  4079	  4083
	  4089	  4112	  4117	  4147	  4152	  4168	  4196	  4233	  4241	  4243	  4247	  4257	  4313	  4319
	  4381	  4387	  4393	  4437	  4508	  4517	  4524	  4527	  4529	  4532	  4535	  4537	  4540	  4543
	  4545	  4548	  4551	  4553	  4555	  4557	  4662
WCI1	  1686	  1690#
WCICRA	  1687#
WCIFRS	  1691	  1718#
WCINXB	  1697	  1702#
WCINXC	  1704	  1708#
WRE	  1705	  1725	  1737#
WRI370	  3912	  3983#
WRIPRM	  3465	  3539	  3650	  3678	  3686	  3753	  3758#
WRITIM	  4373	  4513#
WRITO3	  4087#	  4092
WRITU2	  4317#	  4322
WRIU2	  4224#	  4236
WRIU2H	  4255#	  4260
WRIUN	  3434#	  3439
WRMTBL	  3287#	  3883	  4122	  4134
WRTCNT	  3081#
WTZA	  2155#	  2612	  2621	  2846	  2925	  2981
WWVBT	   147#
XLIM	  2583	  2710#
XLIM1	  2714	  2716#
XLIMIT	  2140#	  2494	  2716	  2756	  2805
XMEMRY	  4815	  4817#	  4825	  4949
XMTLIM	  2285#
YBMSG	  2272#
ZA	  2585	  2620#
ZA1	  2622	  2624#
ZAP	  2556	  2557	  2600#	  2625	  2765
ZAP370	  4407	  4409	  4419#
ZAPACK	  2287#
ZAPMSG	  2259#	  2500	  2841	  2976
ZAPPRT	  2118%	  2976%
ZAPREA	  2290#
ZEROLD	  4421	  4465#
ZEROSW	  4423	  4474#
ZOUTUN	  4445	  4448#
ZR	  2588	  2763#
.	   428	   687	   751	   869	   917	   956	  1053	  1359	  1466	  1470	  1553	  1593	  1702	  1724
	  1918	  1947	  2122	  2213	  2214	  3070	  3170	  3198	  3209	  3305	  3310	  3324	  3330	  3337
	  3364	  3390	  3398	  3406	  3414	  3427	  3434	  3449	  3458	  3467	  3495	  3517	  3528	  3533
	  3541	  3549	  3589	  3596	  3606	  3614	  3625	  3631	  3642	  3644	  3652	  3660	  3666	  3672
	  3680	  3688	  3717	  3719	  3734	  3736	  3745	  3747	  3755	  3758	  3769	  3778	  3792	  3802
	  3805	  3820	  3826	  3834	  3846	  3854	  3869	  3894	  3902	  3905	  3923	  3931	  3945	  3948
	  3961	  3963	  3975	  3979	  3983	  3992	  3999	  4006	  4018	  4035	  4047	  4051	  4059	  4065
	  4067	  4085	  4087	  4101	  4110	  4126	  4141	  4145	  4160	  4166	  4182	  4200	  4207	  4215
	  4224	  4244	  4255	  4264	  4274	  4283	  4291	  4298	  4306	  4315	  4317	  4332	  4351	  4353
	  4360	  4404	  4419	  4429	  4435	  4441	  4448	  4465	  4474	  4483	  4506	  4513	  4515	  4567
	  4619	  4622	  4629	  4633	  4641	  4792	  4797	  4806	  4810	  4963	  4964   ]]^p