



                 **********FOR INTERNAL REFERENCE ONLY**********
                 **********NOT FOR PUBLIC DISTRIBUTION**********
                 ****TYMNET TRAINING AND EDUCATION DEPARTMENT***
                              DEE SMITH, INSTRUCTOR












                             NETWORK TROUBLESHOOTING
                                   CLASS MANUAL






                                   MAY 30, 1984
                                                                 Page 1
   TABLE OF CONTENTS


                                TABLE OF CONTENTS


     SECTION TITLE                                           PAGE
     ------- -----                                           ----
     1.0 INTRODUCTION . . . . . . . . . . . . . . . . . . . . 1-1
     1.1 ISIS CONCEPTS  . . . . . . . . . . . . . . . . . . . 1-2
     1.1.1 INTRODUCTION . . . . . . . . . . . . . . . . . . . 1-2
     1.1.2 KERNEL . . . . . . . . . . . . . . . . . . . . . . 1-2
     1.1.3 DISPATCHER . . . . . . . . . . . . . . . . . . . . 1-3
     1.1.3.1 DISPATCHER RINGS . . . . . . . . . . . . . . . . 1-3
     1.1.3.2 MESSAGE CONVENTION . . . . . . . . . . . . . . . 1-4
     1.2 ISIS DDT . . . . . . . . . . . . . . . . . . . . . . 1-6
     1.3 NAD-DDT  . . . . . . . . . . . . . . . . . . . . . . 1-6
     1.3.1 NAD BASICS . . . . . . . . . . . . . . . . . . . . 1-9
     1.3.2 NAD AUXILIARY CIRCUIT  . . . . . . . . . . . . . .1-10
     1.3.3 NAD LOCAL IMAGE  . . . . . . . . . . . . . . . . .1-10
     1.3.4 NAD-DDT COMMANDS . . . . . . . . . . . . . . . . .1-12
     1.3.5 LAB  . . . . . . . . . . . . . . . . . . . . . . .1-13
     1.4 PROBE  . . . . . . . . . . . . . . . . . . . . . . .1-14
     1.4.1 INTRODUCTION . . . . . . . . . . . . . . . . . . .1-14
     1.4.2 COMMANDS . . . . . . . . . . . . . . . . . . . . .1-15
     1.4.3 ERROR LOG MESSAGES . . . . . . . . . . . . . . . .1-15
     1.4.4 EXERCISE . . . . . . . . . . . . . . . . . . . . .1-15
     1.5 XRAY . . . . . . . . . . . . . . . . . . . . . . . .1-17
     1.5.1 DEFINITION . . . . . . . . . . . . . . . . . . . .1-17
     1.5.2 ACCESS METHODS . . . . . . . . . . . . . . . . . .1-17
     1.5.3 COMMAND NOTES  . . . . . . . . . . . . . . . . . .1-18
     
     2.0 BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY  . . 2-1
     2.1 TERMINAL/TYMSAT LOCAL TOPOLOGY . . . . . . . . . . . 2-2
     2.2 NODE/NETWORK LOCAL TOPOLOGY  . . . . . . . . . . . . 2-2
     2.2.1 PROBE  . . . . . . . . . . . . . . . . . . . . . . 2-2
     2.2.2 XRAY ND COMMAND  . . . . . . . . . . . . . . . . . 2-4
     2.3 LINK LOCAL TOPOLOGY  . . . . . . . . . . . . . . . . 2-5
     2.3.1 INTRODUCTION TO LINK LEVEL . . . . . . . . . . . . 2-6
     2.3.2 XRAY CRYPTO LOG  . . . . . . . . . . . . . . . . . 2-7
     2.3.3 INTRODUCTION TO WINDOWSIZE . . . . . . . . . . . . 2-7
     2.3.4 XRAY KD COMMAND  . . . . . . . . . . . . . . . . . 2-8
     2.4 VIRTUAL CIRCUIT TOPOLOGY . . . . . . . . . . . . . . 2-9
     2.4.1 LOGIN PROCESS  . . . . . . . . . . . . . . . . . . 2-9
     2.4.2 VIRTUAL CIRCUIT TRACING  . . . . . . . . . . . . .2-10
     2.4.2.1 ORIGIN SOLO TYMSAT(CONSAT) . . . . . . . . . . .2-11
     2.4.2.2 ORIGIN ISIS HOST SLOT  . . . . . . . . . . . . .2-13
     2.4.2.3 ORIGIN ISIS CONSAT . . . . . . . . . . . . . . .2-13
     2.4.2.4 HYBRID CIRCUITS  . . . . . . . . . . . . . . . .2-15
     2.4.3 XRAY CHANNEL TRACE . . . . . . . . . . . . . . . .2-16
     2.4.3.1 XRAY CT COMMAND  . . . . . . . . . . . . . . . .2-17
     2.4.3.2 ISIS SLOT LOGIN/CHANNEL TRACE  . . . . . . . . .2-18
     2.4.4 PERMANENT VIRTUAL CIRCUITS . . . . . . . . . . . .2-21
     2.4.5 VIRTUAL CIRCUIT SUMMARY  . . . . . . . . . . . . .2-22
     2.5 NODE/LINK TOPOLOGY . . . . . . . . . . . . . . . . .2-23
     2.5.1 PERFORMANCE  . . . . . . . . . . . . . . . . . . .2-23
     2.5.2 DELAY MEASUREMENTS WITH XRAY . . . . . . . . . . .2-25
                                                                 Page 2
   TABLE OF CONTENTS


     2.5.2.1 XRAY NS COMMANDS . . . . . . . . . . . . . . . .2-25
     2.5.2.2 XRAY KS COMMAND  . . . . . . . . . . . . . . . .2-26
     2.5.2.3 XRAY DB, DD, AND DE COMMANDS . . . . . . . . . .2-27
     2.5.2.4 XRAY PM COMMAND  . . . . . . . . . . . . . . . .2-28
     2.5.2.5 XRAY TC AND TD COMMANDS. . . . . . . . . . . . .2-29
     
     3.0 TYMNET INTERNAL DATA PROTOCOL  . . . . . . . . . . . 3-1
     3.1 PHYSICAL RECORD  . . . . . . . . . . . . . . . . . . 3-1
     3.2 PACKET ASSEMBLY-DISASSEMBLY  . . . . . . . . . . . . 3-3
     3.2.1 LINK ERROR DETERMINATION . . . . . . . . . . . . . 3-3
     3.3 CHANNEL AND BUFFER STRUCTURE . . . . . . . . . . . . 3-5
     3.4 THROUGHPUT CLASS AND BACKPRESSURE. . . . . . . . . . 3-7
     
     4.0 ENGINE CRASH ANALYSIS  . . . . . . . . . . . . . . . 4-1
     4.1 ISIS AND NODE CODE CRASH ANALYSIS  . . . . . . . . . 4-1
     4.1.1 CRASH ID'S . . . . . . . . . . . . . . . . . . . . 4-2
     4.1.2 DUMP ANALYSIS - ENGDMP . . . . . . . . . . . . . . 4-4
     4.1.3 DUMP ANALYSIS - T2SOLO . . . . . . . . . . . . . . 4-6
     4.2 SLOT CRASH ANALYSIS  . . . . . . . . . . . . . . . . 4-9
     4.2.1 SLOT CRASH TABLE . . . . . . . . . . . . . . . . .4-10
     4.2.2 CRASH CODES  . . . . . . . . . . . . . . . . . . .4-11
     4.2.3 CRASH TABLE WITHOUT NIB FILE . . . . . . . . . . .4-12
     
     5.0 APPENDICES . . . . . . . . . . . . . . . . . . . . . 5-1
     5.1 ISIS MESSAGES  . . . . . . . . . . . . . . . . . . . 5-2
     5.2 CTA LAYOUT . . . . . . . . . . . . . . . . . . . . . 5-8
     5.3 SEGMENT 15 CORE LAYOUT . . . . . . . . . . . . . . .5-12
     5.4 DDT COMMANDS . . . . . . . . . . . . . . . . . . . .5-14
     5.5 NAD/NAD-DDT COMMANDS . . . . . . . . . . . . . . . .5-16
     5.6 EXAMPLE PROBE ERROR LOG  . . . . . . . . . . . . . .5-18
     5.7 TYMNET-II MESSAGE FORMAT . . . . . . . . . . . . . .5-23
     5.8 GLOSSARY . . . . . . . . . . . . . . . . . . . . . .5-34
     5.9 TYMNET CONTROL CHARACTERS AND CHARACTER PAIRS  . . .5-43
     5.10 HEX TO ASCII CONVERSION CHART . . . . . . . . . . .5-44
     5.11 ISIS HOST MANAGEMENT  . . . . . . . . . . . . . . .5-45












                                CHAPTER 1

                               INTRODUCTION






          The Network Troubleshooting class  approaches  the  TYMNET-II
     network  from  a  different perspective.  Rather than defining the
     elements of the network in theory, the emphasis  is  on  examining
     the  components  as  implemented.   The  examination  tools  vary,
     depending upon the component.  Some  are  refined,  user  friendly
     tools.  On others, more complex tools, only a sub-set of the total
     functionality will be taught.  Some tools have been  designed  for
     internodal   network   troubleshooting,  and  others  as  software
     debugging tools.  In this class you  will  learn  which  tool  can
     provide  the  most  useful  information  considering  the  problem
     description and the elements involved.

          In order  to  attend  this  class  you  must  have  extensive
     experience  or  classroom  knowledge  of either the Engine and the
     TYMNET Network (via the Engine hardware training  track)  or  ISIS
     and  the  TYMNET  Network (via either the ISIS programming or slot
     interface classes).  The elements of the TYMNET Network  will  not
     be  described  in this class, since it is a common element in both
     of the pre-requisite tracks.

          The first two days of the course are spent  in  review.   The
     first day we will discuss ISIS concepts, and the second day review
     the basics of TYMNET circuit technology and the two  major  tools,
     PROBE and XRAY.
   INTRODUCTION                                                Page 1-2
   ISIS


     1.1  ISIS

     1.1.1  INTRODUCTION

          ISIS (Internally Switched Interface System)  was  defined  in
     order  to  develop,  debug,  and  deploy  new interfaces on TYMNET
     network nodes (using the Engine) while protecting the  nodes  from
     interface  faults.   ISIS  is a set of rules on how the interfaces
     are to be constructed and how they are to  communicate  with  each
     other.  ISIS is not a piece of code, but a convention.

          ISIS divides the Engine into partitions, or SLOTS.  Slot 0 in
     an  Engine  communicating  with the Supervisor is expected to have
     special properties and abilities inherent to processing node code.
     These  include  the  routing  of  circuits within the node and the
     collection  of  diagnostic  and  accounting  information   to   be
     transmitted  to  the  Supervisor.   All other slots under ISIS are
     treated equally and may be interchanged at will.

          An example  of  a  code  program  that  runs  in  the  Engine
     implementing  a one machine ISIS node is called ISIS-II (code name
     I2IS).  This program embodies the ISIS functions  of  control  and
     intranodal communication prescribed by the ISIS convention.  These
     primary functions are the Kernel and the Dispatcher.



     1.1.2  KERNEL

          The Kernel is  the  control  center  of  ISIS.   Its  primary
     responsibilities  are  the  handling  of  the  Engine CPU hardware
     interrupts (the Engine synchronous and asynchronous I/O)  and  the
     scheduling  of  work processes executed in that Engine.  Interrupt
     handling has absolute priority,  but  during  intervals  where  no
     interrupts  are  active, other processes are active.  These may be
     Kernel, slot, or (in a one-machine node) Dispatcher processes.

          The details on the handling of the  device  drivers  and  the
     interrupts  can be found in the ISIS-II Reference Manual.  For our
     purposes this is a transparent process, as we will not look beyond
     the slot for an indication of what is transferred.  The sharing of
     the device  code  inherent  in  ISIS  is  a  protection  mechanism
     necessary  for  nodal  integrity,  even  though  it  may  be  less
     efficient than letting each slot handle its own devices.

          For additional details on the types of processes (Foreground,
     Background,  and DDT) scheduled by the Kernel refer to the ISIS-II
     Reference Manual.  For this class the most  mentioned  process  is
     the  DDT  (Dynamic Debugging Tool) routines built into the ISIS-II
     program for examination and interaction with the  Kernel  and  the
     slots  for  monitoring  and  debugging.  This tool is discussed in
     more detail later.
   INTRODUCTION                                                Page 1-3
   ISIS


     1.1.3  DISPATCHER

          The Dispatcher is the communications controller of the TYMNET
     network  node.   The  data  being  controlled  is within the node,
     directed either to a slot process or a Dispatcher  process  within
     the  node.   Depending  on  the implementation program it may have
     subsidiary functions for the sake of consolidation.  For  example,
     in  a  one  machine  ISIS-II  node,  the  Dispatcher  gathers  all
     accounting statistics.

          Each slot interface has a set of descriptors which it uses to
     talk  to  the  Dispatcher, incorporating a standard message format
     for the exchange.  The descriptors are contained in the slot's CTA
     (Control Table Area, see Appendix II).  ISIS has defined that each
     slot have a CTA and that it be located in the MAC  (Memory  Access
     Controller)  segment 14(decimal) for that slot.  Once loaded, this
     segment is protected by the MAC from inadvertant  modification  by
     the  slot  processes.   The  dispatcher shares segment 14 with the
     slot to communicate with  the  slot  and  maintain  ongoing  event
     records.



     1.1.3.1  DISPATCHER RINGS 

          Incorporated in the set of rules called ISIS, the  Dispatcher
     communication  must  have  certain properties.  The Dispatcher and
     slot  processes  must  be  able  to  operate   independently   and
     concurrently.  Also, the two directions must be separate.  To this
     end, a specific buffering scheme must be adhered to.

          This buffer is a ring buffer which one process fills and  the
     other  empties.   ISIS does not place any restrictions on the size
     of the buffer, nor does it say the buffers for the two  directions
     should  be  equal.   The CTA entries indicating the sizes of these
     ring buffers are OMAXI  (slot  output)  and  IMAXI  (slot  input).
     Usually  a code program (called a library package) generic to this
     transfer is used to actually manipulate these ring  buffers.   The
     corresponding   labels   used   in  this  package  for  the  above
     descriptors are ORSIZE and IRSIZE.

          The CTA entries ORINGP and IRINGP tell the  Dispatcher  where
     in  memory the beginning of the ring buffers and their descriptors
     reside.  The corresponding slot labels are ORING and  IRING.   The
     first  two  halfwords  at this location are indicators of where in
     the ring the fill or empty pointers are.  They are called:
   INTRODUCTION                                                Page 1-4
   ISIS


     1.  NFMI - Next Fill Message Index, the byte index into  the  ring
         area  just  beyond  the  point  the last character was placed,
         indicating the placement of the next message.

     2.  CEI - Current Empty Index, the byte index into the  ring  area
         just  beyond  the  point  where the last character was pulled,
         indicating the place the next  message  to  be  pulled  should
         reside.

     The ring storage area  follows  the  descriptors,  continuing  for
     ORSIZE  or  IRSIZE  bytes.  Therefore, the size of the entire area
     (descriptors plus ring storage) is ORSIZE+4 or IRSIZE+4 bytes.
                           ORING
            __________________________________
           |      |      |                    |\
           | NFMI | CEI  |                    | \
           |______|______|____________________|  \
           |                                  |   \
           |                                  |    \
           |__________________________________|     \
           |                .                 |      \
           |                .                 |       \
           |                .                 |        \
           |                .                 |        / ORSIZE+4
           |                .                 |       /
           |__________________________________|      /
           |                                  |     /
           |                                  |    /
           |__________________________________|   /
           |                                  |  /
           |                                  | /
           |__________________________________|/
     



     1.1.3.2  MESSAGE CONVENTION

          The format of the Dispatcher message must be uniform for  all
     interfaces.   Therefore,  a  message  format  is  defined by ISIS.
     First,  messages  must  always  begin   on   fullword   boundaries
     (locations  ending in 0, 4, 8, and C).  This convention simplifies
     the handling of potential message wrap problems.   Secondly,  each
     message  has  a  three  byte header:  two bytes of Dispatcher port
     address (0000 reserved for slot/Dispatcher communication) and  one
     byte  of  message  type.  This port address is called RPORT and is
     the same for both directions of the exchange.

                       --------.--------.--------.--------
                       |     RPORT      |MSG TYPE|        |
                       --------.--------.--------.--------
   INTRODUCTION                                                Page 1-5
   ISIS


          With the exception of the needle, for each message  type  the
     message  length is fixed.  In the case of the needle (message type
     00), the fourth byte in the message contains  the  length  of  the
     message  (minus  the  header).   This  convention  simplifies  the
     process of passing messages, since only the header need be  looked
     at  to  indicate  how  many characters are being transferred.  The
     Dispatcher does not need to look  for  the  beginning  of  another
     message by sampling each character passed.

          Appendix I of this manual is a list of all the  ISIS  message
     types and a short example of a ring.  For detailed explanations of
     the message types, refer to the ISIS-II Reference Manual.

          At this time in the class there will be  an  exercise  handed
     out  consisting  of  examples of rings to be broken down and their
     messages defined.
   INTRODUCTION                                                Page 1-6
   ISIS DDT


     1.2  ISIS DDT

          ISIS DDT  is  a  subset  of  the  Kernel  routines  used  for
     debugging,  etc.   You  access  it by attaching either through the
     network  (remotely)  or  through  the  multifunction  card  RS232C
     interface  to  the  Kernel.   We will discuss DDT as if you were a
     remote user.  The login is directed at the host  number  given  to
     the  Kernel  (the  TYMfile  parameter HST0) and must use a network
     username defined in that node's Good-Guy  list.   Also,  for  most
     purposes,  this username will not be assigned to any one slot, but
     available to all slots.  Upon connection, a slot  number  will  be
     requested.

          The logon we will use for this class is:

                     DNSONLY:<kernel host #>;in-ddt<cr>

     At the slot   prompt, type a one digit indication of the slot  you
     wish to access.  There may be only one user at a time in the slot.
     If the requested slot is already in use, your network circuit will
     be zapped.  There will not be an error message indicating this.

          If you are interested in the entire capabilities of  the  DDT
     prograhe  ISIS-II  Reference  Manual  lists  all the commands
     available with explanations.  There are many specialized  commands
     used  in  the development of the Engine hardware and software that
     you will not  have  need  for.   If  you  are  in  doubt,  do  not
     experiment.   The  DDT  routines  are  especially  susceptible  to
     typographical and unintentional user errors.  The recovery methods
     may  not be clearly defined, and you may need to resort to halting
     and re-executing or reloading the interface.

          Appendix IV has  a  short  list  of  the  direct  access  DDT
     commands  you  will find useful.  Unless specified, these commands
     do not  require  a  carriage  return  to  terminate.   A  carriage
     return/linefeed  will be supplied by DDT in acknowledgement of the
     command.  A mistyped command may result in  an  error  message  or
     only a <cr>/<lf> with no response from DDT.  The backslash command
     may be used to recover.

          At this time a short demonstration of some of the commands is
     given.



     1.3  NAD-DDT

          NAD (Node Assembler Debugger) is  the  PDP  program  used  to
     assemble  the  Engine  node programs and debug those programs.  In
     this class we will learn the debugging portions, and in particular
     those designed to interact with the ISIS DDT routines.
   INTRODUCTION                                                Page 1-7
   NAD-DDT


          NAD runs in a TYMSHARE PDP host.  You will  find  it  in  all
     hosts  used  for  Engine  code.  It is the tool used to access the
     symbol table resident in the binary file created by NAD  assembler
     to  be loaded into an Engine.  This file is called a NIB file (NAD
     Image Binary).  Using NAD, Engine locations can be referred to  by
     their symbol (or label) name when in DDT.  Following is an example
     of both direct DDT access and NAD-DDT access to read the  slot  to
     dispatcher   out  ring  buffer  for  an  ISIS  Async  TYMCOM  slot
     interface:

     With direct DDT login
     
     *R 0E006C,4<cr>         :read CTA ORINGP for 4 bytes
     E006C  0005  0000       :DDT displays 4 bytes 
     *R 0E0086,2<cr>         :read CTA OMAXI for 2 bytes
     E0086  07FC             :DDT display value of OMAXI
     *R 50000,800<cr>        :read engine memory location 50000 
                             :for value of OMAXI plus 4
     50000  0780  0780  E3B2  8D8A  4232  4531  A8B4  8D8A
     50010  .......
       .
       .
     507F0  .......
     
     With NAD-DDT login
     
     *:R ORING,ORSIZE+4<cr>  :read starting at label ORING for 
                             :value of label ORSIZE plus 4
     50000  0780  0780  E3B2  8D8A  4232  4531  A8B4  8D8A
     50010  .......
       .
       .
     507F0  .......
     

          You can see how NAD simplifies the process.  To do this,  the
     symbol  table  is  pulled into NAD (called the local memory image)
     and a circuit is built from NAD  (an  auxiliary  circuit)  to  the
     Engine  Kernel host running the DDT process.  This is a Supervisor
     built circuit like any other network circuit.

          There are several categories of commands  in  NAD:   commands
     directed at NAD to prepare the local image (including all assembly
     commands) and create the NIB file, those  directed  at  the  local
     image only, commands indicating a relay mode down the aux circuit,
     and a special set of NAD-DDT commands used when  the  aux  circuit
     destination  is ISIS DDT.  Appendix V is a partial list of NAD and
     NAD-DDT commands.  To learn more about the total functionality  of
     NAD,  reference  the  ISIS-II  Reference  Manual and the Tools and
     Utilities Manual.
   INTRODUCTION                                                Page 1-8
   NAD-DDT


                          DIAGRAM OF PDP NAD TO ISIS DDT
     
     ______________                    _______________
     |  S    ______|                  |               |
     |  Y   |      | AUX CIRCUIT      | NETWORK NODE  |
     |  S   | NAD  |__________________|   ISIS DDT    |
     |  T   |______|                  |_______________|
     |  E        \ |             /|
     |  M  70     \|___________ /_|
     |_____________|     |     ___| USER TERMINAL
                       NORMAL
                       NETWORK
                       LOGON
   INTRODUCTION                                                Page 1-9
   NAD-DDT


     1.3.1  NAD BASICS

          To access the NAD program, log in through the network as  you
     would  normally  to  a  TYMSHARE  PDP host.  Then "run" the system
     version of NAD:

                                   -R NAD<cr>

     A NAD version number will be returned to you and your cursor  will
     be  in  the  left-most  position.  There is no command prompt with
     NAD, so procede with caution.  As with DDT,  NAD  is  particularly
     susceptible to typographical mistakes.  Especially, do not use the
     <ESC> indiscriminately.  The <ESC> typed once will abort  the  NAD
     command  in  process,  but  typed twice will cause a return to the
     executive mode.  If this mistake is made, the EXEC command REEnter
     will return NAD in its previous state.  Example:

                    -REE<cr>      :executive command REENTER

     This must be the first executive command processed after your  NAD
     exit to qualify.  Otherwise, start all over again with NAD.

          The abort output command is  <ESC>  typed  once.   The  abort
     input  command  is ?.  The ^A can be used as a backspace character
     back to but not including a non-alphameric character.  The ^Q will
     delete a word back to a non-alphameric character.  In general, the
     ?  command is most commonly used  to  recover  from  typographical
     errors.   The  ?  command is also used to "reset" NAD, if you find
     yourself in a  frozen  situation.   The  NAD  response  to  the  ?
     command is a ?.  To exit NAD type %Q (no <cr>).

          NAD expects all symbols to start with an alphabetic character
     (A  through  Z)  and a number to start with a digit (0 through 9).
     Therefore, if refering to a hex digit beginning with A through  F,
     precede it with a 0 indicating it is a digit, not a symbol.

          Also, you may know of a symbol in the slot program, but  when
     referred  to  (instead of the expected output) an error message is
     returned "undefined symbol", or a similar  indication.   NAD  does
     not  have  that  symbol  local at that time.  All the code modules
     have only a subset of their symbols local at all times,  necessary
     in  order  to  use  overlapping  symbols.  To refer to the symbol,
     first use the NAD command LOCALIZE followed by the module name:

                   LO <module name><cr> or LO BUFFER<cr>

     The module name is found near the beginning of each program module
     in the listing.
   INTRODUCTION                                               Page 1-10
   NAD-DDT


     1.3.2  NAD AUXILIARY CIRCUIT

          AC system license is required to build an  auxiliary  circuit
     from  NAD.   Remember  to set this status before entering NAD.  In
     NAD the command requesting the interaction with the Supervisor  to
     build this circuit is ;C.  Upon receiving this command NAD returns
     three spaces.  At this time enter the network username that  would
     be used for direct network access to the ISIS DDT program followed
     by a carriage return.  With auxiliary circuits a password  is  not
     required.  Example:

         ;C   DNSONLY:<kernel host #><cr>
         Working
         Circuit Ready
         node: <your node number>
         host: <your kernel host #>
     
         slot #: _

          DDT is now waiting for a slot number.  Directly connected  to
     DDT,  a  one  digit  number would be entered to indicate the slot.
     DDT strips that ASCII character to its four  low  order  bits  and
     assigns  the  slot.   However, when the circuit is built from NAD,
     with a needle terminal identifier for Aux Circuit, this  stripping
     is  not done.  DDT expects to see the binary representation of the
     slot number requested, or 0000 0010, hex 02 for slot 2, etc.  

          The  NAD  command  for  transfering  binary  data  down   the
     auxiliary  circuit  is  ;R,  followed  by the hexidecimal (default
     radix for NAD) representation of the binary value, terminated by a
     non-hex character (usually <cr> or /).  Example:

                         slot #: ;R02<cr>      :slot 2

          If the slot connect is successful, the DDT * prompt  will  be
     displayed.   If unsuccessful, the network aux circuit is destroyed
     and NAD indicates the circuit  has  been  lost.   After  the  slot
     connect  is complete, either the special NAD-DDT commands are used
     or those commands in NAD indicating relay down the aux circuit  is
     requested.  To log off the aux circuit, type :Z, the equivalent of
     the Z command in direct access DDT.  You will be required to  type
     it twice.



     1.3.3  NAD LOCAL IMAGE

          Other NAD commands prepare NAD  for  the  NIB  file  inquiry.
     These commands identify your NIB file and how you wish to refer to
     that NIB file.  A NIB file can have two components (or only  one):
     a state table (symbols and labels) and the binary machine code.
   INTRODUCTION                                               Page 1-11
   NAD-DDT


          The %F command tells NAD the PDP disc  filename  of  the  NIB
     file.   Depending  upon your system status license, if it does not
     find the file named, it will either create one  (open  file  of  2
     pages)  or  return a ?  indicating error.  NAD will not respond if
     it has successfully located the file.  As with  the  ;C  commands,
     NAD  returns  three spaces to the terminal when the %F is entered.
     Example:

                         %F   (TRAINLAB)TR2016.N03<cr>

          To requestthe symbol table, follow the %F command with the %G
     command.  With NAD (as in DDT) most of the commands do not require
     a termination character.  If one is not shown in the examples,  do
     not  use one.  With the %G command, a carriage return and linefeed
     are returned by NAD when the symbol table has been opened to  your
     NAD  program  for  reference.  If the file you have named does not
     have a symbol table, an error message will be returned "module not
     in file".

          If you require examination of  the  actual  binary  that  was
     loaded  into  the  Engine, it is requested by the ;G command.  The
     correct response from NAD is a list of the segments used  and  the
     lengths of these segments.  These are described by NAD as the Data
     Ranges.  An example of the entire definition and fetch process:
     
        %F   (TRAINLAB)TR2016.N03<cr>
     
        %G
        ;G
     
        Data ranges read:
        0-119B 10000-1472B 30000-30743 40000-404F5 0E0000-0E012D
     
   INTRODUCTION                                               Page 1-12
   NAD-DDT


     1.3.4  NAD-DDT COMMANDS

          Interaction with DDT takes two forms;   commands  interpreted
     by  NAD prior to being sent to DDT, and commands indicating NAD is
     to transfer the command directly to DDT.  The above example  using
     NAD  to  read the ORING is an example of the first type of NAD-DDT
     interaction, the :R command.  Example:

                :R <label or location>,<symbol or byte count>

                                        Or

                                :R ORING,ORSIZE+4


          An example of a NAD  command  not  DDT  related,  but  simply
     indicating  a relay down the aux circuit is the ::  command.  This
     command instructs NAD to direct the characters following down  the
     aux  circuit  up  to  and  including  the  first  space, comma, or
     carriage return character.  The space and comma leave the  command
     open  for  several  expressions  to  be  relayed, and the carriage
     return closes the command in NAD.  For our purposes (relaying  DDT
     commands)  always  use  the  <cr> for two reasons:  it is safer to
     close the NAD command prior to proceeding, and DDT requires a <cr>
     to  terminate  the  command being sent.  For example, use this NAD
     command to send a question mark command to the ISIS DDT.

                                  ::?HOST<cr>

     The results are the same as  accessing  DDT  directly  and  typing
     ?HOST<cr>.
   INTRODUCTION                                               Page 1-13
   NAD-DDT


     1.3.5  LAB

          Given  the  sensitive  nature  of  the  NAD  to  DDT  command
     structure,   practice   with   the   program   is   necessary   to
     understanding.  Try some of the commands listed in Appendix  V  in
     the  lab  with  emphasis  on knowing what is happening as they are
     executed.  Following is a complete example of running NAD, pulling
     in  the  symbol  table  and  binary  file,  building  an auxiliary
     circuit, and doing some NAD-DDT commands.

     -R NAD<cr>
     0100
     %F   (TRAINLAB)TR2016.N03<cr>
     
     %G
     ;G
     
     Data ranges read:
     0-119B 10000-1472B 30000-30743 40000-404F5 0E0000-0E012D
     
     ;C   DNSONLY:683<cr>
     
     Working
     Circuit Ready
     
     node: 2160
     host: 683
     
     slot#:;R03<cr>
     
     *:R IRING,4<cr>
     50800  046A  046A
     *::?HOST<cr>
     
     0 Host 1897d has 64d ports, is answered
     51d ports in use
     *:Z   logging off?   :Z
     
     aux circuit lost
     
     %Q
     
     EXIT
     
     -



     1.4  PROBE

   INTRODUCTION                                               Page 1-14
   PROBE


     1.4.1  INTRODUCTION

          PROBE  is  a  program  that  runs  on  each  TYMNET   network
     Supervisor.   It  is  used to display the information contained in
     the Supervisor Error Log:  status messages about the nodes, hosts,
     lines,  and  links  in the TYMNET network.  It is used to manually
     intervene to bring up nodes or links, or restrict the use of nodes
     or  links  when  affecting the quality of data transmission in the
     network.  PROBE is also used  to  control  the  operation  of  the
     Supervisor it is a resident of.

          While  a  TYMNET  network  may  contain  as  many  as   seven
     Supervisors,  only  one is active (awake) at a time.  The PROBE on
     the active Supervisor monitors  and  alters  the  current  network
     status.   The PROBEs on the inactive (frozen) Supervisors are used
     to access Error Log information gathered while that Supervisor was
     awake.   It also contains remnants of the status of its Supervisor
     when that Supervisor went to sleep.

          All TYMNET Supervisors are assigned a host system  number  in
     the  range  121  through  127,  corresponding to node numbers 2001
     through 2007 and Supervisor numbers 1  through  7.   To  log  into
     PROBE  you  may specify the host number of the Supervisor with the
     colon option or ask for attachment  to  the  actve  Supervisor  by
     placing an * in place of the host number:

             PROBE:122;welcome<cr>  OR
             PROBE:*;welcome<cr>

          A PROBE system name prompt appears, followed by a request for
     the  system password.  A ^Q will abort the logon and return to the
     name request prompt.  Example:

             NAME: train<cr>
             PASSWORD: welcome<cr>

          This username may be either assembled into  the  code  or  be
     resident  on  disk.   There  are  status  levels assigned to these
     names:  no status, status - 20, status -  10,  status  -  01,  and
     status  -  02.  The username can only use the commands assigned to
     its status level.  These commands are not hierarchical.  There  is
     a  sixth  status  level (04, not command related) that ignores the
     timeout limit.  All usernames without status  04  are  subject  to
     being  dropped  on  timeout.   This  is not an inactivity timeout.
     When the time expires, a drop will occur irregardless  of  current
     activity.
   INTRODUCTION                                               Page 1-15
   PROBE


     1.4.2  COMMANDS

          All PROBE commands are typed on one line and terminate with a
     carriage  return.   The PROBE prompt is a :  and all commands must
     be left justified to the prompt.  The  response  to  an  incorrect
     command is ?  followed by a return of the prompt.  If a command is
     issued to a sleeping Supervisor, SLEEPING is displayed  after  the
     command.  If the Supervisor is frozen, SUP FROZEN is displayed.

          There are three control characters known to PROBE:

     1.  ESC - aborts current operation and returns prompt.

     2.  ^Q - deletes line of text and returns prompt.

     3.  ^A - backspace deletes character(s).  This function  does  not
         display on the terminal.

     To logoff PROBE, type EXIT<cr>.  Your circuit  will  be  destroyed
     and returned to Please Log In.

          The PROBE Reference Manual includes explanations of the PROBE
     commands  and their status levels.  This class will introduce many
     of these commands in examining network problems.   Other  commands
     you  will  discover  on  your  own.   But,  the  bulk of the PROBE
     functions will not be of use unless you participate in  a  network
     control capacity.



     1.4.3  ERROR LOG MESSAGES

          Chapter  three  of  the  PROBE  Reference   Manual   contains
     descriptions  of  most Error Log messages.  The newer messages (in
     particular software  node  reports)  may  not  be  listed.   These
     messages  may  be  researched  using the BASELINE software release
     description documents for either the Supervisor, Node Code, or the
     slot interface generating the node report.

          These messages are listed in  the  Reference  Manual  in  two
     different ways:  alphabetically by message name and numerically by
     message number.  In reading the Error Log, you may also  see  some
     Supervisor  interpretation  of  the  node  reports,  giving a more
     useful explanation at a glance.  If you find  a  message  of  this
     nature, research the Supervisor release documents for details.



     1.4.4  EXERCISE

          As  the  course  progresses,   an   expanded   and   detailed
     explanation  of  PROBE  is  provided, in a working situation.  For
     now,  it  would  be  useful  to  practice  and  become  moderately
     comfortable with the login and a few commands.  Try the following:
   INTRODUCTION                                               Page 1-16
   PROBE


     1.  N <node #> - display node statistics

     2.  HOST <host #> - display host statistics

     3.  LOG 15 - display last 15 minutes of Error Log


          In addition, being able to understand how  to  translate  the
     Error  Log messages is helpful.  Practice on Appendix VI, a little
     over one minutes worth of Error Log on the TYMNET  Public  Network
     at 16:04 PDT.
   INTRODUCTION                                               Page 1-17
   XRAY 


     1.5  XRAY 

     1.5.1  DEFINITION

          XRAY is an interactive monitoring and debugging  system  that
     resides in TYMNET-II node code versions 3.07 and higher.  XRAY has
     evolved in response to the need for easily accessible  and  usable
     tools  to  monitor  the  status of nodes in a TYMNET network.  The
     emphasis is to  supply  as  much  information  as  possible  in  a
     convenient, understandable form.

          XRAY provides a  real-time  window  into  a  TYMNET-II  node.
     Through  it, the user can conveniently display information about a
     node's  configuration,  performance,  and  history.    It   is   a
     supplement   (not  a  replacement)  to  other  network  monitoring
     systems, such as PROBE and TMCS.  Used with them, it is a powerful
     tool   for   monitoring   activity,   measuring  performance,  and
     diagnosing problems at both the node and network levels.

          The XRAY User's Guide given to you is the manual for the XRAY
     resident  in  node  code  version  5,  the  most  current released
     version.  You will find it indispensible in understanding how XRAY
     functions  and  what commands are available to you.  This training
     manual is not meant to replace this document.



     1.5.2  ACCESS METHODS

          XRAY resides in all node codes  for  the  TYMNET-II  network,
     both  solo  and  under  ISIS.   In an ISIS node it can be accessed
     directly with a special username or through  DDT  as  an  extended
     process  (?STAT command).  Note:  when you access XRAY remotely by
     a direct username, you  are  still  activating  the  extended  DDT
     program,  the  same  as  typing  ?STAT  while  in  the slot's DDT.
     However, direct  access  does  not  use  the  reserved  DDT  port,
     allowing   for   multiple   XRAY   user's   and  slot  DDT  useage
     simultaneously.

          Besides the  remote  (through  the  network)  access  quickly
     described  above,  you  may  also  access  XRAY  locally  with the
     multifunction card port.  Refer to the XRAY User's Guide, page  2,
     for  details on the differences in local access and remote.  Also,
     there is a short discussion in the differences between a solo XRAY
     and an ISIS XRAY.

          For this class, we will refer to remote ISIS XRAY.  You  will
     be  given  the opportunity to try local access if you request, but
     all exercises and examples will be done via direct remote  access.
     Our login to XRAY in the training network is:

                      XRAY:<kernel host #>;t2 tool<cr>
   INTRODUCTION                                               Page 1-18
   XRAY 


          The XRAY logon displays a banner, including the node  number,
     the  kernel  host  number,  and the time of day.  The XRAY command
     prompt is >.  If there are already the prescribed  maximum  number
     of  XRAY  user's  logged  into this kernel host (controlled by the
     TYMfile parameter NXUBLK), you will receive an error message  "out
     of   XRAY   slots".   This  should  not  happen  in  the  training
     environment since all lab XRAY are set to the maximum 15 users.



     1.5.3  COMMAND NOTES

          While in XRAY, you may cancel any command  with  ^C  command.
     The ^C is also used to abort a command you have mistyped, there is
     no backspace or erase input.  The original banner will be returned
     with  the  command  prompt.   If  you  have  made an error in your
     command, you will either get ??   as  an  error  indication  or  a
     specific  error  message  for  that  command.  To logoff, type ^Z.
     There will not be a logoff message.  The username  you  have  been
     given has the highest priveledge status.

          We will be reviewing the XRAY commands along with  the  other
     utilities  in  the  class  as  they  apply to the situation we are
     discussing.  At this time a short lab would be  useful  to  become
     familiar  with  the  XRAY  logon  and the command structure.  Each
     student may experiment with XRAY,  with  the  User's  Guide  as  a
     reference.   Now  would  be  a  good time to demonstrate the local
     access through  the  multifunction  card,  if  an  Engine  lab  is
     available.












                                CHAPTER 2

             BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY






          In this class we will approach TYMNET network troubleshooting
     in  components.  We will call these components "LOCAL TOPOLOGIES",
     or "NEIGHBORHOODS".  By doing this, the user of the tools sketched
     out  previously  will  see at which points particular tools are of
     benefit and which are not.

          A Local Topology may consist of one  piece  of  hardware,  or
     many.  It may be a physical entity, or a logical group of software
     components that interact in a particular  manner.   The  order  in
     which  this  class examines these Neighborhoods is not to be taken
     as an ordered method for approaching a problem.  They are  ordered
     approximately  by the complexity of each Neighborhood, in order to
     build on previous knowledge at each step.  In the  real  world  of
     problem  solving, each problem encountered will have its own group
     of Local Topologies that require examination and its own order  of
     examination.   What  the  "best"  approach  is for each problem is
     impossible to define.  Each person and each problem  has  its  own
     "best" methods and techniques.
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY             Page 2-2
   TERMINAL/TYMSAT LOCAL TOPOLOGY


     2.1  TERMINAL/TYMSAT LOCAL TOPOLOGY

          A logical place to start would be your own terminal  and  the
     physical interface required for connection to the network.  Figure
     1 is a diagram of the Local  Topology  of  the  terminal  and  the
     Engine  hardware controlled by the TYMSAT when directly connected,
     the  control  component  being  the  RS232C  connection  and  it's
     signals.   This  component  would  be  examined  using  an  RS232C
     breakout box.  The one made by IDS is called a "Blue Box".

                    ___ DTR          DSR ___           _______
        /|         /                        \         |   T   |
       / |        /                          ASC140-20|   Y   |
      /__|=======/                   DCD _____\=======|   M   |
         |       \                           crossover|   S   |
      ___|        \                          / cable  |   A   |
                   \___ RTS          CTS ___/         |___T___|
     ( Terminal )          ( RS-232C )               ( Engine )

     Figure 1.  Initial  RS-232C  Signal  Presentation  as  seen  on  a
     breakout box.



     2.2  NODE/NETWORK LOCAL TOPOLOGY

          Each TYMNET network node exists as an entity  unique  to  the
     Supervisor  and  its  neighbors.  The following tools and commands
     are used:



     2.2.1  PROBE

          The following  PROBE  commands  display  the  basic  Node  to
     Network parameters:

     1.  Node command.

              Using  the  PROBE  Node  command  we  can   observe   the
         following:

         1.  Code version running in the machine.

         2.  Crash count, set to 1 at  initialization  and  incremented
             with each machine crash when restarted.

         3.  Passthroughs remaining in the machine at  least  4  minute
             interval.

         4.  Host numbers for the machine, their intelligence,  product
             ID.  (One of which is the Kernel host.)
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY             Page 2-3
   NODE/NETWORK LOCAL TOPOLOGY


         5.  Neighbor nodes that are up.

         6.  Link speeds to neighbors.

         7.  Window size may be listed.

         8.  Shuts placed on links by Net Control.

         9.  'OV' may be listed, or '2*OV' showing an overloaded link.


              The following  is  an  example  of  the  PROBE  N  (node)
         command:
         :N 2256
         VERSION 10506 TYPE 9 CRASH 2 UP 2001
         AVAILABLE PASSTHROUGHS 20
         HOST STATUS
          694 ANSWERED 0 IIX-N I2IS  :(kernel host)
         1459 ANSWERED 0 IIX-Y XCOM  :(X.25 interface)
         3403 SHUT     0 IIX-Y PBH   :(3270 Polled Bisync Host)
         4119 ANSWERED 0 IIX-Y OTHER :(CMT interface)
         LINK STATUS
         0 2057 9.6 OV
         1 2056 9.6
         :

     2.  Logger

              The  PROBE  Logger  can  be  called   upon   to   display
         error/status   events  from  any  node,  as  reported  to  the
         Supervisor.   The  RNODE  command  restricts  the  display  to
         messages  from  specified node(s) only.  The LOG command calls
         the display (real time).  The argument E after the LOG command
         specifies  the  RNODE selection is to be honored, and only the
         messages  pertaining  to  the  selected  node(s)  are  to   be
         displayed.

              The Logger information  may  also  be  displayed  from  a
         history  buffer.  To do this, after the LOG, preceding the E a
         desired number of minutes  may  be  entered.   Or  the  format
         "ddd:hh:mm"  may  be  used  to  instruct  the  Logger to begin
         display at that specified day (Julian date), hour and minute.

              The following is an example of the PROBE Logger:

         :RNODE 2056 2057
         :LOG 294:23:54E
         294:23:54:02
         294:23:55:03
          NODE REPORT 2056 LINE 4 BAD CHECKSUMS FROM NODE 2031
          OCCURRED 9 TIMES
          NODE REPORT 2056 LINE 4 TOTAL PACKETS RECEIVED AND SENT 449 480
         294:23:56:00
         294:23:57:02
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY             Page 2-4
   NODE/NETWORK LOCAL TOPOLOGY


         294:23:58:02
         294:23:59:00
         295:00:00:00
         CAUGHT UP

              When the "CAUGHT UP" is displayed, the Logger will  begin
         operating  in  real  time.   To  cancel the Logger state, type
         cntrl-Q.  Your PROBE ":" prompt will return.

     3.  SYNPRT

              The PROBE SYNPRT command places a message in  the  Logger
         indicating  the  synchronous  ports  assigned  to  that node's
         internodal communication function.  The status of these  ports
         can  be  verified  as  "up", "down", or "unused".  If "up" the
         neighbor number is identified.  If "down"  the  neighbor  last
         reporting  on  that  port  is identified.  For non-ISIS nodes,
         this port number can  be  directly  related  to  the  physical
         Engine port.  In ISIS nodes, the TYMFILE will show the logical
         to physical correlation.  The PROBE Logger display methods are
         used  to access the SYNPRT message.  Note:  These commands are
         not available through TMCS.

              The following is an example of the PROBE SYNPRT display:

         :SYNPRT 2256
         :RNODE 2256
         :LOG 1E
         163:15:35:15
          SYNC PORT REQUEST FOR NODE 2256
          SYNC PORT, NODE 2256 PORT 0 IS UNUSED
          SYNC PORT, NODE 2256 TO NEIGHBOR 2056 IS UP ON PORT 1
          SYNC PORT, NODE 2256 TO NEIGHBOR 2057 IS UP ON PORT 2
         163:15:36:02




     2.2.2  XRAY ND COMMAND

          The XRAY ND command, used  with  the  PROBE  SYNPRT  command,
     provides  etailed information important in verifying that the node
     is  configured  properly  within  its  local   topology.    (Note:
     Information  obtained  using  PROBE  and XRAY should be reconciled
     with the Isis and Node Code Parameter file - TYM file.)

          The XRAY ND command provides:

     1.  Node number, kernel host, and TYMNET-II code version.

     2.  Physical line number, type of line, neighbor for that line.
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY             Page 2-5
   NODE/NETWORK LOCAL TOPOLOGY


     3.  Link number, type of link, window size,  line  speed,  and  an
         error rate guage.

     4.  Start-up times.

     5.  Crash information.


          The following is an example of the XRAY ND command:

     >ND
     
     NODE  KHOST  VERSION   H-WARE   S-WARE  SUPR   MEMORY
     2256  0694  00010506   RESTART  RESTART  01    0512KB
     
     PORTS  PASSTHRUS  ALNK  TLNK  XLNK   LINES  SYNC  SIO
     0000    0000      0001  0002  0000    0003  0003  0000
     
     NODE FIRST CAME UP AT 031:18:04:40    NODE LAST CAME UP AT 032:04:19:29
     
     LAST CRASH:     TIME       CC   TYPE  PSW   ADDRESS
                 032:04:18:59  0001  0007  67FA  000134C8
     
     **LINE**  ***--LINK--***    LINE    LINK  LINE   LINK  LINE          LINE
     NO. TYPE  NEIG  NO. TYPE    STATUS  WSIZ  SPEED  CRQS  TIME ATT/DET  ERRATE
     00  SYNC                    UNUSED
     01  SYNC  2056  01  TII     UP      0008   9.6   0004  038:01:26:08
     02  SYNC                    UNUSED
     
     TIILNK NEIGHBORS DOWN - 2057
     
     **X-RAY** NODE: 2256  HOST: 0694  TIME: 038:17:33:37



     2.3  LINK LOCAL TOPOLOGY

          What is the difference between a Line and a  Link?   What  is
     the  difference  between  a  Sync Line and an SIO Line?  If a Line
     goes down on a Multiple Line Link, will the  virtual  circuits  on
     that  Line  be  dropped?  These questions will be answered in this
     section.  First a diagram:

        __________________                            _________________
       |           BB2256 |                          | BB2056          |
       |      ____________|                          |___________      |
       |     :            |                          |           :     |
       |     :  link 01   |       <- 9.6 kb ->       |  link 12  :     |
       |     :  line 01   |==========================|  line 13  :     |
       |     :  tiilnk    |       <-- WS 8 -->       |   xlink   :     |
       |     :____________|                          |___________:     |
       |__________________|                          |_________________|

   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY             Page 2-6
   LINK LOCAL TOPOLOGY


          Figure 2.  Node Line and Link  configuration,  verified  from
     both nodes.



     2.3.1  INTRODUCTION TO LINK LEVEL

          In Tymnet-I technology, a physical Line meant the same  thing
     as  a  Link.   In Tymnet-II technology, a physical Line is not the
     same thing as a Link.  A Link is a logical entity,  which  may  be
     composed  of  one or more than one physical Line.  A Multiple Line
     Link is a logical entity composed of at least two physical  Lines.
     A Multiple Line Link may be sync, SIO, or both.

          Link speed is calculated based on the sum  of  the  composite
     Line  speeds.   For example, two 9.6 sync Lines on a Link make the
     Link speed 19.2kbps.

          Both  sync  Lines  and  SIO  Lines  operate  on   synchronous
     principles.   The  SIO lines, however, are driven by separate 'SIO
     cards' which are  external  to  the  Engine  processor.   The  SIO
     transmissions  use  HDLC trans- mission control (an HDLC frame and
     bit stuffing scheme), which encodes the standard T201 packet.  The
     additional  16 bit checksum provided by the HDLC link control adds
     to our data integrity .

          In a Multiple Line Link, the Link Logic  will  transmit  data
     over  the  first  available  Line.   A  high  speed  Line  will be
     available more  often  than  a  low  speed  Line.   Therefore,  in
     conditions  other than overload conditions, most data will be sent
     over the higher speed Lines.

          The Sync Line process ensures that on an otherwise idle line,
     a  "dummy"  record  is  sent  every  half  second to verify to the
     neighbor  that  the  Line  is  still  up  and  in  good  operating
     condition.

          After a four second wait interval, if a good record (data  or
     dummy)  is  not  received, the line is placed in a 'frozen' state.
     If the line receives a good record, it is 'thawed'.   If  no  good
     records  are received for 16 seconds, the line is 'detached' and a
     'reset' sequence is begun on the line.  This procedure applies for
     each line on a Multiple Line Link.

          A security key exchange on each new  line  brought  up  on  a
     multiple  line  link,  ensures  that  the  line is attached to the
     proper neighbor  for  the  link.   If  it  is  not,  the  line  is
     'suspended' for two minutes, after which it again becomes eligible
     to undergo the reset sequence.

          The following commands are used to examine Lines  and  Links,
     some XRAY and some PROBE.
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY             Page 2-7
   LINK LOCAL TOPOLOGY


     2.3.2  XRAY CRYPTO LOG

          The Crypto Log of XRAY contains  a  history  buffer  of  node
     events.   After  logging in to XRAY, the crypto log is accessed by
     typing CL followed by a hex number  (maximum  ff)  indicating  how
     many  messages  you wish displayed.  The count of messages is from
     most current, back.  Below are some examples:

     130:20:45:25 E7F6  16: LINE ATTACHED - NLAT= 01  LN= 07  NGHBR= 2257
     130:20:45:25 E7F9  01: LINK UP   - KN= 19  NGHBR= 2257
     130:20:45:26 E7FB  51: LINK FROZEN - NGBHR= 2255
     130:20:45:26 E7FC  1E: 4 SEC'S WITH NO REC'S RECVD - LN= 12  NGHBR= 2255
     130:20:45:30 F1F8  1E: 4 SEC'S WITH NO REC'S RECVD - LN= 12  NGHBR= 2255
     130:20:45:34 FBFB  1E: 4 SEC'S WITH NO REC'S RECVD - LN= 12  NGHBR= 2255
     130:20:45:39 0622  04: LINE DETACHED - REASON= 01  LN= 12  NGHBR= 2255
     130:20:45:39 0622  0C: CRQ ZAP   - PORTS= 02B2  02FF
     130:20:45:39 0623  0C: CRQ ZAP   - PORTS= 02B1  004A
     130:20:45:39 0623  0C: CRQ ZAP   - PORTS= 02B0  004B
     130:20:45:39 0624  02: LINK DOWN - KN= 04  NGHBR= 2255
     130:20:45:39 0625  4D: CIRCUITS ZAPPED= 0003  KN= 04  NGHBR= 2255
     130:20:45:39 0625  4E: CMD CTS  ZAPPED= 0002  KN= 04  NGHBR= 2255
     130:20:49:52 58FD  47: 4-SECOND GAPS. COUNT= 0003  LN= 12  NGHBR= 2255
     
     130:20:54:02 26FA  51: LINK FROZEN - NGHBR= 2363
     130:20:54:02 26FA  1E: 4 SEC'S WITH NO REC'S RECVD - LN= 00  NGHBR= 2363
     130:20:54:06 30EE  52: LINK THAWED - NGHBR= 2363
     130:20:54:40 80FA  51: LINK FROZEN - NGHBR= 2363
     130:20:54:40 80FA  1E: 4 SEC'S WITH NO REC'S RECVD - LN= 00  NGHBR= 2363
     130:20:54:44 8AEF  52: LINK THAWED - NGHBR= 2363
     130:20:54:57 8AF0  51: LINK FROZEN - NGHBR= 2363
     130:20:54:57 8AF0  1E: 4 SEC'S WITH NO REC'S RECVD - LN= 00  NGHBR= 2363
     130:20:55:02 B2EB  1E: 4 SEC'S WITH NO REC'S RECVD - LN= 00  NGHBR= 2363
     130:20:55:06 BD0A  1E: 4 SEC'S WITH NO REC'S RECVD - LN= 00  NGHBR= 2363
     130:20:55:10 C6EF  52: LINK THAWED - NGHBR= 2363




     2.3.3  INTRODUCTION TO WINDOW SIZE

          Window size is a Link parameter.  It is the maximum number of
     packets  that  may  be sent on a Link before an acknowledgement is
     required.  Window size is a parameter which  is  set  at  assembly
     time.   It  may  only be specified in multiples of four, from 4 to
     124.

          In the node  software,  window  size  represents  the  actual
     number  of  packet  sectors  for  each  direction of traffic.  For
     example, if a Link is specified with a window size of  eight,  the
     node  reserves  sixteen sectors (eight for each direction) for the
     link.
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY             Page 2-8
   LINK LOCAL TOPOLOGY


          The last acknowledgement received always becomes  the  bottom
     value of the windowsize.  This is called a 'sliding window'.

          If all the packets in the window are not  received  properly,
     then  the oldest non acknowledged packet is retransmitted until an
     acknowledgement is received.

          Multiple Lines on a Link share the same  Link  Level  Window.
     Acknowledgements to packets in the window occur at the Link Level.
     They   may,   therefore,   be   received   on   different   lines.
     Retransmissions, however, are always sent on a different line than
     the original transmission.



     2.3.4  XRAY KD COMMAND

          The  XRAY  'KD'  command   displays   some   important   link
     configuration information.


     1.  NODE - neighbor node number in hex.

     2.  TP - link type (T-I=00, T-II=08).

     3.  BO - expected first nibble from neighbor / low order 0's.

     4.  NL - number of lines attached.

     5.  WS - window size for the link.

     6.  SP - link speed index.

     7.  NM - link number.

     8.  BNOD - same as neighbor number for T-II link, 0 for Xlink.

     9.  LINES- line numbers of all lines attached to the link.


          This is a partial list of all the  information  available  in
     the  KD command display.  For the complete list and details on the
     above portions, see the XRAY Reference Manual page 16.

          The following is an example of the XRAY 'KD' display:

     >KD 2056
     
     NODE  TPBO  NLWS  SPNM  NCHN  ISEC  NRTR  AMSK
     042E  0810  0108  0401  0080  35E0  3604  00FF
     
     OSEC  NRMK  NRXM  LRT   LAS   LRM   LAR   NAS
     3640  3658  3658  B6AA  B6A9  D6F1  D6F1  B6A9
     
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY             Page 2-9
   LINK LOCAL TOPOLOGY


     BNOD  CHN0  B.PT  E.PT  ACHN  VERS  LINES
     042E  0160  0000  0100  0004  0146  01
     
     CMD CKTS = 0001
     
     **X-RAY** NODE: 2256  HOST: 0694  TIME: 038:17:34:20

          Use this information in corroboration with  information  from
     the XRAY ND command and the PROBE Node command.



     2.4  VIRTUAL CIRCUIT TOPOLOGY

          In TYMNET technology, each logon has an origination interface
     interacting  with  the  Supervisor  to  create  a  connection to a
     destination network interface.  This connection, when  created  is
     called  a VIRTUAL CIRCUIT, and with the exception of a change made
     by REBILD, will remain intact for the  duration  of  the  session.
     Intact  meaning  the  channel  numbers in use on the network links
     will stay the same for  all  traffic  for  that  session.   Intact
     meaning the path through the network will be the same for all data
     passed in both directions.  We will start the examination of  this
     Virtual Circuit with an indepth explanation of the login process.



     2.4.1  LOGIN PROCESS

          For circuit origination, each Tymnet-II node uses  a  command
     circuit  to  communicate log-on information to the supervisor.  In
     Tymnet-II Node Code, the process which deals with command  circuit
     information   is  called  the  "Leprechaun".   "LEP"  handles  all
     communication to and from the supervisor,  and  commonly  utilizes
     channels 20 and 21 on the node.

          All command  channel  (supervisor)  messages  have  the  same
     format.   The  first  two bytes of these messages contain the high
     order bit set on and the node number  of  the  node  communicating
     with the supervisor.

          The first byte of the second halfword specifies  the  message
     type.  Formats for message types can be found in document sections
     titled   "to   supervisor   communication",    "from    supervisor
     communication",  or  "LEP  message  formats".  Refer to "Tymnet-II
     Principles of Operations".  (TYMPO.DOC)

          The logon process generally consists of  several  significant
     events:

     1.  When a port is detected to be in log-in state, the  LEP  takes
         the  information  and  places it in a "to supervisor" message.
         This will be a type '0F' "to supervisor" message.
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY            Page 2-10
   VIRTUAL CIRCUIT TOPOLOGY


     2.  The supervisor replies with a "needle" (for  a  T-II  log-on).
         This is a "from supervisor" message type '09'.

     3.  The needle is reformatted by LEP to contain a "needle  point",
         and  is  sent  out  on  the  next  link in the circuit path as
         prescribed by the node list contained in the  needle  message.
         The  needle point is an actual packet header (since the needle
         MUST travel in its own packet).  The needle point  is  '0310'.
         (The actual circuit is built as the needle traverses each node
         in the circuit path.)


          The process is slightly different for T-II Tymsats  and  ISIS
     Tymsats.   In  an ISIS node, an additional interaction takes place
     between the  interface  slot  and  slot  0  by  way  of  the  ISIS
     Dispatcher.  The following events take place:

     1.  The interface slot  issues  a  "pseudo-needle  request",  type
         '07', to slot 0 on dispatcher port 0.

     2.  The node code responds with a "pseudo-needle", type 'B2', on a
         new port assigned by the dispatcher.

     3.  The interface slot responds by sending the  log-on  characters
         in 'B3' messages to the node code on the newly assigned port.

     4.  Node code responds with status message, 'B4'.

     5.  Receipt of "needle" by node code is indicated to the interface
         slot  by  a  'B6'  message.  The circuit is now ready to carry
         data.


          In a T-II Tymsat, we can observe the  process  by  using  the
     Tymnet-II channel tracing facility present in XRAY.

          In an ISIS machine there are  two  areas  of  interest.   The
     interaction  with  the  network and the Supervisor can be observed
     using the XRAY channel trace facility.   The  interaction  between
     the interface slot and the Node code slot 0 must be observed using
     NAD-DDT by reading the input and output rings for  the  slot.   We
     will  come  back  to  reading  the traces of a login after we have
     learned a few commands involving the Virtual Circuit.



     2.4.2  VIRTUAL CIRCUIT TRACING

          Circuits have an origin and a destination.   Each  end  of  a
     circuit  can  be  said  to  be  a termination.  Circuits in Tymnet
     terminate at logical entities known as  'ports'.   Circuits  which
     traverse  both  Tymnet-II  and  Tymnet-I  nodes are called 'hybrid
     circuits'.
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY            Page 2-11
   VIRTUAL CIRCUIT TOPOLOGY


          Hybrid circuits have intermediate termination points.   These
     intermediate  termination points represent the "bridge" across the
     boundary between the Tymnet-I portion  of  the  network,  and  the
     Tymnet-II portion of the network, and vice versa.  These "bridges"
     are identified by 'channel number'.  The "bridge" between Tymnet-I
     and  Tymnet-II  will  have  the  same 'relative channel number' at
     either end.

          Circuit tracing involves several steps.  A  port  or  channel
     number must be established which represents a termination.  Then a
     trace of  the  circuit  may  be  initiated  using  PROBE  or  XRAY
     facilities.   This  termination  point  may  be the origination or
     destination TYMNET interfaces.



     2.4.2.1  ORIGIN SOLO TYMSAT(CONSAT)

          We will  first  examine  tracing  an  all  TYMNET-II  circuit
     starting  at  a  Solo  TYMSAT(CONSAT).  The starting point of this
     circuit is the TYMSAT port.  We will require the  port  number  in
     decimal  radix.   There  are  several  places we can get this port
     number.  If it is displayed in octal, a conversion to  decimal  is
     required.

     1.  Convert octal port number from node -  port  display  on  user
         terminal.

     2.  Use the XRAY 'AS U' command (only  CONSAT)  to  display  async
         port status of the Tymsat before and after the user has logged
         in.  Convert the octal port number given in the  'port'  field
         of the display.

     3.  Use the 'PSTAT' command in PROBE to establish the decimal port
         in  use.   In  PROBE, port groups are 128 ports.  Use the node
         number of the Tymsat, and 'h0' and the port group of 0 or 1.

   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY            Page 2-12
   VIRTUAL CIRCUIT TOPOLOGY


          Examples:

     Logging in at User Terminal
     ---------------------------
     
     please type your terminal identifier
     -2300-263-
     please log in:
     
     Using the XRAY 'AS U' Command
     -----------------------------
     
     >AS U
     
     0001  PORTS IN USE OUT OF  0256      PEAK = 0001           1200  BPS MAX
     
     PORT  RLA DTR DSR RTS CP DPLX BR  TY  SB  TM  NL  CHAN  LINK  TIME(SEC)  UP
     
     0263  FF  FF  FF  00  FF  00  55  70  FF  FF  01  06CF  2034  00000110   04
     
     >
     
     Using the PROBE 'PSTAT' Command
     -------------------------------
     
     :pstat 2300 h0 0
     HOST 0 PORT ARRAY 0
     :pstat 2300 h0 1
     HOST 0 PORT ARRAY 1  179

          In all the above examples the decimal  port  number  is  179.
     Note:   In the PSTAT command what is displayed is the Link channel
     number.  In a Solo TYMSAT(CONSAT) this is the same as the physical
     port  out  of  the  back  of  the Engine (same as the logical port
     referred to by the Solo code).

          After establishing the decimal port  number,  use  the  PROBE
     'TRACE' command.  A list of node numbers will be produced.

          The following is an example of the PROBE Trace Command:

     :trace 2300 h1706 179
     HOST 1706 PORT 179 2300 2102 2034 HOST 1897 PORT 1

          A trace of the  circuit  has  disclosed  the  node  and  port
     numbers  at  each  end  of  the  circuit,  and the node numbers in
     between.  The port number displayed as the termination point  must
     be interpreted according to the type of termination interface.  In
     this case it is an ISIS Host, and the port number is the ISIS Node
     Code dispatcher port number to that host slot.
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY            Page 2-13
   VIRTUAL CIRCUIT TOPOLOGY


     2.4.2.2  ORIGIN ISIS HOST SLOT

          The steps outlined above  can  also  be  used  to  trace  the
     circuit  from  the host end.  Use whatever means applicable to the
     host interface code to determine the Dispatcher port number out of
     the ISIS host slot.  Use the ISIS DDT command ?CT to determine the
     corresponding Node Code (slot 0) Dispatcher port number.  Use this
     port number in the PROBE TRACE command.

          This port number can also be verified in PROBE with the PSTAT
     command.   This  time,  with the PSTAT command, use your slot host
     number.

          Example:  

     :pstat 2034 h1897 0 
     HOST 1897 PORT ARRAY 0 1 2 3 5 6 31
     :trace 2034 h1897 1 
     HOST 1897 PORT 1 2034 2102 2300 TYMSAT PORT 179

                    ( T-II Tymsat )
     
                  ____________________
     (terminal)  |                    | (decimal port
                [ ]       ,--------------------------- ( virtual circuit )
        /|(octal)|       /(termination|  for PROBE)
       /_|------[-]-----'   in node)  |
       __|(port) |                    |
                [ ]                   |
                 |                    |
     (port 0)   [ ] (node code async) |
                 |____________________|
     
        (async    (async          (link's       ( link out to network )
         ports)    channel         channel
                      area)           area)
     

          Figure 3.  Circuit Origination at TYMNET-II TYMSAT



     2.4.2.3  ORIGIN ISIS CONSAT

          In an ISIS  Consat,  the  circuit  goes  from  the  terminal,
     through  the  Consat  interface, through the dispatcher to slot 0,
     and from slot 0 out into the network.   Establishing  the  decimal
     port  (channel  number  for  the  PROBE 'TRACE' command, will take
     several steps, similar to tracing from the ISIS Host slot.

          Note that the  octal  port  number  given  in  the  node/port
     display  at  connection.   Convert  this  octal  port  number into
     decimal.  Using ISIS-DDT enter the Consat slot.  Use  the  '?STAT'
     command  to access the extended DDT program residing in the CONSAT
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY            Page 2-14
   VIRTUAL CIRCUIT TOPOLOGY


     slot code.  When in this program use the 'PORTS'  sub  command  to
     query  the status of internal Consat ports.  Find the decimal port
     number of your port in the "Port" column of the display.  Note the
     hexadecimal  value  in the "ISIS" column which is across from your
     decimal port.  Leave the '?STAT' mode by typing "quit".

          The '?CT' command displays the mapping of ports  through  the
     Dispatcher  from  the  Consat  slot  to  the Node Code slot.  Port
     values will  be  given  in  hex.   Note  the  Slot  0  port  which
     corresponds to the dispatcher port from the Consat slot.

          Convert the Slot 0 port from hex to decimal.  Use the decimal
     port  number  obtained,  along  with  "h0",  in  the PROBE 'TRACE'
     command.  the

          The following is an example of the ISIS-DDT display:

     please log in: USERNAME:2271;<password><cr>
     node: 2701
     host: 2271
     
     slot  : 1<cr>
     *?STAT<cr>
     
     :>PORTS<cr>   :the ":>" is the STAT prompt
     
     ISIS  Port
     
      32    12
      3A    22
      3F    25
     
     :>QUIT<cr>
     
     *?CT<cr>      :the ISIS DDT "*" prompt has been returned
     
     Port 3A-->s3:E6
     Port 3B-->s3:FF
     Port 3F-->s0:6
     Port 42-->s1:ED
     *Z  Logging off?  Z
     please log in:
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY            Page 2-15
   VIRTUAL CIRCUIT TOPOLOGY


                     I S I S  Node
              ________________________________
             | .                              |
             |  +        ( kernel )           |
             |    + ._________________________|
             |d      |    ( node code )       |    ( channel out on
             |i     [ ] (isis          ,----- - -------------------
             |s      |   port, hex)   / (h0   |      network link )
             |p  ,--[-]--------------'prt dec)|
             |a  :   |________________________|
             |t  :   |    ( consat slot )     |
             |c  :  [ ]              (consat [ ]
             |h  :   |  (isis          port   |       |\  (port
             |e  :  [ ]  port,      ----in---[-]------|_\   in
             |r  :   |    hex)     ' decimal) |       |__  octal)
             |    --[-]-----------'          [ ]
             |_______|________________________|


          Figure 4.  Circuit Origination at an ISIS Consat.



     2.4.2.4  HYBRID CIRCUITS

          A hybrid circuit is a circuit which  contains  a  mixture  of
     Tymnet-I  and  Tymnet-II  nodes.   The  basic  principle in hybrid
     circuit tracing is to be aware of the circuit channel  numbers  as
     the  circuit crosses a boundary from T-I to T-II, or T-II to T-II.
     This crossing point will be  identified  by  the  channel  number.
     Channel  numbers are shown in the PROBE 'TRACE' command as numbers
     in parenthesis.  

          In addition to the PROBE 'TRACE' command, the PROBE  commands
     'CT' and 'CL' will be useful for hybrid circuits.

          When the circuit originates at Tymnet-I node;  and, it  is  a
     Varian  machine,  use  the PROBE 'CT' command to show the circuits
     which terminate on the node.  The channel number for entrance into
     T-II  will be given.  Use the PROBE 'TRACE' command with T-II node
     number, T-I node number, and channel number as arguments.  

          Example:

     :ct 1017
      P2 1017 3015 T-II (95)
      P5 1017 2171 T-II (93)
      P4 1017 2171 T-II (94)
     :trace 2171 n1017 93
     NODE 1017 CHANNEL 93 2171 2172 2017 2601 HOST 1304 PORT 21

          Verify the trace by tracing backward using the PSTAT  command
     as follows:
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY            Page 2-16
   VIRTUAL CIRCUIT TOPOLOGY


     :pstat 2601 h1304 0
     HOST 1304 PORT ARRAY 0  1 2 4 5 6 7 8 9 10 11 12 13 14 20 21
     :trace 2601 h1304 21
     HOST 1304 PORT 21 2601 2017 2172 2171 NODE 1017 CHANNEL 93

          If the Tymnet-I node is an Engine, the same procedure applies
     for  T-I  Engines as applies for examining ports as they appear on
     hosts or T-I circuit terminations.   The  PROBE  'PSTAT'  command,
     using  "h0"  as an argument, will show ports as they come up.  The
     'TRACE' command may then be used with the decimal port number  and
     "h0" as arguments.

          When the circuit traverses a Tymnet-I node note  the  channel
     number  given  by the PROBE 'TRACE' command as the T-I termination
     point and also note the T-I node number.

          Use the PROBE 'CL' command to show circuits  passing  through
     the  T-I  node  from  the line to the T-II neighbor from which the
     traced circuit is coming from.

          Note the channel number  given  for  the  other  end  of  the
     passthrough  circuit.   Use  the PROBE 'TRACE' command to continue
     the trace, using the T-I node and channel  number,  and  the  next
     T-II node number as arguments.

          Example:

     :trace 2300 h1706 179
     HOST 1706 PORT 179 2300 2034 NODE 131 CHANNEL 83
     :cl 131 0
     T-II (83) 2034 131 3076 T-II (76)
     T-II (84) 3020 131 3076 T-II (81)
     :trace 3076 n131 76
     NODE 131 CHANNEL 76 3076 2510 2601 HOST 1304 PORT 21

               T2        T2        T 1         T2        T2        T2
              ____      ____      ______      ____      ____      ____
       /|    |    |    |    |    |      |    |    |    |    |    |    |
      /_|----|    |----|    |----[]----[]----|    |----|    |----|    |--HOST
      __|    |____|    |____|    |______|    |____|    |____|    |____|
     
                               (ch83)(ch76)
     (term)  (2300)    (2034)      (131)     (3076)    (2510)    (2601)

          Figure 5.  Hybrid Circuit Tracing.



     2.4.3  XRAY CHANNEL TRACE

          Now that there has been  some  exposure  to  general  Virtual
     Circuit  tracing,  XRAY  has another useful tool to use called the
     Channel Trace.  Where before the emphasis has been on "where"  the
     circuit  resides  in  each  step  of the circuit, the XRAY Channel
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY            Page 2-17
   VIRTUAL CIRCUIT TOPOLOGY


     Trace becomes the window into that circuit.  It is used to display
     actual data (user and control) over the TYMNET-II channel.



     2.4.3.1  XRAY CT COMMAND

          In any Tymnet-II SOLO Tymsat, the absolute channel number  of
     40  hex  denotes  the  beginning of the Tymsat's async ports.  The
     ports themselves  are  numbered  from  zero.   Use  the  node-port
     identifier  from  the  terminal  or use the XRAY 'AS U' command to
     determine your octal port.  Convert the octal port number  to  hex
     and add it to absolute chan 40 hex.

          Use the XRAY 'TC' command to enable tracing on your  channel.
     Observe   the  LEP  messages  as  they  travel  to  and  from  the
     supervisor.  Observe the needle arriving on the  LEP  channel  and
     going out on your channel for the circuit.  

                   ( T-II Tymsat )
     
                 ____________________
     (terminal) |                    |  ( relative channel on link )
               [ ]       ,----------[-]----------- ( virtual circuit )
       /|(octal)| (hex) / (abs chan  |
      /_|------[-]-----'   in node) [ ]
      __|       |                    |
               [ ]                  [ ]
                |                    |
     (port 0)  [ ] (abs chan 40)    [ ]  ( absolute channel for
                |____________________|      link's channel zero )
     
       (async    (async          (link's       ( link out to network )
        ports)    channel         channel
                     area)           area)

          Figure 6.  Circuit Origination at the T-II Tymsat.

          Example:  The following is a logon to  EMSAA  observed  using
     the XRAY "Trace Channel" facility.
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY            Page 2-18
   VIRTUAL CIRCUIT TOPOLOGY


     >TC
     0020
     
     >TC F5 1
     0020 00F5
     
     >TD
     
     I/O  CHN    TIME
     
     IN  00F5  00032324  8D  8A  C4  D2  CF  D0  D0  C5  C4  A0  C2  D9
                         A0  C8  CF  D3  D4  01  FF
     OUT 0020  00056980  84  C0  0B  80  01  FB
     OUT 0020  00058864  84  C0  0F  88  84  26  86  AA  CC  92  E5  ED
                         F3  E1  E1  8D
     IN  0020  00059082  23  84  C0  09  83  00  41  11  42  80  90  04
                         C0  04  26  04  0F  05  48  04  CF  83  40  CC
                         80  86  AA  45  4D  53  41  41  8D
     OUT 0020  00059091  84  C0  14  89  70  41  11  42  84  C0  14  89
                         E0  09  00  B5
     OUT 00F5  00059092  03  10  23  83  00  41  11  42  80  90  04  C0
                         04  26  FF  FF  05  48  04  CF  83  40  CC  80
                         86  AA  45  4D  53  41  41  8D
     IN  00F5  00059358  01  C1  20  0A  0D  3E  4F  4E  54  59  4D  45
                         20  49  49  00  20  20  20
     OUT 00F5  00059367  01  C1
     IN  00F5  00059375  32  32  20  4D  41  59  20  38  33  20  32  30
                         3A  35  30  3A  32  30  20  20
     IN  00F5  00059378  47  4D  54
     IN  00F5  00059389  0D  0A



     2.4.3.2  ISIS SLOT LOGIN/CHANNEL TRACE

          In an ISIS  node,  the  channels  allocated  to  the  Slot  0
     dispatcher  ports  begin  at absolute channel number 60 hex.  In a
     Supervisor or other special configuration, this may not always  be
     the  case.   Consult  the  value  at  'DISZFL' in the node code to
     ascertain the beginning of dispatcher ports for slot 0.

          Circuits mapped into slot zero from the ISIS Dispatcher enter
     through a range of ports beginning at relative port zero.

          The technique used to determine ports  for  a  circuit  trace
     from an ISIS Consat can also be used here to determine the channel
     and Dispatcher port to monitor.  Remember the following points  of
     what we have already covered:

     1.  The octal port number is mapped through the Consat and into an
         ISIS port.  This ISIS port is known as the 'RPORT' in the ISIS
         message format.  This port number (in hex) will appear in  the
         ISIS Iring and Oring display.  
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY            Page 2-19
   VIRTUAL CIRCUIT TOPOLOGY


     2.  The ISIS port terminates on Slot 0 on a relative  port  number
         (in  hex).  Add this number to hex channel 60 to determine the
         absolute channel number in the node which may be traced  using
         the XRAY channel trace facility.  

     3.  Immediately after circuit origination, these techniques may be
         used  to  observe  log  on  information as it travels from the
         interface slot to slot 0, from slot 0 to the  Supervisor,  and
         from the Supervisor to slot 0 and from slot 0 to the interface
         slot.


                     I S I S  Node
              ________________________________
             | .                              |
             |  +        ( kernel )           |
             |    + ._________________________|
             |d      |    ( node code )       |    ( channel out on
             |i     [ ] (isis          ,-----[-]-------------------
             |s      |   port, hex)   /       |      network link )
             |p  ,--[-]--60x---------'        |
             |a  :   |________________________|
             |t  :   |    ( consat slot )     |
             |c  :  [ ]              (async  [ ]
             |h  :   |  (isis          port   |       |\  (port
             |e  :  [ ]  port,      ----in---[-]------|_\   in
             |r  :   |    hex)     ' decimal) |       |__  octal)
             |    --[-]-----------'          [ ]
             |_______|________________________|

          Figure 7.  Circuit Origination at an ISIS Consat.

          Example:  The following is an example  of  finding  port  and
     channel  numbers,  and  monitoring  the Logon messages both in the
     ISIS Dispatcher rings and XRAY Channel Trace facility.
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY            Page 2-20
   VIRTUAL CIRCUIT TOPOLOGY


     -R NAD<cr>
     062382
     %F   ND3325.N01<cr>
     
     %G
     ;G
     
     Data ranges read:
     0-33C9 10000-17FFD 17FFE-1C937 20000-21883 30000-303FF 0E0000-0E00FF
     
     ;C   ISISTECH:2877<cr>
     Working
     Circuit ready
     
     node: 3325
     host: 2877
     
     slot  : ;R01/
     
     *::?STAT<cr>
     
     :>::PORTS<cr>
     
     ISIS  Port
     
      10     1
     
     :>::Q<cr>
     
     *::?CT<cr>
     
     Port 10-->s0:1
     *:R ORING,4<cr>
     21004  0080  0080
     
     *:R ORING,80+10<cr>
     21004  0098  0098  0000  0700  0301  8000  46AD  CC00
     21014  0010  B392  0010  B3E5  0010  B3ED  0100  B3F3
     21024  0010  B3E1  0010  B3E1  0010  B38D  0010  B700
     21034  E009  0101  0010  B100  0100  0000  0010  AA00
     21044  0010  A700  0010  0174  0010  0179  0010  016D
     21054  0010  0120  0010  0165  0010  012F  0010  0176
     21064  0010  0161  0010  016C  0010  0165  0010  016E
     21074  0010  0174  0010  016E  0010  0169  0010  016F
     21084  0010  010D  0010  AD00  0010  9F00  0000  0700
     *:R IRING,4<cr>
     21404  0130  0130
     *:R IRING,130+10<cr>
     21404  0130  0130  0010  B200  0301  0000  0010  B600
     24414  0047  8975  0002  0000  0010  B950  0010  B100
     21424  0153  5038  0010  0420  0A0D  3E4B  0010  1B30
     21444  3320  4A55  4C20  3833  2032  323A  3236  3A33
     21454  3920  2047  4D45  0D0A  0D0A  592D  0010  0449
     21464  443F  2053  0010  AA20  0010  040D  0A0A  0A20
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY            Page 2-21
   VIRTUAL CIRCUIT TOPOLOGY


     21474  0010  0449  443F  2020  0010  020D  0A02  0350
     21484  0010  0A54  494D  454F  5554  200D  0A32  2020
     21494  0010  1744  524F  5050  4544  2042  5920  4F4E
     214A4  5459  4D45  2049  4900  0D0A  290D  0010  1630
     214B4  3320  4A55  4C20  3833  2031  333A  3237  3A34
     214C4  3320  200D  0A41  5052  0010  AC20  0010  9F00
     214D4  0010  BB00  0010  B200  0401  0000  0010  B820
     214E4  0010  468D  8AF0  ECE5  E1F3  E5A0  F3E5  E5A0
     214F4  F9EF  F5F2  A0F2  E5F0  F2E5  F3E5  EEF4  E1F4
     21504  E9F6  E58D  8AE9  E6A0  F9EF  F5A0  E1F2  E5A0
     21514  E8E1  F6E9  EEE7  A0F4  F2EF  F5E2  ECE5  A0EC
     21524  EFE7  E7E9  EEE7  A0E9  EE20  2020  0010  AF20
     21534  0010  BB00  0000  0000  0000  0000  0000  0000

          Now after logging into XRAY:

     >TC<cr>
     0020
     
     >TC 61 1<cr>
     0020 0061
     
     >TD<cr>
     
     I/O  CHN    TIME
     
     OUT 0020  00036922  86  D5  0B  80  01  00
     OUT 0020  00048274  86  D5  0B  80  01  00
     IN  0020  00051056  0D  86  D5  0F  94  88  1D  64  50  80  01
     OUT 0020  00051060  86  D5  14  15  88  1D  64  50  80  01  09  B0
                         C7  72
     OUT 0020  00023330  86  D5  0F  08  80  61  C6  AD  CC  92  E5  ED
                         F3  E1  E1  8D
     IN  0020  00023710  28  86  D5  09  85  00  47  89  75  80  90  06
                         D5  00  61  04  C1  04  C0  04  0F  0F  48  04
                         D0  83  40  CC  80  C6  AD  45  4D  53  41  41
                         8D
     OUT 0061  00023720  03  10  26  85  00  47  89  75  80  90  06  D5
                         00  61  FF  FF  04  C0  04  0F  05  48  04  D0
                         83  40  CC  80  C6  AD  45  4D  53  41  41  8D
     OUT 0020  00023730  86  D5  14  89  70  47  89  75  86  D5  14  89
                         E0  09  01  01
     IN  0061  00024043  01  C1  20  0A  0D  3E
     IN  0061  00024091  4F  4E  54  59  4D  45  20  49  49  00  20  20



     2.4.4  PERMANENT VIRTUAL CIRCUITS

          A Permanent Virtual Circuit is the name for a network virtual
     circuit  created  by  the  TYMSAT(CONSAT)  software  according  to
     parameters  defined  in  the  TYMSAT(CONSAT)  code.   The  circuit
     creation may be triggered by an RS232C signal connection or may be
     automatic upon execution of the TYMSAT(CONSAT) code.  The  primary
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY            Page 2-22
   VIRTUAL CIRCUIT TOPOLOGY


     distinction is the code generated logon sequence as opposed to the
     normal manually controlled logon.  The TYMSAT and CONSAT reference
     documents  describe  the options available to this type of network
     connection.

          Permanent Virtual Circuits (PVC's)can be  specified  for  any
     port  or range of ports on a T-II Tymsat or an ISIS Consat.  Macro
     statements which specify special characteristics for the  port  or
     ports  can be added to the .TYM file for the T-II Tymsat or the .T
     for the ISIS Consat.

          The XRAY 'PV' command, using  an  octal  port  number  as  an
     argument,  will display the currently configured PVC parameters as
     specified in the TYM  file.   The  XRAY  'PV'  display  will  only
     function for a T-II Tymsat.  

          Example:  The following is the XRAY 'PV' command.

     >PV 63
     PORT 0051  (0063)    AID  TID15      ALO  PCO
         NPI  NOPAR    HNG  NOHDX    CRLF    LFCR  NOTRS    RBP
     
     >PV 261
     PORT 0177  (0261)    AID  TID15      ALO  PCO
         NPI  NOPAR    HNG  NOHDX    CRLF    LFCR  NOTRS    RBP
     
     > 

          The 'PV' command, given without an argument, will display all
     ports configured for PVC service.  Many of these parameters can be
     verified by referring to fields in  the  'AS  U'  display,  or  by
     observing  terminal  query and response messages in the ISIS rings
     or in the T-II channel trace.



     2.4.5  VIRTUAL CIRCUIT SUMMARY

          The above procedures  have  outlined  the  basic  methods  of
     tracing  circuits  through  Tymnet-I and Tymnet-II nodes.  We have
     relied on the PROBE 'TRACE' command to provide the list  of  nodes
     in  the  circuit.   We  have used other PROBE commands, along with
     some ISIS -DDT commands and some XRAY commands to  supplement  the
     'TRACE' command.  In some cases we have had to piece together what
     are  known  as  'circuit  segments',  using  channel  numbers   as
     connecting elements.  

          We also have covered how to read data being  passed  on  this
     circuit,  both  with  ISIS  DDT  and  with  the XRAY Channel Trace
     facility.  When using  a  method  called  "chaining"  the  channel
     numbers,  data  can  be  examined at each step along the TYMNET-II
     network.  Later we will also discuss how  to  use  this  chain  to
     determine delays as well.
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY            Page 2-23
   NODE/LINK TOPOLOGY


     2.5  NODE/LINK TOPOLOGY

          Now that a circuit path has been determined, we  can  examine
     each  node  and  each  link in the path in order to detect trouble
     conditions.  Initially, we should examine  the  basic  performance
     characteristics of each machine and each link in the circuit path.
     Problems uncovered at this initial  stage  of  investigation  will
     serve as indicators that a more in depth investigation is required
     for the node or link.



     2.5.1  PERFORMANCE

          Initially, the PROBE N display will indicate if the  node  is
     heavily  loaded.   Lines  may  show  'OV'  or  '2*OV'.   The  'OV'
     indicates overload in the transmit direction  for  the  link.   An
     '2*OV'  indicates  overload  conditions  for both directions.  The
     available passthrough count may be very low.   This  may  indicate
     that  the  machine  is  overloaded.   More  than  six links in the
     circuit path may  cause  excessive  delays.   Topology  should  be
     investigated.

          There are two XRAY commands used to examine the node and  its
     links:

     1.  XRAY ND Display

              Note   the   following   ND   display   items   in   this
         investigation:

         1.  Number of ports and passthroughs in use (indicates load).

         2.  Number of circuits in use per line (indicates load).

         3.  Error rate on each line (*** or **** is problem).

         4.  Number of active links for the node.

         5.  Configuration - network lines and async ports possible.

         6.  Crash status - type and address (must investigate).


     2.  XRAY 'NS' Display

              This command has  not  been  discussed  previously.   The
         details  may  be  found  in the XRAY Reference Manual page 11.
         The following are pertinent to this investigation:

         1.  Number of Exec loops per second - average, high, and low.
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY            Page 2-24
   NODE/LINK TOPOLOGY


         2.  Longest time for a single Exec loop iteration.

         3.  Longest time a needle took to pass through the node.

         4.  Maximum ports and passthru's experienced by node.

         5.  Delay total for data passing through the node  (should  be
             50).

         6.  Maximum async time (should always be less than 'WRAP').


              The 'NSZ' command (a variation on the NS command) may  be
         given  to zero out some of the node statistics high water mark
         fields, providing an  easy  method  for  monitoring  the  node
         starting at a particular point of reference.  High water marks
         for node statistics are meaningful only if taken in  reference
         to  "NSZ".   In  this  way  they  can  be made relevant to the
         current time frame.  

     3.  XRAY 'KS' display (for both links on the circuit)

              Bandwidth utilization (should be less than 60 or max  70;
         optimum utilization occurs between 40 and 50).

     4.  XRAY Crypto Log (Performance History)

              The XRAY crypto log will display messages which relate to
         the  operation  of machines in the circuit, and performance on
         the lines and links which connect them.   The  examples  below
         illustrate  crypto messages which relate to problem conditions
         on sync and SIO lines.  These  problems  may  cause  excessive
         retransmissions, and thus degrade the performance of the link.

         >CL 0F
         
         130:23:52:20 19EF  46: RE-XMISSIONS SENT. COUNT= 0243  LN= 26  NGHBR= 2217
         130:23:52:20 19EF  46: RE-XMISSIONS SENT. COUNT= 05E0  LN= 16  NGHBR= 2217
         130:23:52:20 19F5  40: TOT PKTS - RECD= 0A27  SENT= 0FE8  LN= 26  NGHBR= 2217
         130:23:52:20 19F6  40: TOT PKTS - RECD= 1663  SENT= 1D5E  LN= 16  NGHBR= 2217
         131:00:24:12 99F3  4A: HDLC CKSM ERRORS. COUNT= 8502  LN= 16  NGHBR= 2217
         131:00:24:45 E76F  53: BAD SIO REC LENGTH - LN= 16  NGHBR= 2217
         131:00:27:02 276B  53: BAD SIO REC LENGTH - LN= 16  NGHBR= 2217
         131:00:28:45 19F0  4A: HDLC CKSM ERRORS. COUNT= 8402  LN= 16  NGHBR= 2217
         131:00:28:45 19F1  4B: HDLC ABORTS. COUNT= 8001  LN= 16  NGHBR= 2217
         131:00:33:18 99F3  4A: HDLC CKSM ERRORS. COUNT= 8301  LN= 16  NGHBR= 2217
         131:00:33:18 99F3  4B: HDLC ABORTS. COUNT= 8001  LN= 16  NGHBR=2217
         131:00:37:51 19EF  41: BAD BORI. COUNT= 0040  LN= 00  NGHBR 2363
         131:00:37:51 19F0  43: BAD RECORD NUMBER. COUNT= 0004  LN= 00  NGHBR= 2363
         131:00:37:51 19F1  44: BAD CHECKSUM. COUNT= 0009  LN= 00  NGHBR= 2363
         131:00:37:51 19F4  4A: HDLC CKSM ERRORS. COUNT= 8206  LN= 16  NGHBR= 2217
         >
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY            Page 2-25
   NODE/LINK TOPOLOGY


              The XRAY Crypto Log can also display all  messages  of  a
         certain  type.   If  the crash count has incremented past one,
         for example, we may wish to display all messages  relating  to
         node  crashes.   The Crypto Message type for crash information
         is '00'.

              The XRAY command 'CM ' , using the  XRAY  Crypto  message
         number  as  an  argument,  will  display  all  messages of the
         specified type which have been  retained  in  the  Crypto  Log
         buffer.   The XRAY command 'CD Y' will display Crypto messages
         as they occur on the node.  




     2.5.2  DELAY MEASUREMENTS WITH XRAY

          Delay is of several types.   Average  hardware  and  software
     delay  for  all  links  within a network machine can be determined
     using the XRAY 'NS' display.  Hardware and  software  delay  on  a
     particular  link  is  shown  in the XRAY 'KS' display.  Delay on a
     typical circuit of up to eight T-II nodes can  be  measured  using
     the  XRAY  'DB',  'DD',  AND 'DE' commands.  Delay on a particular
     circuit may be measured directly  using  the  XRAY  'PM'  command.
     Response  at  a  T-II  host interface may be measured by comparing
     times for data in and data  out  using  the  XRAY  'TC'  and  'TD'
     commands.

          The only component of delay  which  we  cannot  measure  with
     Tymnet  tools  is  propagation  delay over the transmission lines.
     This can be estimated using combinations of the features described
     above.   Note:   In using high water marks for delay measurements,
     it is important to first use the 'NSZ' command so that the display
     becomes relevant to the current time frame.



     2.5.2.1  XRAY NS COMMAND

          This command provides us  with  the  following  two  valuable
     pieces of information:

     1.  NEHW - highest time to process  a  needle  through  the  node.
         (Should be approximately less than 500ms.)

     2.  CODE DELAY, H-WARE DELAY, TOTAL - represents combined  figures
         for  all  the links on the node.  (Approximately 50ms total or
         less.)


          Example, the XRAY 'NS' display showing average delay:

     >NS
     
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY            Page 2-26
   NODE/LINK TOPOLOGY


     EXCT  EXLW  EXHW  EDHW  EEHW  SYHW  NEHW  NECT  MPRT  MPAS  MLNK
     0191  0089  0239  0000  0118  0085  0108  0354  0043  0033  0005
     
      RMK XCT  RMK NMK  PACKETS
     00047921 00045771 00002150
     
     NODE LINKS' TOTAL CPS RATES
       CPSO     CPSI     HWMO     HWMI
     00000066 00000216 00000389 00000637
     
     ASYNC CPS RATES
       CPSO     CPSI     HWMO     HWMI
     00000168 00000018 00000595 00000084
     
     PRINTER CPS RATES
       CPSO     CPSI     HWMO     HWMI
     00000168 00000000 00000595 00000000
     
     CODE DELAY    H-WARE DELAY     TOTAL       EFFICIENCY
         0003          0013          0017          0000
     
     PROCESS: ASYNC SYLVR Q-SEC H-SEC SPIDR SWICH LINKR DWLIN SOURC X-RAY 1SEC
     PERCENT:   03    21    00    01    39    10    00    00    00    00    00
     MAX(MS): 0102  0008  0025  0009  0016  0080  0028  0000  0000  0016  0004
     
     AVERAGE ASYNC TIME (MS) : 0002      MAX : 0085      WRAP : 0200



     2.5.2.2  XRAY KS COMMAND

          The KS command indicates delay in the hardware  and  software
     components.  Link performance statistics are based on a one-minute
     measurement interval.  Most of the fields reflect activity  during
     the last interval.

          Incoming

     1.  QUEUE - packet waiting to  be  cksumm'd  and  moved  to  input
         sector.  (May vary in ISIS nodes.)

     2.  RTEAR - from when complete packet reaches input  sector  until
         beginning of packet teardown.


          Outgoing

     1.  BUFFER - in buffer waiting to get made into packet going out.

     2.  OUT QUEUE - time packet waited before being transmitted.

     3.  XMIT - actual  transmission  time  of  the  packet.   (May  be
         slightly higher than others, depending on link conditions.)

   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY            Page 2-27
   NODE/LINK TOPOLOGY


          Total

     1.  TOTAL - sum of previous fields.  (Close to node average.)


          Example:  The following is the XRAY 'KS' display.

     >KS 2217
     
     LINK : 2217
     
     LOGICAL LINK CHARACTERS
         CPS IN : 00002376 HWM : 00003169
         CPS OUT: 00001770 HWM : 00004055
     PHYSICAL LINK CHARACTERS
         CPS IN : 00003386 HWM : 00004271
         CPS OUT: 00002799 HWM : 00005105
     PACKET OVERHEAD
         IN : 29       OUT : 36
     BANDWIDTH UTILIZATION
         IN : 48       OUT : 39
     CHAR/SEC PER CIRCUIT
         IN : 0005    OUT : 0004   CIRCUITS : 0428
     PACKET STATISTICS
         PACKETS/SEC : 0052     AVERAGE SIZE : 0053  BYTES
         RECORDS/PACKET : 0003
     LINK DELAY (MS)
         IN QUEUE    RTEAR    BUFFER   OUT QUEUE   XMIT     TOTAL
           0005      0057      0005      0012      0013      0092
     OVERLOAD COUNT   SATURATED COUNT   BACKLOG COUNT   PACKETS MADE   IDLE CALLS
           0000            0000            0145            3161          00001606
                         MARKING          REXMISSIONS    XMISSIONS
     LINE 0016  :        N/A               0048          2866
     LINE 0024  :        N/A               0023          0366
     
     
     **X-RAY** NODE: 2012  HOST: 1743  TIME: 038:23:42:27

          The above figures summarize  the  delay  which  occurs  on  a
     particular  link  within  the  machine itself.  The total does not
     include propagation time over the link.



     2.5.2.3  XRAY DB, DD, AND DE COMMANDS

          The 'DB' command asks for a node list  (not  to  include  the
     node  we  are logged into) and sends a special packet down its own
     circuit and back again.  The average figures displayed are  for  a
     round trip through the circuit.

          In addition to the average delay times displayed, the data of
     all  delay  times  for  the  last  32  test packets can be used to
     illustrate the consistency  of  transmission  over  the  link.   A
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY            Page 2-28
   NODE/LINK TOPOLOGY


     histogram  can  be  constructed, and peaks or valleys in the graph
     may disclose erratic activity on the link.  

          The following is an example of the XRAY 'DB', 'DD', and  'DE'
     Commands:

     >DB
     
     T-II NODE LIST: 2172 2717 2034
     
     >DD
     
     **** TIME, AVE1, AVE2 AND DATA FIELDS ARE DECIMAL MS ****
     
     TIME  CPS   STAT  FLAG  HWF   PTR   AVE1  AVE2
     1024  0002  0001  80B0  0000  0006  0273  0280
     
     NODES : 2172  2717  2034
     
     DATA:
     0240  0252  0293  0243  0295  0288  0258  0253
     0258  0307  0240  0285  0290  0247  0298  0255
     0258  0308  0305  0262  0300  0285  0295  0282
     0258  0240  0243  0243  0252  0292  0290  0232
     
     >DE

          The DE command terminates the delay measurement  or  loopback
     requested  by  the  DB  command.   the  DD  command  displays  the
     statistics gathered on the test path.  Details on  these  commands
     start on page 52 of the XRAY Reference Manual.



     2.5.2.4  XRAY PM COMMAND

          The round trip delay on a specific circuit may be measured by
     using  the  XRAY 'PM' command.  Two separate timing characters are
     sent out on an actual user circuit.  The character  named  "Timer"
     travels  as a normal character on the user circuit.  The character
     named "Xlax" jumps ahead of all user data on the circuit path and,
     therefore,  avoids  all  processing  queues which normal user data
     encounters.

          The 'PM' command may be given using the hex channel number at
     either  end of a circuit.  The following is an example of the XRAY
     'PM' command:

     >PM 0F4
     
     ROUND TRIP DELAY (MS)    TIMER : 0278    XLAX : 0219
     
     >
     
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY            Page 2-29
   NODE/LINK TOPOLOGY


          Note:  The 'PM' command is a privileged command.



     2.5.2.5  XRAY TC AND TD COMMANDS

          The trace channel facility can be used to monitor data to and
     from  a  host  computer,  and delay measurements may be taken from
     input and output response timing.  This  can  be  accomplished  by
     tracing the channel at the Tymnet-II node closest to the host.  In
     some cases, the T-II channel will be located in the same  node  as
     the host.  

          In order to find the channel number on the terminating end of
     the  circuit,  it  is necessary to use a technique called "channel
     chaining".  This technique can  be  used  to  trace  an  all  T-II
     circuit,  one  node  at  a  time.   It is important to distinguish
     between the relative channel number  on  the  link  ("outside  the
     node"), and the absolute channel number ("inside the node").

          The technique is to establish  the  outgoing  channel  number
     from  the  Tymsat or ISIS Consat and follow that channel from node
     to node until the destination interface is reached.  Refer to  the
     earlier  sections  on  circuit  tracing, in order to determine the
     outgoing channel number at the circuit origin.

          The basic steps are as follows:

     1.  At the origin node  in  a  T-II  Solo  Tymsat  /  Consat,  the
         outgoing

              channel number is given in the XRAY 'AS U' display.

              The following is an example of the XRAY 'AS U' display:

         >AS U
         
         0003  PORTS IN USE OUT OF  0256      PEAK = 0056          1200  BPS MAX
         
         PORT  RLA DTR DSR RTS CP DPLX BR  TY  SB  TM  NL  CHAN  LINK  TIME(SEC)  UP
         
           00  FF  FF  FF  00  FF  00  55  70  FF  00  08  0546  2017  00001294   84
           24  FF  FF  FF  00  FF  00  55  70  FF  FF  05  06B8  2717  00019157   68
           32  FF  FF  FF  00  FF  00  55  70  FF  00  02  0554  2017  00007817   63
         
         >

     2.  The absolute channel number for any  link's  relative  channel
         zero  can  be  found  in  the  'CHN0'  field  of the XRAY 'KD'
         display.

              The following is an example of the XRAY 'KD' display:

         >KD 2017
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY            Page 2-30
   NODE/LINK TOPOLOGY


         
         NODE  TPBO  NLWS  SPNM  NCHN  ISEC  NRTR  AMSK
         040F  0810  020C  0800  0080  5560  55E4  00FF
         OSEC  NRMK  NRXM  LRT   LAS   LRM   LAR   NAS
         55F0  5668  5668  1E76  1E76  C001  BFFF  1E76
         BNOD  CHN0  B.PT  E.PT  ACHN  LINES
         040F  0540  0000  0100  0021  03  01

     3.  The relative channel  number  on  the  outgoing  link  can  be
         determined  by subtracting the absolute channel number for the
         link's relative channel zero from the absolute channel for the
         circuit as given in the 'AS U' display.

              The following is an example of calculating  the  relative
         channel number on the link:

         1.  'CHN0' for the link from 2300  to  2017  is  "0540"  (from
             'KD').

         2.  The outgoing absolute channel number for async port 00  is
             "0546" (from the 'AS U' display).

         3.  Therefore:  546 - 540 = 006

         4.  The circuit for async port 00 is going out on  the  link's
             relative channel "0006".

         5.  For an Isis Consat, the outgoing channel number  and  link
             can be determined by using the 'QC' command in Xray, using
             the dispatcher port channel number as an  argument.   (See
             sections  on  circuit  tracing  from  an Isis Consat.) The
             channels for dispatcher service  in  the  Node  Code  slot
             begin  at  hex  60 for most Isis nodes.  (Check the symbol
             'DISZFL' in slot 0 to ascertain this value.)

         6.  Because the relative channel number should be the same for
             a  particular circuit on each end of the link, the circuit
             coming in to node 2017  is  also  on  the  link's  channel
             "0006".


     4.  Next, we must establish the absolute  channel  number  of  the
         incoming  circuit on node 2017.  To do this, add the circuit's
         relative channel number on the link to  the  absolute  channel
         number for the link's channel zero.

              The following is an example of finding channel number  in
         neighbor node:  

         1.  The XRAY 'KD' display for link 2300  (from  2017  to  link
             2300) shows 'CHN0' as "08C0".
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY            Page 2-31
   NODE/LINK TOPOLOGY


         2.  Adding "0006"  to  "08C0"  gives  channel  "08C6"  as  the
             absolute channel number for the circuit in node 2017.

         3.  We can now trace the channel within  the  node  using  the
             XRAY  'QC'  command.   The  'QC'  command will display the
             outgoing channel number in the field "O-CHN".  Using  this
             "O-CHN"  channel  number,  we  can  repeat  the  procedure
             outlined above and trace the circuit into the next node in
             the circuit path.

         4.  The XRAY 'QC' command, using "08C6" as an argument,  gives
             the channel number of the outgoing circuit.

                  The following is an example of the XRAY 'QC' display:

             >QC 8C6
             
             LINK  SP  O-CHN  O-BUF   S-BUF     BB       BE     BF   COUNT   TIME
             2300  03  01B7    09F0    09F4  00065007 000645E3 08C6  05AD  00000D5D
             >

         5.  A 'QC' command using the  'O-CHN'  channel  number  as  an
             argument  will  display  the  outgoing  link number in the
             'LINK' field.

                  The following is an example  of  finding  the  link's
             other node number:

             >QC 1B7
             
             LINK  SP  O-CHN  O-BUF  S-BUF      BB       BE     BF   COUNT   TIME
             2051  03  08C6    09F4   09F0   00063202 000629EB 01B7  0050  00000D8E

         6.  In  this  manner,  the  'QC'  command  serves  to   "chain
             together" the channels in the circuit.  The circuit may be
             traced from node to node, and data may be  traced  on  any
             channel.


     5.  The 'TC Chan 1' command will turn on tracing for a  particular
         channel.   In  and  out  FASTC  times  may  be  compared  when
         displayed using the 'TD' command.  Divide the FASTC  value  by
         600 to establish the count of seconds elapsed.

              The follwing is an example of  character  delay  as  seen
         through the "trace channel" facility:

         >TD
         
         I/O  CHN     TIME
         
         OUT 035C  00047653  42
         OUT 035C  00047683  C5  47
         OUT 035C  00047713  C9
   BASIC NETWORK TROUBLESHOOTING BY LOCAL TOPOLOGY            Page 2-32
   NODE/LINK TOPOLOGY


         OUT 035C  00047746  4E
         OUT 035C  00048450  A0  CF  C6  A0  D4  D2  41  4E  53  41  C3  D4
                             C9  CF  4E  A0  A0  A0  D4  C9  4D  C5  A0  30
                             B8  3A  30  36  3A  B2  39
         OUT 035C  00050338  8D
         OUT 035C  00050353  0A
         
         >

         1.  Subtract the FASTC time in line five  from  that  in  line
             four.   We  see  that 704 FASTC ticks have elapsed between
             the output of logical records.  This amounts  to  slightly
             more than one second.

         2.  Note that in this case the delay is  being  measured  from
             the  outgoing  side of the node.  This suggests an element
             of delay from the network side of the circuit.














                                CHAPTER 3

                      TYMNET INTERNAL DATA PROTOCOL



          In Tymnet, each user's data is packaged into units  known  as
     "logical  records".   These  logical records are placed in packets
     which are known as "physical records".  Physical records are  sent
     over transmission lines from node to node.  At each node, software
     dis-assembles the physical records and  places  each  user's  data
     into  buffers.   The  buffers  are  then  polled,  and the data is
     removed and placed into a new physical record, and  that  "packet"
     is  then  sent  out  on  a link so that user data may continue its
     journey from origin to destination.

          On a link between nodes, each user's data is identified by  a
     unique  identifier  known as a channel number.  These are the same
     as the  port  numbers  referred  to  earlier  in  circuit  tracing
     facilities.  Each channel number is unique within a specific link.
     A link has a minumum of 128 channels and may  increase  from  that
     point.



     3.1  PHYSICAL RECORD

          The Tymnet "physical record"  has  a  specific  format  which
     identifies  it  as  a  Tymnet  packet.   There  are seven bytes of
     overhead associated with each  packet.   They  are,  in  order  of
     appearance in the packet:  

     1.  BORI - first four bits in the packet, may be 0001 or 0010.

     2.  CNT - four bits representing the number  of  8  byte  segments
         which make up the length of the entire packet.

     3.  ACK -  eight  bits  representing  the  acknowledgement  packet
         number being carried to the neighbor node.

     4.  REC - eight  bits  representing  the  record  number  of  this
         packet.

   TYMNET INTERNAL DATA PROTOCOL                               Page 3-2
   PHYSICAL RECORD


          The above four fields are followed by a  variable  number  of
     users'  logical  records.  ( The format of logical records will be
     discussed in the section on channels and buffers.)

     1.  CKSUM - 16 bits of XOR sum.

     2.  CKSUM - 16 bits diagonal.


          Figure 8 is an example of the Tymnet SYNC line packet format.

      ---------------------------           ---------------------------------
     |bori|cnt |  ack   |  rec   |user data|    cksum       |    cksum       |
     | 4  | 4  |    8   |    8   | variable|      16        |      16        |
      ---------------------------           ---------------------------------
         ( h e a d e r )                         ( c h e c k s u m s )

          Figure 8.  TYMNET SYNC Line Packet.



     3.2  PACKET ASSEMBLY-DISASSEMBLY

          The SYNC lines have a  circular  256  byte  buffer  which  is
     scanned  by Engine microcode.  When the normal idle state of all 1
     bits on the SYNC line is  interrupted  by  a  zero  bit  the  BORI
     pattern  is  looked  for by the microcode.  If the BORI pattern is
     recognized, a process called SYLVER is called in to byte align the
     data and verify the checksums.  If the packet is good, it is moved
     into the input sector for packets in the current window.  When the
     packet  has  been  successfully received, the packet is given to a
     routine called RTD, where it is disassembled.

          Synchronous transmission on SIO lines is similar to  that  of
     SYNC  lines,  except that an additional frame is placed around the
     Tymnet physical record.  This framing  uses  HDLC  specifications.
     The  SIO  processor  also performs the tasks of byte alignment and
     checksum verification.

          When a packet arrives on a sync or SIO line, and is  verified
     to  be  a  good packet, it is passed to a routine called RTD where
     the  physical  record  is  disassembled.   As  a  result  of  this
     disassembly, pointer fields which are used to keep track of packet
     activity are updated.  

          Effectively, RTD compares the record  number  in  the  packet
     with  the field pointed to by NRTR (next record to tear).  If they
     match, the record is torn down, and the logical data  is  sent  to
     the  buffers  assigned  to  the  virtual  circuits  carried in the
     packet.  LRT (last record torn), and NRTR are updated.

          The acknowledgement field in the packet being torn is  copied
     into  LAR  (last acknowledgement received).  This field is checked
     and a calculation based on WSIZ (window size), LAR and  LRM  (last
   TYMNET INTERNAL DATA PROTOCOL                               Page 3-3
   PACKET ASSEMBLY-DISASSEMBLY


     record  made)  is made to determine whether to make another packet
     and queue it for transmission.  The calculation is:

          If (LAR + WSIZ) - LRM is greater than zero
          then make a new packet and queue for transmission.

          If the window size is open, a packet is  made  by  a  routine
     called  RMAKE.   Pointers are updated and values checked to verify
     that the packet is ready for transmission.  After  any  record  is
     made, the NRMK (next record to make) field is updated.

          The value of LRT is placed in the ACK  field  of  the  packet
     being  made.   The  value  of  LRT is also placed in the LAS (last
     acknowledgement sent) field.  When a new record is  made  the  LRM
     (last  record  made) field is incremented by one.  LRM is compared
     to (WSIZ + LAR) to see if a new record can be made.

          The sync transmitter checks the RECN of the packet just  made
     to  see  if  it  is  ready to transmit.  If it is, then NRXM (next
     record to transmit) is updated and the new packet is transmitted.

          RMAKE  compares  the  LRT  value  e  value   of   NAS   (next
     acknowledgement  to  send).  If the value of LRT has advanced more
     than two past the value of NAS, a special "null" (no logical data)
     record  will  be made just to keep up with acknowledging reception
     from its neighbor.  RMAKE also sends a Backpressure Relief message
     every half second, which serves to ensure traffic on the link.

          The following is an example of the XRAY 'KD' display:

     >KD 2017
     
     NODE  TPBO  NLWS  SPNM  NCHN  ISEC  NRTR  AMSK
     040F  0810  020C  0800  0080  5560  55E4  00FF
     OSEC  NRMK  NRXM  LRT   LAS   LRM   LAR   NAS
     55F0  5668  5668  1E76  1E76  C001  BFFF  1E76
     BNOD  CHN0  B.PT  E.PT  ACHN  LINES
     04F0  0540  0000  0100  0021  03  01



     3.2.1  LINK ERROR DETERMINATION

          We may be alerted to possible problems on a link by observing
     error  messages  in  the  PROBE Log or in the XRAY Crypto Log.  In
     addition, a four star ERRATE in  the  XRAY  ND  display  indicates
     significant line errors, and warrants further investigation.

     1.  'BAD BORI' - sync scan has  detected  a  change  from  marking
         state, but a BORI was not recognized.

     2.  'SPACING ON INPUT' - a zero bit was detected, but was followed
         a series of zero bits.

   TYMNET INTERNAL DATA PROTOCOL                               Page 3-4
   PACKET ASSEMBLY-DISASSEMBLY


          The XRAY "trace link" facility may be used to closely examine
     the  sync activity on a particular link.  The "OPTION(TLEV)" macro
     must be present in the .TYM file for the node in  order  for  this
     tracing  option  to  be  in  effect.   The 'TM F' command displays
     events pertaining to sync scanning and SYLVER activity.   The  'TM
     B'  command  displays  events  which pertain to packet activity or
     link attach/detach activity.

          The following examples from the XRAY Crypto Log, and from the
     Trace  Link  facility  show  error conditions as they occur on the
     network links.

     >CL 8
     
     130:21:36:10 58FA  41: BAD BORI. COUNT= 000C  LN= 12  NGHBR= 0000
     130:21:40:43 D8FA  41: BAD BORI. COUNT= 001E  LN= 00  NGHBR= 2030
     130:21:40:43 D8FB  43: BAD RECORD NUMBER. COUNT= 0002  LN= 00  NGHBR= 2030
     130:21:40:43 D8FD  49: SPACING ON INPUT. COUNT= 0007  LN= 00  NGHBR= 2030
     130:21:40:43 D8FE  40: TOT PKTS - RECD= 06C1  SENT= 0602  LN= 00  NGHBR= 2030
     130:21:45:16 58F9  41: BAD BORI. COUNT= 0018  LN= 00  NGHBR=  2030
     130:21:45:16 58FA  43: BAD RECORD NUMBER. COUNT= 0002  LN= 00  NGHBR= 2030
     130:21:45:16 58FD  40: TOT PKTS - RECD= 05B9  SENT= 05C4  LN= 00  NGHBR= 2030
     >

          The following is an example of the XRAY Link Trace:

     >TL 3115
     
     TRACE LINK:  3115
     >TM F
     
      EVENT     LINE  HEAD  ACK   RECN      FASTC
     
     GOOD REC    00    20    C5    4F    BC    92F4
     ZERO BIT    00    20    4F    4F    BC    92F4
     DUMMYREC    14    00    00    00    BC    92D7
     ZERO BIT    14    30    69    00    BC    92D7
     DUMMYREC    1A    00    00    00    BC    92D7
     ZERO BIT    1A    30    69    00    BC    92D7
     GOOD REC    00    20    C4    4E    BC    91AD
     
     >TM B
     
      EVENT     VA1   VA2   VA3   VA4      FASTC
     
     PKT TORN    32    10    00    33    D1    B3DA
     PKT MADE    31    20    32    00    D1    B379
     PKT TORN    31    10    FF    32    D1    B29C
     PKT MADE    30    20    31    FF    D1    B239
     
     >TL 0
     
     TRACE LINK:  0000
     
   TYMNET INTERNAL DATA PROTOCOL                               Page 3-5
   PACKET ASSEMBLY-DISASSEMBLY


     >TL 465
     
     TRACE LINK:  0465
     
     >TM F
     
      EVENT     LINE  HEAD  ACK   RECN     FASTC
     
     ZERO BIT    08    68    DF    84    F4    26CE
     ZERO BIT    08    68    DF    84    F4    26CE
     ZERO BIT    08    2E    D7    84    F4    26CE
     ZERO BIT    08    2E    D7    84    F4    26CE
     CKSM ERR    08    51    6A    B5    F4    26C2
     ZERO BIT    08    51    6A    84    F4    26C1
     GOOD REC    08    51    61    B4    F4    2596
     ZERO BIT    08    50    6C    84    F4    174B
     REXMISSN    08    51    49    A1    F4    1725
     ZERO BIT    08    51    49    84    F4    1725
     REXMISSN    08    51    49    A1    F4    16FD
     ZERO BIT    08    51    49    84    F4    16FD
     
     >TM B
     
      EVENT     VA1   VA2   VA3   VA4      FASTC
     
     PKT MADE    B5    26    B6    02    D2    6B3B
     PKT TORN    B5    66    61    08    D2    6AB9
     PKT MADE    B4    26    B5    01    D2    69FA
     PKT TORN    B4    66    50    08    D2    698C
     
     >TL 0
     
     TRACE LINK:  0000
     
     >



     3.3  CHANNEL AND BUFFER STRUCTURE

          The Tymnet  Engine  is  capable  of  supporting  up  to  8192
     channels,  or  circuits,  per  link.   When link initialization is
     complete, the link is assigned 128 channels.  If traffic increases
     over  that  link, it can receive another 128 channels in a process
     called "link bubble".  This process may continue until the maximum
     number of channels have been assigned for that link.

          As traffic decreases over a given link, the channel  area  is
     consolidated and a "link shrink" is effected, allowing the node to
     reduce the fragmented use of the permuter table (channel  pointer)
     area.
   TYMNET INTERNAL DATA PROTOCOL                               Page 3-6
   CHANNEL AND BUFFER STRUCTURE


          The following is an example of the XRAY  Crypto  log  showing
     link bubble and shrink:

     >CL 0C
     
     159:11:02:29 4006  40: TOT PKTS - RECD= 047D  SENT= 099F  LN= 04  NGHBR= 2003
     159:11:02:59 87EB  22: LINK BUBBLE - NCHN= 0256   NGHBR= 2052
     159:11:04:14 3740  21: LINK SHRINK - NCHN= 0128   NGHBR= 2020
     159:11:07:02 BFFE  41: BAD BORI. COUNT= 002A  LN= 04  NGHBR= 2003
     159:11:07:02 C003  40: TOT PKTS - RECD= 05B0  SENT= 0ACA  LN= 04  NGHBR= 2003
     159:11:15:15 432F  04: LINE DETACHED - REASON= 01  LN= 26  NGHBR= 2217
     159:11:15:58 A908  16: LINE ATTACHED - NLAT= 02  LN= 26  NGHBR= 2217
     159:11:38:40 2239  22: LINK BUBBLE - NCHN= 0384   NGHBR= 2217
     159:13:05:26 CB9A  22: LINK BUBBLE - NCHN= 0256   NGHBR= 3330
     159:13:09:54 3FFF  41: BAD BORI. COUNT= 0029  LN= 04  NGHBR= 2003
     159:13:09:54 4004  40: TOT PKTS - RECD= 028D  SENT= 0283  LN= 04  NGHBR= 2003
     159:13:11:14 FA2D  22: LINK BUBBLE - NCHN= 0640   NGHBR= 2217
     
     >

          Each link references its channels (circuits)  in  a  relative
     sense, from the beginning of its channel (or permuter table) area,
     beginning with relative channel zero (hex).

          Each link's relative channel  zero  actually  corresponds  to
     some  absolute  channel  number  in the node.  The 'KD' display in
     XRAY will list the node's absolute channel number for  the  link's
     relative channel zero.

          The packet disassembly routine, RTD,  places  data  for  each
     virtual  circuit  on  the link in a "buffer".  The 'CHAN' field in
     the logical record serves as an index  into  a  "permuter  table".
     The  content  of  the  permuter  table entry for that channel is a
     pointer to the "buffer descriptor" for the virtual circuit.  

          Figure 9 is an example of a logical record.

         -------- -------- --------------------------------------
        | len  1 | chan   | len  1 bytes of data ................|
         -------- -------- --------------------------------------

          Figure 9.  Logical Record.
   TYMNET INTERNAL DATA PROTOCOL                               Page 3-7
   CHANNEL AND BUFFER STRUCTURE


          Figure 10 is a diagram of virtual circuit channels and buffer
     pairs.

     link 2300                 node  2017                 link 2051
     relative   ______________________________________    relative
       chan 0  |0770|                            |019C|   chan 0
               |    |       02B0                 |    |
               |    |        ____________        |    |
       <----->[-]--[-]----->|bb|be|cnt|bf|->--*  |    |
       chan 9  |0779| \     |------------|     \ |01A2|   chan 5
               |    |  *--<-|bf|cnt|be|bb|<-----[-]--[-]<----->
               |    |        ------------        |    |
               |    |                02B4        |    |
               |____|____________________________|____|

          Figure 10.  Virtual Circuit Channels and Buffer Pairs.

          The permuter table entry for  the  virtual  circuit  actually
     points  to  a  "buffer  descriptor".   The entry in the per- muter
     table is called the "buffer index".

          Buffers, and therefore buffer descriptors,  are  assigned  in
     pairs for each virtual circuit - one "buffer" for each direction.

          Buffer indices can be seen in the XRAY 'QC' display as either
     'O-BUF'  or  'S-BUF'  depending  on  the  direction of flow in the
     circuit.   Buffer  descriptor  fields  are:   BCT  -   approximate
     character count in the "buffer".  BF - absolute channel number for
     the destination port for this direction of  the  virtual  circuit.
     BB  -  beginning address in bufferlet area where actual first data
     character is stored.  BE - end address  in  bufferlet  area  where
     last actual data character is stored.

          The "buffer" for the data in the virtual circuit is  actually
     a  series  of "bufferlets" which are chained together by pointers.
     Bufferlets can be acquired by the "buffer" as they are  needed  to
     store  data characters arriving on the circuit.  Bufferlets are 16
     bytes long, and contain 14 bytes of data and two bytes of  pointer
     to  the  next  bufferlet  to  use.   Bufferlets are taken from and
     returned to  the  "free  pool"  as  needed.   Bufferlets  are  not
     necessarily  contiguous,  and therefore, neither is the storage of
     actual data characters.   This  technique  is  a  resource  saving
     technique for the node.  



     3.3.1  CHANNEL PERFORMANCE MONITOR - XRAY

          We can observe data arriving at a Tymsat by  reading  buffers
     associated  with the virtual circuit.  First determine the channel
     number associated with the async port.  Then, using the XRAY  'QC'
     command,  obtain  the  buffer number of the buffer which is filled
     with data from the channel.  Since we  wish  to  observe  incoming
     data,  we use the 'O-BUF' as an argument to the XRAY 'RB' command.
   TYMNET INTERNAL DATA PROTOCOL                               Page 3-8
   CHANNEL AND BUFFER STRUCTURE


     Hex characters are displayed.

          The following is an example of the XRAY 'RB' command used  to
     read a circuit buffer:

     >AS 11
     
     0022  PORTS IN USE OUT OF  0064      PEAK = 0030          4800  BPS MAX
     
     PORT  RLA DTR DSR TRS CP DPLX BR  TY  SB  TM  NL  CHAN  LINK  TIME(SEC)  UP
     
       11  FF  FF  FF  00  FF  00  BB  54  FF  FF  01  078D  2034  00017400   04
     
     >QC 78D
     
     LINK  SP  O-CHN  O-BUF   S-BUF     BB       BE     BF   COUNT   TIME
     2034  03  0049    021C    0218  00000000 00000000 078D  0000  00004403
     
     >RB 21C
     2D  49  49  20  54  45  43  48  4E  4F  4C  4F  47  59  2E  20
     20  56  45  52  49  46  59  20  4E  45  54  57  4F  52  4B  0D
     0A  20  20  20  20  20  20  20  20  20  20  20  50  41  52  41
     4D  45  54  45  52  53  20  44  59  4E  41  4D  49  43  41  4C    ETC.

          In a passthrough node, we can monitor the data flow  in  both
     directions  using  either  the channel trace facility, or the read
     buffer facility.  If the link's channel zero  is  known,  and  the
     relative incoming channel is known, we can find channel as well as
     buffer numbers, using the XRAY 'QC' command.  We can then use  the
     'RB' command or the 'TC' command to monitor the data.  

          The following is an example of monitoring passthrough traffic
     on a circuit:

     >QC 779
     
     LINK  SP  O-CHN  O-BUF   S-BUF     BB       BE     BF   COUNT   TIME
     2300  01  01A2    02B0    02B4  00063202 000629EB 0779  0050  000003EB
     
     >QC 1A2
     
     LINK  SP  O-CHN  O-BUF   S-BUF     BB       BE     BF   COUNT   TIME
     2051  01  0779    02B4    02B0  00000000 00000000 01A2  0000  000003CF
     
     >TC 20 0
     
     
     >TC 1A2 1
     01A2
     
     >TC 779 1
     01A2  0779
     
     >TD
   TYMNET INTERNAL DATA PROTOCOL                               Page 3-9
   CHANNEL AND BUFFER STRUCTURE


     
     I/O  CHN    TIME
     
     OUT 01A2  00063172  70  70  70  70  70  70  70  70  70  70  70  70
                         70  70  70  70  70  70  70  70  70  70  70  70
                         70  70  70  70  70  70  70  70  70  70  70  70
                         70  70  70  70  70  70  70  70  70
     IN  0779  00063622  70  70  70  70  70  70  70  70  70  70  70  70
                         70  0D  0A  70  70  70  70  70  70  70  70  70
                         70  70  70  70  70  70  70  70  70  70  70  70
     OUT 01A2  00063625  70  70  70  70  70  70  70  70  70  70  70  70
                         70  0D  0A  70  70  70  70  70  70  70  70  70
                         70  70  70  70  70  70  70  70  70  70  70
     
     
     >



     3.4  THROUGHPUT CLASS AND BACKPRESSURE

          Each user circuit is assigned a "throughput class"  when  the
     circuit  is  built.   For a terminal user, the throughput class is
     assigned at log-in.  The default throughput class for a  300  baud
     terminal  is  64  characters  per  second.  The default throughput
     class for a 1200 baud terminal is 160 characters per second.  

          The terminal user may override the default  throughput  class
     by  entering  control  characters  at  the  time of log-in.  These
     control characters and their associated throughput classes are:

     1.  cntrl-A 20hex/hsec = 64 chars/sec

     2.  cntrl-B 50hex/hsec = 160 chars/sec

     3.  cntrl-C 100hex/hsec = 512 chars/sec

     4.  cntrl-D 400hex/hsec = 2048 chars/sec


          Basically, throughput class indicates the maximum buffer size
     that  any  circuit may have in any single node in its path through
     the network.

          The backpressure mechanism functions on a per virtual circuit
     basis.    Each  virtual  circuit  has  a  throughput  class.   The
     transmitter for each node knows how many characters  to  send  for
     each  virtual circuit.  If this limit is reached, transmission for
     that circuit stops.  The transmission is allowed  to  start  again
     when the circuit receives "backpressure relief".

          Backpressure relief is received from the neighbor node toward
     which  the  transmitter wants to transmit.  A "backpressure relief
     message" is sent by the neighbor node which contains  the  channel
   TYMNET INTERNAL DATA PROTOCOL                              Page 3-10
   THROUGHPUT CLASS AND BACKPRESSURE


     numbers  of  all  virtual  circuits  which  may begin transmitting
     again.

          In the receiving node, each channel is checked to see how the
     data  is  coming  in  to  it.  If the channel is receiving data in
     logical records of four or  more  bytes  each,  it  is  marked  as
     "gushing"  and its backpressure is relieved every half second.  If
     the data is being received in logical records of  less  than  four
     bytes,  the  channel is marked as "trickling" and its backpressure
     is relieved every two seconds.

          Versions 5.02 and greater assign a 'trickle' value  based  on
     the  throughput  class  of  the  circuit  so that a channel can be
     determin-- ed to be gushing or trickling on a  per  circuit  basis
     rather  than  on a per node basis.  These values can be changed by
     defining the parameter in the TYMFILE.  The default values are  as
     follows:  

                           A 
                 TRKLVA = 1 for gouged circuit.  
                           B
                 TRKLVB = 2 for gouged circuit.  
                           C 
                 TRKLVC = 3 for gouged circuit.  
                           D 
                 TRKLVD = 4 for gouged circuit.

          The following is an example of the XRAY 'QC' command  showing
     throughput class ('SP'):

     >QC 799
     
     LINK  SP  O-CHN  O-BUF   S-BUF     BB       BE     BF   COUNT   TIME
     2300  01  01A2    0280    0284  00063202 000629EB 0779  0050  000003EB
     
     >

          In Tymnet-I technology, the backpressure control record was a
     bit  array  which  contained a bit set for each channel to receive
     backpressure relief.  In Tymnet-II  technology  the  "backpressure
     control record" travels from node to node on an "internode control
     message".

          The internode control message travels as a logical record  in
     a  packet, except that the high order bit in the first byte of the
     logical record is set on.  The backpressure control record has the
     two  high  order  bits  set,  then a five bit field containing the
     count of channels which are included in  the  backpressure  relief
     message, and finally followed by the hex channel numbers which are
     to receive backpressure relief.  












                                CHAPTER 4

                          ENGINE CRASH ANALYSIS



          This package contains information on dump  analysis  programs
     for  most  types  of  Engines  in  use  in the network.  The first
     portion is the file (ENGDIAG)ENGDMP.DOC and a sample run  of  that
     file.   The  second  portion is the file (ENGDIAG)T2SOLO.DOC and a
     sample run of that file.  Both of these are NAD command files.  In
     order  to  use  them effectively, you must also have a copy of the
     TYMNET ENGINE POCKET GUIDE.

          Which file do you use for a particular dump??  ENGDMP is used
     for all ISIS machines, TYMNET I or TYMNET II, running version 4.11
     or later of ISIS kernel, and for version 5.0 and above  of  TYMNET
     II  SOLO  code.   Also,  although  you will probably never see it,
     version 4.51 and above of TYMNET I ENGINE remote code.  

          T2SOLO is used for all  TYMNET  II  SOLO  machines,  with  or
     without async, running version 4.00 and all revisions of version 4
     solo node code.  There is no method fo analyzing dumps of TYMNET-I
     remote code.



     4.1  ISIS AND NODE CODE CRASH ANALYSIS

          This section describes the common crash table for all  TYMNET
     Engine ISIS and Node Code software.  The supported versions are:

     1.  TYMNET I REMOTE -    451 AND ABOVE

     2.  TYMNET II SOLO -    4??  AND ABOVE

     3.  ISIS KERNEL - 4.11 AND ABOVE


          The table is organized into three parts.  First, there  is  a
     crash  table  header, which contains general information about the
     node.  Second there is a crash table summary, which contains basic
     information  for the last 16 crashes.  Third and last there is the
     detailed crash table, which will contain extensive  data  for  the
     first  crash  of  the  machine  (excluding  power fails and manual
     restarts) and the the last crash (again no power fails  or  manual
   ENGINE CRASH ANALYSIS                                       Page 4-2
   ISIS AND NODE CODE CRASH ANALYSIS


     restarts).

          Physical location 0006c  will  always  contain  the  physical
     address of the beginning of the the crash table.

     CRASH TABLE HEADER:
     
     NODENUMBER      HS      1       :MACHINE NODE NUMBER
     NODETYPE        HS      1       :NODE TYPE (SEE TABLE BELOW)
     TABVER          HS      1       :VERSION OF CRASH TABLE
     CODVER          HS      1       :VERSION OF CODE
     TAKETIME        WS      1       :REAL TIME OF FIRST TAKE OVER (GMT)
     CRCNT           HS      1       :CURRENT CRASH COUNT
     
     CRASH SUMMARY:
     
     CRCNT           HS      1       :CRASH COUNT FOR ENTRY
     CRID            HS      1       :CRASH ID (SEE TABLE BELOW)
     CRPSD           WS      2       :CRASH PSW AND PC
     CRTIME          WS      1       :REAL TIME OF CRASH (GMT)
     
     DETAIL TABLE:
     
     CRCNT           HS      1       :CRASH COUNT FOR ENTRY
     CRID            HS      1       :CRASH ID (SEE TABLE BELOW)
     CRPSD           WS      2       :CRASH PSW AND PC
     CRTIME          WS      1       :REAL TIME OF CRASH (GMT)
     REGS0           WS      $0 10   :REGISTER SET 0
     REGSF           WS      $0 10   :REGISTER SET F (OR CURRENT SET)
     MACREGS         HS      $0 30   :MAC REGISTERS (LOCATIONS 300-35F)
     LASTSLOT        HS      1       :LAST SLOT EXECUTED (FILLED BY ISIS ONLY)

          The summary table is a push  down  stack,  meaning  that  the
     first  entry  is  for  the  last  crash,  the  second entry is the
     previous crash and so on.   The  crash  table  will  not  be  over
     written  by  repetitive loads and the software will not initialize
     it.  So if the macine is reloaded with the same code we can  still
     read out old crash information.

          The taketime label will contain the real time  value  of  the
     first  takeover  (in  GMT)  after  a  reload.   However upon first
     startup the value will be set to hex 80000000.  Also  any  crashes
     occurring  before the first takeover will be the number of seconds
     plus the initial value.  All valid times will not  have  the  high
     order bit on.



     4.1.1  CRASH ID'S

          Crash codes will be one  byte,  with  the  high-order  nibble
     designating the general crash type and the low-order nibble giving
     additional information.
   ENGINE CRASH ANALYSIS                                       Page 4-3
   ISIS AND NODE CODE CRASH ANALYSIS


               2x - Parity error
               20 - Non-DMA
               21 - DMA
     
               3x - Unexpected interrupt
               30 - Non-microcode device
               31 - Microcode-controlled device
     
               4x - Instruction failure
               40 - Illegal instruction (memory location bad)
               41 - Legal illegal instruction (memory location OK)
               42 - Instruction malfunction (e.g., illegal result)
     
               5x - MAC error
               50 - Protection violation
               51 - Out of bounds
               52 - DMA time-out
               53 - Presence error
               54 - Write interrupt
               55 - Fetch error
     
               6x - Software-detected errors (common)
               60 - Illegal SVC
               61 - Dispatcher detected error
               62 - Hardware consistency error
               63 - Software consistency error
               64 - GCI crash - empty buffer
               65 - GCI crash - illegal buffer index
               66 - Bufferlet error - illegal free list pointer
     
               7x - Software-detected errors (code-dependent)
     
               8x - Configuration error
               80 - Not enough memory
               81 - Required device not assigned
               82 - Wrong device type
     
               9x - Device failure
               90 - Busy/not ready
               91 - Status error
               92 - Missing interrupt
     
               Ax-Fx - Reserved for future use.

          The above crash codes will be used in  the  CRID  (crash  ID)
     field  of  the  crash table, for crash reports to the SUP log, and
     for console displays.   The  format  of  console  displays  is  as
     follows:

                +----+----+----+----+----+----+----+----+----+
                                                 
                      D   E   A   D   t   t   c   c ^
                +----+----+----+----+----+----+----+----+----+
   ENGINE CRASH ANALYSIS                                       Page 4-4
   ISIS AND NODE CODE CRASH ANALYSIS


          Where DEAD indicates a crash, tt defines the node  type,  and
     cc is the crash code.  



     4.1.2  DUMP ANALYSIS - ENGDMP

          To run ENGDMP, invoke the NAD program and use the ;X  command
     to execute the NAD commands file (ENGDIAG)ENGDMP.

             -R NAD<cr>
             xxxxxx (version  )
             ;X    (ENGDIAG)ENGDMP<cr>

          The program is self-prompting from this point on.  Example:

     -r nad
     062382
     ;x   (engdiag)engdmp
     
     ;; ENTER FILE NAME OF THE DUMP (FOLLOWED BY A CONTROL D)
     %F   (netcon)nd2775.dmp
     
     ;G
     
     Data ranges read:
     
     0-7FFE 7FFF-0FFFD 0FFFE-17FFC 17FFD-1FFB 1FFC-27FFA 27FFB-2FF9
     2FFA-3007
     
     ;4   6C/   630   ;/   5FD0007
     PHCRTB:   .
     ;; CRASH TABLE STARTS AT
     PHCRTB=   630
     ;; CRASH FOR NODE
     PHCRTB+80/  2775
     ;; NODE TYPE
     ;;  0 - TYMNET I REMOTE
     ;;  7 - ISIS NODE
     PHCRTB+$A2/   7
     ;;SOFTWARE VERSION
     PHCRTB+$A6/  502
     ;; MACHINE CRASH COUNT
     PHCRTB+$814/   2
     ;;
     ;; SUMMARY TABLE
     ;;
     ;;CRCT CRID CRASH PSD      TIME
     8%2  PHCRTB+0E,PHCRTB+10C/
        2  452    0 67F2    1 3D28 110D 2A7F
        1    0    0 0B98    0    0 8000    0
        0    0    0    0    0    0    0    0
        0    0    0    0    0    0    0    0
        0    0    0    0    0    0    0    0
   ENGINE CRASH ANALYSIS                                       Page 4-5
   ISIS AND NODE CODE CRASH ANALYSIS


        0    0    0    0    0    0    0    0
        0    0    0    0    0    0    0    0
        0    0    0    0    0    0    0    0
        0    0    0    0    0    0    0    0
        0    0    0    0    0    0    0    0
        0    0    0    0    0    0    0    0
        0    0    0    0    0    0    0    0
        0    0    0    0    0    0    0    0
        0    0    0    0    0    0    0    0
        0    0    0    0    0    0    0    0
        0    0    0    0    0    0    0    0
     
     ;;
     ;; DETAIL TABLE
     ;;
     ;; FIRST FATAL CRASH
     ;;
     ;;CRCT CRID CRASH PSD        TIME
     8%2   PHCRTB+10E,PHCRTB+11C\
        2  452    0 67F2    1 3D28 110D 2A7F
     
     ;; REGISTER SET 0
     8%4   PHCRTB+11E,PHCRTB+15C\
        0    0    0    0    0    0    0    0
        0    0    0    0    0    0    0    0
     
     ;; REGISTER SET F (OR CURRENT SET)
     8%4   PHCRTB+15E,PHCRTB+19C\
            80     59B4        0  2547690     1560  6A52190  7058C90       0
             0        0        0        0        0        0     67F2   13D28
     
     ;;
     ;; MAC SEGMENTATION REGISTERS
     8%4   PHCRTB+19E,PHCRTB+1DC\
      163E090  7E3F730  2547690  8449C90  6A52190  7058C90        0        0
            0        0        0        0        0        0   13DEF0   4005B0
     
     ;;
     ;; MAC STATUS REGISTERS
     ;; (340,344,348,34C)
     4%4   PHCRTB+1DE,PHCRTB+1EC\
             0     0B32   0FFFFE     0B32   
     
     ;;
     ;; DETAIL TABLE
     ;;
     ;; LAST FATAL CRASH
     ;;
     ;;CRCT CRID CRASH PSD      TIME
     8%2   PHCRTB+200,PHCRTB+20E\
            0        0        0        0        0        0        0        0
     
     
     ;; REGISTER SET 0
   ENGINE CRASH ANALYSIS                                       Page 4-6
   ISIS AND NODE CODE CRASH ANALYSIS


     8%4   PHCRTB+210,PHCRTB+24E\
         0    0    0    0    0    0    0    0    
         0    0    0    0    0    0    0    0
     
     ;; REGISTER SET F (OR CURRENT SET)
     8%4   PHCRTB+250,PHCRTB+28\
            0        0        0       0       0        0       0       0
            0        0        0       0       0        0       0       0
     
     ;;
     ;; MAC SEGMENTATION REGISTERS
     8%4   PHCRTB+290,PHCRTB+2CE\
            0        0        0        0       0      0        0        0        
            0      0        0        0       0      0        0        0
     
     ;;
     ;; MAC STATUS REGISTERS
     ;; (340,344,348,34C)
     
     4%4   PHCRTB+2D0,PHCRTB+2DE\
            0        0        0        0
     ;;
     ;;
     ;; FOR MORE INFORMATION ABOUT THE ABOVE DATA PULL THE FILE
     ;; (ENGDIAG)ENGDMP.DOC
     ;;
     ;; USE A  %Q  TO EXIT.
     %q
     EXIT



     4.1.3  DUMP ANALYSIS - T2SOLO

          There is a new file available that allows for  easy  analysis
     of  TYMNET  II  solo  dumps.   Like  ENGDMP, it is self prompting,
     asking  for  the  filename  of  the  machine  code  running   (ie,
     ND2773.BND)  terminated  with  a ^D (not a carriage return).  Then
     enter the dump filename.  The file will the automatically  request
     information  be  displayed  from the dump file, with comments when
     applicable.

          To execute, run NAD as before  and  use  the  ;X  command  to
     execute your command string.  Example:

     -R NAD
     
     ;X    (ENGDIAG)T2SOLO    (CARRAGE RETURN)

          An example of the type of display:

     PHCRAD\   0
     PHCRAD+2\   8A
     PHCRID\   8
   ENGINE CRASH ANALYSIS                                       Page 4-7
   ISIS AND NODE CODE CRASH ANALYSIS


     PHCRID+2\   2

          For example, this is a display of the PHCRAD, of which a  key
     is  given  above.  Look the 8A up in the table and it will say MAC
     interrupt.  Example of entire operation:

     -r nad
     062382
     ;x   (engdiag)t2solo
     
     ;;ENTER FILENAME FOR T-II SOLO [.BND] (END WITH CONTROL-D)
     %F   (tymisis)nd2355.bnd  
     
     %G
     
     ;;ENTER FILENAME OF DUMP (END WITH CONTROL-D)
     %F   (netcon)nd2355.dmp  
     
     ;G
     Data ranges read:
     0-7FFE 7FFF-0FFFD 0FFFE-17FFC 17FFD-1FFFB 1FFFC-27FFA 27FFB-2FFF9
     2FFFA-30007
     
     ;;PHCRAD     :  00 - MANUAL RESTART
     ;;              84 - MACHINE MALFUNCTION
     ;;              86 - ILLEGAL I/O INTERRUPT
     ;;              88 - ILLEGAL INSTRUCTION
     ;;            8A - MAC INTERRUPT
     ;;            8C - POWER UP
     ;;            8E - MAC/DMA TIMEOUT
     ;;
     ;4    SOPH+20,SOPH+22\
     PHCRAD\    88
     
     ;;PHCRID    : 00 - MANUAL RESTART
     ;;            01 - POWER FAILURE
     ;;            02 - OUTPUT WAIT
     ;;            04 - ILLEGAL INSTRUCTION
     ;;            05 - MAC/DMA TIMEOUT
     ;;            08 - MAC INTERRUPT
     ;;            10 - OOPS CALLED
     ;;            80 - NO SUCH PROCESS
     ;;            0F - # OF MAC REGISTERS IN USE
     ;;           800 - START OF PRIVILEDGED CODE
     ;;
     SOPH+24,SOPH+25
     PHCRID\   4
     
     ;;CRASH SOUNT IS EQUAL TO PHCRID+2
     ;;
     SOPH+26,SOPH+27
     PHCRID+2\   OC
     
     ;;CRASH REGISTERS
   ENGINE CRASH ANALYSIS                                       Page 4-8
   ISIS AND NODE CODE CRASH ANALYSIS


     ;;
     ;4   S0PH+28,S0PH+66\
     PHERRG\   1
     PHERRG+4\   5
     PHERRG+8\   80000000
     PHERRG+0C\   178C
     PHERRG+10\   1AE
     PHERRG+14\   1
     PHERRG+18\   700
     PHERRG+1C\   0FFFFAA85
     PHERRG+20\   29EC
     PHERRG+24\   135EC
     PHERRG+28\   79
     PHERRG+2C\   7
     PHERRG+30\   4C83
     PHERRG+34\   5664
     PHERRG+38\   24
     PHERRG+3C\   4498
     
     ;;VALUE OF LAST PARITY ERROR DURING DUMP
     ;;
     ;4   348,34A\
     ANIZFL+8\   87802
     
     ;;ILLEGAL INSTRUCTION OLD PSW
     ;;
     ;4   S0PH+6C,S0PH+72\
     PHILIP\   1
     PHILIP+4\   18694
     
     ;;MAC INTERRUPT OLD PSW
     ;;
     ;4   S0PH+74,S0PH+7A\
     PHMACP\   67F8
     PHMACP+4\   2FFFE
     
     ;;MAC INTERRUPT STATUS REGISTERS (340,344,348,34C)
     ;;   (SAVED AT TIME OF ERROR)
     ;;
     ;4   S0PH+7C,S0PH+8A\
     PHSMAC\   11
     PHSMAC+4\   2D826
     PHSMAC+8\   0F0200
     PHSMAC+0C\   0D5026
     
     ;;COUNT OF ILLEGAL DEVICE INTERRUPTS
     ;;
     S0PH+8C,S0PH+8D\
     PHMALP\   0
     
     ;;DEVICE ADDRESS FROM LAST ILLEGAL DEVICE INTERRUPT
     ;;
     S0PH+8E,S0PH+8F\
     PHMALP+2\   0
   ENGINE CRASH ANALYSIS                                       Page 4-9
   ISIS AND NODE CODE CRASH ANALYSIS


     
     ;;REFER TO THE ENGINE POCKET GUIDE FOR A MORE DETAILED DESCRIPTION
     ;;OF THE INTERRUPT REGISTERS.
     ;;
     ;;DUMP ANALYSIS COMPLETE. USE %Q TO EXIT. 
     %q
     EXIT
     -



     4.2  SLOT CRASH ANALYSIS

          A slot crash can be analyzed via  NAD/DDT  either  while  the
     slot is halted or by examining the crash table even after the slot
     has automatically restarted.  Slot crashes may be of two different
     varieties:   crash  and remain halted until manually restarted, or
     crash and automatically restart.   Even  those  crash  types  that
     automatically  restart may be declared to remain halted by setting
     a slot statement called CRSTOP.  If CRSTOP is equal to 1, the slot
     will not restart.

          Following is an example of a crash  examination.   The  steps
     involved  show what information may be gathered for later use.  It
     starts knowing that the slot has crashed,  not  necessarily  aware
     the slot has again restarted.

     1.  Run NAD, bring in both the binary and  symbol  table  for  the
         file running in the slot at the time of crash.  (%F,%G,;G)

     2.  Build a NAD auxiliary circuit to the slot.  (;C)

     3.  Request your slot number.  (;R)

     4.  If there is a message printed  out  upon  entering  the  slot,
         write it down for possible later reference.

     5.  Find the ISIS and slot code versions.  (::?VERN)

     6.  Print a history of activity in the ISIS node to  determine  if
         there have been previous crashes.  It may be crashing over and
         over again.  (::?HIST)

     7.  Try to define external circumstances that may have contributed
         to  the  crash.   Maybe  a  messy  host  line,  maybe  a modem
         disconection.

     8.  See if the slot is  still  halted,  could  be  either  because
         CRSTOP  is  set  or  the crash type would not allow a restart.
         (::?HOST)

     9.  If the slot is halted, log off DDT and NAD and use  LOADII  to
         dump the slot.
   ENGINE CRASH ANALYSIS                                      Page 4-10
   SLOT CRASH ANALYSIS


    10.  Attach the symbol table to the slot dump with the NAD commands
         file (TYMNET)DUMP.CMD.

    11.  After the dump is complete, log back into the  slot  with  DDT
         and restart the slot manually.  (:E)

    12.  If the slot is running (not halted permanently)  but  crashing
         and  restarting  at  regular  intervals  (probably less than a
         minute), halt the slot manually and then dump  the  slot  with
         LOADII, etc.  This time when you manually restart, watch to be
         sure the looping crash does not re-appear.  If it  does,  halt
         it again.

    13.  If the slot is running and appears  to  be  stable,  there  is
         still  information  to  be gathered from the crash table - the
         window into the  last  crash.   Read  the  crash  table.   (:R
         CRAT,4C)

    14.  Log off DDT and NAD.




     4.2.1  SLOT CRASH TABLE

          The slot crash table contains the following fields:

            CRAT  :  Start of Crash Table area                       (4C)
            FIELDS
            ------
            CRSHCT : Crash count...how many times slot has crashed   (2)
            CRASHC : Crash Code (init'd to manual restart)           (2)
            CPOINT : where crash occurred                            (4)
            CFROM  : where crash was called from                     (4)
            CRREG  : crash register save area                        (40)

          Depending on the CRASH library package used in the  interface
     code, these may be labels that can be read directly:

                                   :R CRSHCT,2

     Where the label is CRSHCT and the field is two bytes long.  Or the
     field  may  mean a portion of the table and is meant to be read in
     displacement from the beginning of the table:

                                 :R CRAT+CPOINT,4

     The field is a word in length or four bytes.  You will  always  be
     safe reading the entire crash table:

                                    :R CRAT,4C

     The length of all the fields added together is hex 4C.
   ENGINE CRASH ANALYSIS                                      Page 4-11
   SLOT CRASH ANALYSIS


     4.2.2  CRASH CODES

          Each module of code in the interface is likely  to  have  its
     own  subset  of crash codes.  It would be impossible to publish an
     up-to-date list of all the codes in each interface,  as  they  are
     added  and  deleted  to  enhance  the  test  capabilities  of  the
     interface.  Following are a  couple  lists  of  the  modules  that
     remain static in most of the TYMNET interfaces.  These crash codes
     will not be used by other modules.

          First the CRASH library  package,  the  major  controller  of
     crashes:

        14  -  Protection violation
        13  -  System crash
        12  -  Illegal SVC
        11  -  Illegal instruction
        10  -  Dispatcher crash
        01  -  Manual start
        00  -  Power failure

          The  BUFFER  library  package   is   used   in   asynchronous
     interfaces,  handling  the  buffering  of  data  between  the ISIS
     Dispatcher and the async handlers.

        0D  -  Buffer no. out of range on entry to *EMPTY*
        06  -  Unreasonably fast storage drain of buffer
        05  -  Buffer no. out of range on entry to *WCI*
        04  -  Buffer no. out of range on entry to *MCI*
        03  -  Buffer no. out of range on entry to *GCI* or buffer empty



     4.2.3  CRASH TABLE WITHOUT NIB FILE

          The following procedure may be used to locate the crash table
     even  if  the  symbol table is not located.  A procedure like this
     would be used if you were unsure which file was  last  loaded,  or
     the file you wish is on an unavailable system.

          The method locates the starting  address  of  the  executable
     code,  and assumes the crash library is the first module executed.
     It also assumes the crash address is in  a  static  place  in  the
     library.   This is a lot to assume, since there are no conventions
     dictating which module should be executed first or  governing  the
     library   package   and  its  possible  modifications.   Try  this
     procedure with caution.

          For this procedure, a direct login to  DDT  is  the  easiest.
     Example:

        *R E0050,4           : get the slot execution start address
        E0050  xxxA  AAAA        : AAAAA is the start address
     
   ENGINE CRASH ANALYSIS                                      Page 4-12
   SLOT CRASH ANALYSIS


        *R AAAAA,8           : get the crash code address
        AAAAA  2401 4000 YYYY zzzz  : YYYY is the crash code address
     
        *R HHHH,4C           : HHHH is equal to YYYY-2
        At this point, the crash table will be displayed.












                                CHAPTER 5

                                APPENDICES



   APPENDICES                                                  Page 5-2
   ISIS DISPATCHER MESSAGES


     5.1  ISIS DISPATCHER MESSAGES

                      APPENDIX I - ISIS DISPATCHER MESSAGES


                  ********** CIRCUIT ISIS MESSAGES  **********
          
          - Needle         00  :leng|..invoice number...|
                                    |Dest Host!Orig Node|
                                    |Orig Host!Orig Port|
                                    |----:----!----!TPC.|
                                    |HIQ=8000.!TID.:Size|
                                    |User Name .....
          
          * Data           01  :Data|
             :
          * Data           9D  :Data ......
          
          + Detach         9E  :----|
          * Zap            9F  :----|
          * Set BP         A0  :----|
          * Release BP     A1  :----|
          * Gobbler        A2  :----|
          * Flush Input    A3  :----|
          * Black Ball     A4  :----|
          * Gray Ball      A5  :----|
          * Enter DEM      A6  :----|
          * Leave DEM      A7  :----|
          * Enter Trans    A8  :----|
          * Leave Trans    A9  :----|
          * Green Ball     AA  :----|
          * Red Ball       AB  :----|
          * Yellow Ball    AC  :----|
          * Orange Ball    AD  :----|
          * Break Begin    AE  :----|
          * Hang up        AF  :----|
          * Query Term.    B0  :tpar|
          * Set Terminal   B1  :tpar|valu:----!----:----|
          - Pseudo Need.   B2  :Key.|Local.Key!----:----|
          + Logon Char     B3  :Char|
          - Logon status   B4  :lsta|
          - Logon failed   B5  :lerr|
          - Logon OK       B6  :IIX.|..invoice number...|
                                    |Orig Host!----:----|
          + Accounting     B7  :----|0Emg:..Acct Value..|
          * Super Hang     B8  :----|
          * Set xmit lim   B9  :limt|
          * Break end      BA  :----|
          + Zap Ack        BB  :----|
          * Ent Alt Dev    BC  :----|
          * Lev Alt Dev    BD  :----|
          + Zap W/Reason   BE  :resn|
          * SIIX           BF  :.00.|
          * TIIX           C0  :.00.|
   APPENDICES                                                  Page 5-3
   ISIS DISPATCHER MESSAGES


          
                Where    tpar : 0 = echo on/off  (1)
                                1 = echo TAB     (1)
                                2 = echo lf w/cr (1)
                                3 = echo cr w/lf (1)
                                4 = cr delay     (1)
                                5 = input baud   (4)
                                6 = output baud  (4)
                                7 = parity       (1)
                                8 = half duplex  (1)
                                9 = param - A    (4)
                                A = param - B    (4)
                                B = param - C    (4)
                                C = X-enable     (1)
                                D = Echo BS      (1)
                                E = Rev X-enable (1)
                                F = param - D    (4)
                               10 = Katakana     (1)
                               11 = Term on brk  (1)
                               12 = Echo - Esc   (1)
                               13 = Q-Mode       (1)
          
          
                         lsta : 0 = Continue
                                1 = Please Log in
                                2 = Error, type username
                                3 = Error, type password
                                4 = username
                                5 = password
          
                         lerr : 0 = ISIS unable to complete request
                                1 = format error
                                2 = bad user name
                                3 = bad mud
                                4 = system unavailable
                                5 = down line load or dial out failure
                                6 = timeout
                                7 = access not permitted
                                8 = out of origination ports
                                9 = try again later
                                A = bad requesting host number
                                B = requesting host not up on node
          
                         resn : 0 = host out of ports
   APPENDICES                                                  Page 5-4
   ISIS DISPATCHER MESSAGES


           EXAMPLE   :
          
           1. Needle - Type 00
          
              000F  001D  0017  4953  0599  041C  0000  006B
              0000  0000  0000  CC09  4C49  4E43  4F4C  4E31
              8D--
          
           
           2. Data - 
          
              000E  1A8D  8AF2  E5ED  EFF4  E5BA  A0E3  E1EC
              ECA0  E3EF  EEEE  E5E3  F4E5  E48D  8A1B  5936
   APPENDICES                                                  Page 5-5
   ISIS DISPATCHER MESSAGES


                ***** NON-CIRCUIT ISIS MESSAGES, RPORT = 0 *****
     
               - Restart Req.   00  :----|
               + Restart Resp   01  :----|
               - Take over      02  :Sup#|
               + Rpt to SUP     03  :Key.|Half wd 4!Half wd 3|
                                         |Hw2l:----!----:----|
               + Host status    04  :Key.|.Host no.!# of prts|
                                         |Rel Host#!Hsta:HKey|
               + Report Accnt   05  :----|accounting message |
               - Tell host time 06  :----|....:...GMT...:....|
               + Pseudo N Req   07  :Key.|local Key!SIQ=8000.|
                                         |Orig Host!TID.:....|
               + Aux Cir Req    08  :Key.|Local Key!SIQ=8000.|
                                         |Orig Host!Size: User name ....
               - Pseudo N Rej   09  :Key.|Local Key!lerr:----|
               + Host Prt aval  0A  :Key.|.Host no.!# of prts|
                                         |Rel Host#!----:----|
               - Host unaccep   0B  :Key.|.Host no.!Herr:----|
               + Rpt Host cost  0C  :Key.|.Host no.!Host Cost|
                                         |Rel Host#!----:----|
               - No SUP         0D  :----|
               - 1Down Mess     0E  :Key.|Type:Size!Text ...
               + Rpt all Hosts  0F  :----|
               + Ext Host stat  10  :Key.|.Host no.!# of prts|
                                         |Rel Host#!Hsta:HKey|
                                         |I.Q.:PID !----:----|
               
             Where   Hsta : 0 = Host answered
                            1 = Host down
                            2 = Host shut (but up)
                            3 = Host gone
     
                 Host no. : Always a Hex number, convert to radix 10
                            for the actual network host number.
     
               # of ports : Always a Hex number, convert to radix 10
                            for the actual number of ports in decimal.
     
                     I.Q. : Host Intelligent Level
                            (80 - IIX Capable)
     
                      PID : Product ID for the interface
                            Value should be 3 for version 1.15 or lower
                            or 33 for Version 2.0 or higher.
   APPENDICES                                                  Page 5-6
   ISIS DISPATCHER MESSAGES


                            Ex.  0001    ASAT
                                 0002    ACOM
                                 0003    XCOM (for Version 1.15)
                                 0004    3270 Host Interface
                                 0005    3270 Terminal Interface
                                 0009    Standalone Tymsat
                                 000B    ELF
                                 0010    ONTYME
                                 0012    RAM
                                 0014    VAL
                                 0015    CONSAT
                                 0033    XCOM (for Version 2.00)
     
              
     
          
          
          
           EXAMPLE  :
          
           1. Pseudo Needle Request - Type 07
          
              0000  0700  0002  8000 0599  CC--
          
           
           2. Ext Host Stat - Type 10 (Host answered)
          
              0000  100E  0768  000A  0000  0200  8003
          
          
           3. Ext Host Stat - Type 10 (Host shut)
          
              0000  100E  0768  000A  0000  0000  8003
   APPENDICES                                                  Page 5-7
   ISIS DISPATCHER MESSAGES


     
     In   NAD-DDT:
     
           *:r oring,4
           509C0  037C  037C
           *:r oring,37c+4
           509C0  037C  037C  000F  B10E  0000  6575  000F  020D
           509D0  0A0F  A044  000F  044F  4B2C  2DC0  000F  1B5B
           509E0  4E45  544C  494E  4B20  2052  6576  2E20  3138
           509F0  2E33  585D  0D0A  0D0A  4020  0002  000F  2649
           50A00  6C6C  6567  616C  2061  6464  7265  7373  2066
           50A10  6F72  6D61  7420  2774  796D  6E65  7420  270D
           50A20  0A0D  0A40  2006  0107  0000  0700  0002  8000
           50A30  0599  CC11  000E  B30D  000F  020D  0A1E  108E
           50A40  000F  2754  594D  4E45  5420  436F  6E6E  6563
           50A50  7465  640D  0A0D  0A72  656D  6F74  653A  2075
           50A60  7365  7220  6E61  6D65  3A20  0420  000F  B700
           50A70  E800  000C  000F  B700  E700  000A  000F  B700
           50A80  E600  000A  000F  B700  E500  0009  000E  B369
           50A90  000E  B364  000E  B363  000E  B331  000E  B330
           50AA0  000E  B334  000E  B332  000E  B30D  000E  B700
           50AB0  E002  0000  000E  B700  E003  3106  000E  B700
           50AC0  E004  0000  000E  B700  E00B  3106  000E  B700
           50AE0  E00C  0000  000E  B700  E00D  0800  000E  B700
           50AF0  E008  0599  000E  BF00  000E  0480  8180  8300
           50B00  000E  BF00  000E  04C0  9300  0033  000E  BF00
           
           
           
     
           *:r iring,irsize+4
           50D10  00F8  00F8  000E  BF01  000E  1EC0  821B  0202
           50D20  0003  0204  0005  0107  1508  0009  000C  0000
           50D30  2101  0012  0024  0039  018F  0801  000E  BF1E
           50D40  000E  03C0  8203  BFB4  000E  0304  0B00  040B
           50D50  000E  BFCC  000E  03C0  8400  21C0  000E  BF72
           50D60  000E  03C0  8E00  204E  000E  AC6F  000F  A631
           50D70  000F  B100  0053  7973  000F  B10E  008F  0C35
           50D80  000E  9F72  000F  B100  0161  73BF  000F  B10E
           50D90  0053  6967  000F  AA6E  000F  A73E  7465  6D20
           50DA0  000F  0C35  310D  0A0D  0A20  506C  6561  73BF
           50DB0  000F  0D65  2053  6967  6E20  4F6E  200D  0A3E
           50DC0  000F  BFCE  000F  0CC0  8209  0602  010C  0100
   APPENDICES                                                  Page 5-8
   CTA LAYOUT


     5.2  CTA LAYOUT

                      APPENDIX II - SEGMENT 14D LAYOUT, CTA

          Segment 14d is used by ISIS to initialize  memory  resources,
     such  as  MAC  usage and protection.  It also contains information
     for control of and communications with the slot.  This segment  is
     ALWAYS  declared read-only, and should not be modified by the user
     in any way.  The information is provided by the user, and verified
     by  ISIS before the slot may run.  The following data may be found
     within segment 14d:

        LOC    SIZE    NAME   Usage
        (byte)(byte)  (symbol) 
     
        0E0000 4      CNTRL   Control flags.
        0E0004 4      CTASIZ  Size of CTA (bytes).
        0E0008 4      AREAS   Memory area 0 requirements (bytes).
        0E000C 4x13d          Additional memory area requirements 
                               (bytes/area).
        0E0040 2      NPROT   Count of usable protection bytes.
        0E0042 14d    PROT    Memory protection requirements, by segments.
        0E0050 4      ISTART  Slot execution start address.
        0E0054 4      DSTART  DDT execution start address.
        0E0058 4      FPANEL  Pointer to front-panel display cell.
        0E005C 4      HOSTS   Pointer to host table.
        0E0060 4      PORTS   Pointer to port table.
        0E0064 4      PTABLE  Pointer to termination table.
        0E0068 4      IRINGP  Pointer to input ring descriptor.
        0E006C 4      ORINGP  Pointer to output ring descriptor.
        0E0070 4      IBKPNT  Pointer to "FROMISIS" bit array.
        0E0074 4      OBKPNT  Pointer to "TOISIS" bit array.
        0E0078 4      PCBPNT  Pointer to project code termination bit array.
        0E007C 4      CSADDR  Core start address.
        0E0080 2      HOSTN   Maximum number of hosts.
        0E0082 2      NPORTS  Highest real port number.
        0E0084 2      IMAXI   Size of input ring (bytes).
        0E0086 2      OMAXI   Size of output ring (bytes).
        0E0088 2      SLOTNO  Slot number.
        0E008A 1      SVERNO  Slot version number.
        0E008B 1      SREVLE  Slot revision level.
        0E008C 4      DD.BG2  Second DDT entry.
        0E0090 2      MACPNT  HW pointer to extended MAC sets.
        0E0092 2      MAXCNT  HW count of extended MAC sets.
        0E008C 64d            reserved for expansion.
     
   APPENDICES                                                  Page 5-9
   CTA LAYOUT


                                    CONTROL BITS
     
     
                
     
     The word labeled CNTRL contains a number of bit flags:
     
      00000002  Set if  ports not reusable until they emit a disconnect.
      00000004  Set if number of ports may be changed.
      00000008  Set if host numbers may be changed.
      00000010  Slot wants to know about take-over.
      00000020  Slot wants to know supervisor time.
      00000040  Slot can originate reset requests.
      00000080  Slot wants zappers and detach's acknowledged.
      00000100  Set to accumulate project code.
      00000200  Slot wants out-of-band flow-control.
      00000400  Slot wants "1-down" messages.
      00000800  Slot wants to know about undertake.
      00001000  Slot uses extended memory.
     
     These bits are "OR'ed" to specify the collection of services
     requested.
   APPENDICES                                                 Page 5-10
   CTA LAYOUT


          There are also a  number  of  additional  tables  and  cells,
     addressed  by  the  Dispatcher.  These should be placed in segment
     14, where they can be protected from inadvertant  modification  by
     the slot's code.


     START                 The start address for background code.

     DEBUG                 The  address  (if  non-zero)  of  a  special
                     routine,   executable   from   DDT,   to   provide
                     application-dependent information and control.

     FPANEL                The address of  a  halfword,  which  can  be
                     displayed   at  the  front  panel  for  diagnostic
                     purposes.

     HOSTS                 The master table, for this slot, showing the
                     numbers    of    the    hosts   to   be   applied.
                     (NOTE...unless the CNTRL word specifies  that  the
                     host  numbres  may  be changed, this table MUST be
                     assembled in!)

     PORTS                 The master table, for this slot, of all port
                     allowances   (number   of  host  ports)  for  each
                     potential host.   (NOTE...unless  the  CNTRL  word
                     specifies that the number of ports can be changed,
                     this table MUST be assembled in!)  The  HIGH-ORDER
                     TWO BITS of each entry specify the host state:  00
                     - answered, 01 - down, 10 - shut, 11 - gone.

     PTABLE                Slot   permuter   table   (length   NPORTS+1
                     halfwords);   extra port is used for port 0...thus
                     NPORTS is the number of  user  serviceable  ports,
                     and is also the highest port number to use.

     MACR                  The extended MAC register sets are assembled
                     starting at the label MACR.  Each set must consist
                     of  16  fullword  MAC  registers  followed  by   a
                     fullword  pointer  and  two  fullwords of storage.
                     The pointer contains the address of the  PSD  used
                     to  resume  execution after the Change MAC Set SVC
                     has been issued.  The MAC registers take the form:
                     WXYYZZZZ.   Where  W  is the protection mask, X is
                     the extended memory block number, YY is the number
                     of  pages in the segment, and ZZZZ is the starting
                     page of the segment.  The starting page number  is
                     the starting page relative to the beginning of the
                     block.  The protection mask is the same  as  shown
                     for the label PROT above.

     TOISIS                A bit array, of length  MAXPRT,  whose  bits
                     correspond  to  the  same  numeric ports;  the bit
                     turned on  means  the  Dispatcher  is  willing  to
                     accept data on that port (applied to data going to
   APPENDICES                                                 Page 5-11
   CTA LAYOUT


                     ISIS).

     FRISIS                A bit array set by the slot to specify which
                     ports  it is willing to accept data on.  It may be
                     set by ISIS messages A0 and A1  or  explicitly  by
                     the slot.

     PCBTBL                An optional bit array,  the  bits  of  which
                     specify   those  input  characters  which  are  to
                     terminate the "project code" collection.  This  is
                     ignored  unless  the  "project  code" CNTRL bit is
                     set.  Even then, it may be a null pointer (set  to
                     0),   where   27   characters   will  accumulated.
                     (Project code characters are those included in the
                     input data stream, but exclude control messages.)

   APPENDICES                                                 Page 5-12
   SEGMENT 15 CORE LAYOUT


     5.3  SEGMENT 15 CORE LAYOUT

                      APPENDIX III - SEGMENT 15 CORE LAYOUT

          Segment  15d  is  used  by  ISIS  to  make  System  Variables
     available  to  the  individual  users.   This  segment  is  ALWAYS
     declared read-only, and may not be modified by  the  user  in  any
     way.  The following data may be found within segment 15d:

     
      LOC    SIZE   NAME    USAGE
      (byte)(byte)  (lable)  
     
      0F0000   4    RATE    The rate at which the fast clock ticks.
      0F0004   4    FASTC   The fast clock
      0F0008   4    SLOWC   The slow clock (ticks once/second)
      0F000C   4    GMT     The  GMT clock  (ticks once/second);   This will
                             have the high-order  bit set, whenever  the GMT
                             is not known.
      0F0010   1    TEMPER  Machine   temperature,   as   read    from   the
                             multifunction card.
      0F0011   1    VOLTS   Machine voltage, as read from  the multifunction
                             card.
      0F0012   2    VERNO   The ISIS  version number  (binary: corresponding
                             decimal  number  has  leading  digits   as  the
                             version number, low two digits are the revision
                             level.
      0F0014   4            Unused!  (0 if not implemented.)
      0F0018   2    HOSTX   Kernel host number.
      0F001A   2    NODEX   Kernel node number.
      0F001C   2    LO.CLK  Local-clock   area  pointer   (see  description,
                             below), relative to  RATE (the base  of segment
                             0F...LCX = RATE+(LO.CLK) ]).
      0F001E   2    NSLOT   The number  of the  highest-numbered dispatcher-
                             connected slot.
      0F0020   2    LCT     Location of crash table relative to RATE.
      0F0022   2    MAXP0   Largest port 0 message number.
      0F0024   2    MAXMSG  Largest non-port 0 message number.
      0F0026   2    LP0LST  Location  of  a  list  of  port-0  message sizes
                             relative to RATE.  The list has 1 byte for each
                             message  type,  that  indicates  the  number of
                             bytes  in the  message, exclusive  of  the port
                             number.  A value 0 indicates  a variable-length
                             message.
      0F0028 100x   LENGTH  Length table for non-port 0 messages, formatted
                             as above.
      0F0128   8    A.SPED  Bit  array  specifying  ASYNC   terminal  speeds
                             supported.
   APPENDICES                                                 Page 5-13
   SEGMENT 15 CORE LAYOUT


                            LCX -- Local Clocks Area
     
      LCX-2    2    Local system clock.  Ticks whenever a slot numbered -1
                     (FF, ISIS Kernel) is running.
      LCX      2    Local clock index, referenced via LO.CLK.  Index,
                     relative to LCX, for the local  clock currently
                     being ticked.
      LCX+2    2    The local clock for slot 0.
      LCX+4    2    The local system clock for slot 0.  (Ticks while
                     dispatcher is cleaning up after slot 0.)
      LCX+6    2    The local clock for slot 1.
      LCX+8    2    The local system clock for slot 1.
      . . .         For a system with NSLOT, location [4*NSLOT+LCX+6]
                     will be ticked by any other processes active.

          The local clock ticks at the same rate as FASTC;  counting is
     directed   at   the  appropriate  local  clock  each  time  a  new
     context-switch is performed by the KERNEL.  In  particular,  there
     are  TWO clocks for each dispatcher-connected slot:  The one which
     runs while the slot is active, and the one which  runs  while  the
     system  is performing actions for that slot (eg, the dispatcher is
     servicing the output generated by the slot).   Note  that  a  slot
     performing a disproportionate share of input may end up with a low
     recorded share of system usage, while a  slot  which  does  mostly
     output  will  get a correspondingly high indication.  The two slot
     clocks, used together, should provide an indication of  the  share
     of machine time that slot is using.

          To determine the share of machine time any slot is using, one
     can "snapshot" both the local clock of interest, and FASTC;  after
     a short wait, a second "snapshot" will allow  the  computation  of
     real  and  virtual  elapsed  time,  from which a percentage may be
     derived.
   APPENDICES                                                 Page 5-14
   DDT COMMANDS


     5.4  DDT COMMANDS

                            APPENDIX IV - DDT COMMANDS
                           (NOT USING NAD SYMBOL TABLE)



          For remote access, the following commands are a good sampling
     of  what  you  will  find  useful.   For  a complete list, see the
     ISIS-II Reference Manual.

     1.  H - halt slot

     2.  E - execute slot

     3.  R <address>,<byte count of read><cr> - read from Engine memory
         specified number of bytes starting at specified address

     4.  Z - logoff, responds with "logginf off?" and  a  second  Z  is
         required to complete the logoff

     5.  \ - reset DDT, used to recover from an error condition

     6.  ^ <slot #> - switch to another slot (if it is available)

     The following question mark commands all require a carriage return
     to terminate:

     1.  ?MAC - outputs table that  displays  the  slot's  current  MAC
         configuration.

     2.  ?SLOT - outputs current slot number.

     3.  ?VERN - outputs ISIS and slot's code version numbers.

     4.  ?BT - outputs current Background PSD.

     5.  ?FT - outputs current Foreground PSD.

     6.  ?BRR  R,N  -  outputs  the  current  values  of  the   running
         background   registers.    This  is  approximate.   R  is  the
         beginning register  number  and  N  is  the  total  number  of
         registers  you  wish  displayed.   Example:   to  read all the
         registers, type ?BRR 0,10(hex).

     7.  ?FRR R,N - outputs the current values  of  running  foreground
         registers.  Same arguments as above.

     8.  ?CT - outputs a table of Dispatcher circuits attached to  that
         slot  and  the  other  end including the RPORT numbers at both
         ends.
   APPENDICES                                                 Page 5-15
   DDT COMMANDS


     9.  ?USE - outputs a  table  of  the  Dispatcher  ports  currently
         active,  and  the  maximum (decimal) number of characters that
         the Dispatcher neede to buffer in each direction.

    10.  ?HOST  -  outputs  a  table  of  the  hosts  declared  to  the
         Supervisor from that slot, the host state (gone!, down!, shut,
         and answered), the total number of Dispatcher ports  for  that
         slot, and the number of ports in use.

    11.  ?WHO - outputs a table for each slot showing the  current  DDT
         status  of that slot, and the two most recent usernames to log
         into that slot's DDT.  This provides a short  history  of  who
         may have been making changes.

    12.  ?STAT - connects you to an extended DDT function you may  have
         running in your slot.  For example, XRAY or XOM.

    13.  ?PORT - lists all current DDT users.

    14.  ?HANG - destroys the DDT circuit for the port specified.  This
         is   necessary   when  a  partial  DDT  circuit  remains  upon
         disconnect.  Until the remnant is destroyed, users will not be
         able to access that slot.

    15.  ?TIME - outputs current system time (time elapsed  since  node
         was last loaded).

    16.  ?HIST - All diagnostic messages in the node system  diagnostic
         queue will be displayed, starting with the oldest.

    17.  ?CPU - a "snapshot" of the  fast  clock  and  the  appropriate
         local   clocks   is   performed,   then   DDT   dismisses  for
         approximately one second.  The  elapsed  time  is  calculated,
         converted  to a percentage, and displayed.  Further, the total
         "span" used (number of  bytes  processed)  of  the  Dispatcher
         input and output rings is displayed.

    18.  ?LU - outputs a list  of  logical  units  and  the  associated
         device type and unit number.

     (Note:  The ?BRR and ?FRR commands are to be  used  with  caution,
     especially when reading a string of registers.  The program may be
     dismissed in the middle of the read, and after it  has  picked  up
     the  following  registers  reflect  a different point in time than
     those already displayed.  This command can be useful if  the  slot
     is in a loop or frozen.)
   APPENDICES                                                 Page 5-16
   NAD/NAD-DDT COMMANDS


     5.5  NAD/NAD-DDT COMMANDS

                          APPENDIX V - NAD/DDT COMMANDS

          This is only a partial list.   For  a  complete  funcionality
     description  see  the Tools and Utilities Document and the ISIS-II
     Reference Manual.  The  page  numbers  given  are  for  Tools  and
     Utilities reference.


     1.  LO <module name><cr> - Make symbols in specified mudule  local
         to NAD, pg 13.

     2.  FO <module  name><cr>  -  Make  symbols  in  specified  module
         foreign to NAD, pg 13.

     3.  "." (period) - Current program position, pg 25.

     4.  ^A - Backspace to non-alphameric character, pg 25.

     5.  ^Q - Delete word back to non-alphameric, pg 25.

     6.  ?  - cancel current input command, pg 26.

     7.  <ESC> - Deletes and flushes current output command, pg 26.

     8.  <ESC><ESC> - Delete output command and EXIT NAD, pg 26.

     9.  %Q - Exit NAD, pg 26.

    10.  ;C - Construct auxiliary circuit, pg 34.

    11.  ;R - Hex relay on auxiliary circuit, pg 35.

    12.  %R - ASCII text relay on auxiliary circuit, pg 35.

    13.  ::  - Expression relay on auxiliary circuit, pg 35.

    14.  :E - Execute process, pg 39.

    15.  :H - Halt process, pg 40.

    16.  :R <address or symbol>,<byte count> - Read memory starting  at
         address, or symbol for the requested number of bytes, pg 41.

    17.  :W <address or symbol>,<value> - Write to memory  starting  at
         address, or symbol the value shown (max 4 bytes), pg 42.

    18.  <address  or  symbol>,<byte  count>:W  -  Transfer  to  memory
         starting  at  address  the  NAD  image  for the requested byte
         count, pg 42.
   APPENDICES                                                 Page 5-17
   NAD/NAD-DDT COMMANDS


    19.  :WR <register #>,<value> - Write  to  specified  register  the
         value shown, pg 43.

    20.  :Z - logoff ISIS DDT, pg 43.

    21.  :  - Reset ISIS DDT, pg 43.

    22.  %F - Name an existing file as current NAD image, pg 46.

    23.  %G - Get state (symbol) table from named file, pg 47.

    24.  ;G - Get binary machine code from named file, pg 47.

   APPENDICES                                                 Page 5-18
   EXAMPLE PROBE ERROR LOG 


     5.6  EXAMPLE PROBE ERROR LOG 

                 APPENDIX VI - PUBLIC NET PROBE ERROR LOG EXAMPLE
                                  ONE MINUTE LOG

     143:23:04:00
      LINK OUT OF BANDWIDTH, NODE 3270 TO 3514
      LINK OUT OF BANDWIDTH, NODE 2342 TO 2075
      NODE REPORT 3220 LINE 3 BAD BORI FROM NODE 3115
                OCCURRED 37 TIMES
      NODE REPORT 3220 LINE 3 TOTAL PACKETS RECEIVED AND SENT 973 769
      CHECKSUM ERROR 1112 11024
      LOGIN ERROR: USER HUNG DUE TO BAD USERNAME, TID: 1
                REQUESTING HOST 18126 NODE 3466 BUFFER 195
      NODE REPORT 3775 LINE 4 BAD BORI FROM NODE 3076
                OCCURRED 67 TIMES
      NODE REPORT 3775 LINE 4 BAD RECORD NUMBER FROM NODE 3076
                OCCURRED 3 TIMES
      NODE REPORT 3775 LINE 4 TOTAL PACKETS RECEIVED AND SENT 3108 1576
      HOST 3934 UP
      HOST 3934 ANSWERED
      BUFFER ZAPPED 1133 4 251
      NODE REPORT 2644 10E 3 
      NODE REPORT 4102 LINE 10 RETRANSMISSIONS FROM NODE 2061
                OCCURRED 32 TIMES
      NODE REPORT 4102 LINE 10 TOTAL PACKETS RECEIVED AND SENT 213 290
      LOGIN ERROR: USERNAME TOO LONG, TID: 12
                REQUESTING HOST 2957 NODE 2165 BUFFER 965
      UNOVERLOADED 2262 TO 3165
      NODE REPORT 2364 LINE 7 SPACING ON LINE FROM NODE 2020
                OCCURRED 3 TIMES
      NODE REPORT 2364 LINE 7 TOTAL PACKETS RECEIVED AND SENT 6462 6303
      NODE REPORT 4137 FROM KERNEL TYPE FF 5D 
      NODE ERROR 734 101372 12
      NODE ERROR 734 101572 3
      NODE REPORT 3055 TYPE 3 2486B3 
      LINK OUT OF BANDWIDTH, NODE 4000 TO 3514
      NODE REPORT 2230 TYPE 9 81458085 
      NODE REPORT 2532 TYPE 2E 48BE 
      LOGIN ERROR: USER HUNG DUE TO BAD PASSWORD, TID: 1
                REQUESTING HOST 18126 NODE 3466 BUFFER 195
      LOGIN ERROR: USER PREVIOUSLY HUNG FOR BAD PASSWORD WAS FOR UUN 4254
      NODE REPORT 4500 LINE 2 BAD BORI FROM NODE 3214
                OCCURRED 312 TIMES
      NODE REPORT 4500 LINE 2 TOTAL PACKETS RECEIVED AND SENT 513 531
      UNOVERLOADED 2657 TO 2653
      NODE REPORT 2043 TYPE 7 852B8080 
      NODE REPORT 2453 TYPE 7 84238080 
      NODE REPORT 3416 LINE 3 BAD BORI FROM
                AN UNKNOWN NEIGHBOR OCCURRED 2124 TIMES
      NODE REPORT 3416 LINE 0 BAD BORI FROM NODE 2575
                OCCURRED 30 TIMES
      NODE REPORT 3416 LINE 0 TOTAL PACKETS RECEIVED AND SENT 503 524
      RESET. PLI 0 NODE 505 LINE 1
   APPENDICES                                                 Page 5-19
   EXAMPLE PROBE ERROR LOG 


      LINE OUT. PLI 0 NODE 505 LINE 1
      NODE REPORT 2114 FROM KERNEL TYPE FF 274 
      NODE REPORT 4160 FROM KERNEL TYPE FF 159 
      NODE REPORT 4160 FROM KERNEL TYPE FF FFFE019E 
      LINE DETACHED, NODE 2603 TO 4317 PORT 1 BECAUSE NO RECORDS RECEIVED ON 
     LINE
      NODE REPORT 2603 TYPE 16 88CF8010 
      LOGIN ERROR: USERNAME TOO LONG, TID: 2
                REQUESTING HOST 3173 NODE 3271 BUFFER 1955
      NODE REPORT 2145 10B 8 
      LOGIN ERROR: USER HUNG DUE TO BAD USERNAME, TID: 3
                REQUESTING HOST 18126 NODE 3466 BUFFER 195
      LOGIN ERROR: USER HUNG DUE TO BAD PASSWORD, TID: 12
                REQUESTING HOST 18182 NODE 2657 BUFFER 205
      LOGIN ERROR: USER PREVIOUSLY HUNG FOR BAD PASSWORD WAS FOR UUN 16647
      NODE REPORT 3005 LINE 3 BAD RECORD NUMBER FROM NODE 2014
                OCCURRED 5 TIMES
      NODE REPORT 3005 LINE 3 SPACING ON LINE FROM NODE 2014
                OCCURRED 3 TIMES
      NODE REPORT 3005 LINE 3 TOTAL PACKETS RECEIVED AND SENT 3228 1869
      LINK OVERLOADED, NODE 2122 TO 2716
      NODE REPORT 2313 TYPE 2E 40BD 
      LINE ATTACHED, NODE 2603 TO 4317 PORT 1 SPEED 9600 BPS
      NODE REPORT 2603 TYPE 17 88CF8003 
      LINK OUT OF BANDWIDTH, NODE 3257 TO 2414
      ACCOUNTING FILE BLOCKS LEFT 1566
      NODE REPORT 3260 LINE 0 BAD BORI FROM NODE 2612
                OCCURRED 71 TIMES
      NODE REPORT 3260 LINE 0 TOTAL PACKETS RECEIVED AND SENT 1263 1082
      LOGIN RATE 362, AVG 0.86 SEC, PEAK 4.78 SEC 
      CIRCUITS AVG LENGTH 6.1, COST 27.1; MAX LENGTH 9, COST 72
      SUP ACTIVITY PER SECOND - 342.4 EXEC LOOPS
                25.6 INPUT FOUND 0.0 OUTPUT INHIBITED, LAST BY NODE 0
      INTERNAL SUP ACTIVITY IN MS - 2 PER EXEC LOOP
               12 PER INPUT CALL 103 PER MSG TO SUP'S NODE 220 PEAK
      EXTERNAL COMMUNICATION TIMES IN SEC - 0.34 AVG
                0.23 AVG ADJUSTED 0.7 PEAK ADJUSTED TIME, FOR NODE 2011
      UNOVERLOADED 3252 TO 3177
      UNOVERLOADED 2103 TO 2401
      LOGIN ERROR: USER HUNG DUE TO BAD USERNAME, TID: 12
                REQUESTING HOST 2009 NODE 2434 BUFFER 1607
      NODE ERROR 54 101040 26
      NODE REPORT 2222 LINE 1 BAD BORI FROM NODE 2631
                OCCURRED 62 TIMES
      NODE REPORT 2222 LINE 1 BAD RECORD NUMBER FROM NODE 2631
                OCCURRED 8 TIMES
      NODE REPORT 2222 LINE 1 TOTAL PACKETS RECEIVED AND SENT 1447 1461
      NODE REPORT 2337 FROM KERNEL TYPE FF 8C9 
      NODE REPORT 3177 LINE 6 BAD BORI FROM NODE 3643
                OCCURRED 162 TIMES
      NODE REPORT 3177 LINE 6 BAD RECORD NUMBER FROM NODE 3643
                OCCURRED 5 TIMES
      NODE REPORT 3177 LINE 6 BAD CHECKSUMS FROM NODE 3643
                OCCURRED 16 TIMES
   APPENDICES                                                 Page 5-20
   EXAMPLE PROBE ERROR LOG 


      NODE REPORT 3177 LINE 6 TOTAL PACKETS RECEIVED AND SENT 513 518
      NODE REPORT 3177 TYPE 2E 439C 
      NODE REPORT 2042 TYPE 7 84268080 
      NODE REPORT 2046 TYPE 7 84228080 
      NODE REPORT 2744 10B E 
      NODE REPORT 4007 FROM SLOT 2 XCOM TYPE 80 8E 
      NODE REPORT 3157 LINE 4 BAD BORI FROM NODE 3010
                OCCURRED 50 TIMES
      NODE REPORT 3157 LINE 4 BAD RECORD NUMBER FROM NODE 3010
                OCCURRED 2 TIMES
      NODE REPORT 3157 LINE 4 TOTAL PACKETS RECEIVED AND SENT 495 517
      LINK OUT OF BANDWIDTH, NODE 2274 TO 2171
      NODE ERROR 1611 101240 21
      NODE REPORT 4255 LINE 1 SPACING ON LINE FROM NODE 3151
                OCCURRED 4 TIMES
      NODE REPORT 4255 LINE 1 TOTAL PACKETS RECEIVED AND SENT 2937 3128
      NODE REPORT 4013 LINE 6 BAD BORI FROM NODE 2532
                OCCURRED 38 TIMES
      NODE REPORT 4013 LINE 6 TOTAL PACKETS RECEIVED AND SENT 515 513
      LINE DETACHED, NODE 4100 TO 4246 PORT 10 BECAUSE NO RECORDS RECEIVED ON
      LINE
      NODE REPORT 4100 TYPE 16 88A68010 
      HOST 3934 DOWN
      LOGIN ERROR: USER HUNG DUE TO BAD USERNAME, TID: 1
                REQUESTING HOST 18126 NODE 3466 BUFFER 195
      NODE REPORT 3165 LINE 2 BAD BORI FROM NODE 2756
                OCCURRED 18 TIMES
      NODE REPORT 3165 LINE 2 SPACING ON LINE FROM NODE 2756
                OCCURRED 2 TIMES
      NODE REPORT 3165 LINE 2 TOTAL PACKETS RECEIVED AND SENT 972 1395
      HOST 3934 UP
      HOST 3934 ANSWERED
      NODE REPORT 3076 LINE 0 BAD BORI FROM NODE 3775
                OCCURRED 47 TIMES
      NODE REPORT 3076 LINE 0 TOTAL PACKETS RECEIVED AND SENT 1777 3517
      NODE REPORT 3125 FROM KERNEL TYPE FF 6A 
      NODE REPORT 3151 LINE 6 BAD BORI FROM NODE 3421
                OCCURRED 89 TIMES
      NODE REPORT 3151 LINE 6 BAD RECORD NUMBER FROM NODE 3421
                OCCURRED 7 TIMES
      NODE REPORT 3151 LINE 6 BAD CHECKSUMS FROM NODE 3421
                OCCURRED 9 TIMES
      NODE REPORT 3151 LINE 6 TOTAL PACKETS RECEIVED AND SENT 547 513
      HOST 3934 DOWN
      LOGIN ERROR: USERNAME TOO LONG, TID: 12
                REQUESTING HOST 2957 NODE 2165 BUFFER 879
      NODE REPORT 4727 LINE 20 HDLC ABORTS FROM NODE 3755
                OCCURRED 1 TIMES
      NODE REPORT 4727 LINE 20 TOTAL PACKETS RECEIVED AND SENT 1487 864
      LINE DETACHED, NODE 2134 TO 2340 PORT 2 BECAUSE NO RECORDS RECEIVED ON 
     LINE
      NODE REPORT 2134 TYPE 16 84E08010 
      NODE REPORT 4054 FROM KERNEL TYPE FF 16 
      LOGIN ERROR: USERNAME TOO LONG, TID: 12
   APPENDICES                                                 Page 5-21
   EXAMPLE PROBE ERROR LOG 


                REQUESTING HOST 2957 NODE 2165 BUFFER 875
      LINE DETACHED, NODE 2141 TO 2341 PORT 8 BECAUSE NO RECORDS RECELINE
      NODE REPORT 2141 TYPE 16 84E18010 
      NODE REPORT 2641 20B 5 
      LINE DETACHED, NODE 2136 TO 2341 PORT 2 BECAUSE NO RECORDS RECEIVED ON 
     LINE
      NODE REPORT 2136 TYPE 16 84E18010 
      LOGIN ERROR: USER HUNG DUE TO BAD USERNAME, TID: 1
                REQUESTING HOST 1781 NODE 2364 BUFFER 2033
      HOST 3934 UP
      HOST 3934 ANSWERED
      NODE ERROR 350 101340 61
      OVERLOADED NODE 576 LINE 2
      NODE REPORT 2701 LINE 1 SPACING ON LINE FROM
                AN UNKNOWN NEIGHBOR OCCURRED 25480 TIMES
      OVERLOADED NODE 447 LINE 2
      LINE ATTACHED, NODE 2134 TO 2340 PORT 2 SPEED 4800 BPS
      NODE REPORT 2134 TYPE 17 84E08003 
      LOGIN ERROR: USER HUNG DUE TO BAD USERNAME, TID: 3
                REQUESTING HOST 18126 NODE 3466 BUFFER 195
      LINE ATTACHED, NODE 2141 TO 2341 PORT 8 SPEED 4800 BPS
      NODE REPORT 2141 TYPE 17 84E18003 
      LINE ATTACHED, NODE 2136 TO 2341 PORT 2 SPEED 4800 BPS
      NODE REPORT 2136 TYPE 17 84E18003 
      UNOVERLOADED 2773 TO 4301
      UNOVERLOADED 3156 TO 4013
      NODE REPORT 4014 10B 3 
      LINK OUT, NODE 4100 TO 4246 PORT 10 BECAUSE NO RECORDS RECEIVED ON LINE
     
      LOST 4246 UPSTREAM 2002
      NODE REPORT 4100 TYPE A 88A68001 
      NODE REPORT 4100 TYPE 18 88A68001 
      NODE ERROR 424 137777 371
      LINK OVERLOADED, NODE 3773 TO 2575
      NODE REPORT 2730 FROM KERNEL TYPE FF 8B 
      NODE REPORT 3721 LINE 1 BAD RECORD NUMBER FROM NODE 4475
                OCCURRED 3 TIMES
      NODE REPORT 3721 LINE 1 SPACING ON LINE FROM NODE 4475
                OCCURRED 8 TIMES
      NODE REPORT 3721 LINE 1 TOTAL PACKETS RECEIVED AND SENT 1727 22
                OCCURRED 5 TIMES
      NODE REPORT 3133 LINE 11 TOTAL PACKETS RECEIVED AND SENT 5561 3557
      NODE REPORT 3330 LINE 26 HDLC CHECKSUM ERRORS FROM NODE 2414
                OCCURRED 1 TIMES
      NODE REPORT 3330 LINE 26 TOTAL PACKETS RECEIVED AND SENT 3036 2246
      HOST 2872 SHUT
      ACCOUNTING FILE BLOCKS LEFT 1582
      LOGIN ERROR: USERNAME TOO LONG, TID: 1
                REQUESTING HOST 2431 NODE 2756 BUFFER 1029
      NODE REPORT 3125 30C 4 
      NODE REPORT 2514 20B 1 
      NODE REPORT 4133 LINE 1 BAD BORI FROM NODE 3360
                OCCURRED 11 TIMES
      NODE REPORT 4133 LINE 1 TOTAL PACKETS RECEIVED AND SENT 526 593
   APPENDICES                                                 Page 5-22
   EXAMPLE PROBE ERROR LOG 


      NODE REPORT 3762 LINE 1 SPACING ON LINE FROM
                AN UNKNOWN NEIGHBOR OCCURRED 12602 TIMES
      LOGIN ERROR: USER HUNG DUE TO BAD USERNAME, TID: 1
                REQUESTING HOST 18126 NODE 3466 BUFFER 195
     143:23:05:04
      LOGIN ERROR: USER HUNG DUE TO BAD USERNAME, TID: 12
                REQUESTING HOST 2958 NODE 3420 BUFFER 325
      NODE REPORT 2564 LINE 3 BAD BORI FROM NODE 2711
   APPENDICES                                                 Page 5-23
   TYMNET II MESSAGE FORMAT


     5.7  TYMNET II MESSAGE FORMAT


                     APPENDIX VII - TYMNET II MESSAGE FORMAT

          All Supervisory messages begin with 16 bits  of  node  number
     (the  addressed  node if a downstream message, the sending node if
     an upstream message).  The second halfword of the message consists
     of  the  message  type (first byte), and supplementary information
     (second byte).  Following the second halfword of the message there
     may be additional data bytes.  The entire length of the message is
     sometimes implicit in the message type, but in several cases it is
     determined by the type and the accompanying message data.

          In the notation below,  the  header  line  for  each  message
     indicates  the  one  byte  type,  the name of the message, and the
     length of the message.  The length may be a formula which  depends
     on  data  within  the message.  Following the header are lines for
     each halfword of data along with explanations.  When the bytes  of
     a  halfword  have  different  meanings they will be separated by a
     comma.  Required data fields are surrounded by square brackets "["
     and  "]",  wheras  optional  or contigent fields are surrounded by
     angular brackets "<" and ">".

                           SUPERVISOR TO NODE COMMANDS
                           ---------------------------

     08 - TAKEOVER                           Length=4
             [08, Supern+80] -(Supern is Sup's number)
     
     
     09 - NEEDLE                             Length Variable
             [09, link count+80]     note - requesting node replaces
                                     09 with needle point.
             [invoice #
             invoice #]              note - invoice is 4 bytes.
             [Flags+8080]    -Flags bits in the needle are as follows:
                             0001 - rebil circuit
                             0002 - command circuit
                             0004 - origin in TYMNET I
                             0008 - destination in TYMNET I
                             0030 - speed bits
                             0040 - cost table used to plot path
                             0100 - priority circuit
                             0200 - IIX circuit flag
                             3C00 - IRC designator bits
                             4000 - unused
             [Requesting Node #]     -(Global requesting node)
             [Requesting Port #]     -(Global requesting port)
     
                     If the flags indicate the circuit represented
             by this needle starts with a T-I neighbor, then there
             follows two 1/2 words which define the T-I interface:
             <TYMNET I node #>
   APPENDICES                                                 Page 5-24
   TYMNET II MESSAGE FORMAT


             <Channel #>
     
             List of node #'s in the circuit:
               [node #               note - node numbers are
                 :                   not escaped with 8000.
                node #]
     
             [Destination]   - IF command circuit, this is 8080
                             - IF T-II host, Host+8000
                             - IF T-I node, Node+8000
                               followed by channel #:
             <Channel #>
     
             [User Flags + C080]             - bits 1F00 are TID
                                             - bit 2000 is 1/2 duplex flag
                                             - remaining bits reserved
     
             [Requesting Host + 8000]        - 8080 if unknown
             <Control Characters, User name
             termination & pad character>    - this field only present
                     for user circuit terminating in T-II.  Not present
                     for command or rebil circuits, or for circuit
                     fragments continued into T-I.  The field
                     consists of optional initial control characters
                     which are always mark parity:  'BF' for transparent
                     gateway & 'C1' for Oper status (not available
                     if transparent gateway).  The use of parity
                     to provide additional control characters is a
                     future option.  The username follows these
                     characters - without parity.  The username is
                     terminated by either a 'BB' for semi-colon, or a
                     '8D' for a carriage return.  A null, '80', will
                     be inserted, if necessary, to make the entire
                     message even.
     
     
     0A - UPDATE                             Length = 4
             [0A,Supern+80]
     
     
     0B - TRACE                              Length = 8
             [0B80]
             [Host # + 8000]         host # = -2 requests trace of
                                     Sup command circuits
                                     host # = 0 implies the kernel host
             [Port #]                -this command results in a trace
                                     response (Port #s are < 0C000).
               or
             [T1 Node # + C000]      -this requests trace of circuit
                                     crossing to TYMNET I
     0C - SEND PILL TO YOUR SUPERVISOR               Length = 4
             [0C,supern of sending sup+80]
     
     
   APPENDICES                                                 Page 5-25
   TYMNET II MESSAGE FORMAT


     
     0d - TALK TO TERMINAL IN LOGIN MODE             Length Variable
             [0D,n+flags]    flags:  80 is clear input buffer,
                                     40 is echo on
                                     20 clear output buffer
     
                                 n:  <8 not valid
                                     08  send no message
                                     09  PLEASE LOGIN
                                     0A ERROR, TYPE USER NAME
                                     0B ERROR, TYPE PASSWORD
                                     0C USER NAME
                                     0D PASSWORD
                                     10 send string specified below
                                     11 send hang character pair
                                     12 send half dux hang char pair
                                     13 PLS SEE YOUR REP.
                                     14 BAD MUD
                                     15 CIRCUITS BUSY
                                     16 HOST NOT AVAILABLE THRU NET
                                     17 HOST OUT OF PORTS
                                     18 HOST DOWN
                                     19 HOST SHUT
                                     1A TRY AGAIN IN 2 MIN
                                     1B ACCESS NOT PERMITTED
                                     1C NO HOST SPECIFIED
                                     1D BAD HOST NUMBER
                                     1E MUD ERROR
     
             [port #]
             <# of chars,char>  if n=10 then this string
                :               is to be sent to the user
             <char,char>
     
     
     
     0E - RESPONSE TO AUX CIRCUIT REQUEST            Length = 6
             [0E,n+80]         n     Meaning
             [port #]          0 Send login string (no message)
                               1 FORMAT ERROR
                               2 BAD USER NAME
                               3 BAD MUD
                               4 SYSTEM UNAVAILABLE
                               5 DOWN LINE LOAD OR DIALOUT FAILURE
                               6 TIMEOUT
                               7 ACCESS BARRED
                               8 (RESERVED FOR INTERNAL ISIS USE)
                               9 REQUEST REJECTED - QUEUE TOO LONG
                               A INVALID REQUESTING HOST NUMBER
                               B REQUESTING HOST NOT UP ON NODE
     
     
     
     0F - GENERAL                            Length Variable
   APPENDICES                                                 Page 5-26
   TYMNET II MESSAGE FORMAT


             [0F,n+80]        Where 7<n<80 is the subtype as follows:
     
     
          [0F88]     SEND HOST TIME IN GMT   Length = 0A
             [Host #]
             [Time
              Time]          time is one word
     
     
          [0F89]     STOP TALKING TO NODE    Length= 6
             [neighbor #]
     
     
          [0F8A]     START TALKING TO NODE   Length = 6
             [neighbor #]
     
     
          [0F8B]     REBILD ABORTED         Length = 8
             [invoice #
              invoice #]     invoice is 1 word
     
     
          [0F8C]     DOWN LINE LOAD          Length = 6
             [sync port #]
     
     
          [0F8D]     LOGIN ZAPPER CONFIRMATION       Length = 6
             [port # + 8000]
     
     
          [0F8E]     SYNC PORT REQUEST       Length = 4
     
     
          [0F8F]     LINK SPEED REQUEST      Length = 6
             [neighbor #]
     
     
          [0F90]     HOST REJECTED AS IMPOSTER       Length = 6
             [host #+8000]
     
     
          [0F91]     REQUEST CONTENTS OF BAD GUY LIST        Length = 4
     
     
          [0F92]     REMOVE FROM BAD GUYS LIST       Length = 6
             [neighbor #+8000]
          [0F93]     ADD TO BAD GUYS LIST    Length = 6
             [neighbor #+8000]
     
     
          [0F94]     TIMING DIAGNOSTIC REQUEST       Length = 10
             [time
              time] Sup data to return intact
             [8000+count] Return count messages
   APPENDICES                                                 Page 5-27
   TYMNET II MESSAGE FORMAT


     
     
     
     
     10 - PORT STATUS REQUEST                Length = 6
             [10,80+n]       n is port array number, each array is 128 ports
             [Host # + 8000] host # = -2 requests Sup ports
                             host # = 0 requests kernel ports
     
     
     11 - ASSIGN CHANNEL TO TYMNET I         Length = 0A
             [11, channel #]
             [neighbor #]
             [invoice #
              invoice #]     -invoice # is 4 bytes
   APPENDICES                                                 Page 5-28
   TYMNET II MESSAGE FORMAT


                           NODE TO SUPERVISOR MESSAGES
                           ---------------------------

     
     
     08 - ZAPPER to/from TYMNET I            Length = 6
             [8,channel #]
             [Neighbor # + 8000]
     
     09 - TAKEOVER RESPONSE          Length = 14 + 3L + 2H + (2H+7)/8
             [09,80+Supern of requester+(??)Sup node flag]
             [Version #]
             [Contents of crash mark location]
             [Crash count + 80, # of links + 80]
             [# of hosts + 80, 80]
             [# of passthrus available]   (unassigned buffer pairs)
             [Neighbor # + 8000]
               :
             [Neighbor # + 8000]     - one entry per neighbor
             [link speed + 80, speed + 80]  One byte of speed and type
                                     information per link.  Can be odd
                                     number of bytes, offsetting host fields
                                     below.  Low order 5 bits are speed in
                                     multiples of 2400 (0 is frozen).
                                     40 bit is Tymnet I WS8 flag (if set).
                                     20 bit is satellite bit (if set).
               :
               :
             [Host # + 8000]
               :
             [Host # + 8000]   - one entry per host
             [Host status:  status in bit pairs:     00-answered,
                                                     10-shut,
                                                     01-down
                     :
                     :
              Host status]   (Can be odd number of bytes.  No padding)
     
     
     0A - NOTICE OF TAKEOVER         Length = 4
             [0A,80+Supern of requester]     note - this is sent to
                                             former supervisor.
     
     0B - RESOURCES REPORT                   Length = 6
             [0B80]
             [# of free passthrus]
     
     0C - UPDATE RESPONSE                    Length Variable
             [0C80 + Supern of requester +(??)Sup node flag]
             [Version #]
             [Contents of crash mark location]
     
             [Crash count + 80, # of links + 80]
             [# of hosts + 80, 80]
   APPENDICES                                                 Page 5-29
   TYMNET II MESSAGE FORMAT


             [Max # of passthrus]
             [# of passthrus in use]
             [Max # of terminal ports]
             [# of terminal ports in use]
             [Neighbor #]
               :
               :
             [link speed + 80, speed + 80]
               :
               :
             [Host # + 8000]                 These next 3 1/2 words are
             [Max # of ports]                repeated for each host.
             [# of ports in use & status]    status in bits 0&1
               :
               :
               :
     
     0D - REBILD REQUEST                    Length = 14
             [0D80]
             [flags]         copy of flags in original needle
             [Requesting port #]
             [Base #]
             [Host #]
             [Invoice #      Four byte invoice # is checked by
              invoice #]     both ends to insure consistency.
             [node #]        These node numbers define the link
             [node #]        that went out causing the rebil requests.
     
     0E - LOGIN STRING CONTINUATION          Length Variable
             [0E, n+80]      n=count of chars in string
             [Port # + 8000]
             [char,char]
               :
               :
     
     0F - TID FOR NEW LOGIN PLUS STRING      Length Variable
             [0F, n+80*X]    same as login string, but first char is tid
                             and X is used to indicate IIX request (X=0
                             if dialect, X=1 if no IIX (old style)).
             [Port # + 8000]
             [Host # + 8000]
             [char,char]
               :
               :
     10 - AUX CIRCUIT REQUEST                Length 6 or 8
             [1080]          Base will reserve a port for the aux circuit.
             [Unique port #] when the needle comes it will specify the
                             requesting port as the Terminal port #
                             & the flags will show this is an aux circuit.
                             That is confirmation of successful completion.
               or
             [1001+X*80]     similar to above, but requesting host supplied
             [Port #]        and 80 bit used to indicate IIX request
                             (X=0-->IIX, X=1-->no IIX).  This message will
   APPENDICES                                                 Page 5-30
   TYMNET II MESSAGE FORMAT


             [Host # + 8000] replace old 1080 entirely at some point.
     
     
     11 - HOST STATUS REPORT                 Length 6 or 8
             [11, X0+S]      Bits within 'X' are used to designate
                             options as follows, where 'X'='tpsq':
     
                             't' - is Host Type presence designator,
                                   where t=0 if type field present.
                             'p' = 1-t is used to prevent escaping.
                             's' - is the status change bit.  If 0,
                                   then this message represents a host
                                   status change, and the status field
                                   'S' should be processed.
                             'q' - is the HIQ bit.  0 is no IIX capability
                                   declared, 1 is IIX capability.
     
                             Status is in last 2 bits of 'S':
                                     00 - answered
                                     10 - shut or up
                                     01 - down,
                                     11 - host gone away
             [Host # + 8000]
             <8000+Host Type>        - field present only if 't' bit set
     
     12 - ERROR LOG REPORT                   Length 0A
             [1280]
             [H1]            There are 48 bits of data
             [H2]            for a log entry.
             [H3]
     13 - LINK CONDITION REPORT              Length = 8
             [13,n+w]        'n' is report subtype and
                             'w' is supplementary  data as follows:
                     n=80  link down         w= reason for outage
                     n=A0  line down         w= reason for outage
                     n=C0  line up           w= line speed
                     n=E0  link up           w= line speed
                     n=40  overloaded        w= 0
                     n=40  error rate        w= error rate
     
             [6 bits position + 80, (2 bits type, 5 bits link speed)+80]
                             The type bits are as follows:
                                     20 bit - satellite
                                     40 bit - WS8
     
                             Speed bits represent multiples of 2400.
     
             [Neighbor # + 8000]
     
     14 - GENERAL FUNCTION                   Length Variable
             [14,n+80]       Where 7<n<80 is the subtype as follows:
     
          [1488]     HOST COST REPORT        Length = 8
             [Host #]
   APPENDICES                                                 Page 5-31
   TYMNET II MESSAGE FORMAT


             [Host Cost]     - only low order byte of cost is used
     
          [1489]     ACCOUNTING              Length = 8
             [SR2]
             [SR3]           SR2 & SR3 are T-I style msg
     
          [148A]     TRACE RESPONSE          Length Variable
             [Count of nodes + 8000]
             [Host # + 8000 or T-I Node # + C000]
             [Port # + 8000  or Channel # + 8000]
             [Node #]
               :
             [Node #]
     
          if host or node is known
             <Host # + 8000 or t1 Node # + C000>
          else one of the following-
             <-1>     - IF dead end
             <-2>     - IF Sup port
             <-3>     - IF dispatcher port
             <-4>     - IF down line load circuit
             <-5>     - IF command circuit
             <-6>    - IF internal control circuit
             <-7>    - IF transient state
             <-8>    - IF stand alone TYMSAT
          end if
             [Port # + 8000  or Channel # + 8000]
          [148B]     RESPONSE TO PORT STATUS REQUEST Length = 18
         identifier as follows:
             <Host # + 8000>         IF host port
             <-2>                    IF Sup circuit
             <T1 node # + 0C000>     IF terminates on T-I
     
             [Port array # + 8000]
             [bit map]  )
     
                 :      )    - 8 1/2 words of bit map (128 ports)
             [bit map]  )
     
     
          [148C]     HOST KEY                Length = 8
             [Host #]
             [Host Key]      note - only low order byte is used
     
     
          [148D]     SYNC PORT REQUEST RESPONSE      Length Variable
             [# of ports + 8080]     total sync & SIO ports
             [port data]     1 1/2 word per port as follows:
                     Sync ports are listed first starting
                     with port 0, then SIO ports 0 to n
                     SIO ports have bit 4000 on.  The
                     halfword is the neigh # (0 if port
                     has never been active).  Bit 8000
                     on shows port now up.
   APPENDICES                                                 Page 5-32
   TYMNET II MESSAGE FORMAT


     
     
          [148E]     LINK COST REPORT        Length = 8
             [Neighbor Node #]
             [link cost (-1 if down)]
     
     
          [148F]     HOST OUT OF PORTS       Length = 6
             [Host #]
     
          [1490]     HOST HAS PORTS          Length = 6
             [HOST #]
     
     
     
          [1491]     TIME REQUEST            Length = 6
             [Host #]
     
          [1492]     RESPONSE TO BAD GUYS LIST       Length Variable
             [# of entries in list + 8080]
             [Node # + 8000]
               :
             [Node # + 8000]
     
          [1493]     LINK OVERLOADED         Length = 8
             [Neighbor # + 8000]
             [count+8000]
     
     
          [1494]     LINK OUT OF BANDWIDTH   Length = 8
             [Neighbor # + 8000]
             [count + 8000]
     
     
          [1495]     TIMING DIAGNOSTIC RESPONSE Length = 14
     
     
             [time,
              time]  Returned Sup data
             [8000+count] count index is decremented each response
             [time
              time] Node's fastc time
     
     
     
     
     
     15 - NEEDLE ACKNOWLEDGEMENT             Length = 8
             [15,channel #]
             [invoice #
              invoice #]     note - invoice # is 4 bytes long
     
     
     
   APPENDICES                                                 Page 5-33
   TYMNET II MESSAGE FORMAT


     16 - CHANNEL ACKNOWLEDGEMENT            Length = 8
             [16,channel #]
             [invoice #
              invoice #]     note - invoice # is 4 bytes long
     
     
     
     
     17 - OUT OF CHANNELS                    Length = 6
             [1780]
             [Neigh # + 8000]
     
     
     
     
     18 - HAVE FREE CHANNELS                 Length = 6
             [1890]
             [Neigh # + 8000]
   APPENDICES                                                 Page 5-34
   APPENDIX VIII - GLOSSARY


     5.8  APPENDIX VIII - GLOSSARY

     1.  Assign Channel Command - A message which may be  sent  by  the
         Supervisor  to  a  T-II  node  when  a hybrid circuit is being
         built.

              The  assign  channel  command  is  used  only  in  hybrid
         circuit-building  and  then only if the circuit destination is
         in a T-II node.  In that case, the assign channel  command  is
         sent to the first node in the final (destination) T-II portion
         of the circuit.  It causes that  node  to  reserve  a  channel
         (specified by the Supervisor) on the link to the last T-I node
         in the circuit path.

              The node expects to eventually  receive  a  needle  which
         "connects"  the  assigned  channel to the final portion of the
         circuit.  Until then, the node simply holds on to  any  "early
         data"  it  may  receive  on the channel from the T-I neighbor.
         When the needle arrives, any accumulated "early data" are then
         sent on toward the circuit destination.

     2.  Line Attach Process - The process  by  which  a  line  becomes
         attached to (comes up on) a link.

              A line which is not attached to a link is  ordinarily  in
         RESET  state  --  it  is continually transmitting reset frames
         with a "pingpong" count of 0.  As soon as a reset is  received
         on  a line, indicating the presence of a potential neighbor at
         the other end, the line attach process begins.

              The process is different for T-I and T-II links,  but  in
         both  cases  it  involves  the exchange of a certain number of
         reset frames between the two nodes.  Once the  reset  exchange
         sequence  is  complete,  each  node can attach the line to its
         side of the link.

              During the attach process,  the  speed  of  the  line  is
         calculated, based on how it takes a complete reset frame to be
         transmitted (on an SIO line) to received (on a sync line).

              A line which is in the process  of  being  attached  may,
         under certain conditions, be suspended for a short time.

     3.  Backpressure - The process by which data flow in one direction
         on a circuit is temporarily stopped.

              Normally, data should be allowed  to  flow  freely  on  a
         circuit.   Ideally, there should always be "room" for the data
         to move from point to point along the circuit path.   However,
         Bottlenecks  can  develop  in  a  circuit for various reasons;
         when they do, the  flow  of  data  is  restricted  or  stopped
         altogether,  and  the  data tends to "build up" in the node at
         the point where the flow is restricted.  If this were  allowed
         to  happen  without  limit,  the node's capacity to buffer the
   APPENDICES                                                 Page 5-35
   APPENDIX VIII - GLOSSARY


         data might eventually be executed and data could be lost as  a
         result  of  a  BUFFER  ZAP.  The mechanism which prevents this
         from happening is called backpressure.

              There are actually two different backpressure  mechanisms
         in T-II.  In one of them, backpressure is applied and relieved
         explicitly as appropriate -- for instance,  between  the  node
         code  and  the ISIS Dispatcher.  In this case, it is up to the
         receiving process to let the sending process know when it must
         stop and when it may resume sending data on a channel.

              At the link level (ie.  for data flowing between  nodes),
         backpressure  is  applied  automatically  by  the sending node
         whenever a channel's backpressure limit is reached.  The  flow
         of  data  stays  off  until  backpressure  is relieved for the
         channel by the receiving node.

              Each link channel has a backpressure limit which is based
         on  the circuit's throughput class.  The backpressure limit is
         the maximum amount of data that will be sent  on  the  channel
         before  backpressure  relief  is received.  If backpressure is
         relieved for  a  channel  before  its  backpressure  limit  is
         reached  (as  is  usually  the  case), the flow of data on the
         channel is never backpressured.

              Backpressure relief is sent  every  half-second  for  all
         link   channels   which  qualify.   A  channel  qualifies  for
         backpressure relief if the amount of data in its buffer  (ie.,
         data  which have been received on the channel) does not exceed
         the channel's backpressure limit.  The  actual  mechanism  for
         relieving  backpressure  differs  somewhat  for  T-I  and T-II
         links.  Backpressure is relieved for all qualifying  T-I  link
         channels  every  half  second.  For T-II links, relief is sent
         only for channels on  which  data  have  been  received  since
         relief  was  last  sent.   Furthermore,  only gushing channels
         receive backpressure  relief  every  half  second;   trickling
         channels are relieved every 2 seconds.

              The following example illustrates how  backpressure  (and
         backpressure relief) "cascade" along a circuit.

         1.  A user at a terminal connected to a Tymsat (call  it  node
             A) types control-S to halt output to the terminal.  Node A
             continues to receive and  buffer  data  destined  for  the
             terminal  from the next node in the circuit path (node B).
             Eventually, node A discovers that the amount of data it is
             buffering   for   the   terminal   exceeds  the  circuit's
             backpressure limit;  it stops sending backpressure  relief
             for the channel to node B.

         2.  Node B continues to send data to node A until it discovers
             that  it  has  sent up to the circuit's backpressure limit
             without receiving backpressure relief.   It  continues  to
             accumulate  data  from  node  C until it too discovers the
   APPENDICES                                                 Page 5-36
   APPENDIX VIII - GLOSSARY


             amount of buffered data exceeds the backpressure limit and
             stops sending backpressure relief to node C.

         3.  And so on down  the  line  to  the  source  of  the  data,
             typically  an  ISIS  host  in  node  Z.  Node Z explicitly
             applies backpressure through the ISIS Dispatcher interface
             causing the host to suspend output on the channel.

         4.  At  this  point  the  circuit  pipeline  is  full   (fully
             congested)  and  no  data  can pass along in the direction
             toward the terminal.  Each node in  the  circuit  path  is
             buffering  a  certain  amount  of  data for the circuit --
             roughly  between  one  and   two   times   the   circuit's
             backpressure limit.

         5.  Eventually the user types control-Q  in  order  to  resume
             output  to  the  terminal.   As node A starts emptying its
             buffer toward the terminal interface,  it  starts  sending
             backpressure relief again to node B, which starts emptying
             its buffer toward node A and sending  backpressure  relief
             to node C ...  and so on down the line.

         6.  When node Z gets backpressure relief and  starts  emptying
             its  buffer,  it sends a "backpressure-off" message to the
             host and the host is free to start sending again.


     4.  Backpressure Relief Message - A special type of Logical Record
         sent  by  a node to its neighbors every half second to relieve
         backpressure on link channels.

              A node send a backpressure relief message to each of  its
         neighbors  every  half second.  The message specifies the link
         channels for which backpressure is relieved.

              For T-I links, backpressure relief is always sent on link
         channel  (RCN)  1  and  consists of a single bit for each link
         channel.  A 1-bit means that backpressure is relieved for  the
         corresponding channel;  a 0-bit means that backpressure is not
         relieved (this does not mean that backpressure is applied).

              For T-II links, the backpressure relief message  has  the
         following format, where '<>' is a 1-byte quantity:

                          <C0+n><C1><C2>...<Cn>

              Where:
             'n' is a count (0 to 3Fx) of channels for which
             backpressure is being relieved;
         
             'C1 C2 ... Cn' are n ID's of channels for which 
             backpressure is being relieved.
   APPENDICES                                                 Page 5-37
   APPENDIX VIII - GLOSSARY


              Note that this message is sent every half second, even if
         there are no channels for which backpressure is to be relieved
         (in which case 'n' is 0 and  the  entire  message  is  1  byte
         long).

              Backpressure relief is sent only for channels  which  may
         need  it and which qualify for it.  A channel which is gushing
         is considered to need backpressure relief every  half  second;
         a  trickling  channel needs it every two seconds;  channels on
         which  no  data  at  all  have  been  received  do  not   need
         backpressure relief.

              A channel qualifies for backpressure relief if the amount
         of data in its (destination) buffer is less than the circuit's
         Backpressure Limit.  This means that  the  maximum  amount  of
         data that can be accumulated in a buffer is a little less than
         2 times the circuit's backpressure limit.

     5.  Bad Bori - An error condition on a Sync Line  when  the  first
         few bits of a potential frame do not match any valid Bori.

              This error is usually the result of "noise"  on  an  idle
         sync  line.   Occurrences  of  this  error are reported to the
         Crypto log and to the Supervisor log.

     6.  Bandwidth - The capacity of a line or link, usually  expressed
         as  the number of bits (BPS) or characters (CPS) per second it
         is capable of transmitting or receiving.

              Bandwidth is a function primarily of line speed  --  ie.,
         the  rate  at  which  data can be transmitted or received on a
         line.  The bandwidth of a link is the sum of the bandwidths of
         all lines on the link.  The "total bandwidth" of a node is the
         aggregate of the bandwidths of all links on the node.

              "Effective bandwidth" refers to the actual capacity of  a
         line or link, taking into account capacity which is wasted due
         to retransmission of frames.

     7.  BAUDR - An optional Tymfile parameter which defines the  speed
         of the Engine hardware clock for the node code.

              Baudr = 0 (default) ---> the node code assumes  that  the
         hardware  clock  is  operating  at  3600 Hz (hertz, cycles per
         second).  

              Baudr = 2 ---> the node code  assumes  a  clock  rate  of
         14400  Hz.  Baudr = 2 is required only for nodes which have to
         support async terminals at speeds higher than 1200  baud  (ie.
         maximum baud rate of 4800).

     8.  Bubble - The process by which a T-II link acquires  additional
         channels in order to accommodate new circuits.
   APPENDICES                                                 Page 5-38
   APPENDIX VIII - GLOSSARY


              When a node needs to add a new circuit to a link, it  may
         find  that  all the channels allocated to the link are already
         in use.  When this happens, the node will attempt to  allocate
         a  block  of  80x  additional  channels  to the link.  This is
         called a link bubble.

              When a link bubble occurs, the newly  allocated  channels
         have  to  be "inserted" into place so they are contiguous with
         the channels previously allocated.  This results in  a  fairly
         complicated .

              The channels available for  T-II  links  on  a  node  are
         pooled in common and are allocated to links as needed.  Thus a
         link which is down does not "own" any channels.  When  a  link
         comes  up,  it  is  given  an initial allocation of 80x (128d)
         channels.  As circuits are built on the link,  It  can  (  and
         often  does)  happen that all the channels allocated to a link
         will be in use (ie.  will be  connected  to  circuits).   When
         this  happens and a new circuit needs to be built on the link,
         the link must first acquire additional channels  in  order  to
         accommodate  it.  Channels are always acquired -- and released
         -- in groups of 80x.

              The total number of link channels  available  in  a  node
         (set  at  configuration  time)  can be allocated in almost any
         combination (always in groups of 80x) among  the  node's  T-II
         links.   The  bubble  process  is complicated by the fact that
         when a link bubbles,  its  newly  acquired  channels  must  be
         "inserted"  into  place so they are contiguous with the link's
         existing channel range;  this may (and usually  does)  involve
         "shifting"  the channel ranges allocated to other links on the
         node.

              It is possible for a node to run out  of  link  channels.
         When  this  happens,  no  new  links  can  come  up, and if an
         existing link attempts  to  bubble,  it  will  be  taken  down
         (thereby,  incidentally,  freeing up at least one half-page of
         link channels).

              Bubbling applies only to  T-II  links.   A  T-I  link  is
         allocated  a  fixed number of channels when the link comes up.
         When those are used up, no more circuits can be added  to  the
         link.

     9.  Channel - A "port" into which one end of a circuit segment can
         be "plugged".

              Each  node  has  a  fixed  number  of  channels  (set  at
         configuration  time)  which  represents  the maximum number of
         circuit connections that can be made in  the  node.   Channels
         are  grouped  according  to destination.  The lower end of the
         range  of  a  node's  channels  are   reserved   for   circuit
         connections  which  terminate  on the node (dispatcher, async,
         internal host processes).  These channel assignments are fixed
   APPENDICES                                                 Page 5-39
   APPENDIX VIII - GLOSSARY


         -- ie., a given channel in any of these ranges always leads to
         the same process or interface.  The upper end  of  the  node's
         channel  range  is  a  common pool of link channels.  Channels
         from this pool are allocated to links (in groups  of  80x)  as
         they  are  needed  through the BUBBLE process;  channels which
         are no longer needed by links are returned to the pool through
         the  SHRINK  process.  Link channel assignments are not fixed;
         a channel which is "owned" by link at one time may be owned by
         another some other time.

              A channel is considered "active" or "in use" when  it  is
         connected to a circuit;  otherwise it is considered available.
         When a circuit connection needs  to  be  made  to  a  link  or
         process,  the  node code will typically make the connection to
         the first available channel in the appropriate channel  range.
         When  an  existing  circuit  is ZAPPED (or torn down), the two
         channels that were connected to it become available again.

              When a circuit segment is built in  a  node,  a  pair  of
         buffers is acquired by the circuit.  One buffer of the pair is
         assigned to each of the channels on either end of the  circuit
         segment.   The  data  "coming from" a channel is stored in the
         buffer assigned to it;  data "going to" a channel  comes  from
         the other (or complementary) buffer of the pair.

    10.  CRQ - The portion of the node code (in SWITCH) which  performs
         circuit- building functions within the node.

    11.  DISPI - A collection of process in an ISIS node  which  handle
         communications  between  the  node  code (slot 0) and the ISIS
         Dispatcher.

    12.  Gobbler - A control code which "erases" buffered data  in  its
         path as it travels along a circuit.

              A gobbler is used to "flush" data from a circuit (usually
         because  it  is  no  longer  wanted);   it  does not cause the
         circuit to be torn down and does not  affect  any  data  which
         follow it.

              A T-I gobbler is an unescaped '02' byte.  There  are  two
         types of T-II gobblers:

         1.  A  '0308'  is  a  regular   gobbler   and   is   used   on
             non-rebildable circuits.  

         2.  A Fat Gobbler '0309' is used to gobble data on  rebildable
             circuits;   it  is always followed by a 4-byte value which
             is the Sequence Number of the last data character gobbled.


    13.  REBILD - A feature of T-II node code (version 5+) which, under
         certain  conditions,  permits circuits which are zapped due to
         link outages to be rebuilt in a manner that is (more or  less)
   APPENDICES                                                 Page 5-40
   APPENDIX VIII - GLOSSARY


         transparent to the user.

              On a Rebuildable circuit, the node at  each  end  (origin
         and  destination)  maintains  a special History Buffer for the
         data that it transmits on the circuit.  Each node also keeps a
         sequential  count of the bytes transmitted and received on the
         circuit.  The history buffer  always  contains  the  last  <n>
         bytes transmitted by the node, where <n> is never greater than
         the maximum number  of  bytes  which  could  possibly  be  "in
         transit"  to  the  node  on  the other end.  Thus, the history
         buffer always contains at least  all  the  data  that  may  be
         buffered in nodes along the circuit path at any one time.

              When a Rebuildable circuit is zapped due to a link outage
         (not,  obviously,  if  it  is  zapped  by  either  end  of the
         circuit), a special zapper, called a FAT or  SOFT  ZAPPER,  is
         used  to tear the circuit down.  The origin node then requests
         a new circuit path from the Supervisor;  if  such  a  path  is
         available,  the  circuit  is  rebuilt  using  a special REBILD
         NEEDLE.  As soon as  the  rebuilt  circuit  is  complete,  the
         terminating nodes simply send each other the contents of their
         history buffers, along with the sequence numbers of the  first
         characters  in  those  buffers.   Each  node uses the sequence
         number of the  last  character  it  had  received  before  the
         circuit  got  zapped  to  synchronize on the stream of history
         data.  Once  synchronization  is  achieved,  circuit  activity
         resumes  from  where  is  had  let  off  as though nothing had
         happened.

              Two conditions must be met for a circuit to be considered
         Rebuildable.   The  circuit  path must include only T-II nodes
         with code version 5+.  (Actually, for the purposes of  Rebild,
         any  all  T-II  portion  of  a Hybrid Circuit which meets this
         condition also qualifies.  in this case,  however,  only  that
         portion  of  the  circuit  is Rebuildable.) And Rebild must be
         enabled in the two nodes which terminate the circuit (or  T-II
         portion  of  the  circuit).   An Internal Circuit (including a
         T-II portion of a hybrid circuit which is entirely internal to
         a T-II node) is never considered Rebuildable.

              In order for a Rebuildable circuit to be following a zap,
         It  is  only  necessary for some alternate path connecting the
         two terminating nodes to be available.   Needless  to  say,  a
         circuit  cannot  be  rebuilt  if  either  terminating node has
         crashed.  Nor will a circuit be rebuilt if the zap  originates
         in either terminating node (this for the obvious reason that a
         circuit may be legitimately zapped from either end).

    14.  Relative Channel  Number  -  A  channel's  number  (or  index)
         relative  to some subrange of a node's channels;  the subrange
         typically "belongs" to a process (like the  Dispatcher)  or  a
         link.
   APPENDICES                                                 Page 5-41
   APPENDIX VIII - GLOSSARY


              The entire range of channels on a node  is  divided  into
         several  sub-ranges  which  "belong  to" specific processes or
         interfaces.  Each channel sub-range  has  a  relative  channel
         number  0  which  corresponds to an absolute channel number in
         the node.

              Some of these subranges are more or less fixed and useful
         to know:

         1.  The Internal host processes are assigned the range of  10x
             (16d) channels beginning with absolute channel number 30x.
             (internal host  relative  channel  number  0  is  absolute
             channel number 30).

         2.  The async ports on a Tymsat/Consat are associated with the
             sub-range  of  channels  beginning  with  absolute channel
             number 40x.

         3.  The Dispatcher  interface  on  an  ISIS  node  "owns"  the
             sub-range  of  channels  beginning  with  absolute channel
             number 60x.

         4.  The pool of channels available for links begins  with  the
             absolute  channel  number  specified  by the symbol LNKZFL
             (available in the XRAY symbol table).  In  addition,  each
             active  link  on  a node number 0 which corresponds to the
             absolute channel number specified in the CHN0 field of the
             XRAY 'KD' display.


    15.  Retransmission - The transmission on a link of a packet  which
         has already been transmitted at least once before.

              Under  ideal  conditions,  a  node  will  never  have  to
         retransmit  a  packet on a link.  This means that every packet
         transmitted reaches the neighbor node uncorrupted (ie.  with a
         good  Checksum),  and  Acknowledgements are received for those
         packets frequently enough to prevent the link's output  WINDOW
         from filling up.

              On any link, a node can have a fixed  maximum  number  of
         packets  "outstanding"  (that  is,  packets  which  have  been
         transmitted and for which acknowledgements have not  yet  been
         received).  That limit is called the link's WINDOW SIZE and is
         set at configuration time.  If that limit is reached,  no  new
         packets  will  be  transmitted.   Instead, the node will begin
         retransmitting the oldest outstanding  packet  in  the  window
         until  it  receives  an acknowledgement for that packet or any
         other packet in the window.

              Retransmissions  typically  result  from   one   of   two
         conditions.   The  most  common  is  LINE  ERRORS  which cause
         packets to be corrupted in transmission.   If  any  packet  is
         received  with  a  bad  checksum,  the receiving node will not
   APPENDICES                                                 Page 5-42
   APPENDIX VIII - GLOSSARY


         acknowledge it;  it will also not acknowledge  any  subsequent
         packets  received, even if their checksums are good, until the
         packet in error is received with  a  food  checksum  (ie.   is
         transmitted).  Thus, any time a packet is corrupted on a link,
         at least one retransmission will result.

              A  second  cause  of  retransmission  is  a   significant
         difference  between  the  speed with which two nodes on a link
         are processing data.  If  one  node  (the  re-transmitter)  is
         making  and  sending  packets  a  great  deal  faster than the
         neighbor (re-receiver)  node  is  tearing  them  down,  it  is
         possible  for the second node to "get behind" in acknowledging
         the packets it has received.  (packets  are  acknowledged  not
         when  they  are  received,  but only after they have been torn
         down.) This might happen, for instance, between a Switcher and
         a  heavily  loaded  ISIS  node.   a  high retransmission rate,
         without a correspondingly high rate of line errors, on a  link
         is indicative of such a problem.

    16.  Shrink - The process by which a  T-II  link  gives  up  unused
         channels of 80x channels may (and usually does) get to a point
         where it has a large number of unused  channels.   This  is  a
         natural  result  of circuits' being zapped as users log off at
         the end of the workday.  When this number becomes much greater
         than  80x  (Shrink  and  Bubble  both operate on groups of 80x
         channels), contiguous group of 80x channels (a  half-Page)  is
         returned to the common pool of channel resources.  Shrink is a
         fairly complicated process for two reasons:

         1.  The active channels on the link have to be shuffled around
             so  that  the last 80x contiguous channels on the link can
             be freed.

         2.  The Shrink has to occur on both nodes on the link  at  the
             same  time  so  that  the remaining active channels on the
             link stay synchronized.


              For these reasons, only the master node  on  a  link  can
         issue  a  Shrink  command;   the slave node can only request a
         Shrink.  This prevents a potentially disastrous race condition
         in  which both nodes might initiate a Shrink at about the same
         time.


          (Author of above, Eric Valentino, is the TYMNET  Headquarters
     support person for TYMNET-II Node Code.)
   APPENDICES                                                 Page 5-43
   APPENDIX IX - TYMNET CONTROL CHARACTERS AND CHARACTER PAIRS


     5.9  APPENDIX IX - TYMNET CONTROL CHARACTERS AND CHARACTER PAIRS


     0301        --->            Hard Zapper
     0301        --->            Smallest Zapper
     0302        --->            Soft Zapper
     0303        --->            Non-Gobbling Zapper
     0304        --->            Largest Skinny Zapper
     0305        --->            Fat Zapper (Node Pair follows)
     0308        --->            Gobbler
     0309        --->            Fat Gobbler (new sequence number in second HW)
     030A        --->            SQSET - Forces receive seq no. to following da
     030B        --->            SQF - seq no. fis for Rebild
     030C        --->            SQACK - seq no. Ack for Rebuild
     0310        --->            Needle Point
     0311        --->            Needle Eye
     0312        --->            Message for terminal in login
     0313        --->            Error in Circuit request
   APPENDICES                                                 Page 5-44
   APPENDIX X - HEX TO ASCII CONVERSION CHART


     5.10  APPENDIX X - HEX TO ASCII CONVERSION CHART


                                FIRST DIGIT
      
                         0    1   2   3  4  5  6  7  PARITY NOT SET
                         8    9   A   B  C  D  E  F  PARITY SET
      
                    0   NUL  DLE  SP  0  @  P  `  p
                    1   SOH  DC1  !   1  A  Q  a  q
               S    2   STX  DC2  "   2  B  R  b  r
               E    3   ETX  DC3  #   3  C  S  c  s
               C    4   EOT  DC4  $   4  D  T  d  t
               O    5   ENQ  NAK  %   5  E  U  e  u
               N    6   ACK  SYN  &   6  F  V  f  v
               D    7   BEL  ETB  '   7  G  W  g  w
                    8   BS   CAN  (   8  H  X  h  x
               D    9   HT   EM   )   9  I  Y  i  y
               I    A   LF   SUB  *   :  J  Z  j  z
               G    B   VT   ESC  +   ;  K  [  k  {
               I    C   FF   FS   ,   <  L  \  l  |
               T    D   CR   GS   -   =  M  ]  m  }
                    E   SO   RS   .   >  N  ^  n  ~
                    F   SI   US   /   ?  O  _  o  DEL
   APPENDICES                                                 Page 5-45
   ISIS HOST MANAGEMENT


     5.11  ISIS HOST MANAGEMENT

          NOTICE...ALL management of hosts is performed by  the  slots!
     In  particular,  the slot MUST issue an 0:04 message to change the
     state of the host, and in particular to create  initial  knowledge
     of  host  numbers  and  the number of ports to apply to that host.
     The dispatcher will not do any management, other than  update  the
     HOSTS  and  PORTS  tables  (for  it's own information) unless some
     condition outside the slot (halting  the  slot,  etc)  forces  the
     dispatcher  to  take  all  hosts  down  and  zap all circuits.  In
     particular, no attempt will be made to avoid  repetitive  messages
     (i.e.,  host  12 down, host 12 down,...), although TYMNET may have
     strong objections!.

          If the slot crashes, all circuits will  be  zapped,  and  all
     hosts  will  be set "DOWN".  If the slot is HALTED, the hosts will
     instead be set "GONE".

          If the slot issues a host message 0:04,  0:0A  or  0:0C,  the
     dispatcher  will  verify that "RH " is less than HOSTN, else it is
     cause to crash the slot!

          A host MUST be  set  GONE  before  the  host  number  can  be
     changed,  but  the  host  number  may be changed in the process of
     bringing the host from GONE to any other state.

          For the 0:0A and 0:0C messages, a mismatch of host numbers is
     also cause to crash the slot.

          However, in the TYMNET-I environment, a "RH " of zero is  the
     ONLY  legitimate value, and in this environment, HOSTN is taken to
     be 1 for each slot--this will cause a crash  for  any  attempt  to
     address other than host 0!!

          The TYMNET-II node code will  be  configured  for  a  certain
     number  of hosts and ports.  If these are exceeded, a 0:0B message
     is issued back to the requesting slot, indicating the error.

          If "CNTRL" masked with 04 or 08  is  zero  (disallowing  host
     number or port changes), then (and ONLY then) the values presented
     by the slot for that "RH " will be ignored, and  the  assembled-in
     values will be used instead!

          Once a circuit has been built to a host, it is  tied  to  the
     slot.   In  particular,  the dispatcher will not have knowledge of
     which circuits correspond to a host, and that host may be taken to
     any  state,  including  "GONE",  without  affecting  the  existing
     circuits.  The slot must manage this function if it wants to  drop
     circuits when the host goes down.
[g