TAPCHG	MACRO 12.5-46.0 16:12  8-JAN-86 PAGE 1
TAPCHG.MAC	12-MAY-81 14:40	

     1				        TITLE   TAPCHG
     2				;       EXTERNAL  MAKCHG REMOVED 9/16/77 CLC
     3				;
     4				;       PURPOSE IS TO RECEIVE RECORDS FROM PJ WHICH
     5				;       INDICATE SPOOL REQUESTS PROCESSES ON OTHER SYSTEMS
     6				;       AND CREATE ACCT. RECORDS FOR THEM.
     7				;
     8				;       ACCUMULATOR ASSIGNMENTS
     9				;
    10			000000	        AC= 0                   ;BASIC ACCUMULATORS
    11			000001	        AC1= 1                  ;SAME
    12			000002	        AC2= 2                  ;
    13			000003	        AC3= 3                  ;
    14			000004	        AC4= 4                  ;
    15			000005	        AC5= 5                  ;
    16			000006	        REQNUM= 6               ;HOLDS TAPE REC. REQ. NUM.
    17			000007	        DATES= 7                ;HOLDS TAPE REC. DATES
    18			000010	        BUFADR= 10              ;CONTAINS ADDRESS OF GD BUFFER
    19			000001	        GDCHL= 1                ;CHANNEL FOR READING IN REQS
    20			000005	        ACTCHL= 5               ;CHANNEL FOR ACCOUNTING FILE
    21			000011	        RCHL==11
    22			000015	        CH= 15          ;CHANNEL FOR AUX CIRCUITS
    23			000017	        P= 17                   ;PUSH AND POP REGISTER
    24	000137			        LOC 137
    25	000137	000001	000002	        XWD     1,2     ;1.2
    26
    27				;The accounting record is written in this routine and this is what it looks
    28				;like:
    29				;       Status = 3 if delivery mode is notpickup or delivery charge - this 
    30				;       also means the record will be written to Parchg.dat.  Otherwise
    31				;       it will be written to the monthly batch accounting file.
    32				;       Request # (only last 3 digits if status = 3)
    33				;       Month, day, hour and minute of request
    34				;       Username
    35				;       Gan
    36				;       Aun
    37				;       District
    38				;       Project code
    39				;       Customer or inhouse (1 or 0)
    40				;       Space and "1" for Job type
    41				;       # pages spooled
    42				;       Space and # parts (1, 2, 3, or 4)
    43				;       Decollation flag
    44				;       6 blanks
    45				;       7 "0's" for tapbuy
    46				;       Year, month, and day for Date Done
    47				;       Crlf for End Mark
    48
    49
    50	000000'			        RELOC
    51
    52			000000	        debug==0                ;0 for real, 1 for test
    53
TAPCHG	MACRO 12.5-46.0 16:12  8-JAN-86 PAGE 1-2
TAPCHG.MAC	12-MAY-81 14:40	

    54				        ife     debug,<
    55	000000'	000001	133677	splgan: 1,,133677               ;Spool's aun
    56	000001'	000001	000002	owner:  1,,2                    ;Owner is *1batch
    57				                >
    58
    59				        ifn     debug,<
    60				splgan: 3,,234620               ;Sppoper's aun
    61				owner:  3,,234620               ;Sppoper's aun
    62				                >
    63
    64	000002'	200740	001021'	START: MOVE     P,[IOWD 20,PDL] ;SET UP PUSH AND POP POINTER
    65	000003'	047000	000000	        RESET
    66				;
    67				;       SETUP CHANNEL AND DO HANDSHAKE WITH MASTER
    68				;
    69	000004'	201640	000214	        MOVEI   CH,214          ;SET UP NO ECHO
    70	000005'	047640	777752	        SETMOD  CH,             ;SAME
    71	000006'	561640	000004	        HRROI   CH,4            ;SEND OFF CHARACTERS
    72	000007'	042640	000001	        AUXCAL  CH,1            ;SEND A 1
    73	000010'	042640	000002	        AUXCAL  CH,2            ;SEND A 2
    74	000011'	042640	000003	        AUXCAL  CH,3            ;SEND A 3
    75	000012'	042640	000004	        AUXCAL  CH,4            ;SEND A 4
    76				;
    77				;       GET HANDSHAKE BACK
    78				;
    79	000013'	561640	000001	        HRROI   CH,1            ;GET READY TO RECEIVE CHARACTERS
    80	000014'	042640	000000	TRYAGN: AUXCAL  CH,AC           ;RECEIVE A CHARACTER
    81	000015'	254000	000014'	        JRST    .-1             ;WAIT TIL WE GET IT
    82	000016'	302000	000001	        CAIE    AC,1            ;SEE IF IT IS A 1
    83	000017'	254000	000014'	        JRST    TRYAGN          ;NO , GO GET IT TIL IT IS
    84	000020'	042640	000000	        AUXCAL  CH,AC           ;NEXT NEXT HANDSHAKE
    85	000021'	254000	000020'	        JRST    .-1             ;WAIT TIL WE GET IT
    86	000022'	302000	000002	        CAIE    AC,2            ;SEE IF IT IS A 2
    87	000023'	254000	000014'	        JRST    TRYAGN          ;NO, THEN GO START ALL OVER
    88	000024'	042640	000000	        AUXCAL  CH,AC           ;GET NEXT PART OF HAND SHAKE
    89	000025'	254000	000024'	        JRST    .-1             ;WAIT TIL WE GET IT
    90	000026'	302000	000003	        CAIE    AC,3            ;SEE IF IT IS A 3
    91	000027'	254000	000014'	        JRST    TRYAGN          ;NO, START ALL OVER
    92	000030'	042640	000000	        AUXCAL  CH,AC           ;GET LAST PART OF HANDSHAKE
    93	000031'	254000	000030'	        JRST    .-1             ;WAIT TIL WE GET IT
    94	000032'	302000	000004	        CAIE    AC,4            ;SEE IF IS A 4
    95	000033'	254000	000014'	        JRST    TRYAGN          ;NO, THEN START ALL OVER
    96				;
    97				;       GET REQUEST NUMBER AND DATES FROM MASTER
    98				;
    99	000034'	201240	000005	SEMSTR: MOVEI   AC5,5           ;NO. REQ. NO. BYTES TO RECEIVE
   100	000035'	400300	000000	        SETZ    REQNUM,         ;ZERO HOLDING AREA
   101	000036'	200040	001022'	        MOVE    AC1,[POINT 6,REQNUM,^D5] ;POINT TO STORAGE AREA
   102	000037'	561640	000001	        HRROI   CH,1            ;SHOW GOING TO RECEIVE CHARACTERS
   103	000040'	042640	000000	REQINP: AUXCAL  CH,AC           ;GET A BYTE
   104	000041'	254000	000040'	        JRST    .-1             ;WAIT TIL WE GET IT
   105	000042'	136000	000001	        IDPB    AC,AC1          ;STORE BYTE
   106	000043'	367240	000040'	        SOJG    AC5,REQINP      ;GO GET REST OF NUMBER
TAPCHG	MACRO 12.5-46.0 16:12  8-JAN-86 PAGE 1-3
TAPCHG.MAC	12-MAY-81 14:40	

   107				;
   108				;       GET DATES
   109				;
   110	000044'	400340	000000	        SETZ    DATES,          ;ZERO HOLDING AREA
   111	000045'	200040	001023'	        MOVE    AC1,[POINT ^D8,DATES,^D1] ;POINT TO STORAGE
   112	000046'	042640	000000	        AUXCAL  CH,AC           ;GET DATE
   113	000047'	254000	000046'	        JRST    .-1             ;WAIT TIL WE GET IT
   114	000050'	136000	000001	        IDPB    AC,AC1          ;SAVE DATE
   115	000051'	042640	000000	        AUXCAL  CH,AC           ;GET REST OF DATE
   116	000052'	254000	000051'	        JRST    .-1             ;WAIT
   117	000053'	136000	000001	        IDPB    AC,AC1          ;SAVE DATE
   118	000054'	200040	001024'	        MOVE    AC1,[POINT ^D8,DATES,^D19] ;POINT TO STORAGE
   119	000055'	042640	000000	        AUXCAL  CH,AC           ;GET A BYTE
   120	000056'	254000	000055'	        JRST    .-1             ;WAIT
   121	000057'	136000	000001	        IDPB    AC,AC1          ;SAVE BYTE
   122	000060'	042640	000000	        AUXCAL  CH,AC           ;GET LAST BYTE
   123	000061'	254000	000060'	        JRST    .-1             ;WAIT
   124	000062'	136000	000001	        IDPB    AC,AC1          ;SAVE DATE
   125				;
   126				;       SET UP CHANNELS TO DO THE I/O
   127				;
   128	000063'	050040	000756'	        OPEN    GDCHL,GDDEF     ;GET CHANNEL FOR GD REQUEST
   129	000064'	254000	000667'	        JRST    ERROR1          ;CANT GET A CHANNEL
   130	000065'	064040	000001	        INBUF   GDCHL,1         ;SET INPUT BUFFER SIZE
   131	000066'	065040	000001	        OUTBUF  GDCHL,1         ;SAME FOR OUTPUT
   132	000067'	050240	000730'	        OPEN    ACTCHL,ACTDEF   ;GET CHANNEL FOR ACCT. RECORD
   133	000070'	254000	000667'	        JRST    ERROR1          ;CANT GET CHANNEL
   134	000071'	064240	000001	        INBUF   ACTCHL,1
   135	000072'	065240	000001	        OUTBUF  ACTCHL,1
   136				;
   137	000073'	402000	000706'	ALLOVR: SETZM   ,BLKPTR         ;ZERO BLK COUNTER
   138	000074'	200000	000000'	        MOVE    AC,SPLGAN
   139	000075'	202000	000772'	        MOVEM   AC,GDBLK+3      ;STORE FOR LOOKUP
   140	000076'	076040	000767'	        LOOKUP  GDCHL,GDBLK     ;GO GET GD TABLE
   141	000077'	254000	000674'	        JRST    GDERR           ;CANT FIND TABLE
   142	000100'	402000	000771'	        SETZM   ,GDBLK+2        ;ZERO FOR ENTER
   143	000101'	202000	000772'	        MOVEM   AC,GDBLK+3      ;FOR LATER ENTER ON TABLE
   144	000102'	513000	000770'	        HLLZS   ,GDBLK+1        ;ZERO FOR LATER ENTER
   145	000103'	056040	000000	GETNEX: IN      GDCHL,          ;READ A REQ. IN
   146	000104'	334000	000000	        SKIPA                   ;SKIP ON GOOD READ
   147	000105'	254000	000655'	        JRST    WHYEND          ;SEE WHY WE CAME HERE
   148	000106'	350000	000706'	        AOS     ,BLKPTR         ;INCREASE BLK COUNTER
   149	000107'	540400	000765'	        HRR     BUFADR,GDIN+1   ;GET BUFFER ADDRESS
   150	000110'	271400	000001	        ADDI    BUFADR,1        ;ADJUST TO CORRECT POSITION
   151	000111'	200020	000010	        MOVE    AC,@BUFADR      ;GET GD REQ. NUM
   152	000112'	621000	770000	        TLZ     AC,770000       ;ZERO OFF STATUS
   153	000113'	312000	000006	        CAME    AC,REQNUM       ;SEE IF GD MATCHES REQ. RECORD
   154	000114'	254000	000103'	        JRST    GETNEX          ;NO MATCH, GET NEXT REQUEST
   155	000115'	554120	000010	        HLRZ    AC2,@BUFADR     ;GET STATUS OF REQUEST
   156	000116'	200040	000010	        MOVE    AC1,BUFADR      ;GET BUFFER POINTER
   157	000117'	271040	000003	        ADDI    AC1,3           ;POINT TO REQ. DATE OF GD
   158	000120'	554060	000001	        HLRZ    AC1,@AC1        ;GET GD REQ. DATE
   159	000121'	554000	000007	        HLRZ    AC,DATES        ;GET TAPE REQ. REQ. DATE
TAPCHG	MACRO 12.5-46.0 16:12  8-JAN-86 PAGE 1-4
TAPCHG.MAC	12-MAY-81 14:40	

   160	000122'	312000	000001	        CAME    AC,AC1          ;SEE IF DATES MATCH
   161	000123'	254000	000103'	        JRST    GETNEX          ;NO, THEN GET NEXT REQ.
   162	000124'	242100	777764	        LSH     AC2,-^D12       ;SHIFT STATUS OVER TO CHECK
   163	000125'	402000	001020'	        SETZM   REMLOC#
   164	000126'	303100	000004	        CAILE   AC2,4           ;PEND, IN PROCE OR TAPE XFER
   165	000127'	254000	000652'	        JRST    DONEIT          ;YES, THEN DONT CREATE ACCT REC.
   166				;
   167				;       HAVE REQUEST THAT MATCHES THE TAPE RECORD SPECIFIED
   168				;       BUILD ACCT. REC. AND FLAG REQUEST AS COMPLETED
   169				;
   170	000130'	200040	000010	GOTIT:  MOVE    AC1,BUFADR      ;GET BUFFER POINTER
   171	000131'	271040	000021	        ADDI    AC1,21          ;POINT TO COMPLETED DATE AREA
   172	000132'	542360	000001	        HRRM    DATES,@AC1      ;STORE COMPLETED DATE TO BUFFER
   173	000133'	554020	000010	        HLRZ    AC,@BUFADR      ;GET STATUS HALF WD
   174	000134'	620000	770000	        TRZ     AC,770000       ;MASK OFF OLD STATUS
   175	000135'	435000	050000	        IORI    AC,50000        ;MASK IN COMPLETED FLAG
   176	000136'	506020	000010	        HRLM    AC,@BUFADR      ;PUT BACK TO BUFFER
   177	000137'	200240	001025'	        MOVE    AC5,[POINT 7,RECORD] ;POINT TO STORAGE
   178	000140'	200060	000010	        MOVE    AC1,@BUFADR     ;GET REQUEST NUMBER
   179	000141'	242040	000006	        LSH     AC1,6           ;LEFT JUSTIFY FIGURE
   180	000142'	201200	000005	        MOVEI   AC4,5           ;NO. CHAR TO PROCESS
   181	000143'	260740	000473'	        PUSHJ   P,CONINS        ;CONVERT TO ASCII AND STORE
   182	000144'	271400	000004	        ADDI    BUFADR,4                ;POINT TO PRI LOC
   183	000145'	550020	000010	        HRRZ    AC,@BUFADR      ;GET IT
   184	000146'	405000	000777	        ANDI    AC,777          ;KEEP IT
   185	000147'	542000	001020'	        HRRM    AC,REMLOC       ;SAVE IT
   186	000150'	275400	000001	        SUBI    BUFADR,1
   187	000151'	550020	000010	        HRRZ    AC,@BUFADR      ;GET WHERE TO PRINT
   188	000152'	405000	000007	        ANDI    AC,7            ;KEEP IT
   189	000153'	506000	001020'	        HRLM    AC,REMLOC
   190	000154'	554060	000010	        HLRZ    AC1,@BUFADR     ;GET DATE OF REQUEST
   191	000155'	231040	000037	        IDIVI   AC1,^D31        ;DIVIDE BY 31
   192	000156'	271100	000001	        ADDI    AC2,1           ;CREATE CORRECT DAY
   193	000157'	200000	000001	        MOVE    AC,AC1          ;GET MONTH AND YR
   194	000160'	231000	000014	        IDIVI   AC,14           ;DIVIDE BY 12
   195	000161'	271040	000001	        ADDI    AC1,1           ;CORRECT MONTH
   196	000162'	200000	000001	        MOVE    AC,AC1          ;PUT MONTH IN CORRECT PLACE
   197	000163'	202100	000016	        MOVEM   AC2,16          ;SAVE DAY FOR LATER
   198	000164'	260740	000516'	        PUSHJ   P,DECINS        ;CONVERT TO ASCII AND STORE
   199	000165'	200000	000016	        MOVE    AC,16           ;GET THAT DAY WE SAVED
   200	000166'	260740	000516'	        PUSHJ   P,DECINS        ;CONVERT TO ASCII AND STORE
   201	000167'	275400	000002	        SUBI    BUFADR,2        ;POINT TIME OF REQUEST
   202	000170'	550020	000010	        HRRZ    AC,@BUFADR      ;GET TIME OF REQUEST
   203	000171'	231000	000074	        IDIVI   AC,^D60         ;CREATE HOURS AND MINUTES
   204	000172'	202040	000016	        MOVEM   AC1,16          ;SAVE MINUTES
   205	000173'	260740	000516'	        PUSHJ   P,DECINS        ;CONVERT AND STORE
   206	000174'	200000	000016	        MOVE    AC,16           ;GET MINUTES
   207	000175'	260740	000516'	        PUSHJ   P,DECINS        ;CONVERT AND STORE
   208	000176'	271400	000030	        ADDI    BUFADR,30       ;POINT TO CHARAGEABLE USER
   209	000177'	120060	000010	        DMOVE   AC1,@BUFADR     ;GET USERNAME
   210	000200'	201200	000006	        MOVEI   AC4,6
   211	000201'	260740	000473'	        PUSHJ   P,CONINS        ;CONVERT AND STORE
   212	000202'	201200	000006	        MOVEI   AC4,6   
TAPCHG	MACRO 12.5-46.0 16:12  8-JAN-86 PAGE 1-5
TAPCHG.MAC	12-MAY-81 14:40	

   213	000203'	200040	000002	        MOVE    AC1,AC2
   214	000204'	260740	000473'	        PUSHJ   P,CONINS
   215	000205'	275400	000011	        SUBI    BUFADR,11
   216	000206'	510060	000010	        HLLZ    AC1,@BUFADR     ;GET GAN
   217	000207'	201200	000006	        MOVEI   AC4,6           ;MAX SIZE OF GAN
   218	000210'	260740	000501'	        PUSHJ   P,OCTINS        ;CONVERT AND STORE
   219	000211'	514060	000010	        HRLZ    AC1,@BUFADR     ;GET UUN
   220	000212'	201200	000006	        MOVEI   AC4,6           ;SIZE OF UUN
   221	000213'	260740	000501'	        PUSHJ   P,OCTINS        ;CONVERT AND STORE
   222	000214'	271400	000001	        ADDI    BUFADR,1        ;POINT TO DISTRICT WORD
   223	000215'	554020	000010	        HLRZ    AC,@BUFADR      ;GET DISTRICT HALF WORD
   224	000216'	405000	000777	        ANDI    AC,777          ;KEEP JUST THE DISTRICT
   225	000217'	202000	000704'	        MOVEM   AC,SAVE+1       ;SAVE FOR LATER
   226	000220'	201200	000003	        MOVEI   AC4,3           ;WIDTH OF FIELD
   227	000221'	260740	000447'	        PUSHJ   P,SUPZRO        ;CONVERT AND SUPRESS BLANKS
   228	000222'	275400	000007	        SUBI    BUFADR,7        ;POINT TO PROJECT CODE
   229	000223'	200040	001026'	        MOVE    AC1,[POINT 6,AC] ;DUMMY POINTER
   230	000224'	540040	000010	        HRR     AC1,BUFADR      ;CORRECT POINTER
   231	000225'	201200	000014	        MOVEI   AC4,14          ;WIDTH OF FIELD
   232	000226'	134000	000001	        ILDB    AC,AC1          ;GET A CHARACTER
   233	000227'	271000	000040	        ADDI    AC,40           ;CONVERT TO ASCII
   234	000230'	136000	000005	        IDPB    AC,AC5          ;STORE CHARACTER
   235	000231'	367200	000226'	        SOJG    AC4,.-3         ;GO DO MORE PROJECT CODE
   236	000232'	275400	000005	        SUBI    BUFADR,5        ;POINT TO CUSTOMER FLAG
   237	000233'	554060	000010	        HLRZ    AC1,@BUFADR     ;GET THAT HALF WORD
   238	000234'	201000	000061	        MOVEI   AC,61           ;FOR POSSIBLE CUSTOMER
   239	000235'	606040	000040	        TRNN    AC1,40          ;SEE IF CUSTOMER FLAG SET
   240	000236'	201000	000060	        MOVEI   AC,60           ;CUSTOMER FLAG NOT SET
   241	000237'	136000	000005	        IDPB    AC,AC5          ;STORE CUSTOMER INDICATOR
   242	000240'	201000	000040	        MOVEI   AC,40           ;STORE FOR JOB TYPE OF 1
   243	000241'	136000	000005	        IDPB    AC,AC5          ;SAME
   244	000242'	201000	000061	        MOVEI   AC,61           ;GET THE ONE
   245	000243'	136000	000005	        IDPB    AC,AC5          ;STORE JOB TYPE
   246	000244'	275400	000001	        SUBI    BUFADR,1        ;POINT TO VOLUME
   247	000245'	554020	000010	        HLRZ    AC,@BUFADR      ;GET PAGES SPOOLED
   248	000246'	201200	000006	        MOVEI   AC4,6           ;SIZE OF FIELD
   249	000247'	260740	000447'	        PUSHJ   P,SUPZRO        ;CONVERT AND SUPRESS ZERO
   250	000250'	201000	000040	        MOVEI   AC,40           ;FOR NO. PARTS
   251	000251'	136000	000005	        IDPB    AC,AC5          ;STORE FOR PARTS
   252	000252'	271400	000001	        ADDI    BUFADR,1        ;POINT TO NO. PARTS WD
   253	000253'	554020	000010	        HLRZ    AC,@BUFADR      ;GET HALF WD WITH NO. PARTS
   254	000254'	405000	070000	        ANDI    AC,70000        ;MASK THE PARTS
   255	000255'	242000	777764	        LSH     AC,-14          ;RIGHT JUSTIFY FIGURE
   256	000256'	271000	000060	        ADDI    AC,60           ;CONVERT TO ASCII
   257	000257'	136000	000005	        IDPB    AC,AC5          ;STORE NO. PARTS
   258	000260'	554060	000010	        HLRZ    AC1,@BUFADR     ;GET DECOLATION FLAG
   259	000261'	201000	000060	        MOVEI   AC,60           ;FOR POSSIBLE NO DECOLATION
   260	000262'	602040	007000	        TRNE    AC1,7000                ;CHECK FOR DECOLATION
   261	000263'	201000	000061	        MOVEI   AC,61           ;FOR DECOLATION
   262	000264'	136000	000005	        IDPB    AC,AC5          ;STORE DECOLATION FLAG
   263				;
   264				;       SEE WHICH FILE RECORD IS TO BE WRITTEN
   265				;
TAPCHG	MACRO 12.5-46.0 16:12  8-JAN-86 PAGE 1-6
TAPCHG.MAC	12-MAY-81 1

   266	000265'	554020	000010	        HLRZ    AC,@BUFADR      ;GET DELIVERY MODE HALF WD
   267	000266'	405000	000700	        ANDI    AC,700          ;GET ACTUAL MODE
   268	000267'	242000	777772	        LSH     AC,-6           ;RIGHT JUSTIFY FIGURE
   269	000270'	400700	000000	        SETZ    16,             ;ZERO FOR LATER
   270	000271'	302000	000006	        CAIE    AC,6            ;SKIP IF THIS INTER-OFFICE
   271	000272'	306000	000001	        CAIN    AC,1            ;SEE IF MODE IS PICKUP
   272	000273'	254000	000302'	        JRST    COMCHG          ;GO COMPUT PRINTING CHARGE
   273				;
   274				;       ZERO RECORD FOR PARCHG.DAT
   275				;
   276	000274'	200200	001025'	        MOVE    AC4,[POINT 7,RECORD] ;POINT TO START
   277	000275'	201000	000060	        MOVEI   AC,60           ;TO INDICATE PARTIAL RECORD
   278	000276'	136000	000004	        IDPB    AC,AC4          ;STORE SAME
   279	000277'	201000	000063	        MOVEI   AC,63           ;SAME
   280	000300'	136000	000004	        IDPB    AC,AC4          ;SAME
   281	000301'	474700	000000	        SETO    16,             ;SHOWS WHICH FILE TO APPEND TO
   282				;
   283				;       COME HERE TO COMPUTE CHARGES AND SHOW
   284				;       WHICH FILE TO WRITE TO
   285				;
   286	000302'	201200	000006	COMCHG: MOVEI   AC4,6           ;No. zeros to do
   287	000303'	201000	000060	        MOVEI   AC,60           ;GET ACTUAL ZERO
   288	000304'	136000	000005	        IDPB    AC,AC5          ;STORE ZERO
   289	000305'	367200	000304'	        SOJG    AC4,.-1         ;ZERO REST OF FIELD
   290
   291	000306'	201200	000007	        movei   ac4,7           ;Number of blanks
   292	000307'	201000	000040	        movei   ac,40           ;Ascii blank
   293	000310'	136000	000005	        idpb    ac,ac5          ;Blank the field
   294	000311'	367200	000310'	        sojg    ac4,.-1         ;Byte by byte
   295
   296				;       PUT IN COMPLETION DATE, CR LF AND WRITE RECORD
   297				;
   298	000312'	271400	000014	GETDTE: ADDI    BUFADR,14       ;POINT TO COMPLETION DATE
   299	000313'	550020	000010	        HRRZ    AC,@BUFADR      ;GET THAT DATE
   300	000314'	231000	000037	        IDIVI   AC,^D31         ;DIVIDE BY 31 DAYS
   301	000315'	271040	000001	        ADDI    AC1,1           ;CORRECT THE DAY
   302	000316'	202040	000704'	        MOVEM   AC1,SAVE+1      ;SAVE THAT DAY
   303	000317'	231000	000014	        IDIVI   AC,14           ;DIVIDE BY MONTHS
   304	000320'	271040	000001	        ADDI    AC1,1           ;CORRECT THE MONTH
   305	000321'	271000	000100	        ADDI    AC,100          ;CORRECT THE YEAR
   306	000322'	202040	000705'	        MOVEM   AC1,SAVE+2      ;SAVE THE MONTH
   307	000323'	260740	000516'	        PUSHJ   P,DECINS        ;CONVERT AND STORE
   308	000324'	200000	000705'	        MOVE    AC,SAVE+2       ;GET MONTH
   309	000325'	260740	000516'	        PUSHJ   P,DECINS        ;CONVERT AND STORE
   310	000326'	200000	000704'	        MOVE    AC,SAVE+1       ;GET DAY
   311	000327'	260740	000516'	        PUSHJ   P,DECINS        ;CONVERT AND STORE
   312				;
   313				;       INSERT CR AND LF THEN WRITE OUT RECORD
   314				;
   315	000330'	201000	000015	        MOVEI   AC,15           ;GET A CARRIGE RETURN
   316	000331'	136000	000005	        IDPB    AC,AC5          ;STORE IN RECORD
   317	000332'	201000	000012	        MOVEI   AC,12           ;GET A LINE FEED
   318	000333'	136000	000005	        IDPB    AC,AC5          ;STORE IN BUFFER
TAPCHG	MACRO 12.5-46.0 16:12  8-JAN-86 PAGE 1-7
TAPCHG.MAC	12-MAY-81 14:40	

   319				;
   320				;       SEE WHICH FILE TO WORK ON
   321				;
   322	000334'	322700	000342'	        JUMPE   16,COMFIL       ;BR TO DO COMPLETED REQUEST
   323				;
   324				;       BUILD RECORD DESCRIPTOR FOR PARTIAL COMPLETED REQUEST
   325				;
   326	000335'	275400	000021	        SUBI    BUFADR,21       ;RESTORE POINTER
   327	000336'	200000	000741'	        MOVE    AC,FILPAR       ;GET FILE NAME
   328	000337'	202000	000752'	        MOVEM   AC,ACTFIL       ;STORE FOR LOOKUP
   329	000340'	200000	000742'	        MOVE    AC,FILPAR+1     ;GET EXTENSION NAME
   330	000341'	254000	000367'	        JRST    RESTBK          ;GO STORE EXTENSION NAME
   331				;
   332				;       COME HERE TO GET FILE NAME OF FILE FOR HOLDING
   333				;       RECORDS THAT NEED NO MORE INFORMATION
   334				;
   335				;       GET SYSTEM NO. FROM REQUEST NO.
   336				;
   337	000342'	200040	000010	COMFIL: MOVE    AC1,BUFADR      ;GET BUFFER POINTER
   338	000343'	275040	000021	        SUBI    AC1,21          ;POINT TO REQ. NO.
   339	000344'	200060	000001	        MOVE    AC1,@AC1        ;GET REQ. NO. WD.
   340	000345'	242040	000006	        LSH     AC1,6           ;LEFT JUSTIFY REQ. NO.
   341	000346'	200100	001027'	        MOVE    AC2,[POINT 6,FILCOM,^D23] ;POINT TO FILE NAME
   342	000347'	400000	000000	        SETZ    AC,             ;FOR NEXT INST.
   343	000350'	246000	000006	        LSHC    AC,6            ;BRING OVER FIRST SYS. NO.
   344	000351'	136000	000002	        IDPB    AC,AC2          ;STORE SYS. NO.
   345	000352'	400000	000000	        SETZ    AC,             ;FOR NEXT INST.
   346	000353'	246000	000006	        LSHC    AC,6            ;BRING OVER LAST SYS. NO.
   347	000354'	136000	000002	        IDPB    AC,AC2          ;STORE LAST SYS. NO.
   348	000355'	200000	000743'	        MOVE    AC,FILCOM       ;GET FILE NAME
   349	000356'	202000	000752'	        MOVEM   AC,ACTFIL       ;STORE FILE NAME
   350	000357'	550020	000010	        HRRZ    AC,@BUFADR      ;GET COMPLETION DATE
   351	000360'	275400	000021	        SUBI    BUFADR,21       ;RESTORE POINTER
   352	000361'	231000	000037	        IDIVI   AC,^D31         ;GET DAY
   353	000362'	231000	000014	        IDIVI   AC,14           ;GET MONTH
   354	000363'	231040	000002	        IDIVI   AC1,2           ;CREATE POINTER
   355	000364'	510001	000744'	        HLLZ    AC,MONTHS(AC1)  ;GET AN EXTENSION NAME
   356	000365'	332000	000002	        SKIPE   ,AC2            ;SEE IF CORRECT EXT. NEEDED
   357	000366'	514001	000744'	        HRLZ    AC,MONTHS(AC1)  ;GET CORRECT EXTENSION
   358	000367'	202000	000753'	RESTBK: MOVEM   AC,ACTFIL+1     ;STORE EXTENSION
   359	000370'	402000	000754'	LOKAGN: SETZM   ,ACTFIL+2       ;ZERO FOR LOOKUP
   360	000371'	200000	000001'	        MOVE    AC,OWNER        ;GET OWNERS PPN
   361	000372'	202000	000755'	        MOVEM   AC,ACTFIL+3     ;STORE FOR LOOKUP
   362				;
   363				;       DO LOOKUP ON THAT FILE AND ALSO ENTER ON SAME
   364				;
   365	000373'	076240	000752'	        LOOKUP  ACTCHL,ACTFIL   ;GO GET FILE
   366	000374'	254000	000524'	        JRST    CREATE          ;GO CREATE FILE IF NOT THERE
   367	000375'	574040	000755'	        HLRE    AC1,ACTFIL+3    ;GET NEG LENGTH
   368	000376'	202000	000755'	        MOVEM   AC,ACTFIL+3     ;RESTORE PPN
   369	000377'	210040	000001	        MOVN    AC1,AC1         ;CONVERT TO POSITIVE
   370	000400'	231040	000200	        IDIVI   AC1,200         ;GET BLOCK SIZE
   371	000401'	271040	000001	        ADDI    AC1,1           ;ADJUST POINTER
TAPCHG	MACRO 12.5-46.0 16:12  8-JAN-86 PAGE 1-8
TAPCHG.MAC	12-MAY-81 14:40	

   372	000402'	077240	000752'	        ENTER   ACTCHL,ACTFIL   ;DO ENTER ON FILE
   373	000403'	254000	000441'	        JRST    ACTWHY          ;SEE WHY CANT DO ENTER ON FILE
   374	000404'	322100	000433'	        JUMPE   AC2,EVNBND      ;BR. FOR EVEN BOUNDRIES
   375	000405'	074260	000001	        USETI   ACTCHL,@AC1     ;SET INPUT POINTER
   376	000406'	066240	000000	        INPUT   ACTCHL,         ;READ IN BLK
   377	000407'	067240	000000	        OUTPUT  ACTCHL,         ;DUMMY OUTPUT
   378	000410'	075260	000001	        USETO   ACTCHL,@AC1     ;SET OUTPUT POINTER
   379				;
   380				;       PASS OVER OLD DATA IN BUFFER
   381				;
   382	000411'	375000	000740'	PASDAT: SOSGE   ACTI+2          ;SEE IF BUFFER EMPTY
   383	000412'	254000	000417'	        JRST    PUTREC          ;GO PUT IN NEW REC.
   384	000413'	134000	000737'	        ILDB    AC,ACTI+1       ;GET OLD DATA
   385	000414'	370000	000735'	        SOS     ACTO+2          ;DECREASE BYTE COUNTER
   386	000415'	136000	000734'	        IDPB    AC,ACTO+1       ;STORE OLD DATA
   387	000416'	254000	000411'	        JRST    PASDAT          ;GO DO MORE OF SAME
   388	000417'	400240	000000	PUTREC: SETZ    AC5,            ;ZERO WR. POINTER
   389	000420'	200005	000707'	MORREC: MOVE    AC,RECORD(AC5)  ;GET WD OF RECORD
   390	000421'	375000	000735'	        SOSGE   ACTO+2          ;SEE IF BUFFER FULL
   391	000422'	254000	000430'	        JRST    EMPTY           ;GO EMPTY BUFFER
   392	000423'	136000	000734'	STRDTA: IDPB    AC,ACTO+1       ;STORE RECORD
   393	000424'	271240	000001	        ADDI    AC5,1           ;INCREASE POINTER
   394	000425'	305240	000021	        CAIGE   AC5,21          ;SEE IF RECORD PASSED OVER
   395	000426'	254000	000420'	        JRST    MORREC          ;GO DO MORE RECORD
   396	000427'	254000	000436'	        JRST    DONREC          ;RECORDED IS PASSED
   397	000430'	067240	000000	EMPTY:  OUTPUT  ACTCHL,         ;PUT OUT FULL BUFFER
   398	000431'	370000	000735'	        SOS     ACTO+2          ;SUB FOR CURRENT DATA
   399	000432'	254000	000423'	        JRST    STRDTA          ;GO STORE CURRENT DATA
   400	000433'	067240	000000	EVNBND: OUTPUT  ACTCHL,         ;DUMMY OUTPUT
   401	000434'	075260	000001	        USETO   ACTCHL,@AC1     ;POINT TO CORRECT PLACE
   402	000435'	254000	000417'	        JRST    PUTREC          ;GO PUT OUT RECORD
   403	000436'	067240	000000	DONREC: OUTPUT  ACTCHL,         ;PUT OUT CURRENT DATA
   404	000437'	071240	000000	        RELEAS  ACTCHL,         ;RELEASE ACCT. CHANNEL
   405	000440'	254000	000531'	        JRST    MODGD           ;GO MODIFY THE GD RECORD
   406	000441'	550000	000753'	ACTWHY: HRRZ    AC,ACTFIL+1     ;GET REASON FOR FAILURE
   407	000442'	302000	000003	        CAIE    AC,3            ;SEE IF FILE OPENED
   408	000443'	254000	000671'	        JRST    ERROR6          ;CANT OPEN FOR OUTPUT
   409	000444'	201000	000012	        MOVEI   AC,12           ;SLEEP FOR 10 SEC.
   410	000445'	047000	000031	        SLEEP   AC,             ;GO TO SLEEP
   411	000446'	254000	000370'	        JRST    LOKAGN          ;GO TRY AGAIN
   412				;
   413				;       CONVERT DECIMAL TO ASCII AND PUT OUT
   414				;
   415	000447'	275200	000001	SUPZRO: SUBI    AC4,1           ;PREPARE TO CREATE POWER
   416	000450'	201100	000001	        MOVEI   AC2,1           ;INITIAL POWER
   417	000451'	221100	000012	        IMULI   AC2,12          ;MULT BY 10
   418	000452'	367200	000451'	        SOJG    AC4,.-1         ;GO CREATE CORRECT POWER
   419	000453'	400200	000000	        SETZ    AC4,            ;BLANK SUPPRESS FLAG
   420	000454'	230000	000002	SUPMOR: IDIV    AC,AC2          ;DIVIDE BY POWER
   421	000455'	322000	000470'	        JUMPE   AC,SUPRES       ;BR. IF ZERO
   422	000456'	474200	000000	        SETO    AC4,            ;TURN SUPRESS FLAG OFF
   423	000457'	271000	000060	SUPOK:  ADDI    AC,60           ;CONVERT TO ASCII
   424	000460'	136000	000005	SUPOK1: IDPB    AC,AC5          ;STORE THE CHAR
TAPCHG	MACRO 12.5-46.0 16:12  8-JAN-86 PAGE 1-9
TAPCHG.MAC	12-MAY-81 14:40	

   425	000461'	200000	000001	        MOVE    AC,AC1          ;GET REMAINDER
   426	000462'	231100	000012	        IDIVI   AC2,12          ;REDUCE POWER BY 10
   427	000463'	302100	000001	        CAIE    AC2,1           ;SEE IF POWER IS 1
   428	000464'	254000	000454'	        JRST    SUPMOR          ;NO, THEN GO DIVIDE AGAIN
   429	000465'	271000	000060	        ADDI    AC,60           ;CONVERT TO ASCII
   430	000466'	136000	000005	        IDPB    AC,AC5          ;STORE CHAR.
   431	000467'	263740	000000	        POPJ    P,              ;RETURN TO CALLER
   432	000470'	326200	000457'	SUPRES: JUMPN   AC4,SUPOK       ;BR. IF FLAG TURNED OFF
   433	000471'	201000	000040	        MOVEI   AC,40           ;SUPRESS ZERO WITH BLANK
   434	000472'	254000	000460'	        JRST    SUPOK1          ;GO STORE IT
   435				;
   436				;       CONVERT 6 BIT TO ASCII AND STORE
   437				;
   438	000473'	400000	000000	CONINS: SETZ    AC,             ;FOR NEXT INST
   439	000474'	246000	000006	        LSHC    AC,6            ;SHIFT LEFT
   440	000475'	271000	000040	        ADDI    AC,40           ;CONVERT TO ASCII
   441	000476'	136000	000005	        IDPB    AC,AC5          ;STORE IN RECORD
   442	000477'	367200	000473'	        SOJG    AC4,CONINS      ;GO DO MORE
   443	000500'	263740	000000	        POPJ    P,              ;RETURN TO CALLER
   444				;
   445				;       CONVERT FROM OCTAL TO ASCII
   446				;
   447	000501'	400000	000000	OCTINS: SETZ    AC,             ;ZERO FOR NEXT INST.
   448	000502'	246000	000003	        LSHC    AC,3            ;BRING OVER A CHAR
   449	000503'	326000	000512'	        JUMPN   AC,OCTSAV       ;BR. IF NOT ZERO
   450	000504'	201000	000040	        MOVEI   AC,40           ;FILL WITH BLANKS
   451	000505'	136000	000005	        IDPB    AC,AC5          ;STORE DIGIT
   452	000506'	367200	000501'	        SOJG    AC4,OCTINS      ;GO DO REST OF DIGITS
   453	000507'	263740	000000	        POPJ    P,              ;RETURN TO CALLER
   454	000510'	400000	000000	OCTMOR: SETZ    AC,             ;FOR NEXT INST
   455	000511'	246000	000003	        LSHC    AC,3            ;BRING OVER A DIGIT
   456	000512'	271000	000060	OCTSAV: ADDI    AC,60           ;CONVERT TO ASCII
   457	000513'	136000	000005	        IDPB    AC,AC5          ;STORE DIGIT
   458	000514'	367200	000510'	        SOJG    AC4,OCTMOR      ;GO DO REST OF DIGITS
   459	000515'	263740	000000	        POPJ    P,              ;RETURN TO CALLER
   460				;
   461				;       CONVERT 2 DIGITS TO ASCII AND STORE
   462				;
   463	000516'	231000	000012	DECINS: IDIVI   AC,12           ;DIVIDE BY 10
   464	000517'	271000	000060	        ADDI    AC,60           ;CONVERT TO ASCII
   465	000520'	136000	000005	        IDPB    AC,AC5          ;STORE DIGIT
   466	000521'	271040	000060	        ADDI    AC1,60          ;CONVERT LAST TO ASCII
   467	000522'	136040	000005	        IDPB    AC1,AC5         ;STORE LAST DIGIT
   468	000523'	263740	000000	        POPJ    P,              ;RETURN TO CALLER
   469				;
   470				;       CREATE ACCOUNTING FILE IF NOT THERE
   471				;
   472	000524'	202000	000755'	CREATE: MOVEM   AC,ACTFIL+3     ;RESTORE PPN
   473	000525'	077240	000752'	        ENTER   ACTCHL,ACTFIL   ;GO CREATE FILE
   474	000526'	254000	000670'	        JRST    ERROR3          ;CANT CREATE ACCT FILE
   475	000527'	067240	000000	        OUTPUT  ACTCHL,         ;DUMMY OUTPUT
   476	000530'	254000	000417'	        JRST    PUTREC          ;GO PUT OUT RECORD
   477				;
TAPCHG	MACRO 12.5-46.0 16:12  8-JAN-86 PAGE 1-10
TAPCHG.MAC	12-MAY-81 14:40	

   478				;       COPY GD REQ. TO OUTPUT BUFFER AND WRITE BACK OUT TO DSK
   479				;
   480	000531'	077040	000767'	MODGD:  ENTER   GDCHL,GDBLK     ;DO ENTER ON GD TABLE
   481	000532'	254000	000660'	        JRST    GDWHY           ;GO SEE WHY
   482	000533'	067040	000000	        OUTPUT  GDCHL,          ;DUMMY OUPUT
   483	000534'	504000	000765'	        HRL     AC,GDIN+1       ;GET INPUT BUFFER POINTER
   484	000535'	540000	000762'	        HRR     AC,GDOUT+1      ;GET OUTPUT BUFFER POINTER
   485	000536'	253000	000537'	        AOBJN   AC,.+1          ;ADJUST POINTERS
   486	000537'	550040	000000	        HRRZ    AC1,AC          ;GET OUTBUF CORRECTED ADDRESS
   487	000540'	271040	000177	        ADDI    AC1,177         ;SHOW LWA OF OUTPUT BUFFER
   488	000541'	251020	000001	        BLT     AC,@AC1         ;MOVE BUFFER ACROSS
   489	000542'	201000	000200	        MOVEI   AC,200          ;NO. WDS. MOVED
   490	000543'	272000	000762'	        ADDM    AC,GDOUT+1      ;ADJUST BYTE POINTER
   491	000544'	074060	000706'	        USETI   GDCHL,@BLKPTR   ;SET OUTPUT POINTER
   492	000545'	067040	000000	        OUTPUT  GDCHL,          ;WRITE BLK BACK OUT
   493	000546'	071040	000000	        RELEAS  GDCHL,          ;RELEASE THE CHANNEL
   494	000547'	201240	000004	        MOVEI   AC5,4           ;TIMES TO TRY
   495	000550'	336000	001020'	        SKIPN   REMLOC          ;SKIP IF TO UPDATE REMOTE CNT.
   496	000551'	254000	000652'	        JRST    DONEIT          ;DONT DO IT
   497	000552'	554700	001020'	        HLRZ    16,REMLOC       ;GET STATUS
   498	000553'	322700	000652'	        JUMPE   16,DONEIT
   499				;
   500	000554'	041440	000010	        INIT    RCHL,10
   501	000555'	446353	000000	        SIXBIT/DSK/
   502	000556'	000761'	000764'	        XWD     GDOUT,GDIN
   503	000557'	254000	000554'	        JRST    .-3
   504	000560'	064440	000001	        INBUF   RCHL,1
   505	000561'	065440	000001	        OUTBUF  RCHL,1
   506	000562'	554040	001020'	        HLRZ    AC1,REMLOC      ;GET REMOTE LOCATION
   507	000563'	200000	001030'	        MOVE    AC,[SIXBIT/SPLCNT/]
   508	000564'	302700	000001	        CAIE    16,1            ;SKIP IF CENTER UPDATE
   509	000565'	200000	001031'	        MOVE    AC,[SIXBIT/REMCNT/]
   510	000566'	202000	000773'	        MOVEM   AC,REMCNT
   511	000567'	550000	001020'	        HRRZ    AC,REMLOC       ;GET PRI LOC NO.
   512	000570'	306040	000001	        CAIN    AC1,1           ;IF TO CENTER
   513	000571'	400000	000000	        SETZ    AC,             ;FOR CENTER
   514	000572'	202000	000001	        MOVEM   AC,AC1
   515	000573'	200000	000000'	FINPRI: MOVE    AC,SPLGAN       ;GET SPOOLERS PPN
   516	000574'	202000	000776'	        MOVEM   AC,REMCNT+3     ;STORE FOR LOOKUP
   517	000575'	402000	000775'	        SETZM   ,REMCNT+2       ;ZERO FOR LOOKUP
   518	000576'	402000	000774'	        SETZM   REMCNT+1        ;SAVE
   519	000577'	076440	000773'	        LOOKUP  RCHL,REMCNT     ;GET FILE
   520	000600'	254000	000666'	        JRST    ERROR
   521	000601'	202000	000776'	        MOVEM   AC,REMCNT+3     ;STORE PPN FOR ENTER
   522	000602'	077440	000773'	        ENTER   RCHL,REMCNT     ;SEIZE FILE FOR OUTPUT
   523	000603'	254000	000643'	        JRST    REMWHY          ;GO SEE WHY CANT GET IT
   524	000604'	202040	000000	        MOVEM   AC1,AC          ;SAVE PRINTER LOC
   525	000605'	242040	777771	        LSH     AC1,-7          ;CONVERT TO BLK NO.-1
   526	000606'	271040	000001	        ADDI    AC1,1           ;ADJUST BLK POINTER
   527	000607'	074460	000001	        USETI   RCHL,@AC1       ;SET INPUT POINTER
   528	000610'	056440	000000	        IN      RCHL,           ;READ IN CORRECT BLK
   529	000611'	254000	000613'	        JRST    FINPR2          ;GO ON GOOD READ
   530	000612'	254000	000666'	        JRST    ERROR           ;SHOULDNT GET EOF OR ANYTHING ELSE
TAPCHG	MACRO 12.5-46.0 16:12  8-JAN-86 PAGE 1-11
TAPCHG.MAC	12-MAY-81 14:40	

   531	000613'	067440	000000	FINPR2: OUTPUT  RCHL,
   532	000614'	075460	000001	FINPR1: USETO   RCHL,@AC1       ;SET OUTPUT POINTER
   533	000615'	231000	000200	        IDIVI   AC,200          ;GET INDEX TO BLOCK
   534	000616'	550000	000765'	        HRRZ    AC,GDIN+1       ;GET INPUT POINTER
   535	000617'	270040	000000	        ADD     AC1,AC          ;ADDRESS OF WD. TO READ
   536	000620'	271040	000001	        ADDI    AC1,1           ;ADJUST FOR BUFFER POINTER
   537	000621'	200020	000001	        MOVE    AC,@AC1         ;GET WD. TO CHANGE
   538				;
   539				;       ALTER THE REMOTE COUNT
   540				;
   541	000622'	621000	400000	        TLZ     AC,400000       ;TURN SIGN BIT OFF IF THERE
   542	000623'	333000	000000	        SKIPLE  ,AC             ;SKIP IF ALREADY ZERO
   543	000624'	275000	000001	        SUBI    AC,1            ;ELSE REDUCE BY ONE
   544	000625'	302700	000001	        CAIE    16,1            ;SKIP IF CENTER
   545	000626'	661000	400000	        TLO     AC,400000       ;TURN CHANGE BIT ON
   546				;
   547				;       WRITE CHANGE COUNT BACK OUT
   548				;
   549	000627'	202020	000001	WRIPRI: MOVEM   AC,@AC1         ;WRITE CHANGE BACK OUT
   550	000630'	504000	000765'	        HRL     AC,GDIN+1       ;GET INPUT POINTER
   551	000631'	540000	000762'	        HRR     AC,GDOUT+1      ;GET OUTPUT POINTER
   552	000632'	253000	000633'	        AOBJN   AC,.+1          ;ADJUST POINTERS
   553	000633'	550040	000000	        HRRZ    AC1,AC          ;GET OUTPUT POINTER
   554	000634'	271040	000177	        ADDI    AC1,177         ;LAST WD TO CARRY OVER
   555	000635'	251020	000001	        BLT     AC,@AC1         ;MOVE BLOCK OVER
   556	000636'	201040	000200	        MOVEI   AC1,200         ;NO. WDS. MOVED
   557	000637'	272040	000762'	        ADDM    AC1,GDOUT+1     ;CHANGE BYTE POINTER
   558	000640'	067440	000000	        OUTPUT  RCHL,           ;WRITE BLOCK BACK OUT
   559	000641'	071440	000000	        RELEAS  RCHL,           ;CLOSE FILE, RELEASE CHANNEL
   560	000642'	254000	000652'	        JRST    DONEIT          ;TELL MASTER, EVERYTING OK
   561	000643'	550000	000774'	REMWHY: HRRZ    AC,REMCNT+1     ;GET REASON FOR ERROR
   562	000644'	302000	000003	        CAIE    AC,3            ;FILE BUSY
   563	000645'	254000	000666'	        JRST    ERROR
   564	000646'	201000	000001	        MOVEI   AC,1            ;SLEEP FOR A WHILE
   565	000647'	047000	000031	        SLEEP   AC,             ;SAME
   566	000650'	367240	000573'	        SOJG    AC5,FINPRI
   567	000651'	254000	000666'	        JRST    ERROR
   568				;
   569				;       TELLL MASTER WE COMPLETED REQUEST OK
   570				;
   571	000652'	561640	000004	DONEIT: HRROI   CH,4            ;GOING TO SEND SOMETHING
   572	000653'	042640	000151	        AUXCAL  CH,151          ;COMPLETED REQUEST
   573	000654'	254000	000034'	        JRST    SEMSTR          ;GO SEE MASTER
   574	000655'	063040	340000	WHYEND: STATZ   GDCHL,340000    ;CHECK STATUS
   575	000656'	254000	000673'	        JRST    ERROR8          ;ERROR ON INPUT
   576	000657'	254000	000700'	        JRST    ERROR9          ;REQUEST DOESNT EXIST
   577	000660'	550000	000770'	GDWHY:  HRRZ    AC,GDBLK+1      ;GET REASON FOR NO ENTER
   578	000661'	302000	000003	        CAIE    AC,3            ;SEE IF FILE BUSY
   579	000662'	254000	000671'	        JRST    ERROR6          ;CAN OPEN FOR OUTPUT
   580	000663'	201000	000005	        MOVEI   AC,5            ;SLEEP IT OFF
   581	000664'	047000	000031	        SLEEP   AC,             ;DO IT
   582	000665'	254000	000073'	        JRST    ALLOVR          ;GO TRY AGAIN
   583	000666'	255000	000000	ERROR:  jfcl                    ;ERROR COPUTING CHARGE
TAPCHG	MACRO 12.5-46.0 16:12  8-JAN-86 PAGE 1-12
TAPCHG.MAC	12-MAY-81 14:40	

   584	000667'	255000	000000	ERROR1: jfcl                    ;CANT SECURE A CHANNEL
   585	000670'	255000	000000	ERROR3: jfcl                    ;CANT CREATE ACCT. FILE
   586	000671'	255000	000000	ERROR6: jfcl                    ;CANT OPEN FILE FOR OUTPUT
   587	000672'	255000	000000	ERROR7: jfcl                    ;TROUBLE GETTING USERS NAME
   588	000673'	255000	000000	ERROR8: jfcl                    ;TROUBLE DOING AN INPUT
   589	000674'	255000	000000	GDERR:  jfcl                    ;GD TABLE DOESNT EXIST
   590	000675'	561640	000004	        HRROI   CH,4            ;GOING TO SEND SOMETHING BACK
   591	000676'	042640	000152	        AUXCAL  CH,152          ;COULDNT COMPLETE THE REQUEST
   592	000677'	254000	000034'	        JRST    SEMSTR          ;GO SEE MASTER
   593	000700'			ERROR9:                         ;REQUEST DOESNT EXIST
   594	000700'	561640	000004	        HRROI   CH,4            ;GOING TO TELL MASTER SOMETHING
   595	000701'	042640	000153	        AUXCAL  CH,153          ;NOT VALID REQUEST FOR TAPE
   596	000702'	254000	000034'	        JRST    SEMSTR          ;GO SEE MASTER
   597	000703'			SAVE:   BLOCK 3                 ;TEMP HOLDER OF STORAGE
   598	000706'			BLKPTR: BLOCK 1
   599	000707'			RECORD: BLOCK 21                ;HOLD ACCOUNTING FILE
   600	000730'	000000	000010	ACTDEF: EXP  10
   601	000731'	446353	000000	        SIXBIT/DSK/
   602	000732'	000733'	000736'	        XWD ACTO,ACTI
   603	000733'			ACTO:   BLOCK  3
   604	000736'			ACTI:   BLOCK 3
   605	000741'	604162	435047	FILPAR: SIXBIT/PARCHG/
   606	000742'	444164	000000	        SIXBIT/DAT/
   607	000743'	424164	200000	FILCOM: SIXBIT/BAT0/
   608	000744'	524156	464542	MONTHS: SIXBIT/JANFEB/
   609	000745'	554162	416062	        SIXBIT/MARAPR/
   610	000746'	554171	526556	        SIXBIT/MAYJUN/
   611	000747'	526554	416547	        SIXBIT/JULAUG/
   612	000750'	634560	574364	        SIXBIT/SEPOCT/
   613	000751'	565766	444543	        SIXBIT/NOVDEC/
   614	000752'			ACTFIL: BLOCK 4
   615	000756'	000000	000010	GDDEF:  EXP 10
   616	000757'	446353	000000	        SIXBIT/DSK/
   617	000760'	000761'	000764'	        XWD GDOUT,GDIN
   618	000761'			GDOUT:  BLOCK 3
   619	000764'			GDIN:   BLOCK 3
   620	000767'	636057	575400	GDBLK:  SIXBIT/SPOOL/
   621	000770'	474446	000000	        SIXBIT/GDF/
   622	000771'	000000	000000	        0
   623	000772'	000000	000000	        0
   624	000773'	624555	435664	REMCNT: SIXBIT/REMCNT/
   625	000774'	000000	000000	        0
   626	000775'	000000	000000	        0
   627	000776'	000001	133677	        1,,133677
   628	000777'			PDL:    BLOCK 21
   629			000002'	        END     START
   630
NO ERRORS DETECTED
PROGRAM BREAK IS 001032
2K CORE USED
TAPCHG	MACRO 12.5-46.0 16:12  8-JAN-86 PAGE 2
TAPCHG.MAC	12-MAY-81 14:40		SYMBOL TABLE

AC		000000		OCTINS		000501'		
AC1		000001		OCTMOR		000510'		
AC2		000002		OCTSAV		000512'		
AC3		000003		OWNER		000001'		
AC4		000004		P		000017		
AC5		000005		PASDAT		000411'		
ACTCHL		000005		PDL		000777'		
ACTDEF		000730'		PUTREC		000417'		
ACTFIL		000752'		RCHL		000011	SPD	
ACTI		000736'		RECORD		000707'		
ACTO		000733'		REMCNT		000773'		
ACTWHY		000441'		REMLOC		001020'		
ALLOVR		000073'		REMWHY		000643'		
BLKPTR		000706'		REQINP		000040'		
BUFADR		000010		REQNUM		000006		
CH		000015		RESET	047000	000000		
COMCHG		000302'		RESTBK		000367'		
COMFIL		000342'		SAVE		000703'		
CONINS		000473'		SEMSTR		000034'		
CREATE		000524'		SETMOD	047000	777752		
DATES		000007		SLEEP	047000	000031		
DEBUG		000000	SPD	SPLGAN		000000'		
DECINS		000516'		START		000002'		
DONEIT		000652'		STRDTA		000423'		
DONREC		000436'		SUPMOR		000454'		
EMPTY		000430'		SUPOK		000457'		
ERROR		000666'		SUPOK1		000460'		
ERROR1		000667'		SUPRES		000470'		
ERROR3		000670'		SUPZRO		000447'		
ERROR6		000671'		TRYAGN		000014'		
ERROR7		000672'		WHYEND		000655'		
ERROR8		000673'		WRIPRI		000627'		
ERROR9		000700'		
EVNBND		000433'		
FILCOM		000743'		
FILPAR		000741'		
FINPR1		000614'		
FINPR2		000613'		
FINPRI		000573'		
GDBLK		000767'		
GDCHL		000001		
GDDEF		000756'		
GDERR		000674'		
GDIN		000764'		
GDOUT		000761'		
GDWHY		000660'		
GETDTE		000312'		
GETNEX		000103'		
GOTIT		000130'		
LOKAGN		000370'		
MODGD		000531'		
MONTHS		000744'		

TAPCHG	MACRO 12.5-46.0 16:12  8-JAN-86
TAPCHG.MAC	12-MAY-81 14:40		Symbol cross reference

AC	    10#	    80	    82	    84	    86	    88	    90	    92	    94	   103	   105	   112	   114	   115
	   117	   119	   121	   122	   124	   138	   139	   143	   151	   152	   153	   159	   160	   173
	   174	   175	   176	   183	   184	   185	   187	   188	   189	   193	   194	   196	   199	   202
	   203	   206	   223	   224	   225	   229	   232	   233	   234	   238	   240	   241	   242	   243
	   244	   245	   247	   250	   251	   253	   254	   255	   256	   257	   259	   261	   262	   266
	   267	   268	   270	   271	   277	   278	   279	   280	   287	   288	   292	   293	   299	   300
	   303	   305	   308	   310	   315	   316	   317	   318	   327	   328	   329	   342	   343	   344
	   345	   346	   347	   348	   349	   350	   352	   353	   355	   357	   358	   360	   361	   368
	   384	   386	   389	   392	   406	   407	   409	   410	   420	   421	   423	   424	   425	   429
	   430	   433	   438	   439	   440	   441	   447	   448	   449	   450	   451	   454	   455	   456
	   457	   463	   464	   465	   472	   483	   484	   485	   486	   488	   489	   490	   507	   509
	   510	   511	   513	   514	   515	   516	   521	   524	   533	   534	   535	   537	   541	   542
	   543	   545	   549	   550	   551	   552	   553	   555	   561	   562	   564	   565	   577	   578
	   580	   581
AC1	    11#	   101	   105	   111	   114	   117	   118	   121	   124	   156	   157	   158	   160	   170
	   171	   172	   178	   179	   190	   191	   193	   195	   196	   204	   209	   213	   216	   219
	   229	   230	   232	   237	   239	   258	   260	   301	   302	   304	   306	   337	   338	   339
	   340	   354	   355	   357	   367	   369	   370	   371	   375	   378	   401	   425	   466	   467
	   486	   487	   488	   506	   512	   514	   524	   525	   526	   527	   532	   535	   536	   537
	   549	   553	   554	   555	   556	   557
AC2	    12#	   155	   162	   164	   192	   197	   213	   341	   344	   347	   356	   374	   416	   417
	   420	   426	   427
AC3	    13#
AC4	    14#	   180	   210	   212	   217	   220	   226	   231	   235	   248	   276	   278	   280	   286
	   289	   291	   294	   415	   418	   419	   422	   432	   442	   452	   458
AC5	    15#	    99	   106	   177	   234	   241	   243	   245	   251	   257	   262	   288	   293	   316
	   318	   388	   389	   393	   394	   424	   430	   441	   451	   457	   465	   467	   494	   566
ACTCHL	    20#	   132	   134	   135	   365	   372	   375	   376	   377	   378	   397	   400	   401	   403
	   404	   473	   475
ACTDEF	   132	   600#
ACTFIL	   328	   349	   358	   359	   361	   365	   367	   368	   372	   406	   472	   473	   614#
ACTI	   382	   384	   602	   604#
ACTO	   385	   386	   390	   392	   398	   602	   603#
ACTWHY	   373	   406#
ALLOVR	   137#	   582
BLKPTR	   137	   148	   491	   598#
BUFADR	    18#	   149	   150	   151	   155	   156	   170	   173	   176	   178	   182	   183	   186	   187
	   190	   201	   202	   208	   209	   215	   216	   219	   222	   223	   228	   230	   236	   237
	   246	   247	   252	   253	   258	   266	   298	   299	   326	   337	   350	   351
CH	    22#	    69	    70	    71	    72	    73	    74	    75	    79	    80	    84	    88	    92	   102
	   103	   112	   115	   119	   122	   571	   572	   590	   591	   594	   595
COMCHG	   272	   286#
COMFIL	   322	   337#
CONINS	   181	   211	   214	   438#	   442
CREATE	   366	   472#
DATES	    17#	   110	   111	   118	   159	   172
DEBUG	    52#	    54	    59
DECINS	   198	   200	   205	   207	   307	   309	   311	   463#
DONEIT	   165	   496	   498	   560	   571#
DONREC	   396	   403#
EMPTY	   391	   397#
ERROR	   520	   530	   563	   567	   583#
ERROR1	   129	   133	   584#
TAPCHG	MACRO 12.5-46.0 16:12  8-JAN-86
TAPCHG.MAC	12-MAY-81 14:40		Symbol cross reference

ERROR3	   474	   585#
ERROR6	   408	   579	   586#
ERROR7	   587#
ERROR8	   575	   588#
ERROR9	   576	   593#
EVNBND	   374	   400#
FILCOM	   341	   348	   607#
FILPAR	   327	   329	   605#
FINPR1	   532#
FINPR2	   529	   531#
FINPRI	   515#	   566
GDBLK	   139	   140	   142	   143	   144	   480	   577	   620#
GDCHL	    19#	   128	   130	   131	   140	   145	   480	   482	   491	   492	   493	   574
GDDEF	   128	   615#
GDERR	   141	   589#
GDIN	   149	   483	   502	   534	   550	   617	   619#
GDOUT	   484	   490	   502	   551	   557	   617	   618#
GDWHY	   481	   577#
GETDTE	   298#
GETNEX	   145#	   154	   161
GOTIT	   170#
LOKAGN	   359#	   411
MODGD	   405	   480#
MONTHS	   355	   357	   608#
MORREC	   389#	   395
OCTINS	   218	   221	   447#	   452
OCTMOR	   454#	   458
OCTSAV	   449	   456#
OWNER	    56#	   360
P	    23#	    64	   181	   198	   200	   205	   207	   211	   214	   218	   221	   227	   249	   307
	   309	   311	   431	   443	   453	   459	   468
PASDAT	   382#	   387
PDL	    64	   628#
PUTREC	   383	   388#	   402	   476
RCHL	    21#	   500	   504	   505	   519	   522	   527	   528	   531	   532	   558	   559
RECORD	   177	   276	   389	   599#
REMCNT	   510	   516	   517	   518	   519	   521	   522	   561	   624#
REMLOC	   163#	   163	   185	   189	   495	   497	   506	   511
REMWHY	   523	   561#
REQINP	   103#	   106
REQNUM	    16#	   100	   101	   153
RESTBK	   330	   358#
SAVE	   225	   302	   306	   308	   310	   597#
SEMSTR	    99#	   573	   592	   596
SPLGAN	    55#	   138	   515
START	    64#	   629
STRDTA	   392#	   399
SUPMOR	   420#	   428
SUPOK	   423#	   432
SUPOK1	   424#	   434
SUPRES	   421	   432#
SUPZRO	   227	   249	   415#
TRYAGN	    80#	    83	    87	    91	    95
TAPCHG	MACRO 12.5-46.0 16:12  8-JAN-86
TAPCHG.MAC	12-MAY-81 14:40		Symbol cross reference

WHYEND	   147	   574#
WRIPRI	   549#
TAPCHG	MACRO 12.5-46.0 16:12  8-JAN-86
TAPCHG.MAC	12-MAY-81 14:40		Macro/Opdef cross reference

RESET	    65
SETMOD	    70
SLEEP	   410	   565	   581 f F