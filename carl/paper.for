
C
C************************
C
C       PAPER
C
C************************
C
C
C       THIS PROGRAM IS THE SOLE PROPERTY AND CONFIDENTIAL
C       DO NOT DISCLOSE OR USE BY THIRD PARTY.
C
C***********************************************************************

C
C	EXTERNAL DATA DEFINITIONS
C
	INTEGER OSVR,OCKT,VALUE,NEWVAL,OPRO
	INTEGER OTRB,ODUP,RW1,RW2,TIC,RP1,RP2
	INTEGER OCV,OSTH,OEHR,OLOC,OVER
	INTEGER SC,SP,PT,ST,DT,TI,NO,SL,HO,LNO,HNO
	INTEGER VERS,REV,CARR,FF,OKH,PTS

	COMMON /OSVR/OSVR(2),OLOC(2),OVER(2)
	COMMON /OCKT/OCKT(2),OCV(2)
	COMMON /VALUE/VALUE(4),NEWVAL(4)
	COMMON /OPRO/OPRO(2)
	COMMON /OTRB/OTRB(3)
	COMMON /ODUP/ODUP(2)
	COMMON /RW1/RW1(3),RW2(3)
	COMMON /TIC/TIC(3)
	COMMON /RP1/RP1(3),RP2(3)
	COMMON /OSTH/OSTH(2),OEHR(2)
	COMMON /SC/SC(3),SP(3),PT(3),ST(3)
	COMMON /DT/DT,TI
	COMMON /NO/NO,SL,HO
	COMMON /LNO/LNO(2),HNO(2)
	COMMON /VERS/VERS,REV
	COMMON /CHARS/CARR,FF
	COMMON /OKH/OKH
	COMMON /PTS/PTS

	INTEGER NOUT,YN,CAT,CUST,STATUS,REGEN
	INTEGER NUMNET,TVNET,HEX,RVNET,SNET,IVER
	INTEGER NUMCG,NETOP,BLK,AM,NATTN,ATTN,YY,AS
	INTEGER LREFER,HREFER,NTYPE,TYPE,NPROB

	COMMON /NOUT/NOUT(3)
	COMMON /YN/YN(4)
	COMMON /CAT/CAT(3)
	COMMON /CUST/CUST(2)
	COMMON /STATUS/STATUS(9)
	COMMON /REGEN/REGEN(7)
	COMMON /NUMNET/NUMNET
	COMMON /TVNET/TVNET(60),RVNET(60),SNET(60)
	COMMON /HEX/HEX(15)
	COMMON /IVER/IVER(4)
	COMMON /NUMCG/NUMCG
	COMMON /NETOP/NETOP(35)
	COMMON /BLK/BLK(1)
	COMMON /AM/AM(12)
	COMMON /NATTN/NATTN
	COMMON /ATTN/ATTN(151)
	COMMON /YY/YY(10)
	COMMON /AS/AS(4)
	COMMON /LREFER/LREFER(5),HREFER(5)
	COMMON /NTYPE/NTYPE
	COMMON /TYPE/TYPE(97)

	DOUBLE PRECISION BASE,VNET,CODE,ITELC,REPRB
	DOUBLE PRECISION HWARE,SWARE

	COMMON /BASE/BASE(20)
	COMMON /VNET/VNET(60)
	COMMON /CODE/CODE(120)
	COMMON /ITELC/ITELC(5)
	COMMON /NPROB/NPROB
	COMMON /REPRB/REPRB(35)
	COMMON /HWARE/HWARE(5)
	COMMON /SWARE/SWARE(6)

C
C	BEGIN MAIN PROGRAM VARIABLES
C
	INTEGER IM,J,NLINE,YMTOT,MYREG,N,PROD,NODE
	INTEGER TODAY,BB,NDUP,NTUP,REPFLG
	INTEGER INFO(64),K,NUMBER,I,COC(2),CCC
	INTEGER TNUM,TIM1,RNAM(4),RFON(4),OSVER,XCOC,RCOD
	INTEGER TOT,SOPEN,SMONIT,DISC(169),STOTAL,F3(5),TOGO
	INTEGER SRT,X,SYS,DECIS,ESC
	INTEGER HOST,SITP(4),FLAG,UNAM(3),NCNAM(4)
	INTEGER SM,SD,SY,EM,ED,EY,D,NT
	INTEGER L,M,P,DDAT,NUD
	INTEGER TTIM,H2,H1
	INTEGER SDAT,NUM1,ITEM1(19),ITEM2(19),ITEM(19),HIATTN
	INTEGER SITC(4),NOD1,HST1,CIRCKT(4),TROUB1(4)
	INTEGER REPN(4),REPF(4),CG,HH,LOATTN
	INTEGER COL,ROW(20),COR,TDAT
	INTEGER LIST(100),M1,M2,M3,M4,M5,IERT,IERC
	INTEGER TOT1,NTIM,TUS,TTL(21),SVER,FSTREC,RS
	INTEGER RECORD,SUB(25),ME,ATIM
	INTEGER STAT,Y,B,C,TOT2,LIC,XX,F2,JJ1,CSC
	INTEGER TELH(54),COMMT(12),DS1,TELM(4),LO,HO1,F1,CBAK(4),CHEX
	INTEGER ANS,NDAT,SEE,WELL,DVER(4),CHO,Z,MNAM(3)
	INTEGER IA1,IA2,IA3,IA4,IA5,IA6,V1,V2,V3,V4,V5,V6
	INTEGER CKT(4),TRB(4),DUP,DF
	INTEGER TUP,MAINT,CBY,DSP,REG
	INTEGER DRP,JM,JD,JY,COMMEN(12),TT
	INTEGER OFF,LEV,EVER(4),H3,H4,H5,Q,HN,BILL,INT,COMMNT(4)
	INTEGER PRO,TECH(3),COV,CNAM(3),KHST,STH,EHR,PORT
	INTEGER TYP,CDAT,LOC(4),VER,T40
	INTEGER HRGN,SRGN,ONUM(2),HQCC,CCOD,ORDER,PNAM(3)
	INTEGER WHO,LIN1(16),SNAM(3)
	INTEGER ALREDY,TYPST,LONG
	INTEGER TIM2,MOTO,WK,QOS,QOSGY(4),PROBL(2),HDRCHK
	INTEGER YORN,IPXNA,CRDNM,PRTNM

	DOUBLE PRECISION FILE,NET,NNET
	REAL HOUR,TET,ELM,PERCEN,TASKT,TASKP,SRGNT


	DIMENSION SPEN(60)
	DIMENSION TOTAL(60)
	DIMENSION MONIT(60)

C
C	MAIN PROGRAM
C

20      CONTINUE
	FLAG=0
	I=0
10      CALL USERNA(UNAM)
	TYPE 55,VERS,REV
55      FORMAT(' MCI',1H','S NETWORK OPERATIONS PROBLEM TRACKING ',
     1  'PROGRAM VERSION',A5,A5,/,/)
	CALL DBSTRT(-1,1,-4,0,1,0,5,0,-1,0,-4,1,1,1,5,1)
	CALL DBERR($4930,IERT,IERC,0)
	CALL DBOPEN(BASE(20))
31      CALL DBFIND(1,1,UNAM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 40
30      TYPE 33
33      FORMAT(/1X,'ACCESS TO PROGRAM DENIED')
	CALL DBEND
	CALL BYE
40      CALL DBGREC($30,1)
C
C	CALL ONINT($4930)
C
	CALL DBVAL(2,FLAG,3,SRT,4,SYS,5,CG,6,DRP,7,XX,8,LOATTN,
     1  9,HIATTN,10,LO,11,HO1,12,MYREG,13,ALREDY,14,CSC)
	IF (MYREG.GT.0) GOTO 41
39      CALL HREFR
	TYPE 34
34      FORMAT(3X,'ENTER THE NUMBER OF THE ORGANIZATION THAT YOU ARE A ',
     1  'PART OF : ',$)
	ACCEPT 120,MYREG
	IF ((MYREG.LE.1).OR.(MYREG.GT.NATTN)) GOTO 39
	CALL DBCHNG(12,MYREG)
41      IF (FLAG.GT.0) DECODE(10,631,VNET(FLAG))NNET
	IF (FLAG.LT.1) ENCODE(10,43,NNET)
631     FORMAT(A10)
43      FORMAT('  ALL  ')
	IF (XX.LT.0) LIC=1
	ENCODE(841,207,DISC)
46      I=0
	IF (SRT.LT.1) GOTO 59
47      TYPE 175
	ACCEPT 176,ME
	CALL HISET(ME)
	DECODE(3,30176,ME)M1,M2,M3
30176   FORMAT(A1,A1,A1)
	IF ((M1.EQ.' ').OR.(M2.EQ.' ')) GOTO 47
	IF ((M1.ge.'A').AND.(M1.LE.'Z')) GOTO 56
	GOTO 47
56      CALL DBERR($4930,IERT,IERC,0)
	IF (ALREDY.EQ.5) GOTO 59
	ALREDY=ALREDY+1
	CALL DBCHNG(13,ALREDY)
	CALL DBOPEN(BASE(15),BASE(19))
	CALL DBSET(2)
	CALL DBFIND(1,1,UNAM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.EQ.0) GOTO 59
	CALL DBGREC($59,NUMBER)
	CALL DBVAL(2,INFO)
	CALL TYPINF(INFO,4)
59      TYPE 60
60      FORMAT(/1X,'ENTER COMMAND... OR A',4H(CR),' FOR HELP : ',$)
	ACCEPT 65,ANS
	CALL HISET(ANS)
65      FORMAT(A5)
	IF (ANS.EQ.'L') GOTO 650
	IF (ANS.EQ.'48') GOTO 3585
	IF (ANS.EQ.'47') GOTO 3586
	IF (ANS.EQ.'K') GOTO 2590
	IF ((SRT.GE.1).AND.(ANS.EQ.'S')) GOTO 215
	IF (ANS.EQ.'N') GOTO 2320
	IF (ANS.EQ.' ') CALL HLP1(NNET,FLAG,SRT)
	IF (ANS.EQ.'O') GOTO 750
	IF ((XX.LT.0).AND.(ANS.EQ.'A')) goto 4035
	IF ((XX.LT.0).AND.(ANS.EQ.'A2')) goto 4035
	IF ((XX.LT.0).AND.(ANS.EQ.'A3')) goto 4035
	IF (ANS.EQ.'F') GOTO 2000
	IF (ANS.EQ.'MOTO') GOTO 2000
	IF (ANS.EQ.'WK') GOTO 2000
	IF ((SRT.GT.0).AND.(ANS.EQ.'G')) GOTO 2381
	IF ((XX.LT.0).AND.(ANS.EQ.'C')) GOTO 3765
	IF ((XX.LT.0).AND.((ANS.GE.'7').AND.(ANS.LT.'8'))) GOTO 3175
	IF ((FLAG.LT.2).AND.(ANS.EQ.'FRMON')) GOTO 93249
	IF ((ANS.EQ.'1').AND.(FLAG.LT.1)) GOTO 2540
	IF ((ANS.EQ.'9').AND.(FLAG.LT.1)) GOTO 3710
	IF ((XX.LT.0).AND.(ANS.EQ.'A1')) GOTO 3960
	IF ((XX.LT.0).AND.((ANS.GE.'5').AND.(ANS.LT.'6'))) GOTO 800
	IF (ANS.EQ.'Q') GOTO 99999
	IF ((xx.lt.0).AND.(ANS.EQ.'E')) GOTO 3805
	IF ((ANS.EQ.'CBACK').AND.(FLAG.LT.1)) GOTO 4600
	IF ((ANS.EQ.'60').AND.(FLAG.LT.1)) GOTO 4600
	IF ((ANS.EQ.'6L').AND.(FLAG.LT.1)) GOTO 4635
	IF ((ANS.EQ.'6C').AND.(FLAG.LT.1)) GOTO 4675
	IF ((ANS.EQ.'6U').AND.(FLAG.LT.1)) GOTO 4675
	IF ((ANS.EQ.'6D').AND.(FLAG.LT.1)) CALL DEFCB(ME)
	IF ((ANS.EQ.'I').AND.(FLAG.LT.1)) GOTO 2500
	IF ((ANS.EQ.'X').AND.(FLAG.LT.1)) GOTO 3400
	IF ((xx.lt.0).AND.(ANS.EQ.'D')) GOTO 3870
	IF ((LOATTN.GT.0).AND.(ANS.EQ.'TT')) GOTO 4345
	IF((CG.GT.0).AND.(ANS.EQ.'ORIGN')) GOTO 5100
	IF ((xx.lt.0).AND.(ANS.EQ.'Z')) GOTO 1400
	IF ((xx.lt.0).AND.(ANS.EQ.'U')) GOTO 2459
	IF (ANS.EQ.'V') GOTO 3765
	IF ((ANS.EQ.'T').AND.(FLAG.LT.1)) GOTO 3090
	IF ((xx.lt.0).AND.(ANS.EQ.'OP')) GOTO 4120
	IF ((SRT.EQ.1).AND.(ANS.EQ.'AC')) GOTO 4125
	IF ((ANS.EQ.'4').AND.(FLAG.LT.1)) GOTO 3580
	IF ((ANS.EQ.'AR').AND.(LO.GT.0)) GOTO 4210
	IF ((ANS.EQ.'2').AND.(FLAG.LT.1)) GOTO 3520
	IF (ANS.EQ.'?') CALL HLP2(NNET,FLAG,SRT,XX)
	IF (ANS.EQ.'DP') GOTO 4070
	IF ((XX.LT.0).AND.(ANS.EQ.'SUP')) GOTO 4175
	IF (ANS.EQ.'AP') GOTO 4065
	IF (ANS.EQ.'MP') GOTO 4067
	IF ((XX.LT.0).AND.(ANS.EQ.'C1')) GOTO 4235
	IF ((XX.LT.0).AND.(ANS.EQ.'D1')) GOTO 4260
C       IF ((XX.LT.0).AND.(ANS.EQ.'DON')) GOTO 4285
	IF ((XX.LT.0).AND.(ANS.EQ.'FIND')) GOTO 4370
	IF ((XX.LT.0).AND.(ANS.EQ.'DELET')) CALL DRP1(UNAM,ME,VERS)
	IF ((ANS.EQ.'K1').AND.(FLAG.LT.1)) GOTO 4300
	IF (ANS.EQ.'K2') GOTO 4595
	IF ((XX.LT.0).AND.(ANS.EQ.'NSTAT')) GOTO 4490
	IF ((XX.LT.0).AND.(ANS.EQ.'REOPE')) GOTO 3925
	IF (ANS.EQ.'TIME ') GOTO 3950
	IF (ANS.EQ.'VER') TYPE 55,VERS,REV
	IF ((SRT.GE.1).AND.(ANS.EQ.'INT')) GOTO 47
	IF (ANS.EQ.'CNVRT') CALL CDDWN
C       IF ((ANS.EQ.'REP').AND.(XX.LT.0))
C    1  CALL RUN('DSK','REPORT','TNT')
	GOTO 59
C
C       INPUT FOR A NEW TICKET
C
100     FORMAT(4A5)
110     FORMAT(' ENTER THE NETWORK NUMBER OR A ZERO(0) FOR HELP : ',$)
120     FORMAT(I8)
171     FORMAT(/3X,3A5,1X,I8,/)
170     FORMAT(1H+,3A5,2H :,T20,$)
203     FORMAT(1H+,2A5,2H :,T20,$)
188     FORMAT(1H+,A5,2H :,T20,$)
194     FORMAT(I6)
214     FORMAT(20(1H ))
131     FORMAT(/1X,'HERE ARE THE TICKETS FOR THAT NODE...',/1X,
     1  'TNUM',T10,'DATE',T30,'NODE',T37,'HOST',T45,'CIRCUIT #',
     1  T68,'PROD.',/)
135     FORMAT(5X,'... NONE ...',/)
134     FORMAT(/1X,'DO YOU NEED TO SEE MORE DETAIL ? (Y OR N) : ',$)
133     FORMAT(1X,'THERE ARE ',I2,' TICKET(S) FOR NODE # ',I5,
     1  /3X,'DO YOU WANT TO ADD YOUR CONTACT TO THIS TICKETS CALL BACK',
     2  ' LIST ? ',$)
162     FORMAT(1H+,'DO YOU WANT TO OPEN ANOTHER TICKET ? ',$)
174     FORMAT(1H+,4A5,2H :,$)
175     FORMAT(/1X,'ENTER "YOUR" INITIALS PLEASE : ',$)
140     CALL DBERR($150,IERT,IERC,0)
	GOTO 152
150     IF (IERT.NE.7) GOTO 4955
	TYPE 151
151     FORMAT(1X,'STANDBY FOR TNUM... DATA BASE BUSY... ',
     1  'WAITING 10 SECS.')
	CALL WAIT(5.0)
152     CALL DBOPEN(BASE(18))
	CALL DBUPD(-1)
	CALL DBFIND(2,1,9)
	CALL DBNREC(NUMBER)
	IF (NUMBER.EQ.1) GOTO 153
	N=5
	IF (NUMBER.GT.1) GOTO 1360
	GOTO 1370
153     CALL DBGREC($4800,1)
	CALL DBVAL(1,TNUM)
	TNUM=TNUM+1
	TOT=TNUM
	CALL DBCHNG(1,TNUM)
138     CALL DBCLOS
	TYPE 171,TIC,TNUM
	GOTO 4054
176     FORMAT(A3)
180     CALL GTIM(TIM1,SDAT,LIC)
	TYPE 177
177     FORMAT(1X,'PROBLEM DESCRIPTION',/,$)
	CALL GETINF(DISC,10,NLINE)
	I=1
204     TYPE 2531
2531    FORMAT(1H+'ENTER THE NUMBER FOR THE GROUP WITH THE PROBLEM',
     1  /2X,'OR ENTER  A ZERO FOR HELP : ',$)
	ACCEPT 120,M
	IF((M.GE.LOATTN).AND.(M.LE.HIATTN)) GOTO 201
	IF ((M.EQ.0).OR.(I.EQ.2)) CALL HREFR
	IF (I.EQ.3) GOTO 59
	I=I+1
	GOTO 204
201     I=1
208     TYPE 203,OSVR
	ACCEPT 120,SVER
	IF ((SVER.LT.1).OR.(SVER.GT.4)) GOTO 208
	TYPE 209
209     FORMAT(1X,'COMMENT(20 CHAR. MAX): ',T25,$)
	ACCEPT 100,COMMNT
	IF(CSC.EQ.1) GOTO 8112
	TYPE 8110
8110    FORMAT(/1X,'ENTER THE CUST. TICKET # IF YOU KNOW IT: ',$)
	ACCEPT 632,ONUM
632	FORMAT(2A5)
	I=1
8112    TYPE 8111
8111    FORMAT(/1X,'ENTER THE CODE FOR THE "REPORTED" PROBLEM',
     1  /2X,'OR ENTER A ZERO FOR HELP : ',$)
	ACCEPT 120,L
	IF ((L.GE.1).AND.(L.LE.NPROB)) GOTO 8113
	IF ((L.EQ.0).OR.(I.GE.3)) CALL HLPREP
	I=I+1
	GOTO 8112
8113    TYPE 210,TNUM
210     FORMAT(1H+,'DATA BASE IS BEING  OPENED AND TICKET #',I8,
     1  ' WILL BE WRITTEN TO DISK',$)
1375    FORMAT(/3X,'THERE IS NO RECORD OF THE THE LAST TICKET NUMBER',
     1  ' USED !.')
	IF (WELL.EQ.'N') NT=1
	IF (WELL.EQ.'H') NT=2
	IF (WELL.EQ.'C') NT=3
	IF (WELL.EQ.'F') NT=4
	ESC=1
	F2=CG
	IF ((M.EQ.41).OR.(M.EQ.36).OR.(M.EQ.21).OR.(M.EQ.25)
     1  .OR.(M.EQ.29).OR.(M.EQ.30).OR.(M.EQ.72).OR.(M.EQ.81).OR.
     2  (M.EQ.71)) ESC=2
	ENCODE(5,8114,DISC(165))SVER,CG
8114    FORMAT(I1,I2,'  ')
1376    CALL DBERR($1377,IERT,IERC,0)
	GOTO 1378
1377    IF (IERT.NE.7) GOTO 4955
	TYPE 1379
1379    FORMAT(1X,'DATA BASE BUSY... WAITING 10 SECS.')
	CALL WAIT(5.0)
1378    CALL DBOPEN(BASE(1))
	CALL DBUPD(-1)
	CALL DBADD(1,TNUM,2,PRO,3,T40,5,SDAT,6,TIM1,7,REPN,8,REPF,
     1  9,VNET(K),10,ME,11,0,12,SITC,13,SITP,14,PROD,15,'OPEN',16,
     2  DISC,22,LOC,23,KHST,24,COV,25,COMMNT,28,STH,29,EHR,30,PORT,
     3  31,CNAM,32,TECH,33,VER,36,1,37,1,38,1,40,NOD1,41,SLOT,42,HST1,
     4  43,CIRCKT,44,TROUB1,45,1,46,ESC,48,NT,51,ATTN(M),52,SVER,53,CG,
     5  20,SRGN,21,HRGN,50,'.....',27,'.....',55,'NONE      ',47,F1,
     6  19,ONUM,57,REPRB(L),17,1,4,F2)
	ENCODE(841,207,DISC)
207     FORMAT(841(1H ))
	CALL DBCLOS
	CALL DBERR($211,IERT,IERC,0)
	GOTO 213
211     IF (IERT.NE.7) GOTO 4955
	TYPE 212
212     FORMAT(1X,'TRACKING DATA BASE BUSY... WAITING 10 SECS.')
	CALL WAIT(5.0)
213     CALL DBOPEN(BASE(6))
	CALL DBUPD(-1)
	CALL DBADD(1,TNUM,2,SDAT,3,TIM1,7,'OPEN',8,ATTN(M),10,VNET(K),
     1  11,SVER,12,PROD,14,ME,17,F1)
	CALL DBCLOS
	CALL DBERR($4930,IERT,IERC,0)
	IF (NOD1.GT.0) GOTO 3360
	GOTO 59
C
C
C       ADD STATUS FOR A TICKET
C
215     TYPE 170,TIC
	LONG=0
	CALL DBOPEN(BASE(1))
216     ACCEPT 120,TNUM
	IF (TNUM.EQ.0) GOTO 4950
218     CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 217
	IF (ANS.EQ.'D') GOTO 2461
	TYPE 202,TNUM
202     FORMAT(1X,'TICKET # ',I8,' IS NOT IN THE ACTIVE DATA BASE,',
     1  /3X,'PLEASE RE-ENTER.',/)
	TYPE 170,TIC
	GOTO 216
217     CALL DBGREC($4840,1)
	CALL DBVAL(15,STAT,5,SDAT,6,TIM1,14,PROD,51,MAINT,52,SVER,54,
     1  ELM,49,DUP,50,TUP,35,V6,36,V1,37,V2,38,V3,39,V4,53,HH,47,F1,
     2  9,NET,46,ESC,31,CNAM,40,NODE,55,COC)
222     TYPE 221,CNAM,NODE,PROD,TNUM,STAT
221     FORMAT(/1X,'CUSTOMER: ',3A5,4X,'NODE: ',I5,4X,'PROD: ',A5,
     1  /1X,'TICKET # ',I6,' IS CURRENTLY ',A5,'.',/10X,'WHAT ',
     1  'WOULD YOU LIKE TO DO WITH IT ?',/15X,'1 = ADD STATUS',/15X,
     2  '2 = PUT ON MONITOR',/15X,'3 = CLOSE TICKET',/15X,
     3  '4 = REOPEN TICKET',/15X,'5 = MAKE NO CHANGE',/15X,
     4  '6 = ENTER TIC MARK',/15X,'7 = ENTER ESCALATION',/15X,
     5  '8 = DEFER TICKET',/15x,'9 = track'/14X,'10 = SET TIME UP ONLY',
     6  /14X,'11 = DE-ESCALATE THE TICKET',/14X,'12 = ADD LONG STATUS',
     7  /2X,'ENTER # ',$)
	ACCEPT 120,L
	IF(L.NE.12) LONG=0
	IF (L.EQ.1) GOTO 219
	IF ((L.EQ.2).AND.(LIC.EQ.1).AND.(STAT.EQ.'OPEN')) GOTO 219
	IF ((L.EQ.3).AND.(LIC.EQ.1)) GOTO 3765
	IF ((L.EQ.4).AND.(LIC.EQ.1)) GOTO 226
	IF (L.EQ.5) GOTO 4950
	IF ((L.GE.6).AND.(L.LE.8)) GOTO 219
	if ((l.eq.9).AND.(LIC.EQ.1).AND.(STAT.EQ.'OPEN')) goto 219
	IF ((L.EQ.10).AND.(DUP.EQ.0).AND.(LIC.EQ.1)) GOTO 219
	IF (L.EQ.11) GOTO 219
	IF (L.EQ.12) GOTO 4335
	GOTO 222
226     ELM=0
	SDAT=0
	TIM1='     '
	CALL MTTR(DUP,SDAT,TUP,TIM1,ELM,HOUR)
	IF ((HOUR.GT.24.0).AND.(STAT.EQ.'CLSD')) GOTO 240
	V6=V6+HOUR
	IF (V6.GT.999) V6=999
	CALL DBERR($227,IERT,IERC,0)
	GOTO 228
227     IF (IERT.NE.7) GOTO 4955
	TYPE 1379
	CALL WAIT(6.0)
228     CALL DBOPEN(BASE(1))
	CALL DBUPD(-1)
	CALL DBFIND(1,1,TNUM)
	CALL DBCHNG(15,'OPEN',11,0,49,0,50,'.....',54,0,35,V6,
     1  26,0,27,'.....')
	CALL DBCLOS
	CALL DBERR($4930,IERT,IERC,0)
219     TYPE 220,ST
220     FORMAT(1H+,3A5,/,$)
	CALL GETINF(INFO,4,NLINE)
	CALL CSTAT(INFO,TRASH,Z,TNUM)
	IF (TRASH.NE.' ') GOTO 219
	IF (LONG.EQ.1) GOTO 4342
237     IF ((L.NE.2).AND.(L.NE.9)) GOTO 232
	IF(DUP.EQ.0) CALL GETIM(TUP,DUP)
	IF (L.EQ.2) CALL RESCOD(TNUM,CCC,ANS,L)
	CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
	CALL VDIS(V4,V6,ELM)
	CALL DBERR($229,IERT,IERC,0)
	GOTO 231
229     IF (IERT.NE.7) GOTO 4930
	TYPE 1379
	CALL WAIT(5.0)
231     CALL DBOPEN(BASE(1))
	CALL DBUPD(-1)
	CALL DBFIND(1,1,TNUM)
	CALL DBCHNG(49,DUP,50,TUP,'STAT',STATUS(L),54,ELM,34,V5,35,V6,
     1  36,V1,37,V2,38,V3,39,V4)
	IF (L.EQ.2)CALL DBCHNG(55,CODE(CCC),17,CCC,19,ONUM)
	CALL DBCLOS
	IF (L.EQ.9) GOTO 232
	CALL DBERR($239,IERT,IERC,0)
	GOTO 241
239     IF (IERT.NE.7) GOTO 4930
	TYPE 1379
	CALL WAIT(6.0)
241     CALL DBOPEN(BASE(6))
	CALL DBUPD(-1)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(RECORD)
	IF (RECORD.EQ.0) GOTO 236
	CALL DBGREC($215,RECORD)
	CALL DBCHNG(4,DUP,5,TUP)
	CALL DBCLOS
	CALL DBERR($4930,IERT,IERC,0)
	GOTO 232
236     CALL DBADD(1,TNUM,2,SDAT,3,TIM1,4,DUP,5,TUP,7,STATUS(L),
     1  8,MAINT,10,NET,11,SVER,12,PROD,14,ME,17,F1)
	CALL DBCLOS
232     CALL GTIM(TIM1,SDAT,LIC)
	IF ((INFO(1).EQ.'.    ').or.(info(1).eq.'     ')) GOTO 265
	CALL DBERR($261,IERT,IERC,0)
	GOTO 263
261     IF (IERT.NE.7) GOTO 4955
	TYPE 1379
	CALL WAIT(6.0)
263     CALL DBOPEN(BASE(2))
	CALL DBUPD(-1)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(ORDER)
	ORDER=ORDER+1
	IF (L.NE.4) GOTO 264
	CALL DBFIND(1,1,TNUM)
	CALL DBCHNG('RS',1)
264     CALL DBADD(1,TNUM,2,SDAT,3,TIM1,4,ME,'STAT',STATUS(L),
     2  7,INFO,8,UNAM,9,ORDER,5,RS)
	CALL DBCLOS
265     CALL DBERR($4930,IERT,IERC,0)
	ENCODE(320,233,INFO)
233     FORMAT(320(1H ))
	IF (LOATTN.EQ.0) GOTO 59
	IF (L.EQ.6) GOTO 3800
	IF (L.EQ.7) GOTO 3805
	IF (L.EQ.8) GOTO 3870
	IF (L.EQ.10) GOTO 4275
	IF (L.EQ.11) GOTO 4330
	IF ((L.EQ.2).AND.(MAINT.NE.'CUSTM')) GOTO 2383
235     TYPE 234,PROD,MAINT,SVER
234     FORMAT(/1X,'PRODUCT = ',A5,' REFERRED TO = ',A5,' SEVERITY = ',I1,
     1  /1X,'DO YOU WISH TO CHANGE ANYTHING ABOVE (Y) OR RETURN ',
     2  'TO THE MENU (C.R.) ?: ',$)
	ACCEPT 65,SEE
	CALL HISET(SEE)
	IF (SEE.EQ.'Y') GOTO 2381
	GOTO 59
240     TYPE 242,TNUM,HOUR
242     FORMAT(/,/,/,5X,'TICKET # ',I8,' HAS BEEN CLOSED FOR ',F6.1,
     1  ' HOURS.',/6X,'YOU MAY NOT REOPEN TICKETS THAT ARE CLOSED ',
     2  'MORE',/5X,'24 HOURS.  PLEASE OPEN A NEW TICKET TO TRACK ',
     3  'REPEAT PROBLEM.',/,/5X,'THANK YOU...',/)
	GOTO 4950
C
C       LOOK AT A SINGLE TICKET
C
650     I=1
	IF ((ANS.EQ.'A').AND.(SEE.EQ.'Y')) GOTO 59
	SEE=' '
	IF(ANS.EQ.'A') TYPE 9651
9651    FORMAT(/,/,/1X,'NOW CHECK THE TICKET HEADER FOR COMPLETENESS',
     1  ' AND ACCURACY!',/,/)
	IF(ANS.EQ.'A') GOTO 9650
651     TYPE 711,TIC
	ACCEPT 120,TNUM
9650    CALL DBOPEN(BASE(1),BASE(2),BASE(8))
	Z=1
	IF(TNUM.EQ.0) GOTO 4940
653     CALL DBSET(1)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 670
	TYPE 652
652     FORMAT(/1X'THE TICKET YOU WANT IS IN THE ARCHIVE DATA BASE',
     1  /,/2X'STANDBY WHILE WE OPEN THE DATA BASE AND FIND IT',/)
	CALL DBOPEN(BASE(4),BASE(5),BASE(9))
	Z=2
	CALL DBSET(1)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 670
	H2=TNUM/10000
	IF (H2.GT.9) GOTO 300
	ENCODE(10,661,BASE(11))H2
661     FORMAT('B1',I1,'0',6X)
	ENCODE(10,662,BASE(12))H2
662     FORMAT('B2',I1,'0',6X)
	ENCODE(10,663,BASE(13))H2
663     FORMAT('B8',I1,'0',6X)
	GOTO 305
300     ENCODE(10,301,BASE(11))H2
301     FORMAT('B1',I2,'0',5X)
	ENCODE(10,302,BASE(12))H2
302     FORMAT('B2',I2,'0',5X)
	ENCODE(10,303,BASE(13))H2
303     FORMAT('B8',I2,'0',5X)
305     CALL DBERR($659,IERT,IERC,0)
	CALL DBOPEN(BASE(11),BASE(12),BASE(13))
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 670
659     TYPE 660,TNUM
660     FORMAT(/10X,'TICKET NUMBER',I8,' DOES NOT EXIST',/)
	IF (IERT.GT.0) TYPE 4957,IERT,IERC
	I=I+1
	CALL DBERR($4930,IERT,IERC,0)
	IF (I.NE.3) GOTO 651
	TYPE 665
665     FORMAT(/10X,'RE-SETTING INPUT QUES... TRY AGAIN.',/)
	GOTO 4950
670     DO 690 I=1,NUMBER
666     CALL DBGREC0,I)
	CALL DBVAL(1,TNUM,2,PRO,3,T40,4,F2,5,SDAT,6,TIM1,7,RNAM,8,RFON,
     1  9,NET,10,INT,11,RS,12,SITC,13,SITP,14,PROD,15,STAT,16,DISC,17,
     2  CCC,18,HQCC,19,ONUM,20,SRGN,21,HRGN,22,
     3  LOC,23,KHST,24,COV,25,COMMNT,26,CDAT,27,TCLSD,28,STH,29,EHR,
     4  30,PORT,31,CNAM,32,TECH,33,VER,34,V5,35,V6,36,V1,37,V2,38,V3,
     5  39,V4,40,NODE,41,SLOT,42,HOST,43,CKT,44,TRB,45,BILL,46,ESC,47,
     6  F1,48,NT,49,DUP,50,TUP,51,MAINT,52,SVER,53,HH,54,ELM,55,COC,
     7  56,CBY,57,PROBL)
	TDAT=DUP
	TET=ELM
	TIM2=TUP
	IF (FLAG.LT.1) GOTO 678
	ENCODE(25,671,FILE)SNET(FLAG)
671     FORMAT(A5,'          ')
	IF (NET.EQ.FILE) GOTO 678
	TYPE 677
677     FORMAT(/3X'YOU DO NOT HAVE ACCESS TO THIS TICKET !',/)
	ENCODE(841,207,DISC)
	GOTO 59
678     CALL DBNDAT(SDAT,IM,ID,IY)
	IF (DUP.GT.0) GOTO 686
	JY=0
	JD=0
	SM=0
	SD=0
	SY=0
	JM=0
	GOTO 687
686     IF (CDAT.EQ.0)GOTO 685
	CALL DBNDAT(CDAT,SM,SD,SY)
	SY=SY-1900
685     CALL DBNDAT(DUP,JM,JD,JY)
	JY=JY-1900
687     IY=IY-1900
	CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
	IF (NT.EQ.2) GOTO 655
	IF (NT.EQ.3) GOTO 674
	IF (NT.EQ.4) GOTO 99655
654     TYPE 680,NET,SVER,CNAM,TNUM,STAT,SITC,NODE,NETOP(HH),
     1  SITP,KHST,MAINT,LOC,PROD,V1,V2,V3,RNAM,VER,YN(ESC),RFON,
     2  SRGN,HQCC,COV,HRGN,V4,V6,STH,EHR,YN(PRO),ID,
     3  AM(IM),IY,TIM1,TECH,INT,JD,AM(JM),JY,TUP,CKT,F1,SD,AM(SM),
     4  SY,TCLSD,TRB
680     FORMAT(/1X,'NETWORK',T11,2H: ,A10,T24,'SEVERITY',T37,2H: ,
     1  I1,T50,'CUSTOMER: ',3A5,/1X,'NODE TKT#: ',I8,T24,'STATE',
     2  T37,2H: ,A5,T50,'CONTACT : ',4A5,/1X,'NODE #',T11,2H: ,
     3  I5,T24,'CONTROL GROUP: ',A5,T51,'CPHONE : ',4A5,/1X,
     4  'KERNAL',T11,2H: ,I5,T24,'REFERRED TO',T37,2H: ,A5,T50,
     5  'LOCALE',T58,2H: ,4A5,/1X,'PRODUCT',T11,2H: ,A5,T24,
     6  'MGMT ESCAL',T37,3H: H,I1,2H S,I1,2H T,I1,T50,'RPTD ',
     7  'BY : ',4A5,/1X,'S/W VERS : ',A5,T24,'TECH ESCAL',T37,
     8  2H: ,A3,T51,'RPHONE : ',4A5,/1X,'S/W DIST : ',A5,T24,
     9  'DE-ESCAL CODE: ',I3,T50,'PLAN #',T58,2H: ,A2,/1X,
     A  'H/W DIST : ',A5,T24,'DEFER :  ',I3,1H/,I3,T50,'SITE HR ',
     B  2H: ,A5,' TO ',A5,/1X,'PRIMARY  : ',A3,T24,'OPEN  : ',
     C  I2,1H-,A3,1H-,I2,1X,A5,1HZ,2X,'COM SPEC: ',3A5,/1X,
     D  'OPEN BY',T11,2H: ,A3,T24,'RESLV : ',I2,1H-,A3,1H-,I2,
     E  1X,A5,1HZ,T50,'CKT #',T58,2H: ,4A5,/1X,'ZONE',T11,2H: ,I1,T24,
     F  'CLOSE : ',I2,1H-,A3,1H-,I2,1X,A5,1HZ,T50,'TELCO # : ',4A5)
	TYPE 688,HOUR,ONUM,COC,YN(BILL),YN(T40),PROBL
688     FORMAT(T24,'ELAPS :  ',F8.1,4H HR.,T50,'REF.TKT#: ',2A5,
     1  /,T24,'CLSCD : '2A5,T49,'BILL/T40: 'A3,1H/,A5,
     2  /,/1X,'REPORTED PROBLEM: ',2A5,/)
	GOTO 684
655     TYPE 689,NET,SVER,CNAM,TNUM,STAT,SITC,NODE,NETOP(HH),
     1  SITP,KHST,MAINT,LOC,HOST,V1,V2,V3,RNAM,SLOT,YN(ESC),RFON,
     2  PORT,HQCC,COV,PROD,V4,V6,STH,EHR,VER,ID,AM(IM),
     3  IY,TIM1,TECH,SRGN,JD,AM(JM),JY,TUP,CKT,HRGN,
     4  SD,AM(SM),SY,TCLSD,TRB
689     FORMAT(/1X,'NETWORK',T11,2H: ,A10,T24,'SEVERITY',T37,2H: ,
     1  I1,T50,'CUSTOMER: ',3A5,/1X,'HOST TKT#: ',I8,T24,'STATE',
     2  T37,2H: ,A5,T50,'CONTACT : ',4A5,/1X,'NODE #',T11,2H: ,
     3  I5,T24,'CONTROL GROUP: ',A5,T51,'CPHONE : ',4A5,/1X,
     4  'KERNAL',T11,2H: ,I5,T24,'REFERRED TO',T37,2H: ,A5,T50,
     5  'LOCALE',T58,2H: ,4A5,/1X,'HOST #',T11,2H: ,I6,T24,
     6  'MGMT ESCAL',T37,3H: H,I1,2H S,I1,2H T,I1,T50,'RPTD ',
     7  'BY : ',4A5,/1X,'SLOT     : ',A2,T24,'TECH ESCAL',T37,
     8  2H: ,A3,T51,'RPHONE : ',4A5,/1X,'# PORTS  : ',I3,T24,
     9  'DE-ESCAL CODE: ',I3,T50,'PLAN #',T58,2H: ,A2,/1X,
     A  'PRODUCT  : ',A5,T24,'DEFER :  ',I3,1H/,I3,T50,'SITE HR ',
     B  2H: ,A5,' TO ',A5,/1X,'S/W VERS : ',A5,T24,'OPEN  : ',
     C  I2,1H-,A3,1H-,I2,1X,A5,1HZ,2X,'COM SPEC: ',3A5,/1X,
     D  'S/W DIST',T11,2H: ,A5,T24,'RESLV : ',I2,1H-,A3,1H-,I2,
     E  1X,A5,1HZ,T50,'CKT #',T58,2H: ,4A5,/1X,'H/W DIST : ',A5,T24,
     F  'CLOSE : ',I2,1H-,A3,1H-,I2,1X,A5,1HZ,T50,'TELCO # : ',4A5)
	TYPE 668,YN(PRO),HOUR,ONUM,INT,COC,YN(BILL),YN(T40),F1,PROBL
668     FORMAT(1X,'PRIMARY  : ',A3,T24,'ELAPS : ',F8.1,4H HR.,T50,
     1  'REF.TKT#: ',2A5,/1X,'OPEN BY  : ',A3,T24,'CLSCD : '2A5,T49,
     2  'BILL/T40: ',A3,1H/,A5,/1X,'ZONE',T11,2H: ,I1,
     3  /,/1X,'REPORTED PROBLEM: ',2A5,/)
	GOTO 684
C
C       CIRCUIT TICKET DISPLAY
C
674     TYPE 669,NET,SVER,CNAM,TNUM,STAT,SITC,NODE,NETOP(HH),
     1  SITP,KHST,MAINT,LOC,HOST,V1,V2,V3,RNAM,VER,YN(ESC),RFON,
     2  PROD,HQCC,COV,HRGN,V4,V6,STH,EHR,YN(PRO),
     3  ID,AM(IM),IY,TIM1,CKT,INT,JD,AM(JM),JY,TUP,TRB,F1,SD,AM(SM),
     4  SY,TCLSD,ONUM
669     FORMAT(/1X,'NETWORK',T11,2H: ,A10,T24,'SEVERITY',T37,2H: ,
     1  I1,T50,'CUSTOMER: ',3A5,/1X,'LINE TKT#: ',I8,T24,'STATE',
     2  T37,2H: ,A5,T50,'CONTACT : ',4A5,/1X,'LONODE',T11,2H: ,
     3  I5,T24,'CONTROL GROUP: ',A5,T51,'CPHONE : ',4A5,/1X,
     4  'LO KHOST',T11,2H: ,I5,T24,'REFERRED TO',T37,2H: ,A5,T50,
     5  'LOCALE',T58,2H: ,4A5,/1X,'HI NODE',T11,2H: ,I5,T24,
     6  'MGMT ESCAL',T37,3H: H,I1,2H S,I1,2H T,I1,T50,'RPTD ',
     7  'BY : ',4A5,/1X,'HI KHOST : ',A5,T24,'TECH ESCAL',T37,
     8  2H: ,A3,T51,'RPHONE : ',4A5,/1X,'SPEED    : ',A5,T24,
     9  'DE-ESCAL CODE: ',I3,T50,'PLAN #',T58,2H: ,A2,/1X,
     A  'H/W DIST : ',A5,T24,'DEFER :  ',I3,1H/,I3,T50,'SITE HR ',
     B  2H: ,A5,' TO ',A5,/1X,'BACKBONE : ',A3,T24,'OPEN  : ',
     C  I2,1H-,A3,1H-,I2,1X,A5,1HZ,2X,'CIRCUIT : ',4A5,/1X,
     D  'OPEN BY',T11,2H: ,A3,T24,'RESLV : ',I2,1H-,A3,1H-,I2,
     E  1X,A5,1HZ,T50,'TELCO #',T58,2H: ,4A5,/1X,'ZONE',T11,2H: ,I1,T24,
     F  'CLOSE : ',I2,1H-,A3,1H-,I2,1X,A5,1HZ,T50,'REF TKT#: ',3A5)
	TYPE 667,HOUR,TECH,COC,YN(BILL),YN(T40),PROBL
667     FORMAT(T24,'ELAPS : ',F8.1,4H HR.,T50,'ANALYSIS: ',3A5,
     1  /,T24,'CLSCD : '2A5,T49,'BILL/T40: 'A3,1H/,A5,/,
     2  /1X,'REPORTED PROBLEM: ',2A5,/)
	GOTO 684
99655   TYPE 99689,NET,SVER,CNAM,TNUM,STAT,SITC,NODE,NETOP(HH),
     1  SITP,KHST,MAINT,LOC,HOST,V1,V2,V3,RNAM,SLOT,YN(ESC),RFON,
     2  PORT,HQCC,COV,PROD,V4,V6,STH,EHR,VER,ID,AM(IM),
     3  IY,TIM1,TECH,SRGN,JD,AM(JM),JY,TUP,CKT,HRGN,
     4  SD,AM(SM),SY,TCLSD,TRB
99689   FORMAT(/1X,'NETWORK',T11,2H: ,A10,T24,'SEVERITY',T37,2H: ,
     1  I1,T50,'CUSTOMER: ',3A5,/1X,'FRAME TKT: ',I8,T24,'STATE',
     2  T37,2H: ,A5,T50,'CONTACT : ',4A5,/1X,'NODE #',T11,2H: ,
     3  I5,T24,'CONTROL GROUP: ',A5,T51,'CPHONE : ',4A5,/1X,
     4  'DLCI  ',T11,2H: ,I5,T24,'REFERRED TO',T37,2H: ,A5,T50,
     5  'LOCALE',T58,2H: ,4A5,/1X,'CARD #',T11,2H: ,I6,T24,
     6  'MGMT ESCAL',T37,3H: H,I1,2H S,I1,2H T,I1,T50,'RPTD ',
     7  'BY : ',4A5,/1X,'PORT #   : ',A2,T24,'TECH ESCAL',T37,
     8  2H: ,A3,T51,'RPHONE : ',4A5,/1X,'MDLCI    : ',I3,T24,
     9  'DE-ESCAL CODE: ',I3,T50,'PLAN #',T58,2H: ,A2,/1X,
     A  'IPX      : ',A5,T24,'DEFER :  ',I3,1H/,I3,T50,'SITE HR ',
     B  2H: ,A5,' TO ',A5,/1X,'ROUTER   : ',A5,T24,'OPEN  : ',
     C  I2,1H-,A3,1H-,I2,1X,A5,1HZ,2X,'COM SPEC: ',3A5,/1X,
     D  'S/W DIST',T11,2H: ,A5,T24,'RESLV : ',I2,1H-,A3,1H-,I2,
     E  1X,A5,1HZ,T50,'CKT #',T58,2H: ,4A5,/1X,'H/W DIST : ',A5,T24,
     F  'CLOSE : ',I2,1H-,A3,1H-,I2,1X,A5,1HZ,T50,'IP ADDR : ',4A5)
	TYPE 99668,YN(PRO),HOUR,ONUM,INT,COC,YN(BILL),YN(T40),F1,PROBL
99668   FORMAT(1X,'BUNDLED  : ',A3,T24,'ELAPS : ',F8.1,4H HR.,T50,
     1  'REF.TKT#: ',2A5,/1X,'OPEN BY  : ',A3,T24,'CLSCD : '2A5,T49,
     2  'BILL/T40: ',A3,1H/,A5,/1X,'ZONE',T11,2H: ,I1,
     3  /,/1X,'REPORTED PROBLEM: ',2A5,/)
	GOTO 684
684     CALL TYPINF(DISC,10)
690     CONTINUE
	ENCODE(841,207,DISC)
	CALL DBSET(3)
	CALL DBFIND('RS',1,1,'OR','RS',1,9,1,1,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.EQ.0) GOTO 713
	TYPE 709
709     FORMAT(/1X,'***ESCALATIONS PERFORMED ...***',/3X,'PERSON',T27,
     1  'DATE/TIME',/)
	DO 708 I=1,NUMBER
	CALL DBGREC($713,I)
	CALL DBVAL(2,SDAT,3,TIM1,4,RNAM)
	CALL DBNDAT(SDAT,IM,ID,IY)
	IY=IY-1900
	TYPE 707,RNAM,AM(IM),ID,IY,TIM1
707     FORMAT(3X,4A5,T27,A3,1H-,I2,1H-,I2,2X,A5)
708     CONTINUE
713     CALL DBFIND('RS',1,0,'OR','RS',1,8,1,1,1,TNUM)
	CALL DBNREC(RECORD)
	IF (RECORD.EQ.0) GOTO 712
	TYPE 714
714     FORMAT(/1X,'CALL BACK LIST...',/3X,'PERSON',T25,'COMPANY',
     1  T46,'PHONE NUMBER',4X,'TALKED TO ?',/)
	DO 718 J=1,RECORD
	CALL DBGREC($712,J)
	CALL DBVAL(4,RNAM,7,SITC,8,SITP,13,CHEX,12,cbak)
	TYPE 716,CHEX,SITC,RNAM,SITP(1),SITP(2),SITP(3),CBAK(1),
     1  CBAK(2),CBAK(3)
716     FORMAT(1X,A1,1X,4A5,T25,4A5,1X,A5,A5,A5,2X,A5,A5,A5)
718     CONTINUE
712     CALL DBSET(2)
8005    CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
C
C
C
C
	IF (NUMBER.EQ.0) GOTO 740
691     TYPE 692,NUMBER
692     FORMAT(/3X,'HOW MANY OF THE LAST ',I3,' STATUS',
     1  ' ENTRIES DO YOU WANT TO LOOK AT?: ',$)
	ACCEPT 120,RECORD
	IF (RECORD.EQ.0) GOTO 740
	IF (RECORD.GT.NUMBER)RECORD=NUMBER
	RECORD=NUMBER-RECORD+1
	DO 710 I=RECORD,NUMBER
	CALL DBGREC($4930,I)
	CALL DBVAL(1,TNUM,2,SDAT,3,TIM1,4,INT,5,RS,6,STAT,7,INFO,8,
     1  PNAM,9,ORDER)
	CALL DBNDAT(SDAT,IM,ID,IY)
	IY=IY-1900
	TYPE 700,ORDER,PNAM,INT,ID,AM(IM),IY,TIM1,AS(RS),TNUM
700     FORMAT(/1X,'--#',I3,' STATUS ENTERED FROM ',3A5,' BY ',A3,' ON ',
     1  I2,1H-,A3,1H-,I2,2H @,A5,' ZULU.',/5X,'REPORT SENT YET ?: ',A3,
     2  T33,1H(,I8,1H))
	CALL TYPINF(INFO,4)
710     CONTINUE
711     FORMAT(/,/1X,3A5,2H :,T20,$)
	ENCODE(320,233,INFO)
933     FORMAT(95(1H ))
C
C********************
C
C       CHECK FOR MULTIPLE LOOKS
C
C********************
C
740     IF(HDRCHK.EQ.1) GOTO 9741
	IF (ANS.EQ.'A') GOTO 3298
9741    TYPE 741,TNUM
741     FORMAT(/1X,'*** ENTER A 1 TO STATUS TICKET # ',I8,' OR NEXT ',
     1  'TICKET NUMBER TO VIEW')
	NUM1=TNUM
	IF (Z.EQ.2) GOTO 651
	TYPE 711,TIC
	ACCEPT 120,TNUM
	IF (TNUM.GT.2) GOTO 653
	IF ((TNUM.EQ.1).AND.(SRT.GE.1)) GOTO 4365
	GOTO 4940
C
C       LIST OPEN TICKETS FOR A SPECIFIC NETWORK
C
750     CALL DBOPEN(BASE(1))
	IF (FLAG.LE.0) GOTO 751
	K=FLAG
	GOTO 752
751     TYPE 110
	ACCEPT 120,K
	IF ((K.GE.1).AND.(K.LE.NUMNET)) GOTO 752
	CALL HLPNET
	GOTO 751
752     CONTINUE
	CALL DBSET(1)
	CALL DBFIND(9,1,VNET(K),1,'STAT','NE','CLSD')
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 770
	TYPE 760,VNET(K)
760     FORMAT(/5X,' THERE ARE NO TICKETS OPEN FOR ',2A5,' NETWORK',/)
	GOTO 4950
770     TYPE 771,NUMBER,TVNET(K)
772     FORMAT(/3X,'THERE ARE ',I3,' TICKETS OPEN...',/,/)
771     FORMAT(/3X,'THERE ARE ',I3,' TICKETS OPEN FOR ',A3,'NET ',
     1  '...',/,/)
773     TYPE 768
775     FORMAT(/3X,'TIC #',1X,'DATE',1X,'PROD.',1X,'NODE',1X,
     1  'COMMENT        SEVERITY',3X,'HOST',1X,'NETWORK',3X,'STAT',
     2  2X,'ATTN.',/)
768     FORMAT(/3X,'TIC#',2X,'DATE',1X,'PROD',3X,'NODE',1X,'COMMENT',
     1  13X,'SVER',1X,'HOST',1X,'STAT',2X,'ATTN.',1X,
     2  'CTGRP    ETIM',/)
776     FORMAT(/3X,'TIC#',1X,'DATE',2X,'PROD',2X,'NODE',2X,'COMMENT',
     1  12X,'SVER',2X,'HOST',1X,'STAT',2X,'ATTN.',1X,
     2  'CTRL GRP ETIM',/)
777     FORMAT(/3X,'TIC#',1X,'DATE',2X,'WHO',3X,'NODE',2X,'CIRCUIT ',
     1  'NUMBER SVER',1X,'HOST',1X,'NETWORK',4X,'STAT',2X,'CON.',
     2  ' GRP.',/)
769     FORMAT(/3X,'TIC#',1X,'DATE',2X,'PROD',3X,'NODE',2X,'COMMENT ',
     1  '       SVER',1X,'HOST',1X,'NETWORK',4X,'STAT',2X,'CON.',
     2  ' GRP.',/)
	X=25
	IF (ANS.EQ.'4') X=31
	DO 790 I=1,NUMBER
	CALL DBGREC($4930,I)
	CALL DBVAL(1,TNUM,5,SDAT,6,TIM1,14,PROD,15,STAT,40,NODE,
     1  42,HOST,46,ESC,X,CKT,52,SVER,51,MAINT,53,HH,49,DUP,50,TUP,
     2  54,ELM)
	CALL DBNDAT(SDAT,IM,ID,IY)
	IY=IY-1900
	CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
	TYPE 2379,TNUM,IM,ID,PROD,NODE,CKT,SVER,HOST,STAT,MAINT,
     1  NETOP(HH),YY(ESC),HOUR
2379    FORMAT(1X,I6,1X,I2,1H/,I2,1X,A5,1X,I5,1X,4A5,1X,I1,1X,I6,
     1  1X,A5,1X,A5,1X,A5,1X,A1,F6.1)
790     CONTINUE
	GOTO 4950
C
C       PULL OPEN TICKET FOR WHAT EVER NETWORK IN THE DATA BASE
C
800     DECODE(5,3244,ANS)M1,M2,M3
	IF (M3.EQ.'   ') DECODE(5,3245,ANS)H1,H2,H3,H4,H5
	IF (M3.NE.'   ') DECODE(5,3241,ANS)H1,H2,H3,H4
	IF (H2.GT.0) TYPE 3243,NETOP(H2)
	CALL FGMT(IA1,IA2,IA3,IA4,IA5,IA6)
	IA3=IA3+1900
	TYPE 3177,IA4,IA5,AM(IA1),IA2,IA3
802     CALL DBOPEN(BASE(1),BASE(2))
	CALL DBSET(1)
	IF (H2.EQ.0) CALL DBFIND('STAT','NE','CLSD')
	IF (H2.GT.0) CALL DBFIND('STAT','NE','CLSD',1,'HN',1,H2)
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 820
	TYPE 810
810     FORMAT(/,/,' KEEP UP THE GOOD WORK !!!',/,/,/,/9X,
     1  'THERE ARE NO OPEN TICKETS AT ALL ',/,/,/,/,/,/)
	GOTO 4950
820     CONTINUE
	TYPE 772,NUMBER
	TYPE 866
866     FORMAT(/3X,'TIC #',1X,'DATE',1X,'PROD.',1X,'NODE',1X,
     1  'COMMENT        SEVERITY',1X,'NETWORK',3X,'STAT',
     2  2X,'ATTN.CG',2X,'ODUE',/)
	DO 870 I=1,NUMBER
	CALL DBGREC($4930,I)
	CALL DBVAL(1,TNUM,5,SDAT,6,TIM1,9,NET,14,PROD,15,STAT,40,NODE,
     1  42,HOST,25,COMMNT,52,SVER,51,MAINT,53,HH)
	CALL DBNDAT(SDAT,IM,ID,IY)
	DUP=0
	TUP=0
	ELM=0.0
	CALL DBSET(2)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(RECORD)
	IF (RECORD.EQ.0) GOTO 822
	CALL DBGREC($822,RECORD)
	CALL DBVAL(2,SDAT,3,TIM1,'UNAM',PNAM)
	IF ((PNAM(1).EQ.'NETCO').OR.(PNAM(1).EQ.'NSSC').OR.
     1  (PNAM(1).EQ.'NCF').OR.(PNAM(1).EQ.'CSS80')) GOTO 821
	GOTO 822
821    CALL DBGREC($822,RECORD-1)
	CALL DBVAL(2,SDAT,3,TIM1)
822    CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
	HOUR=(ELM-DVER(SVER))/60.0
	TYPE 869,TNUM,IM,ID,PROD,NODE,COMMNT,SVER,NET,STAT,MAINT,
     1  HH,HOUR
869     FORMAT(1X,I6,1X,I2,1H/,I2,1X,A5,1X,I5,1X,4A5,1X,I1,
     1  1X,A10,A5,1X,A5,1X,I1,1X,F5.1)
	CALL DBSET(1)
870     CONTINUE
	GOTO 4950
C
C*********************************************
C
C       ENTER HERE FOR CLOSE COMMAND
C
C*********************************************
C
903     CALL RTIM(NTIM,NDAT)
	CALL DBERR($906,IERT,IERC,0)
	GOTO 912
906     IF (IERT.NE.7) GOTO 4955
	TYPE 908
908     FORMAT(1X'CALL LOG BUSY.. WAITING 10 SECS.')
	CALL WAIT(5.0)
912     CALL DBOPEN(BASE(8),BASE(16))
	CALL DBFIND(1,1,TNUM,1,6,1,0)
	CALL DBSRCH(11,1,'   ')
	CALL DBNREC(DECIS)
	IF (DECIS.EQ.0) GOTO 918
914     TYPE 919
919     FORMAT(1X,'HAVE YOU CALLED BACK ? :')
	DO 917 J=1,DECIS
	CALL DBGREC($4955,J)
	CALL DBVAL(4,RNAM,7,SITC,8,SITP,12,CBAK)
	TYPE 916,SITC,RNAM,SITP
916     FORMAT(1X,4A5,T23,4A5,T45,4A5,T67,'(Y OR N) ? ',$)
	ACCEPT 65,SEE
	CALL HISET(SEE)
	IF (SEE.NE.'Y') GOTO 917
	TYPE 907
907     FORMAT(1X,'WITH WHOM DID YOU SPEAK ? ',$)
	ACCEPT 100,CBAK
	CALL DBERR($99906,IERT,IERC,0)
	GOTO 99912
99906   IF (IERT.NE.7) GOTO 4955
	TYPE 908
	CALL WAIT(5.0)
99912   CALL DBUPD(-1)
	CALL DBCHNG(9,NDAT,10,NTIM,11,ME,12,CBAK,13,'*',8,'CLSD')
	CALL DBUPD(0)
	CALL DBSET(2)
	CALL DBFIND(2,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.EQ.0) GOTO 922
	CALL DBSRCH(1,1,RNAM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.EQ.0) GOTO 922
	CALL DBERR($88906,IERT,IERC,0)
	GOTO 88912
88906   IF (IERT.NE.7) GOTO 4955
	TYPE 908
	CALL WAIT(5.0)
88912   CALL DBUPD(-1)
	CALL DBCHNG(12,2,8,CBAK)
922     CALL DBSET(1)
917     CONTINUE
	CALL DBERR($4930,IERT,IERC,0)
	CALL DBFIND(1,1,TNUM,1,6,1,0)
	CALL DBSRCH(11,1,'   ')
	CALL DBNREC(DECIS)
	IF (DECIS.GT.0) GOTO 921
	CALL DBFIND(1,1,TNUM,1,6,1,1)
	CALL DBNREC(DECIS)
	IF(DECIS.EQ.0) GOTO 925
	CALL DBCHNG('RS',4)
	GOTO 925
921     TYPE 923,TNUM,DECIS
923     FORMAT(1X,'TICKET NUMBER ',I8,' CAN NOT BE CLOSED YET.'/2X,
     1  'YOU STILL HAVE TO CALL ',I2,' CUSTOMER(S) BACK.')
	GOTO 4950
925     CALL DBCLOS
918     TYPE 920
920     FORMAT(/'+WHY IS THIS TICKET BEING CLOSED ?',/)
	CALL GETINF(INFO,4,NLINE)
	CALL CSTAT(INFO,TRASH,Z,TNUM)
	IF (TRASH.NE.' ') GOTO 918
	RS=4
	IF (ELM.GT.0) GOTO 939
	IF (DUP.EQ.0) CALL GETIM(TUP,DUP)
	CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
	CALL VDIS(V4,V6,ELM)
939     IF (STAT.EQ.'MONIT') CALL GTIM(TIM1,SDAT,LIC)
	CALL RESCOD(TNUM,CCC,ANS,L)
	IF (ESC.EQ.2) CALL GETDES(HQCC,ONUM)
932     CALL DBERR($931,IERT,IERC,0)
	GOTO 934
931     IF (IERT.NE.7) GOTO 4955
	TYPE 1379
	CALL WAIT(6.0)
934     CALL DBOPEN(BASE(1))
	CALL DBUPD(-1)
	CALL DBFIND(1,1,TNUM)
C
C       FORCE ELM NEGATIVE FOR TRACK ONLY TICKETS - PREVENT FROM
C       APPEARING IN THE MTTR REPORTS
C
	IF (STAT.NE.'TRACK') GOTO 938
	TET=ELM*2
	ELM=ELM-TET
938     CALL DBCHNG(11,4,'STAT','CLSD',54,ELM,56,ME,
     1  34,V5,35,V6,36,V1,37,V2,38,V3,39,V4,26,NDAT,27,NTIM)
	IF (STAT.EQ.'OPEN') CALL DBCHNG(49,DUP,50,TUP)
	IF (COC(1).EQ.'.....') CALL DBCHNG(55,CODE(CCC),17,CCC)
	IF (ESC.EQ.2) CALL DBCHNG(46,3,18,HQCC,19,ONUM)
	CALL DBCLOS
	call dberr($10935,iert,ierc,0)
	goto 936
10935   IF (IERT.NE.7) GOTO 4955
	TYPE 1379
	call wait(6.0)
936     call dbopen(BASE(2))
	call dbupd(-1)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(ORDER)
	ORDER=ORDER+1
	CALL DBADD(1,TNUM,2,NDAT,3,NTIM,4,ME,5,rs,6,'CLSD',7,INFO,8,
     1  UNAM,9,ORDER)
942     ENCODE(320,233,INFO)
	CALL DBFIND(1,1,TNUM)
	CALL DBCHNG(5,8)
	CALL DBCLOS
	CALL DBERR($943,IERT,IERC,0)
	GOTO 945
943     IF (IERT.NE.7) GOTO 4955
	TYPE 1379
	CALL WAIT(6.0)
945     CALL DBOPEN(BASE(6))
	CALL DBUPD(-1)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.EQ.0) GOTO 940
	CALL DBCHNG(6,8)
	CALL DBGREC($944,NUMBER)
	CALL DBCHNG(4,DUP,5,TUP,7,'CLSD')
944     CALL DBCLOS
	CALL DBERR($4930,IERT,IERC,0)
	GOTO 235
940     CALL DBOPEN(BASE(1))
	CALL DBFIND(1,1,TNUM)
	CALL DBGREC($4930,1)
	CALL DBVAL(5,SDAT,6,TIM1,9,NET,14,PROD,51,MAINT,52,SVER)
	CALL DBERR($946,IERT,IERC,0)
	GOTO 948
946     IF (IERT.NE.7) GOTO 4955
	TYPE 1379
	CALL WAIT(5.5)
948     CALL DBOPEN(BASE(6))
	CALL DBUPD(-1)
	CALL DBADD(1,TNUM,2,SDAT,3,TIM1,4,DUP,5,TUP,6,8,8,MAINT,10,
     1  NET,11,SVER,12,PROD)
	CALL DBERR($949,IERT,IERC,0)
	GOTO 950
949     IF (IERT.NE.7) GOTO 4955
	TYPE 1379
	CALL WAIT(5.5)
950     CALL DBOPEN(BASE(16))
	CALL DBFIND(2,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.EQ.0) GOTO 99948
	CALL DBUPD(-1)
	CALL DBCHNG(9,TIM1,10,SDAT,11,ME,8,'CLOSED',12,2)
99948   CALL DBERR($4930,IERT,IERC,0)
	CALL DBCLOS
	GOTO 235
C
C
C       THIS WILL CREATE A TICKET NUMBER TO START THE DATA BASE WITH
C       OR TO RESTORE IT WHEN ONE IS GONE.
C
1360    TYPE 1415,NUMBER
	GOTO 1400
1370    TYPE 1375
1400    CALL DBOPEN(BASE(1),BASE(4))
1405    FORMAT(/3X,'THE DATA BASE SHOWS A GOOD VALUE FOR TICKET NUMBE'
     1  'RS',/6X,'THE VALUE IS ',I5)
1415    FORMAT(/3X,'!! TROUBLE IN RIVER CITY! - THERE ARE ',I2,
     1  ' DIFFERENT TICKET NUMBERS.')
1420    CALL DBSET(2)
	CALL DBSYSV(1,0,SDAT)
	CALL DBFIND('ALL')
	CALL DBNREC(RECORD)
	CALL DBSET(1)
	CALL DBFIND('ALL')
	CALL DBNREC(NUMBER)
	TNUM=NUMBER+RECORD
1421    CALL DBFIND(1,'GT',TNUM)
	CALL DBNREC(RECORD)
	IF (RECORD.EQ.0) GOTO 1422
	CALL DBGREC($1400,RECORD)
	CALL DBVAL(1,TNUM)
	GOTO 1421
1422    TNUM=TNUM+1
	CALL DBERR($1410,IERT,IERC,0)
	GOTO 1412
1410    IF (IERT.NE.7) GOTO 4955
	TYPE 151
	CALL WAIT(5.0)
1412    CALL DBOPEN(BASE(18))
	CALL DBUPD(-1)
	CALL DBFIND('ALL')
	CALL DBNREC(NUMBER)
	IF (NUMBER.EQ.1) GOTO 1426
	CALL DBDEL
	CALL DBADD(1,TNUM,2,9)
	GOTO 1411
1426    TNUM=TNUM+1
	CALL DBCHNG(1,TNUM)
1411    TYPE 1425,TNUM
1425    FORMAT(/3X,'THE NEW TICKET NUMBER WILL BE ',I5)
1427    CALL DBERR($4930,IERT,IERC,0)
	IF (N.EQ.5) GOTO 138
	GOTO 4950
C
C       ROUTINE TO WRITE DATA TO DISK
C
2000    K=14
	I=1
	CALL DBOPEN(BASE(1),BASE(2),BASE(8),BASE(4),BASE(5),BASE(9))
	IF (ANS.EQ.'MOTO') GOTO 2035
	TYPE 2010
2010    FORMAT(1H+,'DO YOU WANT A FILE WRITTEN BY NETWORK(N), ',/,
     1  ' TICKET(T) NUMBER ?, OR SUPPORT GROUP(S)(N,T,S) : ',$)
	CALL DBOPEN(BASE(1),BASE(2),BASE(8),BASE(4),BASE(5),BASE(9))
2015    ACCEPT 65,WELL
	CALL HISET(WELL)
	IF (WELL.EQ.'N') GOTO 2034
	IF (WELL.EQ.'T') GOTO 2050
	IF (WELL.EQ.'S') GOTO 2001
	IF (I.EQ.3) GOTO 4945
	TYPE 2030
2030    FORMAT(/1X,'WHAT ?   ',T20,$)
	GOTO 2015
C
C       CHECK TO SEE WHAT SUPPORT GROUP
C
2001    L=5
	I=1
2002    TYPE 2531
	ACCEPT 120,M
	IF ((M.GE.LOATTN).AND.(M.LE.HIATTN)) GOTO 2005
	IF ((M.EQ.0).OR.(I.EQ.2)) CALL HREFR
	IF (I.EQ.3) GOTO 59
	I=I+1
	GOTO 2002
C
C       NOW OPEN FILE FOR TICKETS
C
2005    ENCODE(9,2003,FILE)ATTN(M)
2003    FORMAT(A5,4H.OUT)
	OPEN(unit=8,device='DSK',access='SEQOUT',file=FILE)
	CALL DBSET(1)
	CALL DBFIND(51,1,ATTN(M),1,15,'NE','CLSD')
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 2082
	TYPE 2036
	CLOSE(unit=8)
	TYPE 3651,FILE
3651    FORMAT(1X,'CLOSING FILE : ',A10)
	GOTO 4950
C
C       CHECK TO SEE IF THEY WANT ONLY OPEN TICKETS
C
2034    TYPE 2031
2031    FORMAT(/1X,'YOU HAVE TWO CHOICES...',/5X,'1. = ONLY OPEN ',
     1  'TICKETS',/5X,'2. = TICKETS OPENED SINCE A GIVEN DATE',/3X,
     2  'ENTER CHOICE : ',T20,$)
2033    ACCEPT 65,WELL
	CALL HISET(WELL)
	IF (WELL.EQ.'1') GOTO 2038
	IF (WELL.EQ.'2') GOTO 2059
	TYPE 2030
	GOTO 2033
2038    IF (FLAG.LE.0) GOTO 2039
	K=FLAG
	GOTO 2035
2039    TYPE 110
	ACCEPT 120,K
	IF ((K.GE.1).AND.(K.LE.NUMNET)) GOTO 2035
	CALL HLPNET
	GOTO 2039
2035    CALL DBSET(1)
	L=0
	IF (ANS.NE.'MOTO') GOTO 8050
	CALL DBFIND(9,1,'TYMNET')
	CALL DBSRCH(31,'CT','MOTOROLA')
	CALL DBSRCH(15,1,'OPEN')
	CALL DBNREC(NUMBER)
	IF (NUMBER.LT.1) GOTO 4950
C	This used to say 'GOTO 2036' if (number.lt.1)


	OPEN(unit=8,device='DSK',access='SEQOUT',file='MOTORN')
	GOTO 82081
8050    CALL DBFIND(9,1,VNET(K),1,'STAT','NE','CLSD')
	CALL DBSRCH('STAT','NE','TRACK')
	IF (ANS.EQ.'WK') CALL DBSRCH(53,1,1)
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 2037
	IF (L.EQ.2) GOTO 2454
	TYPE 2036
2036    FORMAT(/5X,' NO RECORDS FOUND, SO NO FILE WAS CREATED',/)
	GOTO 4950
2037	OPEN(unit=8,device='DSK',access='SEQOUT',file=VNET(K))
	GOTO 2082
2050    TYPE 170,TIC
	ACCEPT 120,TNUM
	L=1
2060    CALL DBSET(1)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 2080
	L=2
	CALL DBSET(4)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 2080
	L=1
	H2=TNUM/10000
	IF (H2.GT.9) GOTO 20300
	ENCODE(10,661,BASE(11))H2
	ENCODE(10,662,BASE(12))H2
	ENCODE(10,663,BASE(13))H2
	GOTO 20305
20300   ENCODE(10,301,BASE(11))H2
	ENCODE(10,302,BASE(12))H2
	ENCODE(10,303,BASE(13))H2
20305   CALL DBERR($20659,IERT,IERC,0)
	CALL DBOPEN(BASE(11),BASE(12),BASE(13))
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 2080
20659   TYPE 660,TNUM
	I=I+1
	IF (I.NE.3)GOTO 2050
	TYPE 665
	GOTO 4950
2080    IF (TNUM.LT.100000) ENCODE(9,2086,FILE)TNUM
2087    FORMAT(I6,'.OUT')
	IF (TNUM.GT.99999) ENCODE(10,2087,FILE)TNUM
2086    FORMAT(I5,'.OUT')
	OPEN(unit=8,device='DSK',access='SEQOUT',file=FILE)
2082    TYPE 2081,NUMBER
2081    FORMAT(/5X,'THERE ARE ',I3,' TICKETS TO WRITE TO DISK',/)
82081	DO 2142 X=1,NUMBER
	CALL DBGREC($4840,X)
2083    FORMAT(1X,'WRITING TICKET # ',I8,' TO DISK',
     1  5X,'REC. # ',I3)
	WRITE(8,2084)FF
2084    FORMAT(/,A5,/)
	CALL WWHD(TNUM)
	TYPE 2083,TNUM,X
	CALL DBSET(2)
	IF (L.EQ.2) CALL DBSET(5)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(RECORD)
	IF (RECORD.EQ.0) GOTO 2141
	CALL DBSORT('ORDER')
	DO 2140 M=1,RECORD
	CALL DBGREC($4830,M)
	CALL DBVAL(2,SDAT,3,TIM1,4,INT,7,INFO,8,PNAM,9,ORDER,5,RS)
	CALL DBNDAT(SDAT,IM,ID,IY)
	IY=IY-1900
	WRITE(8,380)ORDER,PNAM,INT,ID,AM(IM),IY,TIM1,AS(RS)
380     FORMAT(/1X,'--#',I3,' STATUS ENTERED FROM ',3A5,' BY ',A3,' ON ',
     1  I2,1H-,A3,1H-,I2,2H @,A5,' ZULU.',/5X,'REPORT SENT YET ?: ',A3)
	CALL WRTINF(INFO,4)
2140    CONTINUE
2141    CALL DBSET(1)
	IF (L.EQ.2) CALL DBSET(4)
2142    CONTINUE
2150    CLOSE(unit=8)
	TYPE 3651,FILE
	GOTO 4950
C
C       NEW LISTING COMMAND
C
2320    TYPE 2325
2325    FORMAT(/3X,'THIS COMMAND WILL DISPLAY TICKETS EVER CREATED BY',
     1  ' TOPIC.',/5X,'THE TOPICS ARE...',/10X,'1 = CIRCUIT NUMBER',
     2  /10X,'2 = NODE + NETWORK',/10X,'3 = HOST + NETWORK',/2X'ENTER',
     3  ' THE NUMBER: ',$)
	CALL DBOPEN(BASE(1))
	CALL DBSET(1)
	ACCEPT 120,N
	IF ((N.LT.1).AND.(N.GT.3)) GOTO 2320
	IF ((N.EQ.2).OR.(N.EQ.3)) GOTO 2344
	TYPE 203,OCKT
	ACCEPT 100,CKT
2326    CALL DBFIND('CKT',1,CKT)
	GOTO 2360
2335    TYPE 188,NO
	ACCEPT 120,NODE
2327    CALL DBFIND(9,1,VNET(K),1,40,1,NODE)
	GOTO 2360
2340    TYPE 188,HO
	ACCEPT 194,HOST
2328    CALL DBFIND(9,1,VNET(K),1,42,1,HOST)
	GOTO 2360
2344    IF (FLAG.LE.0) GOTO 2345
	K=FLAG
	GOTO 2346
2345    TYPE 110
	ACCEPT 120,K
	IF(K.EQ.0) CALL HLPNET
	IF ((K.LT.1).OR.(K.GT.NUMNET)) GOTO 2345
2346    IF (N.EQ.2) GOTO 2335
	IF (N.EQ.3) GOTO 2340
	GOTO 2360
2360    CALL DBNREC(NUM1)
	IF (NUM1.EQ.0) GOTO 2365
	TYPE 775
2330    DO 2365 I=1,NUM1
	CALL DBGREC($59,I)
	CALL DBVAL(1,TNUM,5,SDAT,6,TIM1,9,NET,14,PROD,15,STAT,40,NODE,
     1  42,HOST,25,COMMNT,52,SVER,51,MAINT)
	CALL DBNDAT(SDAT,IM,ID,IY)
	TYPE 2380,TNUM,IM,ID,PROD,NODE,COMMNT,SVER,HOST,NET,STAT,MAINT,
     1  HH
2380    FORMAT(1X,I6,1X,I2,1H/,I2,1X,A5,1X,I5,1X,4A5,1X,I1,
     1  1X,I6,1X,A10,A5,1X,A5,1X,I1)
2365    CONTINUE
	TYPE 2370
	TYPE 2119
2119    FORMAT(/1X'DO YOU WANT TO OPEN THE OLD DATABASE ? : ',$)
	ACCEPT 65,WELL
	CALL HISET(WELL)
	IF (WELL.EQ.'Y') GOTO 2371
	GOTO 4950
2371    CALL DBOPEN(BASE(4))
	IF (N.EQ.1) GOTO 2326
	IF (N.EQ.2) GOTO 2327
	IF (N.EQ.3) GOTO 2328
2375    TYPE 2370
2370    FORMAT(/3X,'SEARCH FOR DATA COMPLETE')
	GOTO 4950
C
C       THIS WILL ALLOW YOU TO CHANGE ATTRIBUTES...
C
2382    TYPE 801
801     FORMAT(/1X,'YOU DO NOT HAVE ACCESS TO THIS COMMAND')
	GOTO 59
2383    N=1
	M=42
	STAT='MONIT'
	GOTO 2399
2381    TYPE 2385,RW2,RP2
2385    FORMAT(/1X,'THIS COMMAND WILL ALLOW YOU TO CHANGE AN ',
     1  'ITEM IN AN ENTIRE TICKET',/4X,'*1 = SUPPORT AREA',T29,'*2 = ',
     2  'PROD TYPE/IPX NAME',/5X'3 = SEVERITY',T29,'*4 = CIRCUIT ',
     3  'NUMBER',/4X'*5 = TRB #/IP ADDRESS',T29,'*6 = SITE CONTACT',
     4  /4X,'*7 = SITE PHONE #',T29,'*8 = NODE NUMBER',/4X'*9 = HOST #',
     5  '/IPX CARD #',T28,'*10 = SLOT #/IPX PORT #',/3X'*11 = ',3A5,T28,
     6  '*12 = ',3A5,/4X,'13 = CONTROL GROUP',T29,'14 = DATE UP',/4X,
     7  '15 = TIME UP',T29,'16 = DATE DOWN',/4X,'17 = TIME DOWN',
     8  T29,'18 = ELAPSED TIME (AFTER CLOSING TIC.)',
     9  /3X,'*19 = COMMENT',T29,'20 = REFERANCE NUMBER',/3X,'*21 = ',
     A  'CUSTOMER',T28,'*22 = TECH SUPPORT',/4X,'23 = PRODUCTION STATUS',
     B  T29,'24 = TOP 40 STATUS',/4X,'25 = BILLABLE',T29,'26 = PORTS',
     C  /3X,'*27 = LOCATION',T28,'*28 = KERNAL/DLCI',/4X,'29 = CONTRACT',
     D  T29,'30 = START HOUR',/4X,'31 = END HOUR',T28,'*32 = VERSION/',
     E  'ROUTER',/3X,'*33 = LONODE',T28,'*34 = HINODE',/3X,
     F  '*35 = SOFTWARE DISTRICT',T28,'*36 = HARDWARE DISTRICT',
     G  /2X,'* DENOTES FIELD CHANGABLE ITEMS')
	TYPE 2386
2386    FORMAT(1X,'ENTER ITEM NUMBER : ',$)
	ACCEPT 120,N
	IF (N.GT.36) GOTO 2381
	IF (N.LE.0) GOTO 59
	IF ((N.EQ.35.).OR.(N.EQ.36)) GOTO 5000
	IF (N.EQ.1) GOTO 2384
	IF (N.EQ.2) GOTO 2384
	IF (N.EQ.4) GOTO 2414
	IF (N.EQ.5) GOTO 2415
	IF (N.EQ.6) GOTO 2416
	IF (N.EQ.7) GOTO 2417
	IF (N.EQ.12) GOTO 2427
	IF (N.EQ.32) GOTO 2448
	IF (N.EQ.8) GOTO 2418
	IF (N.EQ.9) GOTO 2419
	IF (N.EQ.10) GOTO 2423
	IF (N.EQ.11) GOTO 2424
	IF (N.EQ.21) GOTO 2437
	IF (N.EQ.27) GOTO 2443
	IF (N.EQ.22) GOTO 2438
	IF (N.EQ.33) GOTO 2418
	IF (N.EQ.34) GOTO 2419
	IF (N.EQ.28) GOTO 2444
	IF (N.EQ.19) GOTO 2434
	IF ((FLAG.GE.0).AND.(N.GT.1)) GOTO 2382
	IF (N.EQ.13) GOTO 2428
	IF (N.EQ.14) GOTO 2429
	IF (N.EQ.15) GOTO 2430
	IF (N.EQ.16) GOTO 2431
	IF (N.EQ.17) GOTO 2432
	IF (N.EQ.18) GOTO 2433
	IF (N.EQ.20) GOTO 2436
	IF (N.EQ.23) GOTO 2439
	IF (N.EQ.24) GOTO 2440
	IF (N.EQ.25) GOTO 2441
	IF (N.EQ.26) GOTO 2442
	IF (N.EQ.29) GOTO 2445
	IF (N.EQ.30) GOTO 2446
	IF (N.EQ.31) GOTO 2447
2384    IF(ANS.EQ.'G') TYPE 170,TIC
	CALL DBOPEN(BASE(1))
	IF (ANS.EQ.'G') ACCEPT 120,TNUM
	IF (TNUM.EQ.0) GOTO 4950
2378    CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.EQ.0) GOTO 2375
	CALL DBGREC($4800,NUMBER)
	CALL DBVAL(5,NDAT,6,NTIM,51,MAINT,52,SVER,15,STAT,9,NET,
     1  14,PROD,11,RS,46,ESC,47,F1,17,CCC)
	IF((NET.EQ.'FRAME').AND.(N.EQ.2)) CALL IPXCHG(TNUM,ME)
	IF((NET.EQ.'FRAME').AND.(N.EQ.2)) GOTO 2381
	I=1
	IF (N.EQ.2) GOTO 2406
	IF (N.EQ.3) GOTO 2388
2389    TYPE 2390,MAINT
2390    FORMAT(/1X,'THE VALUE FOR SUPPORT GROUP IS : ',A5,
     1  /,/2X,'ENTER THE NEW VALUE OR A CARRIAGE RETURN IF YOU DO',
     2  ' NOT WISH TO CHANGE IT')
2391    FORMAT(/3X,'ENTER THE NUMBER FOR THE GROUP WITH THE PROBLEM',
     1  /4X,'OR ENTER NEGATIVE ONE FOR HELP : ',$)
82391        TYPE 2391
	ACCEPT 120,M
	IF (M.EQ.0) GOTO 2402
	IF ((M.GE.LOATTN).AND.(M.LE.HIATTN)) GOTO 2399
	IF ((M.EQ.-1).OR.(I.EQ.3)) CALL HREFR
	I=I+1
	GOTO 2389
2399    IF (ATTN(M).NE.'     ') GOTO 92389
	TYPE 92391,M
92391   FORMAT(/1X,'GROUP ',I3,' IS UNUSED AT THIS TIME.  PLEASE ',
     1  'RESELECT.',/1X)
	GOTO 82391
C	^^^^^^^^^^ This used to say 'GOTO 2391' a format statement.
92389   IF (ANS.EQ.'G') CALL GTIM(TIM1,SDAT,LIC)
	IF (N.NE.2) GOTO 23999
	IF (TYPE(P).EQ.'     ') TYPE 92399,P
92399   FORMAT(/1X,'PRODUCT ID #',I3,' IS CURRENTLY UNUSED.  PLEASE ',
     1  'SELECT ANOTHER.',/1X)
	IF (TYPE(P).EQ.'     ') GOTO 2406
23999   IF (N.NE.1) GOTO 92401
	IF (UNAM(1).NE.'TELEC') CALL RESCOD(TNUM,CCC,ANS,L)
	IF ((M.EQ.41).OR.(M.EQ.36).OR.(M.EQ.21).OR.(M.EQ.25)
     1  .OR.(M.EQ.29).OR.(M.EQ.30).OR.(M.EQ.72).OR.(M.EQ.81).OR.
     2  (M.EQ.71)) ESC=2
92401   CALL DBERR($2401,IERT,IERC,0)
	GOTO 2403
2401    IF (IERT.NE.7) GOTO 4955
	TYPE 1379
	CALL WAIT(8.0)
2403    CALL DBOPEN(BASE(1))
	CALL DBUPD(-1)
	CALL DBFIND(1,1,TNUM)
	IF ((M.EQ.41).OR.(M.EQ.36).OR.(M.EQ.21).OR.(M.EQ.25)
     1  .OR.(M.EQ.29).OR.(M.EQ.30).OR.(M.EQ.72).OR.(M.EQ.81).OR.
     2  (M.EQ.71)) ESC=2
	IF (N.EQ.1) CALL DBCHNG(51,ATTN(M),46,ESC)
	IF (N.EQ.2) CALL DBCHNG(14,TYPE(P))
	IF (N.EQ.3) CALL DBCHNG(52,IVER(K))
	CALL DBCLOS
	CALL DBERR($2404,IERT,IERC,0)
	GOTO 2405
2404    IF (IERT.NE.7) GOTO 4955
	TYPE 1379
	CALL WAIT(6.0)
2405    CALL DBOPEN(BASE(6))
	CALL DBUPD(-1)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(RECORD)
	IF (RECORD.GT.0) GOTO 2392
	CALL DBADD(1,TNUM,2,NDAT,3,NTIM,7,STAT,8,MAINT,10,NET,
     1  11,SVER,12,PROD,17,F1,14,ME)
	CALL DBFIND(1,1,TNUM)
	RECORD=1
2392    CALL DBGREC($2381,RECORD)
	CALL DBVAL(2,TDAT,3,TTIM)
	IF ((TDAT.EQ.0).OR.(TTIM.EQ.0)) CALL DBCHNG(2,NDAT,3,NTIM)
	IF (N.EQ.1) CALL DBCHNG(4,SDAT,5,TIM1)
	IF (STAT.EQ.'CLSD') GOTO 2400
	IF (N.EQ.2) CALL DBCHNG(12,TYPE(P))
	IF (N.EQ.3) CALL DBCHNG(11,IVER(K))
	IF (N.EQ.1) CALL DBADD (1,TNUM,2,SDAT,3,TIM1,
     1  7,STAT,8,ATTN(M),10,NET,11,SVER,12,PROD,17,F1,14,ME,13,CCC)
2400    CALL DBCLOS
2402    CALL DBERR($4930,IERT,IERC,0)
	IF ((N.GT.1).OR.(M.EQ.0)) GOTO 59
	GOTO 4350
2406    TYPE 2410,PROD,PT
2410    FORMAT(/1X,'THE CURRENT VALUE FOR PRODUCT TYPE IS : ',A5,
     1  /,1X'ENTER THE NEW PRODUCT CODE OR A (CR.) FOR NO CHANGE'/2X,
     2  'ENTER A NEGATIVE ONE(-1) IF YOU NEED HELP',/1X,3A5,3H : ,$)
	ACCEPT 120,P
	IF ((P.GE.1).AND.(P.LE.NTYPE)) GOTO 2399
	IF (P.EQ.0) GOTO 4950
	IF ((P.EQ.-1).OR.(I.EQ.2)) CALL HPROD
	IF (I.EQ.3) GOTO 59
	I=I+1
	GOTO 2406
2388    TYPE 2387,SVER,OSVR
2387    FORMAT(/1X,'THE CURRENT VALUE FOR SEVERITY IS : ',I1,
     1  /1X,'ENTER THE NEW SEVERITY CODE OR A (CR.) FOR NO CHANGE'/2X,
     2  2A5,3H : ,$)
	ACCEPT 120,K
	IF (K.EQ.0) GOTO 4950
	IF ((K.LT.0).OR.(K.GT.4)) GOTO 2388
	CALL RTIM(TIM1,SDAT)
	CALL DBERR($8100,IERT,IERC,0)
	GOTO 8101
8100    IF (IERT.NE.7) GOTO 4955
	TYPE 1379
	CALL WAIT(5.0)
8101    CALL DBOPEN(BASE(3))
	CALL DBUPD(-1)
	ENCODE(5,8103,OSVER)SVER
8103    FORMAT(2X,I1,2X)
	CALL DBADD(1,TNUM,2,SDAT,3,TIM1,4,ME,5,'SVCHG',6,K,7,OSVER,8,
     1  UNAM)
	CALL DBCLOS
	CALL GETC(6,UNAM,PCE)
	IF(PCE.EQ."040) GOTO 88113
	CALL GETC(11,UNAM,PCE)
	IF(PCE.EQ."040) GOTO 88123
	ENCODE(90,98103,INFO)UNAM,ME,SVER,K
98103   FORMAT(3A5,1H(,A3,1H),' CHANGED SEVERITY FROM ',I1,' TO ',
     1  I1,31X,'.',5X)
	GOTO 98133
88113   ENCODE(90,98113,INFO)UNAM(1),ME,SVER,K
98113   FORMAT(A5,1H(,A3,1H),' CHANGED SEVERITY FROM ',I1,' TO ',
     1  I1,41X,'.',5X)
	GOTO 98133
88123   ENCODE(90,98123,INFO)UNAM(1),UNAM(2),ME,SVER,K
98123   FORMAT(A5,A5,1H(,A3,1H),' CHANGED SEVERITY FROM ',I1,' TO ',
     1  I1,36X,'.',5X)
98133   CALL DBERR($98104,IERT,IERC,0)
	GOTO 98105
98104   IF(IERT.NE.7) GOTO 4931
	TYPE 1379
	CALL WAIT(6.0)
98105   CALL DBOPEN(BASE(2))
	CALL DBUPD(-1)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	ORDER=NUMBER+1
	CALL DBADD(1,TNUM,2,SDAT,3,TIM1,4,ME,5,5,6,STAT,7,INFO,8,UNAM,
     1  9,ORDER,10,0)
	CALL DBCLOS
	ENCODE(95,933,INFO)
	GOTO 2399
2414    CALL CHA4A5(BASE(1),BASE(10),43,7,'CIRCUIT # ')
	GOTO 2381
2415    CALL CHA4A5(BASE(1),BASE(10),44,8,'TELCO TRB#')
	GOTO 2381
2416    CALL CHA4A5(BASE(1),BASE(10),12,1,'SITE CONT.')
	GOTO 2381
2417    CALL CHA4A5(BASE(1),BASE(10),13,2,'SITE PHONE')
	GOTO 2381
2418    CALL CH1I(BASE(1),BASE(10),40,4,'NODE/LOWND')
	GOTO 2381
2419    CALL CH1I(BASE(1),BASE(10),42,6,'HOST/HINOD')
	GOTO 2381
2423    CALL CHA4A5(BASE(1),BASE(10),41,5,'SLOT      ')
	GOTO 2381
2424    CALL CHA4A5(BASE(1),BASE(10),7,0,'REPRT BY  ')
	GOTO 2381
2427    CALL CHA4A5(BASE(1),BASE(10),8,0,'CALL BACK ')
	GOTO 2381
2428    CALL CHHN1(BASE(1),TNUM,ME,STAT,UNAM)
	GOTO 2381
2429    CALL CHDUP1(BASE(1))
	GOTO 2381
2430    CALL CHTUP1
	GOTO 2381
2431    CALL CHSDT1(BASE(1))
	GOTO 2381
2432    CALL CHTDWN
	GOTO 2381
2433    CALL CH1I(BASE(1),BASE(10),54,0,'ELAPSED MN')
	GOTO 2381
2434    CALL CHA4A5(BASE(1),BASE(10),25,0,'COMMENT   ')
	GOTO 2381
2436    CALL CHA4A5(BASE(1),BASE(10),19,0,'REFERENCE#')
	GOTO 2381
2437    CALL CHA4A5(BASE(1),BASE(10),31,10,'CUSTOMER  ')
	GOTO 2381
2438    CALL CHA4A5(BASE(1),BASE(10),32,9,'TECH/ANAL')
	GOTO 2381
2439    CALL CH1I(BASE(1),BASE(10),2,13,'PRODUCTION')
	GOTO 2381
2440    CALL CH1I(BASE(1),BASE(10),3,23,'TOP 40    ')
	GOTO 2381
2441    CALL CH1I(BASE(1),BASE(10),45,0,'BILLABLE  ')
	GOTO 2381
2442    CALL CH1I(BASE(1),BASE(10),30,16,'PORTS     ')
	GOTO 2381
2443    CALL CHA4A5(BASE(1),BASE(10),22,21,'LOCATION  ')
	GOTO 2381
2444    CALL CH1I(BASE(1),BASE(10),23,11,'KERNAL HST')
	GOTO 2381
2445    CALL CHA4A5(BASE(1),BASE(10),24,12,'CONTRACT  ')
	GOTO 2381
2446    CALL CHASTH(BASE(1),BASE(10))
	GOTO 2381
2447    CALL CHAEHR(BASE(1),BASE(10))
	GOTO 2381
2448    CALL CHA4A5(BASE(1),BASE(10),33,22,'CODE VER#.')
	GOTO 2381
C
C       REPORT GENERATOR FOR ALL OPEN TICKETS
C
2059    TYPE 2051
2051    FORMAT(/1X,'THIS WILL CREATE A FILE FROM ALL DATA BASES, WITH',
     1  /1X,'TICKET INFORMATION EVER ENTERED FOR A GIVEN NETWORK.',
     2  /1X,'THIS WILL START FROM THE DATE SPECIFIED. IF YOU WANT',
     3  /1X,'TO GO TO THE BEGINNING OF TIME JUST HIT A CARRIAGE ',
     4  'RETURN.')
	TYPE 1150
1150    FORMAT(/1X,'ENTER START DATE : MM/DD/YYYY ? = ',$)
1160    FORMAT(I2,1X,I2,1X,I4)
	ACCEPT 1160,IM,ID,IY
	CALL DBDATN(NDATE,IM,ID,IY)
	IF (FLAG.LE.0) GOTO 2058
	K=FLAG
	GOTO 2457
2058    TYPE 110
	ACCEPT 120,K
	IF ((K.GE.1).AND.(K.LE.NUMNET)) GOTO 2457
	CALL HLPNET
	IF (I.EQ.3) GOTO 4950
	I=I+1
	GOTO 2058
2457    CALL DBSET(4)
	L=2
2452    CALL DBFIND(9,1,VNET(K),1,49,'GE',NDATE)
2455    CALL DBNREC(NUMBER)
	IF ((NUMBER.GT.0).AND.(L.EQ.3)) GOTO 2082
	IF (NUMBER.GT.0) GOTO 2037
	IF (L.EQ.3) GOTO 2150
2453    CALL DBSET(1)
	L=L+1
	CALL DBFIND(9,1,VNET(K),1,5,'GE',NDATE)
	GOTO 2455
2454    CALL DBSET(3)
2456    CALL DBFIND(9,1,VNET(K),1,49,'GE',NDATE)
	GOTO 2142
C
C       ROUTINE TO GET A TICKET OUT OF THE ARCHIVE DATA BASE AND
C       PUT IT IN THE CURRENT DATA BASE.
C
2459    TYPE 2460,TIC
2460    FORMAT(/1X,'THIS WILL TAKE A TICKET NUMBER FROM THE OLD DATA',
     1  ' BASE',/4X,'AND PUT IT IN THE CURRENT DATA BASE',/,/1X,3A5,$)
	ACCEPT 120,TNUM
2461    TYPE 2464,BASE(4),BASE(1)
2464    FORMAT(1X,'SEARCHING ',A10,'FOR RECORDS TO MOVE TO ',A10,1H.)
	CALL DBERR($2462,IERT,IERC,0)
	GOTO 2463
2462    IF (IERT.NE.7) GOTO 4955
	TYPE 1379
	CALL WAIT (5.5)
2463    CALL DBOPEN(BASE(4),BASE(1))
	CALL DBSET(2)
	CALL DBUPD(-1)
	CALL DBSET(1)
	CALL DBUPD(-1)
	CALL DBSET(1)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.EQ.0) GOTO 2468
	TYPE 2466,NUMBER
2466    FORMAT(3X,'FOUND ',I3,' RECORD(S) TO MOVE.')
2465    DO 2490 J=1,NUMBER
	CALL DBGREC($4945,J)
	CALL DBVAL(1,TNUM,2,PRO,3,T40,4,F2,5,SDAT,6,TIM1,7,RNAM,8,RFON,
     1  9,NET,10,INT,11,RS,12,SITC,13,SITP,14,PROD,15,STAT,16,DISC,17,
     2  CCC,18,HQCC,19,ONUM,20,SRGN,21,HRGN,22,
     3  LOC,23,KHST,24,COV,25,COMMNT,26,CDAT,27,TCLSD,28,STH,29,EHR,
     4  30,PORT,31,CNAM,32,TECH,33,VER,34,V5,35,V6,36,V1,37,V2,38,V3,
     5  39,V4,40,NODE,41,SLOT,42,HOST,43,CKT,44,TRB,45,BILL,46,ESC,47,
     6  F1,48,NT,49,DUP,50,TUP,51,MAINT,52,SVER,53,HH,54,ELM,55,COC,
     7  56,CBY,57,PROBL)
	CALL DBSET(2)
	CALL DBADD(1,TNUM,2,PRO,3,T40,4,F2,5,SDAT,6,TIM1,7,RNAM,8,RFON,
     1  9,NET,10,INT,11,RS,12,SITC,13,SITP,14,PROD,15,STAT,16,DISC,17,
     2  CCC,18,HQCC,19,ONUM,20,SRGN,21,HRGN,22,
     3  LOC,23,KHST,24,COV,25,COMMNT,26,CDAT,27,TCLSD,28,STH,29,EHR,
     4  30,PORT,31,CNAM,32,TECH,33,VER,34,V5,35,V6,36,V1,37,V2,38,V3,
     5  39,V4,40,NODE,41,SLOT,42,HOST,43,CKT,44,TRB,45,BILL,46,ESC,47,
     6  F1,48,NT,49,DUP,50,TUP,51,MAINT,52,SVER,53,HH,54,ELM,55,COC,
     7  56,CBY,57,PROBL)
	CALL DBSET(1)
2490    CONTINUE
	CALL DBSET(1)
	CALL DBFIND(1,1,TNUM)
	CALL DBDEL
2468    CALL DBCLOS
	CALL DBCLOS
	TYPE 2464,BASE(5),BASE(2)
	CALL DBERR($2469,IERT,IERC,0)
	GOTO 2470
2469    IF (IERT.NE.7) GOTO 4955
	TYPE 1379
	CALL WAIT(5.5)
2470    CALL DBOPEN(BASE(5),BASE(2))
	CALL DBSET(2)
	CALL DBUPD(-1)
	CALL DBSET(1)
	CALL DBUPD(-1)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.EQ.0) GOTO 2475
	TYPE 2466,NUMBER
	DO 2480 J=1,NUMBER
	CALL DBGREC($4930,J)
	CALL DBVAL(2,SDAT,3,TIM1,4,INT,5,RS,6,STAT,7,INFO,8,PNAM,
     1  9,ORDER)
	CALL DBSET(2)
	CALL DBADD(1,TNUM,2,SDAT,3,TIM1,4,INT,5,RS,6,STAT,7,INFO,
     1  8,PNAM,9,ORDER)
	CALL DBSET(1)
2480    CONTINUE
	CALL DBSET(1)
	CALL DBFIND(1,1,TNUM)
	CALL DBDEL
2475    CALL DBCLOS
	CALL DBCLOS
	TYPE 2464,BASE(7),BASE(6)
	CALL DBERR($2476,IERT,IERC,0)
	GOTO 2478
2476    IF (IERT.NE.7) GOTO 4955
	TYPE 1379
	CALL WAIT(5.5)
2478    CALL DBOPEN(BASE(7),BASE(6))
	CALL DBSET(2)
	CALL DBUPD(-1)
	CALL DBSET(1)
	CALL DBUPD(-1)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.EQ.0) GOTO 2496
	TYPE 2466,NUMBER
	DO 2495 I=1,NUMBER
	CALL DBGREC($2496,I)
	CALL DBVAL(1,TNUM,2,SDAT,3,TIM1,4,NDAT,5,NTIM,6,RS,7,STAT,
     1  8,MAINT,9,ELM,10,NET,11,SVER,12,PROD,13,COC,14,INT,15,drp,
     2  16,tt,17,zone,18,tet)
	CALL DBSET(2)
	CALL DBADD(1,TNUM,2,SDAT,3,TIM1,4,NDAT,5,NTIM,6,RS,7,STAT,
     1  8,MAINT,9,ELM,10,NET,11,SVER,12,PROD,13,COC,14,INT,15,drp,
     2  16,tt,17,zone,18,tet)
	CALL DBSET(1)
2495    CONTINUE
	CALL DBSET(1)
	CALL DBFIND(1,1,TNUM)
	CALL DBDEL
2496    CALL DBCLOS
	CALL DBCLOS
	CALL DBERR($4930,IERT,IERC,0)
	CALL DBOPEN(BASE(1))
	ANS='S'
	GOTO 218
C
C       ROUTINE TO MAKE A CHART OF ALL THE OPEN TICKETS FOR EACH NETWORK.
C
2500    TYPE 2492
2492    FORMAT(/,/3X,'THIS OPTION WILL PRINT A CHART BY NETWORK WITH ',
     1  'A COLUMN',/3X,'FOR OPEN TICKETS, AND A COLUMN FOR MONIT TICK',
     2  'ETS',/3X,'EACH MATRIX IS SUBTOTALED',/,/1X,'NETWORK'3X,'OPEN',
     3  3X,'MONIT',2X,'TOTALS',/)
	SOPEN=0
	SMONIT=0
	STOTAL=0
	CALL DBOPEN(BASE(1))
	DO 2530 I=1,NUMNET
	IF (I.EQ.23) GOTO 2530
	CALL DBFIND(9,1,VNET(I),1,'STAT','NE','CLSD')
	CALL DBNREC(TOTAL(I))
	CALL DBFIND(9,1,VNET(I),1,'STAT',1,'OPEN')
	CALL DBNREC(SPEN(I))
	MONIT(I)=TOTAL(I)-SPEN(I)
	TYPE 2524,TVNET(I),SPEN(I),MONIT(I),TOTAL(I)
2524    FORMAT(2X,A5,5X,I3,5X,I3,5X,I3)
	STOTAL=STOTAL+TOTAL(I)
	SOPEN=SOPEN+SPEN(I)
	SMONIT=SMONIT+MONIT(I)
2530    CONTINUE
	TYPE 2534,SOPEN,SMONIT,STOTAL
2534    FORMAT(/2X,'TOTALS',4X,I3,5X,I3,5X,I3)
	GOTO 4950
C
C       WILL LIST TICKETS BY PRODUCT TYPES
C
2540    I=1
2541    TYPE 2542
2542    FORMAT(/1X'THIS OPTION WILL LIST THE OPEN TICKET BY PRODUCT',
     1  ' TYPE',/2X'ENTER THE PRODUCT CODE NUMBER OR A ZERO FOR HELP: '
     2  $)
	CALL DBOPEN(BASE(1))
	ACCEPT 120,P
	IF ((P.GE.1).AND.(P.LE.NTYPE)) GOTO 2544
	IF ((P.EQ.0).OR.(I.EQ.2)) CALL HPROD
	IF (I.EQ.3) GOTO 59
	I=I+1
	GOTO 2541
2544    CALL DBFIND(14,1,TYPE(P),1,15,'NE','CLSD')
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 2546
	TYPE 2545,TYPE(P)
2545    FORMAT(/1X' THERE ARE NO TICKETS OPEN WITH A PRODUCT TYPE OF ',
     1  A5,' !')
	GOTO 4950
2546    TYPE 772,NUMBER
	TYPE 777
	DO 2547 I=1,NUMBER
	CALL DBGREC($59,I)
	CALL DBVAL(1,TNUM,5,SDAT,6,TIM1,9,NET,15,STAT,40,NODE,
     1  42,HOST,43,CKT,52,SVER,51,MAINT,53,HH)
	CALL DBNDAT(SDAT,IM,ID,IY)
	TYPE 2193,TNUM,IM,ID,MAINT,NODE,CKT(1),CKT(2),CKT(3),SVER,
     1  HOST,NET,STAT,NETOP(HH)
2547    CONTINUE
	GOTO 4950
	GOTO 4950
C
C       THIS OPTION LIST TICKETS BY SUPPORT GROUP
C
C
C       IF CUSTOMERS ARE USING OTION THEN GO TO 4200 TO MAKE SURE
C       THEY ARE ONLY SEEING THERE TICKETS
C
2590    IF (FLAG.GT.1) GOTO 4200
	I=1
2591    TYPE 2592
2592    FORMAT(/1X'THIS OPTION LIST TICKETS THAT ARE OVER TO A ',
     1  'SUPPORT GROUP'/2X'ENTER THE NUMBER OR A C.R. FOR HELP : ',$)
	CALL DBOPEN(BASE(1))
2593     ACCEPT 120,P
	IF ((P.GE.1).AND.(P.LE.NATTN)) GOTO 2594
	IF ((P.EQ.O).OR.(I.EQ.2)) CALL HREFR
	IF (I.EQ.3) GOTO 59
	I=I+1
	TYPE 2592
	GOTO 2593
2594    CALL DBFIND(51,1,ATTN(P),1,15,'NE','CLSD')
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 2597
	TYPE 2596,ATTN(P)
	GOTO 4950
2596    FORMAT(/3X'THERE ARE NO TICKET TURNED OVER TO ',A5,/)
2597    TYPE 774,NUMBER,ATTN(P)
	TYPE 769
	DO 2598 I=1,NUMBER
	CALL DBGREC($4930,I)
	CALL DBVAL(1,TNUM,5,SDAT,6,TIM1,9,NET,14,PROD,15,STAT,40,NODE,
     1  42,HOST,25,COMMNT,52,SVER,51,MAINT,53,HH)
	CALL DBNDAT(SDAT,IM,ID,IY)
	TYPE 2193,TNUM,IM,ID,PROD,NODE,
     1  COMMNT(1),COMMNT(2),COMMNT(3),SVER,HOST,NET,STAT,NETOP(HH)
2598    CONTINUE
2193    FORMAT(1X,I6,1X,I2,1H/,I2,1X,A5,1X,I5,1X,3A5,1X,I1,1X,
     1  I6,1X,A10,1X,A5,1X,A5)
	GOTO 4950
C
C       ROUTINE TO DISPLAY THE PATH OF A PROBLEM
C
3090    TYPE 3095
3095    FORMAT(/1X,'THIS COMMAND TAKES A TICKET NUMBER AND DISPLAYS',
     1  /2X,'THE TRACKING OF THAT TICKET.',/2X,'A C.R. TAKES YOU ',
     2  'BACK TO THE MENU.'/)
3100    TYPE 3101,TIC
3101    FORMAT(1X,3A5,2H :,T20,$)
	CALL DBOPEN(BASE(1),BASE(6))
3102    ACCEPT 120,TNUM
	IF (TNUM.EQ.0) GOTO 4950
	P=1
3105    CALL DBSET(1)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 3110
	IF (P.EQ.2) GOTO 3108
	TYPE 652
	CALL DBOPEN(BASE(4),BASE(7))
	P=2
	GOTO 3105
3108    TYPE 660,TNUM
	GOTO 3100
3110    CALL DBGREC($3090,1)
	CALL DBVAL(5,SDAT,6,TIM1,9,NET,14,PROD,40,NODE,42,HOST,53,HN)
	CALL DBNDAT(SDAT,IM,ID,IY)
	IY=IY-1900
	TYPE 3115,TNUM,AM(IM),ID,IY,TIM1,NET,PROD,NODE,HOST,NETOP(HN)
	TYPE 93115
3115    FORMAT(/1X,'TICKET # ',I8,' WAS OPENED ON ',A3,1H ,I2,
     1  2H, ,I2,' @',A5,' FOR ',A10,/' FOR A REPORTED ',A5,' ON NODE',
     2  ' # ',I5,' HOST # ',I6,1H.,/1X,'THE GROUP IN CONTROL OF THIS ',
     3  'TICKET IS ',2A5)
93115   FORMAT(/1X,/1X,'START DATE/TIME',4X,
     1  'END DATE/TIME',2X,'SEV.',1X,'GRP',2X,'PROD',2X,
     2  'STAT',5X,'ELAPSED TIME',/1X)
	CALL DBSET(2)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 3120
	TYPE 3118
3118    FORMAT(2X,'NO TRACKING EXISTS YET FOR THIS TICKET'/)
	GOTO 3100
3120    DO 3130 I=1,NUMBER
	CALL DBGREC($3090,I)
	CALL DBVAL(2,SDAT,3,TIM1,4,DUP,5,TUP,'STAT',TUS,8,MAINT,
     1  11,SVER,12,PROD,15,ADAT,16,ATIM)
	ELM=0
	CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
	CALL DBNDAT(SDAT,IM,ID,IY)
	CALL DBNDAT(ADAT,EM,ED,EY)
	IF (DUP.EQ.0) CALL RTIM(TUP,DUP)
	CALL DBNDAT(DUP,JM,JD,JY)
	JY=JY-1900
	IY=IY-1900
	EY=EY-1900
	IF(TIM1.EQ.TIM2) GOTO 8021
	TYPE 3125,I,IM,ID,IY,TIM1,JM,JD,JY,TUP,SVER,MAINT,PROD,
     1  TUS,HOUR
3125    FORMAT(1X,I2,1X,I2,1H/,I2,1H/,I2,1X,A5,1X,I2,1H/,I2,1H/,I2,1X,
     1  A5,1X,I3,2X,A5,1X,A5,1X,A5,2X,F7.1,1X,'HOURS.')
8021    IF(ADAT.GT.0) TYPE 8020,ATIM,EM,ED,EY
8020    FORMAT(5X,'F.E. ARRIVED ON SITE AT ',A5,' GMT ON ',I2,'/',I2,
     1  '/',I2)
	TIM2=TIM1
3130    CONTINUE
	TYPE 3101,TIC
	GOTO 3102
C
C       ROUTINE TO PRINT LIST OF FRAME RELAY TICKETS
C       CURRENTLY OPEN FOR NORTH AMERICA
C
93249   TYPE 93248
93248   FORMAT(/1X,'THE FOLLOWING IS A LIST OF FRAME RELAY TICKETS',
     1  ' THAT',/1X,'ARE CURRENTLY OPEN AND UNDER THE CONTROL OF',
     2  ' NORTH AMERICAN',/1X,'CONTROL GROUPS.',/1X)
	CALL DBOPEN(BASE(1))
	CALL DBFIND(53,3,3,2,53,1,4)
	CALL DBFIND('LAST',1,15,2,'CLSD ')
	CALL DBSRCH(14,1,'FRE  ',2,9,1,'FRAMERELAY')
	CALL DBNREC(NUMBER)
	IF(NUMBER.EQ.0) GOTO 93244
	CALL DBSORT('SVER','TNUM','ASCEN')
	TYPE 93247
93247   FORMAT(/1X,'TNUM',6X,'SEV',2X,'STATUS',2X,'CTL GRP',5X,
     1  'CUSTOMER',6X,'REF GRP',3X,'ELM',/1X)
	DO 93245 I=1,NUMBER
	DUP=0
	TUP='     '
	CALL DBGREC($4930,I)
	CALL DBVAL(1,TNUM,15,STAT,31,CNAM,51,MAINT,52,SVER,53,HH,
     1  54,ELM,5,SDAT,6,TIM1,49,J)
	CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
	IF(J.GT.0) GOTO 93250
	TYPE 93251,TNUM,SVER,STAT,NETOP(HH),CNAM,MAINT,HOUR
93251   FORMAT(1X,I8,3X,I1,3X,A5,3X,A5,3X,3A5,3X,A5,5X,F7.1)
	GOTO 93245
93250   TYPE 93246,TNUM,SVER,STAT,NETOP(HH),CNAM,MAINT,HOUR
93246   FORMAT(1X,I8,3X,I1,3X,A5,3X,A5,3X,3A5,3X,A5,5X,F7.1,3X,'*')
93245   CONTINUE
	TYPE 93252
93252   FORMAT(/1X,'THE "*" BY THE ELM FIELD INDICATES THAT TIME',
     1  ' UP HAS BEEN',/1X,'SET IN THE TICKET.')
93244   CALL DBCLOS
	GOTO 59
C
C
C       ROUTINE TO LIST TICKETS THAT HAVE NOT BEEN UPDATED IN TWO
C       HOURS.
C
3175    DVER(1)=120
	DVER(2)=240
	DVER(3)=720
	DVER(4)=1440
	EVER(1)=240
	EVER(2)=720
	EVER(3)=1440
	EVER(4)=2880
	F3(1)=5
	F3(2)=6
	F3(3)=5
	BB=0
	DF=1
	DECODE(5,3244,ANS)M1,M2,M3
3244    FORMAT(A1,A1,A3)
	IF (M3.EQ.'   ') DECODE(5,3245,ANS)H1,H2,H3,H4,H5
	IF (M3.NE.' ') DECODE(5,3241,ANS)H1,H2,H3,H4
3241    FORMAT(I1,I2,I1,I1)
3245    FORMAT(I1,I1,I1,I1,I1)
	TYPE 3180
3180    FORMAT(12X,'THIS REPORT WILL LIST THE TICKETS THAT HAVE ',
     1  'NOT BEEN',/11X,'UPDATED ACCORDING TO THE FOLLOWING...',
     2  /15X,'STATUS',T46,'ESCALATION',/6X,'SEVERITY 1 =  2 HOURS',T39,
     3  'SEVERITY 1 =  4 HOURS',/15X,'2 =  4',T48,'2 = 12',/15X,
     4  '3 = 12',T48,'3 = 24',/15X,'4 = 24',T48,'4 = 48',/,/)
	CALL DBOPEN(BASE(1),BASE(2))
	CALL FGMT(IA1,IA2,IA3,IA4,IA5,IA6)
	DUP=0
	TUP='     '
	IF (H2.EQ.0) TYPE 3242
	IF (H2.GT.0) TYPE 3243,NETOP(H2)
3242    FORMAT(/5X,'REPORT GENERATED FOR ALL CONTROL GROUPS.',/)
3243    FORMAT(/5X,'REPORT GENERATED FOR ',A5,' ONLY.',/)
	IA3=IA3+1900
	TYPE 3177,IA4,IA5,AM(IA1),IA2,IA3
3177    FORMAT(/2X,'THIS REPORT WAS GENERATED AT ',I2,1H:,I2,' ZULU',
     1  ' ON ',A3,2H. ,I2,1H,,I4,1H.,/)
	DO 3178 I=1,4
	TTL(I)=0
	ITEM(I)=0
	LIST(I)=0
	TELH(I)=0
	TELM(I)=0
3178    CONTINUE
	DO 3190 I=1,4
	TYPE 3182,I
3182    FORMAT(/2X,'*** THE FOLLOWING SEVERITY ',I1,' PROBLEMS',/)
	IF (H2.EQ.0) CALL DBFIND(15,1,'OPEN',1,52,1,I)
	IF (H2.GT.0) CALL DBFIND(53,1,H2,1,15,1,'OPEN',1,52,1,I)
	IF(H2.EQ.1) CALL DBSRCH(14,2,'PROJ ')
	TYPE 3192
3192    FORMAT(2X,'SEARCHING FOR TICKET THAT HAVE NO TIME UP SET')
	CALL DBSRCH('DUP',1,0)
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 3184
	TYPE 3189,I
3189    FORMAT(' NO TICKETS OPEN FOR SEVERITY LEVEL ',I1,1H.)
3183    FORMAT(4X'UPDATES ARE CURRENT FOR SEVERITY ',I1,' PROBLEMS',
     1  /1X,'************************************************',/,/)
	GOTO 3190
3184    P=0
	TYPE 3176,NUMBER,I
	SUB(I)=0
3176    FORMAT(/5X,'WE WILL CHECK ',I3,' SEVERITY LEVEL ',I1,
     1  ' TICKETS.')
	DO 3188 J=1,NUMBER
	CALL DBGREC($4930,J)
	CALL DBVAL(1,TNUM,5,SDAT,6,TIM1,14,PROD,40,NODE,35,V6,36,V1,
     1  42,HOST,43,CKT,51,MAINT,53,HH,54,ELM,37,V2,38,V3,39,V4)
	IF (V1-V2.LT.0) GOTO 3228
	IF (V1-V3.LT.0) GOTO 3230
	GOTO 3232
3228    IF(V2-V3.LT.0) GOTO 3230
	OFF=(V2*EVER(I))+V6*60
	Z=V2
	L=2
	GOTO 3234
3230    OFF=(V3*EVER(I))+V6*60
	Z=V3
	L=3
	GOTO 3234
3232    OFF=(V1*EVER(I))+V6*60
	Z=V1
	L=1
3234    CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
	IF (H2.EQ.0) OFF=OFF+60
	IF (ELM.LT.OFF) GOTO 3237
	IF ((L.EQ.1).AND.(V1.EQ.5)) GOTO 3237
	IF ((L.EQ.2).AND.(V2.EQ.6)) GOTO 3237
	IF ((L.EQ.3).AND.(V3.EQ.5)) GOTO 3237
	LEV=ELM-OFF
	IF (LEV.LT.EVER(I)) X=1
	IF ((LEV.LT.2*EVER(I)).AND.(LEV.GT.EVER(I))) X=2
	IF ((LEV.LT.3*EVER(I)).AND.(LEV.GE.2*EVER(I))) X=3
	IF ((LEV.LT.4*EVER(I)).AND.(LEV.GE.3*EVER(I))) X=4
	IF ((LEV.LT.5*EVER(I)).AND.(LEV.GE.4*EVER(I))) X=5
	IF (LEV.GE.5*EVER(I)) X=5
	IF (X+Z.GT.F3(L)) X=F3(L)-Z
	TELH(HH)=TELH(HH)+1
	TELM(I)=TELM(I)+1
	P=1
	CALL DBNDAT(SDAT,IM,ID,IY)
	TET=ELM-OFF
	PERCEN=TET/60
	TYPE 3212,TNUM,IM,ID,NODE,HOST,MAINT,HOUR,NETOP(HH),
     1  PROD,PERCEN
3212    FORMAT(/1X,I7,1X,I2,1H/,I2,1X,I5,1X,I6,1X,A5,2X,F7.1,
     1  2X,A5,2X,A5,2X,F7.1,' ESCALATE.')
	IF (L.EQ.1) TYPE 3240,HWARE(V1),SWARE(V2),ITELC(V3),HWARE(V1+X),
     1  SWARE(V2),ITELC(V3)
	IF (L.EQ.2) TYPE 3240,HWARE(V1),SWARE(V2),ITELC(V3),
     1  HWARE(V1),SWARE(V2+X),ITELC(V3)
	IF (L.EQ.3) TYPE 3240,HWARE(V1),SWARE(V2),ITELC(V3),
     1  HWARE(V1),SWARE(V2),ITELC(V3+X)
3240    FORMAT(2X,'CURRENTLY AT - HARDWARE = ',A10,1X,'SOFTWARE = ',
     1  A10,2X,'TELCO = ',A10,/3X,'SHOULD BE   - HARDWARE = 'A10,
     2  1X,'SOFTWARE = ',A10,2X,'TELCO = ',A10)
	GOTO 3238
3237    Q=1
3239    FORMAT(/)
3238    NDAT=SDAT
	ELM=0
	TTL(HH)=TTL(HH)+1
	CALL DBSET(2)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(RECORD)
	IF (RECORD.EQ.0) GOTO 3186
3185    CALL DBGREC($4930,RECORD)
	CALL DBVAL(2,SDAT,3,TIM1)
3186    CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
	ELM=ELM-V4*60
	IF (H2.EQ.0) ELM=ELM-60
	IF (ELM.LT.DVER(I)) GOTO 3187
	CALL DBNDAT(NDAT,IM,ID,IY)
	PERCEN=(ELM-DVER(I))/60
	IF (Q.EQ.1) TYPE 3239
	TYPE 3195,TNUM,IM,ID,NODE,HOST,MAINT,HOUR,NETOP(HH),
     1  PROD,PERCEN
3195    FORMAT(/1X,I7,1X,I2,1H/,I2,1X,I5,1X,I6,1X,A5,2X,F7.1,
     1  2X,A5,2X,A5,2X,F7.1,' ADD STATUS.')
	IF (V4.EQ.0) GOTO 3197
	TYPE 3196,TNUM,V4
3196    FORMAT(T10,'TICKET # ',I8,' HAD BEEN DEFERED FOR ',I2,
     1  ' HOURS.')
	LIST(DF)=TNUM
	DF=DF+1
3197    ITEM(HH)=ITEM(HH)+1
	SUB(I)=SUB(I)+1
	P=1
3187    CALL DBSET(1)
	Q=0
3188    CONTINUE
	IF (SUB(I).GT.0) TYPE 3181,NUMBER,SUB(I)
3181    FORMAT(/2X,'OUT OF ',I3,' TICKETS, ',I3,' NEED UPDATING.',/)
	IF (TELM(I).GT.0) TYPE 3236,NUMBER,TELM(I)
3236    FORMAT(2X,'ADDITIONALLY, OUT OF ',I3,' TICKETS, ',I3,
     1  ' NEED ESCALATING.',/)
	IF (P.EQ.0) TYPE 3183,I
	TDAT=TDAT+SUB(I)
	TOT1=TOT1+NUMBER
	YMTOT=YMTOT+TELM(I)
3190    CONTINUE
	TYPE 3191,TOT1,TDAT,YMTOT,NETOP(1),ITEM(1),TTL(1),TELH(1),
     1  NETOP(2),ITEM(2),TTL(2),TELH(2),NETOP(3),ITEM(3),TTL(3),
     2  TELH(3),NETOP(4),ITEM(4),TTL(4),TELH(4)
3191    FORMAT(/,/2X,'THERE ARE ',I3,' TICKETS OPEN, OF WHICH ',
     1  I3,' HAVE TO BE UPDATED AND',/2X,I3,' TICKETS NEED TO BE ',
     2  'ESCALATED.',/,/4X,'THE BREAK DOWN BY ',
     3  'CONTROL GROUP IS AS FOLLOWS...',/,/10X,A5,2H..,I3,
     4  ' OUT OF ',I3,3X,'AND ',I3,' TO ESC.',/10X,A5,2H..,I3,
     5  ' OUT OF ',I3,3X,'AND ',I3,' TO ESC.',/10X,A5,2H..,I3,
     6  ' OUT OF ',I3,3X,'AND ',I3,' TO ESC.',/10X,A5,2H..,I3,
     7  ' OUT OF ',I3,3X,'AND ',I3,' TO BE ESC.',/,/5X,'END OF REPORT',
     8  /,/)
	TOT1=0
	TDAT=0
	YMTOT=0
	IF ((DF.EQ.1).OR.(H2.EQ.0)) GOTO 3930
	P=DF-1
	TYPE 3248,FF,P
3248    FORMAT(/,A5,/3X,'THERE ARE ',I3,' TICKET(S) WHICH NEED',
     1  ' THE DEFER TIMES CLEARED OUT.')
	CALL DBERR($3249,IERT,IERC,0)
	GOTO 3250
3249    IF (IERT.NE.7) GOTO 4955
	TYPE 1379
	CALL WAIT(7.0)
3250    CALL DBOPEN(BASE(1))
	CALL DBUPD(-1)
	DO 3252 I=1,DF-1
	CALL DBFIND(1,1,LIST(I))
	CALL DBGREC($4930,I)
	CALL DBCHNG(39,0)
	TYPE 3251,LIST(I)
3251    FORMAT(1X,'TICKET NUMBER ',I8,' IS CLEARED OUT')
3252    CONTINUE
	CALL DBCLOS
	TYPE 3253
3253    FORMAT(4X,'JOB COMPLETE')
	GOTO 3930
C*************************************************************
C
C       THIS ROUTINE WILL PLACE A PERSON IN THE CALL BACK LOG
C
C*************************************************************
C
3280    TYPE 170,TIC
	CALL RTIM(TIM1,SDAT)
	CALL DBERR($3284,IERT,IERC,0)
	ACCEPT 120,TNUM
	GOTO 3286
3284    IF (IERT.NE.7) GOTO 4955
	TYPE 3285
3285    FORMAT(1X,'CALL BACK LOG IS BUSY... WILL RETRY IN 10 SECS.')
	CALL WAIT(5.0)
3286    CALL DBOPEN(BASE(8))
	CALL DBUPD(-1)
	IF (ANS.NE.'A') GOTO 3287
	ENCODE(20,3289,NCNAM)CNAM
3289    FORMAT(3A5,'     ')
	CALL DBADD(1,TOT,2,SDAT,3,TIM1,4,NCNAM,5,ME,6,0,7,REPN,
     1  8,REPF,13,' ')
	GOTO 3288
3287    CALL DBADD(1,TNUM,2,SDAT,3,TIM1,4,REPN,5,ME,6,0,7,SITC,
     1  8,SITP,13,' ')
3288    CALL DBUPD(0)
	CALL DBCLOS
	CALL DBOPEN(BASE(1))
	CALL DBFIND(1,1,TNUM)
	CALL DBGREC($93288,1)
	CALL DBVAL(52,SVER)
	CALL DBCLOS
	IF((SVER.EQ.1.).AND.(CG.LT.5).AND.(JJ1.EQ.0))GOTO 4710
	HDRCHK=1
93288   IF(ANS.EQ.'A') GOTO 650
	GOTO 59
C********************************************************************
C
C       LETS CHECK ON THE SEMANTICS OF CHECKING WHICH TNUM TO LOOK AT
C
C********************************************************************
C
3292    IF (DECIS.GT.1) GOTO 3296
3294    CALL DBOPEN(BASE(1),BASE(2),BASE(8))
	GOTO 653
3296    TYPE 170,TIC
	CALL DBOPEN(BASE(1),BASE(2),BASE(8))
	ACCEPT 120,TNUM
	IF (TNUM.EQ.0) GOTO 4062
	GOTO 653
3298    IF (DECIS.EQ.1) GOTO 4062
	TYPE 3300
3300    FORMAT(1X,'DO YOU NEED TO SEE ANOTHER TICKET IN DETAIL ? ',$)
	ACCEPT 65,SEE
	CALL HISET(SEE)
	IF ((SEE.EQ.'N').OR.(SEE.EQ.' ')) GOTO 4062
	TYPE 170,TIC
	ACCEPT 120,TNUM
	GOTO 653
C
C       ROUTINE TO FIND OUT WHAT HAS HAPPENED IN THE LAST 30
C       DAYS. IF THERE HAS BEEN ANY TICKETS OPENED - THEN A STATUS
C       WILL BE ADDED THAT THIS NODE HAS BEEN INVOLVED WITH OTHER
C       PROBLEMS.
C
3360    TYPE 3365,NOD1,CIRCKT
	LEV=SVER
	TOT=TNUM
	L=1
	Z=1
	M=1
3365    FORMAT(/1X,'NOW LET THE PROGRAM CHECK THE DATA BASE TO SEE IF',
     1  /1X'ANY OTHER PROBLEMS HAVE BEEN REPORTED ABOUT NODE # ',I5,
     2  /1X'OR CIRCUIT # ',4A5,'  IN THE LAST 30 DAYS.')
	CALL DBOPEN(BASE(1),BASE(4))
	CALL DBSET(1)
	NDAT=SDAT-30
3368    IF ((CIRCKT(1).EQ.'     ').OR.(CIRCKT(1).EQ.'.    ')) GOTO 3370
	IF (Z.EQ.2) GOTO 3369
	CALL DBFIND(40,1,NOD1,1,9,1,VNET(K),
     1  'OR',9,1,VNET(K),1,43,1,CIRCKT)
	GOTO 3375
3369    CALL DBFIND(40,1,NOD1,1,9,1,VNET(K),1,49,'GE',
     1  NDAT,'OR',9,1,VNET(K),1,49,'GE',NDAT,1,43,1,CIRCKT)
	GOTO 3375
3370    IF (Z.EQ.2) GOTO 3371
	CALL DBFIND(40,1,NOD1,1,9,1,VNET(K))
	GOTO 3375
3371    CALL DBFIND(40,1,NOD1,1,9,1,VNET(K),1,49,'GE',NDAT)
3375    CALL DBNREC(NUMBER)
	IF ((NUMBER.GT.1).AND.(Z.EQ.1)) GOTO 3380
	IF ((NUMBER.GT.0).AND.(Z.EQ.2)) GOTO 3380
	IF (Z.EQ.2) GOTO 3390
	Z=2
	CALL DBSET(2)
	GOTO 3368
3380    IF (L.EQ.2) GOTO 3381
	L=2
	TYPE 776
3381    DO 3389 J=1,NUMBER
3385    CALL DBGREC($3389,J)
	CALL DBVAL(1,TNUM,5,DDAT,53,HH,9,NET,14,PROD,15,STAT,40,NUD,
     1  42,HOST,43,CKT,52,SVER,51,MAINT)
	CALL DBNDAT(DDAT,IM,ID,IY)
	TYPE 2379,TNUM,IM,ID,PROD,NUD,CKT,SVER,HOST,STAT,MAINT,
     1  NETOP(HH),YY(ESC)
	IF ((Z.EQ.1).AND.(J.EQ.NUMBER-1)) GOTO 3382
	IF ((Z.EQ.2).AND.(J.EQ.NUMBER).AND.(M.NE.2)) GOTO 3384
	GOTO 3389
3382    CALL DBSET(2)
	IF ((CIRCKT(1).EQ.'     ').OR.(CIRCKT(1).EQ.'.    ')) GOTO 3387
	CALL DBFIND(40,1,NOD1,1,9,1,VNET(K),1,49,'GE',NDAT,'OR',
     1  9,1,VNET(K),1,49,'GE',NDAT,1,43,1,CIRCKT)
	GOTO 3386
3387    CALL DBFIND(40,1,NOD1,1,9,1,VNET(K),1,49,'GE',NDAT)
3386    CALL DBNREC(RECORD)
	TOGO=NUMBER+RECORD
	CALL DBSET(1)
	GOTO 3383
3384    TOGO=NUMBER+1
3383    ENCODE(320,3391,INFO)NOD1,CIRCKT,TOGO,TNUM,IM,ID,PROD,NUD,
     1  CKT,SVER,HOST,STAT
3391    FORMAT('NODE # ',I5,' OR CIRCUIT # ',4A5,'HAS BEEN INVOLVED ',
     1  'IN ',I2,' TICKETS  ',' OVER THE LAST 30 DAYS. THE MOST REC',
     2  'ENT TICKET IS #',I6,' OPENED ON 'I2,1H/,I2,' FOR',4X,'PROD',
     3  'UCT ',1H",A5,1H",' ON NODE ',I5,' WITH CIRCUIT  ',4A5,
     4  '. THE SEVERITY  WAS A ',I1,' EFFECTING HOST #',I6,'. THE ',
     5  'CURRENT STATUS IS ',A5,1H.)
	M=2
	CALL DBERR($3392,IERT,IERC,0)
	GOTO 3393
3392    IF (IERT.NE.7) GOTO 4931
	TYPE 1379
	CALL WAIT(5.0)
3393    CALL DBOPEN(BASE(2))
	CALL DBUPD(-1)
	CALL DBFIND(1,1,TOT)
	CALL DBNREC(RECORD)
	ORDER=RECORD+1
	CALL DBADD(1,TOT,2,SDAT,3,TIM1,4,'SYS',5,0,6,'OPEN',7,INFO,8,
     1  'PAPER',9,ORDER,10,0)
	ENCODE(320,3373,INFO)TOGO,NOD1,CIRCKT
3373    FORMAT('USE THE ',4H"N" ,'COMMAND TO LEARN ALL OF THE ',I2,
     1  ' TICKET NUMBERS.'22X,' NODE ',I5,' OR CIRCUIT ',4A5,' MAYBE ',
     2  'A CHRONIC PROBLEM.'12X,1H.,90X)
	ORDER=ORDER+1
	CALL DBADD(1,TOT,2,SDAT,3,TIM1,4,'SYS',5,0,6,'OPEN',7,INFO,8,
     1  'PAPER',9,ORDER,10,0)
	CALL DBCLOS
	CALL DBERR($4931,IERT,IERC,0)
	IF (Z.EQ.2) GOTO 3390
	CALL DBOPEN(BASE(1),BASE(4))
	CALL DBSET(1)
3389    CONTINUE
	IF (Z.EQ.2) GOTO 3390
	Z=2
	CALL DBSET(2)
	GOTO 3368
3390    TYPE 2370
	GOTO 3959
C
C
C************************************************************
C
C       ROUTINE TO LOOK AT A TICKET WITH EITHER A NODE, HOST
C        CIRCUIT, CUSTOMER NAME OR TICKET NUMBER.
C
C************************************************************
C
C400    TYPE 3401
3401    FORMAT(1X,'DO YOU WISH TO CREATE A FILE OF YOUR FINDINGS ? ',$)
	ACCEPT 65,WELL
	CALL HISET(WELL)
C
C	CALL ONINT($4930)
C
	IF (WELL.NE.'Y') GOTO 3404
	TYPE 3402
3402    FORMAT(1X,'ENTER OUTPUT FILE NAME : ',$)
	ACCEPT 3403,FILE
3403    FORMAT(A10)
3404	OPEN(unit=8,device='DSK',access='SEQOUT',file=FILE)
3400    TYPE 3405
	Z=1
3405    FORMAT(/1X,'THIS OPTION WILL ALLOW YOU TO SEE A TICKET',/2X,
     1  'IF YOU KNOW EITHER A TICKET NUMBER, HOST, NODE, CIRCUIT #,',
     2  ' OR',/2X,'A CUSTOMER NAME (AT LEAST THE FIRST THREE LETTERS).',
     3  /2X,'THE SYNTAX IS ',1H",'OPTION VALUE',1H"'. THE OPTIONS ARE',
     4  '...'/2X,'(N= NODE, H= HOST, C= CUSTOMER ',
     5  'NAME, T= TIC. #',/2X,'AND L= CIRCUIT NUMBER).',
     6  ' USE THE "N" COMMAND FOR',
     7  /2X,'ALL OTHER DATA. EXAMPLES ARE ',1H",'N 02210',1H",/2X,
     8  'NOTE: YOU MUST HAVE LEADING ZEROS FOR NODE AND HOST NUMBERS',
     9  /2X,'NODES ARE FIVE DIGITS AND HOSTS ARE SIX DIGITS.',/1X,
     A  'ENTER OPTION SPACE VALUE',/1X'X ....................',/)
	CALL DBOPEN(BASE(1),BASE(2),BASE(8))
3410    ACCEPT 3415,CHO,VALUE
3415    FORMAT(A1,1X,4A5)
	CALL HISET(CHO)
	call upcase(value)
3417    IF (CHO.EQ.'C') goto 3425
	IF (CHO.EQ.'N') GOTO 3450
	IF (CHO.EQ.'L') GOTO 3465
	IF (CHO.EQ.' ') GOTO 4945
	IF (CHO.EQ.'H') GOTO 3470
C       OPTION IS NOT KNOWN
	TYPE 3420,CHO
3420    FORMAT(/1X,'YOUR OPTION "',A1,1H"' IS NOT RECOGNIZED.',/)
	TYPE 3405
	GOTO 3410
C425    DECODE(5,3424,VALUE(1))M1,M2,M3,M4,M5
3424    FORMAT(A1,A1,A1,A1,A1)
C       M3=M3+"001
C       ENCODE(5,3421,NEWVAL(1))M1,M2,M3,M4,M5
3421    FORMAT(A1,A1,A1,'  ')
3433    FORMAT(3X,4A5)
C
C       GET THIRD CHARACTER FROM VALUE AND PLACE IT IN THE NEWVAL
C       STRING
C
3425    CALL GETC(1,VALUE,M1)
	CALL GETC(2,VALUE,M2)
	CALL GETC(3,VALUE,M3)
	M3=M3+"001
	CALL PUTC(1,NEWVAL,M1)
	CALL PUTC(2,NEWVAL,M2)
	CALL PUTC(3,NEWVAL,M3)
3434    CALL DBFIND('CNAM','GE',VALUE,1,'CNAM','LE',NEWVAL)
	IF (VALUE(1).EQ.'MOT  ') CALL DBSRCH(15,1,'OPEN ')
	YMTOT=0
	I=1
3427    CALL DBNREC(TODAY)
3430    IF (TODAY.EQ.0) GOTO 3431
	TYPE 3480
	YMTOT=YMTOT+TODAY
	DO 3429 X=1,TODAY
	CALL DBGREC($3429,X)
	CALL DBVAL(1,LIST(I),9,NET,40,NODE,42,HOST,43,CKT,51,
     1  MAINT,14,PROD,'CNAM',CNAM)
	TYPE 3485,I,LIST(I),CNAM(1),CNAM(2),CNAM(3),NET,NODE,
     1  CKT(1),CKT(2),CKT(3),HOST,PROD,MAINT
	I=I+1
3429    CONTINUE
3431    CALL DBSET(3)
	CALL DBFIND('RNAM','GE',VALUE,1,'RNAM','LE',NEWVAL,1,6,1,0)
	CALL DBNREC(NUMBER)
	IF (NUMBER.EQ.0) GOTO 3428
	YMTOT=YMTOT+NUMBER
	DO 3428 X=1,NUMBER
	CALL DBSET(3)
	CALL DBGREC($3455,X)
	CALL DBVAL(1,TNUM,'RNAM',RNAM)
	CALL DBSET(1)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(RECORD)
	IF((NUMBER.GT.0).AND.(RECORD.EQ.0)) GOTO 3455
	IF (RECORD.EQ.0) GOTO 3428
	CALL DBGREC($3455,RECORD)
	CALL DBVAL(1,LIST(I),9,NET,40,NODE,42,HOST,43,CKT,51,MAINT,
     1  14,PROD,15,STAT,'CNAM',CNAM)
	IF ((STAT.EQ.'CLSD').OR.(RNAM(1).EQ.CNAM(1))) GOTO 3456
	TYPE 3485,I,LIST(I),RNAM(1),RNAM(2),RNAM(3),NET,NODE,
     1  CKT(1),CKT(2),CKT(3),HOST,PROD,MAINT
	I=I+1
3456    CALL DBSET(3)
	GOTO 3428
3455    TYPE 3446,NUMBER,YMTOT,RECORD,X
3446    FORMAT(1X,'ERROR... NUM=',I3,3X,'YM=',I3,3X,'REC=',I3,3X,
     1  'X=',I3)
3428    CONTINUE
	IF((NUMBER.GT.0).AND.(RECORD.EQ.0)) GOTO 4945
	IF ((YMTOT.EQ.0).AND.(Z.EQ.1)) GOTO 3441
	IF ((YMTOT.EQ.0).AND.(Z.EQ.2)) GOTO 4945
	TYPE 3500
	ACCEPT 120,I
	IF (I.EQ.0) GOTO 4945
	IF ((I.LT.1).OR.(I.GT.YMTOT)) GOTO 3428
	CALL DBSET(1)
	CALL DBFIND(1,1,LIST(I))
	CALL DBNREC(NUMBER)
	I=NUMBER
	GOTO 666
3432    IF (Z.EQ.2) GOTO 4945
	TYPE 3435,CHO,VALUE
3435    FORMAT(/1X'NO VALUE FOR YOUR OPTION ',1H",A1,1H"' AND VALUE ',
     1  'OF ',4A5,/)
3441    TYPE 3440
3440    FORMAT(1X,'DO YOU WISH TO TRY THE ARCHIVE DATA BASE ? ',$)
	ACCEPT 65,SEE
	CALL HISET(SEE)
	IF (SEE.EQ.'Y') GOTO 3445
	IF (WELL.EQ.'Y') CLOSE(unit=8)
	GOTO 4945
3445    Z=2
	CALL DBOPEN(BASE(4),BASE(5),BASE(9))
	IF (CHO.EQ.'C') GOTO 3434
	IF (CHO.EQ.'N') GOTO 3460
	IF (CHO.EQ.'L') GOTO 3465
	GOTO 3470
C       OPTION IS NODE
3450    DECODE(5,34509,VALUE(1))NODE
34509   FORMAT(I5)
3460    CALL DBFIND(40,1,NODE)
	GOTO 3427
C       OPTION IS CIRCUIT
3465    CALL DBFIND('CKT',1,VALUE)
	GOTO 3427
C       OPTION IS HOST
3470    DECODE(6,3454,VALUE)HOST
3454    FORMAT(I6)
	CALL DBFIND('HOST',1,HOST)
	GOTO 3427
3472    CALL DBFIND(1,1,TNUM)
	GOTO 3427
C       LIST TICKETS FOUND
3475    IF (NUMBER.GT.1) GOTO 3476
	I=NUMBER
	GOTO 666
3476    TYPE 3480
C       IF (WELL.EQ.'Y') WRITE(8,3480)
3480    FORMAT(1X,'REC. TNUM   CUSTOMER',T30,'NET',T41,'NODE',T46,
     1  'CIRCUIT',T63,'HOST PROD  MAINT'/)
	DO 3490 I=1,NUMBER
	CALL DBGREC($59,I)
	CALL DBVAL(1,LIST(I),9,NET,40,NODE,42,HOST,43,CKT,51,
     1  MAINT,14,PROD,'CNAM',CNAM)
	TYPE 3485,I,LIST(I),CNAM(1),CNAM(2),CNAM(3),NET,NODE,
     1  CKT(1),CKT(2),CKT(3),HOST,PROD,MAINT
3485    FORMAT(1X,I2,I8,2X,3A5,1X,A10,I5,1X,3A5,I6,1X,A5,1X,A5)
C       IF (WELL.EQ.'Y') WRITE(8,3485)I,
C    1  LIST(I),RNAM(1),RNAM(2),RNAM(3),NET,
C    2  NODE,CKT(1),CKT(2),CKT(3),HOST,PROD,MAINT
3490    CONTINUE
	IF (WELL.EQ.'Y') GOTO 3507
3495    TYPE 3500
3500    FORMAT(/1X,'WHICH REC. NO. DO YOU WISH TO SEE IN DETAIL ? ',$)
	ACCEPT 120,I
	IF (I.EQ.0) GOTO 4945
	IF ((I.GT.0).AND.(I.LE.NUMBER)) GOTO 3505
	GOTO 3495
3505    CALL DBSREC
	NUMBER=I
	GOTO 666
3507    IF (Z.EQ.1) GOTO 3441
	CLOSE(unit=8)
	TYPE 3651,FILE
	GOTO 4950
C
C***********************************************
C
C       LIST ESCALATED TICKETS
C
C***********************************************
C
3520    TYPE 3525
3525    FORMAT(3X,'THIS OPTION WILL LIST THE OPEN ESCALATED TICKETS',/)
	CALL DBOPEN(BASE(1))
	CALL DBFIND(46,1,2,1,15,'NE','CLSD')
	IF (FLAG.GT.1) CALL DBFIND(46,1,2,1,15,'NE','CLSD',1,
     1  9,1,VNET(FLAG))
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 773
	TYPE 3530
3530    FORMAT(/5X,'THERE ARE NO ESCALATED TICKETS AVAILABLE !',/)
	GOTO 4950
C
C
C**************************************************
C
C       ROUTINE TO FIND ALL TICKETS FOR A MAINT REGION
C
C**************************************************
C
3580    TYPE 3581
3581    FORMAT(/1X,'SELECT THE REGION YOU WISH TO SEE THE OPEN TICKETS',
     1  ' FOR.',/6X,'SELECT:   1  FOR NFO',/T17,'2  FOR INTERNATIONAL',
     2  /T17,'3  FOR ETS',/T17,'4  FOR CTS',/T17,'5  FOR WTS',/T17,
     3  '6  FOR ALL EAST SOFTWARE    ) ',/T17,'7  FOR ALL CENTRAL SOFT',
     4  'WARE  > REGARDLESS OF REF. GRP.',/T17,'8  FOR ALL WEST ',
     5  'SOFTWARE    )',
     7  /3X,'ENTER SELECTION NUMBER : ',$)
	CALL DBOPEN(BASE(1))
	ACCEPT 120,P
	IF ((P.LT.0).OR.(P.GT.8)) GOTO 3580
	IF ((P.GE.6).AND.(P.LE.8)) GOTO 3582
	IF (P.EQ.0) GOTO 4950
3584    CALL DBFIND('MAINT','GE',LREFER(P),1,'MAINT','LE',HREFER(P),1,
     1  'STAT','NE','CLSD')
	GOTO 3583
3582    P=P-3
	X=31
	CALL DBFIND(20,'GE',LREFER(P),1,20,'LE',HREFER(P),1,
     1  15,'NE','CLSD')
3583    CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 770
	TYPE 2596,LREFER(P)
	GOTO 4950
C
C       ROUTINE TO LIST CFSS TICKETS
C
3586    CALL DBOPEN(BASE(1))
	CALL DBFIND(51,'GE','NF',1,51,'LE','NG',1,15,'NE','CLSD',1,52,
     1  'LE',2,'OR',51,1,'CFSS',1,15,'NE','CLSD',1,52,'LE',2)
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 770
	TYPE 2596,ATTN(63)
	GOTO 4950
3585    CALL DBOPEN(BASE(1))
	CALL DBFIND(51,'GE','NF',1,51,'LE','NG',1,15,'NE','CLSD',1,52,
     1  'GE',3,'OR',51,1,'CFSS',1,15,'NE','CLSD',1,52,'GE',3)
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 770
	TYPE 2596,ATTN(63)
	GOTO 4950
	CALL DBNREC(NUMBER)
	IF (NUMBER.EQ.0) GOTO 3577
3587    FORMAT(//4X,'THERE ARE ZERO PROJECT TICKETS OPEN',//)
	TYPE 3589,NUMBER
3589    FORMAT(/3X,'THERE ARE ',I3,' TICKETS OPEN FOR PROJECTS',/)
	TYPE 3579
3579    FORMAT(/3X,'TIC#',1X,'DATE',2X,'PROD',2X,'NODE',2X,'PROJECT',
     1  11X,'SVER',2X,'HOST',1X,'STAT',2X,'ATTN.',1X,
     2  'CTRL GRP ETIM',/)
	DO 3578 I=1,NUMBER
	CALL DBGREC($4930,I)
	CALL DBVAL(1,TNUM,5,SDAT,6,TIM1,14,PROD,15,STAT,40,NODE,
     1  42,HOST,46,ESC,52,SVER,51,MAINT,53,HH,49,DUP,50,TUP,
     2  54,ELM,19,ONUM)
	CALL DBNDAT(SDAT,IM,ID,IY)
	IY=IY-1900
	CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
	TYPE 3576,TNUM,IM,ID,PROD,NODE,ONUM,SVER,HOST,STAT,MAINT,
     1  NETOP(HH),YY(ESC),HOUR
3576    FORMAT(1X,I6,1X,I2,1H/,I2,1X,A5,1X,I5,1X,2A5,10X,I1,1X,I6,
     1  1X,A5,1X,A5,1X,A5,1X,A1,F6.1)
3578    CONTINUE
	GOTO 4950
3577    TYPE 3587
	GOTO 4950
C
C********************
C
C       ROUTINE TO LIST LAST STATUS TIME ENTRY
C
C********************
C
3710    TYPE 3715
3715    FORMAT(1X,'THIS ROUTINE WILL LIST THE TIME THAT THE ',
     1  'TICKET WAS LAST UPDATED.',/)
	TYPE 170,TIC
	CALL DBOPEN(BASE(2),BASE(1))
3720    CALL DBSET(1)
	ACCEPT 120,TNUM
	IF (TNUM.EQ.0) GOTO 4950
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 3730
	TYPE 3725
3725    FORMAT(T25,'NO ENTRIES',/)
	TYPE 170,TIC
	GOTO 3720
3730    CALL DBGREC($3710,NUMBER)
	CALL DBVAL(2,SDAT,3,TIM1,4,INT,6,STAT)
	CALL DBNDAT(SDAT,IM,ID,IY)
	TYPE 3735,IM,ID,IY,TIM1,STAT,INT,NUMBER
3735    FORMAT(1X,I2,1H-,I2,1H-,I4,4X,A5,5X,A5,5X,A3,3X,I3,$)
	CALL DBSET(2)
	CALL DBFIND(1,1,TNUM)
	CALL DBGREC($3736,1)
	CALL DBVAL(39,V4)
	TYPE 3737,V4
3737    FORMAT('+',3X,I3,/)
3736    TYPE 170,TIC
	GOTO 3720
C
C********************
C
C       ROUTINE TO PLACE A TICK MARK IN THE DATA BASE
C
C********************
3740    TYPE 3745
3745    FORMAT(1X,'THIS ROUTINE IS FOR PLACING QA COMMENTS ABOUT ',
     1  'SERVICE RENDERED.',/,/1X,'THIS OPTION WILL ALLOW YOU TO ',
     2  'PUT MULTIPLE TICMARKS IN FOR TICKET.',/1X,'YOU WILL NOT ',
     3  'BE PROMPTED. INSTEAD YOU WILL ENTER A TICKET ',/1X,
     4  'NUMBER. YOU CAN THEN ENTER ALL THE DATA ON ONE LINE.',/1X,
     5  'REFER GROUPS ARE STANDARD !',T30,'DISCIPLINES ARE...',T50,
     6  'H = HARDWARE',/T50,'S = SOFTWARE',/T50,
     7  'V = VENDOR',
     8  /,/3X,'NOTE : ',
     9  'WHEN CLOSING A TICKET ENTER A -1 ON ',/12X,'THE LAST LINE.',/)
3749    TYPE 3750
3750    FORMAT(1X,'CTT RRR COMMENTS................................',
     1  '....................',/)
3752    ACCEPT 3755,DSP,TT,REG,COMMEN
	IF (TT.EQ.0) GOTO 59
	IF ((DSP.EQ.'-').AND.(ANS.EQ.'S'.OR.'C')) GOTO 903
	CALL HISET(DSP)
	IF (DSP.EQ.'H') GOTO 3771
	IF (DSP.EQ.'S') GOTO 3772
	IF (DSP.eq.'V') GOTO 3773
	IF (DSP.EQ.'-') GOTO 4950
	GOTO 3801
3773    IF ((TT.GE.1).AND.(TT.LE.13)) GOTO 3791
	IF ((TT.GE.20).AND.(TT.LE.25)) GOTO 3791
	IF (TT.EQ.14) GOTO 3806
	GOTO 3801
3771    IF ((TT.GE.1).AND.(TT.LE.20)) GOTO 3791
	IF (TT.EQ.21) GOTO 3806
	GOTO 3801
3772    IF ((TT.GE.1).AND.(TT.LE.15)) GOTO 3791
	IF (TT.EQ.16) GOTO 3806
	GOTO 3801
3791    IF ((REG.GE.1).AND.(REG.LE.NATTN)) GOTO 3757
3801    TYPE 3802
3802    FORMAT(3X,'INPUT REJECTED  --  REENTER THE LINE AGAIN.')
	GOTO 3749
3806    TYPE 3804
3804    FORMAT(/3X,'"NO QA" IS NO LONGER TO BE USED AS A TICMARK ',
     1  'WHEN CLOSING TICKETS.',/3X,'USE "-1" IF THERE ARE NO ',
     2  'NEGATIVE TICMARKS.',/,/)
	GOTO 3749
3803    REG=NATTN+1
3755    FORMAT(A1,I2,1X,I3,1X,12A5)
3757    CALL DBERR($3759,IERT,IERC,0)
	GOTO 3762
3759    IF (IERT.NE.7) GOTO 4955
	TYPE 1379
	CALL WAIT(5.0)
3762    CALL DBOPEN(BASE(17))
	CALL DBUPD(-1)
	CALL DBSYSV(1,0,SDAT)
	CALL DBADD(1,TNUM,2,SDAT,3,ME,5,TT,6,ATTN(REG),7,DSP,
     1  8,COMMEN,'NET',NET)
	CALL DBCLOS
	CALL DBERR($4930,IERT,IERC,0)
	GOTO 3752
C
C       ENTER HERE TO CLOSE TICKET
C
3765    CALL DBOPEN(BASE(17),BASE(1))
	IF((ANS.EQ.'L').OR.(ANS.EQ.'S')) GOTO 93765
	TYPE 170,TIC
	ACCEPT 120,TNUM
	IF (TNUM.EQ.0)GOTO 4950
93765   CALL DBSET(2)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 3774
	TYPE 660,TNUM
	GOTO 4950
3774    CALL DBGREC($3776,NUMBER)
	CALL DBVAL(15,STAT,14,PROD,51,MAINT,52,SVER,49,DUP,
     1  50,TUP,54,ELM,5,SDAT,6,TIM1,35,V6,36,V1,37,V2,38,V3,39,V4,
     2  55,COC,46,ESC,9,NET,31,CNAM,40,NODE,53,HH)
3776    CALL DBSET(1)
3770    CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 3780
	TYPE 3775
3775    FORMAT(/5X,'****** NO Q.A. ENTRIES MADE ******',/)
	CALL DBCLOS
	GOTO 3740
3780    TYPE 3785
3785    FORMAT(/1X,'DATE',3X,'WHO',1X,'DSP',1X,'CODE',1X,'REGN',
     1  2X,'COMMENT',/)
	DO 3795 I=1,NUMBER
	CALL DBGREC($3740,I)
	CALL DBVAL(2,SDAT,3,INT,5,SVER,6,MAINT,7,DS1,8,COMMT)
	CALL DBNDAT(SDAT,IM,ID,IY)
	TYPE 3790,IM,ID,INT,DS1,SVER,MAINT,COMMT
3790    FORMAT(1X,I2,1H-,I2,2X,A3,2X,A1,3X,I2,2X,A5,1X,12A5)
3795    CONTINUE
	CALL DBCLOS
	GOTO 3740
C
C
C       ENTER HERE FROM S COMMAND
C
3800    CALL DBOPEN(BASE(17))
	GOTO 3770
C
C  ********************************
C
C       ROUTINE TO ESCALATE A TICKET
C
C ***********************************
C
3805    TYPE 3810
3810    FORMAT(/15X,'PERFORM AN ESCALATION',/,/3X,'ROUTINE TO ',
     1  'TO NOTE THAT AN ESCALATION HAS BEEN PERFORMED.',/)
	CALL GDIS(V1,V2,V3,V4,V5,V6,TNUM,BAS1)
	IF (TNUM.EQ.0) GOTO 59
3812    TYPE 3815
3815    FORMAT(/,/3X,'WHICH DISCIPLINE WAS THE ESCALATION PERFORMED ',
     1  'UNDER ?',/10X,'1 = HARWARE',/10X,'2 = SOFTWARE',/10X,
     2  '3 = TELCO',/10X,'4 = CUSTOMER',/3X,'ENTER SELECTION : ',$)
	ACCEPT 120,K
	IF (K.EQ.0) GOTO 59
	IF ((K.LT.1).OR.(K.GT.4)) GOTO 3812
	IF (K.EQ.1) GOTO 3840
	IF (K.EQ.2) GOTO 3850
	IF (K.EQ.4) GOTO 3860
3818    TYPE 3820,ITELC(1),ITELC(2),ITELC(3),ITELC(4),ITELC(5)
3820    FORMAT(3X,'ENTER THE LEVEL OF TELCO SUPERVISION THAT THE ',
     1  'PROBLEM WAS GIVEN TO...',/10X,'1 = ',A10,/10X,'2 = ',A10,
     2  /10X,'3 = ',A10,/10X,'4 = ',A10,/10X,'5 = ',A10,/3X,'ENTER ',
     3  'THE NUMBER : ',$)
	ACCEPT 120,P
	IF ((P.LT.1).OR.(P.GT.5)) GOTO 3812
	IF (P.GT.V3) GOTO 3838
	IF (P.LT.V3) TYPE 3825,ITELC(V3),ITELC(P)
3825    FORMAT(/1X,'ACCORDING TO THE DATA BASE THIS TICKET HAD BEEN',
     1  /1X,'ESCALATED TO THE ',A10,'. ARE YOU SAYING THAT YOU ',
     2  /1X,'DE-ESCALATED THIS TICKET TO THE ',A10,'?',/,/3X,
     3  'ENTER Y OR N : ',$)
	IF (P.EQ.V3) TYPE 3830,ITELC(V3)
3830    FORMAT(/1X,'ACCORDING TO THE DATA BASE THIS TICKET IS ALREADY',
     1  /1X,'AT THE ',A10,'. ARE YOU TRYING TO WASTE YOUR TIME AND ',
     2  'MINE ?',/,/3X,'ENTER Y OR N : ',$)
	ACCEPT 65,SEE
	CALL HISET(SEE)
	IF (SEE.NE.'Y') GOTO 3818
3838    V3=P
	V4=0
	GOTO 3860
3840    TYPE 3842,HWARE(1),HWARE(2),HWARE(3),HWARE(4),HWARE(5)
3842    FORMAT(3X,'ENTER THE FIELD ENGINEERING MANAGEMENT LEVEL THAT',
     1  ' THE PROBLEM',/3X,'WAS ESCALATED TO...',/10X'1 = ',A10,/10X,
     2  '2 = ',A10,/10X,'3 = ',A10,/10X,'4 = ',A10,/10X,'5 = ',A10,/3X,
     3  'ENTER THE NUMBER : ',$)
	ACCEPT 120,P
	IF ((P.LT.1).OR.(P.GT.5)) GOTO 3812
	IF (P.GT.V1) GOTO 3848
	IF (P.LT.V1) TYPE 3845,HWARE(V1),HWARE(P)
3845    FORMAT(1X,'ACCORDING TO THE DATA BASE THIS TICKET HAD BEEN',
     1  /1X,'ESCALATED TO A ',A10,' LEVEL. ARE YOU SAYING THAT YOU',
     2  /1X,'DE-ESCALATED THIS TICKET TO ',A10,'?',/,/3X,
     3  'ENTER Y OR N : ',$)
	IF (P.EQ.V1) TYPE 3847,HWARE(V1)
3847    FORMAT(1X,'ACCORDING TO THE DATA BASE THIS TICKET IS ALREADY',
     1  /1X,'ESCALATED TO ',A10,' LEVEL. ARE YOU TRYING TO WASTE YOUR',
     2  /1X'TIME AND MINE ?',/,/3X,'ENTER Y OR N : ',$)
	ACCEPT 65,SEE
	CALL HISET(SEE)
	IF (SEE.NE.'Y') GOTO 3840
3848    V1=P
	V4=0
	GOTO 3860
3850    TYPE 3852,SWARE(1),SWARE(2),SWARE(3),SWARE(4),SWARE(5),
     1  SWARE(6)
3852    FORMAT(3X,'ENTER THE LEVEL OF SOFTWARE ESCALATION THAT YOU ',
     1  'HAVE PERFORMED...',/10X,'1 = ',A10,/10X,'2 = ',A10,/10X,'3 = ',
     2  A10,/10X,'4 = ',A10,/10X,'5 = ',A10,/10X,'6 = ',A10,/3X,
     3  'ENTER THE NUMBER : ',$)
	ACCEPT 120,P
	IF ((P.LT.1).OR.(P.GT.6)) GOTO 3812
	IF (P.GT.V2) GOTO 3858
	IF (P.LT.V2) TYPE 3825,SWARE(V2),SWARE(P)
	IF (P.EQ.V2) TYPE 3830,SWARE(V2)
	ACCEPT 65,SEE
	CALL HISET(SEE)
	IF (SEE.NE.'Y') GOTO 3850
3858    V2=P
	V4=0
3860    TYPE 3853
3853    FORMAT(1X,'NAME OF PERSON ESCALATED TO : ',$)
	ACCEPT 100,RNAM
	CALL GTIM(TIM1,SDAT,LIC)
	CALL DBERR($3854,IERT,IERC,0)
	GOTO 3857
3854    IF (IERT.NE.7) GOTO 4950
	TYPE 3285
	CALL WAIT(5.0)
3857    CALL DBOPEN(BASE(8))
	CALL DBUPD(-1)
	CALL DBADD(1,TNUM,2,SDAT,3,TIM1,4,RNAM,5,ME,6,1)
	CALL DBUPD(0)
	CALL DBCLOS
3855    TYPE 3862,TNUM
3862    FORMAT(3X'DO YOU HAVE ANY MORE ESCALATIONS TO PERFORM ON ',
     1  'TICKET (#',I8,')',/3X,'ENTER Y OR N : ',$)
	ACCEPT 65,SEE
	CALL HISET(SEE)
	IF (SEE.EQ.'Y') GOTO 3812
	GOTO 3920
	ENCODE(841,207,DISC)
	GOTO 59
C
C       ROUTINE TO PLACE A TICKET ON DEFERMENT
C
3870    TYPE 3875
3875    FORMAT(/15X,'PLACE A TICKET ON DEFERMENT',/)
	TYPE 170,TIC
	CALL DBOPEN(BASE(1))
	ACCEPT 120,TNUM
	IF (TNUM.EQ.0) GOTO 59
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 3882
	TYPE 660,TNUM
	GOTO 59
3882    CALL DBGREC($3870,1)
	CALL DBVAL(34,V5,35,V6,36,V1,37,V2,38,V3,39,V4,'DUP',DUP)
	IF (DUP.NE.0) GOTO 3912
3877    TYPE 3880,V4
3880    FORMAT(/3X,'THIS TICKET IS CURRENTLY DEFERED FOR ',I2,
     1  ' HOURS.',/3X,'DO YOU WISH TO...',/10X,'1 = REDUCE DEFERMENT ',
     2  '(ENTER NEGATIVE TIME)',/10X,'2 = ZERO OUT DEFERMENT',/10X,
     3  '3 = DEFER TICKET ACTION'/3X,'ENTER NUMBER : ',$)
	ACCEPT 120,P
	IF ((P.GT.0).AND.(P.LT.4)) GOTO 3890
	I=I+1
	IF (I.EQ.3) GOTO 59
	GOTO 3877
3890    IF (P.EQ.3) GOTO 3900
	IF (P.EQ.2) GOTO 3910
	TYPE 3892
3892    FORMAT(1X,'ENTER THE AMOUNT OF HOURS THAT SHOULD BE REMOVED',
     1  /1X,'FROM THE TOTAL DEFERMENT HOURS (NEGATIVE NUMBER) ? ',$)
	ACCEPT 120,K
	IF (K.LT.0) GOTO 3895
	TYPE 3893,K
3893    FORMAT(3X'*** ',I2,' *** IS NOT A NEGATIVE NUMBER, THIS TIME',
     1  ' DO NOT FORGET THE MINUS SIGN!',/)
	GOTO 3877
3895    V4=V4+K
	IF (V4.LT.0)V4=0
	V6=V6+K
3920    CALL DBERR($3921,IERT,IERC,0)
	GOTO 3922
3921    IF (IERT.NE.7) GOTO 4955
	TYPE 1379
	CALL WAIT(5.0)
3922    CALL DBOPEN(BASE(1))
	CALL DBUPD(-1)
	CALL DBFIND(1,1,TNUM)
	CALL DBCHNG(34,V5,35,V6,36,V1,37,V2,38,V3,39,V4)
	CALL DBCLOS
	CALL DBERR($4930,IERT,IERC,0)
	ENCODE(841,207,DISC)
	GOTO 59
3900    TYPE 3902
3902    FORMAT(1X,'HOW MANY HOURS SHOULD THIS TICKET BE DEFERED ?',
     1  /1X'ENTER A NUMBER BETWEEN 1 AND 300 : ',$)
	ACCEPT 120,K
	IF ((K.LT.1).OR.(K.GT.300)) GOTO 3900
	V4=K
	V6=V6+K
	IF (V6.GT.999)V6=999
	GOTO 3920
3910    V4=0
	GOTO 3920
C
C       TIME UP IS SET SO ZERO OUT DEFERMENT
C
3912    TYPE 3913
3913    FORMAT(1X,'TIME UP IS SET. THERE IS NO NEED TO DEFFER THIS',
     1  ' TICKET.')
	IF (V4.EQ.0) GOTO 4950
	V4=0
	GOTO 3920
C
C
3925    ANS='D'
	TYPE 170,TIC
	ACCEPT 120,TNUM
	GOTO 2461
C
C
C******************************
C
C       ROUTINE TO LIST TICKETS ON MONITOR MORE THAN
C       24 HOURS.
C
C******************************
C
3930    TYPE 3935,FF,IA4,IA5,AM(IA1),IA2,IA3
3935    FORMAT(/,A5,/3X,'ROUTINE TO LIST TICKETS ON MONITOR MORE',
     1  /3X,'THAN 24 HOURS AS OF ',I2,1H:,I2,' ON ',A3,2H. ,I2,
     2  2H, ,I4,1H.,/,/5X,'TICKET NUMBER',3X,'HOURS PAST 24',/)
	CALL DBOPEN(BASE(1))
	IF (H2.EQ.0) CALL DBFIND(15,1,'MONIT')
	IF (H2.GT.0) CALL DBFIND(53,1,H2,1,15,1,'MONIT')
	DF=0
	CALL DBNREC(NUMBER)
	IF (NUMBER.EQ.0) GOTO 3945
	DUP=0
	TUP='     '
	DO 3942 I=1,NUMBER
	CALL DBGREC($4930,I)
	CALL DBVAL(1,TNUM,49,SDAT,50,TIM1)
	ELM=0
	CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
	IF (ELM.LT.1440) GOTO 3942
	TYPE 3937,TNUM,HOUR
3937    FORMAT(9X,I8,8X,F7.1)
	DF=1
3942    CONTINUE
3945    IF (DF.EQ.0) TYPE 3944
3944    FORMAT(/,/8X,'NONE',/)
	TYPE 3253
	GOTO 4950
C
C***********************************8
C
C       PRINTS TIME AND DATE ON TERMINAL
C
C*************************************
C
3950    CALL FGMT(IA1,IA2,IA3,IA4,IA5,IA6)
	CALL TIME(TIM1)
	TYPE 3952,IA4,IA5,IA2,AM(IA1),IA3,TIM1
3952    FORMAT(15X,'ZULU TIME IS ',I2,1H:,I2,' ON ',I2,1H-,A3,1H-,I2,
     1  1H.,/14X,'LOCAL TIME IS ',A5,/)
	I=1
	GOTO 59
C
C
C******************************************
C
C       ROUTINE TO ENTER CALL BACK LOG ONLY
C       ENTER 3959 FROM 30 DAY HISTORY CHECK
C******************************************
C
3960    TYPE 170,TIC
3961    ACCEPT 120,TNUM
3959    IF (ANS.EQ.'A') TNUM=TOT
93959   IF (TNUM.EQ.0) GOTO 59
	CALL DBOPEN(BASE(1))
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 3962
	TYPE 202,TNUM
	TYPE 170,TIC
	GOTO 3961
3962    CALL DBGREC($3960,1)
	CALL DBVAL(52,SVER,53,HN)
	CALL DBCLOS
	IF (ANS.EQ.'A') GOTO 3963
	TYPE 170,RW1
	ACCEPT 100,REPN
	CALL UPCASE(REPN)
	TYPE 170,SC
	ACCEPT 100,SITC
	CALL UPCASE(SITC)
	TYPE 170,SP
	ACCEPT 100,SITP
	CALL RTIM(TIM1,SDAT)
3963    CALL DBERR($3284,IERT,IERC,0)
	GOTO 3286
C********************
C
C       OPEN DATA BASE TO SEE IF WE HAVE A MATCH
C
C********************
C
3975    FORMAT(/3X,'IS THIS A NODE, HOST, CIRCUIT, OR FRAME RELAY ',
     1  'TICKET?',/4X,'ENTER N,H,C, OR F :  ',$)
4005    CALL DBNREC(RECORD)
	IF (RECORD.GT.0) GOTO 3986
	TYPE 3985
3985    FORMAT('+NOT FOUND',/)
	GOTO 4054
C
C       ENTER HERE WHEN RECORD HEADER FOUND
C
3986    TYPE 3987
3987    FORMAT('+FOUND !!',/)
	CALL DBGREC($4005,1)
4009    CALL DBVAL(1,SITC,2,SITP,3,NET,4,NOD1,5,SLOT,6,HST1,7,CIRCKT,
     1  8,TROUB1,9,TECH,10,CNAM,11,KHST,12,COV,13,PRO,14,STH,15,EHR,16,
     2  PORT,18,PROD,21,LOC,22,VER,23,T40,25,SRGN,26,HRGN,27,LIN1,
     3  28,SNAM,29,SDAT,30,INT,31,F1)
	CALL DBNDAT(SDAT,IM,ID,IY)
	IF (LIN1(1).NE.'     ') TYPE 4021,SNAM,ID,AM(IM),IY,INT,LIN1
4021    FORMAT(/,/3X,'***  SPECIAL INSTRUCTION  ***    ENTERED BY : ',
     1  3A5,/9X,I2,1H-,A3,1H-,I4,4X,1H(,A3,1H),/,/1X,16A5,/)
	IF(T40.EQ.4) TYPE 4024
4024    FORMAT(/,/,/,/,/,/17X,'*****THIS IS A CODE BLUE CUSTOMER*****',
     1  /,/7X,'MAKE SURE YOU NOTIFY THE APPROPRIATE MANAGEMENT ',
     2  'PERSONNEL',/,/11X,'FAILURE TO DO SO WILL RESULT IN GRAVE ',
     3  'CONSEQUENCES',/,/,/,/,/)
	IF (WELL.EQ.'F') CALL FPRUPD(SITC,SITP,NET,NOD1,SLOT,HST1,
     1  CIRCKT,TROUB1,TECH,CNAM,KHST,COV,PRO,STH,EHR,PORT,PROD,LOC,
     2  VER,T40,SRGN,HRGN,LIN1,SNAM,SDAT,INT,F1,RECORD,IPXNA,CRDNM,
     3  PRTNM)
	IF (WELL.EQ.'F') K=38
	IF (WELL.EQ.'F') GOTO 4016
	IF (RECORD.GT.0) GOTO 4007
4008    FORMAT(A10)
	IF(NET.EQ.'          ')DECODE(10,4008,VNET(K))NET
	Z=1
	IF (WELL.EQ.'N') NOD1=NODE
	IF (WELL.EQ.'H') HST1=HOST
	IF (WELL.EQ.'C') ENCODE(20,100,CIRCKT)CKT(1),CKT(2),CKT(3),
     1  CKT(4)
	IF (ANS.EQ.'A2') GOTO 4016
4007    IF (ANS.EQ.'A2') GOTO 4020
	IF (ANS.EQ.'MP') GOTO 6000
	TYPE 4010
4010    FORMAT(' BEGIN CHECK FOR EMPTY FIELDS',/)
	IF((WELL.EQ.'C').AND.(NOD1.EQ.0))CALL GTW3(LNO,NOD1,Z)
	IF((WELL.EQ.'C').AND.(HST1.EQ.0))CALL GTW3(HNO,HST1,Z)
	IF (SITC(1).EQ.'     ') CALL GTHRE(SC,SITC,Z)
	IF (SITP(1).EQ.'     ') CALL GTHRE(SP,SITP,Z)
	IF (SLOT.EQ.'  ') CALL G1NE(SL,SLOT,Z)
	IF (WELL.EQ.'H') CALL GTWO(OCKT,CIRCKT,Z,2)
	IF (TROUB1(1).EQ.'     ') CALL GTHRE(OTRB,TROUB1,Z)
	IF((TECH(1).EQ.'     ').AND.(WELL.NE.'C'))CALL GTHR3(RP1,
     1  TECH,Z,1)
	IF((TECH(1).EQ.'     ').AND.(WELL.EQ.'C'))CALL GTHR3('ANALYSIS',
     1  TECH,Z,1)
	IF (SRGN.EQ.'     ') CALL GRGN(1,P,Z)
	IF ((SRGN.EQ.'     ').AND.(P.GT.0)) SRGN=ATTN(P)
	IF (HRGN.EQ.'     ') CALL GRGN(2,P,Z)
	IF ((HRGN.EQ.'     ').AND.(P.GT.0)) HRGN=ATTN(P)
	CALL GTHR3(RW1,CNAM,Z,2)
	IF ((WELL.EQ.'H').AND.(NOD1.EQ.0))CALL GONE(NO,NOD1,Z)
	IF (KHST.EQ.0) CALL GONE(OKH,KHST,Z)
	IF (PORT.EQ.0) CALL GONE(PTS,PORT,Z)
	IF (PRO.EQ.0) CALL GTW2(OPRO,PRO,Z)
	IF (COV.EQ.'  ') CALL GTW1(OCV,COV,Z)
	IF (STH.EQ.0) CALL GTW1(OSTH,STH,Z)
	IF (EHR.EQ.0) CALL GTW1(OEHR,EHR,Z)
4011    CALL GPROD(P,Z)
	IF (TYPE(P).NE.'     ') GOTO 94011
	TYPE 92399,P
	GOTO 4011
94011   IF (LOC(1).EQ.'     ') CALL GTWO(OLOC,LOC,Z,2)
	IF(WELL.EQ.'C') GOTO 94016
	IF (VER.EQ.'     ') GOTO 94017
	IF (CSC.EQ.1) GOTO 94018
	TYPE 94015,VER
94015   FORMAT(/1X,'VERSION IS CURRENTLY SET TO ',A5,/1X,
     1  'DO YOU WISH TO CHANGE IT?  ',$)
	ACCEPT 65,VCHG
	CALL HISET(VCHG)
	IF(VCHG.EQ.'Y') CALL GTW1(OVER,VER,Z)
	GOTO 94016
94017   IF ((VER.EQ.'     ').AND.(WELL.NE.'C'))CALL GTW1(OVER,VER,Z)
94016   IF ((VER.EQ.'     ').AND.(WELL.EQ.'C'))CALL GTW1('HIKHST',VER,Z)
94018   IF (F1.EQ.0) CALL GZONE(F1,Z)
	IF ((Z.EQ.1).AND.(ANS.EQ.'AP')) GOTO 4950
	IF (Z.EQ.1) GOTO 4020
	IF (P.GT.0) PROD=TYPE(P)
4016    CALL DBERR($4015,IERT,IERC,0)
	GOTO 4018
4015    IF (IERT.NE.7) GOTO 4955
	TYPE 1379
	CALL WAIT(5.0)

4018    CALL DBOPEN(BASE(10))
	CALL DBUPD(-1)
	TYPE 4019
4019    FORMAT(' UPDATING RELATIONS ... ',$)
	CALL DBSYSV(1,0,CDAT)
	IF ((K.NE.34).OR.(WELL.NE.'H')) GOTO 4028
	CALL DBFIND(17,1,WELL,1,6,1,HST1,1,3,1,VNET(K),1,4,1,NOD1)
	GOTO 4029
4028    IF (WELL.EQ.'N') CALL DBFIND(17,1,WELL,1,4,1,NOD1,1,3,1,VNET(K))
	IF (WELL.EQ.'H') CALL DBFIND(17,1,WELL,1,6,1,HST1,1,3,1,VNET(K))
	IF (WELL.EQ.'C') CALL DBFIND(17,1,WELL,1,7,1,CIRCKT)
	IF (WELL.EQ.'F') CALL DBFIND(17,1,WELL,1,18,1,IPXNA,1,6,1,
     1  CRDNM,1,5,1,PRTNM)
4029    CALL DBNREC(NUMBER)
	IF (NUMBER.EQ.0) GOTO 4025
74026   CALL DBCHNG(1,SITC,2,SITP,4,NOD1,5,SLOT,6,HST1,7,CIRCKT,8,
     1  TROUB1,9,TECH,11,KHST,12,COV,13,PRO,14,STH,15,EHR,16,
     2  PORT,18,PROD,19,CDAT,20,ME,21,LOC,22,VER,24,UNAM,25,SRGN,
     3  26,HRGN,23,t40,31,F1,10,CNAM)
	IF (NUMBER.EQ.1) GOTO 4023
	DO 4026 I=2,NUMBER
	CALL DBGREC($4026,I)
	CALL DBDEL
4026    CONTINUE
4023    CALL DBCLOS
	TYPE 4017
	CALL DBERR($4930,IERT,IERC,0)
4017    FORMAT('+COMPLETE',/)
	IF ((ANS.EQ.'A2').OR.(ANS.EQ.'A ')) GOTO 4020
	IF ((Z.EQ.3).AND.(NOD1.GT.0)) GOTO 3360
	GOTO 59
C
C       ENTER HERE FROM A2 COMMAND
C
4020    TYPE 170,RW2
	ACCEPT 100,REPN
	IF (REPN(1).EQ.'     ') GOTO 4022
	TYPE 170,RP2
	ACCEPT 100,REPF
	GOTO 180
4022    CALL NPHONE(REPN,REPF,UNAM,JJ1)
	GOTO 180
4025    TYPE 4030
4030    FORMAT(' ADDING INFORMATION TO RELATIONAL DATA BASE...',$)
74030   CALL DBADD(1,SITC,2,SITP,4,NOD1,5,SLOT,6,HST1,7,CIRCKT,8,
     1  TROUB1,9,TECH,11,KHST,12,COV,13,PRO,14,STH,15,EHR,
     2  16,PORT,18,PROD,19,CDAT,20,ME,21,LOC,22,VER,24,UNAM,25,
     3  SRGN,26,HRGN,17,WELL,3,VNET(K),23,T40,31,F1,10,CNAM)
	CALL DBCLOS
	TYPE 4017
	CALL DBERR($4930,IERT,IERC,0)
	IF (ANS.EQ.'AP') GOTO 59
	IF (ANS.EQ.'MP') GOTO 59
	IF (RECORD.EQ.0) GOTO 4020
	GOTO 59
C
C************************************
C
C       ROUTINE TO FIND OPEN TICKETS IN BASE1
C
C************************************
C
4035    TYPE 3975
	HDRCHK=0
	JJ1=0
	CALL DBOPEN(BASE(1))
4038    ACCEPT 65,WELL
	CALL HISET(WELL)
	IF (WELL.EQ.'N') GOTO 4040
	IF (WELL.EQ.'H') GOTO 4045
	IF (WELL.EQ.'C') GOTO 4046
	IF (WELL.EQ.'F') GOTO 70009
	TYPE 3975
	GOTO 4038
70009   TYPE 70010
70010   FORMAT(/1X,'IN ORDER TO OPEN A FRAME RELAY TICKET YOU MUST ',
     1  'KNOW THE',/1X,'IPX NAME, THE CARD #, AND THE PORT #.',/1X,
     2  'DO YOU WISH TO CONTINUE?  (Y OR N)',$)
	ACCEPT 70015,YORN
70015   FORMAT(A5)
	CALL HISET(YORN)
	IF (YORN.NE.'Y') GOTO 59
	I=1
70019   TYPE 70020
70020   FORMAT(/1X,'ENTER THE 5 CHARACTER IPX NAME:  ',$)
	ACCEPT 70021,IPXNA
70021   FORMAT(A5)
	CALL HISET(IPXNA)
	I=I+1
	IF (I.EQ.4) GOTO 59
	IF (IPXNA.EQ.' ') GOTO 70019
	PROD=IPXNA
	I=1
70025   TYPE 70026
70026   FORMAT(/1X,'ENTER THE CARD NUMBER:  ',$)
	ACCEPT 70027,CRDNM
70027   FORMAT(I2)
	I=I+1
	IF (I.EQ.4) GOTO 59
	IF (CRDNM.EQ.0) GOTO 70025
	I=1
70030   TYPE 70031
70031   FORMAT(/1X,'ENTER THE PORT NUMBER:  ',$)
	ACCEPT 70032,PRTNM
70032   FORMAT(A2)
	I=I+1
	IF (I.EQ.4) GOTO 59
	IF (PRTNM.EQ.' ') GOTO 70030
	DECODE(2,70032,PRTNM)SLOT
	GOTO 4044
4040    TYPE 188,NO
	ACCEPT 120,NOD1
	IF (NOD1.EQ.0) GOTO 4040
	IF (FLAG.GT.0) GOTO 4042
4041    TYPE 110
	ACCEPT 120,K
	IF ((K.GE.1).AND.(K.LE.NUMNET)) GOTO 4044
	CALL HLPNET
	GOTO 4041
4042    K=FLAG
4044    IF ((ANS.EQ.'AP').OR.(ANS.EQ.'MP')) GOTO 4054
	TYPE 131
	IF (WELL.EQ.'N') CALL DBFIND(9,1,VNET(K),1,40,1,NOD1,1,
     1  15,1,'OPEN')
	IF (WELL.EQ.'H') CALL DBFIND(9,1,VNET(K),1,42,1,HST1,1,
     1  15,1,'OPEN')
	IF (WELL.EQ.'C') CALL DBFIND(43,1,CIRCKT,1,15,1,'OPEN')
	IF (WELL.EQ.'F') CALL DBFIND(15,1,'OPEN',1,14,1,IPXNA,1,
     1  42,1,CRDNM,1,41,1,PRTNM)
	CALL DBNREC(DECIS)
	IF ((DECIS.GT.0).AND.(WELL.EQ.'F')) GOTO 74055
	IF (DECIS.GT.0) GOTO 4055
	TYPE 135
	CALL DBCLOS
	GOTO 140
4054    TYPE 3983
3983    FORMAT('  SEARCHING FOR RECORD ...',$)
	CALL DBOPEN(BASE(10))
	IF ((K.NE.34).OR.(WELL.NE.'H')) GOTO 4056
	CALL DBFIND(17,1,WELL,1,6,1,HST1,1,3,1,VNET(K),1,4,1,NOD1)
	GOTO 4057
4056    IF (WELL.EQ.'N') CALL DBFIND(17,1,WELL,1,4,1,NOD1,1,3,1,VNET(K))
	IF (WELL.EQ.'H') CALL DBFIND(17,1,WELL,1,6,1,HST1,1,3,1,VNET(K))
	IF (WELL.EQ.'C') CALL DBFIND(17,1,WELL,1,7,1,CIRCKT)
	IF (WELL.EQ.'F') CALL DBFIND(17,1,WELL,1,18,1,IPXNA,1,6,1,
     1  CRDNM,1,5,1,PRTNM)
4057    CALL DBNREC(RECORD)
	IF (RECORD.GT.0) GOTO 3986
	IF (ANS.NE.'MP') GOTO 4058
	TYPE 64057
64057   FORMAT(/1X,'NO RECORD FOUND.  USE THE "AP" COMMAND')
	CALL DBCLOS
	GOTO 59
4058    CALL DBFIND(17,1,'Z')
	CALL DBGREC($4054,1)
	NODE=NOD1
	HOST=HST1
	ENCODE(20,100,CKT)CIRCKT(1),CIRCKT(2),CIRCKT(3),CIRCKT(4)
	GOTO 4009
4045    TYPE 188,HO
	ACCEPT 194,HST1
	IF (HST1.EQ.0) GOTO 4045
	IF (FLAG.GT.0) GOTO 4047
4046    TYPE 110
	ACCEPT 120,K
	IF ((K.GE.1).AND.(K.LE.NUMNET)) GOTO 4051
	CALL HLPNET
	GOTO 4046
4047    K=FLAG
4051    IF (WELL.EQ.'C')GOTO 4050
	IF (K.NE.34) GOTO 4044
4049    TYPE 188,NO
	ACCEPT 120,NOD1
	IF (NOD1.EQ.0) GOTO 4049
	GOTO 4044
4050    TYPE 203,OCKT
	ACCEPT 100,CIRCKT
	IF (CIRCKT(1).EQ.'     ') GOTO 4050
	CALL UPCASE(CIRCKT)
	GOTO 4044
74055   DO 74060 I=1,DECIS
	CALL DBGREC($4054,I)
	CALL DBVAL(1,TNUM,5,SDAT,6,TIM1,40,NODE,42,HOST,14,PROD,
     1  57,RE,41,SLOT)
	CALL DBNDAT(SDAT,IM,ID,IY)
	IY=IY-1900
	TYPE 70130,TNUM,IM,ID,IY,TIM1,NODE,PROD,HOST,SLOT
70130   FORMAT(1X,I8,T11,I2,1H/,I2,1H/,I2,4X,A5,T30,I5,T37,A5,T45,
     1  I6,T68,I2)
74060   CONTINUE
	TOT=TNUM
	GOTO 70050
4055    DO 4060 I=1,DECIS
	CALL DBGREC($4054,I)
	CALL DBVAL(1,TNUM,5,SDAT,6,TIM1,40,NODE,42,HOST,43,CKT,14,
     1  PROD,57,RE)
	CALL DBNDAT(SDAT,IM,ID,IY)
	IY=IY-1900
	TYPE 130,TNUM,IM,ID,IY,TIM1,NODE,HOST,CKT,PROD
130     FORMAT(1X,I8,T11,I2,1H/,I2,1H/,I2,4X,A5,T30,I5,T37,I6,T45,
     1  4A5,T68,A5,1X,2A5)
4060    CONTINUE
	TOT=TNUM
C
C       CHECK TO SEE IF MORE DETAIL NEEDED
C
70050   TYPE 134
	ACCEPT 65,SEE
	CALL HISET(SEE)
	IF (SEE.EQ.'Y') GOTO 3292
C
C       SEE IF ADD TO CALL BACK LIST
C
4062    TYPE 133,DECIS,NODE
	ACCEPT 65,SEE
	CALL HISET(SEE)
	IF (SEE.NE.'Y') GOTO 4063
	ANS='A1'
	GOTO 3960
C       IF YES GOTO 140 GET TNUM THEN GOTO 4054
C
C       SEE IF USER WANTS TO OPEN ANOTHER TICKET
C
4063    TYPE 162
	ACCEPT 65,SEE
	CALL HISET(SEE)
	IF (SEE.EQ.'Y') GOTO 140
	CALL DBCLOS
	GOTO 59
C
C***********************************
C
C       ROUTINE TO START OF THE ADDING TO THE PROFILE
C       DATA BASE UNDER 1022
C
C***********************************
C
4065    TYPE 4068
4068    FORMAT(/3X,'ROUTINE TO ADD A RECORD TO THE PROFIL DATA ',
     1  'BASE...')
	TYPE 3975
	GOTO 4038
4067    TYPE 4069
4069    FORMAT(/3X,'ROUTINE TO MODIFY A RECORD IN THE PROFIL DATA ',
     1  'BASE...')
	TYPE 3975
	GOTO 4038
C
C***********************************
C
C       ROUTINE TO DISPLAY A PROFIL RECORD
C
C***********************************
C
4070    TYPE 4075
4075    FORMAT(/1X,'ROUTINE TO DISPLAY A RECORD FROM THE PROFIL ',
     1  'DATA BASE',/)
	TYPE 3975
	CALL DBOPEN(BASE(10))
4077    ACCEPT 65,WELL
	CALL HISET(WELL)
	IF ((WELL.EQ.'N').OR.(WELL.EQ.'H')) GOTO 4080
	IF (WELL.EQ.'C') GOTO 4078
	TYPE 3975
	GOTO 4077
4078    TYPE 203,OCKT
	ACCEPT 100,CKT
	IF (CKT(1).EQ.'     ') GOTO 59
	CALL DBFIND(7,1,CKT,1,17,1,WELL)
	GOTO 4090
4080    IF (FLAG.LT.1) GOTO 4081
	K=FLAG
	GOTO 4084
4081    TYPE 110
	ACCEPT 120,K
	IF ((K.GE.1).AND.(K.LE.NUMNET)) GOTO 4084
	CALL HLPNET
	GOTO 4080
4084    IF (WELL.EQ.'N') CALL GPNUM(NO,NODE)
	IF (WELL.EQ.'H') CALL GPNUM(HO,HOST)
	IF (WELL.EQ.'N') CALL DBFIND(3,1,VNET(K),1,4,1,NODE,1,
     1  17,1,WELL)
	IF (WELL.EQ.'H') CALL DBFIND(3,1,VNET(K),1,6,1,HOST,1,
     1  17,1,WELL)
4090    CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 4095
	TYPE 4092
4092    FORMAT(/3X,'NO RECORDS FOUND ...',//2X,'WOULD YOU LIKE TO ',
     1  'TRY AGAIN ? ',$)
	ACCEPT 65,SEE
	CALL HISET(SEE)
	IF (SEE.NE.'Y') GOTO 4950
	TYPE 3975
	GOTO 4077
4095    IF (NUMBER.EQ.1) GOTO 4103
	TYPE 4097
4097    FORMAT(/1X,'REC #',2X,'NODE',3X,'HOST',3X,'CUSTOMER NAME',4X,
     1  'CIRCUIT I.D.'10X,'PRODUCT',/)
	DO 4100 I=1,NUMBER
	CALL DBGREC($4100,I)
	CALL DBVAL(1,SITC,2,SITP,3,NET,4,NOD1,5,SLOT,6,HST1,7,CIRCKT,
     1  8,TROUB1,9,TECH,10,CNAM,11,KHST,12,COV,13,PRO,14,STH,15,EHR,16,
     2  PORT,18,PROD,21,LOC,22,VER,23,T40,25,SRGN,26,HRGN)
	TYPE 4098,I,NOD1,HST1,CNAM,CIRCKT,PROD
4098    FORMAT(3X,I2,3X,I5,1X,I6,2X,3A5,2X,4A5,2X,A5)
4100    CONTINUE
	TYPE 4102
4102    FORMAT(/1X,'WHICH REC # DO YOU WISH TO SEE : ',$)
	ACCEPT 120,P
	IF (P.LE.0) GOTO 4950
4104    CALL DBGREC($4950,P)
	CALL DBVAL(1,SITC,2,SITP,3,NET,4,NOD1,5,SLOT,6,HST1,7,CIRCKT,
     1  8,TROUB1,9,TECH,10,CNAM,11,KHST,12,COV,13,PRO,14,STH,15,EHR,16,
     2  PORT,18,PROD,21,LOC,22,VER,23,T40,25,SRGN,26,HRGN,17,TYP)
	IF (TYP.EQ.'N') GOTO 4110
	IF (TYP.EQ.'H') GOTO 4115
	TYPE 4105,NET,CIRCKT,NOD1,HST1,TROUB1,TECH,CNAM,COV,YN(PRO),
     1  STH,EHR,PROD,LOC,VER,YN(T40),SRGN,HRGN,SITC,SITP
4105    FORMAT(/1X,'NETWORK : 'A10,3X,'CIRCUIT : ',4A5,2X'LONODE : ',
     1  I5,/1X,'HINODE : ',I5,T23,'TROUBLE #: ',4A5,' ANALYSIS : ',
     2  3A5,/1X'CUSTOMER : ',3A5,T30,'COVERAGE : ',A2,10X,
     3  'PRODUCTION : ',A3,/1X,'SITE HOURS : ',
     4  A5,' TO ',A5,T58,'SPEED : ',A5,/1X,'LOCATION : ',
     5  4A5,' VERSION : ',A5,4X,'T40 : ',A3,/1X,'SOFTWARE DIST.: ',
     6  A5,4X,'HARDWARE DIST.: ',A5,/1X,'SITE CONTACT : ',4A5,
     7  ' PHONE : ',4A5)
	GOTO 4950
4110    TYPE 4112,NET,NOD1,KHST,HST1,CIRCKT,SLOT,TROUB1,TECH,CNAM,COV,
     1  YN(PRO),STH,EHR,PORT,PROD,LOC,VER,YN(T40),SRGN,HRGN,SITC,SITP
4112    FORMAT(/1X,'NETWORK : ',A10,3X,'NODE : ',I5,3X,'KERNAL : ',I5,
     1  4X,'HOST : ',I6,/1X,'CIRCUIT : ',4A5,3X'SLOT : ',A2,/1X,'TELCO ',
     2  ': ',4A5,5X'TECH : ',3A5,/1X,'CUSTOMER : ',3A5,3X,'COVERAGE : ',
     3  A3,4X,'PRODUCTION : ',A3,/1X,'SITE HOURS : ',A5,' TO ',A5,5X,
     4  'PORTS : ',I3,7X,'PRODUCT : ',A5,/1X,'LOCATION : ',4A5,4X,
     5  'VERSION : ',A5,9X,'T40 : ',A3,/1X,'SOFT. DIST. : ',A5,T28,
     6  'HARD. DIST. : ',A5,/1X,'SITE CONTACT : ',4A5,4X,'PHONE : ',4A5)
	GOTO 4950
4115    TYPE 4117,NET,HST1,NOD1,KHST,SLOT,VER,PROD,YN(PRO),YN(T40),
     1  COV,CNAM,LOC,SITC,SITP,CIRCKT,TROUB1,TECH,STH,EHR,PORT,SRGN,
     2  HRGN
4117    FORMAT(/1X,'NETWORK : ',A10,3X,'HOST : ',I6,3X,'NODE : ',I5,
     1  3X,'KERNAL : ',I5,3X,'SLOT : ',A2,/1X,'VERSION : ',A5,3X,
     2  'PRODUCT : ',A5,3X,'PRODUCTION : ',A3,3X,'T40 : ',A3,3X,
     3  'COVERAGE : ',A2,/1X,'CUSTOMER : ',3A5,3X,'LOCATION : ',4A5,/1X,
     4  'SITE CONTACT : '4A5,3X,'PHONE : ',4A5,/1X,'CIRCUIT : ',4A5,3X,
     5  'TELCO # : ',4A5,/1X,'TECH : ',3A5,3X,'SITE HOURS : ',A5,' TO ',
     6  A5,4X,'PORTS : ',I3,/1X,'SOFTWARE DIST.: ',A5,4X,'HARDWARE ',
     7  'DIST.: ',A5)
	GOTO 4950
C
C       LIST OPERATIONAL TICKETS ONLY
C
4120    TYPE 4122
4122    FORMAT(/1X,'OPERATIONAL TICKET LISTER...',/,/)
	CALL DBOPEN(BASE(1))
	CALL DBFIND(15,1,'OPEN','OR',15,1,'MONIT')
	CALL DBNREC(NUMBER)
	IF (NUMBER.EQ.0) GOTO 4124
	TYPE 772,NUMBER
	GOTO 773
4124    TYPE 810
	GOTO 4950
C
C       SET P = 1 FOR SINGLE RECORDS THEN GOTO GETREC
C
4103    P=1
	GOTO 4104
C
C*********************************************
C
C       ADD SPECIAL COMMENT
C
C*********************************************
C
4125    TYPE 4127
4127    FORMAT(1X,'ROUTINE TO ADD SPECIAL COMMENT ...')
	TYPE 3975
	CALL DBOPEN(BASE(10))
4129    ACCEPT 65,WELL
	CALL HISET(WELL)
	IF ((WELL.EQ.'N').OR.(WELL.EQ.'H')) GOTO 4134
	IF (WELL.EQ.'C') GOTO 4140
	TYPE 3975
	GOTO 4129
4134    IF (FLAG.GT.0) GOTO 4136
4135    TYPE 110
	ACCEPT 120,K
	IF ((K.GE.1).AND.(K.LE.NUMNET)) GOTO 4137
	CALL HLPNET
	GOTO 4135
4136    K=FLAG
	GOTO 4137
4140    TYPE 203,OCKT
	ACCEPT 100,CKT
	CALL UPCASE(CKT)
	IF (CKT(1).EQ.'     ') GOTO 59
	TYPE 3983
	NODE=0
	HOST=0
	CALL DBFIND(7,1,CKT)
	GOTO 4145
4137    IF (WELL.EQ.'N') GOTO 4142
	CALL GPNUM(HO,HOST)
	NODE=0
	ENCODE(20,214,CKT)
	CALL DBFIND(3,1,VNET(K),1,6,1,HOST)
	GOTO 4145
4142    CALL GPNUM(NO,NODE)
	HOST=0
	ENCODE(20,214,CKT)
	CALL DBFIND(3,1,VNET(K),1,4,1,NODE)
4145    CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) TYPE 3987
	IF (NUMBER.LE.0) TYPE 3985
	TYPE 4146
4146    FORMAT(1X,'ENTER YOUR ONE LINE SPECIAL COMMENT (80 CHARS.',
     1  ' MAX)',/)
	ACCEPT 4148,LIN1
4148    FORMAT(16A5)
	IF ((LIN1(1).EQ.'     ').AND.(LIN1(2).EQ.'     ')) GOTO 4950
	CALL DBSYSV(1,0,SDAT)
	IF (NUMBER.EQ.0) GOTO 4152
	CALL DBERR($4155,IERT,IERC,0)
	GOTO 4156
4155    IF (IERT.NE.7) GOTO 4955
	TYPE 1379
	CALL WAIT(7.0)
4156    CALL DBOPEN(BASE(10))
	CALL DBUPD(-1)
	IF (WELL.EQ.'N') CALL DBFIND(3,1,VNET(K),1,4,1,NODE)
	IF (WELL.EQ.'H') CALL DBFIND(3,1,VNET(K),1,6,1,HOST)
	IF (WELL.EQ.'C') CALL DBFIND(7,1,CKT)
	CALL DBCHNG(27,LIN1,28,UNAM,29,SDAT,30,ME)
	GOTO 4158
4152    CALL DBERR($4153,IERT,IERC,0)
	GOTO 4154
4153    IF (IERT.NE.7) GOTO 4955
	TYPE 1379
	CALL WAIT (7.0)
4154    CALL DBOPEN(BASE(10))
	CALL DBUPD(-1)
	CALL DBADD(3,VNET(K),4,NODE,13,1,17,WELL,23,1,6,HOST,7,CKT,
     1  24,UNAM,20,ME,27,LIN1,28,UNAM,29,SDAT,30,ME,31,F1)
4158    CALL DBCLOS
	CALL DBERR($4930,IERT,IERC,0)
	GOTO 59
C
C++++++++++++++++++++++++++++++++++++++++++++
C
C       ROTUINE TO CLOSED TICKETS THAT HAVE BEEN ON MONITOR
C       FOR MORE THAN 24 HOURS.
C
C++++++++++++++++++++++++++++++++++++++++++++
C
4175    TYPE 4180
4180    FORMAT(/1X,'ROTUINE TO CLOSED OUT TICKETS THAT HAVE ',
     1  'ON MONITOR MORE THAN 24 HOURS.',/,/)
	CALL DBERR($4176,IERT,IERC,0)
	GOTO 4177
4176    IF (IERT.NE.7) GOTO 4930
	TYPE 1379
	CALL WAIT(6.0)
4177    CALL DBOPEN(BASE(1),BASE(2))
	CALL DBSET(2)
	CALL DBUPD(-1)
	CALL DBSET(1)
	CALL DBUPD(-1)
	CALL RTIM(TCLSD,CLSD)
	CALL DBFIND(5,'LT',CLSD,1,15,1,'MONIT')
	CALL DBNREC(NUMBER)
	IF (NUMBER.EQ.0) GOTO 4195
	DO 4190 I=1,NUMBER
	CALL DBGREC($4195,I)
	CALL DBVAL(49,SDAT,50,TIM1,1,TNUM,'ESC',ESC)
	TYPE 4182,TNUM
4182    FORMAT(2X,'TIC # ',I8,T21,$)
	ELM=0
	CALL MTTR(SDAT,CLSD,TIM1,TCLSD,ELM,HOUR)
	TYPE 4183,HOUR
4183    FORMAT('+',F7.1,T28,$)
	IF (ELM.LT.1440) GOTO 4188
	CALL DBCHNG(15,'CLSD',26,CLSD,27,TCLSD)
	IF (ESC.EQ.2) CALL DBCHNG('ESC',3)
	TYPE 4184
4184    FORMAT('+','CLOSED',3X,$)
	CALL DBSET(2)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(ORDER)
	ORDER=ORDER+1
	ENCODE(320,4178,INFO)HOUR
4178    FORMAT('TICKET CLOSED AFTER BEING ON MONITOR FOR ',F5.1,
     1  ' HOURS.',27X,1H.,5X)
	CALL DBADD(1,TNUM,2,CLSD,3,TCLSD,4,ME,5,7,6,'CLSD',7,INFO,
     1  8,UNAM,9,ORDER,10,0)
	TYPE 4179
4179    FORMAT('+','STATUS ADDED')
	CALL DBSET(1)
	GOTO 4190
4188    TYPE 4189
4189    FORMAT('+','MONIT')
4190    CONTINUE
	GOTO 4197
4195    TYPE 4196
4196    FORMAT(/3X,'THERE ARE NO TICKETS TO CLOSED BY THIS CRITERIA')
4197    CALL DBCLOS
	CALL DBCLOS
	ENCODE(320,233,INFO)
	GOTO 59
C
C       CHECK FOR TICKETS OVER TO THE CUSTOMER
C
4200    CALL DBOPEN(BASE(1))
	CALL DBFIND(51,1,'CUSTM',1,9,1,VNET(FLAG))
	CALL DBNREC(NUMBER)
	P=42
	IF (NUMBER.GT.0) GOTO 2597
	TYPE 4202,VNET(FLAG)
4202    FORMAT(/1X,'THERE ARE NO TICKETS OVER TO THE CUSTOMER FOR ',
     1  A10,1H.,/,/5X,'THANK YOU FOR CHECKING.')
	GOTO 4950
C
C***************************************
C
C       ROUTINE TO POST ARRIVED TIME
C
C***************************************
4210    TYPE 4211
4211    FORMAT(1X,'ROUTINE TO POST ARRIVAL AT THE SITE...',/)
	TYPE 170,TIC
4212    ACCEPT 120,TNUM
	IF (TNUM.EQ.0) GOTO 59
	CALL GTIM(TIM1,SDAT,LIC)
	CALL DBERR($4215,IERT,IERC,0)
	GOTO 4217
4215    IF (IERT.NE.7) GOTO 4955
	TYPE 1379
	CALL WAIT(7.0)
4217    CALL DBOPEN(BASE(6))
	CALL DBUPD(-1)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.EQ.0) GOTO 4225
	CALL DBGREC($4210,NUMBER)
	CALL DBVAL(8,MAINT,15,ADAT)
	IF ((MAINT.LT.ATTN(LO)).OR.(MAINT.GT.ATTN(HO1)))GOTO 4228
	IF (ADAT.GT.0) GOTO 8022
	CALL DBCHNG(15,SDAT,16,TIM1)
	CALL DBCLOS
	TYPE 4224
4224    FORMAT(5X,'THANK YOU...')
	GOTO 59
8022    CALL DBVAL(1,TNUM,2,TDAT,3,TTIM,4,NDAT,5,NTIM,6,RS,7,STAT,
     1  8,MAINT,9,ELM,10,NET,11,SVER,12,PROB,13,COC,14,WHO,17,ZONE,
     2  18,AELM)
	CALL DBADD(1,TNUM,2,TDAT,3,TTIM,4,NDAT,5,NTIM,6,RS,7,STAT,
     1  8,MAINT,9,ELM,10,NET,11,SVER,12,PROB,13,COC,14,WHO,15,SDAT,
     2  16,TIM1,17,ZONE,18,AELM)
	TYPE 4224
	GOTO 59
4225    TYPE 4226
4226    FORMAT(/3X,'THERE ARE NO RECORDS FOR TICKET # ',I8,/)
	TYPE 170,TIC
	GOTO 4212
4228    TYPE 4229,MAINT
4229    FORMAT(/3X,'YOU DO NOT HAVE ATHORIZATION TO POST ARRIVAL FOR ',
     1  A5,1H.,/2X,'IF YOU FEEL THIS IS IN ERROR, PLEASE CALL A TYMNET',
     2  /2X,'CONTROL GROUP',/2X,'THANK YOU...')
	CALL DBCLOS
	GOTO 59
C
C
C       ROUTINE TO HANDLE THE CALBAK LOG ENTRIES
C
4235    TYPE 170,TIC
	CALL RTIM(TIM1,SDAT)
4236    ACCEPT 120,TNUM
	IF (TNUM.EQ.0) GOTO 4950
4238    CALL DBOPEN(BASE(8))
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 4240
	TYPE 4237,TNUM
4237    FORMAT(1X,'TICKET NUMBER ',I8,' COULD NOT BE FOUND')
	TYPE 170,TIC
	GOTO 4236
4240    CALL DBSRCH(9,1,0)
	CALL DBNREC(RECORD)
	IF (RECORD.GT.0) GOTO 4241
	TYPE 4243,TNUM
4243    FORMAT(1X,'ALL CALL BACKS HAVE BEEN MADE FOR TICKET # ',I8)
	GOTO 4950
4241    CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	TYPE 714
	DO 4248 I=1,NUMBER
	CALL DBGREC($4950,I)
	CALL DBVAL(4,RNAM,7,SITC,8,SITP,13,CHEX,9,K)
	IF (K.GT.0) GOTO 4248
	TYPE 4242,I,RNAM,SITC,SITP,CHEX
4242    FORMAT(1X,I3,1X,4A5,T27,4A5,T52,4A5,2X,A1)
4248    CONTINUE
4247    TYPE 4249
4249    FORMAT(/2X,'WHICH RECORD NUMBER PRECEEDS THE COMPANY CALLED',
     1  ' BACK : ',$)
	ACCEPT 120,K
	IF ((K.GE.1).AND.(K.LE.NUMBER)) GOTO 4250
	IF (K.EQ.0) GOTO 4950
	GOTO 4247
4250    TYPE 170,SC
	ACCEPT 100,REPF
	CALL DBERR($4252,IERT,IERC,0)
	GOTO 4253
4252    IF (IERT.NE.7) GOTO 4930
	TYPE 1379
	CALL WAIT(5.0)
4253    CALL DBOPEN(BASE(8))
	CALL DBUPD(-1)
	CALL DBFIND(1,1,TNUM)
	CALL DBGREC($4950,K)
	CALL DBCHNG(9,SDAT,10,TIM1,11,ME,12,REPF,13,'*')
	CALL DBUPD(0)
	CALL STBKCL(TNUM,SITC,REPF,ME,TIM1,SDAT)
	TYPE 4255
4255    FORMAT(1X,'ARE THERE MORE CALL BACKS TO MAKE (Y OR N) ? ',$)
	ACCEPT 65,SEE
	CALL HISET(SEE)
	IF (SEE.EQ.'Y') GOTO 4238
	GOTO 59
C
C
C       ROUTINE TO LIST ALL ATTR'S FOR CALBAK LOG
C
4260    TYPE 170,TIC
	CALL DBOPEN(BASE(8))
4262    ACCEPT 120,TNUM
	IF (TNUM.EQ.0) GOTO 4950
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 4265
	TYPE 4263,TNUM
4263    FORMAT(3X,'CHECKING OLD DATA BASE FOR TICKET # ',I8)
	CALL DBOPEN(BASE(9))
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 4265
	TYPE 4264
4264    FORMAT(1X,'NO CALL BACKS EXIST FOR TICKET # ; ',I8)
	GOTO 4950
4265    TYPE 4267
4267    FORMAT(1X,'COMPANY',T23,'PERSON',T44,'PHONE #',T66,'DATE',
     1  9X,'SR',/6X,'NOTIFIED',T31,'REP.',T38,'DATE',/)
	RECORD=0
	DO 4270 I=1,NUMBER
	CALL DBGREC($4950,I)
	CALL DBVAL(2,SDAT,3,TIM1,4,RNAM,5,WHO,7,SITC,8,SITP,9,DUP,
     1  10,TUP,11,CBY,12,CBAK)
	CALL DBNDAT(SDAT,SM,SD,SY)
	TYPE 4268,RNAM,SITC,SITP,SM,SD,TIM1,WHO
4268    FORMAT(1X,4A5,1X,4A5,1X,4A5,1X,I2,1H/,I2,2X,A5,2X,A3)
	IF (DUP.EQ.0) GOTO 4266
	CALL DBNDAT(DUP,SM,SD,SY)
	TYPE 4269,CBAK,CBY,SM,SD,TUP
4269    FORMAT(6X,4A5,4X,A3,4X,I2,1H/,I2,2X,A5)
	GOTO 4270
4266    RECORD=RECORD+1
4270    CONTINUE
	IF (RECORD.EQ.0) GOTO 4950
	TYPE 4272,RECORD,TNUM
4272    FORMAT(/2X,I2,' CALL BACKS NEED TO BE MADE FOR TICKET # ',I8,
     1  /2X,'DO YOU WISH TO CHECK OF ANY OF THE REMAINING CALL BACKS ',
     2  '(Y OR N) ?',$)
	ACCEPT 65,SEE
	CALL HISET(SEE)
	IF (SEE.EQ.'Y') GOTO 4238
	GOTO 4950
C
C       ROUTINE TO SET TIME UP IN BASE1 ONLY
C
4275    TYPE 4277,BASE(1)
4277    FORMAT(/1X,'SETTING TIME UP IN ',A10)
	CALL DBERR($4280,IERT,IERC,0)
	GOTO 4281
4280    IF (IERT.NE.7) GOTO 4930
	TYPE 1379
	CALL WAIT(7.0)
4281    CALL DBOPEN(BASE(1))
	CALL DBUPD(-1)
	CALL DBFIND(1,1,TNUM)
	CALL DBGREC($4955,1)
	call dbval(52,SVER)
	CALL DBCHNG(49,SDAT,50,TIM1,'ELM',0)
	CALL DBCLOS
	CALL DBERR($4950,IERT,IERC,0)
	IF (SVER.EQ.1) GOTO 4700
	GOTO 59
C
C****************************************
C
C       SPECIAL ROUTINE TO LIST TICKETS EVERY 15 MINUTES
C       TO SEE WHICH SVER ONES AND TWOS WHICH NEED TO BE
C       ESCALATED
C
C****************************************
C
4285    CALL DBOPEN(BASE(1))
	CALL DBFIND(52,1,1)
	CALL DBSRCH(49,1,0)
	CALL DBNREC(NUMBER)
	IF (NUMBER.EQ.0) GOTO 4290
	DO 4288 I=1,NUMBER
	CALL DBGREC($4950,I)
	CALL DBVAL(5,SDAT,6,TIM1,49,DUP,50,TUP,1,TNUM,9,NET,14,PROD,
     1  54,ELM,35,V6,'CNAM',CNAM,'HH',HH)
	CALL DBNDAT(SDAT,SM,SD,SY)
	CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
	HOUR=HOUR-V6
	IF (HOUR.GT.5.0) TYPE 4286,NET,TNUM,PROD,SM,SD,HOUR,CNAM,
     1  NETOP(HH)
4286    FORMAT(1X,A10,1X,I6,1X,A5,1X,I2,1H/,I2,1X,F5.2,2X,3A5,2X,A5)
4288    CONTINUE
	CALL WAIT(900.0)
	GOTO 4285
4290    TYPE 4291
4291    FORMAT(13X,'-1')
	GOTO 4288
C
C*********************************************
C
C       LIST TICKETS REFERED AND THEIR TIMES
C
C*********************************************
C
4300    I=1
C       PRINT K HEADER QUESTION
	TYPE 2592
4301    ACCEPT 120,P
	IF ((P.GE.1).AND.(P.LE.NATTN)) GOTO 4305
	IF ((P.EQ.0).OR.(I.EQ.3)) CALL HREFR
	IF (I.EQ.3) GOTO 59
	I=I+1
	GOTO 4301
4305    CALL DBERR($4304,IERT,IERC,0)
	GOTO 4303
4304    IF (IERT.NE.7) GOTO 4930
	TYPE 1379
	CALL WAIT(6.0)
4303    CALL DBOPEN(BASE(6),BASE(6))
	CALL DBUPD(-1)
	CALL DBFIND('MAINT',1,ATTN(P),1,'RS',1,0)
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 4310
C       NO TICKETS OVER TO THIS GROUP OUTPUT SAME AND GOTO MAIN
C       PROMPT
	TYPE 2596,ATTN(P)
	GOTO 4950
4310    TYPE 774,NUMBER,ATTN(P)
774     FORMAT(/3X,'THERE ARE ',I3,' TICKETS OVER TO ',A5,/,/)
	TYPE 4302
4302    FORMAT(/2X,'TNUM'2X,'PROD.',1X,'S',1X,'STAT',2X,'DATE/TIME',
     1  6X,'ARIVE TIME',T52,'POSS.',/)
	DO 4320 I=1,NUMBER
	CALL DBGREC($4930,I)
	CALL DBVAL(1,TNUM,2,SDAT,3,TIM1,4,DUP,5,TUP,7,STAT,9,ELM,11,
     1  SVER,12,PROD,15,ADAT,16,ATIM)
	CALL DBSET(2)
	CALL DBFIND(1,1,TNUM,1,'RS',1,1)
	CALL DBNREC(RECORD)
	IF (RECORD.GT.0) GOTO 4319
	CALL DBNDAT(SDAT,SM,SD,SY)
	CALL DBSET(1)
	IF (UNAM(1).EQ.'TECHS') CALL DBCHNG(6,1)
	IF (ADAT.GT.0) GOTO 4312
	EM=0
	ED=0
	GOTO 4314
4312    CALL DBNDAT(ADAT,EM,ED,EY)
4314    CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
	IF (ATIM.EQ.0) ATIM='.....'
	TYPE 4315,TNUM,PROD,SVER,STAT,SM,SD,TIM1,EM,ED,ATIM,HOUR
4315    FORMAT(1X,I6,1X,A5,1X,I1,1X,A5,1X,I2,1H-,I2,2H @,A5,2HZ ,
     1  I2,1H-,I2,2H @,A5,2HZ ,T52,F6.1)
	GOTO 4320
4319    CALL DBSET(1)
4320    CONTINUE
	GOTO 4950
4330    CALL GETDES(HQCC,ONUM)
	CALL DBERR($4331,IERT,IERC,0)
	GOTO 4332
4331    IF (IERT.NE.7) GOTO 4930
	TYPE 1379
	CALL WAIT(6.0)
4332    CALL DBOPEN(BASE(1))
	CALL DBUPD(-1)
	CALL DBFIND(1,1,TNUM)
	CALL DBCHNG(18,HQCC,46,3,19,ONUM)
	CALL DBCLOS
	CALL DBERR($4930,IERT,IERC,0)
	GOTO 235
C
C       CHECK TO SEE IF A PERIOD IS THE FIRST AND ONLY OF THE FIRST
C       FIVE CHARACTERS ON A LINE  IF SO END THE INPUT, ELSE GOTO 219
C       AND ACCEPT MORE LINES OF STATUS
C

4335    CALL GTIM(TIM1,SDAT,LIC)
	LONG=1
	RS=0
4337    TYPE 220,ST
	CALL GETINF(INFO,4,NLINE)
	CALL CSTAT(INFO,TRASH,Z,TNUM)
	IF (TRASH.NE.' ') GOTO 4337
	IF ((INFO(N).EQ.'.    ').AND.(NLINE.EQ.0)) GOTO 4343
4340    CALL DBERR($4341,IERT,IERC,0)
	GOTO 4342
4341    IF (IERT.NE.7) GOTO 4930
	TYPE 1379
	CALL WAIT(6.0)
4342    CALL DBOPEN(BASE(2))
	CALL DBUPD(-1)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(ORDER)
	ORDER=ORDER+1
	CALL DBADD(1,TNUM,2,SDAT,3,TIM1,4,ME,5,RS,6,STAT,7,INFO,
     1  8,UNAM,9,ORDER)
	CALL DBCLOS
	CALL DBERR($4930,IERT,IERC,0)
	N=(NLINE*16)-15
4336    FORMAT(/3X,'DATA = "',A5,1H",4X,'NLIE=',I2,3X,'N=',I3,/)
	IF (INFO(N).EQ.'.    ') GOTO 4343
	ENCODE(320,233,INFO)
	GOTO 4337
4343    ENCODE(320,233,INFO)
	IF (LOATTN.EQ.0) GOTO 59
	GOTO 235
C
C       ROUTINE TO ADD A RECORD THAT THE TICKET WAS TRANSFERED
C
4345    TYPE 170,TIC
	CALL DBOPEN(BASE(1))
	ACCEPT 120,TNUM
	IF (TNUM.EQ.0) GOTO 59
	CALL RTIM(TIM1,SDAT)
	N=1
C
C       GOTO CHANGE MAINT ROUTINE AND THEN COME BACK HERE
C
	GOTO 2378
4350    CALL GETC(6,UNAM,PCE)
	IF (PCE.EQ."040) GOTO 4351
	CALL GETC(11,UNAM,PCE)
	IF (PCE.EQ."040) GOTO 4354
	ENCODE(170,4355,INFO)UNAM,ME,MAINT,ATTN(M),CCC,CODE(CCC)
4355    FORMAT(3A5,1H(,A3,1H),' TRANSFERRED THIS TICKET FROM ',A5,
     1  ' TO ',A5,1H.,15X,'RESOLUTION CODE IS CURRENTLY SET TO ',
     2  I3,2X,A10,29X,'.',5X)
4352    FORMAT(1X,'ADDING A STATUS THAT THIS TICKET WAS TRANSFERRED',
     1  ' FROM ',A5,' TO ',A5,1H.,$)
	GOTO 4358
4351    ENCODE(170,4353,INFO)UNAM(1),ME,MAINT,ATTN(M),CCC,CODE(CCC)
4353    FORMAT(A5,1H(,A3,1H),' TRANSFERRED THIS TICKET FROM ',A5,
     1  ' TO ',A5,1H.,25X,'RESOLUTION CODE IS CURRENTLY SET TO ',
     2  I3,2X,A10,29X,'.',5X)
	GOTO 4358
4354    ENCODE(170,4360,INFO)UNAM(1),UNAM(2),ME,MAINT,ATTN(M),
     1  CCC,CODE(CCC)
4360    FORMAT(A5,A5,1H(,A3,1H),' TRANSFERRED THIS TICKET FROM ',A5,
     1  ' TO ',A5,1H.,20X,'RESOLUTION CODE IS CURRENTLY SET TO ',
     2  I3,2X,A10,29X,'.',5X)
4358    TYPE 4352,MAINT,ATTN(M)
	CALL DBERR($4356,IERT,IERC,0)
	GOTO 4357
4356    IF (IERT.NE.7) GOTO 4930
	TYPE 1379
	CALL WAIT(6.0)
4357    CALL DBOPEN(BASE(2))
	CALL DBUPD(-1)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	ORDER=NUMBER+1
	CALL DBADD(1,TNUM,2,SDAT,3,TIM1,4,ME,5,5,6,STAT,7,INFO,8,UNAM,
     1  9,ORDER,10,0)
	CALL DBCLOS
	ENCODE(95,933,INFO)
	GOTO 59
C
C       RESET TNUM BACK TO ORIGINAL VALUE
C
4365    TNUM=NUM1
	DUP=TDAT
	ELM=TET
	TUP=TIM2
	GOTO 222
C
C
C       ROUTINE TO FIND A TICKET NUMBER WHERE EVER IT IS, THEN
C       REPORT BACK THAT IT WAS FOUND
C
C
4370    TYPE 4375
4375    FORMAT(1X,'ROUTINE TO FIND A TICKET NUMBER IN ALL THE DATA',
     1  ' BASES',/)
	TYPE 170,TIC
	CALL DBOPEN(BASE(1))
	ACCEPT 120,TNUM
	TYPE 4377,BASE(1)
4377    FORMAT(1X,'SEARCHING ',A10,T40,$)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	TYPE 4379,NUMBER
4379    FORMAT('+',I3,' RECORDS FOUND')
	TYPE 4377,BASE(2)
	CALL DBOPEN(BASE(2))
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	TYPE 4379,NUMBER
	TYPE 4377,BASE(6)
	CALL DBOPEN(BASE(6))
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	TYPE 4379,NUMBER
	TYPE 4377,BASE(8)
	CALL DBOPEN(BASE(8))
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	TYPE 4379,NUMBER
	TYPE 4377,BASE(4)
	CALL DBOPEN(BASE(4))
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	TYPE 4379,NUMBER
	TYPE 4377,BASE(5)
	CALL DBOPEN(BASE(5))
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	TYPE 4379,NUMBER
	TYPE 4377,BASE(7)
	CALL DBOPEN(BASE(7))
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	TYPE 4379,NUMBER
	TYPE 4377,BASE(9)
	CALL DBOPEN(BASE(9))
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	TYPE 4379,NUMBER
	H2=TNUM/10000
	IF (H2.GT.9) GOTO 4381
	ENCODE(10,661,BASE(11))H2
	ENCODE(10,662,BASE(12))H2
	ENCODE(10,663,BASE(13))H2
	GOTO 4383
4381    ENCODE(10,301,BASE(11))H2
	ENCODE(10,302,BASE(12))H2
	ENCODE(10,303,BASE(13))H2
4383    TYPE 4377,BASE(11)
	CALL DBOPEN(BASE(11))
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	TYPE 4379,NUMBER
	TYPE 4377,BASE(12)
	CALL DBOPEN(BASE(12))
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	TYPE 4379,NUMBER
	TYPE 4377,BASE(13)
	CALL DBOPEN(BASE(13))
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	TYPE 4379,NUMBER
	TYPE 4385,TNUM
4385    FORMAT(/3X,'SEARCH FOR TICKET NUMBER ',I8,' COMPLETE',/)
	GOTO 4950
C
C*************************************************
C
C       ROUTINE TO LIST A TICKET NUMBER AND THE STATUSES
C       FOR A TIME PERIOD
C
C*************************************************
C
4395    TYPE 4397
4397    FORMAT(2X,'ENTER THE DATE TO LIST STATUSES FROM (MM/DD/YYYY)',
     1  ' : ',$)
84397        CALL DBSYSV(1,0,SDAT)
	ACCEPT 1160,IM,ID,IY
	IF (IM.NE.0) CALL DBDATN(NDATE,IM,ID,IY)
	IF (IM.EQ.0) NDATE=SDAT-1
	TYPE 4396
4396    FORMAT('+',2X,'OUTPUT TO FILE OR TERMINAL (TERM) : ',$)
	ACCEPT 65,ANS
	CALL HISET(ANS)
	IF (ANS.EQ.'     ') GOTO 4401
	IF ((ANS.GE.'F').AND.(ANS.LE.'FILE')) GOTO 4398
	GOTO 84397
C	^^^^^^^^^^ used to say 'GOTO 4397' a format statement.

4398    ENCODE(15,4400,FILE)NDATE
	TYPE 4406,FILE
4406    FORMAT(' ENTER FILE NAME (15 CHAR. MAX) (',A10,') : ',$)
	ACCEPT 4403,FILE
4403    FORMAT(A10)
	IF (FILE.EQ.'          ') ENCODE(15,4400,FILE)NDATE
4400    FORMAT(I5,'.OUT',6X)
	OPEN(unit=8,device='DSK',access='SEQOUT',file=FILE)
4401    DO 4420 I=1,NUMBER
	CALL DBGREC($4405,I)
	CALL DBVAL(1,TNUM)
	IF(ANS.NE.'     ')WRITE(8,4404)FF,TNUM
	IF (ANS.EQ.'     ')TYPE 4404,FF,TNUM
4404    FORMAT(/,A5,/,/,3X,'TICKET NUMBER : ',I6)
	CALL DBSET(2)
	CALL DBFIND(1,1,TNUM)
	CALL DBSRCH(2,'GE',NDATE)
	CALL DBNREC(RECORD)
	IF (RECORD.GT.0) GOTO 4405
	IF(ANS.NE.'     ')WRITE (8,4402)IM,ID,IY,TNUM
	IF (ANS.EQ.'     ')TYPE 4402,IM,ID,IY,TNUM
4402    FORMAT(///,T9,'NO STATUSES ENTERED ON OR AFTER ',I2,1H/,I2,
     1  1H/,I4,' FOR TICKET NUMBER ',I6)
	CALL DBSET(1)
	GOTO 4420
4405    DO 4416 J=1,RECORD
	CALL DBGREC($4416,J)
	CALL DBVAL(1,TNUM,2,SDAT,3,TIM1,4,INT,5,RS,7,INFO,8,PNAM,
     1  9,ORDER)
	CALL DBNDAT(SDAT,SM,SD,SY)
	SY=SY-1900
	IF(ANS.NE.'     ')WRITE(8,380)ORDER,PNAM,INT,SD,AM(SM),
     1  SY,TIM1,AS(RS)
	IF (ANS.EQ.'     ')TYPE 380,ORDER,PNAM,INT,SD,AM(SM),SY,TIM1,
     1  AS(RS)
	IF (ANS.NE.'     ') GOTO 4415
4413    CALL TYPINF(INFO,4)
4415    CALL WRTINF(INFO,4)
4416    CONTINUE
	CALL DBSET(1)
4420    CONTINUE
	CLOSE(unit=8)
	TYPE 3651,FILE
	GOTO 4950
C***************************************
C
C       ROUTINE TO LIST NEW STATUSES EVERY 10 MINUTES. THAT WAY WE CAN
C       STAY ON TOP OF WHAT IS BEING WORKED ON.
C
C***************************************
4490    TYPE 4495
4495    FORMAT(/5X,'LISTER OF NEW STATUSES ADDED EVERY FIVE MINUTES',/)
	BB=0
	CALL DBOPEN(BASE(2))
	CALL DBFIND('ALL')
	CALL DBNREC(BB)
	CALL WAIT(60.0)
4500    CALL DBOPEN(BASE(2))
	CALL DBFIND('ALL')
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.BB) GOTO 4505
	IF (NUMBER.LT.BB) BB=NUMBER
	TYPE 4502,YY(2)
4502    FORMAT('+',A1,$)
	CALL WAIT(300.0)
	GOTO 4500
4505    DO 4520 I=BB+1,NUMBER
	CALL DBGREC($4950,I)
	CALL DBVAL(1,TNUM,2,SDAT,3,TIM1,4,INT,5,RS,6,STAT,7,INFO,8,
     1  PNAM,9,ORDER)
	CALL DBNDAT(SDAT,IM,ID,IY)
	IY=IY-1900
	TYPE 700,ORDER,PNAM,INT,ID,AM(IM),IY,TIM1,AS(RS),TNUM
	CALL TYPINF(INFO,4)
	CALL WAIT(3.0)
4520    CONTINUE
	TYPE 3239
	TYPE 4502,YY(2)
	BB=NUMBER
	CALL WAIT(300.0)
	GOTO 4500
C
C       ROUTINE TO LIST TICKETS IN A MODIFIED FORMAT
C
4595    TYPE 4597
4597    FORMAT(/1X,'ROUTINE TO LIST THE TICKETS IN A CUSTOMER FORMAT')
	I=1
	TYPE 2592
	CALL DBOPEN(BASE(1),BASE(2))
4888    ACCEPT 120,P
	IF ((P.GE.1).AND.(P.LE.NATTN)) GOTO 4900
	IF ((P.EQ.0).OR.(I.EQ.3)) CALL HREFR
	IF (I.EQ.3) TYPE 2592
	I=I+1
	TYPE 2592
	GOTO 4888
4900    CALL DBFIND('MAINT',1,ATTN(P),1,15,'NE','CLSD')
	CALL DBNREC(NUMBER)
	IF (NUMBER.GT.0) GOTO 4910
	TYPE 2596,ATTN(P)
	GOTO 4950
4910    TYPE 4912,NUMBER,ATTN(P)
4912    FORMAT(/3X,'THERE ARE ',I3,' TICKETS OVER TO ',A5,1H.,//1X,
     1  2X,'TIC# DATE  SVER PROD   NODE  HOST COMM. SP.',7X,
     2  'CUSTOMER'8X,'CON.GRP.ODUE',/)
	DVER(1)=120
	DVER(2)=240
	DVER(3)=720
	DVER(4)=1440
	DO 4920 I=1,NUMBER
	CALL DBGREC($4950,I)
	DUP=0
	TUP=0
	ELM=0.0
	CALL DBVAL(1,TNUM,'SDAT',SDAT,'SVER',SVER,'PROD',PROD,'NODE',
     1  NODE,'HOST',HOST,'TECH',TECH,'CNAM',CNAM,'HN',HN,'TIME',TIM1)
	CALL DBNDAT(SDAT,IM,ID,IY)
	CALL DBSET(2)
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(RECORD)
	IF (RECORD.EQ.0) GOTO 4914
	CALL DBGREC($4914,RECORD)
	CALL DBVAL(2,SDAT,3,TIM1,'UNAM',PNAM)
	IF ((PNAM(1).EQ.'NETCO').OR.(PNAM(1).EQ.'NSSC').OR.
     1  (PNAM(1).EQ.'NCF').OR.(PNAM(1).EQ.'CSS80')) GOTO 4913
	GOTO 4914
4913    IF (RECORD-1.LT.1) GOTO 4914
	CALL DBGREC($4920,RECORD-1)
	CALL DBVAL(2,SDAT,3,TIM1)
4914    CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
	HOUR=(ELM-DVER(SVER))/60.0
	TYPE 4915,TNUM,IM,ID,SVER,PROD,NODE,HOST,TECH,CNAM,NETOP(HN),
     1  HOUR
4915    FORMAT(1X,I6,1X,I2,1H/,I2,3X,I1,2X,A5,1X,I5,1X,I5,1X,3A5,1X,
     1  3A5,1X,A5,1X,F6.1)
	CALL DBSET(1)
4920    CONTINUE
	GOTO 4950
C
C***********************************************
C
C       AUTO UPDATE ROUTINE FOR SEV 1
C       TICKETS.
C
C***********************************************
4601    GOTO 4600
4602    TYPE 4603
4603    FORMAT(/1X,'WAITING 15 MINUTES')
	CALL WAIT(900.0)
	GOTO 4601
C
c********************************************
c
c       routine to print ticket info for those
c       tickets which the customer needs an update
c       within 2 hours.
c
c********************************************
4600            type 4605
4605    FORMAT(/1X,'OPENING DATA BASE TO GET TICKETS ',
     1  'WHICH NEED A STATUS CALL BACK',/)
	        call DBOPEN(BASE(16),BASE(2))
	        call dbset(1)
	        call fgmt(ia1,ia2,ia3,ia4,ia5,ia6)
	IA3=IA3+1900
	IF (IA5.LE.9) ENCODE(5,4609,TIM1)IA4,IA5
	        encode(5,4613,tim1)ia4,ia5
4609            FORMAT(I2,':0',I1)
4613            format(i2,':'i2)
	        call dbdatn(sdat,ia1,ia2,ia3)
	CALL DBFIND(12,1,0,1,5,3,SDAT,1,7,1,CG)
	CALL DBNREC(NUMBER)
	IF (NUMBER.LT.1) GOTO 94615
	DO 94610 I=1,NUMBER
	CALL DBGREC($94610,I)
	CALL DBCHNG(5,SDAT,4,' 0:00')
94610   CONTINUE
94615   CALL DBFIND(12,1,0,1,4,'LE',TIM1,1,5,1,SDAT,1,7,1,CG)
	        call dbnrec(number)
	        if (number.gt.0) goto 4615
	        type 4610
4610    format(/3x,'no tickets to status',/)
	IF (ANS.EQ.'CBACK') GOTO 4602
	        goto 4945
4615            type 4612,number
4612            format(/2x,'there are ',i2,' call backs to place')
	        call dbsort(5,4,'ascen')
	        type 4614
4614            format(/1x,'tnum',3x,'company',10x,'contact',15x,
     1  'phone #',11x,'time to call')
	        tnum=0
	M=0
	TOT1=0
	        do 4625 i=1,number
	M=M+1
	        call dbgrec($4625,i)
	        call dbval(1,cnam,2,tnum,3,sitp,4,tim1,5,sdat,15,SITC)
	        type 4620,tnum,cnam,sitc,sitp,tim1
4620            format(1X,I6,1X,3A5,2X,4A5,2X,4A5,2X,A5)
	        tot1=tnum
	        call dbgrec($4616,i+1)
	        call dbval(2,tnum)
	        if (tnum.eq.tot1) goto 4625
4616            call dbset(2)
	        call dbfind(1,1,TOT1)
	        call dbnrec(record)
	        if (record.gt.0) goto 4622
	        type 4621,TOT1,ff
4621            format(2x,'***  no status entries for ticket ',
     1  'number ',i6,/,a5)
	        call dbset(1)
	        goto 4625
4622            x=1
	        if (record.gt.4) x=record-3
	        do 4624 p=x,record
	        call dbgrec($4624,p)
	        call dbval(2,sdat,3,tim1,4,int,5,rs,6,stat,7,
     1  info,8,pnam,9,order)
	        call dbndat(sdat,im,id,iy)
	        iy=iy-1900
	        type 700,order,pnam,int,id,am(im),iy,tim1,as(rs),
     1  tot1
	CALL TYPINF(INFO,4)
4624            continue
	        call dbset(1)
	        type 2084,ff
	TYPE 4614
C       IF (M.LT.NUMBER) TYPE 4614
4625            continue
	IF (ANS.EQ.'CBACK') GOTO 4602
	        goto 4945
c********************************************
c
c       routine to list all call entries
c
c********************************************
c
4635            type 4636
4636            format(/1x,'list all status call back entries')
	        CALL DBOPEN(BASE(16))
	        call dbfind(12,1,0)
	        call dbnrec(number)
	        if (number.gt.0) goto 4638
	        type 4637
4637            format(1x,'*** no entries found ***')
	        call DBCLOS
	        goto 59
4638            type 4639,number
4639            format(5x,i3,' entries found...'//1x,'customer ',
     1  'name',4x,'tnum'4x,'date and time to place call')
	        call dbsort(5,4,1,'ascen')
	        do 4643 i=1,number
	        call dbgrec($4643,i)
	        call dbval(1,cnam,2,tnum,4,tim1,5,sdat)
	        call dbndat(sdat,im,id,iy)
	        type 4640,cnam,tnum,am(im),id,tim1
4640    FORMAT(1X,3A5,2X,I6,2X,A3,'-',I2,2X,A5,'Z')
4643            continue
	        call DBCLOS
	        goto 59
c
c****************************************************
c
c       routine to mark which record was updated for the call
c       status update
c
c****************************************************
c
4675            type 4676
4676            format(1x,'command to mark which people were ',
     1  'called with a status update',/)
	        type 170,tic
	        accept 120,tnum
	        if (tnum.eq.0) goto 59
	        CALL DBOPEN(BASE(16))
	        call dbfind(2,1,tnum,1,12,1,0)
	        call dbnrec(number)
	        if (number.gt.0) goto 4679
	        type 4678,tnum
4678            format(1x,'ticket ',i6,' does not have pending',
     1  ' update calls...')
	        call DBCLOS
	        goto 59
4680            format(1x,'did you call everyone already ? ',$)
4679            CALL FGMT(IA1,IA2,IA3,IA4,IA5,IA6)
	IA3=IA3+1900
	ENCODE(5,4613,TIM1)IA4,IA5
	IF (IA5.LE.9) ENCODE(5,4609,TIM1)IA4,IA5
	        CALL DBDATN(SDAT,IA1,IA2,IA3)
	IF (ANS.EQ.'6U') GOTO 4685
	TYPE 4680
	        accept 65,SEE
	        call hiset(SEE)
	        if (SEE.ne.'Y') goto 4685
	        call dberr($4682,iert,ierc,0)
	        goto 4683
4682            if (iert.ne.7) goto 4955
	        type 1379
	        call wait(5.0)
4683            call dbupd(-1)
	        call dbfind(2,1,tnum,1,12,1,0)
	        call dbchng(9,tim1,10,sdat,11,me,12,2)
	        call dberr($4930,iert,ierc,0)
	        call DBCLOS
	        goto 59
4685            type 4686,number
4686            format(1x,'there are ',i3,' people to call...',
     1  //2x,'selection ',2x,'customer'9x,'person'16x,
     2  'number')
	        do 4690 i=1,number
	        call dbgrec($4690,i)
	        call dbval(1,cnam,15,sitc,3,sitp)
	        type 4687,i,cnam,sitc,sitp
4687            format(5x,i2,5x,3a5,2x,4a5,2x,4a5)
4690            continue
4691            type 4692
4692            format(/2x,'enter selection number : ',$)
4693            accept 120,tot
	IF ((TOT.LT.0).OR.(TOT.GT.NUMBER)) GOTO 4691
	        if (tot.eq.0) goto 4950
4695            type 4696
4696            format(1x'who did you speak to ? ',$)
	        accept 100,repf
	        call dberr($4697,iert,ierc,0)
	        goto 4698
4697            if (iert.ne.7) goto 4955
	        type 1379
	        call wait(5.0)
4698            call dbupd(-1)
	        call dbgrec($4697,tot)
	        call dbchng(9,tim1,10,sdat,11,me,8,repf,
     1  12,2)
	IF (ANS.EQ.'6C') GOTO 4681
	CALL DBVAL(1,CNAM,3,SITP,4,TIM1,5,SDAT,7,CG,15,SITC)
	CALL ATWO(TIM1,SDAT)
	CALL DBADD(1,CNAM,2,TNUM,3,SITP,4,TIM1,5,SDAT,6,0,7,CG,
     1  12,0,15,SITC)
4681            type 4699
4699            format(1x'did you call anyone else ? ',$)
	        accept 65,SEE
	        call hiset(SEE)
	        if (SEE.NE.'Y') GOTO 94699
	CALL DBFIND(2,1,TNUM,1,12,1,0)
	CALL DBNREC(NUMBER)
	GOTO 4685
94699           call dberr($4930,iert,ierc,0)
	CALL DBCLOS
	        goto 59
c
c****************************************************
c
c       routine to add call backs when we set time up
c
c****************************************************
c
4700            call dberr($4701,iert,ierc,0)
	        goto 4702
4701            if (iert.ne.7) goto 4945
	        type 1379
	        call wait(5.0)
4702            CALL DBOPEN(BASE(16))
	        call dbupd(-1)
	        call dbfind(2,1,tnum,1,12,1,0)
	        call dbnrec(number)
	        if (number.eq.0) goto 4720
94720   DO 4720 I=1,NUMBER
	CALL DBGREC($4720,I)
	        call dbchng(9,tim1,10,sdat,11,me,12,2)
4720    CONTINUE
	CALL DBERR($4930,IERT,IERC,0)
	CALL DBCLOS
	        goto 59
c
C
C********************************************
C
C       JUMP HERE TO PLACE CALL BACKS OR OPEN SVER TICKET
C       CALL BACKS HERE
C
C********************************************
C
4710    TYPE 4713
4713    FORMAT(/3X,'ADDING RECORD TO STATUS CALL BACK LIST FOR UP',
     1  'DATE IN TWO HOURS...')
	CALL DBERR($4711,IERT,IERC,0)
	CALL FGMT(IA1,IA2,IA3,IA4,IA5,IA6)
	IA3=IA3+1900
	CALL DBDATN(SDAT,IA1,IA2,IA3)
	IF (IA4+2.GT.23) GOTO 4721
	IA4=IA4+2
	GOTO 4722
4721    TOT=IA4+2
	TOT1=TOT/24
	SDAT=SDAT+TOT1
	IA4=TOT-(TOT1*24)
4722    ENCODE(5,4613,TIM1)IA4,IA5
	IF (IA5.LE.9) ENCODE(5,4609,TIM1)IA4,IA5
	GOTO 4712
4711    IF (IERT.NE.7) GOTO 4955
	TYPE 1379
	CALL WAIT(5.0)
4712    CALL DBOPEN(BASE(16))
	CALL DBUPD(-1)
	IF (ANS.EQ.'A') CALL DBADD(1,CNAM,2,TNUM,3,REPF,4,TIM1,5,
     1  SDAT,6,0,7,HN,12,0,15,REPN)
	IF (ANS.EQ.'A1') CALL DBADD(1,REPN,2,TNUM,3,SITP,4,TIM1,5,
     1  SDAT,6,0,7,HN,12,0,15,SITC)
	HDRCHK=1
	CALL DBCLOS
	IF(ANS.EQ.'A') GOTO 650
	CALL DBERR($4930,IERT,IERC,0)
	GOTO 59
C      ROUTINE TO CHANGE HARDWARE AND SOFTWARE REGION

5000    IF (ANS.EQ.'G') TYPE 170,TIC
	CALL DBOPEN(BASE(1))
	IF (ANS.EQ.'G') ACCEPT 120,TNUM
	IF (TNUM.EQ.0) GOTO 4950
	CALL DBFIND(1,1,TNUM)
	CALL DBNREC(NUMBER)
	IF (NUMBER.EQ.0) GOTO 2375
	CALL DBGREC($4800,NUMBER)
	CALL DBVAL(20,SRGN,21,HRGN,9,NET,40,NODE,42,HOST,43,CKT,
     1  48,NT)
	IF (N.EQ.35) MAINT=SRGN
	IF (N.EQ.36) MAINT=HRGN
	I=1
5001    TYPE 2390,MAINT
	TYPE 2391
	ACCEPT 120,M
	IF (M.EQ.0) GOTO 5007
	IF ((M.GT.0).AND.(M.LE.NATTN)) GOTO 5002
	IF ((M.EQ.-1).OR.(I.EQ.3)) CALL HREFR
	I=I+1
	GOTO 5001
5002    CALL DBERR($5003,IERT,IERC,0)
	GOTO 5004
5003    IF (IERT.NE.7) GOTO 4955
	TYPE 1379
	CALL WAIT(5.0)
5004    CALL DBOPEN(BASE(1))
	CALL DBUPD(-1)
	CALL DBFIND(1,1,TNUM)
	IF (N.EQ.35) CALL DBCHNG(20,ATTN(M))
	IF (N.EQ.36) CALL DBCHNG(21,ATTN(M))
	CALL DBCLOS
	CALL DBERR($5005,IERT,IERC,0)
	GOTO 5006
5005    IF (IERT.NE.7) GOTO 4955
	CALL WAIT(5.0)
5006    CALL DBOPEN(BASE(10))
	IF (NT.EQ.1) CALL DBFIND(3,1,NET,1,4,1,NODE,1,17,1,'N')
	IF (NT.EQ.2) CALL DBFIND(3,1,NET,1,6,1,HOST,1,17,1,'H')
	IF (NT.EQ.3) CALL DBFIND(3,1,NET,1,7,1,CKT,1,17,1,'C')
	CALL DBNREC(NUMBER)
	IF (NUMBER.EQ.0) GOTO 5007
	IF (N.EQ.35) CALL DBCHNG(25,ATTN(M))
	IF (N.EQ.36) CALL DBCHNG(26,ATTN(M))
5007    CALL DBCLOS
	GOTO 2381


C       ROUTINE TO PRINT DETAIL OF ORIGINATING AND CURRENT
C       CONTROL GROUP

5100    Z=0
5102    TYPE 5101,NETOP(CG),NETOP(CG)
5101    FORMAT(/5X,'THIS ROUTINE WILL PRINT A LIST OF TICKETS FROM ',
     1  'THE ACTIVE DATABASE',/5X,'THAT EITHER WERE ORIGINATED BY ',
     2  'YOUR CONTROL GROUP AND ARE CURRENTLY',/5X,'CONTROLLED ',
     3  'BY ANOTHER GROUP, OR THOSE THAT WERE ORIGINATED BY ANOTHER ',
     4  /5X,'GROUP AND ARE CURRENTLY UNDER YOUR CONTROL.',/,/5X,
     5  'DO YOU WISH TO SEE:',/10X,'1 = TICKETS ORIGINATED BY ',A5,' ',
     6  'AND CONTROLLED BY OTHERS, OR',/10X,'2 = TICKETS ORIGINATED BY ',
     7  'OTHERS AND CONTROLLED BY ',A5,/,/10X,'ENTER 1 OR 2: ')
	ACCEPT 120,P
	IF(P.EQ.0) GOTO 59
	Z=Z+1
	IF (Z.EQ.3) GOTO 59
	IF((P.LT.0).OR.(P.GT.2)) GOTO 5102
	IF(P.EQ.1) GOTO 5130
	CALL DBOPEN(BASE(1))
	CALL DBFIND(4,1,CG,1,53,2,CG)
	CALL DBNREC(NUMBER)
	IF (NUMBER.EQ.0) GOTO 5110
	TYPE 5105
5105    FORMAT(/1X,'TICKET   ORIGINATING               CURRENT   ',
     3  'CURRENT',
     1  /1X,'NUMBER   CONT. GROUP   INITIALS    CONT.GRP  REF.GRP',
     2  '    STATUS',/1X)
	DO 5109 I=1,NUMBER
	CALL DBGREC($4930,I)
	CALL DBVAL(1,TNUM,4,F2,10,WHO,53,HN,51,MAINT,15,STAT)
	TYPE 5106,TNUM,NETOP(F2),WHO,NETOP(HN),MAINT,STAT
5106    FORMAT(/1X,I6,6X,A5,8X,A3,8X,A5,4X,A5,6X,A5)
5109    CONTINUE
	CALL DBCLOS
	GOTO 59
5110    TYPE 5111,NETOP(CG)
5111    FORMAT(/1X,'YOU ARE NOT CURRENTLY CONTROLLING ANY TICKETS ',
     1  'THAT WERE ORIGINATED',/1X,'BY ANOTHER REGION.  USE THE O ',
     2  'COMMAND TO SEE OPEN TICKETS FOR ',A5)
	GOTO 59
5130    CALL DBOPEN(BASE(1))
	CALL DBFIND(4,2,CG,1,53,1,CG)
	CALL DBNREC(NUMBER)
	IF(NUMBER.EQ.0) GOTO 5145
	TYPE 5105
	DO 5140 I=1,NUMBER
	CALL DBGREC($4930,I)
	CALL DBVAL(1,TNUM,4,F2,10,WHO,53,HN,51,MAINT,15,STAT)
	TYPE 5106,TNUM,NETOP(F2),WHO,NETOP(HN),MAINT,STAT
5140    CONTINUE
	CALL DBCLOS
	GOTO 59
5145    TYPE 5146,NETOP(CG),NETOP(CG)
5146    FORMAT(/1X,'THERE ARE NO TICKETS ORIGINATED BY ',A5,' THAT ',
     1  'ARE CURRENTLY CONTROLLED',/1X,'BY ANOTHER REGION.',/1X,
     2  'USE THE O COMMAND TO SEE OPEN TICKETS FOR ',A5)
	GOTO 59
6000    Z=7
	IF(WELL.EQ.'C')CALL GTW3(LNO,NOD1,Z)
	IF(WELL.EQ.'C')CALL GTW3(HNO,HST1,Z)
	CALL GTHRE(SC,SITC,Z)
	CALL GTHRE(SP,SITP,Z)
	CALL G1NE(SL,SLOT,Z)
	CALL GTWO(OCKT,CIRCKT,Z,2)
	CALL GTHRE(OTRB,TROUB1,Z)
	IF(WELL.NE.'C')CALL GTHR3(RP1,
     1  TECH,Z,1)
	IF(WELL.EQ.'C')CALL GTHR3('ANALYSIS',
     1  TECH,Z,1)
	CALL MPGRGN(1,P,Z,SRGN)
	IF (P.GT.0) SRGN=ATTN(P)
	CALL MPGRGN(2,P,Z,HRGN)
	IF (P.GT.0) HRGN=ATTN(P)
	IF (WELL.EQ.'H')CALL GONE(NO,NOD1,Z)
	CALL GONE(OKH,KHST,Z)
	CALL GONE(PTS,PORT,Z)
	CALL GTW1(OCV,COV,Z)
	CALL GTW1(OSTH,STH,Z)
	CALL GTW1(OEHR,EHR,Z)
	CALL MPGPRO(P,Z,PROD)
	IF (P.GT.0) PROD=TYPE(P)
	CALL GTWO(OLOC,LOC,Z,2)
	IF (WELL.NE.'C')CALL GTW1(OVER,VER,Z)
	IF (WELL.EQ.'C')CALL GTW1('HIKHST',VER,Z)
	Z=2
	GOTO 4016
CCCCC
4800    TYPE 4805
4805    FORMAT(/10X,' ERROR IN DO LOOP ##1010 REPORT IT !!!',/)
4810    TYPE 4815
4815    FORMAT(/1X,'ERROR IN DO LOOP ##1130, REPORT IT !!!',/)
4830    TYPE 4835
4835    FORMAT(/1X,'ERROR IN DO LOOP ##2140, REPORT IT !!!',/)
4840    TYPE 4845
4845    FORMAT(/1X,' WE WENT FOR A VALUE THAT WAS NOT THERE CHECK ',
     1  'STATEMENT 2080 ')
	GOTO 4950
4850    TYPE 4855
	GOTO 59
4930    CALL DBERR($4932,IERT,IERC,0)
	CALL DBNSET(NUMBER)
	IF (ME.EQ.0) GOTO 99999
	IF (NUMBER.EQ.0) GOTO 4931
	DO 4931 I=1,NUMBER
	CALL DBCLOS
4931    CONTINUE
	IF (IERT.GT.0) TYPE 4957,IERT,IERC
4957    FORMAT(/3X,'ERROR TYPE = ',I3,4X,'ERROR CODE = ',I3,/)
C       TEMP COMMAND NEXT LINE
	CALL DBEND
	CALL DBSTRT(-1,1,-4,0,1,0,5,0,-1,0,-4,1,1,1,5,1)
C	CALL RELEAS(1)
C	CALL RELEAS(2)
C	CALL RELEAS(3)
C	CALL RELEAS(4)
C	CALL RELEAS(-1)
C	CALL RELEAS(5)
C	CALL RELEAS(6)
C	CALL RELEAS(7)
C	CALL RELEAS(-4)
C	CALL RELEAS(8)
	TYPE 4933
4933	FORMAT(1x,'All Channels RELEASED here... Stopping until testing
     +over.')
	STOP
	GOTO 59
4932    IF ((IERT.NE.14).AND.(IERC.NE.11)) GOTO 4955
	GOTO 59
4855    FORMAT(/1X,'ERROR IN DO LOOP FINDING VALUE OF ESCALATIONS',/)
4940    CALL DBCLOS
4945    CALL DBCLOS
4950    CALL DBCLOS
	GOTO 59
4955    TYPE 4956,IERT,IERC,CUST(SYS)
4956    FORMAT(/3X,'ERROR TYPE = ',I5,4X,'ERROR CODE = ',I5,
     1  /,/2X,'PLEASE REPORT THIS TO ',A5)
99999   CALL DBEND
	IF ((DRP.GT.0).OR.(ME.EQ.0)) CALL BYE
	STOP
	END
	SUBROUTINE TYPINF(INF,LINES)

	INTEGER I,N,LINE,LINES,INF(LINES*16)

	DO 20 LINE=1,LINES
	N=(LINE*16)-15
	IF (INF(N).EQ.'.    ') RETURN
	TYPE 10,(INF(I),I=N,N+15)
10	FORMAT(1X,16A5)
20	CONTINUE

	RETURN
	END
	SUBROUTINE GETINF(INF,LINES,RET)

	INTEGER I,N,LINE,LINES,RET,INF(LINES*16)

	RET=0
	DO 20 LINE=1,LINES
	N=(LINE*16)-15
	ACCEPT 10,(INF(I),I=N,N+15)
10	FORMAT(16A5)
	IF (INF(N).EQ.'.    ') RETURN
	RET=LINE
20	CONTINUE
	RETURN
	END
        SUBROUTINE WRTINF(INF,LINES)
C
C       SUBROUTINE FOR THE PURPOSE OF WRITING INFO FROM
C       THE PROBLEM DESCRIPTION OR STATUSES WITHOUT THE
C	PERIOD OR FOLLOWING LINES
C
        INTEGER I,N,LINE,LINES,INF(LINES*16)

	DO 20 LINE=1,LINES
	N=(LINE*16)-15
	IF (INF(N).EQ.'.    ') RETURN
	WRITE(8,10)(INF(I),I=N,N+15)
10	FORMAT(16A5)
20	CONTINUE
        RETURN
	END
	SUBROUTINE ATWO(TIM1,SDAT)
C
C********************************************************************
C
C       SUBROUTINE TO ADD TWO HOURS TO TIM1 AND SDAT. IF TIM1+2 IS
C       GREATER THAN 23 WEE WILL ADJUST SDAT BY ADDING ONE DAY
C
C********************************************************************
C
	INTEGER TIM1,SDAT,TOT,TOT1,IA1,IA2,IA3,IA4,IA5,IA6
C
100     CALL FGMT(IA1,IA2,IA3,IA4,IA5,IA6)
	IA3=IA3+1900
	CALL DBDATN(SDAT,IA1,IA2,IA3)
	IA4=IA4+2
	TOT1=IA4/24
	SDAT=SDAT+TOT1
	IA4=IA4-(24*TOT1)
	ENCODE(5,105,TIM1)IA4,IA5
	IF (IA5.LE.9) ENCODE(5,106,TIM1)IA4,IA5
105     FORMAT(I2,':',I2)
106     FORMAT(I2,':0',I1)
	RETURN
	END
C
 Kf>