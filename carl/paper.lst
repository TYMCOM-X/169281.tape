MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1


00001	C
00002	C************************
00003	C
00004	C       PAPER
00005	C
00006	C************************
00007	C
00008	C
00009	C       THIS PROGRAM IS THE SOLE PROPERTY AND CONFIDENTIAL
00010	C       DO NOT DISCLOSE OR USE BY THIRD PARTY.
00011	C
00012	C***********************************************************************
00013		INTEGER IM,J,NLINE,ILIN,YMTOT,MYREG,N,NUMCG
00014		INTEGER SC(3),SP(3),PT(3),TODAY
00015		INTEGER DT,TI,BB,NDUP,NTUP,REPFLG
00016		INTEGER INFO(64),K,NUMBER,I,COC(2),NNET(2),CCC,CARR
00017		INTEGER TNUM,TIM1,RNAM(4),RFON(4),OSVER,XCOC,RCOD
00018		INTEGER TOT,SPEN,MONIT,TOTAL,SOPEN,SMONIT
00019		INTEGER DISC(169),STOTAL,F3(5),TOGO
00020		INTEGER SRT,TYPE,X,SYS,DECIS
00021		INTEGER HOST,SITP(4),NTYPE,FLAG,UNAM(3),NCNAM(4)
00022		INTEGER SM,SD,SY,EM,ED,EY,D,NT
00023		INTEGER L,M,P,NUMNET,NATTN,DDAT,NUD,NPROB
00024		INTEGER NET(2),FILE(3),FF,TTIM,H2,H1,BAS11(3),BAS12(3),BAS16(3)
00025		INTEGER NO,SL,HO,ATTN,SDAT,LREFER,HREFER
00026		INTEGER ST(3),NUM1,ITEM1(19),ITEM2(19),ITEM(19),HIATTN
00027		INTEGER SITC(4),NOD1,HST1,CIRCKT(4),TROUB1(4)
00028		INTEGER REPN(4),REPF(4),BAS1(3),BAS2(3),BAS4(3),CG
00029		INTEGER BAS5(3),BAS6(3),BAS7(3),BAS8(3),BAS9(3),HH,LOATTN
00030		INTEGER VERS,COL,ROW(20),COR,TDAT
00031		INTEGER LIST(100),NEWVAL(4),M1,M2,M3,M4,M5,IERT,IERC,YY,AS
00032		INTEGER TOT1,NTIM,TUS,TTL(21),IVER,SVER,FSTREC,RS
00033		INTEGER RECORD,SUB(25),ME,VALUE(4),ATIM
00034		INTEGER STAT,Y,B,C,TOT2,LIC,XX,F2,JJ1,CSC
00035		INTEGER TIC(3),RW1(3),RW2(3),RP1(3),RP2(3)
00036		INTEGER TELH(54),COMMT(12),DS1,TELM(4),LO,HO1,F1,CBAK(4),CHEX
00037		INTEGER CUST,ANS,NDAT,SEE,WELL,DVER(4),CHO,Z,MNAM(3)
00038		INTEGER IA1,IA2,IA3,IA4,IA5,IA6,V1,V2,V3,V4,V5,V6
00039		INTEGER OCKT(2),CKT(4),OTRB(3),TRB(4),DUP,ODUP(2),DF,REV
00040		INTEGER TUP,MAINT,CBY,DSP,REGEN,REG
00041		INTEGER OSVR(2),DRP,JM,JD,JY,COMMEN(12),TT
00042		INTEGER OFF,LEV,EVER(4),H3,H4,H5,Q,HN,BILL,ESC,INT,COMMNT(4)
00043		INTEGER OPRO(2),PRO,TECH(3),COV,CNAM(3),KHST,OKH,STH,EHR,PORT
00044		INTEGER TYP,CDAT,LOC(4),VER,T40,OSTH(2),OEHR(2),OLOC(2),OVER(2)
00045		INTEGER PTS,OCV(2),HRGN,SRGN,ONUM(2),HQCC,CCOD,ORDER,PNAM(3)
00046		INTEGER WHO,LNO(2),HNO(2),BAS10(3),LIN1(16),SNAM(3)
00047		INTEGER ALREDY,TYPST,LONG
00048		INTEGER TIM2,MOTO,WK,QOS,QOSGY(4),PROBL(2),HDRCHK
00049		INTEGER YORN,IPXNA,CRDNM,PRTNM
00050	
00051		REAL HOUR,TET,ELM,PERCEN,TASKT,TASKP,SRGNT
00052	
00053		DOUBLE PRECISION VNET(60)
00054		DOUBLE PRECISION CODE(120)
00055		DOUBLE PRECISION HWARE(5)
00056		DOUBLE PRECISION SWARE(6)
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-1


00057		DOUBLE PRECISION ITELC(5)
00058		DOUBLE PRECISION REPRB(35)
00059	
00060		DIMENSION NOUT(3)
00061		DIMENSION YN(4)
00062		DIMENSION CAT(3)
00063		DIMENSION CUST(2)
00064		DIMENSION STATUS(9)
00065		DIMENSION REGEN(7)
00066		DIMENSION TVNET(60)
00067		DIMENSION HEX(15)
00068		DIMENSION RVNET(60)
00069		DIMENSION SNET(60)
00070		DIMENSION IVER(4)
00071		DIMENSION NETOP(28)
00072		DIMENSION BLK(1)
00073		DIMENSION AM(12)
00074		DIMENSION ATTN(151)
00075		DIMENSION LREFER(5)
00076		DIMENSION HREFER(5)
00077		DIMENSION TYPE(97)
00078		DIMENSION YY(10)
00079		DIMENSION AS(4)
00080		DIMENSION SPEN(60)
00081		DIMENSION TOTAL(60)
00082		DIMENSION MONIT(60)
00083	
00084		DATA OSVR/'SEVERITY'/
00085		DATA OCKT/'CIRCUIT # '/
00086		DATA VALUE/'                    '/
00087		DATA NEWVAL/'                    '/
00088		DATA OTRB/'TELCO  NUMBER '/
00089		DATA ODUP/'DATE UP:'/
00090		DATA RW1/'COMPANY NAME   '/
00091		DATA RW2/'REPORTED BY    '/
00092		DATA SC/'SITE CONTACT'/
00093		DATA DT/'DATE'/
00094		DATA TI/'TIME'/
00095		DATA SP/'SITE PHONE#'/
00096		DATA PT/'PRODUCT TYPE'/
00097		DATA NO/'NODE'/
00098		DATA SL/'SLOT'/
00099		DATA HO/'HOST'/
00100		DATA ST/'TICKET STATUS'/
00101		DATA LNO/'LOW NODE'/
00102		DATA HNO/'HIGH NODE'/
00103		DATA VERS/' 6.50'/
00104		DATA REV/'  0  '/
00105		DATA CARR/"015/
00106		DATA (NOUT(P),P=1,3)/'     ','HOST','LONOD'/
00107		DATA (YN(P),P=1,4)/'NO','YES','DSC','*BLUE'/
00108		DATA (CAT(P),P=1,3)/'N','H','C'/
00109		DATA (CUST(K),K=1,2)/'CS800','NSSC'/
00110		DATA (STATUS(L),L=1,9)/'OPEN ','MONIT','CLSD ','TRACK',
00111	     1  '   ','   ','   ','   ','TRACK'/
00112		DATA (REGEN(J),J=1,7)/'EAST','CENT','WEST','TNSC','     ',
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-2


00113	     1  'AGENT','     '/
00114		DATA (VNET(K),K=1,60)/'TYMNET','DECNET','MCIRNET','NINNET',
00115	     1  'IPLCNET','ITSNET ','BOFANET','ALASCOM','DUNET  ','FIRNNET',
00116	     2  'HKBGNET','        ','TRWNET','      ','DIALNET','SWBNET',
00117	     3  'WESTNET','AUTONET','MNSQANET','EXXNET','MGTBNET','UCCPAC',
00118	     4  'DATAPAK','         ','XEROX ','SLIGOS','NISNET','UKNET ',
00119	     5  'PHILIPS','ANZPAC','ITALNET','CWNET ','ITANET','TELERANET',
00120	     6  'SCANDUTCH','NTSNET','BABYLONNET','FRAMERELAY','LENET ',
00121	     7  'PAYMENT','FORDNET','MTSSNET','XADANET ','EUSKONET',
00122	     8  'HELLERNET','PRIMEX  ','ANYLABNET','THNET  ','ARMYCORP',
00123	     9  'EDINET','DIALCOM','KTNET ','AFNET ','VIDEONET','SFBNET',
00124	     A  '      ','C&WBERMUDA','NETBILLING','PNBNET','CPRMNET'/
00125		DATA (CODE(K),K=1,66)/'NONE     ','          ','          ',
00126	     1  '          ','          ','          ','          ',
00127	     2  '          ','         ','PWR SUPPLY','BOARD ','CABLE ',
00128	     3  'PERIPHERAL','BPLN/CHASS','SETUP PROB','REPL/ENGN ',
00129	     4  '          ','          ','          ','CONFIG CHG',
00130	     5  'VRSN UPGRD','VRSN DNGRD','KNWN PTCH','NEW PTCH','UNSPPRTD',
00131	     6  'PIR REQRD','NSR SBMTTD','MO.INF.REQ','VENDOR    ',
00132	     7  'ASYC MODEM','SYNC MODEM','DGTL MODEM','BT PAD    ',
00133	     8  'BRDG/RTR','SWARE CNFG','         ','         ','          ',
00134	     9  '          ','OP/PCDR ER','SWARE/VNDR','HWARE/VNDR',
00135	     A  'CHANGE','DOWNTIME','          ','          ','          ',
00136	     B  '          ','          ','DIAL-UP','ANALOG','DIGITAL',
00137	     C  'SS 800/950','T-1       ','          ','          ',
00138	     D  '          ','          ','          ','CFG GL EXC',
00139	     E  'DEADENDED','VALIDATION','IRC/PTT','          ',
00140	     F  '          ','          '/
00141		DATA (CODE(K),K=67,120)/'        ','        ','        ',
00142	     G  'SCHD OUT','UNSCHD OUT','CUST. SITE',
00143	     H  '          ','          ','          ','          ',
00144	     I  '          ','          ','          ','PROJECT   ',
00145	     J  '          ','          ','          ','          ',
00146	     K  '          ','          ','          ','          ',
00147	     L  '          ','SLT RLOD','SDUMP&RLOD','NODE RLOD','NDUMP&RLOD',
00148	     M  'DOCUMENTN ','NTF       ','SLOT H&E  ','REF-OTH-TK',
00149	     N  'CWT       ','TRACKING  ','P/L RESET ','          ',
00150	     O  '          ','          ','          ','          ',
00151	     P  '          ','          ','          ','          ',
00152	     Q  '          ','          ','          ','          ',
00153	     R  '          ','          ','          ','          ',
00154	     S  '          ','          ','          '/
00155		DATA (TVNET(K),K=1,60)/'TYM','DEC','MCI','NIN',
00156	     1  'IPL','ITS','BOA','ALA','DUN','FRN','HKB','   ','TRW',
00157	     2  '   ','DIA','SWB','WST','ATO','MNQ','EXX','MGT','UCC',
00158	     3  'TVK','   ','XRX','SLG','NIS','UK','PHL','ANZ','ITL','CAN',
00159	     4  'ITA','TEL','SCN','NTS','BAB','FRA','LEN','PAY','FRD',
00160	     5  'MTS','XAD','EUS','HLR','PRX','LAB','THN','ARM','EDI','DCM',
00161	     6  'KTN','AFN','VID','SFB','   ','CWB','NBI','PNB','CPM'/
00162		DATA (HEX(I),I=1,15)/1H1,1H2,1H3,1H4,1H5,1H6,1H7,1H8,1H9,
00163	     1  1HA,1HB,1HC,1HD,1HE,1HF/
00164		DATA (RVNET(K),K=1,60)/'TYMN','DECN','MCIN','NINN',
00165	     1  'IPLC','ITSN ','BOFA','ALAS','DUPN','FIRN','HKBGN','    ',
00166	     2  'TRWN','     ','DIALN','SWBN','WESTN','AUTO','MNQN',
00167	     3  'EXXN','MGTBN','UCCP','DPACK','     ','XRXN','SLIG','NISN',
00168	     4  'UKNE','PHLP','ANZP','INTL','CWNE','ITAN','TELA','SCAN',
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-3


00169	     5  'NTSN','BABY','FRLY','LENE','PAYM','FORD','MTSS','XAD',
00170	     6  'EUSK','HLRN','PRMX','LABN','THNE','ARMY','EDIN','DCMN','KTNE',
00171	     7  'AFNE','VIDNE','SFBNE','     ','CWBNE','NBILL','PNBN','CPRM'/
00172		DATA (SNET(K),K=1,60)/'TYMNE','DECNE','MCIRN','NINNE',
00173	     1  'IPLCN','ITSNE','BOFAN','ALASC','DUNET','FIRNN',
00174	     2  'HKBGN','     ','TRWNE','     ','DIALN','SWBNE',
00175	     3  'WESTN','AUTON','MNSQN','EXXNE','MGTBN','UCCPA','DATAP',
00176	     4  '     ','XEROX','SLIGO','NISNE','UKNET','PHILP','ANZPA',
00177	     5  'INTAL','CWNET','ITANE','TELER','SCAND','NTSNE','BABYL',
00178	     6  'FRAME','LENET','PAYMT','FORDN','MTSSN','XADAN','EUSKO',
00179	     7  'HELLE','PRIMX','ANYLB','THNET','ARMYN','EDINE','DCMNE',
00180	     8  'KTNET','AFNET','VIDEO','SFBNE','     ','CWBNE','NBILL',
00181	     9  'PNBNE','CPRMN'/
00182		DATA (IVER(P),P=1,4)/1,2,3,4/
00183		DATA (NETOP(I),I=1,28)/'NSSC','NETCN','ONTYM','CS800','BTDUB',
00184	     1  'NTENG','BTAUS','UKMSG','BTJPN','NISOP','BTUK','BTHK','NTS  ',
00185	     2  'EDICN','BTALS','PORTS','GCSCL','MSGCN','BTAP ','BTSNG',
00186	     3  'ECSC ','ENMC ','LNKOP','UK800','TSIS','BTCAN','CONFR',
00187	     4  '     '/
00188		DATA BLK/'   '/
00189		DATA (AM(IM),IM=1,12)/'JAN','FEB','MAR','APR','MAY','JUN','JUL',
00190	     1  'AUG','SEP','OCT','NOV','DEC'/
00191		DATA (ATTN(I),I=1,149)/'NFTEL','NFONE','NFOCN','TWITS','LNKOP',
00192	     1  'UKOM ','BTDUB','NFOKP','NFOMX','SCRTY','NFOVA','TPPGL',
00193	     2  'TSIS ','HKHW ','NFOCH','NFOPL','FMTOP','NFOSL','FIRST',
00194	     3  'NFODA','FRSPT','NFOHO','NFOAT','NFOTA','CSSP ','TSOPS','NFTEC',
00195	     4  'NFODE','ONT11','GTSPE','NFOEB','NFOSB','NFOLA','DESS ',
00196	     5  'CRSUP','NTS','NSSC','ONTYM','NETCO','CS800','STS  ','CUSTM',
00197	     6  'WTSSF','UKFR ','WTSIR','CTSCH','WTSDA','CTSDE','CTSSL','EIMGT',
00198	     7  'EPSG ','ETSBO','NSSCP','FTMSG','PORTS','MCI','DBVAL','ROTRY',
00199	     8  'UKMSG','BTGER','PI','BTWCA','CHAD','CONFR','BTSWE','ATCOM',
00200	     9  'CLOSE','TELCO','ETSG ','ORDIN','DSOS','NTD','NMCAP',
00201	     A  'VIDSP','BTNL','HTSUK','BTFR','CPSS','STSUK','CS8CU','GTSAR',
00202	     B  'ORDCU','CWSRV','GTSMX','NIS','SIRTI','GTSCO','GTSVE','DLCOP',
00203	     C  'GTSZP','BTJPN','HKSW ','GTSZR','EMSG','BTBEL','ETSRE','DTPSC',
00204	     D  'ETSAT','BTKOR','CSGER','BTAP','BTUK','FSNL ','FSBEL','BTSZ',
00205	     E  'UKCS ','BTITA','BTSP','TSBEL','TSNL ','EUROP','SNGTL','BTAUS',
00206	     F  'NBILL','BTHK','FSFR','UK800','SPNMC','EDICN','MSGCN',
00207	     G  'TIS  ','UKRF ','UKCLR','NTENG','TPVIE','NOVPS','FRCS ','GSTC ',
00208	     F  'FLMTC','IPLC ','ECSC ','ENMC ','FSGER','FSITA','FSSZ ',
00209	     I  'FSSPA','FSSWE','BTSNG','ITSNY','GCSCL','FLMCU','EDITS',
00210	     J  'HSMC ','NTNOR','SDSKO','PHCOM','PADSP','SDSMA','MAYTL'/
00211		DATA (ATTN(I),I=150,151)/'BTALS','OTHER'/
00212		DATA (LREFER(K),K=1,5)/'NFO','BTA','ETS','CTS','WTS'/
00213		DATA (HREFER(P),P=1,5)/'NFP','BTZ','ETT','CTT','WTT'/
00214		DATA (TYPE(P),P=1,97)/'DIALU','ATC','BPS','PAP','MCP','BDLC',
00215	     1  'MSVO','ISCS ','SUN','SWTCH','XCOM','ISIS','PBH',
00216	     2  'PBT','SNA','BBXS','X.75','X.PC','ACOM','4.8','9.6','14.4',
00217	     3  '19.2','56KB','T1','HWOCL','SDB','XDIAL','OUTD','VALID',
00218	     4  'PROJ','TLNET','PERIF','OEM','SUP','ONTY','PRB','UN2',
00219	     5  'TII','EDI ','EMSGA','CMTI','UTS','TMCS','NEM','RAM','NVAL',
00220	     6  'DG  ','CFRS','NALRT','PICO','CMS','ALC','    ','FRE',
00221	     7  'CMH','    ','ELF','HSA','VIDEO','MUX','NTCN','     ','TDI',
00222	     8  'TIIG','DIALC','    ','     ','UTIL','SDLC','INTLS','TURBO',
00223	     9  'PTI','PHR','CDM','CMF','CPC','CPPP','NADA','CPAS','BITS',
00224	     A  'SVR  ','SVP  ','SVC ','PADS ','PAPER','     ','FRAD','OTHER',
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-4


00225	     B  'CRDU','ITS','MFX','EZTYM','LEM ','PXL  ','NODE ','CMTU '/
00226		DATA (HWARE(J),J=1,5)/'NONE    ','DISTRICT','REGIONAL',
00227	     1  'DIRECTOR','VICE PRES.'/
00228		DATA (SWARE(K),K=1,6)/'NONE    ','DISTRICT','REGIONAL',
00229	     1  'DIRECTOR','EXEC. DIR.','VICE PRES.'/
00230		DATA (ITELC(P),P=1,5)/'NONE    ','FIRST LEV.','SEC. LEVEL',
00231	     1  'THIRD LEV.','FORTH LEV.'/
00232		DATA (YY(P),P=1,10)/' ','*','!',' ',' ','*','*','*','*',
00233	     1  'NO'/
00234		DATA (AS(P),P=1,4)/'YES','YES','YES','YES'/
00235		DATA (REPRB(I),I=1,35)/'OPR INTCPT','RNA       ','BUSY      ',
00236	     1  'GARBAGE   ','NO CARRIER','TONE, NR  ','NR TO TID ',
00237	     2  'SLOW RESP.','USER DRPD.','OUTDIAL   ','MODEM     ',
00238	     3  'INTL. ACC.','PAP PROB. ','NODE DOWN ','NODE RSTRT',
00239	     4  'HOST DOWN ','HOST MSSNG','SLOT RSTRT','UTIL CODE ',
00240	     5  'LEASE LINE','HW/MS LINK','DBU FAILED','PERIPHERAL',
00241	     6  'CHRONIC   ','HOST SHUT ','NONE      ','OTHER     ',
00242	     7  'DIALCOM   ','NETBILLING','EDIBILLING','ETSBILLING',
00243	     8  'DCOMBILLNG','ONTBILLING','RTR DOWN  ','CUST INQRY'/
00244		DATA TIC/'TICKET NUMBER'/
00245		DATA RP1/'COMM SPECIALIST'/
00246		DATA RP2/'CALL BACK #'/
00247		DATA FF/"030/
00248		DATA OPRO/'PRODUCTION'/
00249		DATA OKH/'KHOST'/
00250		DATA OCV/'CONTRACT'/
00251		DATA PTS/'PORTS'/
00252		DATA OSTH/'START HOUR'/
00253		DATA OEHR/'END HOUR '/
00254		DATA OLOC/'LOCATION'/
00255		DATA OVER/'VERSION '/
00256	
00257	20      CONTINUE
00258		NUMNET=60
00259		NATTN=151
00260		NTYPE=97
00261		NUMCG=28
00262		NPROB=35
00263		FLAG=0
00264		I=0
00265	10      CALL USERNA(UNAM)
00266		TYPE 55,VERS,REV
00267	55      FORMAT(' MCI',1H','S NETWORK OPERATIONS PROBLEM TRACKING ',
00268	     1  'PROGRAM VERSION',A5,A5,/,/)
00269		CALL DBSTRT(-1,1,-4,0,1,0,5,0,-1,0,-4,1,1,1,5,1)
00270		CALL DBERR($4930,IERT,IERC,0)
00271		CALL DBOPEN('(NSSC)NPAP')
00272	31      CALL DBFIND(1,1,UNAM)
00273		CALL DBNREC(NUMBER)
00274		IF (NUMBER.GT.0) GOTO 40
00275	30      TYPE 33
00276	33      FORMAT(/1X,'ACCESS TO PROGRAM DENIED')
00277		CALL DBEND
00278		CALL BYE
00279	40      CALL DBGREC($30,1)
00280		CALL ONINT($4930)
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-5


00281		CALL DBVAL(2,FLAG,3,SRT,4,SYS,5,CG,6,DRP,7,XX,8,LOATTN,
00282	     1  9,HIATTN,10,LO,11,HO1,12,MYREG,13,ALREDY,14,CSC)
00283		IF (MYREG.GT.0) GOTO 41
00284	39      CALL HREFR
00285		TYPE 34
00286	34      FORMAT(3X,'ENTER THE NUMBER OF THE ORGANIZATION THAT YOU ARE A ',
00287	     1  'PART OF : ',$)
00288		ACCEPT 120,MYREG
00289		IF ((MYREG.LE.1).OR.(MYREG.GT.NATTN)) GOTO 39
00290		CALL DBCHNG(12,MYREG)
00291	41      IF (FLAG.GT.0) DECODE(10,631,VNET(FLAG))NNET
00292		IF (FLAG.LT.1) ENCODE(10,43,NNET)
00293	631     FORMAT(2A5)
00294	43      FORMAT('  ALL  ')
00295		IF (XX.LT.0) LIC=1
00296		ENCODE(15,3200,BAS1)
00297		ENCODE(15,3201,BAS2)
00298		ENCODE(15,3202,BAS4)
00299		ENCODE(15,3203,BAS5)
00300		ENCODE(15,3204,BAS6)
00301		ENCODE(15,3205,BAS7)
00302		ENCODE(15,3206,BAS8)
00303		ENCODE(15,3207,BAS9)
00304		ENCODE(15,3229,BAS10)
00305		ENCODE(841,207,DISC)
00306	3200    FORMAT('(TNT)BASE1  ')
00307	3201    FORMAT('(TNT)BASE2  ')
00308	3202    FORMAT('(TNT)BASE4  ')
00309	3203    FORMAT('(TNT)BASE5  ')
00310	3204    FORMAT('(TNT)BASE6  ')
00311	3205    FORMAT('(TNT)BASE7  ')
00312	3206    FORMAT('(TNT)CALBAK ')
00313	3207    FORMAT('(TNT)OCALBK ')
00314	3229    FORMAT('(TNT)PROFIL ')
00315	46      I=0
00316		IF (SRT.LT.1) GOTO 59
00317	47      TYPE 175
00318		ACCEPT 176,ME
00319		CALL HISET(ME)
00320		DECODE(3,30176,ME)M1,M2,M3
00321	30176   FORMAT(A1,A1,A1)
00322		IF ((M1.EQ.' ').OR.(M2.EQ.' ')) GOTO 47
00323		IF ((M1.ge.'A').AND.(M1.LE.'Z')) GOTO 56
00324		GOTO 47
00325	56      CALL DBERR($4930,IERT,IERC,0)
00326		IF (ALREDY.EQ.5) GOTO 59
00327		ALREDY=ALREDY+1
00328		CALL DBCHNG(13,ALREDY)
00329		CALL DBOPEN('NOCLOSE','(NSSC)ACCMSG')
00330		CALL DBSET(2)
00331		CALL DBFIND(1,1,UNAM)
00332		CALL DBNREC(NUMBER)
00333		IF (NUMBER.EQ.0) GOTO 59
00334		CALL DBGREC($59,NUMBER)
00335		CALL DBVAL(2,INFO)
00336		DO 58 ILIN=1,4
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-6


00337		N=(ILIN*16)-15
00338		IF (INFO(N).EQ.'.    ') GOTO 59
00339		TYPE 701,(INFO(J),J=N,N+15)
00340	58      CONTINUE
00341	59      TYPE 60
00342	60      FORMAT(/1X,'ENTER COMMAND... OR A',4H(CR),' FOR HELP : ',$)
00343		ACCEPT 65,ANS
00344		CALL HISET(ANS)
00345	65      FORMAT(A5)
00346		IF (ANS.EQ.'L') GOTO 650
00347		IF (ANS.EQ.'48') GOTO 3585
00348		IF (ANS.EQ.'47') GOTO 3586
00349		IF (ANS.EQ.'K') GOTO 2590
00350		IF ((SRT.GE.1).AND.(ANS.EQ.'S')) GOTO 215
00351		IF (ANS.EQ.'N') GOTO 2320
00352		IF (ANS.EQ.' ') CALL HLP1(NNET,FLAG,SRT)
00353		IF (ANS.EQ.'O') GOTO 750
00354		IF ((XX.LT.0).AND.(ANS.EQ.'A')) goto 4035
00355		IF ((XX.LT.0).AND.(ANS.EQ.'A2')) goto 4035
00356		IF ((XX.LT.0).AND.(ANS.EQ.'A3')) goto 4035
00357		IF (ANS.EQ.'F') GOTO 2000
00358		IF (ANS.EQ.'MOTO') GOTO 2000
00359		IF (ANS.EQ.'WK') GOTO 2000
00360		IF ((SRT.GT.0).AND.(ANS.EQ.'G')) GOTO 2381
00361		IF ((XX.LT.0).AND.(ANS.EQ.'C')) GOTO 3765
00362		IF ((XX.LT.0).AND.((ANS.GE.'7').AND.(ANS.LT.'8'))) GOTO 3175
00363		IF ((FLAG.LT.2).AND.(ANS.EQ.'FRMON')) GOTO 93249
00364		IF ((ANS.EQ.'1').AND.(FLAG.LT.1)) GOTO 2540
00365		IF ((ANS.EQ.'9').AND.(FLAG.LT.1)) GOTO 3710
00366		IF ((XX.LT.0).AND.(ANS.EQ.'A1')) GOTO 3960
00367		IF ((XX.LT.0).AND.((ANS.GE.'5').AND.(ANS.LT.'6'))) GOTO 800
00368		IF (ANS.EQ.'Q') GOTO 99999
00369		IF ((xx.lt.0).AND.(ANS.EQ.'E')) GOTO 3805
00370		IF ((ANS.EQ.'CBACK').AND.(FLAG.LT.1)) GOTO 4600
00371		IF ((ANS.EQ.'60').AND.(FLAG.LT.1)) GOTO 4600
00372		IF ((ANS.EQ.'6L').AND.(FLAG.LT.1)) GOTO 4635
00373		IF ((ANS.EQ.'6C').AND.(FLAG.LT.1)) GOTO 4675
00374		IF ((ANS.EQ.'6U').AND.(FLAG.LT.1)) GOTO 4675
00375		IF ((ANS.EQ.'6D').AND.(FLAG.LT.1)) CALL DEFCB(ME)
00376		IF ((ANS.EQ.'I').ALAG.LT.1)) GOTO 2500
00377		IF ((ANS.EQ.'X').AND.(FLAG.LT.1)) GOTO 3400
00378		IF ((xx.lt.0).AND.(ANS.EQ.'D')) GOTO 3870
00379		IF ((LOATTN.GT.0).AND.(ANS.EQ.'TT')) GOTO 4345
00380		IF((CG.GT.0).AND.(ANS.EQ.'ORIGN')) GOTO 5100
00381		IF ((xx.lt.0).AND.(ANS.EQ.'Z')) GOTO 1400
00382		IF ((xx.lt.0).AND.(ANS.EQ.'U')) GOTO 2459
00383		IF (ANS.EQ.'V') GOTO 3765
00384		IF ((ANS.EQ.'T').AND.(FLAG.LT.1)) GOTO 3090
00385		IF ((xx.lt.0).AND.(ANS.EQ.'OP')) GOTO 4120
00386		IF ((SRT.EQ.1).AND.(ANS.EQ.'AC')) GOTO 4125
00387		IF ((ANS.EQ.'4').AND.(FLAG.LT.1)) GOTO 3580
00388		IF ((ANS.EQ.'AR').AND.(LO.GT.0)) GOTO 4210
00389		IF ((ANS.EQ.'2').AND.(FLAG.LT.1)) GOTO 3520
00390		IF (ANS.EQ.'?') CALL HLP2(NNET,FLAG,SRT,XX)
00391		IF (ANS.EQ.'DP') GOTO 4070
00392		IF ((XX.LT.0).AND.(ANS.EQ.'SUP')) GOTO 4175
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-7


00393		IF (ANS.EQ.'AP') GOTO 4065
00394		IF (ANS.EQ.'MP') GOTO 4067
00395		IF ((XX.LT.0).AND.(ANS.EQ.'C1')) GOTO 4235
00396		IF ((XX.LT.0).AND.(ANS.EQ.'D1')) GOTO 4260
00397	C       IF ((XX.LT.0).AND.(ANS.EQ.'DON')) GOTO 4285
00398		IF ((XX.LT.0).AND.(ANS.EQ.'FIND')) GOTO 4370
00399		IF ((XX.LT.0).AND.(ANS.EQ.'DELET')) CALL DRP1(UNAM,ME,VERS)
00400		IF ((ANS.EQ.'K1').AND.(FLAG.LT.1)) GOTO 4300
00401		IF (ANS.EQ.'K2') GOTO 4595
00402		IF ((XX.LT.0).AND.(ANS.EQ.'NSTAT')) GOTO 4490
00403		IF ((XX.LT.0).AND.(ANS.EQ.'REOPE')) GOTO 3925
00404		IF (ANS.EQ.'TIME ') GOTO 3950
00405		IF (ANS.EQ.'VER') TYPE 55,VERS,REV
00406		IF ((SRT.GE.1).AND.(ANS.EQ.'INT')) GOTO 47
00407		IF (ANS.EQ.'CNVRT') CALL CDDWN
00408	C       IF ((ANS.EQ.'REP').AND.(XX.LT.0))
00409	C    1  CALL RUN('DSK','REPORT','TNT')
00410		GOTO 59
00411	C
00412	C       INPUT FOR A NEW TICKET
00413	C
00414	100     FORMAT(4A5)
00415	110     FORMAT(' ENTER THE NETWORK NUMBER OR A ZERO(0) FOR HELP : ',$)
00416	120     FORMAT(I8)
00417	171     FORMAT(/3X,3A5,1X,I8,/)
00418	170     FORMAT(1H+,3A5,2H :,T20,$)
00419	203     FORMAT(1H+,2A5,2H :,T20,$)
00420	188     FORMAT(1H+,A5,2H :,T20,$)
00421	194     FORMAT(I6)
00422	214     FORMAT(20(1H ))
00423	131     FORMAT(/1X,'HERE ARE THE TICKETS FOR THAT NODE...',/1X,
00424	     1  'TNUM',T10,'DATE',T30,'NODE',T37,'HOST',T45,'CIRCUIT #',
00425	     1  T68,'PROD.',/)
00426	135     FORMAT(5X,'... NONE ...',/)
00427	134     FORMAT(/1X,'DO YOU NEED TO SEE MORE DETAIL ? (Y OR N) : ',$)
00428	133     FORMAT(1X,'THERE ARE ',I2,' TICKET(S) FOR NODE # ',I5,
00429	     1  /3X,'DO YOU WANT TO ADD YOUR CONTACT TO THIS TICKETS CALL BACK',
00430	     2  ' LIST ? ',$)
00431	162     FORMAT(1H+,'DO YOU WANT TO OPEN ANOTHER TICKET ? ',$)
00432	174     FORMAT(1H+,4A5,2H :,$)
00433	175     FORMAT(/1X,'ENTER "YOUR" INITIALS PLEASE : ',$)
00434	140     CALL DBERR($150,IERT,IERC,0)
00435		GOTO 152
00436	150     IF (IERT.NE.7) GOTO 4955
00437		TYPE 151
00438	151     FORMAT(1X,'STANDBY FOR TNUM... DATA BASE BUSY... ',
00439	     1  'WAITING 10 SECS.')
00440		CALL WAIT(5.0)
00441	152     CALL DBOPEN('(TNT)TNUM')
00442		CALL DBUPD(-1)
00443		CALL DBFIND(2,1,9)
00444		CALL DBNREC(NUMBER)
00445		IF (NUMBER.EQ.1) GOTO 153
00446		N=5
00447		IF (NUMBER.GT.1) GOTO 1360
00448		GOTO 1370
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-8


00449	153     CALL DBGREC($4800,1)
00450		CALL DBVAL(1,TNUM)
00451		TNUM=TNUM+1
00452		TOT=TNUM
00453		CALL DBCHNG(1,TNUM)
00454	138     CALL DBCLOS
00455		TYPE 171,TIC,TNUM
00456		GOTO 4054
00457	176     FORMAT(A3)
00458	180     CALL GTIM(TIM1,SDAT,LIC)
00459		TYPE 177
00460	177     FORMAT(1X,'PROBLEM DESCRIPTION',/,$)
00461		NLINE=0
00462		DO 179 ILIN=1,10
00463		N=(ILIN*16)-15
00464		ACCEPT 178,(DISC(J),J=N,N+15)
00465	178     FORMAT(16A5)
00466		IF (DISC(N).EQ.'.    ') GOTO 181
00467		NLINE=ILIN
00468	179     CONTINUE
00469	181	I=1
00470	204     TYPE 2531
00471	2531    FORMAT(1H+'ENTER THE NUMBER FOR THE GROUP WITH THE PROBLEM',
00472	     1  /2X,'OR ENTER  A ZERO FOR HELP : ',$)
00473		ACCEPT 120,M
00474		IF((M.GE.LOATTN).AND.(M.LE.HIATTN)) GOTO 201
00475		IF ((M.EQ.0).OR.(I.EQ.2)) CALL HREFR
00476		IF (I.EQ.3) GOTO 59
00477		I=I+1
00478		GOTO 204
00479	201     I=1
00480	208     TYPE 203,OSVR
00481		ACCEPT 120,SVER
00482		IF ((SVER.LT.1).OR.(SVER.GT.4)) GOTO 208
00483		TYPE 209
00484	209     FORMAT(1X,'COMMENT(20 CHAR. MAX): ',T25,$)
00485		ACCEPT 100,COMMNT
00486		IF(CSC.EQ.1) GOTO 8112
00487		TYPE 8110
00488	8110    FORMAT(/1X,'ENTER THE CUST. TICKET # IF YOU KNOW IT: ',$)
00489		ACCEPT 631,ONUM
00490		I=1
00491	8112    TYPE 8111
00492	8111    FORMAT(/1X,'ENTER THE CODE FOR THE "REPORTED" PROBLEM',
00493	     1  /2X,'OR ENTER A ZERO FOR HELP : ',$)
00494		ACCEPT 120,L
00495		IF ((L.GE.1).AND.(L.LE.NPROB)) GOTO 8113
00496		IF ((L.EQ.0).OR.(I.GE.3)) CALL HLPREP
00497		I=I+1
00498		GOTO 8112
00499	8113    TYPE 210,TNUM
00500	210     FORMAT(1H+,'DATA BASE IS BEING  OPENED AND TICKET #',I8,
00501	     1  ' WILL BE WRITTEN TO DISK',$)
00502	1375    FORMAT(/3X,'THERE IS NO RECORD OF THE THE LAST TICKET NUMBER',
00503	     1  ' USED !.')
00504		IF (WELL.EQ.'N') NT=1
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-9


00505		IF (WELL.EQ.'H') NT=2
00506		IF (WELL.EQ.'C') NT=3
00507		IF (WELL.EQ.'F') NT=4
00508		ESC=1
00509		F2=CG
00510		IF ((M.EQ.41).OR.(M.EQ.36).OR.(M.EQ.21).OR.(M.EQ.25)
00511	     1  .OR.(M.EQ.29).OR.(M.EQ.30).OR.(M.EQ.72).OR.(M.EQ.81).OR.
00512	     2  (M.EQ.71)) ESC=2
00513		ENCODE(5,8114,DISC(165))SVER,CG
00514	8114    FORMAT(I1,I2,'  ')
00515	1376    CALL DBERR($1377,IERT,IERC,0)
00516		GOTO 1378
00517	1377    IF (IERT.NE.7) GOTO 4955
00518		TYPE 1379
00519	1379    FORMAT(1X,'DATA BASE BUSY... WAITING 10 SECS.')
00520		CALL WAIT(5.0)
00521	1378    CALL DBOPEN(BAS1)
00522		CALL DBUPD(-1)
00523		CALL DBADD(1,TNUM,2,PRO,3,T40,5,SDAT,6,TIM1,7,REPN,8,REPF,
00524	     1  9,VNET(K),10,ME,11,0,12,SITC,13,SITP,14,PROD,15,'OPEN',16,
00525	     2  DISC,22,LOC,23,KHST,24,COV,25,COMMNT,28,STH,29,EHR,30,PORT,
00526	     3  31,CNAM,32,TECH,33,VER,36,1,37,1,38,1,40,NOD1,41,SLOT,42,HST1,
00527	     4  43,CIRCKT,44,TROUB1,45,1,46,ESC,48,NT,51,ATTN(M),52,SVER,53,CG,
00528	     5  20,SRGN,21,HRGN,50,'.....',27,'.....',55,'NONE      ',47,F1,
00529	     6  19,ONUM,57,REPRB(L),17,1,4,F2)
00530		ENCODE(841,207,DISC)
00531	207     FORMAT(841(1H ))
00532		CALL DBCLOS
00533		CALL DBERR($211,IERT,IERC,0)
00534		GOTO 213
00535	211     IF (IERT.NE.7) GOTO 4955
00536		TYPE 212
00537	212     FORMAT(1X,'TRACKING DATA BASE BUSY... WAITING 10 SECS.')
00538		CALL WAIT(5.0)
00539	213     CALL DBOPEN(BAS6)
00540		CALL DBUPD(-1)
00541		CALL DBADD(1,TNUM,2,SDAT,3,TIM1,7,'OPEN',8,ATTN(M),10,VNET(K),
00542	     1  11,SVER,12,PROD,14,ME,17,F1)
00543		CALL DBCLOS
00544		CALL DBERR($4930,IERT,IERC,0)
00545		IF (NOD1.GT.0) GOTO 3360
00546		GOTO 59
00547	C
00548	C
00549	C       ADD STATUS FOR A TICKET
00550	C
00551	215     TYPE 170,TIC
00552		LONG=0
00553		CALL DBOPEN(BAS1)
00554	216     ACCEPT 120,TNUM
00555		IF (TNUM.EQ.0) GOTO 4950
00556	218     CALL DBFIND(1,1,TNUM)
00557		CALL DBNREC(NUMBER)
00558		IF (NUMBER.GT.0) GOTO 217
00559		IF (ANS.EQ.'D') GOTO 2461
00560		TYPE 202,TNUM
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-10


00561	202     FORMAT(1X,'TICKET # ',I8,' IS NOT IN THE ACTIVE DATA BASE,',
00562	     1  /3X,'PLEASE RE-ENTER.',/)
00563		TYPE 170,TIC
00564		GOTO 216
00565	217     CALL DBGREC($4840,1)
00566		CALL DBVAL(15,STAT,5,SDAT,6,TIM1,14,PROD,51,MAINT,52,SVER,54,
00567	     1  ELM,49,DUP,50,TUP,35,V6,36,V1,37,V2,38,V3,39,V4,53,HH,47,F1,
00568	     2  9,NET,46,ESC,31,CNAM,40,NODE,55,COC)
00569	222     TYPE 221,CNAM,NODE,PROD,TNUM,STAT
00570	221     FORMAT(/1X,'CUSTOMER: ',3A5,4X,'NODE: ',I5,4X,'PROD: ',A5,
00571	     1  /1X,'TICKET # ',I6,' IS CURRENTLY ',A5,'.',/10X,'WHAT ',
00572	     1  'WOULD YOU LIKE TO DO WITH IT ?',/15X,'1 = ADD STATUS',/15X,
00573	     2  '2 = PUT ON MONITOR',/15X,'3 = CLOSE TICKET',/15X,
00574	     3  '4 = REOPEN TICKET',/15X,'5 = MAKE NO CHANGE',/15X,
00575	     4  '6 = ENTER TIC MARK',/15X,'7 = ENTER ESCALATION',/15X,
00576	     5  '8 = DEFER TICKET',/15x,'9 = track'/14X,'10 = SET TIME UP ONLY',
00577	     6  /14X,'11 = DE-ESCALATE THE TICKET',/14X,'12 = ADD LONG STATUS',
00578	     7  /2X,'ENTER # ',$)
00579		ACCEPT 120,L
00580		IF(L.NE.12) LONG=0
00581		IF (L.EQ.1) GOTO 219
00582		IF ((L.EQ.2).AND.(LIC.EQ.1).AND.(STAT.EQ.'OPEN')) GOTO 219
00583		IF ((L.EQ.3).AND.(LIC.EQ.1)) GOTO 3765
00584		IF ((L.EQ.4).AND.(LIC.EQ.1)) GOTO 226
00585		IF (L.EQ.5) GOTO 4950
00586		IF ((L.GE.6).AND.(L.LE.8)) GOTO 219
00587		if ((l.eq.9).AND.(LIC.EQ.1).AND.(STAT.EQ.'OPEN')) goto 219
00588		IF ((L.EQ.10).AND.(DUP.EQ.0).AND.(LIC.EQ.1)) GOTO 219
00589		IF (L.EQ.11) GOTO 219
00590		IF (L.EQ.12) GOTO 4335
00591		GOTO 222
00592	226     ELM=0
00593		SDAT=0
00594		TIM1='     '
00595		CALL MTTR(DUP,SDAT,TUP,TIM1,ELM,HOUR)
00596		IF ((HOUR.GT.24.0).AND.(STAT.EQ.'CLSD')) GOTO 240
00597		V6=V6+HOUR
00598		IF (V6.GT.999) V6=999
00599		CALL DBERR($227,IERT,IERC,0)
00600		GOTO 228
00601	227     IF (IERT.NE.7) GOTO 4955
00602		TYPE 1379
00603		CALL WAIT(6.0)
00604	228     CALL DBOPEN(BAS1)
00605		CALL DBUPD(-1)
00606		CALL DBFIND(1,1,TNUM)
00607		CALL DBCHNG(15,'OPEN',11,0,49,0,50,'.....',54,0,35,V6,
00608	     1  26,0,27,'.....')
00609		CALL DBCLOS
00610		CALL DBERR($4930,IERT,IERC,0)
00611	219     TYPE 220,ST
00612	220     FORMAT(1H+,3A5,/,$)
00613		DO 230 ILIN=1,4
00614		N=(ILIN*16)-15
00615		ACCEPT 225,(INFO(J),J=N,N+15)
00616	225     FORMAT(16A5)
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-11


00617		NLINE=ILIN
00618		IF (INFO(N).EQ.'.    ') GOTO 238
00619	230     CONTINUE
00620	238	CALL CSTAT(INFO,TRASH,Z,TNUM)
00621		IF (TRASH.NE.' ') GOTO 219
00622		IF (LONG.EQ.1) GOTO 4342
00623	237     IF ((L.NE.2).AND.(L.NE.9)) GOTO 232
00624		IF(DUP.EQ.0) CALL GETIM(TUP,DUP)
00625		IF (L.EQ.2) CALL RESCOD(TNUM,CCC,ANS,L)
00626		CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
00627		CALL VDIS(V4,V6,ELM)
00628		CALL DBERR($229,IERT,IERC,0)
00629		GOTO 231
00630	229     IF (IERT.NE.7) GOTO 4930
00631		TYPE 1379
00632		CALL WAIT(5.0)
00633	231     CALL DBOPEN(BAS1)
00634		CALL DBUPD(-1)
00635		CALL DBFIND(1,1,TNUM)
00636		CALL DBCHNG(49,DUP,50,TUP,'STAT',STATUS(L),54,ELM,34,V5,35,V6,
00637	     1  36,V1,37,V2,38,V3,39,V4)
00638		IF (L.EQ.2)CALL DBCHNG(55,CODE(CCC),17,CCC,19,ONUM)
00639		CALL DBCLOS
00640		IF (L.EQ.9) GOTO 232
00641		CALL DBERR($239,IERT,IERC,0)
00642		GOTO 241
00643	239     IF (IERT.NE.7) GOTO 4930
00644		TYPE 1379
00645		CALL WAIT(6.0)
00646	241     CALL DBOPEN(BAS6)
00647		CALL DBUPD(-1)
00648		CALL DBFIND(1,1,TNUM)
00649		CALL DBNREC(RECORD)
00650		IF (RECORD.EQ.0) GOTO 236
00651		CALL DBGREC($215,RECORD)
00652		CALL DBCHNG(4,DUP,5,TUP)
00653		CALL DBCLOS
00654		CALL DBERR($4930,IERT,IERC,0)
00655		GOTO 232
00656	236     CALL DBADD(1,TNUM,2,SDAT,3,TIM1,4,DUP,5,TUP,7,STATUS(L),
00657	     1  8,MAINT,10,NET,11,SVER,12,PROD,14,ME,17,F1)
00658		CALL DBCLOS
00659	232     CALL GTIM(TIM1,SDAT,LIC)
00660		IF ((INFO(1).EQ.'.    ').or.(info(1).eq.'     ')) GOTO 265
00661		CALL DBERR($261,IERT,IERC,0)
00662		GOTO 263
00663	261     IF (IERT.NE.7) GOTO 4955
00664		TYPE 1379
00665		CALL WAIT(6.0)
00666	263     CALL DBOPEN(BAS2)
00667		CALL DBUPD(-1)
00668		CALL DBFIND(1,1,TNUM)
00669		CALL DBNREC(ORDER)
00670		ORDER=ORDER+1
00671		IF (L.NE.4) GOTO 264
00672		CALL DBFIND(1,1,TNUM)
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-12


00673		CALL DBCHNG('RS',1)
00674	264     CALL DBADD(1,TNUM,2,SDAT,3,TIM1,4,ME,'STAT',STATUS(L),
00675	     2  7,INFO,8,UNAM,9,ORDER,5,RS)
00676		CALL DBCLOS
00677	265     CALL DBERR($4930,IERT,IERC,0)
00678		ENCODE(320,233,INFO)
00679	233     FORMAT(320(1H ))
00680		IF (LOATTN.EQ.0) GOTO 59
00681		IF (L.EQ.6) GOTO 3800
00682		IF (L.EQ.7) GOTO 3805
00683		IF (L.EQ.8) GOTO 3870
00684		IF (L.EQ.10) GOTO 4275
00685		IF (L.EQ.11) GOTO 4330
00686		IF ((L.EQ.2).AND.(MAINT.NE.'CUSTM')) GOTO 2383
00687	235     TYPE 234,PROD,MAINT,SVER
00688	234     FORMAT(/1X,'PRODUCT = ',A5,' REFERRED TO = ',A5,' SEVERITY = ',I1,
00689	     1  /1X,'DO YOU WISH TO CHANGE ANYTHING ABOVE (Y) OR RETURN ',
00690	     2  'TO THE MENU (C.R.) ?: ',$)
00691		ACCEPT 65,SEE
00692		CALL HISET(SEE)
00693		IF (SEE.EQ.'Y') GOTO 2381
00694		GOTO 59
00695	240     TYPE 242,TNUM,HOUR
00696	242     FORMAT(/,/,/,5X,'TICKET # ',I8,' HAS BEEN CLOSED FOR ',F6.1,
00697	     1  ' HOURS.',/6X,'YOU MAY NOT REOPEN TICKETS THAT ARE CLOSED ',
00698	     2  'MORE',/5X,'24 HOURS.  PLEASE OPEN A NEW TICKET TO TRACK ',
00699	     3  'REPEAT PROBLEM.',/,/5X,'THANK YOU...',/)
00700		GOTO 4950
00701	C
00702	C       LOOK AT A SINGLE TICKET
00703	C
00704	650     I=1
00705		IF ((ANS.EQ.'A').AND.(SEE.EQ.'Y')) GOTO 59
00706		SEE=' '
00707		IF(ANS.EQ.'A') TYPE 9651
00708	9651    FORMAT(/,/,/1X,'NOW CHECK THE TICKET HEADER FOR COMPLETENESS',
00709	     1  ' AND ACCURACY!',/,/)
00710		IF(ANS.EQ.'A') GOTO 9650
00711	651     TYPE 711,TIC
00712		ACCEPT 120,TNUM
00713	9650    CALL DBOPEN(BAS1,BAS2,BAS8)
00714		Z=1
00715		IF(TNUM.EQ.0) GOTO 4940
00716	653     CALL DBSET(1)
00717		CALL DBFIND(1,1,TNUM)
00718		CALL DBNREC(NUMBER)
00719		IF (NUMBER.GT.0) GOTO 670
00720		TYPE 652
00721	652     FORMAT(/1X'THE TICKET YOU WANT IS IN THE ARCHIVE DATA BASE',
00722	     1  /,/2X'STANDBY WHILE WE OPEN THE DATA BASE AND FIND IT',/)
00723		CALL DBOPEN(BAS4,BAS5,BAS9)
00724		Z=2
00725		CALL DBSET(1)
00726		CALL DBFIND(1,1,TNUM)
00727		CALL DBNREC(NUMBER)
00728		IF (NUMBER.GT.0) GOTO 670
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-13


00729		H2=TNUM/10000
00730		IF (H2.GT.9) GOTO 300
00731		ENCODE(15,661,BAS11)H2
00732	661     FORMAT('(TNT)B1',I1,'0',6X)
00733		ENCODE(15,662,BAS12)H2
00734	662     FORMAT('(TNT)B2',I1,'0',6X)
00735		ENCODE(15,663,BAS19)H2
00736	663     FORMAT('(TNT)B8',I1,'0',6X)
00737		GOTO 305
00738	300     ENCODE(15,301,BAS11)H2
00739	301     FORMAT('(TNT)B1',I2,'0',5X)
00740		ENCODE(15,302,BAS12)H2
00741	302     FORMAT('(TNT)B2',I2,'0',5X)
00742		ENCODE(15,303,BAS19)H2
00743	303     FORMAT('(TNT)B8',I2,'0',5X)
00744	305     CALL DBERR($659,IERT,IERC,0)
00745		CALL DBOPEN(BAS11,BAS12,BAS19)
00746		CALL DBFIND(1,1,TNUM)
00747		CALL DBNREC(NUMBER)
00748		IF (NUMBER.GT.0) GOTO 670
00749	659     TYPE 660,TNUM
00750	660     FORMAT(/10X,'TICKET NUMBER',I8,' DOES NOT EXIST',/)
00751		IF (IERT.GT.0) TYPE 4957,IERT,IERC
00752		I=I+1
00753		CALL DBERR($4930,IERT,IERC,0)
00754		IF (I.NE.3) GOTO 651
00755		TYPE 665
00756	665     FORMAT(/10X,'RE-SETTING INPUT QUES... TRY AGAIN.',/)
00757		GOTO 4950
00758	670     DO 690 I=1,NUMBER
00759	666     CALL DBGREC($4930,I)
%FTNDIM LINE:00759 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
00760		CALL DBVAL(1,TNUM,2,PRO,3,T40,4,F2,5,SDAT,6,TIM1,7,RNAM,8,RFON,
00761	     1  9,NET,10,INT,11,RS,12,SITC,13,SITP,14,PROD,15,STAT,16,DISC,17,
00762	     2  CCC,18,HQCC,19,ONUM,20,SRGN,21,HRGN,22,
00763	     3  LOC,23,KHST,24,COV,25,COMMNT,26,CDAT,27,TCLSD,28,STH,29,EHR,
00764	     4  30,PORT,31,CNAM,32,TECH,33,VER,34,V5,35,V6,36,V1,37,V2,38,V3,
00765	     5  39,V4,40,NODE,41,SLOT,42,HOST,43,CKT,44,TRB,45,BILL,46,ESC,47,
00766	     6  F1,48,NT,49,DUP,50,TUP,51,MAINT,52,SVER,53,HH,54,ELM,55,COC,
00767	     7  56,CBY,57,PROBL)
00768		TDAT=DUP
00769		TET=ELM
00770		TIM2=TUP
00771		IF (FLAG.LT.1) GOTO 678
00772		ENCODE(25,671,FILE)SNET(FLAG)
00773	671     FORMAT(A5,'                    ')
00774		IF (NET(1).EQ.FILE(1)) GOTO 678
00775		TYPE 677
00776	677     FORMAT(/3X'YOU DO NOT HAVE ACCESS TO THIS TICKET !',/)
00777		ENCODE(841,207,DISC)
00778		GOTO 59
00779	678     CALL DBNDAT(SDAT,IM,ID,IY)
00780		IF (DUP.GT.0) GOTO 686
00781		JY=0
00782		JD=0
00783		SM=0
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-14


00784		SD=0
00785		SY=0
00786		JM=0
00787		GOTO 687
00788	686     IF (CDAT.EQ.0)GOTO 685
00789		CALL DBNDAT(CDAT,SM,SD,SY)
00790		SY=SY-1900
00791	685     CALL DBNDAT(DUP,JM,JD,JY)
00792		JY=JY-1900
00793	687     IY=IY-1900
00794		CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
00795		IF (NT.EQ.2) GOTO 655
00796		IF (NT.EQ.3) GOTO 674
00797		IF (NT.EQ.4) GOTO 99655
00798	654     TYPE 680,NET,SVER,CNAM,TNUM,STAT,SITC,NODE,NETOP(HH),
00799	     1  SITP,KHST,MAINT,LOC,PROD,V1,V2,V3,RNAM,VER,YN(ESC),RFON,
00800	     2  SRGN,HQCC,COV,HRGN,V4,V6,STH,EHR,YN(PRO),ID,
00801	     3  AM(IM),IY,TIM1,TECH,INT,JD,AM(JM),JY,TUP,CKT,F1,SD,AM(SM),
00802	     4  SY,TCLSD,TRB
00803	680     FORMAT(/1X,'NETWORK',T11,2H: ,2A5,T24,'SEVERITY',T37,2H: ,
00804	     1  I1,T50,'CUSTOMER: ',3A5,/1X,'NODE TKT#: ',I8,T24,'STATE',
00805	     2  T37,2H: ,A5,T50,'CONTACT : ',4A5,/1X,'NODE #',T11,2H: ,
00806	     3  I5,T24,'CONTROL GROUP: ',A5,T51,'CPHONE : ',4A5,/1X,
00807	     4  'KERNAL',T11,2H: ,I5,T24,'REFERRED TO',T37,2H: ,A5,T50,
00808	     5  'LOCALE',T58,2H: ,4A5,/1X,'PRODUCT',T11,2H: ,A5,T24,
00809	     6  'MGMT ESCAL',T37,3H: H,I1,2H S,I1,2H T,I1,T50,'RPTD ',
00810	     7  'BY : ',4A5,/1X,'S/W VERS : ',A5,T24,'TECH ESCAL',T37,
00811	     8  2H: ,A3,T51,'RPHONE : ',4A5,/1X,'S/W DIST : ',A5,T24,
00812	     9  'DE-ESCAL CODE: ',I3,T50,'PLAN #',T58,2H: ,A2,/1X,
00813	     A  'H/W DIST : ',A5,T24,'DEFER :  ',I3,1H/,I3,T50,'SITE HR ',
00814	     B  2H: ,A5,' TO ',A5,/1X,'PRIMARY  : ',A3,T24,'OPEN  : ',
00815	     C  I2,1H-,A3,1H-,I2,1X,A5,1HZ,2X,'COM SPEC: ',3A5,/1X,
00816	     D  'OPEN BY',T11,2H: ,A3,T24,'RESLV : ',I2,1H-,A3,1H-,I2,
00817	     E  1X,A5,1HZ,T50,'CKT #',T58,2H: ,4A5,/1X,'ZONE',T11,2H: ,I1,T24,
00818	     F  'CLOSE : ',I2,1H-,A3,1H-,I2,1X,A5,1HZ,T50,'TELCO # : ',4A5)
00819		TYPE 688,HOUR,ONUM,COC,YN(BILL),YN(T40),PROBL
00820	688     FORMAT(T24,'ELAPS :  ',F8.1,4H HR.,T50,'REF.TKT#: ',2A5,
00821	     1  /,T24,'CLSCD : '2A5,T49,'BILL/T40: 'A3,1H/,A5,
00822	     2  /,/1X,'REPORTED PROBLEM: ',2A5,/)
00823		GOTO 684
00824	655     TYPE 689,NET,SVER,CNAM,TNUM,STAT,SITC,NODE,NETOP(HH),
00825	     1  SITP,KHST,MAINT,LOC,HOST,V1,V2,V3,RNAM,SLOT,YN(ESC),RFON,
00826	     2  PORT,HQCC,COV,PROD,V4,V6,STH,EHR,VER,ID,AM(IM),
00827	     3  IY,TIM1,TECH,SRGN,JD,AM(JM),JY,TUP,CKT,HRGN,
00828	     4  SD,AM(SM),SY,TCLSD,TRB
00829	689     FORMAT(/1X,'NETWORK',T11,2H: ,2A5,T24,'SEVERITY',T37,2H: ,
00830	     1  I1,T50,'CUSTOMER: ',3A5,/1X,'HOST TKT#: ',I8,T24,'STATE',
00831	     2  T37,2H: ,A5,T50,'CONTACT : ',4A5,/1X,'NODE #',T11,2H: ,
00832	     3  I5,T24,'CONTROL GROUP: ',A5,T51,'CPHONE : ',4A5,/1X,
00833	     4  'KERNAL',T11,2H: ,I5,T24,'REFERRED TO',T37,2H: ,A5,T50,
00834	     5  'LOCALE',T58,2H: ,4A5,/1X,'HOST #',T11,2H: ,I6,T24,
00835	     6  'MGMT ESCAL',T37,3H: H,I1,2H S,I1,2H T,I1,T50,'RPTD ',
00836	     7  'BY : ',4A5,/1X,'SLOT     : ',A2,T24,'TECH ESCAL',T37,
00837	     8  2H: ,A3,T51,'RPHONE : ',4A5,/1X,'# PORTS  : ',I3,T24,
00838	     9  'DE-ESCAL CODE: ',I3,T50,'PLAN #',T58,2H: ,A2,/1X,
00839	     A  'PRODUCT  : ',A5,T24,'DEFER :  ',I3,1H/,I3,T50,'SITE HR ',
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-15


00840	     B  2H: ,A5,' TO ',A5,/1X,'S/W VERS : ',A5,T24,'OPEN  : ',
00841	     C  I2,1H-,A3,1H-,I2,1X,A5,1HZ,2X,'COM SPEC: ',3A5,/1X,
00842	     D  'S/W DIST',T11,2H: ,A5,T24,'RESLV : ',I2,1H-,A3,1H-,I2,
00843	     E  1X,A5,1HZ,T50,'CKT #',T58,2H: ,4A5,/1X,'H/W DIST : ',A5,T24,
00844	     F  'CLOSE : ',I2,1H-,A3,1H-,I2,1X,A5,1HZ,T50,'TELCO # : ',4A5)
00845		TYPE 668,YN(PRO),HOUR,ONUM,INT,COC,YN(BILL),YN(T40),F1,PROBL
00846	668     FORMAT(1X,'PRIMARY  : ',A3,T24,'ELAPS : ',F8.1,4H HR.,T50,
00847	     1  'REF.TKT#: ',2A5,/1X,'OPEN BY  : ',A3,T24,'CLSCD : '2A5,T49,
00848	     2  'BILL/T40: ',A3,1H/,A5,/1X,'ZONE',T11,2H: ,I1,
00849	     3  /,/1X,'REPORTED PROBLEM: ',2A5,/)
00850		GOTO 684
00851	C
00852	C       CIRCUIT TICKET DISPLAY
00853	C
00854	674     TYPE 669,NET,SVER,CNAM,TNUM,STAT,SITC,NODE,NETOP(HH),
00855	     1  SITP,KHST,MAINT,LOC,HOST,V1,V2,V3,RNAM,VER,YN(ESC),RFON,
00856	     2  PROD,HQCC,COV,HRGN,V4,V6,STH,EHR,YN(PRO),
00857	     3  ID,AM(IM),IY,TIM1,CKT,INT,JD,AM(JM),JY,TUP,TRB,F1,SD,AM(SM),
00858	     4  SY,TCLSD,ONUM
00859	669     FORMAT(/1X,'NETWORK',T11,2H: ,2A5,T24,'SEVERITY',T37,2H: ,
00860	     1  I1,T50,'CUSTOMER: ',3A5,/1X,'LINE TKT#: ',I8,T24,'STATE',
00861	     2  T37,2H: ,A5,T50,'CONTACT : ',4A5,/1X,'LONODE',T11,2H: ,
00862	     3  I5,T24,'CONTROL GROUP: ',A5,T51,'CPHONE : ',4A5,/1X,
00863	     4  'LO KHOST',T11,2H: ,I5,T24,'REFERRED TO',T37,2H: ,A5,T50,
00864	     5  'LOCALE',T58,2H: ,4A5,/1X,'HI NODE',T11,2H: ,I5,T24,
00865	     6  'MGMT ESCAL',T37,3H: H,I1,2H S,I1,2H T,I1,T50,'RPTD ',
00866	     7  'BY : ',4A5,/1X,'HI KHOST : ',A5,T24,'TECH ESCAL',T37,
00867	     8  2H: ,A3,T51,'RPHONE : ',4A5,/1X,'SPEED    : ',A5,T24,
00868	     9  'DE-ESCAL CODE: ',I3,T50,'PLAN #',T58,2H: ,A2,/1X,
00869	     A  'H/W DIST : ',A5,T24,'DEFER :  ',I3,1H/,I3,T50,'SITE HR ',
00870	     B  2H: ,A5,' TO ',A5,/1X,'BACKBONE : ',A3,T24,'OPEN  : ',
00871	     C  I2,1H-,A3,1H-,I2,1X,A5,1HZ,2X,'CIRCUIT : ',4A5,/1X,
00872	     D  'OPEN BY',T11,2H: ,A3,T24,'RESLV : ',I2,1H-,A3,1H-,I2,
00873	     E  1X,A5,1HZ,T50,'TELCO #',T58,2H: ,4A5,/1X,'ZONE',T11,2H: ,I1,T24,
00874	     F  'CLOSE : ',I2,1H-,A3,1H-,I2,1X,A5,1HZ,T50,'REF TKT#: ',3A5)
00875		TYPE 667,HOUR,TECH,COC,YN(BILL),YN(T40),PROBL
00876	667     FORMAT(T24,'ELAPS : ',F8.1,4H HR.,T50,'ANALYSIS: ',3A5,
00877	     1  /,T24,'CLSCD : '2A5,T49,'BILL/T40: 'A3,1H/,A5,/,
00878	     2  /1X,'REPORTED PROBLEM: ',2A5,/)
00879		GOTO 684
00880	99655   TYPE 99689,NET,SVER,CNAM,TNUM,STAT,SITC,NODE,NETOP(HH),
00881	     1  SITP,KHST,MAINT,LOC,HOST,V1,V2,V3,RNAM,SLOT,YN(ESC),RFON,
00882	     2  PORT,HQCC,COV,PROD,V4,V6,STH,EHR,VER,ID,AM(IM),
00883	     3  IY,TIM1,TECH,SRGN,JD,AM(JM),JY,TUP,CKT,HRGN,
00884	     4  SD,AM(SM),SY,TCLSD,TRB
00885	99689   FORMAT(/1X,'NETWORK',T11,2H: ,2A5,T24,'SEVERITY',T37,2H: ,
00886	     1  I1,T50,'CUSTOMER: ',3A5,/1X,'FRAME TKT: ',I8,T24,'STATE',
00887	     2  T37,2H: ,A5,T50,'CONTACT : ',4A5,/1X,'NODE #',T11,2H: ,
00888	     3  I5,T24,'CONTROL GROUP: ',A5,T51,'CPHONE : ',4A5,/1X,
00889	     4  'DLCI  ',T11,2H: ,I5,T24,'REFERRED TO',T37,2H: ,A5,T50,
00890	     5  'LOCALE',T58,2H: ,4A5,/1X,'CARD #',T11,2H: ,I6,T24,
00891	     6  'MGMT ESCAL',T37,3H: H,I1,2H S,I1,2H T,I1,T50,'RPTD ',
00892	     7  'BY : ',4A5,/1X,'PORT #   : ',A2,T24,'TECH ESCAL',T37,
00893	     8  2H: ,A3,T51,'RPHONE : ',4A5,/1X,'MDLCI    : ',I3,T24,
00894	     9  'DE-ESCAL CODE: ',I3,T50,'PLAN #',T58,2H: ,A2,/1X,
00895	     A  'IPX      : ',A5,T24,'DEFER :  ',I3,1H/,I3,T50,'SITE HR ',
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-16


00896	     B  2H: ,A5,' TO ',A5,/1X,'ROUTER   : ',A5,T24,'OPEN  : ',
00897	     C  I2,1H-,A3,1H-,I2,1X,A5,1HZ,2X,'COM SPEC: ',3A5,/1X,
00898	     D  'S/W DIST',T11,2H: ,A5,T24,'RESLV : ',I2,1H-,A3,1H-,I2,
00899	     E  1X,A5,1HZ,T50,'CKT #',T58,2H: ,4A5,/1X,'H/W DIST : ',A5,T24,
00900	     F  'CLOSE : ',I2,1H-,A3,1H-,I2,1X,A5,1HZ,T50,'IP ADDR : ',4A5)
00901		TYPE 99668,YN(PRO),HOUR,ONUM,INT,COC,YN(BILL),YN(T40),F1,PROBL
00902	99668   FORMAT(1X,'BUNDLED  : ',A3,T24,'ELAPS : ',F8.1,4H HR.,T50,
00903	     1  'REF.TKT#: ',2A5,/1X,'OPEN BY  : ',A3,T24,'CLSCD : '2A5,T49,
00904	     2  'BILL/T40: ',A3,1H/,A5,/1X,'ZONE',T11,2H: ,I1,
00905	     3  /,/1X,'REPORTED PROBLEM: ',2A5,/)
00906		GOTO 684
00907	684     DO 682 ILIN=1,10
00908		N=(ILIN*16)-15
00909		IF (DISC(N).EQ.'.    ') GOTO 690
00910		TYPE 681,(DISC(J),J=N,N+15)
00911	681     FORMAT(1X,15A5,A4)
00912	682     CONTINUE
00913	690     CONTINUE
00914		ENCODE(841,207,DISC)
00915		CALL DBSET(3)
00916		CALL DBFIND('RS',1,1,'OR','RS',1,9,1,1,1,TNUM)
00917		CALL DBNREC(NUMBER)
00918		IF (NUMBER.EQ.0) GOTO 713
00919		TYPE 709
00920	709     FORMAT(/1X,'***ESCALATIONS PERFORMED ...***',/3X,'PERSON',T27,
00921	     1  'DATE/TIME',/)
00922		DO 708 I=1,NUMBER
00923		CALL DBGREC($713,I)
%FTNDIM LINE:00923 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
00924		CALL DBVAL(2,SDAT,3,TIM1,4,RNAM)
00925		CALL DBNDAT(SDAT,IM,ID,IY)
00926		IY=IY-1900
00927		TYPE 707,RNAM,AM(IM),ID,IY,TIM1
00928	707     FORMAT(3X,4A5,T27,A3,1H-,I2,1H-,I2,2X,A5)
00929	708     CONTINUE
00930	713     CALL DBFIND('RS',1,0,'OR','RS',1,8,1,1,1,TNUM)
00931		CALL DBNREC(RECORD)
00932		IF (RECORD.EQ.0) GOTO 712
00933		TYPE 714
00934	714     FORMAT(/1X,'CALL BACK LIST...',/3X,'PERSON',T25,'COMPANY',
00935	     1  T46,'PHONE NUMBER',4X,'TALKED TO ?',/)
00936		DO 718 J=1,RECORD
00937		CALL DBGREC($712,J)
%FTNDIM LINE:00937 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
00938		CALL DBVAL(4,RNAM,7,SITC,8,SITP,13,CHEX,12,cbak)
00939		TYPE 716,CHEX,SITC,RNAM,SITP(1),SITP(2),SITP(3),CBAK(1),
00940	     1  CBAK(2),CBAK(3)
00941	716     FORMAT(1X,A1,1X,4A5,T25,4A5,1X,A5,A5,A5,2X,A5,A5,A5)
00942	718     CONTINUE
00943	712     CALL DBSET(2)
00944	8005    CALL DBFIND(1,1,TNUM)
00945		CALL DBNREC(NUMBER)
00946	C
00947	C
00948	C
00949	C
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-17


00950		IF (NUMBER.EQ.0) GOTO 740
00951	691     TYPE 692,NUMBER
00952	692     FORMAT(/3X,'HOW MANY OF THE LAST ',I3,' STATUS',
00953	     1  ' ENTRIES DO YOU WANT TO LOOK AT?: ',$)
00954		ACCEPT 120,RECORD
00955		IF (RECORD.EQ.0) GOTO 740
00956		IF (RECORD.GT.NUMBER)RECORD=NUMBER
00957		RECORD=NUMBER-RECORD+1
00958		DO 710 I=RECORD,NUMBER
00959		CALL DBGREC($4930,I)
%FTNDIM LINE:00959 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
00960		CALL DBVAL(1,TNUM,2,SDAT,3,TIM1,4,INT,5,RS,6,STAT,7,INFO,8,
00961	     1  PNAM,9,ORDER)
00962		CALL DBNDAT(SDAT,IM,ID,IY)
00963		IY=IY-1900
00964		TYPE 700,ORDER,PNAM,INT,ID,AM(IM),IY,TIM1,AS(RS),TNUM
00965	700     FORMAT(/1X,'--#',I3,' STATUS ENTERED FROM ',3A5,' BY ',A3,' ON ',
00966	     1  I2,1H-,A3,1H-,I2,2H @,A5,' ZULU.',/5X,'REPORT SENT YET ?: ',A3,
00967	     2  T33,1H(,I8,1H))
00968		DO 705 ILIN=1,4
00969		N=(ILIN*16)-15
00970		IF (INFO(N).EQ.'.    ') GOTO 710
00971		TYPE 701,(INFO(J),J=N,N+15)
00972	701     FORMAT(1X,15A5,A4)
00973	705     CONTINUE
00974	710     CONTINUE
00975	711     FORMAT(/,/1X,3A5,2H :,T20,$)
00976		ENCODE(320,233,INFO)
00977	933     FORMAT(95(1H ))
00978	C
00979	C********************
00980	C
00981	C       CHECK FOR MULTIPLE LOOKS
00982	C
00983	C********************
00984	C
00985	740     IF(HDRCHK.EQ.1) GOTO 9741
00986		IF (ANS.EQ.'A') GOTO 3298
00987	9741    TYPE 741,TNUM
00988	741     FORMAT(/1X,'*** ENTER A 1 TO STATUS TICKET # ',I8,' OR NEXT ',
00989	     1  'TICKET NUMBER TO VIEW')
00990		NUM1=TNUM
00991		IF (Z.EQ.2) GOTO 651
00992		TYPE 711,TIC
00993		ACCEPT 120,TNUM
00994		IF (TNUM.GT.2) GOTO 653
00995		IF ((TNUM.EQ.1).AND.(SRT.GE.1)) GOTO 4365
00996		GOTO 4940
00997	C
00998	C       LIST OPEN TICKETS FOR A SPECIFIC NETWORK
00999	C
01000	750     CALL DBOPEN(BAS1)
01001		IF (FLAG.LE.0) GOTO 751
01002		K=FLAG
01003		GOTO 752
01004	751     TYPE 110
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-18


01005		ACCEPT 120,K
01006		IF ((K.GE.1).AND.(K.LE.NUMNET)) GOTO 752
01007		CALL HLPNET
01008		GOTO 751
01009	752     CONTINUE
01010		CALL DBSET(1)
01011		CALL DBFIND(9,1,VNET(K),1,'STAT','NE','CLSD')
01012		CALL DBNREC(NUMBER)
01013		IF (NUMBER.GT.0) GOTO 770
01014		TYPE 760,VNET(K)
01015	760     FORMAT(/5X,' THERE ARE NO TICKETS OPEN FOR ',2A5,' NETWORK',/)
01016		GOTO 4950
01017	770     TYPE 771,NUMBER,TVNET(K)
01018	772     FORMAT(/3X,'THERE ARE ',I3,' TICKETS OPEN...',/,/)
01019	771     FORMAT(/3X,'THERE ARE ',I3,' TICKETS OPEN FOR ',A3,'NET ',
01020	     1  '...',/,/)
01021	773     TYPE 768
01022	775     FORMAT(/3X,'TIC #',1X,'DATE',1X,'PROD.',1X,'NODE',1X,
01023	     1  'COMMENT        SEVERITY',3X,'HOST',1X,'NETWORK',3X,'STAT',
01024	     2  2X,'ATTN.',/)
01025	768     FORMAT(/3X,'TIC#',2X,'DATE',1X,'PROD',3X,'NODE',1X,'COMMENT',
01026	     1  13X,'SVER',1X,'HOST',1X,'STAT',2X,'ATTN.',1X,
01027	     2  'CTGRP    ETIM',/)
01028	776     FORMAT(/3X,'TIC#',1X,'DATE',2X,'PROD',2X,'NODE',2X,'COMMENT',
01029	     1  12X,'SVER',2X,'HOST',1X,'STAT',2X,'ATTN.',1X,
01030	     2  'CTRL GRP ETIM',/)
01031	777     FORMAT(/3X,'TIC#',1X,'DATE',2X,'WHO',3X,'NODE',2X,'CIRCUIT ',
01032	     1  'NUMBER SVER',1X,'HOST',1X,'NETWORK',4X,'STAT',2X,'CON.',
01033	     2  ' GRP.',/)
01034	769     FORMAT(/3X,'TIC#',1X,'DATE',2X,'PROD',3X,'NODE',2X,'COMMENT ',
01035	     1  '       SVER',1X,'HOST',1X,'NETWORK',4X,'STAT',2X,'CON.',
01036	     2  ' GRP.',/)
01037		X=25
01038		IF (ANS.EQ.'4') X=31
01039		DO 790 I=1,NUMBER
01040		CALL DBGREC($4930,I)
%FTNDIM LINE:01040 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
01041		CALL DBVAL(1,TNUM,5,SDAT,6,TIM1,14,PROD,15,STAT,40,NODE,
01042	     1  42,HOST,46,ESC,X,CKT,52,SVER,51,MAINT,53,HH,49,DUP,50,TUP,
01043	     2  54,ELM)
01044		CALL DBNDAT(SDAT,IM,ID,IY)
01045		IY=IY-1900
01046		CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
01047		TYPE 2379,TNUM,IM,ID,PROD,NODE,CKT,SVER,HOST,STAT,MAINT,
01048	     1  NETOP(HH),YY(ESC),HOUR
01049	2379    FORMAT(1X,I6,1X,I2,1H/,I2,1X,A5,1X,I5,1X,4A5,1X,I1,1X,I6,
01050	     1  1X,A5,1X,A5,1X,A5,1X,A1,F6.1)
01051	790     CONTINUE
01052		GOTO 4950
01053	C
01054	C       PULL OPEN TICKET FOR WHAT EVER NETWORK IN THE DATA BASE
01055	C
01056	800     DECODE(5,3244,ANS)M1,M2,M3
01057		IF (M3.EQ.'   ') DECODE(5,3245,ANS)H1,H2,H3,H4,H5
01058		IF (M3.NE.'   ') DECODE(5,3241,ANS)H1,H2,H3,H4
01059		IF (H2.GT.0) TYPE 3243,NETOP(H2)
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-19


01060		CALL FGMT(IA1,IA2,IA3,IA4,IA5,IA6)
01061		IA3=IA3+1900
01062		TYPE 3177,IA4,IA5,AM(IA1),IA2,IA3
01063	802     CALL DBOPEN(BAS1,BAS2)
01064		CALL DBSET(1)
01065		IF (H2.EQ.0) CALL DBFIND('STAT','NE','CLSD')
01066		IF (H2.GT.0) CALL DBFIND('STAT','NE','CLSD',1,'HN',1,H2)
01067		CALL DBNREC(NUMBER)
01068		IF (NUMBER.GT.0) GOTO 820
01069		TYPE 810
01070	810     FORMAT(/,/,' KEEP UP THE GOOD WORK !!!',/,/,/,/9X,
01071	     1  'THERE ARE NO OPEN TICKETS AT ALL ',/,/,/,/,/,/)
01072		GOTO 4950
01073	820     CONTINUE
01074		TYPE 772,NUMBER
01075		TYPE 866
01076	866     FORMAT(/3X,'TIC #',1X,'DATE',1X,'PROD.',1X,'NODE',1X,
01077	     1  'COMMENT        SEVERITY',1X,'NETWORK',3X,'STAT',
01078	     2  2X,'ATTN.CG',2X,'ODUE',/)
01079		DO 870 I=1,NUMBER
01080		CALL DBGREC($4930,I)
%FTNDIM LINE:01080 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
01081		CALL DBVAL(1,TNUM,5,SDAT,6,TIM1,9,NET,14,PROD,15,STAT,40,NODE,
01082	     1  42,HOST,25,COMMNT,52,SVER,51,MAINT,53,HH)
01083		CALL DBNDAT(SDAT,IM,ID,IY)
01084		DUP=0
01085		TUP=0
01086		ELM=0.0
01087		CALL DBSET(2)
01088		CALL DBFIND(1,1,TNUM)
01089		CALL DBNREC(RECORD)
01090		IF (RECORD.EQ.0) GOTO 822
01091		CALL DBGREC($822,RECORD)
01092		CALL DBVAL(2,SDAT,3,TIM1,'UNAM',PNAM)
01093		IF ((PNAM(1).EQ.'NETCO').OR.(PNAM(1).EQ.'NSSC').OR.
01094	     1  (PNAM(1).EQ.'NCF').OR.(PNAM(1).EQ.'CSS80')) GOTO 821
01095		GOTO 822
01096	821    CALL DBGREC($822,RECORD-1)
01097		CALL DBVAL(2,SDAT,3,TIM1)
01098	822    CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
01099		HOUR=(ELM-DVER(SVER))/60.0
01100		TYPE 869,TNUM,IM,ID,PROD,NODE,COMMNT,SVER,NET,STAT,MAINT,
01101	     1  HH,HOUR
01102	869     FORMAT(1X,I6,1X,I2,1H/,I2,1X,A5,1X,I5,1X,4A5,1X,I1,
01103	     1  1X,2A5,A5,1X,A5,1X,I1,1X,F5.1)
01104		CALL DBSET(1)
01105	870     CONTINUE
01106		GOTO 4950
01107	C
01108	C*********************************************
01109	C
01110	C       ENTER HERE FOR CLOSE COMMAND
01111	C
01112	C*********************************************
01113	C
01114	903     CALL RTIM(NTIM,NDAT)
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-20


01115		CALL DBERR($906,IERT,IERC,0)
01116		GOTO 912
01117	906     IF (IERT.NE.7) GOTO 4955
01118		TYPE 908
01119	908     FORMAT(1X'CALL LOG BUSY.. WAITING 10 SECS.')
01120		CALL WAIT(5.0)
01121	912     call dbopen(bas8,'(TNT)STATBK')
01122		CALL DBFIND(1,1,TNUM,1,6,1,0)
01123		CALL DBSRCH(11,1,'   ')
01124		CALL DBNREC(DECIS)
01125		IF (DECIS.EQ.0) GOTO 918
01126	914     TYPE 919
01127	919     FORMAT(1X,'HAVE YOU CALLED BACK ? :')
01128		DO 917 J=1,DECIS
01129		CALL DBGREC($4955,J)
%FTNDIM LINE:01129 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
01130		CALL DBVAL(4,RNAM,7,SITC,8,SITP,12,CBAK)
01131		TYPE 916,SITC,RNAM,SITP
01132	916     FORMAT(1X,4A5,T23,4A5,T45,4A5,T67,'(Y OR N) ? ',$)
01133		ACCEPT 65,SEE
01134		CALL HISET(SEE)
01135		IF (SEE.NE.'Y') GOTO 917
01136		TYPE 907
01137	907     FORMAT(1X,'WITH WHOM DID YOU SPEAK ? ',$)
01138		ACCEPT 100,CBAK
01139		CALL DBERR($99906,IERT,IERC,0)
01140		GOTO 99912
01141	99906   IF (IERT.NE.7) GOTO 4955
01142		TYPE 908
01143		CALL WAIT(5.0)
01144	99912   CALL DBUPD(-1)
01145		CALL DBCHNG(9,NDAT,10,NTIM,11,ME,12,CBAK,13,'*',8,'CLSD')
01146		CALL DBUPD(0)
01147		CALL DBSET(2)
01148		CALL DBFIND(2,1,TNUM)
01149		CALL DBNREC(NUMBER)
01150		IF (NUMBER.EQ.0) GOTO 922
01151		CALL DBSRCH(1,1,RNAM)
01152		CALL DBNREC(NUMBER)
01153		IF (NUMBER.EQ.0) GOTO 922
01154		CALL DBERR($88906,IERT,IERC,0)
01155		GOTO 88912
01156	88906   IF (IERT.NE.7) GOTO 4955
01157		TYPE 908
01158		CALL WAIT(5.0)
01159	88912   CALL DBUPD(-1)
01160		CALL DBCHNG(12,2,8,CBAK)
01161	922     CALL DBSET(1)
01162	917     CONTINUE
01163		CALL DBERR($4930,IERT,IERC,0)
01164		CALL DBFIND(1,1,TNUM,1,6,1,0)
01165		CALL DBSRCH(11,1,'   ')
01166		CALL DBNREC(DECIS)
01167		IF (DECIS.GT.0) GOTO 921
01168		CALL DBFIND(1,1,TNUM,1,6,1,1)
01169		CALL DBNREC(DECIS)
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-21


01170		IF(DECIS.EQ.0) GOTO 925
01171		CALL DBCHNG('RS',4)
01172		GOTO 925
01173	921     TYPE 923,TNUM,DECIS
01174	923     FORMAT(1X,'TICKET NUMBER ',I8,' CAN NOT BE CLOSED YET.'/2X,
01175	     1  'YOU STILL HAVE TO CALL ',I2,' CUSTOMER(S) BACK.')
01176		GOTO 4950
01177	925     CALL DBCLOS
01178	918     TYPE 920
01179	920     FORMAT(/'+WHY IS THIS TICKET BEING CLOSED ?',/)
01180		DO 930 ILIN=1,4
01181		N=(ILIN*16)-15
01182		ACCEPT 225,(INFO(J),J=N,N+15)
01183		IF (INFO(N).EQ.'.    ') GOTO 937
01184		NLINE=ILIN
01185	930     CONTINUE
01186	937     CALL CSTAT(INFO,TRASH,Z,TNUM)
01187		IF (TRASH.EQ.' ') GOTO 935
01188		GOTO 918
01189	935     RS=4
01190		IF (ELM.GT.0) GOTO 939
01191		IF (DUP.EQ.0) CALL GETIM(TUP,DUP)
01192		CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
01193		CALL VDIS(V4,V6,ELM)
01194	939     IF (STAT.EQ.'MONIT') CALL GTIM(TIM1,SDAT,LIC)
01195		CALL RESCOD(TNUM,CCC,ANS,L)
01196		IF (ESC.EQ.2) CALL GETDES(HQCC,ONUM)
01197	932     CALL DBERR($931,IERT,IERC,0)
01198		GOTO 934
01199	931     IF (IERT.NE.7) GOTO 4955
01200		TYPE 1379
01201		CALL WAIT(6.0)
01202	934     CALL DBOPEN(BAS1)
01203		CALL DBUPD(-1)
01204		CALL DBFIND(1,1,TNUM)
01205	C
01206	C       FORCE ELM NEGATIVE FOR TRACK ONLY TICKETS - PREVENT FROM
01207	C       APPEARING IN THE MTTR REPORTS
01208	C
01209		IF (STAT.NE.'TRACK') GOTO 938
01210		TET=ELM*2
01211		ELM=ELM-TET
01212	938     CALL DBCHNG(11,4,'STAT','CLSD',54,ELM,56,ME,
01213	     1  34,V5,35,V6,36,V1,37,V2,38,V3,39,V4,26,NDAT,27,NTIM)
01214		IF (STAT.EQ.'OPEN') CALL DBCHNG(49,DUP,50,TUP)
01215		IF (COC(1).EQ.'.....') CALL DBCHNG(55,CODE(CCC),17,CCC)
01216		IF (ESC.EQ.2) CALL DBCHNG(46,3,18,HQCC,19,ONUM)
01217		CALL DBCLOS
01218		call dberr($10935,iert,ierc,0)
01219		goto 936
01220	10935   IF (IERT.NE.7) GOTO 4955
01221		TYPE 1379
01222		call wait(6.0)
01223	936     call dbopen(bas2)
01224		call dbupd(-1)
01225		CALL DBFIND(1,1,TNUM)
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-22


01226		CALL DBNREC(ORDER)
01227		ORDER=ORDER+1
01228		CALL DBADD(1,TNUM,2,NDAT,3,NTIM,4,ME,5,rs,6,'CLSD',7,INFO,8,
01229	     1  UNAM,9,ORDER)
01230	942     ENCODE(320,233,INFO)
01231		CALL DBFIND(1,1,TNUM)
01232		CALL DBCHNG(5,8)
01233		CALL DBCLOS
01234		CALL DBERR($943,IERT,IERC,0)
01235		GOTO 945
01236	943     IF (IERT.NE.7) GOTO 4955
01237		TYPE 1379
01238		CALL WAIT(6.0)
01239	945     CALL DBOPEN(BAS6)
01240		CALL DBUPD(-1)
01241		CALL DBFIND(1,1,TNUM)
01242		CALL DBNREC(NUMBER)
01243		IF (NUMBER.EQ.0) GOTO 940
01244		CALL DBCHNG(6,8)
01245		CALL DBGREC($944,NUMBER)
01246		CALL DBCHNG(4,DUP,5,TUP,7,'CLSD')
01247	944     CALL DBCLOS
01248		CALL DBERR($4930,IERT,IERC,0)
01249		GOTO 235
01250	940     CALL DBOPEN(BAS1)
01251		CALL DBFIND(1,1,TNUM)
01252		CALL DBGREC($4930,1)
01253		CALL DBVAL(5,SDAT,6,TIM1,9,NET,14,PROD,51,MAINT,52,SVER)
01254		CALL DBERR($946,IERT,IERC,0)
01255		GOTO 948
01256	946     IF (IERT.NE.7) GOTO 4955
01257		TYPE 1379
01258		CALL WAIT(5.5)
01259	948     CALL DBOPEN(BAS6)
01260		CALL DBUPD(-1)
01261		CALL DBADD(1,TNUM,2,SDAT,3,TIM1,4,DUP,5,TUP,6,8,8,MAINT,10,
01262	     1  NET,11,SVER,12,PROD)
01263		CALL DBERR($949,IERT,IERC,0)
01264		GOTO 950
01265	949     IF (IERT.NE.7) GOTO 4955
01266		TYPE 1379
01267		CALL WAIT(5.5)
01268	950     CALL DBOPEN('(TNT)STATBK')
01269		CALL DBFIND(2,1,TNUM)
01270		CALL DBNREC(NUMBER)
01271		IF (NUMBER.EQ.0) GOTO 99948
01272		CALL DBUPD(-1)
01273		CALL DBCHNG(9,TIM1,10,SDAT,11,ME,8,'CLOSED',12,2)
01274	99948   CALL DBERR($4930,IERT,IERC,0)
01275		CALL DBCLOS
01276		GOTO 235
01277	C
01278	C
01279	C       THIS WILL CREATE A TICKET NUMBER TO START THE DATA BASE WITH
01280	C       OR TO RESTORE IT WHEN ONE IS GONE.
01281	C
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-23


01282	1360    TYPE 1415,NUMBER
01283		GOTO 1400
01284	1370    TYPE 1375
01285	1400    CALL DBOPEN(BAS1,BAS4)
01286	1405    FORMAT(/3X,'THE DATA BASE SHOWS A GOOD VALUE FOR TICKET NUMBE'
01287	     1  'RS',/6X,'THE VALUE IS ',I5)
01288	1415    FORMAT(/3X,'!! TROUBLE IN RIVER CITY! - THERE ARE ',I2,
01289	     1  ' DIFFERENT TICKET NUMBERS.')
01290	1420    CALL DBSET(2)
01291		CALL DBSYSV(1,0,SDAT)
01292		CALL DBFIND('ALL')
01293		CALL DBNREC(RECORD)
01294		CALL DBSET(1)
01295		CALL DBFIND('ALL')
01296		CALL DBNREC(NUMBER)
01297		TNUM=NUMBER+RECORD
01298	1421    CALL DBFIND(1,'GT',TNUM)
01299		CALL DBNREC(RECORD)
01300		IF (RECORD.EQ.0) GOTO 1422
01301		CALL DBGREC($1400,RECORD)
01302		CALL DBVAL(1,TNUM)
01303		GOTO 1421
01304	1422    TNUM=TNUM+1
01305		CALL DBERR($1410,IERT,IERC,0)
01306		GOTO 1412
01307	1410    IF (IERT.NE.7) GOTO 4955
01308		TYPE 151
01309		CALL WAIT(5.0)
01310	1412    CALL DBOPEN('(TNT)TNUM')
01311		CALL DBUPD(-1)
01312		CALL DBFIND('ALL')
01313		CALL DBNREC(NUMBER)
01314		IF (NUMBER.EQ.1) GOTO 1426
01315		CALL DBDEL
01316		CALL DBADD(1,TNUM,2,9)
01317		GOTO 1411
01318	1426    TNUM=TNUM+1
01319		CALL DBCHNG(1,TNUM)
01320	1411    TYPE 1425,TNUM
01321	1425    FORMAT(/3X,'THE NEW TICKET NUMBER WILL BE ',I5)
01322	1427    CALL DBERR($4930,IERT,IERC,0)
01323		IF (N.EQ.5) GOTO 138
01324		GOTO 4950
01325	C
01326	C       ROUTINE TO WRITE DATA TO DISK
01327	C
01328	2000    K=14
01329		I=1
01330		CALL DBOPEN(BAS1,BAS2,BAS8,BAS4,BAS5,BAS9)
01331		IF (ANS.EQ.'MOTO') GOTO 2035
01332		TYPE 2010
01333	2010    FORMAT(1H+,'DO YOU WANT A FILE WRITTEN BY NETWORK(N), ',/,
01334	     1  ' TICKET(T) NUMBER ?, OR SUPPORT GROUP(S)(N,T,S) : ',$)
01335		CALL DBOPEN(BAS1,BAS2,BAS8,BAS4,BAS5,BAS9)
01336	2015    ACCEPT 65,WELL
01337		CALL HISET(WELL)
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-24


01338		IF (WELL.EQ.'N') GOTO 2034
01339		IF (WELL.EQ.'T') GOTO 2050
01340		IF (WELL.EQ.'S') GOTO 2001
01341		IF (I.EQ.3) GOTO 4945
01342		TYPE 2030
01343	2030    FORMAT(/1X,'WHAT ?   ',T20,$)
01344		GOTO 2015
01345	C
01346	C       CHECK TO SEE WHAT SUPPORT GROUP
01347	C
01348	2001    L=5
01349		I=1
01350	2002    TYPE 2531
01351		ACCEPT 120,M
01352		IF ((M.GE.LOATTN).AND.(M.LE.HIATTN)) GOTO 2005
01353		IF ((M.EQ.0).OR.(I.EQ.2)) CALL HREFR
01354		IF (I.EQ.3) GOTO 59
01355		I=I+1
01356		GOTO 2002
01357	C
01358	C       NOW OPEN FILE FOR TICKETS
01359	C
01360	2005    ENCODE(9,2003,FILE)ATTN(M)
01361	2003    FORMAT(A5,4H.OUT)
01362		OPEN(unit=8,device='DSK',access='SEQOUT',file=FILE)
01363		CALL DBSET(1)
01364		CALL DBFIND(51,1,ATTN(M),1,15,'NE','CLSD')
01365		CALL DBNREC(NUMBER)
01366		IF (NUMBER.GT.0) GOTO 2082
01367		TYPE 2036
01368		CLOSE(unit=8)
01369		TYPE 3651,FILE
01370	3651    FORMAT(1X,'CLOSING FILE : ',3A5)
01371		GOTO 4950
01372	C
01373	C       CHECK TO SEE IF THEY WANT ONLY OPEN TICKETS
01374	C
01375	2034    TYPE 2031
01376	2031    FORMAT(/1X,'YOU HAVE TWO CHOICES...',/5X,'1. = ONLY OPEN ',
01377	     1  'TICKETS',/5X,'2. = TICKETS OPENED SINCE A GIVEN DATE',/3X,
01378	     2  'ENTER CHOICE : ',T20,$)
01379	2033    ACCEPT 65,WELL
01380		CALL HISET(WELL)
01381		IF (WELL.EQ.'1') GOTO 2038
01382		IF (WELL.EQ.'2') GOTO 2059
01383		TYPE 2030
01384		GOTO 2033
01385	2038    IF (FLAG.LE.0) GOTO 2039
01386		K=FLAG
01387		GOTO 2035
01388	2039    TYPE 110
01389		ACCEPT 120,K
01390		IF ((K.GE.1).AND.(K.LE.NUMNET)) GOTO 2035
01391		CALL HLPNET
01392		GOTO 2039
01393	2035    CALL DBSET(1)
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-25


01394		L=0
01395		IF (ANS.NE.'MOTO') GOTO 8050
01396		CALL DBFIND(9,1,'TYMNET')
01397		CALL DBSRCH(31,'CT','MOTOROLA')
01398		CALL DBSRCH(15,1,'OPEN')
01399		CALL DBNREC(NUMBER)
01400		IF (NUMBER.LT.1) GOTO 4950
01401	C	This used to say 'GOTO 2036' if (number.lt.1)
01402	
01403	
01404		OPEN(unit=8,device='DSK',access='SEQOUT',file='MOTORN')
01405		GOTO 82081
01406	8050    CALL DBFIND(9,1,VNET(K),1,'STAT','NE','CLSD')
01407		CALL DBSRCH('STAT','NE','TRACK')
01408		IF (ANS.EQ.'WK') CALL DBSRCH(53,1,1)
01409		CALL DBNREC(NUMBER)
01410		IF (NUMBER.GT.0) GOTO 2037
01411		IF (L.EQ.2) GOTO 2454
01412		TYPE 2036
01413	2036    FORMAT(/5X,' NO RECORDS FOUND, SO NO FILE WAS CREATED',/)
01414		GOTO 4950
01415	2037	OPEN(unit=8,device='DSK',access='SEQOUT',file=VNET(K))
01416		GOTO 2082
01417	2050    TYPE 170,TIC
01418		ACCEPT 120,TNUM
01419		L=1
01420	2060    CALL DBSET(1)
01421		CALL DBFIND(1,1,TNUM)
01422		CALL DBNREC(NUMBER)
01423		IF (NUMBER.GT.0) GOTO 2080
01424		L=2
01425		CALL DBSET(4)
01426		CALL DBFIND(1,1,TNUM)
01427		CALL DBNREC(NUMBER)
01428		IF (NUMBER.GT.0) GOTO 2080
01429		L=1
01430		H2=TNUM/10000
01431		IF (H2.GT.9) GOTO 20300
01432		ENCODE(15,661,BAS11)H2
01433		ENCODE(15,662,BAS12)H2
01434		ENCODE(15,663,BAS19)H2
01435		GOTO 20305
01436	20300   ENCODE(15,301,BAS11)H2
01437		ENCODE(15,302,BAS12)H2
01438		ENCODE(15,303,BAS19)H2
01439	20305   CALL DBERR($20659,IERT,IERC,0)
01440		CALL DBOPEN(BAS11,BAS12,BAS19)
01441		CALL DBFIND(1,1,TNUM)
01442		CALL DBNREC(NUMBER)
01443		IF (NUMBER.GT.0) GOTO 2080
01444	20659   TYPE 660,TNUM
01445		I=I+1
01446		IF (I.NE.3)GOTO 2050
01447		TYPE 665
01448		GOTO 4950
01449	2080    IF (TNUM.LT.100000) ENCODE(9,2086,FILE)TNUM
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-26


01450	2087    FORMAT(I6,'.OUT')
01451		IF (TNUM.GT.99999) ENCODE(10,2087,FILE)TNUM
01452	2086    FORMAT(I5,'.OUT')
01453		OPEN(unit=8,device='DSK',access='SEQOUT',file=FILE)
01454	2082    TYPE 2081,NUMBER
01455	2081    FORMAT(/5X,'THERE ARE ',I3,' TICKETS TO WRITE TO DISK',/)
01456	82081	DO 2142 X=1,NUMBER
01457		CALL DBGREC($4840,X)
%FTNDIM LINE:01457 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
01458	2083    FORMAT(1X,'WRITING TICKET # ',I8,' TO DISK',
01459	     1  5X,'REC. # ',I3)
01460		WRITE(8,2084)FF
01461	2084    FORMAT(/,A5,/)
01462		CALL WWHD(TNUM)
01463		TYPE 2083,TNUM,X
01464		CALL DBSET(2)
01465		IF (L.EQ.2) CALL DBSET(5)
01466		CALL DBFIND(1,1,TNUM)
01467		CALL DBNREC(RECORD)
01468		IF (RECORD.EQ.0) GOTO 2141
01469		CALL DBSORT('ORDER')
01470		DO 2140 M=1,RECORD
01471		CALL DBGREC($4830,M)
%FTNDIM LINE:01471 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
01472		CALL DBVAL(2,SDAT,3,TIM1,4,INT,7,INFO,8,PNAM,9,ORDER,5,RS)
01473		CALL DBNDAT(SDAT,IM,ID,IY)
01474		IY=IY-1900
01475		WRITE(8,380)ORDER,PNAM,INT,ID,AM(IM),IY,TIM1,AS(RS)
01476	380     FORMAT(/1X,'--#',I3,' STATUS ENTERED FROM ',3A5,' BY ',A3,' ON ',
01477	     1  I2,1H-,A3,1H-,I2,2H @,A5,' ZULU.',/5X,'REPORT SENT YET ?: ',A3)
01478		CALL WINFO(INFO)
01479	2140    CONTINUE
01480	2141    CALL DBSET(1)
01481		IF (L.EQ.2) CALL DBSET(4)
01482	2142    CONTINUE
01483	2150    CLOSE(unit=8)
01484		TYPE 3651,FILE
01485		GOTO 4950
01486	C
01487	C       NEW LISTING COMMAND
01488	C
01489	2320    TYPE 2325
01490	2325    FORMAT(/3X,'THIS COMMAND WILL DISPLAY TICKETS EVER CREATED BY',
01491	     1  ' TOPIC.',/5X,'THE TOPICS ARE...',/10X,'1 = CIRCUIT NUMBER',
01492	     2  /10X,'2 = NODE + NETWORK',/10X,'3 = HOST + NETWORK',/2X'ENTER',
01493	     3  ' THE NUMBER: ',$)
01494		CALL DBOPEN(BAS1)
01495		CALL DBSET(1)
01496		ACCEPT 120,N
01497		IF ((N.LT.1).AND.(N.GT.3)) GOTO 2320
01498		IF ((N.EQ.2).OR.(N.EQ.3)) GOTO 2344
01499		TYPE 203,OCKT
01500		ACCEPT 100,CKT
01501	2326    CALL DBFIND('CKT',1,CKT)
01502		GOTO 2360
01503	2335    TYPE 188,NO
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-27


01504		ACCEPT 120,NODE
01505	2327    CALL DBFIND(9,1,VNET(K),1,40,1,NODE)
01506		GOTO 2360
01507	2340    TYPE 188,HO
01508		ACCEPT 194,HOST
01509	2328    CALL DBFIND(9,1,VNET(K),1,42,1,HOST)
01510		GOTO 2360
01511	2344    IF (FLAG.LE.0) GOTO 2345
01512		K=FLAG
01513		GOTO 2346
01514	2345    TYPE 110
01515		ACCEPT 120,K
01516		IF(K.EQ.0) CALL HLPNET
01517		IF ((K.LT.1).OR.(K.GT.NUMNET)) GOTO 2345
01518	2346    IF (N.EQ.2) GOTO 2335
01519		IF (N.EQ.3) GOTO 2340
01520		GOTO 2360
01521	2360    CALL DBNREC(NUM1)
01522		IF (NUM1.EQ.0) GOTO 2365
01523		TYPE 775
01524	2330    DO 2365 I=1,NUM1
01525		CALL DBGREC($59,I)
%FTNDIM LINE:01525 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
01526		CALL DBVAL(1,TNUM,5,SDAT,6,TIM1,9,NET,14,PROD,15,STAT,40,NODE,
01527	     1  42,HOST,25,COMMNT,52,SVER,51,MAINT)
01528		CALL DBNDAT(SDAT,IM,ID,IY)
01529		TYPE 2380,TNUM,IM,ID,PROD,NODE,COMMNT,SVER,HOST,NET,STAT,MAINT,
01530	     1  HH
01531	2380    FORMAT(1X,I6,1X,I2,1H/,I2,1X,A5,1X,I5,1X,4A5,1X,I1,
01532	     1  1X,I6,1X,2A5,A5,1X,A5,1X,I1)
01533	2377    FORMAT(1X,I6,1X,I2,1H/,I2,1X,A5,1X,I5,1X,3A5,6X,I1,
01534	     1  1X,I6,1X,2A5,A5,1X,A5,1X,I1)
01535	2365    CONTINUE
01536		TYPE 2370
01537		TYPE 2119
01538	2119    FORMAT(/1X'DO YOU WANT TO OPEN THE OLD DATABASE ? : ',$)
01539		ACCEPT 65,WELL
01540		CALL HISET(WELL)
01541		IF (WELL.EQ.'Y') GOTO 2371
01542		GOTO 4950
01543	2371    CALL DBOPEN(BAS4)
01544		IF (N.EQ.1) GOTO 2326
01545		IF (N.EQ.2) GOTO 2327
01546		IF (N.EQ.3) GOTO 2328
01547	2375    TYPE 2370
01548	2370    FORMAT(/3X,'SEARCH FOR DATA COMPLETE')
01549		GOTO 4950
01550	C
01551	C       THIS WILL ALLOW YOU TO CHANGE ATTRIBUTES...
01552	C
01553	2382    TYPE 801
01554	801     FORMAT(/1X,'YOU DO NOT HAVE ACCESS TO THIS COMMAND')
01555		GOTO 59
01556	2383    N=1
01557		M=42
01558		STAT='MONIT'
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-28


01559		GOTO 2399
01560	2381    TYPE 2385,RW2,RP2
01561	2385    FORMAT(/1X,'THIS COMMAND WILL ALLOW YOU TO CHANGE AN ',
01562	     1  'ITEM IN AN ENTIRE TICKET',/4X,'*1 = SUPPORT AREA',T29,'*2 = ',
01563	     2  'PROD TYPE/IPX NAME',/5X'3 = SEVERITY',T29,'*4 = CIRCUIT ',
01564	     3  'NUMBER',/4X'*5 = TRB #/IP ADDRESS',T29,'*6 = SITE CONTACT',
01565	     4  /4X,'*7 = SITE PHONE #',T29,'*8 = NODE NUMBER',/4X'*9 = HOST #',
01566	     5  '/IPX CARD #',T28,'*10 = SLOT #/IPX PORT #',/3X'*11 = ',3A5,T28,
01567	     6  '*12 = ',3A5,/4X,'13 = CONTROL GROUP',T29,'14 = DATE UP',/4X,
01568	     7  '15 = TIME UP',T29,'16 = DATE DOWN',/4X,'17 = TIME DOWN',
01569	     8  T29,'18 = ELAPSED TIME (AFTER CLOSING TIC.)',
01570	     9  /3X,'*19 = COMMENT',T29,'20 = REFERANCE NUMBER',/3X,'*21 = ',
01571	     A  'CUSTOMER',T28,'*22 = TECH SUPPORT',/4X,'23 = PRODUCTION STATUS',
01572	     B  T29,'24 = TOP 40 STATUS',/4X,'25 = BILLABLE',T29,'26 = PORTS',
01573	     C  /3X,'*27 = LOCATION',T28,'*28 = KERNAL/DLCI',/4X,'29 = CONTRACT',
01574	     D  T29,'30 = START HOUR',/4X,'31 = END HOUR',T28,'*32 = VERSION/',
01575	     E  'ROUTER',/3X,'*33 = LONODE',T28,'*34 = HINODE',/3X,
01576	     F  '*35 = SOFTWARE DISTRICT',T28,'*36 = HARDWARE DISTRICT',
01577	     G  /2X,'* DENOTES FIELD CHANGABLE ITEMS')
01578		TYPE 2386
01579	2386    FORMAT(1X,'ENTER ITEM NUMBER : ',$)
01580		ACCEPT 120,N
01581		IF (N.GT.36) GOTO 2381
01582		IF (N.LE.0) GOTO 59
01583		IF ((N.EQ.35.).OR.(N.EQ.36)) GOTO 5000
01584		IF (N.EQ.1) GOTO 2384
01585		IF (N.EQ.2) GOTO 2384
01586		IF (N.EQ.4) GOTO 2414
01587		IF (N.EQ.5) GOTO 2415
01588		IF (N.EQ.6) GOTO 2416
01589		IF (N.EQ.7) GOTO 2417
01590		IF (N.EQ.12) GOTO 2427
01591		IF (N.EQ.32) GOTO 2448
01592		IF (N.EQ.8) GOTO 2418
01593		IF (N.EQ.9) GOTO 2419
01594		IF (N.EQ.10) GOTO 2423
01595		IF (N.EQ.11) GOTO 2424
01596		IF (N.EQ.21) GOTO 2437
01597		IF (N.EQ.27) GOTO 2443
01598		IF (N.EQ.22) GOTO 2438
01599		IF (N.EQ.33) GOTO 2418
01600		IF (N.EQ.34) GOTO 2419
01601		IF (N.EQ.28) GOTO 2444
01602		IF (N.EQ.19) GOTO 2434
01603		IF ((FLAG.GE.0).AND.(N.GT.1)) GOTO 2382
01604		IF (N.EQ.13) GOTO 2428
01605		IF (N.EQ.14) GOTO 2429
01606		IF (N.EQ.15) GOTO 2430
01607		IF (N.EQ.16) GOTO 2431
01608		IF (N.EQ.17) GOTO 2432
01609		IF (N.EQ.18) GOTO 2433
01610		IF (N.EQ.20) GOTO 2436
01611		IF (N.EQ.23) GOTO 2439
01612		IF (N.EQ.24) GOTO 2440
01613		IF (N.EQ.25) GOTO 2441
01614		IF (N.EQ.26) GOTO 2442
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-29


01615		IF (N.EQ.29) GOTO 2445
01616		IF (N.EQ.30) GOTO 2446
01617		IF (N.EQ.31) GOTO 2447
01618	2384    IF(ANS.EQ.'G') TYPE 170,TIC
01619		CALL DBOPEN(BAS1)
01620		IF (ANS.EQ.'G') ACCEPT 120,TNUM
01621		IF (TNUM.EQ.0) GOTO 4950
01622	2378    CALL DBFIND(1,1,TNUM)
01623		CALL DBNREC(NUMBER)
01624		IF (NUMBER.EQ.0) GOTO 2375
01625		CALL DBGREC($4800,NUMBER)
01626		CALL DBVAL(5,NDAT,6,NTIM,51,MAINT,52,SVER,15,STAT,9,NET,
01627	     1  14,PROD,11,RS,46,ESC,47,F1,17,CCC)
01628		IF((NET(1).EQ.'FRAME').AND.(N.EQ.2)) CALL IPXCHG(TNUM,ME)
01629		IF((NET(1).EQ.'FRAME').AND.(N.EQ.2)) GOTO 2381
01630		I=1
01631		IF (N.EQ.2) GOTO 2406
01632		IF (N.EQ.3) GOTO 2388
01633	2389    TYPE 2390,MAINT
01634	2390    FORMAT(/1X,'THE VALUE FOR SUPPORT GROUP IS : ',A5,
01635	     1  /,/2X,'ENTER THE NEW VALUE OR A CARRIAGE RETURN IF YOU DO',
01636	     2  ' NOT WISH TO CHANGE IT')
01637	2391    FORMAT(/3X,'ENTER THE NUMBER FOR THE GROUP WITH THE PROBLEM',
01638	     1  /4X,'OR ENTER NEGATIVE ONE FOR HELP : ',$)
01639	82391        TYPE 2391
01640		ACCEPT 120,M
01641		IF (M.EQ.0) GOTO 2402
01642		IF ((M.GE.LOATTN).AND.(M.LE.HIATTN)) GOTO 2399
01643		IF ((M.EQ.-1).OR.(I.EQ.3)) CALL HREFR
01644		I=I+1
01645		GOTO 2389
01646	2399    IF (ATTN(M).NE.'     ') GOTO 92389
01647		TYPE 92391,M
01648	92391   FORMAT(/1X,'GROUP ',I3,' IS UNUSED AT THIS TIME.  PLEASE ',
01649	     1  'RESELECT.',/1X)
01650		GOTO 82391
01651	C	^^^^^^^^^^ This used to say 'GOTO 2391' a format statement.
01652	92389   IF (ANS.EQ.'G') CALL GTIM(TIM1,SDAT,LIC)
01653		IF (N.NE.2) GOTO 23999
01654		IF (TYPE(P).EQ.'     ') TYPE 92399,P
01655	92399   FORMAT(/1X,'PRODUCT ID #',I3,' IS CURRENTLY UNUSED.  PLEASE ',
01656	     1  'SELECT ANOTHER.',/1X)
01657		IF (TYPE(P).EQ.'     ') GOTO 2406
01658	23999   IF (N.NE.1) GOTO 92401
01659		IF (UNAM(1).NE.'TELEC') CALL RESCOD(TNUM,CCC,ANS,L)
01660		IF ((M.EQ.41).OR.(M.EQ.36).OR.(M.EQ.21).OR.(M.EQ.25)
01661	     1  .OR.(M.EQ.29).OR.(M.EQ.30).OR.(M.EQ.72).OR.(M.EQ.81).OR.
01662	     2  (M.EQ.71)) ESC=2
01663	92401   CALL DBERR($2401,IERT,IERC,0)
01664		GOTO 2403
01665	2401    IF (IERT.NE.7) GOTO 4955
01666		TYPE 1379
01667		CALL WAIT(8.0)
01668	2403    CALL DBOPEN(BAS1)
01669		CALL DBUPD(-1)
01670		CALL DBFIND(1,1,TNUM)
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-30


01671		IF ((M.EQ.41).OR.(M.EQ.36).OR.(M.EQ.21).OR.(M.EQ.25)
01672	     1  .OR.(M.EQ.29).OR.(M.EQ.30).OR.(M.EQ.72).OR.(M.EQ.81).OR.
01673	     2  (M.EQ.71)) ESC=2
01674		IF (N.EQ.1) CALL DBCHNG(51,ATTN(M),46,ESC)
01675		IF (N.EQ.2) CALL DBCHNG(14,TYPE(P))
01676		IF (N.EQ.3) CALL DBCHNG(52,IVER(K))
01677		CALL DBCLOS
01678		CALL DBERR($2404,IERT,IERC,0)
01679		GOTO 2405
01680	2404    IF (IERT.NE.7) GOTO 4955
01681		TYPE 1379
01682		CALL WAIT(6.0)
01683	2405    CALL DBOPEN(BAS6)
01684		CALL DBUPD(-1)
01685		CALL DBFIND(1,1,TNUM)
01686		CALL DBNREC(RECORD)
01687		IF (RECORD.GT.0) GOTO 2392
01688		CALL DBADD(1,TNUM,2,NDAT,3,NTIM,7,STAT,8,MAINT,10,NET,
01689	     1  11,SVER,12,PROD,17,F1,14,ME)
01690		CALL DBFIND(1,1,TNUM)
01691		RECORD=1
01692	2392    CALL DBGREC($2381,RECORD)
01693		CALL DBVAL(2,TDAT,3,TTIM)
01694		IF ((TDAT.EQ.0).OR.(TTIM.EQ.0)) CALL DBCHNG(2,NDAT,3,NTIM)
01695		IF (N.EQ.1) CALL DBCHNG(4,SDAT,5,TIM1)
01696		IF (STAT.EQ.'CLSD') GOTO 2400
01697		IF (N.EQ.2) CALL DBCHNG(12,TYPE(P))
01698		IF (N.EQ.3) CALL DBCHNG(11,IVER(K))
01699		IF (N.EQ.1) CALL DBADD (1,TNUM,2,SDAT,3,TIM1,
01700	     1  7,STAT,8,ATTN(M),10,NET,11,SVER,12,PROD,17,F1,14,ME,13,CCC)
01701	2400    CALL DBCLOS
01702	2402    CALL DBERR($4930,IERT,IERC,0)
01703		IF ((N.GT.1).OR.(M.EQ.0)) GOTO 59
01704		GOTO 4350
01705	2406    TYPE 2410,PROD,PT
01706	2410    FORMAT(/1X,'THE CURRENT VALUE FOR PRODUCT TYPE IS : ',A5,
01707	     1  /,1X'ENTER THE NEW PRODUCT CODE OR A (CR.) FOR NO CHANGE'/2X,
01708	     2  'ENTER A NEGATIVE ONE(-1) IF YOU NEED HELP',/1X,3A5,3H : ,$)
01709		ACCEPT 120,P
01710		IF ((P.GE.1).AND.(P.LE.NTYPE)) GOTO 2399
01711		IF (P.EQ.0) GOTO 4950
01712		IF ((P.EQ.-1).OR.(I.EQ.2)) CALL HPROD
01713		IF (I.EQ.3) GOTO 59
01714		I=I+1
01715		GOTO 2406
01716	2388    TYPE 2387,SVER,OSVR
01717	2387    FORMAT(/1X,'THE CURRENT VALUE FOR SEVERITY IS : ',I1,
01718	     1  /1X,'ENTER THE NEW SEVERITY CODE OR A (CR.) FOR NO CHANGE'/2X,
01719	     2  2A5,3H : ,$)
01720		ACCEPT 120,K
01721		IF (K.EQ.0) GOTO 4950
01722		IF ((K.LT.0).OR.(K.GT.4)) GOTO 2388
01723		CALL RTIM(TIM1,SDAT)
01724		CALL DBERR($8100,IERT,IERC,0)
01725		GOTO 8101
01726	8100    IF (IERT.NE.7) GOTO 4955
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-31


01727		TYPE 1379
01728		CALL WAIT(5.0)
01729	8101    CALL DBOPEN('(TNT)BASE3')
01730		CALL DBUPD(-1)
01731		ENCODE(5,8103,OSVER)SVER
01732	8103    FORMAT(2X,I1,2X)
01733		CALL DBADD(1,TNUM,2,SDAT,3,TIM1,4,ME,5,'SVCHG',6,K,7,OSVER,8,
01734	     1  UNAM)
01735		CALL DBCLOS
01736		CALL GETC(6,UNAM,PCE)
01737		IF(PCE.EQ."040) GOTO 88113
01738		CALL GETC(11,UNAM,PCE)
01739		IF(PCE.EQ."040) GOTO 88123
01740		ENCODE(90,98103,INFO)UNAM,ME,SVER,K
01741	98103   FORMAT(3A5,1H(,A3,1H),' CHANGED SEVERITY FROM ',I1,' TO ',
01742	     1  I1,31X,'.',5X)
01743		GOTO 98133
01744	88113   ENCODE(90,98113,INFO)UNAM(1),ME,SVER,K
01745	98113   FORMAT(A5,1H(,A3,1H),' CHANGED SEVERITY FROM ',I1,' TO ',
01746	     1  I1,41X,'.',5X)
01747		GOTO 98133
01748	88123   ENCODE(90,98123,INFO)UNAM(1),UNAM(2),ME,SVER,K
01749	98123   FORMAT(A5,A5,1H(,A3,1H),' CHANGED SEVERITY FROM ',I1,' TO ',
01750	     1  I1,36X,'.',5X)
01751	98133   CALL DBERR($98104,IERT,IERC,0)
01752		GOTO 98105
01753	98104   IF(IERT.NE.7) GOTO 4931
01754		TYPE 1379
01755		CALL WAIT(6.0)
01756	98105   CALL DBOPEN(BAS2)
01757		CALL DBUPD(-1)
01758		CALL DBFIND(1,1,TNUM)
01759		CALL DBNREC(NUMBER)
01760		ORDER=NUMBER+1
01761		CALL DBADD(1,TNUM,2,SDAT,3,TIM1,4,ME,5,5,6,STAT,7,INFO,8,UNAM,
01762	     1  9,ORDER,10,0)
01763		CALL DBCLOS
01764		ENCODE(95,933,INFO)
01765		GOTO 2399
01766	2414    CALL CHA4A5(BAS1,BAS10,43,7,'CIRCUIT # ')
01767		GOTO 2381
01768	2415    CALL CHA4A5(BAS1,BAS10,44,8,'TELCO TRB#')
01769		GOTO 2381
01770	2416    CALL CHA4A5(BAS1,BAS10,12,1,'SITE CONT.')
01771		GOTO 2381
01772	2417    CALL CHA4A5(BAS1,BAS10,13,2,'SITE PHONE')
01773		GOTO 2381
01774	2418    CALL CH1I(BAS1,BAS10,40,4,'NODE/LOWND')
01775		GOTO 2381
01776	2419    CALL CH1I(BAS1,BAS10,42,6,'HOST/HINOD')
01777		GOTO 2381
01778	2423    CALL CHA4A5(BAS1,BAS10,41,5,'SLOT      ')
01779		GOTO 2381
01780	2424    CALL CHA4A5(BAS1,BAS10,7,0,'REPRT BY  ')
01781		GOTO 2381
01782	2427    CALL CHA4A5(BAS1,BAS10,8,0,'CALL BACK ')
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-32


01783		GOTO 2381
01784	2428    CALL CHHN1(BAS1,TNUM,ME,STAT,UNAM)
01785		GOTO 2381
01786	2429    CALL CHDUP1(BAS1)
01787		GOTO 2381
01788	2430    CALL CHTUP1
01789		GOTO 2381
01790	2431    CALL CHSDT1(BAS1)
01791		GOTO 2381
01792	2432    CALL CHTDWN
01793		GOTO 2381
01794	2433    CALL CH1I(BAS1,BAS10,54,0,'ELAPSED MN')
01795		GOTO 2381
01796	2434    CALL CHA4A5(BAS1,BAS10,25,0,'COMMENT   ')
01797		GOTO 2381
01798	2436    CALL CHA4A5(BAS1,BAS10,19,0,'REFERENCE#')
01799		GOTO 2381
01800	2437    CALL CHA4A5(BAS1,BAS10,31,10,'CUSTOMER  ')
01801		GOTO 2381
01802	2438    CALL CHA4A5(BAS1,BAS10,32,9,'TECH/ANAL')
01803		GOTO 2381
01804	2439    CALL CH1I(BAS1,BAS10,2,13,'PRODUCTION')
01805		GOTO 2381
01806	2440    CALL CH1I(BAS1,BAS10,3,23,'TOP 40    ')
01807		GOTO 2381
01808	2441    CALL CH1I(BAS1,BAS10,45,0,'BILLABLE  ')
01809		GOTO 2381
01810	2442    CALL CH1I(BAS1,BAS10,30,16,'PORTS     ')
01811		GOTO 2381
01812	2443    CALL CHA4A5(BAS1,BAS10,22,21,'LOCATION  ')
01813		GOTO 2381
01814	2444    CALL CH1I(BAS1,BAS10,23,11,'KERNAL HST')
01815		GOTO 2381
01816	2445    CALL CHA4A5(BAS1,BAS10,24,12,'CONTRACT  ')
01817		GOTO 2381
01818	2446    CALL CHASTH(BAS1,BAS10)
01819		GOTO 2381
01820	2447    CALL CHAEHR(BAS1,BAS10)
01821		GOTO 2381
01822	2448    CALL CHA4A5(BAS1,BAS10,33,22,'CODE VER#.')
01823		GOTO 2381
01824	C
01825	C       REPORT GENERATOR FOR ALL OPEN TICKETS
01826	C
01827	2059    TYPE 2051
01828	2051    FORMAT(/1X,'THIS WILL CREATE A FILE FROM ALL DATA BASES, WITH',
01829	     1  /1X,'TICKET INFORMATION EVER ENTERED FOR A GIVEN NETWORK.',
01830	     2  /1X,'THIS WILL START FROM THE DATE SPECIFIED. IF YOU WANT',
01831	     3  /1X,'TO GO TO THE BEGINNING OF TIME JUST HIT A CARRIAGE ',
01832	     4  'RETURN.')
01833		TYPE 1150
01834	1150    FORMAT(/1X,'ENTER START DATE : MM/DD/YYYY ? = ',$)
01835	1160    FORMAT(I2,1X,I2,1X,I4)
01836		ACCEPT 1160,IM,ID,IY
01837		CALL DBDATN(NDATE,IM,ID,IY)
01838		IF (FLAG.LE.0) GOTO 2058
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-33


01839		K=FLAG
01840		GOTO 2457
01841	2058    TYPE 110
01842		ACCEPT 120,K
01843		IF ((K.GE.1).AND.(K.LE.NUMNET)) GOTO 2457
01844		CALL HLPNET
01845		IF (I.EQ.3) GOTO 4950
01846		I=I+1
01847		GOTO 2058
01848	2457    CALL DBSET(4)
01849		L=2
01850	2452    CALL DBFIND(9,1,VNET(K),1,49,'GE',NDATE)
01851	2455    CALL DBNREC(NUMBER)
01852		IF ((NUMBER.GT.0).AND.(L.EQ.3)) GOTO 2082
01853		IF (NUMBER.GT.0) GOTO 2037
01854		IF (L.EQ.3) GOTO 2150
01855	2453    CALL DBSET(1)
01856		L=L+1
01857		CALL DBFIND(9,1,VNET(K),1,5,'GE',NDATE)
01858		GOTO 2455
01859	2454    CALL DBSET(3)
01860	2456    CALL DBFIND(9,1,VNET(K),1,49,'GE',NDATE)
01861		GOTO 2142
01862	C
01863	C       ROUTINE TO GET A TICKET OUT OF THE ARCHIVE DATA BASE AND
01864	C       PUT IT IN THE CURRENT DATA BASE.
01865	C
01866	2459    TYPE 2460,TIC
01867	2460    FORMAT(/1X,'THIS WILL TAKE A TICKET NUMBER FROM THE OLD DATA',
01868	     1  ' BASE',/4X,'AND PUT IT IN THE CURRENT DATA BASE',/,/1X,3A5,$)
01869		ACCEPT 120,TNUM
01870	2461    TYPE 2464,BAS4,BAS1
01871	2464    FORMAT(1X,'SEARCHING ',3A5,'FOR RECORDS TO MOVE TO ',3A5,1H.)
01872		CALL DBERR($2462,IERT,IERC,0)
01873		GOTO 2463
01874	2462    IF (IERT.NE.7) GOTO 4955
01875		TYPE 1379
01876		CALL WAIT (5.5)
01877	2463    CALL DBOPEN(BAS4,BAS1)
01878		CALL DBSET(2)
01879		CALL DBUPD(-1)
01880		CALL DBSET(1)
01881		CALL DBUPD(-1)
01882		CALL DBSET(1)
01883		CALL DBFIND(1,1,TNUM)
01884		CALL DBNREC(NUMBER)
01885		IF (NUMBER.EQ.0) GOTO 2468
01886		TYPE 2466,NUMBER
01887	2466    FORMAT(3X,'FOUND ',I3,' RECORD(S) TO MOVE.')
01888	2465    DO 2490 J=1,NUMBER
01889		CALL DBGREC($4945,J)
%FTNDIM LINE:01889 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
01890		CALL DBVAL(1,TNUM,2,PRO,3,T40,4,F2,5,SDAT,6,TIM1,7,RNAM,8,RFON,
01891	     1  9,NET,10,INT,11,RS,12,SITC,13,SITP,14,PROD,15,STAT,16,DISC,17,
01892	     2  CCC,18,HQCC,19,ONUM,20,SRGN,21,HRGN,22,
01893	     3  LOC,23,KHST,24,COV,25,COMMNT,26,CDAT,27,TCLSD,28,STH,29,EHR,
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-34


01894	     4  30,PORT,31,CNAM,32,TECH,33,VER,34,V5,35,V6,36,V1,37,V2,38,V3,
01895	     5  39,V4,40,NODE,41,SLOT,42,HOST,43,CKT,44,TRB,45,BILL,46,ESC,47,
01896	     6  F1,48,NT,49,DUP,50,TUP,51,MAINT,52,SVER,53,HH,54,ELM,55,COC,
01897	     7  56,CBY,57,PROBL)
01898		CALL DBSET(2)
01899		CALL DBADD(1,TNUM,2,PRO,3,T40,4,F2,5,SDAT,6,TIM1,7,RNAM,8,RFON,
01900	     1  9,NET,10,INT,11,RS,12,SITC,13,SITP,14,PROD,15,STAT,16,DISC,17,
01901	     2  CCC,18,HQCC,19,ONUM,20,SRGN,21,HRGN,22,
01902	     3  LOC,23,KHST,24,COV,25,COMMNT,26,CDAT,27,TCLSD,28,STH,29,EHR,
01903	     4  30,PORT,31,CNAM,32,TECH,33,VER,34,V5,35,V6,36,V1,37,V2,38,V3,
01904	     5  39,V4,40,NODE,41,SLOT,42,HOST,43,CKT,44,TRB,45,BILL,46,ESC,47,
01905	     6  F1,48,NT,49,DUP,50,TUP,51,MAINT,52,SVER,53,HH,54,ELM,55,COC,
01906	     7  56,CBY,57,PROBL)
01907		CALL DBSET(1)
01908	2490    CONTINUE
01909		CALL DBSET(1)
01910		CALL DBFIND(1,1,TNUM)
01911		CALL DBDEL
01912	2468    CALL DBCLOS
01913		CALL DBCLOS
01914		TYPE 2464,BAS5,BAS2
01915		CALL DBERR($2469,IERT,IERC,0)
01916		GOTO 2470
01917	2469    IF (IERT.NE.7) GOTO 4955
01918		TYPE 1379
01919		CALL WAIT(5.5)
01920	2470    CALL DBOPEN(BAS5,BAS2)
01921		CALL DBSET(2)
01922		CALL DBUPD(-1)
01923		CALL DBSET(1)
01924		CALL DBUPD(-1)
01925		CALL DBFIND(1,1,TNUM)
01926		CALL DBNREC(NUMBER)
01927		IF (NUMBER.EQ.0) GOTO 2475
01928		TYPE 2466,NUMBER
01929		DO 2480 J=1,NUMBER
01930		CALL DBGREC($4930,J)
%FTNDIM LINE:01930 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
01931		CALL DBVAL(2,SDAT,3,TIM1,4,INT,5,RS,6,STAT,7,INFO,8,PNAM,
01932	     1  9,ORDER)
01933		CALL DBSET(2)
01934		CALL DBADD(1,TNUM,2,SDAT,3,TIM1,4,INT,5,RS,6,STAT,7,INFO,
01935	     1  8,PNAM,9,ORDER)
01936		CALL DBSET(1)
01937	2480    CONTINUE
01938		CALL DBSET(1)
01939		CALL DBFIND(1,1,TNUM)
01940		CALL DBDEL
01941	2475    CALL DBCLOS
01942		CALL DBCLOS
01943		TYPE 2464,BAS7,BAS6
01944		CALL DBERR($2476,IERT,IERC,0)
01945		GOTO 2478
01946	2476    IF (IERT.NE.7) GOTO 4955
01947		TYPE 1379
01948		CALL WAIT(5.5)
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-35


01949	2478    CALL DBOPEN(BAS7,BAS6)
01950		CALL DBSET(2)
01951		CALL DBUPD(-1)
01952		CALL DBSET(1)
01953		CALL DBUPD(-1)
01954		CALL DBFIND(1,1,TNUM)
01955		CALL DBNREC(NUMBER)
01956		IF (NUMBER.EQ.0) GOTO 2496
01957		TYPE 2466,NUMBER
01958		DO 2495 I=1,NUMBER
01959		CALL DBGREC($2496,I)
%FTNDIM LINE:01959 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
01960		CALL DBVAL(1,TNUM,2,SDAT,3,TIM1,4,NDAT,5,NTIM,6,RS,7,STAT,
01961	     1  8,MAINT,9,ELM,10,NET,11,SVER,12,PROD,13,COC,14,INT,15,drp,
01962	     2  16,tt,17,zone,18,tet)
01963		CALL DBSET(2)
01964		CALL DBADD(1,TNUM,2,SDAT,3,TIM1,4,NDAT,5,NTIM,6,RS,7,STAT,
01965	     1  8,MAINT,9,ELM,10,NET,11,SVER,12,PROD,13,COC,14,INT,15,drp,
01966	     2  16,tt,17,zone,18,tet)
01967		CALL DBSET(1)
01968	2495    CONTINUE
01969		CALL DBSET(1)
01970		CALL DBFIND(1,1,TNUM)
01971		CALL DBDEL
01972	2496    CALL DBCLOS
01973		CALL DBCLOS
01974		CALL DBERR($4930,IERT,IERC,0)
01975		CALL DBOPEN(BAS1)
01976		ANS='S'
01977		GOTO 218
01978	C
01979	C       ROUTINE TO MAKE A CHART OF ALL THE OPEN TICKETS FOR EACH NETWORK.
01980	C
01981	2500    TYPE 2492
01982	2492    FORMAT(/,/3X,'THIS OPTION WILL PRINT A CHART BY NETWORK WITH ',
01983	     1  'A COLUMN',/3X,'FOR OPEN TICKETS, AND A COLUMN FOR MONIT TICK',
01984	     2  'ETS',/3X,'EACH MATRIX IS SUBTOTALED',/,/1X,'NETWORK'3X,'OPEN',
01985	     3  3X,'MONIT',2X,'TOTALS',/)
01986		SOPEN=0
01987		SMONIT=0
01988		STOTAL=0
01989		CALL DBOPEN(BAS1)
01990		DO 2530 I=1,NUMNET
01991		IF (I.EQ.23) GOTO 2530
01992		CALL DBFIND(9,1,VNET(I),1,'STAT','NE','CLSD')
01993		CALL DBNREC(TOTAL(I))
01994		CALL DBFIND(9,1,VNET(I),1,'STAT',1,'OPEN')
01995		CALL DBNREC(SPEN(I))
01996		MONIT(I)=TOTAL(I)-SPEN(I)
01997		TYPE 2524,TVNET(I),SPEN(I),MONIT(I),TOTAL(I)
01998	2524    FORMAT(2X,A5,5X,I3,5X,I3,5X,I3)
01999		STOTAL=STOTAL+TOTAL(I)
02000		SOPEN=SOPEN+SPEN(I)
02001		SMONIT=SMONIT+MONIT(I)
02002	2530    CONTINUE
02003		TYPE 2534,SOPEN,SMONIT,STOTAL
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-36


02004	2534    FORMAT(/2X,'TOTALS',4X,I3,5X,I3,5X,I3)
02005		GOTO 4950
02006	C
02007	C       WILL LIST TICKETS BY PRODUCT TYPES
02008	C
02009	2540    I=1
02010	2541    TYPE 2542
02011	2542    FORMAT(/1X'THIS OPTION WILL LIST THE OPEN TICKET BY PRODUCT',
02012	     1  ' TYPE',/2X'ENTER THE PRODUCT CODE NUMBER OR A ZERO FOR HELP: '
02013	     2  $)
02014		CALL DBOPEN(BAS1)
02015		ACCEPT 120,P
02016		IF ((P.GE.1).AND.(P.LE.NTYPE)) GOTO 2544
02017		IF ((P.EQ.0).OR.(I.EQ.2)) CALL HPROD
02018		IF (I.EQ.3) GOTO 59
02019		I=I+1
02020		GOTO 2541
02021	2544    CALL DBFIND(14,1,TYPE(P),1,15,'NE','CLSD')
02022		CALL DBNREC(NUMBER)
02023		IF (NUMBER.GT.0) GOTO 2546
02024		TYPE 2545,TYPE(P)
02025	2545    FORMAT(/1X' THERE ARE NO TICKETS OPEN WITH A PRODUCT TYPE OF ',
02026	     1  A5,' !')
02027		GOTO 4950
02028	2546    TYPE 772,NUMBER
02029		TYPE 777
02030		DO 2547 I=1,NUMBER
02031		CALL DBGREC($59,I)
%FTNDIM LINE:02031 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
02032		CALL DBVAL(1,TNUM,5,SDAT,6,TIM1,9,NET,15,STAT,40,NODE,
02033	     1  42,HOST,43,CKT,52,SVER,51,MAINT,53,HH)
02034		CALL DBNDAT(SDAT,IM,ID,IY)
02035		TYPE 2193,TNUM,IM,ID,MAINT,NODE,CKT(1),CKT(2),CKT(3),SVER,
02036	     1  HOST,NET,STAT,NETOP(HH)
02037	2547    CONTINUE
02038		GOTO 4950
02039		GOTO 4950
02040	C
02041	C       THIS OPTION LIST TICKETS BY SUPPORT GROUP
02042	C
02043	C
02044	C       IF CUSTOMERS ARE USING OTION THEN GO TO 4200 TO MAKE SURE
02045	C       THEY ARE ONLY SEEING THERE TICKETS
02046	C
02047	2590    IF (FLAG.GT.1) GOTO 4200
02048		I=1
02049	2591    TYPE 2592
02050	2592    FORMAT(/1X'THIS OPTION LIST TICKETS THAT ARE OVER TO A ',
02051	     1  'SUPPORT GROUP'/2X'ENTER THE NUMBER OR A C.R. FOR HELP : ',$)
02052		CALL DBOPEN(BAS1)
02053	2593     ACCEPT 120,P
02054		IF ((P.GE.1).AND.(P.LE.NATTN)) GOTO 2594
02055		IF ((P.EQ.O).OR.(I.EQ.2)) CALL HREFR
02056		IF (I.EQ.3) GOTO 59
02057		I=I+1
02058		TYPE 2592
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-37


02059		GOTO 2593
02060	2594    CALL DBFIND(51,1,ATTN(P),1,15,'NE','CLSD')
02061		CALL DBNREC(NUMBER)
02062		IF (NUMBER.GT.0) GOTO 2597
02063		TYPE 2596,ATTN(P)
02064		GOTO 4950
02065	2596    FORMAT(/3X'THERE ARE NO TICKET TURNED OVER TO ',A5,/)
02066	2597    TYPE 774,NUMBER,ATTN(P)
02067		TYPE 769
02068		DO 2598 I=1,NUMBER
02069		CALL DBGREC($4930,I)
%FTNDIM LINE:02069 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
02070		CALL DBVAL(1,TNUM,5,SDAT,6,TIM1,9,NET,14,PROD,15,STAT,40,NODE,
02071	     1  42,HOST,25,COMMNT,52,SVER,51,MAINT,53,HH)
02072		CALL DBNDAT(SDAT,IM,ID,IY)
02073		TYPE 2193,TNUM,IM,ID,PROD,NODE,
02074	     1  COMMNT(1),COMMNT(2),COMMNT(3),SVER,HOST,NET,STAT,NETOP(HH)
02075	2598    CONTINUE
02076	2193    FORMAT(1X,I6,1X,I2,1H/,I2,1X,A5,1X,I5,1X,A5,A5,A5,1X,I1,1X,
02077	     1  I6,1X,2A5,1X,A5,1X,A5)
02078		GOTO 4950
02079	C
02080	C       ROUTINE TO DISPLAY THE PATH OF A PROBLEM
02081	C
02082	3090    TYPE 3095
02083	3095    FORMAT(/1X,'THIS COMMAND TAKES A TICKET NUMBER AND DISPLAYS',
02084	     1  /2X,'THE TRACKING OF THAT TICKET.',/2X,'A C.R. TAKES YOU ',
02085	     2  'BACK TO THE MENU.'/)
02086	3100    TYPE 3101,TIC
02087	3101    FORMAT(1X,3A5,2H :,T20,$)
02088		CALL DBOPEN(BAS1,BAS6)
02089	3102    ACCEPT 120,TNUM
02090		IF (TNUM.EQ.0) GOTO 4950
02091		P=1
02092	3105    CALL DBSET(1)
02093		CALL DBFIND(1,1,TNUM)
02094		CALL DBNREC(NUMBER)
02095		IF (NUMBER.GT.0) GOTO 3110
02096		IF (P.EQ.2) GOTO 3108
02097		TYPE 652
02098		CALL DBOPEN(BAS4,BAS7)
02099		P=2
02100		GOTO 3105
02101	3108    TYPE 660,TNUM
02102		GOTO 3100
02103	3110    CALL DBGREC($3090,1)
02104		CALL DBVAL(5,SDAT,6,TIM1,9,NET,14,PROD,40,NODE,42,HOST,53,HN)
02105		CALL DBNDAT(SDAT,IM,ID,IY)
02106		IY=IY-1900
02107		TYPE 3115,TNUM,AM(IM),ID,IY,TIM1,NET,PROD,NODE,HOST,NETOP(HN)
02108		TYPE 93115
02109	3115    FORMAT(/1X,'TICKET # ',I8,' WAS OPENED ON ',A3,1H ,I2,
02110	     1  2H, ,I2,' @',A5,' FOR ',2A5,/' FOR A REPORTED ',A5,' ON NODE',
02111	     2  ' # ',I5,' HOST # ',I6,1H.,/1X,'THE GROUP IN CONTROL OF THIS ',
02112	     3  'TICKET IS ',2A5)
02113	93115   FORMAT(/1X,/1X,'START DATE/TIME',4X,
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-38


02114	     1  'END DATE/TIME',2X,'SEV.',1X,'GRP',2X,'PROD',2X,
02115	     2  'STAT',5X,'ELAPSED TIME',/1X)
02116		CALL DBSET(2)
02117		CALL DBFIND(1,1,TNUM)
02118		CALL DBNREC(NUMBER)
02119		IF (NUMBER.GT.0) GOTO 3120
02120		TYPE 3118
02121	3118    FORMAT(2X,'NO TRACKING EXISTS YET FOR THIS TICKET'/)
02122		GOTO 3100
02123	3120    DO 3130 I=1,NUMBER
02124		CALL DBGREC($3090,I)
%FTNDIM LINE:02124 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
02125		CALL DBVAL(2,SDAT,3,TIM1,4,DUP,5,TUP,'STAT',TUS,8,MAINT,
02126	     1  11,SVER,12,PROD,15,ADAT,16,ATIM)
02127		ELM=0
02128		CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
02129		CALL DBNDAT(SDAT,IM,ID,IY)
02130		CALL DBNDAT(ADAT,EM,ED,EY)
02131		IF (DUP.EQ.0) CALL RTIM(TUP,DUP)
02132		CALL DBNDAT(DUP,JM,JD,JY)
02133		JY=JY-1900
02134		IY=IY-1900
02135		EY=EY-1900
02136		IF(TIM1.EQ.TIM2) GOTO 8021
02137		TYPE 3125,I,IM,ID,IY,TIM1,JM,JD,JY,TUP,SVER,MAINT,PROD,
02138	     1  TUS,HOUR
02139	3125    FORMAT(1X,I2,1X,I2,1H/,I2,1H/,I2,1X,A5,1X,I2,1H/,I2,1H/,I2,1X,
02140	     1  A5,1X,I3,2X,A5,1X,A5,1X,A5,2X,F7.1,1X,'HOURS.')
02141	8021    IF(ADAT.GT.0) TYPE 8020,ATIM,EM,ED,EY
02142	8020    FORMAT(5X,'F.E. ARRIVED ON SITE AT ',A5,' GMT ON ',I2,'/',I2,
02143	     1  '/',I2)
02144		TIM2=TIM1
02145	3130    CONTINUE
02146		TYPE 3101,TIC
02147		GOTO 3102
02148	C
02149	C       ROUTINE TO PRINT LIST OF FRAME RELAY TICKETS
02150	C       CURRENTLY OPEN FOR NORTH AMERICA
02151	C
02152	93249   TYPE 93248
02153	93248   FORMAT(/1X,'THE FOLLOWING IS A LIST OF FRAME RELAY TICKETS',
02154	     1  ' THAT',/1X,'ARE CURRENTLY OPEN AND UNDER THE CONTROL OF',
02155	     2  ' NORTH AMERICAN',/1X,'CONTROL GROUPS.',/1X)
02156		CALL DBOPEN(BAS1)
02157		CALL DBFIND(53,3,3,2,53,1,4)
02158		CALL DBFIND('LAST',1,15,2,'CLSD ')
02159		CALL DBSRCH(14,1,'FRE  ',2,9,1,'FRAMERELAY')
02160		CALL DBNREC(NUMBER)
02161		IF(NUMBER.EQ.0) GOTO 93244
02162		CALL DBSORT('SVER','TNUM','ASCEN')
02163		TYPE 93247
02164	93247   FORMAT(/1X,'TNUM',6X,'SEV',2X,'STATUS',2X,'CTL GRP',5X,
02165	     1  'CUSTOMER',6X,'REF GRP',3X,'ELM',/1X)
02166		DO 93245 I=1,NUMBER
02167		DUP=0
02168		TUP='     '
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-39


02169		CALL DBGREC($4930,I)
%FTNDIM LINE:02169 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
02170		CALL DBVAL(1,TNUM,15,STAT,31,CNAM,51,MAINT,52,SVER,53,HH,
02171	     1  54,ELM,5,SDAT,6,TIM1,49,J)
02172		CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
02173		IF(J.GT.0) GOTO 93250
02174		TYPE 93251,TNUM,SVER,STAT,NETOP(HH),CNAM,MAINT,HOUR
02175	93251   FORMAT(1X,I8,3X,I1,3X,A5,3X,A5,3X,3A5,3X,A5,5X,F7.1)
02176		GOTO 93245
02177	93250   TYPE 93246,TNUM,SVER,STAT,NETOP(HH),CNAM,MAINT,HOUR
02178	93246   FORMAT(1X,I8,3X,I1,3X,A5,3X,A5,3X,3A5,3X,A5,5X,F7.1,3X,'*')
02179	93245   CONTINUE
02180		TYPE 93252
02181	93252   FORMAT(/1X,'THE "*" BY THE ELM FIELD INDICATES THAT TIME',
02182	     1  ' UP HAS BEEN',/1X,'SET IN THE TICKET.')
02183	93244   CALL DBCLOS
02184		GOTO 59
02185	C
02186	C
02187	C       ROUTINE TO LIST TICKETS THAT HAVE NOT BEEN UPDATED IN TWO
02188	C       HOURS.
02189	C
02190	3175    DVER(1)=120
02191		DVER(2)=240
02192		DVER(3)=720
02193		DVER(4)=1440
02194		EVER(1)=240
02195		EVER(2)=720
02196		EVER(3)=1440
02197		EVER(4)=2880
02198		F3(1)=5
02199		F3(2)=6
02200		F3(3)=5
02201		BB=0
02202		DF=1
02203		DECODE(5,3244,ANS)M1,M2,M3
02204	3244    FORMAT(A1,A1,A3)
02205		IF (M3.EQ.'   ') DECODE(5,3245,ANS)H1,H2,H3,H4,H5
02206		IF (M3.NE.' ') DECODE(5,3241,ANS)H1,H2,H3,H4
02207	3241    FORMAT(I1,I2,I1,I1)
02208	3245    FORMAT(I1,I1,I1,I1,I1)
02209		TYPE 3180
02210	3180    FORMAT(12X,'THIS REPORT WILL LIST THE TICKETS THAT HAVE ',
02211	     1  'NOT BEEN',/11X,'UPDATED ACCORDING TO THE FOLLOWING...',
02212	     2  /15X,'STATUS',T46,'ESCALATION',/6X,'SEVERITY 1 =  2 HOURS',T39,
02213	     3  'SEVERITY 1 =  4 HOURS',/15X,'2 =  4',T48,'2 = 12',/15X,
02214	     4  '3 = 12',T48,'3 = 24',/15X,'4 = 24',T48,'4 = 48',/,/)
02215		CALL DBOPEN(BAS1,BAS2)
02216		CALL FGMT(IA1,IA2,IA3,IA4,IA5,IA6)
02217		DUP=0
02218		TUP='     '
02219		IF (H2.EQ.0) TYPE 3242
02220		IF (H2.GT.0) TYPE 3243,NETOP(H2)
02221	3242    FORMAT(/5X,'REPORT GENERATED FOR ALL CONTROL GROUPS.',/)
02222	3243    FORMAT(/5X,'REPORT GENERATED FOR ',A5,' ONLY.',/)
02223		IA3=IA3+1900
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-40


02224		TYPE 3177,IA4,IA5,AM(IA1),IA2,IA3
02225	3177    FORMAT(/2X,'THIS REPORT WAS GENERATED AT ',I2,1H:,I2,' ZULU',
02226	     1  ' ON ',A3,2H. ,I2,1H,,I4,1H.,/)
02227		DO 3178 I=1,4
02228		TTL(I)=0
02229		ITEM(I)=0
02230		LIST(I)=0
02231		TELH(I)=0
02232		TELM(I)=0
02233	3178    CONTINUE
02234		DO 3190 I=1,4
02235		TYPE 3182,I
02236	3182    FORMAT(/2X,'*** THE FOLLOWING SEVERITY ',I1,' PROBLEMS',/)
02237		IF (H2.EQ.0) CALL DBFIND(15,1,'OPEN',1,52,1,I)
%FTNDIM LINE:02237 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
02238		IF (H2.GT.0) CALL DBFIND(53,1,H2,1,15,1,'OPEN',1,52,1,I)
%FTNDIM LINE:02238 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
02239		IF(H2.EQ.1) CALL DBSRCH(14,2,'PROJ ')
02240		TYPE 3192
02241	3192    FORMAT(2X,'SEARCHING FOR TICKET THAT HAVE NO TIME UP SET')
02242		CALL DBSRCH('DUP',1,0)
02243		CALL DBNREC(NUMBER)
02244		IF (NUMBER.GT.0) GOTO 3184
02245		TYPE 3189,I
02246	3189    FORMAT(' NO TICKETS OPEN FOR SEVERITY LEVEL ',I1,1H.)
02247	3183    FORMAT(4X'UPDATES ARE CURRENT FOR SEVERITY ',I1,' PROBLEMS',
02248	     1  /1X,'************************************************',/,/)
02249		GOTO 3190
02250	3184    P=0
02251		TYPE 3176,NUMBER,I
02252		SUB(I)=0
02253	3176    FORMAT(/5X,'WE WILL CHECK ',I3,' SEVERITY LEVEL ',I1,
02254	     1  ' TICKETS.')
02255		DO 3188 J=1,NUMBER
02256		CALL DBGREC($4930,J)
%FTNDIM LINE:02256 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
02257		CALL DBVAL(1,TNUM,5,SDAT,6,TIM1,14,PROD,40,NODE,35,V6,36,V1,
02258	     1  42,HOST,43,CKT,51,MAINT,53,HH,54,ELM,37,V2,38,V3,39,V4)
02259		IF (V1-V2.LT.0) GOTO 3228
02260		IF (V1-V3.LT.0) GOTO 3230
02261		GOTO 3232
02262	3228    IF(V2-V3.LT.0) GOTO 3230
02263		OFF=(V2*EVER(I))+V6*60
02264		Z=V2
02265		L=2
02266		GOTO 3234
02267	3230    OFF=(V3*EVER(I))+V6*60
02268		Z=V3
02269		L=3
02270		GOTO 3234
02271	3232    OFF=(V1*EVER(I))+V6*60
02272		Z=V1
02273		L=1
02274	3234    CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
02275		IF (H2.EQ.0) OFF=OFF+60
02276		IF (ELM.LT.OFF) GOTO 3237
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-41


02277		IF ((L.EQ.1).AND.(V1.EQ.5)) GOTO 3237
02278		IF ((L.EQ.2).AND.(V2.EQ.6)) GOTO 3237
02279		IF ((L.EQ.3).AND.(V3.EQ.5)) GOTO 3237
02280		LEV=ELM-OFF
02281		IF (LEV.LT.EVER(I)) X=1
02282		IF ((LEV.LT.2*EVER(I)).AND.(LEV.GT.EVER(I))) X=2
02283		IF ((LEV.LT.3*EVER(I)).AND.(LEV.GE.2*EVER(I))) X=3
02284		IF ((LEV.LT.4*EVER(I)).AND.(LEV.GE.3*EVER(I))) X=4
02285		IF ((LEV.LT.5*EVER(I)).AND.(LEV.GE.4*EVER(I))) X=5
02286		IF (LEV.GE.5*EVER(I)) X=5
02287		IF (X+Z.GT.F3(L)) X=F3(L)-Z
02288		TELH(HH)=TELH(HH)+1
02289		TELM(I)=TELM(I)+1
02290		P=1
02291		CALL DBNDAT(SDAT,IM,ID,IY)
02292		TET=ELM-OFF
02293		PERCEN=TET/60
02294		TYPE 3212,TNUM,IM,ID,NODE,HOST,MAINT,HOUR,NETOP(HH),
02295	     1  PROD,PERCEN
02296	3212    FORMAT(/1X,I7,1X,I2,1H/,I2,1X,I5,1X,I6,1X,A5,2X,F7.1,
02297	     1  2X,A5,2X,A5,2X,F7.1,' ESCALATE.')
02298		IF (L.EQ.1) TYPE 3240,HWARE(V1),SWARE(V2),ITELC(V3),HWARE(V1+X),
02299	     1  SWARE(V2),ITELC(V3)
02300		IF (L.EQ.2) TYPE 3240,HWARE(V1),SWARE(V2),ITELC(V3),
02301	     1  HWARE(V1),SWARE(V2+X),ITELC(V3)
02302		IF (L.EQ.3) TYPE 3240,HWARE(V1),SWARE(V2),ITELC(V3),
02303	     1  HWARE(V1),SWARE(V2),ITELC(V3+X)
02304	3240    FORMAT(2X,'CURRENTLY AT - HARDWARE = ',A10,1X,'SOFTWARE = ',
02305	     1  A10,2X,'TELCO = ',A10,/3X,'SHOULD BE   - HARDWARE = 'A10,
02306	     2  1X,'SOFTWARE = ',A10,2X,'TELCO = ',A10)
02307		GOTO 3238
02308	3237    Q=1
02309	3239    FORMAT(/)
02310	3238    NDAT=SDAT
02311		ELM=0
02312		TTL(HH)=TTL(HH)+1
02313		CALL DBSET(2)
02314		CALL DBFIND(1,1,TNUM)
02315		CALL DBNREC(RECORD)
02316		IF (RECORD.EQ.0) GOTO 3186
02317	3185    CALL DBGREC($4930,RECORD)
02318		CALL DBVAL(2,SDAT,3,TIM1)
02319	3186    CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
02320		ELM=ELM-V4*60
02321		IF (H2.EQ.0) ELM=ELM-60
02322		IF (ELM.LT.DVER(I)) GOTO 3187
02323		CALL DBNDAT(NDAT,IM,ID,IY)
02324		PERCEN=(ELM-DVER(I))/60
02325		IF (Q.EQ.1) TYPE 3239
02326		TYPE 3195,TNUM,IM,ID,NODE,HOST,MAINT,HOUR,NETOP(HH),
02327	     1  PROD,PERCEN
02328	3195    FORMAT(/1X,I7,1X,I2,1H/,I2,1X,I5,1X,I6,1X,A5,2X,F7.1,
02329	     1  2X,A5,2X,A5,2X,F7.1,' ADD STATUS.')
02330		IF (V4.EQ.0) GOTO 3197
02331		TYPE 3196,TNUM,V4
02332	3196    FORMAT(T10,'TICKET # ',I8,' HAD BEEN DEFERED FOR ',I2,
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-42


02333	     1  ' HOURS.')
02334		LIST(DF)=TNUM
02335		DF=DF+1
02336	3197    ITEM(HH)=ITEM(HH)+1
02337		SUB(I)=SUB(I)+1
02338		P=1
02339	3187    CALL DBSET(1)
02340		Q=0
02341	3188    CONTINUE
02342		IF (SUB(I).GT.0) TYPE 3181,NUMBER,SUB(I)
02343	3181    FORMAT(/2X,'OUT OF ',I3,' TICKETS, ',I3,' NEED UPDATING.',/)
02344		IF (TELM(I).GT.0) TYPE 3236,NUMBER,TELM(I)
02345	3236    FORMAT(2X,'ADDITIONALLY, OUT OF ',I3,' TICKETS, ',I3,
02346	     1  ' NEED ESCALATING.',/)
02347		IF (P.EQ.0) TYPE 3183,I
02348		TDAT=TDAT+SUB(I)
02349		TOT1=TOT1+NUMBER
02350		YMTOT=YMTOT+TELM(I)
02351	3190    CONTINUE
02352		TYPE 3191,TOT1,TDAT,YMTOT,NETOP(1),ITEM(1),TTL(1),TELH(1),
02353	     1  NETOP(2),ITEM(2),TTL(2),TELH(2),NETOP(3),ITEM(3),TTL(3),
02354	     2  TELH(3),NETOP(4),ITEM(4),TTL(4),TELH(4)
02355	3191    FORMAT(/,/2X,'THERE ARE ',I3,' TICKETS OPEN, OF WHICH ',
02356	     1  I3,' HAVE TO BE UPDATED AND',/2X,I3,' TICKETS NEED TO BE ',
02357	     2  'ESCALATED.',/,/4X,'THE BREAK DOWN BY ',
02358	     3  'CONTROL GROUP IS AS FOLLOWS...',/,/10X,A5,2H..,I3,
02359	     4  ' OUT OF ',I3,3X,'AND ',I3,' TO ESC.',/10X,A5,2H..,I3,
02360	     5  ' OUT OF ',I3,3X,'AND ',I3,' TO ESC.',/10X,A5,2H..,I3,
02361	     6  ' OUT OF ',I3,3X,'AND ',I3,' TO ESC.',/10X,A5,2H..,I3,
02362	     7  ' OUT OF ',I3,3X,'AND ',I3,' TO BE ESC.',/,/5X,'END OF REPORT',
02363	     8  /,/)
02364		TOT1=0
02365		TDAT=0
02366		YMTOT=0
02367		IF ((DF.EQ.1).OR.(H2.EQ.0)) GOTO 3930
02368		P=DF-1
02369		TYPE 3248,FF,P
02370	3248    FORMAT(/,A5,/3X,'THERE ARE ',I3,' TICKET(S) WHICH NEED',
02371	     1  ' THE DEFER TIMES CLEARED OUT.')
02372		CALL DBERR($3249,IERT,IERC,0)
02373		GOTO 3250
02374	3249    IF (IERT.NE.7) GOTO 4955
02375		TYPE 1379
02376		CALL WAIT(7.0)
02377	3250    CALL DBOPEN(BAS1)
02378		CALL DBUPD(-1)
02379		DO 3252 I=1,DF-1
02380		CALL DBFIND(1,1,LIST(I))
02381		CALL DBGREC($4930,I)
%FTNDIM LINE:02381 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
02382		CALL DBCHNG(39,0)
02383		TYPE 3251,LIST(I)
02384	3251    FORMAT(1X,'TICKET NUMBER ',I8,' IS CLEARED OUT')
02385	3252    CONTINUE
02386		CALL DBCLOS
02387		TYPE 3253
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-43


02388	3253    FORMAT(4X,'JOB COMPLETE')
02389		GOTO 3930
02390	C*************************************************************
02391	C
02392	C       THIS ROUTINE WILL PLACE A PERSON IN THE CALL BACK LOG
02393	C
02394	C*************************************************************
02395	C
02396	3280    TYPE 170,TIC
02397		CALL RTIM(TIM1,SDAT)
02398		CALL DBERR($3284,IERT,IERC,0)
02399		ACCEPT 120,TNUM
02400		GOTO 3286
02401	3284    IF (IERT.NE.7) GOTO 4955
02402		TYPE 3285
02403	3285    FORMAT(1X,'CALL BACK LOG IS BUSY... WILL RETRY IN 10 SECS.')
02404		CALL WAIT(5.0)
02405	3286    CALL DBOPEN('(TNT)CALBAK')
02406		CALL DBUPD(-1)
02407		IF (ANS.NE.'A') GOTO 3287
02408		ENCODE(20,3289,NCNAM)CNAM
02409	3289    FORMAT(3A5,'     ')
02410		CALL DBADD(1,TOT,2,SDAT,3,TIM1,4,NCNAM,5,ME,6,0,7,REPN,
02411	     1  8,REPF,13,' ')
02412		GOTO 3288
02413	3287    CALL DBADD(1,TNUM,2,SDAT,3,TIM1,4,REPN,5,ME,6,0,7,SITC,
02414	     1  8,SITP,13,' ')
02415	3288    CALL DBUPD(0)
02416		CALL DBCLOS
02417		CALL DBOPEN('(TNT)BASE1')
02418		CALL DBFIND(1,1,TNUM)
02419		CALL DBGREC($93288,1)
02420		CALL DBVAL(52,SVER)
02421		CALL DBCLOS
02422		IF((SVER.EQ.1.).AND.(CG.LT.5).AND.(JJ1.EQ.0))GOTO 4710
02423		HDRCHK=1
02424	93288   IF(ANS.EQ.'A') GOTO 650
02425		GOTO 59
02426	C********************************************************************
02427	C
02428	C       LETS CHECK ON THE SEMANTICS OF CHECKING WHICH TNUM TO LOOK AT
02429	C
02430	C********************************************************************
02431	C
02432	3292    IF (DECIS.GT.1) GOTO 3296
02433	3294    CALL DBOPEN(BAS1,BAS2,BAS8)
02434		GOTO 653
02435	3296    TYPE 170,TIC
02436		CALL DBOPEN(BAS1,BAS2,BAS8)
02437		ACCEPT 120,TNUM
02438		IF (TNUM.EQ.0) GOTO 4062
02439		GOTO 653
02440	3298    IF (DECIS.EQ.1) GOTO 4062
02441		TYPE 3300
02442	3300    FORMAT(1X,'DO YOU NEED TO SEE ANOTHER TICKET IN DETAIL ? ',$)
02443		ACCEPT 65,SEE
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-44


02444		CALL HISET(SEE)
02445		IF ((SEE.EQ.'N').OR.(SEE.EQ.' ')) GOTO 4062
02446		TYPE 170,TIC
02447		ACCEPT 120,TNUM
02448		GOTO 653
02449	C
02450	C       ROUTINE TO FIND OUT WHAT HAS HAPPENED IN THE LAST 30
02451	C       DAYS. IF THERE HAS BEEN ANY TICKETS OPENED - THEN A STATUS
02452	C       WILL BE ADDED THAT THIS NODE HAS BEEN INVOLVED WITH OTHER
02453	C       PROBLEMS.
02454	C
02455	3360    TYPE 3365,NOD1,CIRCKT
02456		LEV=SVER
02457		TOT=TNUM
02458		L=1
02459		Z=1
02460		M=1
02461	3365    FORMAT(/1X,'NOW LET THE PROGRAM CHECK THE DATA BASE TO SEE IF',
02462	     1  /1X'ANY OTHER PROBLEMS HAVE BEEN REPORTED ABOUT NODE # ',I5,
02463	     2  /1X'OR CIRCUIT # ',4A5,'  IN THE LAST 30 DAYS.')
02464		CALL DBOPEN(BAS1,BAS4)
02465		CALL DBSET(1)
02466		NDAT=SDAT-30
02467	3368    IF ((CIRCKT(1).EQ.'     ').OR.(CIRCKT(1).EQ.'.    ')) GOTO 3370
02468		IF (Z.EQ.2) GOTO 3369
02469		CALL DBFIND(40,1,NOD1,1,9,1,VNET(K),
02470	     1  'OR',9,1,VNET(K),1,43,1,CIRCKT)
02471		GOTO 3375
02472	3369    CALL DBFIND(40,1,NOD1,1,9,1,VNET(K),1,49,'GE',
02473	     1  NDAT,'OR',9,1,VNET(K),1,49,'GE',NDAT,1,43,1,CIRCKT)
02474		GOTO 3375
02475	3370    IF (Z.EQ.2) GOTO 3371
02476		CALL DBFIND(40,1,NOD1,1,9,1,VNET(K))
02477		GOTO 3375
02478	3371    CALL DBFIND(40,1,NOD1,1,9,1,VNET(K),1,49,'GE',NDAT)
02479	3375    CALL DBNREC(NUMBER)
02480		IF ((NUMBER.GT.1).AND.(Z.EQ.1)) GOTO 3380
02481		IF ((NUMBER.GT.0).AND.(Z.EQ.2)) GOTO 3380
02482		IF (Z.EQ.2) GOTO 3390
02483		Z=2
02484		CALL DBSET(2)
02485		GOTO 3368
02486	3380    IF (L.EQ.2) GOTO 3381
02487		L=2
02488		TYPE 776
02489	3381    DO 3389 J=1,NUMBER
02490	3385    CALL DBGREC($3389,J)
%FTNDIM LINE:02490 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
02491		CALL DBVAL(1,TNUM,5,DDAT,53,HH,9,NET,14,PROD,15,STAT,40,NUD,
02492	     1  42,HOST,43,CKT,52,SVER,51,MAINT)
02493		CALL DBNDAT(DDAT,IM,ID,IY)
02494		TYPE 2379,TNUM,IM,ID,PROD,NUD,CKT,SVER,HOST,STAT,MAINT,
02495	     1  NETOP(HH),YY(ESC)
02496		IF ((Z.EQ.1).AND.(J.EQ.NUMBER-1)) GOTO 3382
02497		IF ((Z.EQ.2).AND.(J.EQ.NUMBER).AND.(M.NE.2)) GOTO 3384
02498		GOTO 3389
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-45


02499	3382    CALL DBSET(2)
02500		IF ((CIRCKT(1).EQ.'     ').OR.(CIRCKT(1).EQ.'.    ')) GOTO 3387
02501		CALL DBFIND(40,1,NOD1,1,9,1,VNET(K),1,49,'GE',NDAT,'OR',
02502	     1  9,1,VNET(K),1,49,'GE',NDAT,1,43,1,CIRCKT)
02503		GOTO 3386
02504	3387    CALL DBFIND(40,1,NOD1,1,9,1,VNET(K),1,49,'GE',NDAT)
02505	3386    CALL DBNREC(RECORD)
02506		TOGO=NUMBER+RECORD
02507		CALL DBSET(1)
02508		GOTO 3383
02509	3384    TOGO=NUMBER+1
02510	3383    ENCODE(320,3391,INFO)NOD1,CIRCKT,TOGO,TNUM,IM,ID,PROD,NUD,
02511	     1  CKT,SVER,HOST,STAT
02512	3391    FORMAT('NODE # ',I5,' OR CIRCUIT # ',4A5,'HAS BEEN INVOLVED ',
02513	     1  'IN ',I2,' TICKETS  ',' OVER THE LAST 30 DAYS. THE MOST REC',
02514	     2  'ENT TICKET IS #',I6,' OPENED ON 'I2,1H/,I2,' FOR',4X,'PROD',
02515	     3  'UCT ',1H",A5,1H",' ON NODE ',I5,' WITH CIRCUIT  ',4A5,
02516	     4  '. THE SEVERITY  WAS A ',I1,' EFFECTING HOST #',I6,'. THE ',
02517	     5  'CURRENT STATUS IS ',A5,1H.)
02518		M=2
02519		CALL DBERR($3392,IERT,IERC,0)
02520		GOTO 3393
02521	3392    IF (IERT.NE.7) GOTO 4931
02522		TYPE 1379
02523		CALL WAIT(5.0)
02524	3393    CALL DBOPEN(BAS2)
02525		CALL DBUPD(-1)
02526		CALL DBFIND(1,1,TOT)
02527		CALL DBNREC(RECORD)
02528		ORDER=RECORD+1
02529		CALL DBADD(1,TOT,2,SDAT,3,TIM1,4,'SYS',5,0,6,'OPEN',7,INFO,8,
02530	     1  'PAPER',9,ORDER,10,0)
02531		ENCODE(320,3373,INFO)TOGO,NOD1,CIRCKT
02532	3373    FORMAT('USE THE ',4H"N" ,'COMMAND TO LEARN ALL OF THE ',I2,
02533	     1  ' TICKET NUMBERS.'22X,' NODE ',I5,' OR CIRCUIT ',4A5,' MAYBE ',
02534	     2  'A CHRONIC PROBLEM.'12X,1H.,90X)
02535		ORDER=ORDER+1
02536		CALL DBADD(1,TOT,2,SDAT,3,TIM1,4,'SYS',5,0,6,'OPEN',7,INFO,8,
02537	     1  'PAPER',9,ORDER,10,0)
02538		CALL DBCLOS
02539		CALL DBERR($4931,IERT,IERC,0)
02540		IF (Z.EQ.2) GOTO 3390
02541		CALL DBOPEN(BAS1,BAS4)
02542		CALL DBSET(1)
02543	3389    CONTINUE
02544		IF (Z.EQ.2) GOTO 3390
02545		Z=2
02546		CALL DBSET(2)
02547		GOTO 3368
02548	3390    TYPE 2370
02549		GOTO 3959
02550	C
02551	C
02552	C************************************************************
02553	C
02554	C       ROUTINE TO LOOK AT A TICKET WITH EITHER A NODE, HOST
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-46


02555	C        CIRCUIT, CUSTOMER NAME OR TICKET NUMBER.
02556	C
02557	C************************************************************
02558	C
02559	C400    TYPE 3401
02560	3401    FORMAT(1X,'DO YOU WISH TO CREATE A FILE OF YOUR FINDINGS ? ',$)
02561		ACCEPT 65,WELL
02562		CALL HISET(WELL)
02563		CALL ONINT($4930)
02564		IF (WELL.NE.'Y') GOTO 3404
02565		TYPE 3402
02566	3402    FORMAT(1X,'ENTER OUTPUT FILE NAME : ',$)
02567		ACCEPT 3403,FILE
02568	3403    FORMAT(5A5)
02569	3404	OPEN(unit=8,device='DSK',access='SEQOUT',file=FILE)
02570	3400    TYPE 3405
02571		Z=1
02572	3405    FORMAT(/1X,'THIS OPTION WILL ALLOW YOU TO SEE A TICKET',/2X,
02573	     1  'IF YOU KNOW EITHER A TICKET NUMBER, HOST, NODE, CIRCUIT #,',
02574	     2  ' OR',/2X,'A CUSTOMER NAME (AT LEAST THE FIRST THREE LETTERS).',
02575	     3  /2X,'THE SYNTAX IS ',1H",'OPTION VALUE',1H"'. THE OPTIONS ARE',
02576	     4  '...'/2X,'(N= NODE, H= HOST, C= CUSTOMER ',
02577	     5  'NAME, T= TIC. #',/2X,'AND L= CIRCUIT NUMBER).',
02578	     6  ' USE THE "N" COMMAND FOR',
02579	     7  /2X,'ALL OTHER DATA. EXAMPLES ARE ',1H",'N 02210',1H",/2X,
02580	     8  'NOTE: YOU MUST HAVE LEADING ZEROS FOR NODE AND HOST NUMBERS',
02581	     9  /2X,'NODES ARE FIVE DIGITS AND HOSTS ARE SIX DIGITS.',/1X,
02582	     A  'ENTER OPTION SPACE VALUE',/1X'X ....................',/)
02583		CALL DBOPEN(BAS1,BAS2,BAS8)
02584	3410    ACCEPT 3415,CHO,VALUE
02585	3415    FORMAT(A1,1X,4A5)
02586		CALL HISET(CHO)
02587		call upcase(value)
02588	3417    IF (CHO.EQ.'C') goto 3425
02589		IF (CHO.EQ.'N') GOTO 3450
02590		IF (CHO.EQ.'L') GOTO 3465
02591		IF (CHO.EQ.' ') GOTO 4945
02592		IF (CHO.EQ.'H') GOTO 3470
02593	C       OPTION IS NOT KNOWN
02594		TYPE 3420,CHO
02595	3420    FORMAT(/1X,'YOUR OPTION "',A1,1H"' IS NOT RECOGNIZED.',/)
02596		TYPE 3405
02597		GOTO 3410
02598	C425    DECODE(5,3424,VALUE(1))M1,M2,M3,M4,M5
02599	3424    FORMAT(A1,A1,A1,A1,A1)
02600	C       M3=M3+"001
02601	C       ENCODE(5,3421,NEWVAL(1))M1,M2,M3,M4,M5
02602	3421    FORMAT(A1,A1,A1,'  ')
02603	3433    FORMAT(3X,4A5)
02604	C
02605	C       GET THIRD CHARACTER FROM VALUE AND PLACE IT IN THE NEWVAL
02606	C       STRING
02607	C
02608	3425    CALL GETC(1,VALUE,M1)
02609		CALL GETC(2,VALUE,M2)
02610		CALL GETC(3,VALUE,M3)
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-47


02611		M3=M3+"001
02612		CALL PUTC(1,NEWVAL,M1)
02613		CALL PUTC(2,NEWVAL,M2)
02614		CALL PUTC(3,NEWVAL,M3)
02615	3434    CALL DBFIND('CNAM','GE',VALUE,1,'CNAM','LE',NEWVAL)
02616		IF (VALUE(1).EQ.'MOT  ') CALL DBSRCH(15,1,'OPEN ')
02617		YMTOT=0
02618		I=1
02619	3427    CALL DBNREC(TODAY)
02620	3430    IF (TODAY.EQ.0) GOTO 3431
02621		TYPE 3480
02622		YMTOT=YMTOT+TODAY
02623		DO 3429 X=1,TODAY
02624		CALL DBGREC($3429,X)
%FTNDIM LINE:02624 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
02625		CALL DBVAL(1,LIST(I),9,NET,40,NODE,42,HOST,43,CKT,51,
02626	     1  MAINT,14,PROD,'CNAM',CNAM)
02627		TYPE 3485,I,LIST(I),CNAM(1),CNAM(2),CNAM(3),NET(1),NET(2),NODE,
02628	     1  CKT(1),CKT(2),CKT(3),HOST,PROD,MAINT
02629		I=I+1
02630	3429    CONTINUE
02631	3431    CALL DBSET(3)
02632		CALL DBFIND('RNAM','GE',VALUE,1,'RNAM','LE',NEWVAL,1,6,1,0)
02633		CALL DBNREC(NUMBER)
02634		IF (NUMBER.EQ.0) GOTO 3428
02635		YMTOT=YMTOT+NUMBER
02636		DO 3428 X=1,NUMBER
02637		CALL DBSET(3)
02638		CALL DBGREC($3455,X)
%FTNDIM LINE:02638 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
02639		CALL DBVAL(1,TNUM,'RNAM',RNAM)
02640		CALL DBSET(1)
02641		CALL DBFIND(1,1,TNUM)
02642		CALL DBNREC(RECORD)
02643		IF((NUMBER.GT.0).AND.(RECORD.EQ.0)) GOTO 3455
02644		IF (RECORD.EQ.0) GOTO 3428
02645		CALL DBGREC($3455,RECORD)
02646		CALL DBVAL(1,LIST(I),9,NET,40,NODE,42,HOST,43,CKT,51,MAINT,
02647	     1  14,PROD,15,STAT,'CNAM',CNAM)
02648		IF ((STAT.EQ.'CLSD').OR.(RNAM(1).EQ.CNAM(1))) GOTO 3456
02649		TYPE 3485,I,LIST(I),RNAM(1),RNAM(2),RNAM(3),NET(1),NET(2),NODE,
02650	     1  CKT(1),CKT(2),CKT(3),HOST,PROD,MAINT
02651		I=I+1
02652	3456    CALL DBSET(3)
02653		GOTO 3428
02654	3455    TYPE 3446,NUMBER,YMTOT,RECORD,X
02655	3446    FORMAT(1X,'ERROR... NUM=',I3,3X,'YM=',I3,3X,'REC=',I3,3X,
02656	     1  'X=',I3)
02657	3428    CONTINUE
02658		IF((NUMBER.GT.0).AND.(RECORD.EQ.0)) GOTO 4945
02659		IF ((YMTOT.EQ.0).AND.(Z.EQ.1)) GOTO 3441
02660		IF ((YMTOT.EQ.0).AND.(Z.EQ.2)) GOTO 4945
02661		TYPE 3500
02662		ACCEPT 120,I
02663		IF (I.EQ.0) GOTO 4945
02664		IF ((I.LT.1).OR.(I.GT.YMTOT)) GOTO 3428
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-48


02665		CALL DBSET(1)
02666		CALL DBFIND(1,1,LIST(I))
02667		CALL DBNREC(NUMBER)
02668		I=NUMBER
02669		GOTO 666
02670	3432    IF (Z.EQ.2) GOTO 4945
02671		TYPE 3435,CHO,VALUE
02672	3435    FORMAT(/1X'NO VALUE FOR YOUR OPTION ',1H",A1,1H"' AND VALUE ',
02673	     1  'OF ',4A5,/)
02674	3441    TYPE 3440
02675	3440    FORMAT(1X,'DO YOU WISH TO TRY THE ARCHIVE DATA BASE ? ',$)
02676		ACCEPT 65,SEE
02677		CALL HISET(SEE)
02678		IF (SEE.EQ.'Y') GOTO 3445
02679		IF (WELL.EQ.'Y') CLOSE(unit=8)
02680		GOTO 4945
02681	3445    Z=2
02682		CALL DBOPEN(BAS4,BAS5,BAS9)
02683		IF (CHO.EQ.'C') GOTO 3434
02684		IF (CHO.EQ.'N') GOTO 3460
02685		IF (CHO.EQ.'L') GOTO 3465
02686		GOTO 3470
02687	C       OPTION IS NODE
02688	3450    DECODE(5,34509,VALUE(1))NODE
02689	34509   FORMAT(I5)
02690	3460    CALL DBFIND(40,1,NODE)
02691		GOTO 3427
02692	C       OPTION IS CIRCUIT
02693	3465    CALL DBFIND('CKT',1,VALUE)
02694		GOTO 3427
02695	C       OPTION IS HOST
02696	3470    DECODE(6,3454,VALUE)HOST
02697	3454    FORMAT(I6)
02698		CALL DBFIND('HOST',1,HOST)
02699		GOTO 3427
02700	3472    CALL DBFIND(1,1,TNUM)
02701		GOTO 3427
02702	C       LIST TICKETS FOUND
02703	3475    IF (NUMBER.GT.1) GOTO 3476
02704		I=NUMBER
02705		GOTO 666
02706	3476    TYPE 3480
02707	C       IF (WELL.EQ.'Y') WRITE(8,3480)
02708	3480    FORMAT(1X,'REC. TNUM   CUSTOMER',T30,'NET',T41,'NODE',T46,
02709	     1  'CIRCUIT',T63,'HOST PROD  MAINT'/)
02710		DO 3490 I=1,NUMBER
02711		CALL DBGREC($59,I)
%FTNDIM LINE:02711 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
02712		CALL DBVAL(1,LIST(I),9,NET,40,NODE,42,HOST,43,CKT,51,
02713	     1  MAINT,14,PROD,'CNAM',CNAM)
02714		TYPE 3485,I,LIST(I),CNAM(1),CNAM(2),CNAM(3),NET(1),NET(2),NODE,
02715	     1  CKT(1),CKT(2),CKT(3),HOST,PROD,MAINT
02716	3485    FORMAT(1X,I2,I8,2X,A5,A5,A5,1X,2A5,I5,1X,A5,A5,A5,I6,
02717	     1  1X,A5,1X,A5)
02718	C       IF (WELL.EQ.'Y') WRITE(8,3485)I,
02719	C    1  LIST(I),RNAM(1),RNAM(2),RNAM(3),
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-49


02720	C    2  NET(1),NET(2),NODE,CKT(1),CKT(2),CKT(3),HOST,PROD,MAINT
02721	3490    CONTINUE
02722		IF (WELL.EQ.'Y') GOTO 3507
02723	3495    TYPE 3500
02724	3500    FORMAT(/1X,'WHICH REC. NO. DO YOU WISH TO SEE IN DETAIL ? ',$)
02725		ACCEPT 120,I
02726		IF (I.EQ.0) GOTO 4945
02727		IF ((I.GT.0).AND.(I.LE.NUMBER)) GOTO 3505
02728		GOTO 3495
02729	3505    CALL DBSREC
02730		NUMBER=I
02731		GOTO 666
02732	3507    IF (Z.EQ.1) GOTO 3441
02733		CLOSE(unit=8)
02734		TYPE 3651,FILE
02735		GOTO 4950
02736	C
02737	C***********************************************
02738	C
02739	C       LIST ESCALATED TICKETS
02740	C
02741	C***********************************************
02742	C
02743	3520    TYPE 3525
02744	3525    FORMAT(3X,'THIS OPTION WILL LIST THE OPEN ESCALATED TICKETS',/)
02745		CALL DBOPEN(BAS1)
02746		CALL DBFIND(46,1,2,1,15,'NE','CLSD')
02747		IF (FLAG.GT.1) CALL DBFIND(46,1,2,1,15,'NE','CLSD',1,
02748	     1  9,1,VNET(FLAG))
02749		CALL DBNREC(NUMBER)
02750		IF (NUMBER.GT.0) GOTO 773
02751		TYPE 3530
02752	3530    FORMAT(/5X,'THERE ARE NO ESCALATED TICKETS AVAILABLE !',/)
02753		GOTO 4950
02754	C
02755	C
02756	C**************************************************
02757	C
02758	C       ROUTINE TO FIND ALL TICKETS FOR A MAINT REGION
02759	C
02760	C**************************************************
02761	C
02762	3580    TYPE 3581
02763	3581    FORMAT(/1X,'SELECT THE REGION YOU WISH TO SEE THE OPEN TICKETS',
02764	     1  ' FOR.',/6X,'SELECT:   1  FOR NFO',/T17,'2  FOR INTERNATIONAL',
02765	     2  /T17,'3  FOR ETS',/T17,'4  FOR CTS',/T17,'5  FOR WTS',/T17,
02766	     3  '6  FOR ALL EAST SOFTWARE    ) ',/T17,'7  FOR ALL CENTRAL SOFT',
02767	     4  'WARE  > REGARDLESS OF REF. GRP.',/T17,'8  FOR ALL WEST ',
02768	     5  'SOFTWARE    )',
02769	     7  /3X,'ENTER SELECTION NUMBER : ',$)
02770		CALL DBOPEN(BAS1)
02771		ACCEPT 120,P
02772		IF ((P.LT.0).OR.(P.GT.8)) GOTO 3580
02773		IF ((P.GE.6).AND.(P.LE.8)) GOTO 3582
02774		IF (P.EQ.0) GOTO 4950
02775	3584    CALL DBFIND('MAINT','GE',LREFER(P),1,'MAINT','LE',HREFER(P),1,
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-50


02776	     1  'STAT','NE','CLSD')
02777		GOTO 3583
02778	3582    P=P-3
02779		X=31
02780		CALL DBFIND(20,'GE',LREFER(P),1,20,'LE',HREFER(P),1,
02781	     1  15,'NE','CLSD')
02782	3583    CALL DBNREC(NUMBER)
02783		IF (NUMBER.GT.0) GOTO 770
02784		TYPE 2596,LREFER(P)
02785		GOTO 4950
02786	C
02787	C       ROUTINE TO LIST CHAD TICKETS
02788	C
02789	3586    CALL DBOPEN(BAS1)
02790		CALL DBFIND(51,'GE','NF',1,51,'LE','NG',1,15,'NE','CLSD',1,52,
02791	     1  'LE',2,'OR',51,1,'CHAD',1,15,'NE','CLSD',1,52,'LE',2)
02792		CALL DBNREC(NUMBER)
02793		IF (NUMBER.GT.0) GOTO 770
02794		TYPE 2596,ATTN(63)
02795		GOTO 4950
02796	3585    CALL DBOPEN(BAS1)
02797		CALL DBFIND(51,'GE','NF',1,51,'LE','NG',1,15,'NE','CLSD',1,52,
02798	     1  'GE',3,'OR',51,1,'CHAD',1,15,'NE','CLSD',1,52,'GE',3)
02799		CALL DBNREC(NUMBER)
02800		IF (NUMBER.GT.0) GOTO 770
02801		TYPE 2596,ATTN(63)
02802		GOTO 4950
02803		CALL DBNREC(NUMBER)
02804		IF (NUMBER.EQ.0) GOTO 3577
02805	3587    FORMAT(//4X,'THERE ARE ZERO PROJECT TICKETS OPEN',//)
02806		TYPE 3589,NUMBER
02807	3589    FORMAT(/3X,'THERE ARE ',I3,' TICKETS OPEN FOR PROJECTS',/)
02808		TYPE 3579
02809	3579    FORMAT(/3X,'TIC#',1X,'DATE',2X,'PROD',2X,'NODE',2X,'PROJECT',
02810	     1  11X,'SVER',2X,'HOST',1X,'STAT',2X,'ATTN.',1X,
02811	     2  'CTRL GRP ETIM',/)
02812		DO 3578 I=1,NUMBER
02813		CALL DBGREC($4930,I)
%FTNDIM LINE:02813 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
02814		CALL DBVAL(1,TNUM,5,SDAT,6,TIM1,14,PROD,15,STAT,40,NODE,
02815	     1  42,HOST,46,ESC,52,SVER,51,MAINT,53,HH,49,DUP,50,TUP,
02816	     2  54,ELM,19,ONUM)
02817		CALL DBNDAT(SDAT,IM,ID,IY)
02818		IY=IY-1900
02819		CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
02820		TYPE 3576,TNUM,IM,ID,PROD,NODE,ONUM,SVER,HOST,STAT,MAINT,
02821	     1  NETOP(HH),YY(ESC),HOUR
02822	3576    FORMAT(1X,I6,1X,I2,1H/,I2,1X,A5,1X,I5,1X,2A5,10X,I1,1X,I6,
02823	     1  1X,A5,1X,A5,1X,A5,1X,A1,F6.1)
02824	3578    CONTINUE
02825		GOTO 4950
02826	3577    TYPE 3587
02827		GOTO 4950
02828	C
02829	C********************
02830	C
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-51


02831	C       ROUTINE TO LIST LAST STATUS TIME ENTRY
02832	C
02833	C********************
02834	C
02835	3710    TYPE 3715
02836	3715    FORMAT(1X,'THIS ROUTINE WILL LIST THE TIME THAT THE ',
02837	     1  'TICKET WAS LAST UPDATED.',/)
02838		TYPE 170,TIC
02839		CALL DBOPEN(BAS2,BAS1)
02840	3720    CALL DBSET(1)
02841		ACCEPT 120,TNUM
02842		IF (TNUM.EQ.0) GOTO 4950
02843		CALL DBFIND(1,1,TNUM)
02844		CALL DBNREC(NUMBER)
02845		IF (NUMBER.GT.0) GOTO 3730
02846		TYPE 3725
02847	3725    FORMAT(T25,'NO ENTRIES',/)
02848		TYPE 170,TIC
02849		GOTO 3720
02850	3730    CALL DBGREC($3710,NUMBER)
02851		CALL DBVAL(2,SDAT,3,TIM1,4,INT,6,STAT)
02852		CALL DBNDAT(SDAT,IM,ID,IY)
02853		TYPE 3735,IM,ID,IY,TIM1,STAT,INT,NUMBER
02854	3735    FORMAT(1X,I2,1H-,I2,1H-,I4,4X,A5,5X,A5,5X,A3,3X,I3,$)
02855		CALL DBSET(2)
02856		CALL DBFIND(1,1,TNUM)
02857		CALL DBGREC($3736,1)
02858		CALL DBVAL(39,V4)
02859		TYPE 3737,V4
02860	3737    FORMAT('+',3X,I3,/)
02861	3736    TYPE 170,TIC
02862		GOTO 3720
02863	C
02864	C********************
02865	C
02866	C       ROUTINE TO PLACE A TICK MARK IN THE DATA BASE
02867	C
02868	C********************
02869	3740    TYPE 3745
02870	3745    FORMAT(1X,'THIS ROUTINE IS FOR PLACING QA COMMENTS ABOUT ',
02871	     1  'SERVICE RENDERED.',/,/1X,'THIS OPTION WILL ALLOW YOU TO ',
02872	     2  'PUT MULTIPLE TICMARKS IN FOR TICKET.',/1X,'YOU WILL NOT ',
02873	     3  'BE PROMPTED. INSTEAD YOU WILL ENTER A TICKET ',/1X,
02874	     4  'NUMBER. YOU CAN THEN ENTER ALL THE DATA ON ONE LINE.',/1X,
02875	     5  'REFER GROUPS ARE STANDARD !',T30,'DISCIPLINES ARE...',T50,
02876	     6  'H = HARDWARE',/T50,'S = SOFTWARE',/T50,
02877	     7  'V = VENDOR',
02878	     8  /,/3X,'NOTE : ',
02879	     9  'WHEN CLOSING A TICKET ENTER A -1 ON ',/12X,'THE LAST LINE.',/)
02880	3749    TYPE 3750
02881	3750    FORMAT(1X,'CTT RRR COMMENTS................................',
02882	     1  '....................',/)
02883	3752    ACCEPT 3755,DSP,TT,REG,COMMEN
02884		IF (TT.EQ.0) GOTO 59
02885		IF ((DSP.EQ.'-').AND.(ANS.EQ.'S'.OR.'C')) GOTO 903
02886		CALL HISET(DSP)
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-52


02887		IF (DSP.EQ.'H') GOTO 3771
02888		IF (DSP.EQ.'S') GOTO 3772
02889		IF (DSP.eq.'V') GOTO 3773
02890		IF (DSP.EQ.'-') GOTO 4950
02891		GOTO 3801
02892	3773    IF ((TT.GE.1).AND.(TT.LE.13)) GOTO 3791
02893		IF ((TT.GE.20).AND.(TT.LE.25)) GOTO 3791
02894		IF (TT.EQ.14) GOTO 3806
02895		GOTO 3801
02896	3771    IF ((TT.GE.1).AND.(TT.LE.20)) GOTO 3791
02897		IF (TT.EQ.21) GOTO 3806
02898		GOTO 3801
02899	3772    IF ((TT.GE.1).AND.(TT.LE.15)) GOTO 3791
02900		IF (TT.EQ.16) GOTO 3806
02901		GOTO 3801
02902	3791    IF ((REG.GE.1).AND.(REG.LE.NATTN)) GOTO 3757
02903	3801    TYPE 3802
02904	3802    FORMAT(3X,'INPUT REJECTED  --  REENTER THE LINE AGAIN.')
02905		GOTO 3749
02906	3806    TYPE 3804
02907	3804    FORMAT(/3X,'"NO QA" IS NO LONGER TO BE USED AS A TICMARK ',
02908	     1  'WHEN CLOSING TICKETS.',/3X,'USE "-1" IF THERE ARE NO ',
02909	     2  'NEGATIVE TICMARKS.',/,/)
02910		GOTO 3749
02911	3803    REG=NATTN+1
02912	3755    FORMAT(A1,I2,1X,I3,1X,12A5)
02913	3757    CALL DBERR($3759,IERT,IERC,0)
02914		GOTO 3762
02915	3759    IF (IERT.NE.7) GOTO 4955
02916		TYPE 1379
02917		CALL WAIT(5.0)
02918	3762    CALL DBOPEN('(TNT)TICMRK')
02919		CALL DBUPD(-1)
02920		CALL DBSYSV(1,0,SDAT)
02921		CALL DBADD(1,TNUM,2,SDAT,3,ME,5,TT,6,ATTN(REG),7,DSP,
02922	     1  8,COMMEN,'NET',NET)
02923		CALL DBCLOS
02924		CALL DBERR($4930,IERT,IERC,0)
02925		GOTO 3752
02926	C
02927	C       ENTER HERE TO CLOSE TICKET
02928	C
02929	3765    CALL DBOPEN('(TNT)TICMRK',BAS1)
02930		IF((ANS.EQ.'L').OR.(ANS.EQ.'S')) GOTO 93765
02931		TYPE 170,TIC
02932		ACCEPT 120,TNUM
02933		IF (TNUM.EQ.0)GOTO 4950
02934	93765   CALL DBSET(2)
02935		CALL DBFIND(1,1,TNUM)
02936		CALL DBNREC(NUMBER)
02937		IF (NUMBER.GT.0) GOTO 3774
02938		TYPE 660,TNUM
02939		GOTO 4950
02940	3774    CALL DBGREC($3776,NUMBER)
02941		CALL DBVAL(15,STAT,14,PROD,51,MAINT,52,SVER,49,DUP,
02942	     1  50,TUP,54,ELM,5,SDAT,6,TIM1,35,V6,36,V1,37,V2,38,V3,39,V4,
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-53


02943	     2  55,COC,46,ESC,9,NET,31,CNAM,40,NODE,53,HH)
02944	3776    CALL DBSET(1)
02945	3770    CALL DBFIND(1,1,TNUM)
02946		CALL DBNREC(NUMBER)
02947		IF (NUMBER.GT.0) GOTO 3780
02948		TYPE 3775
02949	3775    FORMAT(/5X,'****** NO Q.A. ENTRIES MADE ******',/)
02950		CALL DBCLOS
02951		GOTO 3740
02952	3780    TYPE 3785
02953	3785    FORMAT(/1X,'DATE',3X,'WHO',1X,'DSP',1X,'CODE',1X,'REGN',
02954	     1  2X,'COMMENT',/)
02955		DO 3795 I=1,NUMBER
02956		CALL DBGREC($3740,I)
%FTNDIM LINE:02956 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
02957		CALL DBVAL(2,SDAT,3,INT,5,SVER,6,MAINT,7,DS1,8,COMMT)
02958		CALL DBNDAT(SDAT,IM,ID,IY)
02959		TYPE 3790,IM,ID,INT,DS1,SVER,MAINT,COMMT
02960	3790    FORMAT(1X,I2,1H-,I2,2X,A3,2X,A1,3X,I2,2X,A5,1X,12A5)
02961	3795    CONTINUE
02962		CALL DBCLOS
02963		GOTO 3740
02964	C
02965	C
02966	C       ENTER HERE FROM S COMMAND
02967	C
02968	3800    CALL DBOPEN('(TNT)TICMRK')
02969		GOTO 3770
02970	C
02971	C  ********************************
02972	C
02973	C       ROUTINE TO ESCALATE A TICKET
02974	C
02975	C ***********************************
02976	C
02977	3805    TYPE 3810
02978	3810    FORMAT(/15X,'PERFORM AN ESCALATION',/,/3X,'ROUTINE TO ',
02979	     1  'TO NOTE THAT AN ESCALATION HAS BEEN PERFORMED.',/)
02980		CALL GDIS(V1,V2,V3,V4,V5,V6,TNUM,BAS1)
02981		IF (TNUM.EQ.0) GOTO 59
02982	3812    TYPE 3815
02983	3815    FORMAT(/,/3X,'WHICH DISCIPLINE WAS THE ESCALATION PERFORMED ',
02984	     1  'UNDER ?',/10X,'1 = HARWARE',/10X,'2 = SOFTWARE',/10X,
02985	     2  '3 = TELCO',/10X,'4 = CUSTOMER',/3X,'ENTER SELECTION : ',$)
02986		ACCEPT 120,K
02987		IF (K.EQ.0) GOTO 59
02988		IF ((K.LT.1).OR.(K.GT.4)) GOTO 3812
02989		IF (K.EQ.1) GOTO 3840
02990		IF (K.EQ.2) GOTO 3850
02991		IF (K.EQ.4) GOTO 3860
02992	3818    TYPE 3820,ITELC(1),ITELC(2),ITELC(3),ITELC(4),ITELC(5)
02993	3820    FORMAT(3X,'ENTER THE LEVEL OF TELCO SUPERVISION THAT THE ',
02994	     1  'PROBLEM WAS GIVEN TO...',/10X,'1 = ',A10,/10X,'2 = ',A10,
02995	     2  /10X,'3 = ',A10,/10X,'4 = ',A10,/10X,'5 = ',A10,/3X,'ENTER ',
02996	     3  'THE NUMBER : ',$)
02997		ACCEPT 120,P
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-54


02998		IF ((P.LT.1).OR.(P.GT.5)) GOTO 3812
02999		IF (P.GT.V3) GOTO 3838
03000		IF (P.LT.V3) TYPE 3825,ITELC(V3),ITELC(P)
03001	3825    FORMAT(/1X,'ACCORDING TO THE DATA BASE THIS TICKET HAD BEEN',
03002	     1  /1X,'ESCALATED TO THE ',A10,'. ARE YOU SAYING THAT YOU ',
03003	     2  /1X,'DE-ESCALATED THIS TICKET TO THE ',A10,'?',/,/3X,
03004	     3  'ENTER Y OR N : ',$)
03005		IF (P.EQ.V3) TYPE 3830,ITELC(V3)
03006	3830    FORMAT(/1X,'ACCORDING TO THE DATA BASE THIS TICKET IS ALREADY',
03007	     1  /1X,'AT THE ',A10,'. ARE YOU TRYING TO WASTE YOUR TIME AND ',
03008	     2  'MINE ?',/,/3X,'ENTER Y OR N : ',$)
03009		ACCEPT 65,SEE
03010		CALL HISET(SEE)
03011		IF (SEE.NE.'Y') GOTO 3818
03012	3838    V3=P
03013		V4=0
03014		GOTO 3860
03015	3840    TYPE 3842,HWARE(1),HWARE(2),HWARE(3),HWARE(4),HWARE(5)
03016	3842    FORMAT(3X,'ENTER THE FIELD ENGINEERING MANAGEMENT LEVEL THAT',
03017	     1  ' THE PROBLEM',/3X,'WAS ESCALATED TO...',/10X'1 = ',A10,/10X,
03018	     2  '2 = ',A10,/10X,'3 = ',A10,/10X,'4 = ',A10,/10X,'5 = ',A10,/3X,
03019	     3  'ENTER THE NUMBER : ',$)
03020		ACCEPT 120,P
03021		IF ((P.LT.1).OR.(P.GT.5)) GOTO 3812
03022		IF (P.GT.V1) GOTO 3848
03023		IF (P.LT.V1) TYPE 3845,HWARE(V1),HWARE(P)
03024	3845    FORMAT(1X,'ACCORDING TO THE DATA BASE THIS TICKET HAD BEEN',
03025	     1  /1X,'ESCALATED TO A ',A10,' LEVEL. ARE YOU SAYING THAT YOU',
03026	     2  /1X,'DE-ESCALATED THIS TICKET TO ',A10,'?',/,/3X,
03027	     3  'ENTER Y OR N : ',$)
03028		IF (P.EQ.V1) TYPE 3847,HWARE(V1)
03029	3847    FORMAT(1X,'ACCORDING TO THE DATA BASE THIS TICKET IS ALREADY',
03030	     1  /1X,'ESCALATED TO ',A10,' LEVEL. ARE YOU TRYING TO WASTE YOUR',
03031	     2  /1X'TIME AND MINE ?',/,/3X,'ENTER Y OR N : ',$)
03032		ACCEPT 65,SEE
03033		CALL HISET(SEE)
03034		IF (SEE.NE.'Y') GOTO 3840
03035	3848    V1=P
03036		V4=0
03037		GOTO 3860
03038	3850    TYPE 3852,SWARE(1),SWARE(2),SWARE(3),SWARE(4),SWARE(5),
03039	     1  SWARE(6)
03040	3852    FORMAT(3X,'ENTER THE LEVEL OF SOFTWARE ESCALATION THAT YOU ',
03041	     1  'HAVE PERFORMED...',/10X,'1 = ',A10,/10X,'2 = ',A10,/10X,'3 = ',
03042	     2  A10,/10X,'4 = ',A10,/10X,'5 = ',A10,/10X,'6 = ',A10,/3X,
03043	     3  'ENTER THE NUMBER : ',$)
03044		ACCEPT 120,P
03045		IF ((P.LT.1).OR.(P.GT.6)) GOTO 3812
03046		IF (P.GT.V2) GOTO 3858
03047		IF (P.LT.V2) TYPE 3825,SWARE(V2),SWARE(P)
03048		IF (P.EQ.V2) TYPE 3830,SWARE(V2)
03049		ACCEPT 65,SEE
03050		CALL HISET(SEE)
03051		IF (SEE.NE.'Y') GOTO 3850
03052	3858    V2=P
03053		V4=0
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-55


03054	3860    TYPE 3853
03055	3853    FORMAT(1X,'NAME OF PERSON ESCALATED TO : ',$)
03056		ACCEPT 100,RNAM
03057		CALL GTIM(TIM1,SDAT,LIC)
03058		CALL DBERR($3854,IERT,IERC,0)
03059		GOTO 3857
03060	3854    IF (IERT.NE.7) GOTO 4950
03061		TYPE 3285
03062		CALL WAIT(5.0)
03063	3857    CALL DBOPEN('(TNT)CALBAK')
03064		CALL DBUPD(-1)
03065		CALL DBADD(1,TNUM,2,SDAT,3,TIM1,4,RNAM,5,ME,6,1)
03066		CALL DBUPD(0)
03067		CALL DBCLOS
03068	3855    TYPE 3862,TNUM
03069	3862    FORMAT(3X'DO YOU HAVE ANY MORE ESCALATIONS TO PERFORM ON ',
03070	     1  'TICKET (#',I8,')',/3X,'ENTER Y OR N : ',$)
03071		ACCEPT 65,SEE
03072		CALL HISET(SEE)
03073		IF (SEE.EQ.'Y') GOTO 3812
03074		GOTO 3920
03075		ENCODE(841,207,DISC)
03076		GOTO 59
03077	C
03078	C       ROUTINE TO PLACE A TICKET ON DEFERMENT
03079	C
03080	3870    TYPE 3875
03081	3875    FORMAT(/15X,'PLACE A TICKET ON DEFERMENT',/)
03082		TYPE 170,TIC
03083		CALL DBOPEN(BAS1)
03084		ACCEPT 120,TNUM
03085		IF (TNUM.EQ.0) GOTO 59
03086		CALL DBFIND(1,1,TNUM)
03087		CALL DBNREC(NUMBER)
03088		IF (NUMBER.GT.0) GOTO 3882
03089		TYPE 660,TNUM
03090		GOTO 59
03091	3882    CALL DBGREC($3870,1)
03092		CALL DBVAL(34,V5,35,V6,36,V1,37,V2,38,V3,39,V4,'DUP',DUP)
03093		IF (DUP.NE.0) GOTO 3912
03094	3877    TYPE 3880,V4
03095	3880    FORMAT(/3X,'THIS TICKET IS CURRENTLY DEFERED FOR ',I2,
03096	     1  ' HOURS.',/3X,'DO YOU WISH TO...',/10X,'1 = REDUCE DEFERMENT ',
03097	     2  '(ENTER NEGATIVE TIME)',/10X,'2 = ZERO OUT DEFERMENT',/10X,
03098	     3  '3 = DEFER TICKET ACTION'/3X,'ENTER NUMBER : ',$)
03099		ACCEPT 120,P
03100		IF ((P.GT.0).AND.(P.LT.4)) GOTO 3890
03101		I=I+1
03102		IF (I.EQ.3) GOTO 59
03103		GOTO 3877
03104	3890    IF (P.EQ.3) GOTO 3900
03105		IF (P.EQ.2) GOTO 3910
03106		TYPE 3892
03107	3892    FORMAT(1X,'ENTER THE AMOUNT OF HOURS THAT SHOULD BE REMOVED',
03108	     1  /1X,'FROM THE TOTAL DEFERMENT HOURS (NEGATIVE NUMBER) ? ',$)
03109		ACCEPT 120,K
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-56


03110		IF (K.LT.0) GOTO 3895
03111		TYPE 3893,K
03112	3893    FORMAT(3X'*** ',I2,' *** IS NOT A NEGATIVE NUMBER, THIS TIME',
03113	     1  ' DO NOT FORGET THE MINUS SIGN!',/)
03114		GOTO 3877
03115	3895    V4=V4+K
03116		IF (V4.LT.0)V4=0
03117		V6=V6+K
03118	3920    CALL DBERR($3921,IERT,IERC,0)
03119		GOTO 3922
03120	3921    IF (IERT.NE.7) GOTO 4955
03121		TYPE 1379
03122		CALL WAIT(5.0)
03123	3922    CALL DBOPEN(BAS1)
03124		CALL DBUPD(-1)
03125		CALL DBFIND(1,1,TNUM)
03126		CALL DBCHNG(34,V5,35,V6,36,V1,37,V2,38,V3,39,V4)
03127		CALL DBCLOS
03128		CALL DBERR($4930,IERT,IERC,0)
03129		ENCODE(841,207,DISC)
03130		GOTO 59
03131	3900    TYPE 3902
03132	3902    FORMAT(1X,'HOW MANY HOURS SHOULD THIS TICKET BE DEFERED ?',
03133	     1  /1X'ENTER A NUMBER BETWEEN 1 AND 300 : ',$)
03134		ACCEPT 120,K
03135		IF ((K.LT.1).OR.(K.GT.300)) GOTO 3900
03136		V4=K
03137		V6=V6+K
03138		IF (V6.GT.999)V6=999
03139		GOTO 3920
03140	3910    V4=0
03141		GOTO 3920
03142	C
03143	C       TIME UP IS SET SO ZERO OUT DEFERMENT
03144	C
03145	3912    TYPE 3913
03146	3913    FORMAT(1X,'TIME UP IS SET. THERE IS NO NEED TO DEFFER THIS',
03147	     1  ' TICKET.')
03148		IF (V4.EQ.0) GOTO 4950
03149		V4=0
03150		GOTO 3920
03151	C
03152	C
03153	3925    ANS='D'
03154		TYPE 170,TIC
03155		ACCEPT 120,TNUM
03156		GOTO 2461
03157	C
03158	C
03159	C******************************
03160	C
03161	C       ROUTINE TO LIST TICKETS ON MONITOR MORE THAN
03162	C       24 HOURS.
03163	C
03164	C******************************
03165	C
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-57


03166	3930    TYPE 3935,FF,IA4,IA5,AM(IA1),IA2,IA3
03167	3935    FORMAT(/,A5,/3X,'ROUTINE TO LIST TICKETS ON MONITOR MORE',
03168	     1  /3X,'THAN 24 HOURS AS OF ',I2,1H:,I2,' ON ',A3,2H. ,I2,
03169	     2  2H, ,I4,1H.,/,/5X,'TICKET NUMBER',3X,'HOURS PAST 24',/)
03170		CALL DBOPEN(BAS1)
03171		IF (H2.EQ.0) CALL DBFIND(15,1,'MONIT')
03172		IF (H2.GT.0) CALL DBFIND(53,1,H2,1,15,1,'MONIT')
03173		DF=0
03174		CALL DBNREC(NUMBER)
03175		IF (NUMBER.EQ.0) GOTO 3945
03176		DUP=0
03177		TUP='     '
03178		DO 3942 I=1,NUMBER
03179		CALL DBGREC($4930,I)
%FTNDIM LINE:03179 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
03180		CALL DBVAL(1,TNUM,49,SDAT,50,TIM1)
03181		ELM=0
03182		CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
03183		IF (ELM.LT.1440) GOTO 3942
03184		TYPE 3937,TNUM,HOUR
03185	3937    FORMAT(9X,I8,8X,F7.1)
03186		DF=1
03187	3942    CONTINUE
03188	3945    IF (DF.EQ.0) TYPE 3944
03189	3944    FORMAT(/,/8X,'NONE',/)
03190		TYPE 3253
03191		GOTO 4950
03192	C
03193	C***********************************8
03194	C
03195	C       PRINTS TIME AND DATE ON TERMINAL
03196	C
03197	C*************************************
03198	C
03199	3950    CALL FGMT(IA1,IA2,IA3,IA4,IA5,IA6)
03200		CALL TIME(TIM1)
03201		TYPE 3952,IA4,IA5,IA2,AM(IA1),IA3,TIM1
03202	3952    FORMAT(15X,'ZULU TIME IS ',I2,1H:,I2,' ON ',I2,1H-,A3,1H-,I2,
03203	     1  1H.,/14X,'LOCAL TIME IS ',A5,/)
03204		I=1
03205		GOTO 59
03206	C
03207	C
03208	C******************************************
03209	C
03210	C       ROUTINE TO ENTER CALL BACK LOG ONLY
03211	C       ENTER 3959 FROM 30 DAY HISTORY CHECK
03212	C******************************************
03213	C
03214	3960    TYPE 170,TIC
03215	3961    ACCEPT 120,TNUM
03216	3959    IF (ANS.EQ.'A') TNUM=TOT
03217	93959   IF (TNUM.EQ.0) GOTO 59
03218		CALL DBOPEN('(TNT)BASE1')
03219		CALL DBFIND(1,1,TNUM)
03220		CALL DBNREC(NUMBER)
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-58


03221		IF (NUMBER.GT.0) GOTO 3962
03222		TYPE 202,TNUM
03223		TYPE 170,TIC
03224		GOTO 3961
03225	3962    CALL DBGREC($3960,1)
03226		CALL DBVAL(52,SVER,53,HN)
03227		CALL DBCLOS
03228		IF (ANS.EQ.'A') GOTO 3963
03229		TYPE 170,RW1
03230		ACCEPT 100,REPN
03231		CALL UPCASE(REPN)
03232		TYPE 170,SC
03233		ACCEPT 100,SITC
03234		CALL UPCASE(SITC)
03235		TYPE 170,SP
03236		ACCEPT 100,SITP
03237		CALL RTIM(TIM1,SDAT)
03238	3963    CALL DBERR($3284,IERT,IERC,0)
03239		GOTO 3286
03240	C********************
03241	C
03242	C       OPEN DATA BASE TO SEE IF WE HAVE A MATCH
03243	C
03244	C********************
03245	C
03246	3975    FORMAT(/3X,'IS THIS A NODE, HOST, CIRCUIT, OR FRAME RELAY ',
03247	     1  'TICKET?',/4X,'ENTER N,H,C, OR F :  ',$)
03248	4005    CALL DBNREC(RECORD)
03249		IF (RECORD.GT.0) GOTO 3986
03250		TYPE 3985
03251	3985    FORMAT('+NOT FOUND',/)
03252		GOTO 4054
03253	C
03254	C       ENTER HERE WHEN RECORD HEADER FOUND 
03255	C
03256	3986    TYPE 3987
03257	3987    FORMAT('+FOUND !!',/)
03258		CALL DBGREC($4005,1)
03259	4009    CALL DBVAL(1,SITC,2,SITP,3,NET,4,NOD1,5,SLOT,6,HST1,7,CIRCKT,
03260	     1  8,TROUB1,9,TECH,10,CNAM,11,KHST,12,COV,13,PRO,14,STH,15,EHR,16,
03261	     2  PORT,18,PROD,21,LOC,22,VER,23,T40,25,SRGN,26,HRGN,27,LIN1,
03262	     3  28,SNAM,29,SDAT,30,INT,31,F1)
03263		CALL DBNDAT(SDAT,IM,ID,IY)
03264		IF (LIN1(1).NE.'     ') TYPE 4021,SNAM,ID,AM(IM),IY,INT,LIN1
03265	4021    FORMAT(/,/3X,'***  SPECIAL INSTRUCTION  ***    ENTERED BY : ',
03266	     1  3A5,/9X,I2,1H-,A3,1H-,I4,4X,1H(,A3,1H),/,/1X,16A5,/)
03267		IF(T40.EQ.4) TYPE 4024
03268	4024    FORMAT(/,/,/,/,/,/17X,'*****THIS IS A CODE BLUE CUSTOMER*****',
03269	     1  /,/7X,'MAKE SURE YOU NOTIFY THE APPROPRIATE MANAGEMENT ',
03270	     2  'PERSONNEL',/,/11X,'FAILURE TO DO SO WILL RESULT IN GRAVE ',
03271	     3  'CONSEQUENCES',/,/,/,/,/)
03272		IF (WELL.EQ.'F') CALL FPRUPD(SITC,SITP,NET,NOD1,SLOT,HST1,
03273	     1  CIRCKT,TROUB1,TECH,CNAM,KHST,COV,PRO,STH,EHR,PORT,PROD,LOC,
03274	     2  VER,T40,SRGN,HRGN,LIN1,SNAM,SDAT,INT,F1,RECORD,IPXNA,CRDNM,
03275	     3  PRTNM)
03276		IF (WELL.EQ.'F') K=38
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-59


03277		IF (WELL.EQ.'F') GOTO 4016
03278		IF (RECORD.GT.0) GOTO 4007
03279	4008    FORMAT(2(A5))
03280		IF(NET(1).EQ.'     ')DECODE(10,4008,VNET(K))NET(1),NET(2)
03281		Z=1
03282		IF (WELL.EQ.'N') NOD1=NODE
03283		IF (WELL.EQ.'H') HST1=HOST
03284		IF (WELL.EQ.'C') ENCODE(20,100,CIRCKT)CKT(1),CKT(2),CKT(3),
03285	     1  CKT(4)
03286		IF (ANS.EQ.'A2') GOTO 4016
03287	4007    IF (ANS.EQ.'A2') GOTO 4020
03288		IF (ANS.EQ.'MP') GOTO 6000
03289		TYPE 4010
03290	4010    FORMAT(' BEGIN CHECK FOR EMPTY FIELDS',/)
03291		IF((WELL.EQ.'C').AND.(NOD1.EQ.0))CALL GTW3(LNO,NOD1,Z)
03292		IF((WELL.EQ.'C').AND.(HST1.EQ.0))CALL GTW3(HNO,HST1,Z)
03293		IF (SITC(1).EQ.'     ') CALL GTHRE(SC,SITC,Z)
03294		IF (SITP(1).EQ.'     ') CALL GTHRE(SP,SITP,Z)
03295		IF (SLOT.EQ.'  ') CALL G1NE(SL,SLOT,Z)
03296		IF (WELL.EQ.'H') CALL GTWO(OCKT,CIRCKT,Z,2)
03297		IF (TROUB1(1).EQ.'     ') CALL GTHRE(OTRB,TROUB1,Z)
03298		IF((TECH(1).EQ.'     ').AND.(WELL.NE.'C'))CALL GTHR3(RP1,
03299	     1  TECH,Z,1)
03300		IF((TECH(1).EQ.'     ').AND.(WELL.EQ.'C'))CALL GTHR3('ANALYSIS',
03301	     1  TECH,Z,1)
03302		IF (SRGN.EQ.'     ') CALL GRGN(1,P,Z,NATTN)
03303		IF ((SRGN.EQ.'     ').AND.(P.GT.0))DECODE(5,65,ATTN(P))SRGN
03304		IF (HRGN.EQ.'     ') CALL GRGN(2,P,Z,NATTN)
03305		IF ((HRGN.EQ.'     ').AND.(P.GT.0))DECODE(5,65,ATTN(P))HRGN
03306		CALL GTHR3(RW1,CNAM,Z,2)
03307		IF ((WELL.EQ.'H').AND.(NOD1.EQ.0))CALL GONE(NO,NOD1,Z)
03308		IF (KHST.EQ.0) CALL GONE(OKH,KHST,Z)
03309		IF (PORT.EQ.0) CALL GONE(PTS,PORT,Z)
03310		IF (PRO.EQ.0) CALL GTW2(OPRO,PRO,Z)
03311		IF (COV.EQ.'  ') CALL GTW1(OCV,COV,Z)
03312		IF (STH.EQ.0) CALL GTW1(OSTH,STH,Z)
03313		IF (EHR.EQ.0) CALL GTW1(OEHR,EHR,Z)
03314	4011    CALL GPROD(NTYPE,P,Z)
03315		IF (TYPE(P).NE.'     ') GOTO 94011
03316		TYPE 92399,P
03317		GOTO 4011
03318	94011   IF (LOC(1).EQ.'     ') CALL GTWO(OLOC,LOC,Z,2)
03319		IF(WELL.EQ.'C') GOTO 94016
03320		IF (VER.EQ.'     ') GOTO 94017
03321		IF (CSC.EQ.1) GOTO 94018
03322		TYPE 94015,VER
03323	94015   FORMAT(/1X,'VERSION IS CURRENTLY SET TO ',A5,/1X,
03324	     1  'DO YOU WISH TO CHANGE IT?  ',$)
03325		ACCEPT 65,VCHG
03326		CALL HISET(VCHG)
03327		IF(VCHG.EQ.'Y') CALL GTW1(OVER,VER,Z)
03328		GOTO 94016
03329	94017   IF ((VER.EQ.'     ').AND.(WELL.NE.'C'))CALL GTW1(OVER,VER,Z)
03330	94016   IF ((VER.EQ.'     ').AND.(WELL.EQ.'C'))CALL GTW1('HIKHST',VER,Z)
03331	94018   IF (F1.EQ.0) CALL GZONE(F1,Z)
03332		IF ((Z.EQ.1).AND.(ANS.EQ.'AP')) GOTO 4950
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-60


03333		IF (Z.EQ.1) GOTO 4020
03334		IF(P.GT.0) DECODE(5,65,TYPE(P))PROD
03335	4016    CALL DBERR($4015,IERT,IERC,0)
03336		GOTO 4018
03337	4015    IF (IERT.NE.7) GOTO 4955
03338		TYPE 1379
03339		CALL WAIT(5.0)
03340	4018    CALL DBOPEN(BAS10)
03341		CALL DBUPD(-1)
03342		TYPE 4019
03343	4019    FORMAT(' UPDATING RELATIONS ... ',$)
03344		CALL DBSYSV(1,0,CDAT)
03345		IF ((K.NE.34).OR.(WELL.NE.'H')) GOTO 4028
03346		CALL DBFIND(17,1,WELL,1,6,1,HST1,1,3,1,VNET(K),1,4,1,NOD1)
03347		GOTO 4029
03348	4028    IF (WELL.EQ.'N') CALL DBFIND(17,1,WELL,1,4,1,NOD1,1,3,1,VNET(K))
03349		IF (WELL.EQ.'H') CALL DBFIND(17,1,WELL,1,6,1,HST1,1,3,1,VNET(K))
03350		IF (WELL.EQ.'C') CALL DBFIND(17,1,WELL,1,7,1,CIRCKT)
03351		IF (WELL.EQ.'F') CALL DBFIND(17,1,WELL,1,18,1,IPXNA,1,6,1,
03352	     1  CRDNM,1,5,1,PRTNM)
03353	4029    CALL DBNREC(NUMBER)
03354		IF (NUMBER.EQ.0) GOTO 4025
03355	74026   CALL DBCHNG(1,SITC,2,SITP,4,NOD1,5,SLOT,6,HST1,7,CIRCKT,8,
03356	     1  TROUB1,9,TECH,11,KHST,12,COV,13,PRO,14,STH,15,EHR,16,
03357	     2  PORT,18,PROD,19,CDAT,20,ME,21,LOC,22,VER,24,UNAM,25,SRGN,
03358	     3  26,HRGN,23,t40,31,F1,10,CNAM)
03359		IF (NUMBER.EQ.1) GOTO 4023
03360		DO 4026 I=2,NUMBER
03361		CALL DBGREC($4026,I)
%FTNDIM LINE:03361 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
03362		CALL DBDEL
03363	4026    CONTINUE
03364	4023    CALL DBCLOS
03365		TYPE 4017
03366		CALL DBERR($4930,IERT,IERC,0)
03367	4017    FORMAT('+COMPLETE',/)
03368		IF ((ANS.EQ.'A2').OR.(ANS.EQ.'A ')) GOTO 4020
03369		IF ((Z.EQ.3).AND.(NOD1.GT.0)) GOTO 3360
03370		GOTO 59
03371	C
03372	C       ENTER HERE FROM A2 COMMAND
03373	C
03374	4020    TYPE 170,RW2
03375		ACCEPT 100,REPN
03376		IF (REPN(1).EQ.'     ') GOTO 4022
03377		TYPE 170,RP2
03378		ACCEPT 100,REPF
03379		GOTO 180
03380	4022    CALL NPHONE(REPN,REPF,UNAM,JJ1)
03381		GOTO 180
03382	4025    TYPE 4030
03383	4030    FORMAT(' ADDING INFORMATION TO RELATIONAL DATA BASE...',$)
03384	74030   CALL DBADD(1,SITC,2,SITP,4,NOD1,5,SLOT,6,HST1,7,CIRCKT,8,
03385	     1  TROUB1,9,TECH,11,KHST,12,COV,13,PRO,14,STH,15,EHR,
03386	     2  16,PORT,18,PROD,19,CDAT,20,ME,21,LOC,22,VER,24,UNAM,25,
03387	     3  SRGN,26,HRGN,17,WELL,3,VNET(K),23,T40,31,F1,10,CNAM)
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-61


03388		CALL DBCLOS
03389		TYPE 4017
03390		CALL DBERR($4930,IERT,IERC,0)
03391		IF (ANS.EQ.'AP') GOTO 59
03392		IF (ANS.EQ.'MP') GOTO 59
03393		IF (RECORD.EQ.0) GOTO 4020
03394		GOTO 59
03395	C
03396	C************************************
03397	C
03398	C       ROUTINE TO FIND OPEN TICKETS IN BASE1
03399	C
03400	C************************************
03401	C
03402	4035    TYPE 3975
03403		HDRCHK=0
03404		JJ1=0
03405		CALL DBOPEN(BAS1)
03406	4038    ACCEPT 65,WELL
03407		CALL HISET(WELL)
03408		IF (WELL.EQ.'N') GOTO 4040
03409		IF (WELL.EQ.'H') GOTO 4045
03410		IF (WELL.EQ.'C') GOTO 4046
03411		IF (WELL.EQ.'F') GOTO 70009
03412		TYPE 3975
03413		GOTO 4038
03414	70009   TYPE 70010
03415	70010   FORMAT(/1X,'IN ORDER TO OPEN A FRAME RELAY TICKET YOU MUST ',
03416	     1  'KNOW THE',/1X,'IPX NAME, THE CARD #, AND THE PORT #.',/1X,
03417	     2  'DO YOU WISH TO CONTINUE?  (Y OR N)',$)
03418		ACCEPT 70015,YORN
03419	70015   FORMAT(A5)
03420		CALL HISET(YORN)
03421		IF (YORN.NE.'Y') GOTO 59
03422		I=1
03423	70019   TYPE 70020
03424	70020   FORMAT(/1X,'ENTER THE 5 CHARACTER IPX NAME:  ',$)
03425		ACCEPT 70021,IPXNA
03426	70021   FORMAT(A5)
03427		CALL HISET(IPXNA)
03428		I=I+1
03429		IF (I.EQ.4) GOTO 59
03430		IF (IPXNA.EQ.' ') GOTO 70019
03431		DECODE(5,70021,IPXNA)PROD
03432		I=1
03433	70025   TYPE 70026
03434	70026   FORMAT(/1X,'ENTER THE CARD NUMBER:  ',$)
03435		ACCEPT 70027,CRDNM
03436	70027   FORMAT(I2)
03437		I=I+1
03438		IF (I.EQ.4) GOTO 59
03439		IF (CRDNM.EQ.0) GOTO 70025
03440		I=1
03441	70030   TYPE 70031
03442	70031   FORMAT(/1X,'ENTER THE PORT NUMBER:  ',$)
03443		ACCEPT 70032,PRTNM
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-62


03444	70032   FORMAT(A2)
03445		I=I+1
03446		IF (I.EQ.4) GOTO 59
03447		IF (PRTNM.EQ.' ') GOTO 70030
03448		DECODE(2,70032,PRTNM)SLOT
03449		GOTO 4044
03450	4040    TYPE 188,NO
03451		ACCEPT 120,NOD1
03452		IF (NOD1.EQ.0) GOTO 4040
03453		IF (FLAG.GT.0) GOTO 4042
03454	4041    TYPE 110
03455		ACCEPT 120,K
03456		IF ((K.GE.1).AND.(K.LE.NUMNET)) GOTO 4044
03457		CALL HLPNET
03458		GOTO 4041
03459	4042    K=FLAG
03460	4044    IF ((ANS.EQ.'AP').OR.(ANS.EQ.'MP')) GOTO 4054
03461		TYPE 131
03462		IF (WELL.EQ.'N') CALL DBFIND(9,1,VNET(K),1,40,1,NOD1,1,
03463	     1  15,1,'OPEN')
03464		IF (WELL.EQ.'H') CALL DBFIND(9,1,VNET(K),1,42,1,HST1,1,
03465	     1  15,1,'OPEN')
03466		IF (WELL.EQ.'C') CALL DBFIND(43,1,CIRCKT,1,15,1,'OPEN')
03467		IF (WELL.EQ.'F') CALL DBFIND(15,1,'OPEN',1,14,1,IPXNA,1,
03468	     1  42,1,CRDNM,1,41,1,PRTNM)
03469		CALL DBNREC(DECIS)
03470		IF ((DECIS.GT.0).AND.(WELL.EQ.'F')) GOTO 74055
03471		IF (DECIS.GT.0) GOTO 4055
03472		TYPE 135
03473		CALL DBCLOS
03474		GOTO 140
03475	4054    TYPE 3983
03476	3983    FORMAT('  SEARCHING FOR RECORD ...',$)
03477		CALL DBOPEN(BAS10)
03478		IF ((K.NE.34).OR.(WELL.NE.'H')) GOTO 4056
03479		CALL DBFIND(17,1,WELL,1,6,1,HST1,1,3,1,VNET(K),1,4,1,NOD1)
03480		GOTO 4057
03481	4056    IF (WELL.EQ.'N') CALL DBFIND(17,1,WELL,1,4,1,NOD1,1,3,1,VNET(K))
03482		IF (WELL.EQ.'H') CALL DBFIND(17,1,WELL,1,6,1,HST1,1,3,1,VNET(K))
03483		IF (WELL.EQ.'C') CALL DBFIND(17,1,WELL,1,7,1,CIRCKT)
03484		IF (WELL.EQ.'F') CALL DBFIND(17,1,WELL,1,18,1,IPXNA,1,6,1,
03485	     1  CRDNM,1,5,1,PRTNM)
03486	4057    CALL DBNREC(RECORD)
03487		IF (RECORD.GT.0) GOTO 3986
03488		IF (ANS.NE.'MP') GOTO 4058
03489		TYPE 64057
03490	64057   FORMAT(/1X,'NO RECORD FOUND.  USE THE "AP" COMMAND')
03491		CALL DBCLOS
03492		GOTO 59
03493	4058    CALL DBFIND(17,1,'Z')
03494		CALL DBGREC($4054,1)
03495		NODE=NOD1
03496		HOST=HST1
03497		ENCODE(20,100,CKT)CIRCKT(1),CIRCKT(2),CIRCKT(3),CIRCKT(4)
03498		GOTO 4009
03499	4045    TYPE 188,HO
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-63


03500		ACCEPT 194,HST1
03501		IF (HST1.EQ.0) GOTO 4045
03502		IF (FLAG.GT.0) GOTO 4047
03503	4046    TYPE 110
03504		ACCEPT 120,K
03505		IF ((K.GE.1).AND.(K.LE.NUMNET)) GOTO 4051
03506		CALL HLPNET
03507		GOTO 4046
03508	4047    K=FLAG
03509	4051    IF (WELL.EQ.'C')GOTO 4050
03510		IF (K.NE.34) GOTO 4044
03511	4049    TYPE 188,NO
03512		ACCEPT 120,NOD1
03513		IF (NOD1.EQ.0) GOTO 4049
03514		GOTO 4044
03515	4050    TYPE 203,OCKT
03516		ACCEPT 100,CIRCKT
03517		IF (CIRCKT(1).EQ.'     ') GOTO 4050
03518		CALL UPCASE(CIRCKT)
03519		GOTO 4044
03520	74055   DO 74060 I=1,DECIS
03521		CALL DBGREC($4054,I)
%FTNDIM LINE:03521 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
03522		CALL DBVAL(1,TNUM,5,SDAT,6,TIM1,40,NODE,42,HOST,14,PROD,
03523	     1  57,RE,41,SLOT)
03524		CALL DBNDAT(SDAT,IM,ID,IY)
03525		IY=IY-1900
03526		TYPE 70130,TNUM,IM,ID,IY,TIM1,NODE,PROD,HOST,SLOT
03527	70130   FORMAT(1X,I8,T11,I2,1H/,I2,1H/,I2,4X,A5,T30,I5,T37,A5,T45,
03528	     1  I6,T68,I2)
03529	74060   CONTINUE
03530		TOT=TNUM
03531		GOTO 70050
03532	4055    DO 4060 I=1,DECIS
03533		CALL DBGREC($4054,I)
%FTNDIM LINE:03533 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
03534		CALL DBVAL(1,TNUM,5,SDAT,6,TIM1,40,NODE,42,HOST,43,CKT,14,
03535	     1  PROD,57,RE)
03536		CALL DBNDAT(SDAT,IM,ID,IY)
03537		IY=IY-1900
03538		TYPE 130,TNUM,IM,ID,IY,TIM1,NODE,HOST,CKT,PROD
03539	130     FORMAT(1X,I8,T11,I2,1H/,I2,1H/,I2,4X,A5,T30,I5,T37,I6,T45,
03540	     1  4A5,T68,A5,1X,2A5)
03541	4060    CONTINUE
03542		TOT=TNUM
03543	C
03544	C       CHECK TO SEE IF MORE DETAIL NEEDED
03545	C
03546	70050   TYPE 134
03547		ACCEPT 65,SEE
03548		CALL HISET(SEE)
03549		IF (SEE.EQ.'Y') GOTO 3292
03550	C
03551	C       SEE IF ADD TO CALL BACK LIST
03552	C
03553	4062    TYPE 133,DECIS,NODE
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-64


03554		ACCEPT 65,SEE
03555		CALL HISET(SEE)
03556		IF (SEE.NE.'Y') GOTO 4063
03557		ANS='A1'
03558		GOTO 3960
03559	C       IF YES GOTO 140 GET TNUM THEN GOTO 4054
03560	C
03561	C       SEE IF USER WANTS TO OPEN ANOTHER TICKET
03562	C
03563	4063    TYPE 162
03564		ACCEPT 65,SEE
03565		CALL HISET(SEE)
03566		IF (SEE.EQ.'Y') GOTO 140
03567		CALL DBCLOS
03568		GOTO 59
03569	C
03570	C***********************************
03571	C
03572	C       ROUTINE TO START OF THE ADDING TO THE PROFILE
03573	C       DATA BASE UNDER 1022
03574	C
03575	C***********************************
03576	C
03577	4065    TYPE 4068
03578	4068    FORMAT(/3X,'ROUTINE TO ADD A RECORD TO THE PROFIL DATA ',
03579	     1  'BASE...')
03580		TYPE 3975
03581		GOTO 4038
03582	4067    TYPE 4069
03583	4069    FORMAT(/3X,'ROUTINE TO MODIFY A RECORD IN THE PROFIL DATA ',
03584	     1  'BASE...')
03585		TYPE 3975
03586		GOTO 4038
03587	C
03588	C***********************************
03589	C
03590	C       ROUTINE TO DISPLAY A PROFIL RECORD
03591	C
03592	C***********************************
03593	C
03594	4070    TYPE 4075
03595	4075    FORMAT(/1X,'ROUTINE TO DISPLAY A RECORD FROM THE PROFIL ',
03596	     1  'DATA BASE',/)
03597		TYPE 3975
03598		CALL DBOPEN(BAS10)
03599	4077    ACCEPT 65,WELL
03600		CALL HISET(WELL)
03601		IF ((WELL.EQ.'N').OR.(WELL.EQ.'H')) GOTO 4080
03602		IF (WELL.EQ.'C') GOTO 4078
03603		TYPE 3975
03604		GOTO 4077
03605	4078    TYPE 203,OCKT
03606		ACCEPT 100,CKT
03607		IF (CKT(1).EQ.'     ') GOTO 59
03608		CALL DBFIND(7,1,CKT,1,17,1,WELL)
03609		GOTO 4090
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-65


03610	4080    IF (FLAG.LT.1) GOTO 4081
03611		K=FLAG
03612		GOTO 4084
03613	4081    TYPE 110
03614		ACCEPT 120,K
03615		IF ((K.GE.1).AND.(K.LE.NUMNET)) GOTO 4084
03616		CALL HLPNET
03617		GOTO 4080
03618	4084    IF (WELL.EQ.'N') CALL GPNUM(NO,NODE)
03619		IF (WELL.EQ.'H') CALL GPNUM(HO,HOST)
03620		IF (WELL.EQ.'N') CALL DBFIND(3,1,VNET(K),1,4,1,NODE,1,
03621	     1  17,1,WELL)
03622		IF (WELL.EQ.'H') CALL DBFIND(3,1,VNET(K),1,6,1,HOST,1,
03623	     1  17,1,WELL)
03624	4090    CALL DBNREC(NUMBER)
03625		IF (NUMBER.GT.0) GOTO 4095
03626		TYPE 4092
03627	4092    FORMAT(/3X,'NO RECORDS FOUND ...',//2X,'WOULD YOU LIKE TO ',
03628	     1  'TRY AGAIN ? ',$)
03629		ACCEPT 65,SEE
03630		CALL HISET(SEE)
03631		IF (SEE.NE.'Y') GOTO 4950
03632		TYPE 3975
03633		GOTO 4077
03634	4095    IF (NUMBER.EQ.1) GOTO 4103
03635		TYPE 4097
03636	4097    FORMAT(/1X,'REC #',2X,'NODE',3X,'HOST',3X,'CUSTOMER NAME',4X,
03637	     1  'CIRCUIT I.D.'10X,'PRODUCT',/)
03638		DO 4100 I=1,NUMBER
03639		CALL DBGREC($4100,I)
%FTNDIM LINE:03639 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
03640		CALL DBVAL(1,SITC,2,SITP,3,NET,4,NOD1,5,SLOT,6,HST1,7,CIRCKT,
03641	     1  8,TROUB1,9,TECH,10,CNAM,11,KHST,12,COV,13,PRO,14,STH,15,EHR,16,
03642	     2  PORT,18,PROD,21,LOC,22,VER,23,T40,25,SRGN,26,HRGN)
03643		TYPE 4098,I,NOD1,HST1,CNAM,CIRCKT,PROD
03644	4098    FORMAT(3X,I2,3X,I5,1X,I6,2X,3A5,2X,4A5,2X,A5)
03645	4100    CONTINUE
03646		TYPE 4102
03647	4102    FORMAT(/1X,'WHICH REC # DO YOU WISH TO SEE : ',$)
03648		ACCEPT 120,P
03649		IF (P.LE.0) GOTO 4950
03650	4104    CALL DBGREC($4950,P)
03651		CALL DBVAL(1,SITC,2,SITP,3,NET,4,NOD1,5,SLOT,6,HST1,7,CIRCKT,
03652	     1  8,TROUB1,9,TECH,10,CNAM,11,KHST,12,COV,13,PRO,14,STH,15,EHR,16,
03653	     2  PORT,18,PROD,21,LOC,22,VER,23,T40,25,SRGN,26,HRGN,17,TYP)
03654		IF (TYP.EQ.'N') GOTO 4110
03655		IF (TYP.EQ.'H') GOTO 4115
03656		TYPE 4105,NET,CIRCKT,NOD1,HST1,TROUB1,TECH,CNAM,COV,YN(PRO),
03657	     1  STH,EHR,PROD,LOC,VER,YN(T40),SRGN,HRGN,SITC,SITP
03658	4105    FORMAT(/1X,'NETWORK : '2A5,3X,'CIRCUIT : ',4A5,2X'LONODE : ',
03659	     1  I5,/1X,'HINODE : ',I5,T23,'TROUBLE #: ',4A5,' ANALYSIS : ',
03660	     2  3A5,/1X'CUSTOMER : ',3A5,T30,'COVERAGE : ',A2,10X,
03661	     3  'PRODUCTION : ',A3,/1X,'SITE HOURS : ',
03662	     4  A5,' TO ',A5,T58,'SPEED : ',A5,/1X,'LOCATION : ',
03663	     5  4A5,' VERSION : ',A5,4X,'T40 : ',A3,/1X,'SOFTWARE DIST.: ',
03664	     6  A5,4X,'HARDWARE DIST.: ',A5,/1X,'SITE CONTACT : ',4A5,
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-66


03665	     7  ' PHONE : ',4A5)
03666		GOTO 4950
03667	4110    TYPE 4112,NET,NOD1,KHST,HST1,CIRCKT,SLOT,TROUB1,TECH,CNAM,COV,
03668	     1  YN(PRO),STH,EHR,PORT,PROD,LOC,VER,YN(T40),SRGN,HRGN,SITC,SITP
03669	4112    FORMAT(/1X,'NETWORK : ',2A5,3X,'NODE : ',I5,3X,'KERNAL : ',I5,
03670	     1  4X,'HOST : ',I6,/1X,'CIRCUIT : ',4A5,3X'SLOT : ',A2,/1X,'TELCO ',
03671	     2  ': ',4A5,5X'TECH : ',3A5,/1X,'CUSTOMER : ',3A5,3X,'COVERAGE : ',
03672	     3  A3,4X,'PRODUCTION : ',A3,/1X,'SITE HOURS : ',A5,' TO ',A5,5X,
03673	     4  'PORTS : ',I3,7X,'PRODUCT : ',A5,/1X,'LOCATION : ',4A5,4X,
03674	     5  'VERSION : ',A5,9X,'T40 : ',A3,/1X,'SOFT. DIST. : ',A5,T28,
03675	     6  'HARD. DIST. : ',A5,/1X,'SITE CONTACT : ',4A5,4X,'PHONE : ',4A5)
03676		GOTO 4950
03677	4115    TYPE 4117,NET,HST1,NOD1,KHST,SLOT,VER,PROD,YN(PRO),YN(T40),
03678	     1  COV,CNAM,LOC,SITC,SITP,CIRCKT,TROUB1,TECH,STH,EHR,PORT,SRGN,
03679	     2  HRGN
03680	4117    FORMAT(/1X,'NETWORK : ',2A5,3X,'HOST : ',I6,3X,'NODE : ',I5,
03681	     1  3X,'KERNAL : ',I5,3X,'SLOT : ',A2,/1X,'VERSION : ',A5,3X,
03682	     2  'PRODUCT : ',A5,3X,'PRODUCTION : ',A3,3X,'T40 : ',A3,3X,
03683	     3  'COVERAGE : ',A2,/1X,'CUSTOMER : ',3A5,3X,'LOCATION : ',4A5,/1X,
03684	     4  'SITE CONTACT : '4A5,3X,'PHONE : ',4A5,/1X,'CIRCUIT : ',4A5,3X,
03685	     5  'TELCO # : ',4A5,/1X,'TECH : ',3A5,3X,'SITE HOURS : ',A5,' TO ',
03686	     6  A5,4X,'PORTS : ',I3,/1X,'SOFTWARE DIST.: ',A5,4X,'HARDWARE ',
03687	     7  'DIST.: ',A5)
03688		GOTO 4950
03689	C
03690	C       LIST OPERATIONAL TICKETS ONLY
03691	C
03692	4120    TYPE 4122
03693	4122    FORMAT(/1X,'OPERATIONAL TICKET LISTER...',/,/)
03694		CALL DBOPEN(BAS1)
03695		CALL DBFIND(15,1,'OPEN','OR',15,1,'MONIT')
03696		CALL DBNREC(NUMBER)
03697		IF (NUMBER.EQ.0) GOTO 4124
03698		TYPE 772,NUMBER
03699		GOTO 773
03700	4124    TYPE 810
03701		GOTO 4950
03702	C
03703	C       SET P = 1 FOR SINGLE RECORDS THEN GOTO GETREC
03704	C
03705	4103    P=1
03706		GOTO 4104
03707	C
03708	C*********************************************
03709	C
03710	C       ADD SPECIAL COMMENT
03711	C
03712	C*********************************************
03713	C
03714	4125    TYPE 4127
03715	4127    FORMAT(1X,'ROUTINE TO ADD SPECIAL COMMENT ...')
03716		TYPE 3975
03717		CALL DBOPEN(BAS10)
03718	4129    ACCEPT 65,WELL
03719		CALL HISET(WELL)
03720		IF ((WELL.EQ.'N').OR.(WELL.EQ.'H')) GOTO 4134
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-67


03721		IF (WELL.EQ.'C') GOTO 4140
03722		TYPE 3975
03723		GOTO 4129
03724	4134    IF (FLAG.GT.0) GOTO 4136
03725	4135    TYPE 110
03726		ACCEPT 120,K
03727		IF ((K.GE.1).AND.(K.LE.NUMNET)) GOTO 4137
03728		CALL HLPNET
03729		GOTO 4135
03730	4136    K=FLAG
03731		GOTO 4137
03732	4140    TYPE 203,OCKT
03733		ACCEPT 100,CKT
03734		CALL UPCASE(CKT)
03735		IF (CKT(1).EQ.'     ') GOTO 59
03736		TYPE 3983
03737		NODE=0
03738		HOST=0
03739		CALL DBFIND(7,1,CKT)
03740		GOTO 4145
03741	4137    IF (WELL.EQ.'N') GOTO 4142
03742		CALL GPNUM(HO,HOST)
03743		NODE=0
03744		ENCODE(20,214,CKT)
03745		CALL DBFIND(3,1,VNET(K),1,6,1,HOST)
03746		GOTO 4145
03747	4142    CALL GPNUM(NO,NODE)
03748		HOST=0
03749		ENCODE(20,214,CKT)
03750		CALL DBFIND(3,1,VNET(K),1,4,1,NODE)
03751	4145    CALL DBNREC(NUMBER)
03752		IF (NUMBER.GT.0) TYPE 3987
03753		IF (NUMBER.LE.0) TYPE 3985
03754		TYPE 4146
03755	4146    FORMAT(1X,'ENTER YOUR ONE LINE SPECIAL COMMENT (80 CHARS.',
03756	     1  ' MAX)',/)
03757		ACCEPT 4148,LIN1
03758	4148    FORMAT(16A5)
03759		IF ((LIN1(1).EQ.'     ').AND.(LIN1(2).EQ.'     ')) GOTO 4950
03760		CALL DBSYSV(1,0,SDAT)
03761		IF (NUMBER.EQ.0) GOTO 4152
03762		CALL DBERR($4155,IERT,IERC,0)
03763		GOTO 4156
03764	4155    IF (IERT.NE.7) GOTO 4955
03765		TYPE 1379
03766		CALL WAIT(7.0)
03767	4156    CALL DBOPEN(BAS10)
03768		CALL DBUPD(-1)
03769		IF (WELL.EQ.'N') CALL DBFIND(3,1,VNET(K),1,4,1,NODE)
03770		IF (WELL.EQ.'H') CALL DBFIND(3,1,VNET(K),1,6,1,HOST)
03771		IF (WELL.EQ.'C') CALL DBFIND(7,1,CKT)
03772		CALL DBCHNG(27,LIN1,28,UNAM,29,SDAT,30,ME)
03773		GOTO 4158
03774	4152    CALL DBERR($4153,IERT,IERC,0)
03775		GOTO 4154
03776	4153    IF (IERT.NE.7) GOTO 4955
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-68


03777		TYPE 1379
03778		CALL WAIT (7.0)
03779	4154    CALL DBOPEN(BAS10)
03780		CALL DBUPD(-1)
03781		CALL DBADD(3,VNET(K),4,NODE,13,1,17,WELL,23,1,6,HOST,7,CKT,
03782	     1  24,UNAM,20,ME,27,LIN1,28,UNAM,29,SDAT,30,ME,31,F1)
03783	4158    CALL DBCLOS
03784		CALL DBERR($4930,IERT,IERC,0)
03785		GOTO 59
03786	C
03787	C++++++++++++++++++++++++++++++++++++++++++++
03788	C
03789	C       ROTUINE TO CLOSED TICKETS THAT HAVE BEEN ON MONITOR
03790	C       FOR MORE THAN 24 HOURS.
03791	C
03792	C++++++++++++++++++++++++++++++++++++++++++++
03793	C
03794	4175    TYPE 4180
03795	4180    FORMAT(/1X,'ROTUINE TO CLOSED OUT TICKETS THAT HAVE ',
03796	     1  'ON MONITOR MORE THAN 24 HOURS.',/,/)
03797		CALL DBERR($4176,IERT,IERC,0)
03798		GOTO 4177
03799	4176    IF (IERT.NE.7) GOTO 4930
03800		TYPE 1379
03801		CALL WAIT(6.0)
03802	4177    CALL DBOPEN(BAS1,BAS2)
03803		CALL DBSET(2)
03804		CALL DBUPD(-1)
03805		CALL DBSET(1)
03806		CALL DBUPD(-1)
03807		CALL RTIM(TCLSD,CLSD)
03808		CALL DBFIND(5,'LT',CLSD,1,15,1,'MONIT')
03809		CALL DBNREC(NUMBER)
03810		IF (NUMBER.EQ.0) GOTO 4195
03811		DO 4190 I=1,NUMBER 
03812		CALL DBGREC($4195,I)
%FTNDIM LINE:03812 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
03813		CALL DBVAL(49,SDAT,50,TIM1,1,TNUM,'ESC',ESC)
03814		TYPE 4182,TNUM
03815	4182    FORMAT(2X,'TIC # ',I8,T21,$)
03816		ELM=0
03817		CALL MTTR(SDAT,CLSD,TIM1,TCLSD,ELM,HOUR)
03818		TYPE 4183,HOUR
03819	4183    FORMAT('+',F7.1,T28,$)
03820		IF (ELM.LT.1440) GOTO 4188
03821		CALL DBCHNG(15,'CLSD',26,CLSD,27,TCLSD)
03822		IF (ESC.EQ.2) CALL DBCHNG('ESC',3)
03823		TYPE 4184
03824	4184    FORMAT('+','CLOSED',3X,$)
03825		CALL DBSET(2)
03826		CALL DBFIND(1,1,TNUM)
03827		CALL DBNREC(ORDER)
03828		ORDER=ORDER+1
03829		ENCODE(320,4178,INFO)HOUR
03830	4178    FORMAT('TICKET CLOSED AFTER BEING ON MONITOR FOR ',F5.1,
03831	     1  ' HOURS.',27X,1H.,5X)
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-69


03832		CALL DBADD(1,TNUM,2,CLSD,3,TCLSD,4,ME,5,7,6,'CLSD',7,INFO,
03833	     1  8,UNAM,9,ORDER,10,0)
03834		TYPE 4179
03835	4179    FORMAT('+','STATUS ADDED')
03836		CALL DBSET(1)
03837		GOTO 4190
03838	4188    TYPE 4189
03839	4189    FORMAT('+','MONIT')
03840	4190    CONTINUE
03841		GOTO 4197
03842	4195    TYPE 4196
03843	4196    FORMAT(/3X,'THERE ARE NO TICKETS TO CLOSED BY THIS CRITERIA')
03844	4197    CALL DBCLOS
03845		CALL DBCLOS
03846		ENCODE(320,233,INFO)
03847		GOTO 59
03848	C
03849	C       CHECK FOR TICKETS OVER TO THE CUSTOMER
03850	C
03851	4200    CALL DBOPEN(BAS1)
03852		CALL DBFIND(51,1,'CUSTM',1,9,1,VNET(FLAG))
03853		CALL DBNREC(NUMBER)
03854		P=42
03855		IF (NUMBER.GT.0) GOTO 2597
03856		TYPE 4202,VNET(FLAG)
03857	4202    FORMAT(/1X,'THERE ARE NO TICKETS OVER TO THE CUSTOMER FOR ',
03858	     1  A10,1H.,/,/5X,'THANK YOU FOR CHECKING.')
03859		GOTO 4950
03860	C
03861	C***************************************
03862	C
03863	C       ROUTINE TO POST ARRIVED TIME
03864	C
03865	C***************************************
03866	4210    TYPE 4211
03867	4211    FORMAT(1X,'ROUTINE TO POST ARRIVAL AT THE SITE...',/)
03868		TYPE 170,TIC
03869	4212    ACCEPT 120,TNUM
03870		IF (TNUM.EQ.0) GOTO 59
03871		CALL GTIM(TIM1,SDAT,LIC)
03872		CALL DBERR($4215,IERT,IERC,0)
03873		GOTO 4217
03874	4215    IF (IERT.NE.7) GOTO 4955
03875		TYPE 1379
03876		CALL WAIT(7.0)
03877	4217    CALL DBOPEN(BAS6)
03878		CALL DBUPD(-1)
03879		CALL DBFIND(1,1,TNUM)
03880		CALL DBNREC(NUMBER)
03881		IF (NUMBER.EQ.0) GOTO 4225
03882		CALL DBGREC($4210,NUMBER)
03883		CALL DBVAL(8,MAINT,15,ADAT)
03884		IF ((MAINT.LT.ATTN(LO)).OR.(MAINT.GT.ATTN(HO1)))GOTO 4228
03885		IF (ADAT.GT.0) GOTO 8022
03886		CALL DBCHNG(15,SDAT,16,TIM1)
03887		CALL DBCLOS
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-70


03888		TYPE 4224
03889	4224    FORMAT(5X,'THANK YOU...')
03890		GOTO 59
03891	8022    CALL DBVAL(1,TNUM,2,TDAT,3,TTIM,4,NDAT,5,NTIM,6,RS,7,STAT,
03892	     1  8,MAINT,9,ELM,10,NET,11,SVER,12,PROB,13,COC,14,WHO,17,ZONE,
03893	     2  18,AELM)
03894		CALL DBADD(1,TNUM,2,TDAT,3,TTIM,4,NDAT,5,NTIM,6,RS,7,STAT,
03895	     1  8,MAINT,9,ELM,10,NET,11,SVER,12,PROB,13,COC,14,WHO,15,SDAT,
03896	     2  16,TIM1,17,ZONE,18,AELM)
03897		TYPE 4224
03898		GOTO 59
03899	4225    TYPE 4226
03900	4226    FORMAT(/3X,'THERE ARE NO RECORDS FOR TICKET # ',I8,/)
03901		TYPE 170,TIC
03902		GOTO 4212
03903	4228    TYPE 4229,MAINT
03904	4229    FORMAT(/3X,'YOU DO NOT HAVE ATHORIZATION TO POST ARRIVAL FOR ',
03905	     1  A5,1H.,/2X,'IF YOU FEEL THIS IS IN ERROR, PLEASE CALL A TYMNET',
03906	     2  /2X,'CONTROL GROUP',/2X,'THANK YOU...')
03907		CALL DBCLOS
03908		GOTO 59
03909	C
03910	C
03911	C       ROUTINE TO HANDLE THE CALBAK LOG ENTRIES
03912	C
03913	4235    TYPE 170,TIC
03914		CALL RTIM(TIM1,SDAT)
03915	4236    ACCEPT 120,TNUM
03916		IF (TNUM.EQ.0) GOTO 4950
03917	4238    CALL DBOPEN('(TNT)CALBAK')
03918		CALL DBFIND(1,1,TNUM)
03919		CALL DBNREC(NUMBER)
03920		IF (NUMBER.GT.0) GOTO 4240
03921		TYPE 4237,TNUM
03922	4237    FORMAT(1X,'TICKET NUMBER ',I8,' COULD NOT BE FOUND')
03923		TYPE 170,TIC
03924		GOTO 4236
03925	4240    CALL DBSRCH(9,1,0)
03926		CALL DBNREC(RECORD)
03927		IF (RECORD.GT.0) GOTO 4241
03928		TYPE 4243,TNUM
03929	4243    FORMAT(1X,'ALL CALL BACKS HAVE BEEN MADE FOR TICKET # ',I8)
03930		GOTO 4950
03931	4241    CALL DBFIND(1,1,TNUM)
03932		CALL DBNREC(NUMBER)
03933		TYPE 714
03934		DO 4248 I=1,NUMBER
03935		CALL DBGREC($4950,I)
%FTNDIM LINE:03935 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
03936		CALL DBVAL(4,RNAM,7,SITC,8,SITP,13,CHEX,9,K)
03937		IF (K.GT.0) GOTO 4248
03938		TYPE 4242,I,RNAM,SITC,SITP,CHEX
03939	4242    FORMAT(1X,I3,1X,4A5,T27,4A5,T52,4A5,2X,A1)
03940	4248    CONTINUE
03941	4247    TYPE 4249
03942	4249    FORMAT(/2X,'WHICH RECORD NUMBER PRECEEDS THE COMPANY CALLED',
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-71


03943	     1  ' BACK : ',$)
03944		ACCEPT 120,K
03945		IF ((K.GE.1).AND.(K.LE.NUMBER)) GOTO 4250
03946		IF (K.EQ.0) GOTO 4950
03947		GOTO 4247
03948	4250    TYPE 170,SC
03949		ACCEPT 100,REPF
03950		CALL DBERR($4252,IERT,IERC,0)
03951		GOTO 4253
03952	4252    IF (IERT.NE.7) GOTO 4930
03953		TYPE 1379
03954		CALL WAIT(5.0)
03955	4253    CALL DBOPEN('(TNT)CALBAK')
03956		CALL DBUPD(-1)
03957		CALL DBFIND(1,1,TNUM)
03958		CALL DBGREC($4950,K)
03959		CALL DBCHNG(9,SDAT,10,TIM1,11,ME,12,REPF,13,'*')
03960		CALL DBUPD(0)
03961		CALL STBKCL(TNUM,SITC,REPF,ME,TIM1,SDAT)
03962		TYPE 4255
03963	4255    FORMAT(1X,'ARE THERE MORE CALL BACKS TO MAKE (Y OR N) ? ',$)
03964		ACCEPT 65,SEE
03965		CALL HISET(SEE)
03966		IF (SEE.EQ.'Y') GOTO 4238
03967		GOTO 59
03968	C
03969	C
03970	C       ROUTINE TO LIST ALL ATTR'S FOR CALBAK LOG
03971	C
03972	4260    TYPE 170,TIC
03973		CALL DBOPEN('(TNT)CALBAK')
03974	4262    ACCEPT 120,TNUM
03975		IF (TNUM.EQ.0) GOTO 4950
03976		CALL DBFIND(1,1,TNUM)
03977		CALL DBNREC(NUMBER)
03978		IF (NUMBER.GT.0) GOTO 4265
03979		TYPE 4263,TNUM
03980	4263    FORMAT(3X,'CHECKING OLD DATA BASE FOR TICKET # ',I8)
03981		CALL DBOPEN('(TNT)OCALBK')
03982		CALL DBFIND(1,1,TNUM)
03983		CALL DBNREC(NUMBER)
03984		IF (NUMBER.GT.0) GOTO 4265
03985		TYPE 4264
03986	4264    FORMAT(1X,'NO CALL BACKS EXIST FOR TICKET # ; ',I8)
03987		GOTO 4950
03988	4265    TYPE 4267
03989	4267    FORMAT(1X,'COMPANY',T23,'PERSON',T44,'PHONE #',T66,'DATE',
03990	     1  9X,'SR',/6X,'NOTIFIED',T31,'REP.',T38,'DATE',/)
03991		RECORD=0
03992		DO 4270 I=1,NUMBER
03993		CALL DBGREC($4950,I)
%FTNDIM LINE:03993 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
03994		CALL DBVAL(2,SDAT,3,TIM1,4,RNAM,5,WHO,7,SITC,8,SITP,9,DUP,
03995	     1  10,TUP,11,CBY,12,CBAK)
03996		CALL DBNDAT(SDAT,SM,SD,SY)
03997		TYPE 4268,RNAM,SITC,SITP,SM,SD,TIM1,WHO
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-72


03998	4268    FORMAT(1X,4A5,1X,4A5,1X,4A5,1X,I2,1H/,I2,2X,A5,2X,A3)
03999		IF (DUP.EQ.0) GOTO 4266
04000		CALL DBNDAT(DUP,SM,SD,SY)
04001		TYPE 4269,CBAK,CBY,SM,SD,TUP
04002	4269    FORMAT(6X,4A5,4X,A3,4X,I2,1H/,I2,2X,A5)
04003		GOTO 4270
04004	4266    RECORD=RECORD+1
04005	4270    CONTINUE
04006		IF (RECORD.EQ.0) GOTO 4950
04007		TYPE 4272,RECORD,TNUM
04008	4272    FORMAT(/2X,I2,' CALL BACKS NEED TO BE MADE FOR TICKET # ',I8,
04009	     1  /2X,'DO YOU WISH TO CHECK OF ANY OF THE REMAINING CALL BACKS ',
04010	     2  '(Y OR N) ?',$)
04011		ACCEPT 65,SEE
04012		CALL HISET(SEE)
04013		IF (SEE.EQ.'Y') GOTO 4238
04014		GOTO 4950
04015	C
04016	C       ROUTINE TO SET TIME UP IN BASE1 ONLY
04017	C
04018	4275    TYPE 4277,BAS1
04019	4277    FORMAT(/1X,'SETTING TIME UP IN ',3A5)
04020		CALL DBERR($4280,IERT,IERC,0)
04021		GOTO 4281
04022	4280    IF (IERT.NE.7) GOTO 4930
04023		TYPE 1379
04024		CALL WAIT(7.0)
04025	4281    CALL DBOPEN(BAS1)
04026		CALL DBUPD(-1)
04027		CALL DBFIND(1,1,TNUM)
04028		CALL DBGREC($4955,1)
04029		call dbval(52,SVER)
04030		CALL DBCHNG(49,SDAT,50,TIM1,'ELM',0)
04031		CALL DBCLOS
04032		CALL DBERR($4950,IERT,IERC,0)
04033		IF (SVER.EQ.1) GOTO 4700
04034		GOTO 59
04035	C
04036	C****************************************
04037	C
04038	C       SPECIAL ROUTINE TO LIST TICKETS EVERY 15 MINUTES
04039	C       TO SEE WHICH SVER ONES AND TWOS WHICH NEED TO BE
04040	C       ESCALATED
04041	C
04042	C****************************************
04043	C
04044	4285    CALL DBOPEN(BAS1)
04045		CALL DBFIND(52,1,1)
04046		CALL DBSRCH(49,1,0)
04047		CALL DBNREC(NUMBER)
04048		IF (NUMBER.EQ.0) GOTO 4290
04049		DO 4288 I=1,NUMBER
04050		CALL DBGREC($4950,I)
%FTNDIM LINE:04050 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
04051		CALL DBVAL(5,SDAT,6,TIM1,49,DUP,50,TUP,1,TNUM,9,NET,14,PROD,
04052	     1  54,ELM,35,V6,'CNAM',CNAM,'HH',HH)
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-73


04053		CALL DBNDAT(SDAT,SM,SD,SY)
04054		CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
04055		HOUR=HOUR-V6
04056		IF (HOUR.GT.5.0) TYPE 4286,NET,TNUM,PROD,SM,SD,HOUR,CNAM,
04057	     1  NETOP(HH)
04058	4286    FORMAT(1X,2A5,1X,I6,1X,A5,1X,I2,1H/,I2,1X,F5.2,2X,3A5,2X,A5)
04059	4288    CONTINUE
04060		CALL WAIT(900.0)
04061		GOTO 4285
04062	4290    TYPE 4291
04063	4291    FORMAT(13X,'-1')
04064		GOTO 4288
04065	C
04066	C*********************************************
04067	C
04068	C       LIST TICKETS REFERED AND THEIR TIMES
04069	C
04070	C*********************************************
04071	C
04072	4300    I=1
04073	C       PRINT K HEADER QUESTION
04074		TYPE 2592
04075	4301    ACCEPT 120,P
04076		IF ((P.GE.1).AND.(P.LE.NATTN)) GOTO 4305
04077		IF ((P.EQ.0).OR.(I.EQ.3)) CALL HREFR
04078		IF (I.EQ.3) GOTO 59
04079		I=I+1
04080		GOTO 4301
04081	4305    CALL DBERR($4304,IERT,IERC,0)
04082		GOTO 4303
04083	4304    IF (IERT.NE.7) GOTO 4930
04084		TYPE 1379
04085		CALL WAIT(6.0)
04086	4303    CALL DBOPEN(BAS6,BAS6)
04087		CALL DBUPD(-1)
04088		CALL DBFIND('MAINT',1,ATTN(P),1,'RS',1,0)
04089		CALL DBNREC(NUMBER)
04090		IF (NUMBER.GT.0) GOTO 4310
04091	C       NO TICKETS OVER TO THIS GROUP OUTPUT SAME AND GOTO MAIN
04092	C       PROMPT
04093		TYPE 2596,ATTN(P)
04094		GOTO 4950
04095	4310    TYPE 774,NUMBER,ATTN(P)
04096	774     FORMAT(/3X,'THERE ARE ',I3,' TICKETS OVER TO ',A5,/,/)
04097		TYPE 4302
04098	4302    FORMAT(/2X,'TNUM'2X,'PROD.',1X,'S',1X,'STAT',2X,'DATE/TIME',
04099	     1  6X,'ARIVE TIME',T52,'POSS.',/)
04100		DO 4320 I=1,NUMBER
04101		CALL DBGREC($4930,I)
%FTNDIM LINE:04101 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
04102		CALL DBVAL(1,TNUM,2,SDAT,3,TIM1,4,DUP,5,TUP,7,STAT,9,ELM,11,
04103	     1  SVER,12,PROD,15,ADAT,16,ATIM)
04104		CALL DBSET(2)
04105		CALL DBFIND(1,1,TNUM,1,'RS',1,1)
04106		CALL DBNREC(RECORD)
04107		IF (RECORD.GT.0) GOTO 4319
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-74


04108		CALL DBNDAT(SDAT,SM,SD,SY)
04109		CALL DBSET(1)
04110		IF (UNAM(1).EQ.'TECHS') CALL DBCHNG(6,1)
04111		IF (ADAT.GT.0) GOTO 4312
04112		EM=0
04113		ED=0
04114		GOTO 4314
04115	4312    CALL DBNDAT(ADAT,EM,ED,EY)
04116	4314    CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
04117		IF (ATIM.EQ.0) ATIM='.....'
04118		TYPE 4315,TNUM,PROD,SVER,STAT,SM,SD,TIM1,EM,ED,ATIM,HOUR
04119	4315    FORMAT(1X,I6,1X,A5,1X,I1,1X,A5,1X,I2,1H-,I2,2H @,A5,2HZ ,
04120	     1  I2,1H-,I2,2H @,A5,2HZ ,T52,F6.1)
04121		GOTO 4320
04122	4319    CALL DBSET(1)
04123	4320    CONTINUE
04124		GOTO 4950
04125	4330    CALL GETDES(HQCC,ONUM)
04126		CALL DBERR($4331,IERT,IERC,0)
04127		GOTO 4332
04128	4331    IF (IERT.NE.7) GOTO 4930
04129		TYPE 1379
04130		CALL WAIT(6.0)
04131	4332    CALL DBOPEN(BAS1)
04132		CALL DBUPD(-1)
04133		CALL DBFIND(1,1,TNUM)
04134		CALL DBCHNG(18,HQCC,46,3,19,ONUM)
04135		CALL DBCLOS
04136		CALL DBERR($4930,IERT,IERC,0)
04137		GOTO 235
04138	C
04139	C       CHECK TO SEE IF A PERIOD IS THE FIRST AND ONLY OF THE FIRST
04140	C       FIVE CHARACTERS ON A LINE  IF SO END THE INPUT, ELSE GOTO 219
04141	C       AND ACCEPT MORE LINES OF STATUS
04142	C
04143	
04144	4335    CALL GTIM(TIM1,SDAT,LIC)
04145		LONG=1
04146		RS=0
04147	4337    TYPE 220,ST
04148		NLINE=0
04149		DO 4338 ILIN=1,4
04150		N=(ILIN*16)-15
04151		ACCEPT 225,(INFO(J),J=N,N+15)
04152		IF (INFO(N).EQ.'.    ') GOTO 4339
04153		NLINE=ILIN
04154	4338    CONTINUE
04155	4339    CALL CSTAT(INFO,TRASH,Z,TNUM)
04156		IF (TRASH.NE.' ') GOTO 4337
04157		IF ((INFO(N).EQ.'.    ').AND.(NLINE.EQ.0)) GOTO 4343
04158	4340    CALL DBERR($4341,IERT,IERC,0)
04159		GOTO 4342
04160	4341    IF (IERT.NE.7) GOTO 4930
04161		TYPE 1379
04162		CALL WAIT(6.0)
04163	4342    CALL DBOPEN(BAS2)
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-75


04164		CALL DBUPD(-1)
04165		CALL DBFIND(1,1,TNUM)
04166		CALL DBNREC(ORDER)
04167		ORDER=ORDER+1
04168		CALL DBADD(1,TNUM,2,SDAT,3,TIM1,4,ME,5,RS,6,STAT,7,INFO,
04169	     1  8,UNAM,9,ORDER)
04170		CALL DBCLOS
04171		CALL DBERR($4930,IERT,IERC,0)
04172		N=(NLINE*16)-15
04173	4336    FORMAT(/3X,'DATA = "',A5,1H",4X,'NLIE=',I2,3X,'N=',I3,/)
04174		IF (INFO(N).EQ.'.    ') GOTO 4343
04175		ENCODE(320,233,INFO)
04176		GOTO 4337
04177	4343    ENCODE(320,233,INFO)
04178		IF (LOATTN.EQ.0) GOTO 59
04179		GOTO 235
04180	C
04181	C       ROUTINE TO ADD A RECORD THAT THE TICKET WAS TRANSFERED
04182	C
04183	4345    TYPE 170,TIC
04184		CALL DBOPEN(BAS1)
04185		ACCEPT 120,TNUM
04186		IF (TNUM.EQ.0) GOTO 59
04187		CALL RTIM(TIM1,SDAT)
04188		N=1
04189	C
04190	C       GOTO CHANGE MAINT ROUTINE AND THEN COME BACK HERE
04191	C
04192		GOTO 2378
04193	4350    CALL GETC(6,UNAM,PCE)
04194		IF (PCE.EQ."040) GOTO 4351
04195		CALL GETC(11,UNAM,PCE)
04196		IF (PCE.EQ."040) GOTO 4354
04197		ENCODE(170,4355,INFO)UNAM,ME,MAINT,ATTN(M),CCC,CODE(CCC)
04198	4355    FORMAT(3A5,1H(,A3,1H),' TRANSFERRED THIS TICKET FROM ',A5,
04199	     1  ' TO ',A5,1H.,15X,'RESOLUTION CODE IS CURRENTLY SET TO ',
04200	     2  I3,2X,A10,29X,'.',5X)
04201	4352    FORMAT(1X,'ADDING A STATUS THAT THIS TICKET WAS TRANSFERRED',
04202	     1  ' FROM ',A5,' TO ',A5,1H.,$)
04203		GOTO 4358
04204	4351    ENCODE(170,4353,INFO)UNAM(1),ME,MAINT,ATTN(M),CCC,CODE(CCC)
04205	4353    FORMAT(A5,1H(,A3,1H),' TRANSFERRED THIS TICKET FROM ',A5,
04206	     1  ' TO ',A5,1H.,25X,'RESOLUTION CODE IS CURRENTLY SET TO ',
04207	     2  I3,2X,A10,29X,'.',5X)
04208		GOTO 4358
04209	4354    ENCODE(170,4360,INFO)UNAM(1),UNAM(2),ME,MAINT,ATTN(M),
04210	     1  CCC,CODE(CCC)
04211	4360    FORMAT(A5,A5,1H(,A3,1H),' TRANSFERRED THIS TICKET FROM ',A5,
04212	     1  ' TO ',A5,1H.,20X,'RESOLUTION CODE IS CURRENTLY SET TO ',
04213	     2  I3,2X,A10,29X,'.',5X)
04214	4358    TYPE 4352,MAINT,ATTN(M)
04215		CALL DBERR($4356,IERT,IERC,0)
04216		GOTO 4357
04217	4356    IF (IERT.NE.7) GOTO 4930
04218		TYPE 1379
04219		CALL WAIT(6.0)
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-76


04220	4357    CALL DBOPEN(BAS2)
04221		CALL DBUPD(-1)
04222		CALL DBFIND(1,1,TNUM)
04223		CALL DBNREC(NUMBER)
04224		ORDER=NUMBER+1
04225		CALL DBADD(1,TNUM,2,SDAT,3,TIM1,4,ME,5,5,6,STAT,7,INFO,8,UNAM,
04226	     1  9,ORDER,10,0)
04227		CALL DBCLOS
04228		ENCODE(95,933,INFO)
04229		GOTO 59
04230	C
04231	C       RESET TNUM BACK TO ORIGINAL VALUE
04232	C
04233	4365    TNUM=NUM1
04234		DUP=TDAT
04235		ELM=TET
04236		TUP=TIM2
04237		GOTO 222
04238	C
04239	C
04240	C       ROUTINE TO FIND A TICKET NUMBER WHERE EVER IT IS, THEN
04241	C       REPORT BACK THAT IT WAS FOUND
04242	C
04243	C
04244	4370    TYPE 4375
04245	4375    FORMAT(1X,'ROUTINE TO FIND A TICKET NUMBER IN ALL THE DATA',
04246	     1  ' BASES',/)
04247		TYPE 170,TIC
04248		CALL DBOPEN(BAS1)
04249		ACCEPT 120,TNUM
04250		TYPE 4377,BAS1
04251	4377    FORMAT(1X,'SEARCHING ',3A5,T40,$)
04252		CALL DBFIND(1,1,TNUM)
04253		CALL DBNREC(NUMBER)
04254		TYPE 4379,NUMBER
04255	4379    FORMAT('+',I3,' RECORDS FOUND')
04256		TYPE 4377,BAS2
04257		CALL DBOPEN(BAS2)
04258		CALL DBFIND(1,1,TNUM)
04259		CALL DBNREC(NUMBER)
04260		TYPE 4379,NUMBER
04261		TYPE 4377,BAS6
04262		CALL DBOPEN(BAS6)
04263		CALL DBFIND(1,1,TNUM)
04264		CALL DBNREC(NUMBER)
04265		TYPE 4379,NUMBER
04266		TYPE 4377,BAS8
04267		CALL DBOPEN(BAS8)
04268		CALL DBFIND(1,1,TNUM)
04269		CALL DBNREC(NUMBER)
04270		TYPE 4379,NUMBER
04271		TYPE 4377,BAS4
04272		CALL DBOPEN(BAS4)
04273		CALL DBFIND(1,1,TNUM)
04274		CALL DBNREC(NUMBER)
04275		TYPE 4379,NUMBER
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-77


04276		TYPE 4377,BAS5
04277		CALL DBOPEN(BAS5)
04278		CALL DBFIND(1,1,TNUM)
04279		CALL DBNREC(NUMBER)
04280		TYPE 4379,NUMBER
04281		TYPE 4377,BAS7
04282		CALL DBOPEN(BAS7)
04283		CALL DBFIND(1,1,TNUM)
04284		CALL DBNREC(NUMBER)
04285		TYPE 4379,NUMBER
04286		TYPE 4377,BAS9
04287		CALL DBOPEN(BAS9)
04288		CALL DBFIND(1,1,TNUM)
04289		CALL DBNREC(NUMBER)
04290		TYPE 4379,NUMBER
04291		H2=TNUM/10000
04292		IF (H2.GT.9) GOTO 4381
04293		ENCODE(15,661,BAS11)H2
04294		ENCODE(15,662,BAS12)H2
04295		ENCODE(15,663,BAS19)H2
04296		GOTO 4383
04297	4381    ENCODE(15,301,BAS11)H2
04298		ENCODE(15,302,BAS12)H2
04299		ENCODE(15,303,BAS19)H2
04300	4383    TYPE 4377,BAS11
04301		CALL DBOPEN(BAS11)
04302		CALL DBFIND(1,1,TNUM)
04303		CALL DBNREC(NUMBER)
04304		TYPE 4379,NUMBER
04305		TYPE 4377,BAS12
04306		CALL DBOPEN(BAS12)
04307		CALL DBFIND(1,1,TNUM)
04308		CALL DBNREC(NUMBER)
04309		TYPE 4379,NUMBER
04310		TYPE 4377,BAS19
04311		CALL DBOPEN(BAS19)
04312		CALL DBFIND(1,1,TNUM)
04313		CALL DBNREC(NUMBER)
04314		TYPE 4379,NUMBER
04315		TYPE 4385,TNUM
04316	4385    FORMAT(/3X,'SEARCH FOR TICKET NUMBER ',I8,' COMPLETE',/)
04317		GOTO 4950
04318	C
04319	C*************************************************
04320	C
04321	C       ROUTINE TO LIST A TICKET NUMBER AND THE STATUSES
04322	C       FOR A TIME PERIOD
04323	C
04324	C*************************************************
04325	C
04326	4395    TYPE 4397
04327	4397    FORMAT(2X,'ENTER THE DATE TO LIST STATUSES FROM (MM/DD/YYYY)',
04328	     1  ' : ',$)
04329	84397        CALL DBSYSV(1,0,SDAT)
04330		ACCEPT 1160,IM,ID,IY
04331		IF (IM.NE.0) CALL DBDATN(NDATE,IM,ID,IY)
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-78


04332		IF (IM.EQ.0) NDATE=SDAT-1
04333		TYPE 4396
04334	4396    FORMAT('+',2X,'OUTPUT TO FILE OR TERMINAL (TERM) : ',$)
04335		ACCEPT 65,ANS
04336		CALL HISET(ANS)
04337		IF (ANS.EQ.'     ') GOTO 4401
04338		IF ((ANS.GE.'F').AND.(ANS.LE.'FILE')) GOTO 4398
04339		GOTO 84397
04340	C	^^^^^^^^^^ used to say 'GOTO 4397' a format statement.
04341	
04342	4398    ENCODE(15,4400,FILE)NDATE
04343		TYPE 4406,FILE
04344	4406    FORMAT(' ENTER FILE NAME (15 CHAR. MAX) (',3A5,') : ',$)
04345		ACCEPT 4403,FILE
04346	4403    FORMAT(3A5)
04347		IF (FILE(1).EQ.'     ') ENCODE(15,4400,FILE)NDATE
04348	4400    FORMAT(I5,'.OUT',6X)
04349		OPEN(unit=8,device='DSK',access='SEQOUT',file=FILE)
04350	4401    DO 4420 I=1,NUMBER
04351		CALL DBGREC($4405,I)
%FTNDIM LINE:04351 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
04352		CALL DBVAL(1,TNUM)
04353		IF(ANS.NE.'     ')WRITE(8,4404)FF,TNUM
04354		IF (ANS.EQ.'     ')TYPE 4404,FF,TNUM
04355	4404    FORMAT(/,A5,/,/,3X,'TICKET NUMBER : ',I6)
04356		CALL DBSET(2)
04357		CALL DBFIND(1,1,TNUM)
04358		CALL DBSRCH(2,'GE',NDATE)
04359		CALL DBNREC(RECORD)
04360		IF (RECORD.GT.0) GOTO 4405
04361		IF(ANS.NE.'     ')WRITE (8,4402)IM,ID,IY,TNUM
04362		IF (ANS.EQ.'     ')TYPE 4402,IM,ID,IY,TNUM
04363	4402    FORMAT(///,T9,'NO STATUSES ENTERED ON OR AFTER ',I2,1H/,I2,
04364	     1  1H/,I4,' FOR TICKET NUMBER ',I6)
04365		CALL DBSET(1)
04366		GOTO 4420
04367	4405    DO 4416 J=1,RECORD
04368		CALL DBGREC($4416,J)
%FTNDIM LINE:04368 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
04369		CALL DBVAL(1,TNUM,2,SDAT,3,TIM1,4,INT,5,RS,7,INFO,8,PNAM,
04370	     1  9,ORDER)
04371		CALL DBNDAT(SDAT,SM,SD,SY)
04372		SY=SY-1900
04373		IF(ANS.NE.'     ')WRITE(8,380)ORDER,PNAM,INT,SD,AM(SM),
04374	     1  SY,TIM1,AS(RS)
04375		IF (ANS.EQ.'     ')TYPE 380,ORDER,PNAM,INT,SD,AM(SM),SY,TIM1,
04376	     1  AS(RS)
04377		IF (ANS.NE.'     ') GOTO 4415
04378	4413    DO 4414 ILIN=1,4
04379		N=(ILIN*16)-15
04380		IF (INFO(N).EQ.'.    ') GOTO 4416
04381		TYPE 701,(INFO(X),X=N,N+15)
04382	4414    CONTINUE
04383	4415    CALL WINFO(INFO)
04384	4416    CONTINUE
04385		CALL DBSET(1)
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-79


04386	4420    CONTINUE
04387		CLOSE(unit=8)
04388		TYPE 3651,FILE
04389		GOTO 4950
04390	C***************************************
04391	C
04392	C       ROUTINE TO LIST NEW STATUSES EVERY 10 MINUTES. THAT WAY WE CAN
04393	C       STAY ON TOP OF WHAT IS BEING WORKED ON.
04394	C
04395	C***************************************
04396	4490    TYPE 4495
04397	4495    FORMAT(/5X,'LISTER OF NEW STATUSES ADDED EVERY FIVE MINUTES',/)
04398		BB=0
04399		CALL DBOPEN('(TNT)BASE2')
04400		CALL DBFIND('ALL')
04401		CALL DBNREC(BB)
04402		CALL WAIT(60.0)
04403	4500    CALL DBOPEN('(TNT)BASE2')
04404		CALL DBFIND('ALL')
04405		CALL DBNREC(NUMBER)
04406		IF (NUMBER.GT.BB) GOTO 4505
04407		IF (NUMBER.LT.BB) BB=NUMBER
04408		TYPE 4502,YY(2)
04409	4502    FORMAT('+',A1,$)
04410		CALL WAIT(300.0)
04411		GOTO 4500
04412	4505    DO 4520 I=BB+1,NUMBER
04413		CALL DBGREC($4950,I)
%FTNDIM LINE:04413 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
04414		CALL DBVAL(1,TNUM,2,SDAT,3,TIM1,4,INT,5,RS,6,STAT,7,INFO,8,
04415	     1  PNAM,9,ORDER)
04416		CALL DBNDAT(SDAT,IM,ID,IY)
04417		IY=IY-1900
04418		TYPE 700,ORDER,PNAM,INT,ID,AM(IM),IY,TIM1,AS(RS),TNUM
04419		DO 4515 ILIN=1,4
04420		N=(ILIN*16)-15
04421		IF (INFO(N).EQ.'.    ') GOTO 4516
04422		TYPE 701,(INFO(J),J=N,N+15)
04423	4515    CONTINUE
04424	4516	CALL WAIT(3.0)
04425	4520    CONTINUE
04426		TYPE 3239
04427		TYPE 4502,YY(2)
04428		BB=NUMBER
04429		CALL WAIT(300.0)
04430		GOTO 4500
04431	C
04432	C       ROUTINE TO LIST TICKETS IN A MODIFIED FORMAT
04433	C
04434	4595    TYPE 4597
04435	4597    FORMAT(/1X,'ROUTINE TO LIST THE TICKETS IN A CUSTOMER FORMAT')
04436		I=1
04437		TYPE 2592
04438		CALL DBOPEN(BAS1,BAS2)
04439	4888    ACCEPT 120,P
04440		IF ((P.GE.1).AND.(P.LE.NATTN)) GOTO 4900
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-80


04441		IF ((P.EQ.0).OR.(I.EQ.3)) CALL HREFR
04442		IF (I.EQ.3) TYPE 2592
04443		I=I+1
04444		TYPE 2592
04445		GOTO 4888
04446	4900    CALL DBFIND('MAINT',1,ATTN(P),1,15,'NE','CLSD')
04447		CALL DBNREC(NUMBER)
04448		IF (NUMBER.GT.0) GOTO 4910
04449		TYPE 2596,ATTN(P)
04450		GOTO 4950
04451	4910    TYPE 4912,NUMBER,ATTN(P)
04452	4912    FORMAT(/3X,'THERE ARE ',I3,' TICKETS OVER TO ',A5,1H.,//1X,
04453	     1  2X,'TIC# DATE  SVER PROD   NODE  HOST COMM. SP.',7X,
04454	     2  'CUSTOMER'8X,'CON.GRP.ODUE',/)
04455		DVER(1)=120
04456		DVER(2)=240
04457		DVER(3)=720
04458		DVER(4)=1440
04459		DO 4920 I=1,NUMBER
04460		CALL DBGREC($4950,I)
%FTNDIM LINE:04460 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
04461		DUP=0
04462		TUP=0
04463		ELM=0.0
04464		CALL DBVAL(1,TNUM,'SDAT',SDAT,'SVER',SVER,'PROD',PROD,'NODE',
04465	     1  NODE,'HOST',HOST,'TECH',TECH,'CNAM',CNAM,'HN',HN,'TIME',TIM1)
04466		CALL DBNDAT(SDAT,IM,ID,IY)
04467		CALL DBSET(2)
04468		CALL DBFIND(1,1,TNUM)
04469		CALL DBNREC(RECORD)
04470		IF (RECORD.EQ.0) GOTO 4914
04471		CALL DBGREC($4914,RECORD)
04472		CALL DBVAL(2,SDAT,3,TIM1,'UNAM',PNAM)
04473		IF ((PNAM(1).EQ.'NETCO').OR.(PNAM(1).EQ.'NSSC').OR.
04474	     1  (PNAM(1).EQ.'NCF').OR.(PNAM(1).EQ.'CSS80')) GOTO 4913
04475		GOTO 4914
04476	4913    IF (RECORD-1.LT.1) GOTO 4914
04477		CALL DBGREC($4920,RECORD-1)
04478		CALL DBVAL(2,SDAT,3,TIM1)
04479	4914    CALL MTTR(SDAT,DUP,TIM1,TUP,ELM,HOUR)
04480		HOUR=(ELM-DVER(SVER))/60.0
04481		TYPE 4915,TNUM,IM,ID,SVER,PROD,NODE,HOST,TECH,CNAM,NETOP(HN),
04482	     1  HOUR
04483	4915    FORMAT(1X,I6,1X,I2,1H/,I2,3X,I1,2X,A5,1X,I5,1X,I5,1X,3A5,1X,
04484	     1  3A5,1X,A5,1X,F6.1)
04485		CALL DBSET(1)
04486	4920    CONTINUE
04487		GOTO 4950
04488	C
04489	C***********************************************
04490	C
04491	C       AUTO UPDATE ROUTINE FOR SEV 1
04492	C       TICKETS.
04493	C
04494	C***********************************************
04495	4601    GOTO 4600
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-81


04496	4602    TYPE 4603
04497	4603    FORMAT(/1X,'WAITING 15 MINUTES')
04498		CALL WAIT(900.0)
04499		GOTO 4601
04500	C
04501	c********************************************
04502	c
04503	c       routine to print ticket info for those
04504	c       tickets which the customer needs an update
04505	c       within 2 hours.
04506	c
04507	c********************************************
04508	4600            type 4605
04509	4605    FORMAT(/1X,'OPENING DATA BASE TO GET TICKETS ',
04510	     1  'WHICH NEED A STATUS CALL BACK',/)
04511		        call dbopen('(tnt)statbk','(tnt)base2')
04512		        call dbset(1)
04513		        call fgmt(ia1,ia2,ia3,ia4,ia5,ia6)
04514		IA3=IA3+1900
04515		IF (IA5.LE.9) ENCODE(5,4609,TIM1)IA4,IA5
04516		        encode(5,4613,tim1)ia4,ia5
04517	4609            FORMAT(I2,':0',I1)
04518	4613            format(i2,':'i2)
04519		        call dbdatn(sdat,ia1,ia2,ia3)
04520		CALL DBFIND(12,1,0,1,5,3,SDAT,1,7,1,CG)
04521		CALL DBNREC(NUMBER)
04522		IF (NUMBER.LT.1) GOTO 94615
04523		DO 94610 I=1,NUMBER
04524		CALL DBGREC($94610,I)
%FTNDIM LINE:04524 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
04525		CALL DBCHNG(5,SDAT,4,' 0:00')
04526	94610   CONTINUE
04527	94615   CALL DBFIND(12,1,0,1,4,'LE',TIM1,1,5,1,SDAT,1,7,1,CG)
04528		        call dbnrec(number)
04529		        if (number.gt.0) goto 4615
04530		        type 4610
04531	4610    format(/3x,'no tickets to status',/)
04532		IF (ANS.EQ.'CBACK') GOTO 4602
04533		        goto 4945
04534	4615            type 4612,number
04535	4612            format(/2x,'there are ',i2,' call backs to place')
04536		        call dbsort(5,4,'ascen')
04537		        type 4614
04538	4614            format(/1x,'tnum',3x,'company',10x,'contact',15x,
04539	     1  'phone #',11x,'time to call')
04540		        tnum=0
04541		M=0
04542		TOT1=0
04543		        do 4625 i=1,number
04544		M=M+1
04545		        call dbgrec($4625,i)
%FTNDIM LINE:04545 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
04546		        call dbval(1,cnam,2,tnum,3,sitp,4,tim1,5,sdat,15,SITC)
04547		        type 4620,tnum,cnam,sitc,sitp,tim1
04548	4620            format(1X,I6,1X,3A5,2X,4A5,2X,4A5,2X,A5)
04549		        tot1=tnum
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-82


04550		        call dbgrec($4616,i+1)
04551		        call dbval(2,tnum)
04552		        if (tnum.eq.tot1) goto 4625
04553	4616            call dbset(2)
04554		        call dbfind(1,1,TOT1)
04555		        call dbnrec(record)
04556		        if (record.gt.0) goto 4622
04557		        type 4621,TOT1,ff
04558	4621            format(2x,'***  no status entries for ticket ',
04559	     1  'number ',i6,/,a5)
04560		        call dbset(1)
04561		        goto 4625
04562	4622            x=1
04563		        if (record.gt.4) x=record-3
04564		        do 4624 p=x,record
04565		        call dbgrec($4624,p)
%FTNDIM LINE:04565 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
04566		        call dbval(2,sdat,3,tim1,4,int,5,rs,6,stat,7,
04567	     1  info,8,pnam,9,order)
04568		        call dbndat(sdat,im,id,iy)
04569		        iy=iy-1900
04570		        type 700,order,pnam,int,id,am(im),iy,tim1,as(rs),
04571	     1  tot1
04572		        do 4630 ilin=1,4
04573		        n=(ilin*16)-15
04574		        if (info(n).eq.'.    ') goto 4624
04575		        type 701,(info(j),j=n,n+15)
04576	4630            continue
04577	4624            continue
04578		        call dbset(1)
04579		        type 2084,ff
04580		TYPE 4614
04581	C       IF (M.LT.NUMBER) TYPE 4614
04582	4625            continue
04583		IF (ANS.EQ.'CBACK') GOTO 4602
04584		        goto 4945
04585	c********************************************
04586	c
04587	c       routine to list all call entries
04588	c
04589	c********************************************
04590	c
04591	4635            type 4636
04592	4636            format(/1x,'list all status call back entries')
04593		        call dbopen('(tnt)statbk')
04594		        call dbfind(12,1,0)
04595		        call dbnrec(number)
04596		        if (number.gt.0) goto 4638
04597		        type 4637
04598	4637            format(1x,'*** no entries found ***')
04599		        call DBCLOS
04600		        goto 59
04601	4638            type 4639,number
04602	4639            format(5x,i3,' entries found...'//1x,'customer ',
04603	     1  'name',4x,'tnum'4x,'date and time to place call')
04604		        call dbsort(5,4,1,'ascen')
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-83


04605		        do 4643 i=1,number
04606		        call dbgrec($4643,i)
%FTNDIM LINE:04606 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
04607		        call dbval(1,cnam,2,tnum,4,tim1,5,sdat)
04608		        call dbndat(sdat,im,id,iy)
04609		        type 4640,cnam,tnum,am(im),id,tim1
04610	4640    FORMAT(1X,3A5,2X,I6,2X,A3,'-',I2,2X,A5,'Z')
04611	4643            continue
04612		        call DBCLOS
04613		        goto 59
04614	c
04615	c****************************************************
04616	c
04617	c       routine to mark which record was updated for the call
04618	c       status update
04619	c
04620	c****************************************************
04621	c
04622	4675            type 4676
04623	4676            format(1x,'command to mark which people were ',
04624	     1  'called with a status update',/)
04625		        type 170,tic
04626		        accept 120,tnum
04627		        if (tnum.eq.0) goto 59
04628		        CALL DBOPEN('(TNT)STATBK')
04629		        call dbfind(2,1,tnum,1,12,1,0)
04630		        call dbnrec(number)
04631		        if (number.gt.0) goto 4679
04632		        type 4678,tnum
04633	4678            format(1x,'ticket ',i6,' does not have pending',
04634	     1  ' update calls...')
04635		        call DBCLOS
04636		        goto 59
04637	4680            format(1x,'did you call everyone already ? ',$)
04638	4679            CALL FGMT(IA1,IA2,IA3,IA4,IA5,IA6)
04639		IA3=IA3+1900
04640		ENCODE(5,4613,TIM1)IA4,IA5
04641		IF (IA5.LE.9) ENCODE(5,4609,TIM1)IA4,IA5
04642		        CALL DBDATN(SDAT,IA1,IA2,IA3)
04643		IF (ANS.EQ.'6U') GOTO 4685
04644		TYPE 4680
04645		        accept 65,SEE
04646		        call hiset(SEE)
04647		        if (SEE.ne.'Y') goto 4685
04648		        call dberr($4682,iert,ierc,0)
04649		        goto 4683
04650	4682            if (iert.ne.7) goto 4955
04651		        type 1379
04652		        call wait(5.0)
04653	4683            call dbupd(-1)
04654		        call dbfind(2,1,tnum,1,12,1,0)
04655		        call dbchng(9,tim1,10,sdat,11,me,12,2)
04656		        call dberr($4930,iert,ierc,0)
04657		        call DBCLOS
04658		        goto 59
04659	4685            type 4686,number
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-84


04660	4686            format(1x,'there are ',i3,' people to call...',
04661	     1  //2x,'selection ',2x,'customer'9x,'person'16x,
04662	     2  'number')
04663		        do 4690 i=1,number
04664		        call dbgrec($4690,i)
%FTNDIM LINE:04664 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
04665		        call dbval(1,cnam,15,sitc,3,sitp)
04666		        type 4687,i,cnam,sitc,sitp
04667	4687            format(5x,i2,5x,3a5,2x,4a5,2x,4a5)
04668	4690            continue
04669	4691            type 4692
04670	4692            format(/2x,'enter selection number : ',$)
04671	4693            accept 120,tot
04672		IF ((TOT.LT.0).OR.(TOT.GT.NUMBER)) GOTO 4691
04673		        if (tot.eq.0) goto 4950
04674	4695            type 4696
04675	4696            format(1x'who did you speak to ? ',$)
04676		        accept 100,repf
04677		        call dberr($4697,iert,ierc,0)
04678		        goto 4698
04679	4697            if (iert.ne.7) goto 4955
04680		        type 1379
04681		        call wait(5.0)
04682	4698            call dbupd(-1)
04683		        call dbgrec($4697,tot)
04684		        call dbchng(9,tim1,10,sdat,11,me,8,repf,
04685	     1  12,2)
04686		IF (ANS.EQ.'6C') GOTO 4681
04687		CALL DBVAL(1,CNAM,3,SITP,4,TIM1,5,SDAT,7,CG,15,SITC)
04688		CALL ATWO(TIM1,SDAT)
04689		CALL DBADD(1,CNAM,2,TNUM,3,SITP,4,TIM1,5,SDAT,6,0,7,CG,
04690	     1  12,0,15,SITC)
04691	4681            type 4699
04692	4699            format(1x'did you call anyone else ? ',$)
04693		        accept 65,SEE
04694		        call hiset(SEE)
04695		        if (SEE.NE.'Y') GOTO 94699
04696		CALL DBFIND(2,1,TNUM,1,12,1,0)
04697		CALL DBNREC(NUMBER)
04698		GOTO 4685
04699	94699           call dberr($4930,iert,ierc,0)
04700		CALL DBCLOS
04701		        goto 59
04702	c
04703	c****************************************************
04704	c
04705	c       routine to add call backs when we set time up
04706	c
04707	c****************************************************
04708	c
04709	4700            call dberr($4701,iert,ierc,0)
04710		        goto 4702
04711	4701            if (iert.ne.7) goto 4945
04712		        type 1379
04713		        call wait(5.0)
04714	4702            call dbopen('(tnt)statbk')
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-85


04715		        call dbupd(-1)
04716		        call dbfind(2,1,tnum,1,12,1,0)
04717		        call dbnrec(number)
04718		        if (number.eq.0) goto 4720
04719	94720   DO 4720 I=1,NUMBER
04720		CALL DBGREC($4720,I)
%FTNDIM LINE:04720 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
04721		        call dbchng(9,tim1,10,sdat,11,me,12,2)
04722	4720    CONTINUE
04723		CALL DBERR($4930,IERT,IERC,0)
04724		CALL DBCLOS
04725		        goto 59
04726	c
04727	C
04728	C********************************************
04729	C
04730	C       JUMP HERE TO PLACE CALL BACKS OR OPEN SVER TICKET
04731	C       CALL BACKS HERE
04732	C
04733	C********************************************
04734	C
04735	4710    TYPE 4713
04736	4713    FORMAT(/3X,'ADDING RECORD TO STATUS CALL BACK LIST FOR UP',
04737	     1  'DATE IN TWO HOURS...')
04738		CALL DBERR($4711,IERT,IERC,0)
04739		CALL FGMT(IA1,IA2,IA3,IA4,IA5,IA6)
04740		IA3=IA3+1900
04741		CALL DBDATN(SDAT,IA1,IA2,IA3)
04742		IF (IA4+2.GT.23) GOTO 4721
04743		IA4=IA4+2
04744		GOTO 4722
04745	4721    TOT=IA4+2
04746		TOT1=TOT/24
04747		SDAT=SDAT+TOT1
04748		IA4=TOT-(TOT1*24)
04749	4722    ENCODE(5,4613,TIM1)IA4,IA5
04750		IF (IA5.LE.9) ENCODE(5,4609,TIM1)IA4,IA5
04751		GOTO 4712
04752	4711    IF (IERT.NE.7) GOTO 4955
04753		TYPE 1379
04754		CALL WAIT(5.0)
04755	4712    CALL DBOPEN('(TNT)STATBK')
04756		CALL DBUPD(-1)
04757		IF (ANS.EQ.'A') CALL DBADD(1,CNAM,2,TNUM,3,REPF,4,TIM1,5,
04758	     1  SDAT,6,0,7,HN,12,0,15,REPN)
04759		IF (ANS.EQ.'A1') CALL DBADD(1,REPN,2,TNUM,3,SITP,4,TIM1,5,
04760	     1  SDAT,6,0,7,HN,12,0,15,SITC)
04761		HDRCHK=1
04762		CALL DBCLOS
04763		IF(ANS.EQ.'A') GOTO 650
04764		CALL DBERR($4930,IERT,IERC,0)
04765		GOTO 59
04766	C      ROUTINE TO CHANGE HARDWARE AND SOFTWARE REGION
04767	
04768	5000    IF (ANS.EQ.'G') TYPE 170,TIC
04769		CALL DBOPEN(BAS1)
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-86


04770		IF (ANS.EQ.'G') ACCEPT 120,TNUM
04771		IF (TNUM.EQ.0) GOTO 4950
04772		CALL DBFIND(1,1,TNUM)
04773		CALL DBNREC(NUMBER)
04774		IF (NUMBER.EQ.0) GOTO 2375
04775		CALL DBGREC($4800,NUMBER)
04776		CALL DBVAL(20,SRGN,21,HRGN,9,NET,40,NODE,42,HOST,43,CKT,
04777	     1  48,NT)
04778		IF (N.EQ.35) MAINT=SRGN
04779		IF (N.EQ.36) MAINT=HRGN
04780		I=1
04781	5001    TYPE 2390,MAINT
04782		TYPE 2391
04783		ACCEPT 120,M
04784		IF (M.EQ.0) GOTO 5007
04785		IF ((M.GT.0).AND.(M.LE.NATTN)) GOTO 5002
04786		IF ((M.EQ.-1).OR.(I.EQ.3)) CALL HREFR
04787		I=I+1
04788		GOTO 5001
04789	5002    CALL DBERR($5003,IERT,IERC,0)
04790		GOTO 5004
04791	5003    IF (IERT.NE.7) GOTO 4955
04792		TYPE 1379
04793		CALL WAIT(5.0)
04794	5004    CALL DBOPEN(BAS1)
04795		CALL DBUPD(-1)
04796		CALL DBFIND(1,1,TNUM)
04797		IF (N.EQ.35) CALL DBCHNG(20,ATTN(M))
04798		IF (N.EQ.36) CALL DBCHNG(21,ATTN(M))
04799		CALL DBCLOS
04800		CALL DBERR($5005,IERT,IERC,0)
04801		GOTO 5006
04802	5005    IF (IERT.NE.7) GOTO 4955
04803		CALL WAIT(5.0)
04804	5006    CALL DBOPEN(BAS10)
04805		IF (NT.EQ.1) CALL DBFIND(3,1,NET,1,4,1,NODE,1,17,1,'N')
04806		IF (NT.EQ.2) CALL DBFIND(3,1,NET,1,6,1,HOST,1,17,1,'H')
04807		IF (NT.EQ.3) CALL DBFIND(3,1,NET,1,7,1,CKT,1,17,1,'C')
04808		CALL DBNREC(NUMBER)
04809		IF (NUMBER.EQ.0) GOTO 5007
04810		IF (N.EQ.35) CALL DBCHNG(25,ATTN(M))
04811		IF (N.EQ.36) CALL DBCHNG(26,ATTN(M))
04812	5007    CALL DBCLOS
04813		GOTO 2381
04814	
04815	
04816	C       ROUTINE TO PRINT DETAIL OF ORIGINATING AND CURRENT
04817	C       CONTROL GROUP
04818	
04819	5100    Z=0
04820	5102    TYPE 5101,NETOP(CG),NETOP(CG)
04821	5101    FORMAT(/5X,'THIS ROUTINE WILL PRINT A LIST OF TICKETS FROM ',
04822	     1  'THE ACTIVE DATABASE',/5X,'THAT EITHER WERE ORIGINATED BY ',
04823	     2  'YOUR CONTROL GROUP AND ARE CURRENTLY',/5X,'CONTROLLED ',
04824	     3  'BY ANOTHER GROUP, OR THOSE THAT WERE ORIGINATED BY ANOTHER ',
04825	     4  /5X,'GROUP AND ARE CURRENTLY UNDER YOUR CONTROL.',/,/5X,
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-87


04826	     5  'DO YOU WISH TO SEE:',/10X,'1 = TICKETS ORIGINATED BY ',A5,' ',
04827	     6  'AND CONTROLLED BY OTHERS, OR',/10X,'2 = TICKETS ORIGINATED BY ',
04828	     7  'OTHERS AND CONTROLLED BY ',A5,/,/10X,'ENTER 1 OR 2: ')
04829		ACCEPT 120,P
04830		IF(P.EQ.0) GOTO 59
04831		Z=Z+1
04832		IF (Z.EQ.3) GOTO 59
04833		IF((P.LT.0).OR.(P.GT.2)) GOTO 5102
04834		IF(P.EQ.1) GOTO 5130
04835		CALL DBOPEN(BAS1)
04836		CALL DBFIND(4,1,CG,1,53,2,CG)
04837		CALL DBNREC(NUMBER)
04838		IF (NUMBER.EQ.0) GOTO 5110
04839		TYPE 5105
04840	5105    FORMAT(/1X,'TICKET   ORIGINATING               CURRENT   ',
04841	     3  'CURRENT',
04842	     1  /1X,'NUMBER   CONT. GROUP   INITIALS    CONT.GRP  REF.GRP',
04843	     2  '    STATUS',/1X)
04844		DO 5109 I=1,NUMBER
04845		CALL DBGREC($4930,I)
%FTNDIM LINE:04845 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
04846		CALL DBVAL(1,TNUM,4,F2,10,WHO,53,HN,51,MAINT,15,STAT)
04847		TYPE 5106,TNUM,NETOP(F2),WHO,NETOP(HN),MAINT,STAT
04848	5106    FORMAT(/1X,I6,6X,A5,8X,A3,8X,A5,4X,A5,6X,A5)
04849	5109    CONTINUE
04850		CALL DBCLOS
04851		GOTO 59
04852	5110    TYPE 5111,NETOP(CG)
04853	5111    FORMAT(/1X,'YOU ARE NOT CURRENTLY CONTROLLING ANY TICKETS ',
04854	     1  'THAT WERE ORIGINATED',/1X,'BY ANOTHER REGION.  USE THE O ',
04855	     2  'COMMAND TO SEE OPEN TICKETS FOR ',A5)
04856		GOTO 59
04857	5130    CALL DBOPEN(BAS1)
04858		CALL DBFIND(4,2,CG,1,53,1,CG)
04859		CALL DBNREC(NUMBER)
04860		IF(NUMBER.EQ.0) GOTO 5145
04861		TYPE 5105
04862		DO 5140 I=1,NUMBER
04863		CALL DBGREC($4930,I)
%FTNDIM LINE:04863 POSSIBLE DO INDEX MODIFICATION INSIDE LOOP
04864		CALL DBVAL(1,TNUM,4,F2,10,WHO,53,HN,51,MAINT,15,STAT)
04865		TYPE 5106,TNUM,NETOP(F2),WHO,NETOP(HN),MAINT,STAT
04866	5140    CONTINUE
04867		CALL DBCLOS
04868		GOTO 59
04869	5145    TYPE 5146,NETOP(CG),NETOP(CG)
04870	5146    FORMAT(/1X,'THERE ARE NO TICKETS ORIGINATED BY ',A5,' THAT ',
04871	     1  'ARE CURRENTLY CONTROLLED',/1X,'BY ANOTHER REGION.',/1X,
04872	     2  'USE THE O COMMAND TO SEE OPEN TICKETS FOR ',A5)
04873		GOTO 59
04874	6000    Z=7
04875		IF(WELL.EQ.'C')CALL GTW3(LNO,NOD1,Z)
04876		IF(WELL.EQ.'C')CALL GTW3(HNO,HST1,Z)
04877		CALL GTHRE(SC,SITC,Z)
04878		CALL GTHRE(SP,SITP,Z)
04879		CALL G1NE(SL,SLOT,Z)
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-88


04880		CALL GTWO(OCKT,CIRCKT,Z,2)
04881		CALL GTHRE(OTRB,TROUB1,Z)
04882		IF(WELL.NE.'C')CALL GTHR3(RP1,
04883	     1  TECH,Z,1)
04884		IF(WELL.EQ.'C')CALL GTHR3('ANALYSIS',
04885	     1  TECH,Z,1)
04886		CALL MPGRGN(1,P,Z,NATTN,SRGN)
04887		IF(P.GT.0)DECODE(5,65,ATTN(P))SRGN
04888		CALL MPGRGN(2,P,Z,NATTN,HRGN)
04889		IF(P.GT.0)DECODE(5,65,ATTN(P))HRGN
04890		IF (WELL.EQ.'H')CALL GONE(NO,NOD1,Z)
04891		CALL GONE(OKH,KHST,Z)
04892		CALL GONE(PTS,PORT,Z)
04893		CALL GTW1(OCV,COV,Z)
04894		CALL GTW1(OSTH,STH,Z)
04895		CALL GTW1(OEHR,EHR,Z)
04896		CALL MPGPRO(NTYPE,P,Z,PROD)
04897		IF(P.GT.0) DECODE(5,65,TYPE(P))PROD
04898		CALL GTWO(OLOC,LOC,Z,2)
04899		IF (WELL.NE.'C')CALL GTW1(OVER,VER,Z)
04900		IF (WELL.EQ.'C')CALL GTW1('HIKHST',VER,Z)
04901		Z=2
04902		GOTO 4016
04903	CCCCC
04904	4800    TYPE 4805
04905	4805    FORMAT(/10X,' ERROR IN DO LOOP ##1010 REPORT IT !!!',/)
04906	4810    TYPE 4815
04907	4815    FORMAT(/1X,'ERROR IN DO LOOP ##1130, REPORT IT !!!',/)
04908	4830    TYPE 4835
04909	4835    FORMAT(/1X,'ERROR IN DO LOOP ##2140, REPORT IT !!!',/)
04910	4840    TYPE 4845
04911	4845    FORMAT(/1X,' WE WENT FOR A VALUE THAT WAS NOT THERE CHECK ',
04912	     1  'STATEMENT 2080 ')
04913		GOTO 4950
04914	4850    TYPE 4855
04915		GOTO 59
04916	4930    CALL DBERR($4932,IERT,IERC,0)
04917		CALL DBNSET(NUMBER)
04918		IF (ME.EQ.0) GOTO 99999
04919		IF (NUMBER.EQ.0) GOTO 4931
04920		DO 4931 I=1,NUMBER
04921		CALL DBCLOS
04922	4931    CONTINUE
04923		IF (IERT.GT.0) TYPE 4957,IERT,IERC
04924	4957    FORMAT(/3X,'ERROR TYPE = ',I3,4X,'ERROR CODE = ',I3,/)
04925	C       TEMP COMMAND NEXT LINE
04926		CALL DBEND
04927		CALL DBSTRT(-1,1,-4,0,1,0,5,0,-1,0,-4,1,1,1,5,1)
04928		CALL RELEAS(1)
04929		CALL RELEAS(2)
04930		CALL RELEAS(3)
04931		CALL RELEAS(4)
04932		CALL RELEAS(-1)
04933		CALL RELEAS(5)
04934		CALL RELEAS(6)
04935		CALL RELEAS(7)
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-89


04936		CALL RELEAS(-4)
04937		CALL RELEAS(8)
04938		GOTO 59
04939	4932    IF ((IERT.NE.14).AND.(IERC.NE.11)) GOTO 4955
04940		GOTO 59
04941	4855    FORMAT(/1X,'ERROR IN DO LOOP FINDING VALUE OF ESCALATIONS',/)
04942	4940    CALL DBCLOS
04943	4945    CALL DBCLOS
04944	4950    CALL DBCLOS
04945		GOTO 59
04946	4955    TYPE 4956,IERT,IERC,CUST(SYS)
04947	4956    FORMAT(/3X,'ERROR TYPE = ',I5,4X,'ERROR CODE = ',I5,
04948	     1  /,/2X,'PLEASE REPORT THIS TO ',A5)
04949	99999   CALL DBEND
04950		IF ((DRP.GT.0).OR.(ME.EQ.0)) CALL BYE
04951		STOP
04952		END


SUBPROGRAMS CALLED

DBSRCH
DBSTRT	DBEND	HLP2	GTW1	STBKCL	DBSYSV
USERNA	GETC	RTIM	MTTR	DBUPD	DBNREC
HLP1	DBVAL	ONINT	DBGREC	RELEAS	DBNSET
PUTC	GPNUM	DBSET	GTHR3	DBDATN	DBNDAT
CH1I	DBCLOS	GZONE	CHTUP1	NPHONE	HREFR
GONE	HLPNET	MPGRGN	CHAEHR	DBADD	BYE
CSTAT	CDDWN	DRP1	GTWO	IPXCHG	ATWO
GRGN	DBSREC	FPRUPD	DBDEL	FGMT	GETDES
DBFIND	HPROD	RESCOD	HISET	MPGPRO	GETIM
VDIS	G1NE	TIME	CHHN1	WAIT	GTW3
HLPREP	DBERR	UPCASE	DBSORT	DEFCB	GDIS
GTHRE	CHASTH	CHSDT1	CHDUP1	DBOPEN	GTW2
GTIM	WINFO	CHTDWN	CHA4A5	DBCHNG	GPROD
WWHD	

SCALARS AND ARRAYS [ "*" NO EXPLICIT DEFINITION - "%" NOT REFERENCED ]

 .S0020	1	 T40	2	 RP1	3	 TDAT	6	 H2	7	
 HWARE	10	 TET	22	 IA2	23	 BAS1	24	*NDATE	27	
 HOUR	30	 VERS	31	 TROUB1	32	%TASKT		 HN	36	
 V3	37	 Z	40	 RW2	41	 EHR	44	 NDAT	45	
 HST1	46	 SD	47	 SRT	50	 PERCEN	51	 WHO	52	
 DRP	53	 TUP	54	 NET	55	*TRASH	57	 OPRO	60	
 REG	62	 WELL	63	 STATUS	64	 .S0037	75	 CNAM	76	
 HH	101	 BAS7	102	 ITEM	105	 LREFER	130	 .S0036	135	
 Q	136	 M3	137	 EY	140	 SOPEN	141	 .S0035	142	
 HNO	143	 JD	145	 IA6	146	 TTL	147	 .S0034	174	
%FSTREC		 FF	175	 NATTN	176	 RFON	177	 INFO	203	
 N	303	 .S0033	304	 PORT	305	 .S0032	306	 PROBL	307	
 OSTH	311	 HOST	313	 K	314	 .S0031	315	 INT	316	
 SEE	317	 H1	320	 DISC	321	 .S0030	572	 COMMNT	573	
 MAINT	577	 NCNAM	600	%RCOD		 HRGN	604	 TECH	605	
 OSVR	610	*RE	612	*NODE	613	*PROD	614	 V2	615	
 ST	616	 BB	621	 HEX	622	 YN	641	%NDUP		
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-90


 SC	645	%QOSGY		 LOC	650	%B		 FILE	654	
 EM	657	 SPEN	660	 TOT	754	 PT	755	 SWARE	760	
 REV	774	 DS1	775	 BAS6	776	 NOD1	1001	*BAS19	1002	
 RP2	1003	 YY	1006	 MYREG	1020	 .S0047	1021	 IA3	1022	
 M2	1023	%XCOC		 .S0046	1024	 LEV	1025	 LIC	1026	
 .S0045	1027	%CCOD		 OKH	1030	 IERT	1031	 COC	1032	
 .S0044	1034	 SITC	1035	 SY	1041	 .S0043	1042	 OTRB	1043	
 SDAT	1046	 FLAG	1047	 DT	1050	 .S0042	1051	 TYP	1052	
 STH	1053	 EVER	1054	 SITP	1060	 .S0041	1064	 HDRCHK	1065	
 .S0040	1066	 LONG	1067	 KHST	1070	%Y		 CARR	1071	
 V1	1072	 COMMT	1073	 NNET	1107	%NTUP		 JY	1111	
 BAS5	1112	*VCHG	1115	 BLK	1116	 SMONIT	1117	*AELM	1120	
%WK		 SRGN	1121	 PTS	1122	 CCC	1123	 TTIM	1124	
 P	1125	 SM	1126	*ID	1127	 H5	1130	 M1	1131	
 HREFER	1132	 DDAT	1137	 .S0057	1140	 M	1141	 NTYPE	1142	
 TOGO	1143	 ILIN	1144	 .S0056	1145	*ADAT	1146	%MOTO		
 LO	1147	%COR		 LOATTN	1150	 .S0055	1151	 V6	1152	
%TOT2		 STAT	1153	 SUB	1154	 NTIM	1205	 F3	1206	
 J	1213	*PROB	1214	 .S0054	1215	 RVNET	1216	 .S0053	1312	
 .S0007	1313	 CAT	1314	 REPRB	1317	 CRDNM	1425	 JM	1426	
 DUP	1427	 CBAK	1430	 SYS	1434	 .S0052	1435	 .S0006	1436	
 PRTNM	1437	 BILL	1440	 AS	1441	 .S0051	1445	*PCE	1446	
*TCLSD	1447	 .S0005	1450	 BAS4	1451	%D		 NUMCG	1454	
 .S0050	1455	 .S0004	1456	%SRGNT		 ONUM	1457	 IA4	1461	
 TIC	1462	 SVER	1465	 .S0003	1466	 .S0002	1467	 HO1	1470	
 REPN	1471	 BAS12	1475	 .S0001	1500	 AM	1501	 ITELC	1515	
 COV	1527	 CHEX	1530	 CSC	1531	 .S0000	1532	 TIM2	1533	
 SNAM	1534	 OCV	1537	 ANS	1541	 SL	1542	 H4	1543	
 OFF	1544	 VNET	1545	 PNAM	1735	 TOT1	1740	 .S0067	1741	
 NOUT	1742	 OCKT	1745	 .S0066	1747	 SNET	1750	 IPXNA	2044	
 PRO	2045	 V5	2046	%MNAM		 F2	2047	%ITEM2		
 OSVER	2050	 .S0106	2051	 .S0065	2052	 TRB	2053	 DVER	2057	
 NUM1	2063	 STOTAL	2064	 .S0105	2065	 .S0064	2066	 TELH	2067	
 .S0104	2155	 .S0063	2156	 .S0017	2157	 REGEN	2160	 X	2167	
 NUMBER	2170	 .S0103	2171	 .S0062	2172	 .S0016	2173	%TYPST		
 IA1	2174	 VALUE	2175	 RS	2201	 CIRCKT	2202	 TYPE	2206	
 .S0102	2347	 .S0061	2350	 .S0015	2351	*IY	2352	 CBY	2353	
 NLINE	2354	 .S0101	2355	 .S0060	2356	 .S0014	2357	 LNO	2360	
 CKT	2362	 RW1	2366	%M5		%ROW		 .S0100	2371	
 .S0013	2372	 OLOC	2373	 VER	2375	 NUD	2376	 TIM1	2377	
 .S0012	2400	 LIN1	2401	 OEHR	2421	 RECORD	2423	 BAS11	2424	
*O	2427	 .S0011	2430	%TASKP		 JJ1	2431	 XX	2432	
 BAS9	2433	 .S0010	2436	 NETOP	2437	 CDAT	2473	 CUST	2474	
 REPF	2476	 NO	2502	*SLOT	2503	 H3	2504	 COMMEN	2505	
 DF	2521	%COL		 L	2522	 TI	2523	*CLSD	2524	
 TVNET	2525	%BAS16		 ED	2621	 DECIS	2622	 .I0000	2623	
 ORDER	2624	 IA5	2625	 I	2626	 .S0077	2627	 V4	2630	
 F1	2631	 LIST	2632	 BAS2	2776	 ATTN	3001	 HO	3230	
 MONIT	3231	 TNUM	3325	 .S0076	3326	 TT	3327	%ITEM1		
 TOTAL	3330	 YMTOT	3424	 IM	3425	 .S0075	3426	 DSP	3427	
 ODUP	3430	 .S0074	3432	*ZONE	3433	 CHO	3434	%C		
 TUS	3435	 IERC	3436	 .S0073	3437	 .S0027	3440	 .S0072	3441	
 .S0026	3442	 ESC	3443	 ME	3444	 HIATTN	3445	 NUMNET	3446	
 NT	3447	 SP	3450	 .S0071	3453	 .S0025	3454	 HQCC	3455	
 OVER	3456	%M4		 .S0070	3460	 .S0024	3461	 ELM	3462	
 TELM	3463	 ATIM	3467	 BAS8	3470	 UNAM	3473	%REPFLG		
MAIN. 	PAPER.FOR	FORTRAN V.50A(530005) /KI	1-MAR-95	18:53	PAGE 1-91


 TODAY	3476	 .S0023	3477	 NPROB	3500	 .S0022	3501	 CODE	3502	
 ALREDY	4062	 BAS10	4063	 RNAM	4066	 .S0021	4072	 YORN	4073	
%QOS		 IVER	4074	 NEWVAL	4100	 CG	4104	

TEMPORARIES

 .Q0000	20474	 .Q0001	20475	 .Q0002	20476	
    K@H 