	SUBROUTINE GETCRD(X,D)
	IMPLICIT INTEGER(A-Z)
	DOUBLE PRECISION CARDS(45),URCARD(4),PLAYER(6)
	DIMENSION TRIAL(3),CASH(3),HOLDS(6,10),NHOLD(6)
	DIMENSION NATION(45),TERR(6,42),TROOPS(42),AMOUNT(6)
	COMMON /CARDS/CARDS/URCARD/URCARD/PLAYER/PLAYER
	COMMON /NATION/NATION/TERR/TERR/AMOUNT/AMOUNT/C/TROOPS
	COMMON /HOLDS/HOLDS/NHOLD/NHOLD/T2/T2


50	FORMAT(1A10)
100	CNB = NHOLD(X)
	IF (CNB.LT.3) RETURN

	TYPE 130,PLAYER(X),CNB
130	FORMAT(/1X,A10,/1X,'You have',I2,' cards')
140	IF (CNB.GE.5)TYPE 150
150	FORMAT(1X,'You must cash them in on this turn')
160	TYPE 170
170	FORMAT(1X,'Do you want your cards listed? '$)
	CALL YESNOZ($180,$200,$430)
180	TYPE 190,((NATION(HOLDS(X,IDA)),CARDS(HOLDS(X,IDA)),IDA=1,CNB))
190	FORMAT(4(1X,A5,'-',A10))
200	IF(CNB.GE.5)GO TO 220
	TYPE 210
210	FORMAT(1X,'Do you have a set to turn in? '$)
	CALL YESNOZ($220,$430,$430)
220	TYPE 230
230	FORMAT(1X,'What do you want to turn in?')

	LAST = CNB
	DO 330  IDX= 1 , 3
240	CALL GETNAM(DUMMY,NAME,5)
	IF (NAME.EQ.' ') GO TO 240
	TRIAL(IDX) = INDEX(NAME)
	IF (TRIAL(IDX).NE.0) GO TO 260
	TYPE 250
250	FORMAT(1X,'Illegal card, Type ''WILD'' or the name of a country')
	GO TO 240
260	DO 270 IDY = 1,LAST
	IF (TRIAL(IDX).EQ.HOLDS(X,IDY)) GO TO 290
270	CONTINUE
	TYPE 280,NATION(TRIAL(IDX))
280	FORMAT(1X,'You don''t have ',A5,' in your hand, Try again:'$)
	GO TO 240
290	DO 300  IDZ=1 , 4
	IF (CARDS(TRIAL(IDX)).EQ.URCARD(IDZ)) GO TO  320
300	CONTINUE
	TYPE 310
310	FORMAT(1X,'Impossible error has occurred, Illegal country name')
	CALL EXIT
320	HOLDS(X,IDY)=HOLDS(X,LAST)
	HOLDS(X,LAST)=0
	LAST = LAST - 1
	CASH (IDX) = IDZ
330	CONTINUE

	NAME = CASH(1)+CASH(2)+CASH(3)
	IF (((NAME/3)*3).EQ.NAME) GO TO 370
	IF (CASH(1).EQ.4.OR.CASH(2).EQ.4.OR.CASH(3).EQ.4) GO TO 370
	TYPE 340,(URCARD(CASH(I)),I=1,3)
340	FORMAT(1X,'Sorry ',3A10,'is close but no Rubber Duckie!')
	DO 350 IDX = 1,3
	LAST = LAST + 1
	HOLDS(X,LAST)=TRIAL(IDX)
350	CONTINUE
	IF (CNB.GE.5) GO TO 140
	IF (CNB.EQ.3) RETURN
	TYPE 360
360	FORMAT(1X,'Do you want to try again? '$)
	CALL YESNOZ($160,$430,$430)
370	T2=T2+1
	A6=2+(2*T2)
	IF (T2.GT.5)A6=(T2-3)*5
	TYPE 380,A6
380	FORMAT(1X,'The set is worth ',I4,' armies')
	D=D+A6
	DO 420 IDX = 1,3
	NHOLD(X) = NHOLD(X) - 1
	CALL RETCRD(TRIAL(IDX))
	DO 390 IDY = 1,AMOUNT(X)
	IF (TERR(X,IDY).EQ.NATION(TRIAL(IDX))) GO TO 400
390	CONTINUE
	GO TO 420
400	TROOPS(TRIAL(IDX))=TROOPS(TRIAL(IDX))+2
	TYPE 410,NATION(TRIAL(IDX)),TROOPS(TRIAL(IDX))
410	FORMAT(1X,'Two armies have been added to ',A5,' Total now:',I3)
420	CONTINUE
	GO TO 100
430	RETURN
	END
